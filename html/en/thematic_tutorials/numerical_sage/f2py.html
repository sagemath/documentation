<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="More Interesting Examples with f2py" href="f2py_examples.html" /><link rel="prev" title="Using Compiled Code Interactively" href="using_compiled_code_iteractively.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>f2py - Thematic Tutorials</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom-furo.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom-jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom-codemirror-monokai.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Thematic Tutorials</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 10.2 Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../index.html">Home - Thematic Tutorials</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../toctree.html">Thematic tutorial document tree</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../algebraic_combinatorics.html">Algebraic Combinatorics in Sage</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../algebraic_combinatorics/walks.html">Walks in graphs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../algebraic_combinatorics/n_cube.html"><span class="math notranslate nohighlight">\(n\)</span>-Cube</a></li>
<li class="toctree-l3"><a class="reference internal" href="../algebraic_combinatorics/tsetlin_library.html">The Tsetlin library</a></li>
<li class="toctree-l3"><a class="reference internal" href="../algebraic_combinatorics/rsk.html">Youngâ€™s lattice and the RSK algorithm</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../sandpile.html">Abelian Sandpile Model</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../group_theory.html">Group Theory and Sage</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../lie.html">Lie Methods and Related Combinatorics in Sage</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../lie/introduction.html">The Scope of this Document</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lie/lie_basics.html">Lie Group Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lie/weyl_character_ring.html">The Weyl Character Ring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lie/branching_rules.html">Maximal Subgroups and Branching Rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lie/weyl_groups.html">Weyl Groups, Coxeter Groups and the Bruhat Order</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lie/crystals.html">Classical Crystals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lie/affine.html">Affine Root System Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lie/integrable.html">Integrable Highest Weight Representations of Affine Lie algebras</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lie/affine_finite_crystals.html">Affine Finite Crystals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lie/affine_hw_crystals.html">Affine Highest Weight Crystals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lie/elementary_crystals.html">Elementary crystals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lie/infinity_crystals.html">Infinity Crystals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lie/iwahori_hecke_algebra.html">Iwahori Hecke Algebras</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lie/kazhdan_lusztig_polynomials.html">Kazhdan-Lusztig Polynomials</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lie/bibliography.html">Bibliography</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../vector_calculus.html">Tutorial: Vector Calculus in Euclidean Spaces</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../vector_calculus/vector_calc_cartesian.html">How to compute a gradient, a divergence or a curl</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vector_calculus/vector_calc_curvilinear.html">How to perform vector calculus in curvilinear coordinates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vector_calculus/vector_calc_change.html">How to change coordinates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vector_calculus/vector_calc_advanced.html">Advanced aspects: the Euclidean space as a Riemannian manifold</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vector_calculus/vector_calc_plane.html">Vector calculus in the Euclidean plane</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../linear_programming.html">Linear Programming (Mixed Integer)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../numtheory_rsa.html">Number Theory and the RSA Public Key Cryptosystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../coding_theory.html">Coding Theory in Sage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../structures_in_coding_theory.html">How to write your own classes for coding theory</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../geometry.html">Polyhedra</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../geometry/polyhedra_quicktutorial.html">A Brief Introduction to Polytopes in Sage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/polyhedra_tutorial.html">A Longer Introduction to Polyhedral Computations in Sage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/polyhedra_quickref.html">Quick reference for polyhedra in Sage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/tips.html">Polyhedra tips and tricks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/visualization.html">Visualization of polyhedron objects in Sage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/polytope_tikz.html">Draw polytopes in LaTeX using TikZ</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../steenrod_algebra_modules.html">Steenrod Algebra Modules</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial-programming-python.html">Tutorial: Programming in Python and Sage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial-comprehensions.html">Tutorial: Comprehensions, Iterators, and Iterables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial-objects-and-classes.html">Tutorial: Objects and Classes in Python and Sage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../functional_programming.html">Functional Programming for Mathematicians</a></li>
<li class="toctree-l2"><a class="reference internal" href="../coercion_and_categories.html">How to implement new algebraic structures in Sage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial-implementing-algebraic-structures.html">Tutorial: Implementing Algebraic Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cython_interface.html">How to call a C code (or a compiled library) from Sage ?</a></li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">Numerical Computing with Sage</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 has-children"><a class="reference internal" href="numerical_tools.html">Numerical Tools</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="numpy.html">NumPy</a></li>
<li class="toctree-l4"><a class="reference internal" href="scipy.html">SciPy</a></li>
<li class="toctree-l4"><a class="reference internal" href="cvxopt.html">Cvxopt</a></li>
</ul>
</li>
<li class="toctree-l3 current has-children"><a class="reference internal" href="using_compiled_code_iteractively.html">Using Compiled Code Interactively</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l4 current current-page"><a class="current reference internal" href="#">f2py</a></li>
<li class="toctree-l4"><a class="reference internal" href="f2py_examples.html">More Interesting Examples with f2py</a></li>
<li class="toctree-l4"><a class="reference internal" href="ctypes.html">Ctypes</a></li>
<li class="toctree-l4"><a class="reference internal" href="ctypes_examples.html">More complicated ctypes example</a></li>
<li class="toctree-l4"><a class="reference internal" href="comparison_to_cython.html">Comparison to Cython/Pyrex</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="parallel_computation.html">Parallel Computation</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mpi4py.html">mpi4py</a></li>
<li class="toctree-l4"><a class="reference internal" href="parallel_laplace_solver.html">Parallel Laplace Solver</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../explicit_methods_in_number_theory/index.html">Three Lectures about Explicit Methods in Number Theory Using Sage</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../explicit_methods_in_number_theory/introduction.html">Introduction</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../explicit_methods_in_number_theory/number_fields.html">Number Fields</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/nf_introduction.html">Introduction to Number Fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/nf_galois_groups.html">Number Fields: Galois Groups and Class Groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/nf_orders.html">Orders and Relative Extensions</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../explicit_methods_in_number_theory/birds_eye_view.html">A Birdâ€™s Eye View</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/integer_factorization.html">Integer Factorization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/elliptic_curves.html">Elliptic Curves</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/birds_other.html">The Matrix of Frobenius on Hyperelliptic Curves</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/birds_other.html#modular-symbols">Modular Symbols</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/birds_other.html#enumerating-totally-real-number-fields">Enumerating Totally Real Number Fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/birds_other.html#bernoulli-numbers">Bernoulli Numbers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/birds_other.html#polynomial-arithmetic">Polynomial Arithmetic</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../explicit_methods_in_number_theory/modular_forms.html">Modular Forms</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/modular_forms_and_hecke_operators.html">Modular Forms and Hecke Operators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/modular_symbols.html">Modular Symbols</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/method_of_graphs.html">Method of Graphs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/level_one_forms.html">Level One Modular Forms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/half_integral.html">Half Integral Weight Forms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/generators_for_rings.html">Generators for Rings of Modular Forms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/l_series.html"><span class="math notranslate nohighlight">\(L\)</span>-series</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/modabvar.html">Modular Abelian Varieties</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../profiling.html">Profiling in Sage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sws2rst.html">Creating a Tutorial from an old Sage Worksheet (.sws)</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="f2py">
<h1>f2py<a class="headerlink" href="#f2py" title="Permalink to this heading">#</a></h1>
<p>F2py is a very nice package that automatically wraps fortran code
and makes it callable from Python. The Fibonacci examples are taken
from the f2py webpage <a class="reference external" href="http://cens.ioc.ee/projects/f2py2e/">http://cens.ioc.ee/projects/f2py2e/</a>.</p>
<p>From the notebook the magic %fortran will automatically compile any
fortran code in a cell and all the subroutines will become callable
functions (though the names will be converted to lowercase.) As an
example paste the following into a cell. It is important that the
spacing is correct as by default the code is treated as fixed
format fortran and the compiler will complain if things are not in
the correct column. To avoid this, you can write fortran 90 code
instead by making your first line !f90. There will be an example of
this later.</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="p">%</span><span class="n">fortran</span><span class="w"></span>
<span class="n">C</span><span class="w"> </span><span class="k">FILE</span><span class="p">:</span><span class="w"> </span><span class="n">FIB1</span><span class="p">.</span><span class="n">F</span><span class="w"></span>
<span class="w">      </span><span class="k">SUBROUTINE </span><span class="n">FIB</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">N</span><span class="p">)</span><span class="w"></span>
<span class="n">C</span><span class="w"></span>
<span class="n">C</span><span class="w">     </span><span class="n">CALCULATE</span><span class="w"> </span><span class="n">FIRST</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="n">FIBONACCI</span><span class="w"> </span><span class="n">NUMBERS</span><span class="w"></span>
<span class="n">C</span><span class="w"></span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">N</span><span class="w"></span>
<span class="w">      </span><span class="kt">REAL</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">DO </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="w"></span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">I</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            </span><span class="n">A</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0D0</span><span class="w"></span>
<span class="w">         </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="n">I</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            </span><span class="n">A</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0D0</span><span class="w"></span>
<span class="w">         </span><span class="k">ELSE</span>
<span class="k">            </span><span class="n">A</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span>
<span class="k">      ENDDO</span>
<span class="k">      END</span>
<span class="n">C</span><span class="w"> </span><span class="k">END FILE </span><span class="n">FIB1</span><span class="p">.</span><span class="n">F</span><span class="w"></span>
</pre></div>
</div>
<p>Now evaluate it. It will be automatically compiled and imported
into Sage (though the name of imported function will be lowercase).
Now we want to try to call it, we need to somehow pass it an array
<span class="math notranslate nohighlight">\(A\)</span>, and the length of the array <span class="math notranslate nohighlight">\(N\)</span>. The way it
works is that numpy arrays will be automatically converted to
fortran arrays, and Python scalars converted to fortran scalars. So
to call fib we do the following.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="n">m</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">fib</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that fortran is a function that can be called on any string.
So if you have a fortran program in a file my
prog.f. Then you could do the following</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;my_prog.f&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">s</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">fortran</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<p>Now all the functions in my
prog.f are callable.</p>
<p>It is possible to call external libraries in your fortran code. You
simply need to tell f2py to link them in. For example suppose we
wish to write a program to solve a linear equation using lapack (a
linear algebra library). The function we want to use is called
dgesv and it has the following signature.</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">SUBROUTINE </span><span class="n">DGESV</span><span class="p">(</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">NRHS</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">LDA</span><span class="p">,</span><span class="w"> </span><span class="n">IPIV</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">LDB</span><span class="p">,</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="p">)</span><span class="w"></span>


<span class="o">*</span><span class="w">  </span><span class="n">N</span><span class="w">       </span><span class="p">(</span><span class="n">input</span><span class="p">)</span><span class="w"> </span><span class="kt">INTEGER</span><span class="w"></span>
<span class="o">*</span><span class="w">          </span><span class="n">The</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">linear</span><span class="w"> </span><span class="n">equations</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">.</span><span class="n">e</span><span class="p">.,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"></span>
<span class="o">*</span><span class="w">          </span><span class="n">matrix</span><span class="w"> </span><span class="n">A</span><span class="p">.</span><span class="w">  </span><span class="n">N</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<span class="o">*</span><span class="w"></span>
<span class="o">*</span><span class="w">  </span><span class="n">NRHS</span><span class="w">    </span><span class="p">(</span><span class="n">input</span><span class="p">)</span><span class="w"> </span><span class="kt">INTEGER</span><span class="w"></span>
<span class="o">*</span><span class="w">          </span><span class="n">The</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">right</span><span class="w"> </span><span class="n">hand</span><span class="w"> </span><span class="n">sides</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">.</span><span class="n">e</span><span class="p">.,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">columns</span><span class="w"></span>
<span class="o">*</span><span class="w">          </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">matrix</span><span class="w"> </span><span class="n">B</span><span class="p">.</span><span class="w">  </span><span class="n">NRHS</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<span class="o">*</span><span class="w"></span>
<span class="o">*</span><span class="w">  </span><span class="n">A</span><span class="w">       </span><span class="p">(</span><span class="n">input</span><span class="o">/</span><span class="n">output</span><span class="p">)</span><span class="w"> </span><span class="kt">DOUBLE PRECISION </span><span class="k">array</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="w"> </span><span class="p">(</span><span class="n">LDA</span><span class="p">,</span><span class="n">N</span><span class="p">)</span><span class="w"></span>
<span class="o">*</span><span class="w">          </span><span class="n">On</span><span class="w"> </span><span class="k">entry</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">N</span><span class="o">-</span><span class="n">by</span><span class="o">-</span><span class="n">N</span><span class="w"> </span><span class="n">coefficient</span><span class="w"> </span><span class="n">matrix</span><span class="w"> </span><span class="n">A</span><span class="p">.</span><span class="w"></span>
<span class="o">*</span><span class="w">          </span><span class="n">On</span><span class="w"> </span><span class="k">exit</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">factors</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="nb">and </span><span class="n">U</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">factorization</span><span class="w"></span>
<span class="o">*</span><span class="w">          </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">P</span><span class="o">*</span><span class="n">L</span><span class="o">*</span><span class="n">U</span><span class="p">;</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">unit</span><span class="w"> </span><span class="n">diagonal</span><span class="w"> </span><span class="n">elements</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="nb">not </span><span class="n">stored</span><span class="p">.</span><span class="w"></span>
<span class="o">*</span><span class="w"></span>
<span class="o">*</span><span class="w">  </span><span class="n">LDA</span><span class="w">     </span><span class="p">(</span><span class="n">input</span><span class="p">)</span><span class="w"> </span><span class="kt">INTEGER</span><span class="w"></span>
<span class="o">*</span><span class="w">          </span><span class="n">The</span><span class="w"> </span><span class="n">leading</span><span class="w"> </span><span class="k">dimension </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">array </span><span class="n">A</span><span class="p">.</span><span class="w">  </span><span class="n">LDA</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">).</span><span class="w"></span>
<span class="o">*</span><span class="w"></span>
<span class="o">*</span><span class="w">  </span><span class="n">IPIV</span><span class="w">    </span><span class="p">(</span><span class="n">output</span><span class="p">)</span><span class="w"> </span><span class="kt">INTEGER </span><span class="k">array</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="w"> </span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="w"></span>
<span class="o">*</span><span class="w">          </span><span class="n">The</span><span class="w"> </span><span class="n">pivot</span><span class="w"> </span><span class="n">indices</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">define</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">permutation</span><span class="w"> </span><span class="n">matrix</span><span class="w"> </span><span class="n">P</span><span class="p">;</span><span class="w"></span>
<span class="o">*</span><span class="w">          </span><span class="n">row</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">matrix</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">interchanged</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">row</span><span class="w"> </span><span class="n">IPIV</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="w"></span>
<span class="o">*</span><span class="w"></span>
<span class="o">*</span><span class="w">  </span><span class="n">B</span><span class="w">       </span><span class="p">(</span><span class="n">input</span><span class="o">/</span><span class="n">output</span><span class="p">)</span><span class="w"> </span><span class="kt">DOUBLE PRECISION </span><span class="k">array</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="w"> </span><span class="p">(</span><span class="n">LDB</span><span class="p">,</span><span class="n">NRHS</span><span class="p">)</span><span class="w"></span>
<span class="o">*</span><span class="w">          </span><span class="n">On</span><span class="w"> </span><span class="k">entry</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">N</span><span class="o">-</span><span class="n">by</span><span class="o">-</span><span class="n">NRHS</span><span class="w"> </span><span class="n">matrix</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">right</span><span class="w"> </span><span class="n">hand</span><span class="w"> </span><span class="n">side</span><span class="w"> </span><span class="n">matrix</span><span class="w"> </span><span class="n">B</span><span class="p">.</span><span class="w"></span>
<span class="o">*</span><span class="w">          </span><span class="n">On</span><span class="w"> </span><span class="k">exit</span><span class="p">,</span><span class="w"> </span><span class="k">if </span><span class="n">INFO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">N</span><span class="o">-</span><span class="n">by</span><span class="o">-</span><span class="n">NRHS</span><span class="w"> </span><span class="n">solution</span><span class="w"> </span><span class="n">matrix</span><span class="w"> </span><span class="n">X</span><span class="p">.</span><span class="w"></span>
<span class="o">*</span><span class="w"></span>
<span class="o">*</span><span class="w">  </span><span class="n">LDB</span><span class="w">     </span><span class="p">(</span><span class="n">input</span><span class="p">)</span><span class="w"> </span><span class="kt">INTEGER</span><span class="w"></span>
<span class="o">*</span><span class="w">          </span><span class="n">The</span><span class="w"> </span><span class="n">leading</span><span class="w"> </span><span class="k">dimension </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">array </span><span class="n">B</span><span class="p">.</span><span class="w">  </span><span class="n">LDB</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">).</span><span class="w"></span>
<span class="o">*</span><span class="w"></span>
<span class="o">*</span><span class="w">  </span><span class="n">INFO</span><span class="w">    </span><span class="p">(</span><span class="n">output</span><span class="p">)</span><span class="w"> </span><span class="kt">INTEGER</span><span class="w"></span>
<span class="o">*</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span><span class="w">  </span><span class="n">successful</span><span class="w"> </span><span class="k">exit</span><span class="w"></span>
<span class="o">*</span><span class="w">          </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span><span class="w">  </span><span class="k">if </span><span class="n">INFO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">i</span><span class="o">-</span><span class="n">th</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">had</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">illegal</span><span class="w"> </span><span class="k">value</span><span class="w"></span>
<span class="o">*</span><span class="w">          </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span><span class="w">  </span><span class="k">if </span><span class="n">INFO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">U</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">is </span><span class="n">exactly</span><span class="w"> </span><span class="n">zero</span><span class="p">.</span><span class="w">  </span><span class="n">The</span><span class="w"> </span><span class="n">factorization</span><span class="w"></span>
<span class="o">*</span><span class="w">                </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">completed</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">factor</span><span class="w"> </span><span class="n">U</span><span class="w"> </span><span class="k">is </span><span class="n">exactly</span><span class="w"></span>
<span class="o">*</span><span class="w">                </span><span class="n">singular</span><span class="p">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">solution</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="nb">not </span><span class="n">be</span><span class="w"> </span><span class="n">computed</span><span class="p">.</span><span class="w"></span>
</pre></div>
</div>
<p>we could do the following. Note that the order that library are in
the list actually matters as it is the order in which they are
passed to gcc. Also fortran.libraries is simply a list of names of
libraries that are linked in. You can just directly set this list.
So that fortran.libraries=[â€˜lapackâ€™,â€™blasâ€™]is equivalent to the
following.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fortran</span><span class="o">.</span><span class="n">add_library</span><span class="p">(</span><span class="s1">&#39;lapack&#39;</span><span class="p">)</span>
<span class="n">fortran</span><span class="o">.</span><span class="n">add_library</span><span class="p">(</span><span class="s1">&#39;blas&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="p">%</span><span class="n">fortran</span><span class="w"></span>
<span class="c">!f90</span>
<span class="k">Subroutine </span><span class="n">LinearEquations</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">n</span><span class="p">)</span><span class="w"></span>
<span class="kt">Integer </span><span class="n">n</span><span class="w"></span>
<span class="kt">Real</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">),</span><span class="w"> </span><span class="n">b</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"></span>
<span class="kt">Integer </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">pivot</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="w"> </span><span class="n">ok</span><span class="w"></span>
<span class="k">call </span><span class="n">DGESV</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">pivot</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">ok</span><span class="p">)</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
</pre></div>
</div>
<p>There are a couple things to note about this. As we remarked
earlier, if the first line of the code is !f90, then it will be
treated as fortran 90 code and does not need to be in fixed format.
To use the above try</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">b</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">x</span><span class="o">=</span><span class="n">b</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">linearequations</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">numpy</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>This will solve the linear system ax=b and store the result in b.
If your library is not in Sageâ€™s local/lib or in your path you can
add it to the search path using</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fortran</span><span class="o">.</span><span class="n">add_library_path</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">)</span><span class="o">.</span>
</pre></div>
</div>
<p>You can also directly set fortran.library
paths by assignment. It should be a list of paths (strings) to be
passed to gcc. To give you an idea of some more things you can do
with f2py, note that using intent statements you can control the
way the resulting Python function behaves a bit bitter. For example
consider the following modification of our original fibonacci
code.</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">C</span><span class="w"> </span><span class="k">FILE</span><span class="p">:</span><span class="w"> </span><span class="n">FIB3</span><span class="p">.</span><span class="n">F</span><span class="w"></span>
<span class="w">      </span><span class="k">SUBROUTINE </span><span class="n">FIB</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">N</span><span class="p">)</span><span class="w"></span>
<span class="n">C</span><span class="w"></span>
<span class="n">C</span><span class="w">     </span><span class="n">CALCULATE</span><span class="w"> </span><span class="n">FIRST</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="n">FIBONACCI</span><span class="w"> </span><span class="n">NUMBERS</span><span class="w"></span>
<span class="n">C</span><span class="w"></span>
<span class="w">      </span><span class="kt">INTEGER </span><span class="n">N</span><span class="w"></span>
<span class="w">      </span><span class="kt">REAL</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="w"></span>
<span class="n">Cf2py</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="n">n</span><span class="w"></span>
<span class="n">Cf2py</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="n">a</span><span class="w"></span>
<span class="n">Cf2py</span><span class="w"> </span><span class="n">depend</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="n">a</span><span class="w"></span>
<span class="w">      </span><span class="k">DO </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="w"></span>
<span class="w">         </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">I</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            </span><span class="n">A</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0D0</span><span class="w"></span>
<span class="w">         </span><span class="n">ELSEIF</span><span class="w"> </span><span class="p">(</span><span class="n">I</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="k">            </span><span class="n">A</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0D0</span><span class="w"></span>
<span class="w">         </span><span class="k">ELSE</span>
<span class="k">            </span><span class="n">A</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="k">ENDIF</span>
<span class="k">      ENDDO</span>
<span class="k">      END</span>
<span class="n">C</span><span class="w"> </span><span class="k">END FILE </span><span class="n">FIB3</span><span class="p">.</span><span class="n">F</span><span class="w"></span>
</pre></div>
</div>
<p>Note the comments with the intent statements. This tells f2py that
<span class="math notranslate nohighlight">\(n\)</span> is an input parameter and <span class="math notranslate nohighlight">\(a\)</span> is the output.
This is called as</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">=</span><span class="n">fib</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>In general you will pass everything declared intent(in) to the
fortran function and everything declared intent(out) will be
returned in a tuple. Note that declaring something intent(in) means
you only care about its value before the function is called not
afterwards. So in the above n tells us how many fiboncci numbers to
compute we need to specify this as an input, however we donâ€™t need
to get n back as it doesnâ€™t contain anything new. Similarly A is
intent(out) so we donâ€™t need A to have an specific value
beforehand, we just care about the contents afterwards. F2py
generates a Python function so you only pass those declared
intent(in) and supplies empty workspaces for the remaining
arguments and it only returns those that are intent(out). All
arguments are intent(in) by default.</p>
<p>Consider now the following</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="p">%</span><span class="n">fortran</span><span class="w"></span>
<span class="w">        </span><span class="k">Subroutine </span><span class="n">Rescale</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">n</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">Implicit none</span>
<span class="k">        </span><span class="kt">Integer </span><span class="n">n</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="w"></span>
<span class="w">        </span><span class="kt">Real</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">),</span><span class="w"> </span><span class="n">b</span><span class="w"></span>
<span class="w">        </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="w"></span>
<span class="w">           </span><span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="w"></span>
<span class="w">             </span><span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">=</span><span class="n">b</span><span class="o">*</span><span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">           </span><span class="k">end do</span>
<span class="k">        end do</span>
<span class="k">        end</span><span class="w"></span>
</pre></div>
</div>
<p>You might be expecting Rescale(a,n) to rescale a numpy matrix a.
Alas this doesnâ€™t work. Anything you pass in is unchanged
afterwards. Note that in the fibonacci example above, the one
dimensional array was changed by the fortran code, similarly the
one dimensional vector b was replaced by its solution in the
example where we called lapack while the matrix A was not changed
even then dgesv says it modifies the input matrix. Why does this
not happen with the two dimensional array. Understanding this
requires that you are aware of the difference between how fortran
and C store arrays. Fortran stores a matrices using column ordering
while C stores them using row ordering. That is the matrix</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\left(
\begin{array}{ccc}
0 &amp; 1 &amp;2\\
3 &amp; 4 &amp; 5\\
\end{array}
\right)\end{split}\]</div>
</div>
<p>is stored as</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\((0\, 1\, 2\, 3\, 4\, 5\,) \,\,\,\, \text{ in C}\)</span></p>
<p><span class="math notranslate nohighlight">\((0\, 3\,1\, 4\, 2\, 5) \,\,\,\, \text{ in Fortran}\)</span></p>
</div></blockquote>
<p>One dimensional arrays are stored the same in C and Fortran.
Because of this f2py allows the fortran code to operate on one
dimensional vectors in place, so your fortran code will change one
dimensional numpy arrays passed to it. However, since two
dimensional arrays are different by default f2py copies the numpy
array (which is stored in C format) into a second array that is in
the fortran format (i.e. takes the transpose) and that is what is
passed to the fortran function. We will see a way to get around
this copying later. First let us point one way of writing the
rescale function.</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="p">%</span><span class="n">fortran</span><span class="w"></span>

<span class="w">        </span><span class="k">Subroutine </span><span class="n">Rescale</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">n</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">Implicit none</span>
<span class="k">        </span><span class="kt">Integer </span><span class="n">n</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="w"></span>
<span class="w">        </span><span class="kt">Real</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">),</span><span class="w"> </span><span class="n">b</span><span class="w"></span>
<span class="n">Cf2py</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">,</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="n">a</span><span class="w"></span>
<span class="w">        </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="w"></span>
<span class="w">           </span><span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="w"></span>
<span class="w">             </span><span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">=</span><span class="n">b</span><span class="o">*</span><span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">           </span><span class="k">end do</span>
<span class="k">        end do</span>
<span class="k">        end</span><span class="w"></span>
</pre></div>
</div>
<p>Note that to call this you would use</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="o">=</span><span class="n">rescale</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mf">2.0</span><span class="p">)</span><span class="o">.</span>
</pre></div>
</div>
<p>Note here I am not passing in <span class="math notranslate nohighlight">\(n\)</span> which is the dimension of
<span class="math notranslate nohighlight">\(a\)</span>. Often f2py can figure this out. This is a good time to
mention that f2py automatically generates some documentation for
the Python version of the function so you can check what you need
to pass to it and what it will return. To use this try</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">rescale?</span>
</pre></div>
</div>
<p>The intent(in,out) directives tells f2py to take the contents of
<span class="math notranslate nohighlight">\(a\)</span> at the end of the subroutine and return them in a numpy
array. This still may not be what you want. The original
<span class="math notranslate nohighlight">\(a\)</span> that you pass in is unmodified. If you want to modify
the original <span class="math notranslate nohighlight">\(a\)</span> that you passed in use intent(inout). This
essentially lets your fortran code work with the data inplace.</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="p">%</span><span class="n">fortran</span><span class="w"></span>

<span class="w">        </span><span class="k">Subroutine </span><span class="n">Rescale</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">n</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">Implicit none</span>
<span class="k">        </span><span class="kt">Integer </span><span class="n">n</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="w"></span>
<span class="w">        </span><span class="kt">Real</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">),</span><span class="w"> </span><span class="n">b</span><span class="w"></span>
<span class="n">Cf2py</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="n">a</span><span class="w"></span>
<span class="w">        </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="w"></span>
<span class="w">           </span><span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="w"></span>
<span class="w">             </span><span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">=</span><span class="n">b</span><span class="o">*</span><span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">           </span><span class="k">end do</span>
<span class="k">        end do</span>
<span class="k">        end</span><span class="w"></span>
</pre></div>
</div>
<p>If you wish to have fortran code work with numpy arrays in place,
you should make sure that your numpy arrays are stored in fortranâ€™s
format. You can ensure this by using the order=â€™FORTRANâ€™ keyword
when creating the arrays, as follows.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;FORTRAN&#39;</span><span class="p">)</span>
<span class="n">rescale</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mf">2.0</span><span class="p">)</span>
</pre></div>
</div>
<p>After this executes, a will have the rescaled version of itself.
There is one final version which combines the previous two.</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="p">%</span><span class="n">fortran</span><span class="w"></span>

<span class="w">        </span><span class="k">Subroutine </span><span class="n">Rescale</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">n</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">Implicit none</span>
<span class="k">        </span><span class="kt">Integer </span><span class="n">n</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="w"></span>
<span class="w">        </span><span class="kt">Real</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">),</span><span class="w"> </span><span class="n">b</span><span class="w"></span>
<span class="n">Cf2py</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="n">overwrite</span><span class="p">)</span><span class="w"> </span><span class="n">a</span><span class="w"></span>
<span class="w">        </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="w"></span>
<span class="w">           </span><span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="w"></span>
<span class="w">             </span><span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">=</span><span class="n">b</span><span class="o">*</span><span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">           </span><span class="k">end do</span>
<span class="k">        end do</span>
<span class="k">        end</span><span class="w"></span>
</pre></div>
</div>
<p>The (in,out,overwrite) intent says that if <span class="math notranslate nohighlight">\(a\)</span> is in FORTRAN
ordering we work in place, however if its not we copy it and return
the contents afterwards. This is sort of the best of both worlds.
Note that if you are repeatedly passing large numpy arrays to
fortran code, it is very important to avoiding copying the array by
using (inout) or (in,out,overwrite). Remember though that your
numpy array must use Fortran ordering to avoid the copying.</p>
<p>For more examples and more advanced usage of F2py you should refer
to the f2py webpage <a class="reference external" href="http://cens.ioc.ee/projects/f2py2e/">http://cens.ioc.ee/projects/f2py2e/</a>. The
command line f2py tool which is referred to in the f2py
documentation can be called from the Sage shell using</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">!f2py</span>
</pre></div>
</div>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="f2py_examples.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">More Interesting Examples with f2py</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="using_compiled_code_iteractively.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Using Compiled Code Interactively</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2023, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "lcm": "\\mathop{\\operatorname{lcm}}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <script src="../_static/jupyter-sphinx-furo.js"></script>
    </body>
</html>