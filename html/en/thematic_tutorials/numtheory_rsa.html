<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Coding Theory in Sage" href="coding_theory.html" /><link rel="prev" title="Linear Programming (Mixed Integer)" href="linear_programming.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>Number Theory and the RSA Public Key Cryptosystem - Thematic Tutorials</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="_static/custom-furo.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom-jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom-codemirror-monokai.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Thematic Tutorials</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 10.2 Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="index.html">Home - Thematic Tutorials</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="toctree.html">Thematic tutorial document tree</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="algebraic_combinatorics.html">Algebraic Combinatorics in Sage</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="algebraic_combinatorics/walks.html">Walks in graphs</a></li>
<li class="toctree-l3"><a class="reference internal" href="algebraic_combinatorics/n_cube.html"><span class="math notranslate nohighlight">\(n\)</span>-Cube</a></li>
<li class="toctree-l3"><a class="reference internal" href="algebraic_combinatorics/tsetlin_library.html">The Tsetlin library</a></li>
<li class="toctree-l3"><a class="reference internal" href="algebraic_combinatorics/rsk.html">Young’s lattice and the RSK algorithm</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="sandpile.html">Abelian Sandpile Model</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="group_theory.html">Group Theory and Sage</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="lie.html">Lie Methods and Related Combinatorics in Sage</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="lie/introduction.html">The Scope of this Document</a></li>
<li class="toctree-l3"><a class="reference internal" href="lie/lie_basics.html">Lie Group Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="lie/weyl_character_ring.html">The Weyl Character Ring</a></li>
<li class="toctree-l3"><a class="reference internal" href="lie/branching_rules.html">Maximal Subgroups and Branching Rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="lie/weyl_groups.html">Weyl Groups, Coxeter Groups and the Bruhat Order</a></li>
<li class="toctree-l3"><a class="reference internal" href="lie/crystals.html">Classical Crystals</a></li>
<li class="toctree-l3"><a class="reference internal" href="lie/affine.html">Affine Root System Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="lie/integrable.html">Integrable Highest Weight Representations of Affine Lie algebras</a></li>
<li class="toctree-l3"><a class="reference internal" href="lie/affine_finite_crystals.html">Affine Finite Crystals</a></li>
<li class="toctree-l3"><a class="reference internal" href="lie/affine_hw_crystals.html">Affine Highest Weight Crystals</a></li>
<li class="toctree-l3"><a class="reference internal" href="lie/elementary_crystals.html">Elementary crystals</a></li>
<li class="toctree-l3"><a class="reference internal" href="lie/infinity_crystals.html">Infinity Crystals</a></li>
<li class="toctree-l3"><a class="reference internal" href="lie/iwahori_hecke_algebra.html">Iwahori Hecke Algebras</a></li>
<li class="toctree-l3"><a class="reference internal" href="lie/kazhdan_lusztig_polynomials.html">Kazhdan-Lusztig Polynomials</a></li>
<li class="toctree-l3"><a class="reference internal" href="lie/bibliography.html">Bibliography</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="vector_calculus.html">Tutorial: Vector Calculus in Euclidean Spaces</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="vector_calculus/vector_calc_cartesian.html">How to compute a gradient, a divergence or a curl</a></li>
<li class="toctree-l3"><a class="reference internal" href="vector_calculus/vector_calc_curvilinear.html">How to perform vector calculus in curvilinear coordinates</a></li>
<li class="toctree-l3"><a class="reference internal" href="vector_calculus/vector_calc_change.html">How to change coordinates</a></li>
<li class="toctree-l3"><a class="reference internal" href="vector_calculus/vector_calc_advanced.html">Advanced aspects: the Euclidean space as a Riemannian manifold</a></li>
<li class="toctree-l3"><a class="reference internal" href="vector_calculus/vector_calc_plane.html">Vector calculus in the Euclidean plane</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="linear_programming.html">Linear Programming (Mixed Integer)</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Number Theory and the RSA Public Key Cryptosystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="coding_theory.html">Coding Theory in Sage</a></li>
<li class="toctree-l2"><a class="reference internal" href="structures_in_coding_theory.html">How to write your own classes for coding theory</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="geometry.html">Polyhedra</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="geometry/polyhedra_quicktutorial.html">A Brief Introduction to Polytopes in Sage</a></li>
<li class="toctree-l3"><a class="reference internal" href="geometry/polyhedra_tutorial.html">A Longer Introduction to Polyhedral Computations in Sage</a></li>
<li class="toctree-l3"><a class="reference internal" href="geometry/polyhedra_quickref.html">Quick reference for polyhedra in Sage</a></li>
<li class="toctree-l3"><a class="reference internal" href="geometry/tips.html">Polyhedra tips and tricks</a></li>
<li class="toctree-l3"><a class="reference internal" href="geometry/visualization.html">Visualization of polyhedron objects in Sage</a></li>
<li class="toctree-l3"><a class="reference internal" href="geometry/polytope_tikz.html">Draw polytopes in LaTeX using TikZ</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="steenrod_algebra_modules.html">Steenrod Algebra Modules</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial-programming-python.html">Tutorial: Programming in Python and Sage</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial-comprehensions.html">Tutorial: Comprehensions, Iterators, and Iterables</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial-objects-and-classes.html">Tutorial: Objects and Classes in Python and Sage</a></li>
<li class="toctree-l2"><a class="reference internal" href="functional_programming.html">Functional Programming for Mathematicians</a></li>
<li class="toctree-l2"><a class="reference internal" href="coercion_and_categories.html">How to implement new algebraic structures in Sage</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial-implementing-algebraic-structures.html">Tutorial: Implementing Algebraic Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="cython_interface.html">How to call a C code (or a compiled library) from Sage ?</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="numerical_sage/index.html">Numerical Computing with Sage</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="numerical_sage/numerical_tools.html">Numerical Tools</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="numerical_sage/numpy.html">NumPy</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical_sage/scipy.html">SciPy</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical_sage/cvxopt.html">Cvxopt</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="numerical_sage/using_compiled_code_iteractively.html">Using Compiled Code Interactively</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="numerical_sage/f2py.html">f2py</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical_sage/f2py_examples.html">More Interesting Examples with f2py</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical_sage/ctypes.html">Ctypes</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical_sage/ctypes_examples.html">More complicated ctypes example</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical_sage/comparison_to_cython.html">Comparison to Cython/Pyrex</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="numerical_sage/parallel_computation.html">Parallel Computation</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="numerical_sage/mpi4py.html">mpi4py</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical_sage/parallel_laplace_solver.html">Parallel Laplace Solver</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="explicit_methods_in_number_theory/index.html">Three Lectures about Explicit Methods in Number Theory Using Sage</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="explicit_methods_in_number_theory/introduction.html">Introduction</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="explicit_methods_in_number_theory/number_fields.html">Number Fields</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/nf_introduction.html">Introduction to Number Fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/nf_galois_groups.html">Number Fields: Galois Groups and Class Groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/nf_orders.html">Orders and Relative Extensions</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="explicit_methods_in_number_theory/birds_eye_view.html">A Bird’s Eye View</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/integer_factorization.html">Integer Factorization</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/elliptic_curves.html">Elliptic Curves</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/birds_other.html">The Matrix of Frobenius on Hyperelliptic Curves</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/birds_other.html#modular-symbols">Modular Symbols</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/birds_other.html#enumerating-totally-real-number-fields">Enumerating Totally Real Number Fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/birds_other.html#bernoulli-numbers">Bernoulli Numbers</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/birds_other.html#polynomial-arithmetic">Polynomial Arithmetic</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="explicit_methods_in_number_theory/modular_forms.html">Modular Forms</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/modular_forms_and_hecke_operators.html">Modular Forms and Hecke Operators</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/modular_symbols.html">Modular Symbols</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/method_of_graphs.html">Method of Graphs</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/level_one_forms.html">Level One Modular Forms</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/half_integral.html">Half Integral Weight Forms</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/generators_for_rings.html">Generators for Rings of Modular Forms</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/l_series.html"><span class="math notranslate nohighlight">\(L\)</span>-series</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/modabvar.html">Modular Abelian Varieties</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="profiling.html">Profiling in Sage</a></li>
<li class="toctree-l2"><a class="reference internal" href="sws2rst.html">Creating a Tutorial from an old Sage Worksheet (.sws)</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="number-theory-and-the-rsa-public-key-cryptosystem">
<span id="numtheory-rsa"></span><h1>Number Theory and the RSA Public Key Cryptosystem<a class="headerlink" href="#number-theory-and-the-rsa-public-key-cryptosystem" title="Permalink to this heading">#</a></h1>
<p><em>Author: Minh Van Nguyen &lt;<a class="reference external" href="mailto:nguyenminh2&#37;&#52;&#48;gmail&#46;com">nguyenminh2<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt;</em></p>
<p>This tutorial uses Sage to study elementary number theory and the RSA
public key cryptosystem.  A number of Sage commands will be presented
that help us to perform basic number theoretic operations such as
greatest common divisor and Euler’s phi function.  We then present the
RSA cryptosystem and use Sage’s built-in commands to encrypt and
decrypt data via the RSA algorithm.  Note that this tutorial on RSA is
for pedagogy purposes only.  For further details on cryptography or
the security of various cryptosystems, consult specialized texts such
as
<a class="reference internal" href="#menezesetal1996" id="id1"><span>[MenezesEtAl1996]</span></a>,
<a class="reference internal" href="#stinson2006" id="id2"><span>[Stinson2006]</span></a>, and
<a class="reference internal" href="#trappewashington2006" id="id3"><span>[TrappeWashington2006]</span></a>.</p>
<section id="elementary-number-theory">
<h2>Elementary number theory<a class="headerlink" href="#elementary-number-theory" title="Permalink to this heading">#</a></h2>
<p>We first review basic concepts from elementary number theory,
including the notion of primes, greatest common divisors, congruences
and Euler’s phi function.  The number theoretic concepts and Sage
commands introduced will be referred to in later sections when we
present the RSA algorithm.</p>
<section id="prime-numbers">
<h3>Prime numbers<a class="headerlink" href="#prime-numbers" title="Permalink to this heading">#</a></h3>
<p>Public key cryptography uses many fundamental concepts from number
theory, such as prime numbers and greatest common divisors.  A
positive integer <span class="math notranslate nohighlight">\(n &gt; 1\)</span> is said to be <em>prime</em> if its factors are
exclusively 1 and itself.  In Sage, we can obtain the first 20 prime
numbers using the command <code class="docutils literal notranslate"><span class="pre">primes_first_n</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">primes_first_n</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">[2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71]</span>
</pre></div>
</div>
</section>
<section id="greatest-common-divisors">
<h3>Greatest common divisors<a class="headerlink" href="#greatest-common-divisors" title="Permalink to this heading">#</a></h3>
<p>Let <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> be integers, not both zero. Then the greatest common
divisor (GCD) of <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> is the largest positive integer which is
a factor of both <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>. We use <span class="math notranslate nohighlight">\(\gcd(a,b)\)</span> to denote this
largest positive factor. One can extend this definition by setting
<span class="math notranslate nohighlight">\(\gcd(0,0) = 0\)</span>. Sage uses <code class="docutils literal notranslate"><span class="pre">gcd(a,</span> <span class="pre">b)</span></code> to denote the GCD of <span class="math notranslate nohighlight">\(a\)</span>
and <span class="math notranslate nohighlight">\(b\)</span>. The GCD of any two distinct primes is 1, and the GCD of 18
and 27 is 9.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">gcd</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">59</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">gcd</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">27</span><span class="p">)</span>
<span class="go">9</span>
</pre></div>
</div>
<p>If <span class="math notranslate nohighlight">\(\gcd(a,b) = 1\)</span>, we say that <span class="math notranslate nohighlight">\(a\)</span> is <em>coprime</em> (or relatively
prime) to <span class="math notranslate nohighlight">\(b\)</span>.  In particular, <span class="math notranslate nohighlight">\(\gcd(3, 59) = 1\)</span> so 3 is coprime to 59
and vice versa.</p>
</section>
<section id="congruences">
<h3>Congruences<a class="headerlink" href="#congruences" title="Permalink to this heading">#</a></h3>
<p>When one integer is divided by a non-zero integer, we usually get a
remainder.  For example, upon dividing 23 by 5, we get a remainder of
3; when 8 is divided by 5, the remainder is again 3.  The notion of
congruence helps us to describe the situation in which two integers
have the same remainder upon division by a non-zero integer.  Let
<span class="math notranslate nohighlight">\(a,b,n \in \ZZ\)</span> such that <span class="math notranslate nohighlight">\(n \neq 0\)</span>.  If <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> have the
same remainder upon division by <span class="math notranslate nohighlight">\(n\)</span>, then we say that <span class="math notranslate nohighlight">\(a\)</span> is
<em>congruent</em> to <span class="math notranslate nohighlight">\(b\)</span> modulo <span class="math notranslate nohighlight">\(n\)</span> and denote this relationship by</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[a \equiv b \pmod{n}\]</div>
</div>
<p>This definition is equivalent to saying that <span class="math notranslate nohighlight">\(n\)</span> divides the
difference of <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>, i.e. <span class="math notranslate nohighlight">\(n \;|\; (a - b)\)</span>.  Thus
<span class="math notranslate nohighlight">\(23 \equiv 8 \pmod{5}\)</span> because when both 23 and 8 are divided by 5, we
end up with a remainder of 3.  The command <code class="docutils literal notranslate"><span class="pre">mod</span></code> allows us to
compute such a remainder:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">mod</span><span class="p">(</span><span class="mi">23</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">mod</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
</section>
<section id="euler-s-phi-function">
<h3>Euler’s phi function<a class="headerlink" href="#euler-s-phi-function" title="Permalink to this heading">#</a></h3>
<p>Consider all the integers from 1 to 20, inclusive.  List all those
integers that are coprime to 20.  In other words, we want to find
those integers <span class="math notranslate nohighlight">\(n\)</span>, where <span class="math notranslate nohighlight">\(1 \leq n \leq 20\)</span>, such that
<span class="math notranslate nohighlight">\(\gcd(n,20) = 1\)</span>.  The latter task can be easily accomplished with a
little bit of Sage programming:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="k">if</span> <span class="n">gcd</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span class="gp">....: </span>        <span class="n">L</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">[1, 3, 7, 9, 11, 13, 17, 19]</span>
</pre></div>
</div>
<p>The above programming statements can be saved to a text file called,
say, <code class="docutils literal notranslate"><span class="pre">/home/mvngu/totient.sage</span></code>, organizing it as follows to enhance
readability.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">gcd</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">L</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">L</span>
</pre></div>
</div>
<p>We refer to <code class="docutils literal notranslate"><span class="pre">totient.sage</span></code> as a Sage script, just as one would refer
to a file containing Python code as a Python script.  We use 4 space
indentations, which is a coding convention in Sage as well as Python
programming, instead of tabs.</p>
<p>The command <code class="docutils literal notranslate"><span class="pre">load</span></code> can be used to read the file containing our
programming statements into Sage and, upon loading the content of the
file, have Sage execute those statements:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">load(&quot;/home/mvngu/totient.sage&quot;)</span>
<span class="go">[1, 3, 7, 9, 11, 13, 17, 19]</span>
</pre></div>
</div>
<p>From the latter list, there are 8 integers in the closed interval
<span class="math notranslate nohighlight">\([1, 20]\)</span> that are coprime to 20.  Without explicitly generating the
list</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>1  3  7  9  11  13  17  19
</pre></div>
</div>
<p>how can we compute the number of integers in <span class="math notranslate nohighlight">\([1, 20]\)</span> that are
coprime to 20?  This is where Euler’s phi function comes in handy.
Let <span class="math notranslate nohighlight">\(n \in \ZZ\)</span> be positive.  Then <em>Euler’s phi function</em> counts the
number of integers <span class="math notranslate nohighlight">\(a\)</span>, with <span class="math notranslate nohighlight">\(1 \leq a \leq n\)</span>, such that
<span class="math notranslate nohighlight">\(\gcd(a,n) = 1\)</span>.  This number is denoted by <span class="math notranslate nohighlight">\(\varphi(n)\)</span>.  Euler’s phi
function is sometimes referred to as Euler’s totient function, hence
the name <code class="docutils literal notranslate"><span class="pre">totient.sage</span></code> for the above Sage script.  The command
<code class="docutils literal notranslate"><span class="pre">euler_phi</span></code> implements Euler’s phi function.  To compute
<span class="math notranslate nohighlight">\(\varphi(20)\)</span> without explicitly generating the above list, we proceed
as follows:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">euler_phi</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">8</span>
</pre></div>
</div>
</section>
</section>
<section id="how-to-keep-a-secret">
<h2>How to keep a secret?<a class="headerlink" href="#how-to-keep-a-secret" title="Permalink to this heading">#</a></h2>
<p><em>Cryptography</em> is the science (some might say art) of concealing
data.  Imagine that we are composing a confidential email to
someone.  Having written the email, we can send it in one of two ways.
The first, and usually convenient, way is to simply press the send
button and not care about how our email will be delivered.  Sending an
email in this manner is similar to writing our confidential message on
a postcard and post it without enclosing our postcard inside an
envelope.  Anyone who can access our postcard can see our message.
On the other hand, before sending our email, we can scramble the
confidential message and then press the send button.  Scrambling our
message is similar to enclosing our postcard inside an envelope.
While not 100% secure, at least we know that anyone wanting to read
our postcard has to open the envelope.</p>
<p>In cryptography parlance, our message is called <em>plaintext</em>.  The
process of scrambling our message is referred to as <em>encryption</em>.
After encrypting our message, the scrambled version is called
<em>ciphertext</em>.  From the ciphertext, we can recover our original
unscrambled message via <em>decryption</em>. The following figure
illustrates the processes of encryption and decryption.  A
<em>cryptosystem</em> is comprised of a pair of related encryption and
decryption processes.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>+ ---------+   encrypt    +------------+   decrypt    +-----------+
| plaintext| -----------&gt; | ciphertext | -----------&gt; | plaintext |
+----------+              +------------+              +-----------+
</pre></div>
</div>
<p>The following table provides a very simple method of scrambling a
message written in English and using only upper case letters,
excluding punctuation characters.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>+----------------------------------------------------+
| A   B   C   D   E   F   G   H   I   J   K   L   M  |
| 65  66  67  68  69  70  71  72  73  74  75  76  77 |
+----------------------------------------------------+
| N   O   P   Q   R   S   T   U   V   W   X   Y   Z  |
| 78  79  80  81  82  83  84  85  86  87  88  89  90 |
+----------------------------------------------------+
</pre></div>
</div>
<p>Formally, let</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\Sigma
=
\{ \mathtt{A}, \mathtt{B}, \mathtt{C}, \dots, \mathtt{Z} \}\]</div>
</div>
<p>be the set of capital letters of the English alphabet. Furthermore,
let</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\Phi
=
\{ 65, 66, 67, \dots, 90 \}\]</div>
</div>
<p>be the American Standard Code for Information Interchange (ASCII)
encodings of the upper case English letters.  Then the above table
explicitly describes the mapping <span class="math notranslate nohighlight">\(f: \Sigma \longrightarrow \Phi\)</span>.
(For those familiar with ASCII, <span class="math notranslate nohighlight">\(f\)</span> is actually a common process for
<em>encoding</em> elements of <span class="math notranslate nohighlight">\(\Sigma\)</span>, rather than a cryptographic
“scrambling” process <em>per se</em>.)  To scramble a message written using
the alphabet <span class="math notranslate nohighlight">\(\Sigma\)</span>, we simply replace each capital letter of the
message with its corresponding ASCII encoding.  However, the
scrambling process described in the above table provides,
cryptographically speaking, very little to no security at all and we
strongly discourage its use in practice.</p>
</section>
<section id="keeping-a-secret-with-two-keys">
<h2>Keeping a secret with two keys<a class="headerlink" href="#keeping-a-secret-with-two-keys" title="Permalink to this heading">#</a></h2>
<p>The Rivest, Shamir, Adleman (RSA) cryptosystem is an example of a
<em>public key cryptosystem</em>.  RSA uses a <em>public key</em> to
encrypt messages and decryption is performed using a corresponding
<em>private key</em>.  We can distribute our public keys, but for
security reasons we should keep our private keys to ourselves.  The
encryption and decryption processes draw upon techniques from
elementary number theory.  The algorithm below is adapted from page
165 of <a class="reference internal" href="#trappewashington2006" id="id4"><span>[TrappeWashington2006]</span></a>. It outlines the RSA procedure for
encryption and decryption.</p>
<ol class="arabic simple">
<li><p>Choose two primes <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span> and let <span class="math notranslate nohighlight">\(n = pq\)</span>.</p></li>
<li><p>Let <span class="math notranslate nohighlight">\(e \in \ZZ\)</span> be positive such that
<span class="math notranslate nohighlight">\(\gcd \big( e, \varphi(n) \big) = 1\)</span>.</p></li>
<li><p>Compute a value for <span class="math notranslate nohighlight">\(d \in \ZZ\)</span> such that
<span class="math notranslate nohighlight">\(de \equiv 1 \pmod{\varphi(n)}\)</span>.</p></li>
<li><p>Our public key is the pair <span class="math notranslate nohighlight">\((n, e)\)</span> and our private key is the
triple <span class="math notranslate nohighlight">\((p,q,d)\)</span>.</p></li>
<li><p>For any non-zero integer <span class="math notranslate nohighlight">\(m &lt; n\)</span>, encrypt <span class="math notranslate nohighlight">\(m\)</span> using
<span class="math notranslate nohighlight">\(c \equiv m^e \pmod{n}\)</span>.</p></li>
<li><p>Decrypt <span class="math notranslate nohighlight">\(c\)</span> using <span class="math notranslate nohighlight">\(m \equiv c^d \pmod{n}\)</span>.</p></li>
</ol>
<p>The next two sections will step through the RSA algorithm, using
Sage to generate public and private keys, and perform encryption
and decryption based on those keys.</p>
</section>
<section id="generating-public-and-private-keys">
<h2>Generating public and private keys<a class="headerlink" href="#generating-public-and-private-keys" title="Permalink to this heading">#</a></h2>
<p>Positive integers of the form <span class="math notranslate nohighlight">\(M_m = 2^m - 1\)</span> are called
<em>Mersenne numbers</em>.  If <span class="math notranslate nohighlight">\(p\)</span> is prime and <span class="math notranslate nohighlight">\(M_p = 2^p - 1\)</span> is also
prime, then <span class="math notranslate nohighlight">\(M_p\)</span> is called a <em>Mersenne prime</em>.  For example, 31
is prime and <span class="math notranslate nohighlight">\(M_{31} = 2^{31} - 1\)</span> is a Mersenne prime, as can be
verified using the command <code class="docutils literal notranslate"><span class="pre">is_prime(p)</span></code>.  This command returns
<code class="docutils literal notranslate"><span class="pre">True</span></code> if its argument <code class="docutils literal notranslate"><span class="pre">p</span></code> is precisely a prime number;
otherwise it returns <code class="docutils literal notranslate"><span class="pre">False</span></code>.  By definition, a prime must be a
positive integer, hence <code class="docutils literal notranslate"><span class="pre">is_prime(-2)</span></code> returns <code class="docutils literal notranslate"><span class="pre">False</span></code>
although we know that 2 is prime.  Indeed, the number
<span class="math notranslate nohighlight">\(M_{61} = 2^{61} - 1\)</span> is also a Mersenne prime.  We can use
<span class="math notranslate nohighlight">\(M_{31}\)</span> and <span class="math notranslate nohighlight">\(M_{61}\)</span> to work through step 1 in the RSA algorithm:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">31</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">is_prime</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">61</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">is_prime</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span> <span class="p">;</span> <span class="n">n</span>
<span class="go">4951760154835678088235319297</span>
</pre></div>
</div>
<p>A word of warning is in order here.  In the above code example, the
choice of <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span> as Mersenne primes, and with so many digits far
apart from each other, is a very bad choice in terms of cryptographic
security.  However, we shall use the above chosen numeric values for
<span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span> for the remainder of this tutorial, always bearing in mind
that they have been chosen for pedagogy purposes only.  Refer to
<a class="reference internal" href="#menezesetal1996" id="id5"><span>[MenezesEtAl1996]</span></a>,
<a class="reference internal" href="#stinson2006" id="id6"><span>[Stinson2006]</span></a>, and
<a class="reference internal" href="#trappewashington2006" id="id7"><span>[TrappeWashington2006]</span></a>
for in-depth discussions on the security of RSA, or consult other
specialized texts.</p>
<p>For step 2, we need to find a positive integer that is coprime to
<span class="math notranslate nohighlight">\(\varphi(n)\)</span>.  The set of integers is implemented within the Sage
module <code class="docutils literal notranslate"><span class="pre">sage.rings.integer_ring</span></code>.  Various operations on
integers can be accessed via the <code class="docutils literal notranslate"><span class="pre">ZZ.*</span></code> family of functions.
For instance, the command <code class="docutils literal notranslate"><span class="pre">ZZ.random_element(n)</span></code> returns a
pseudo-random integer uniformly distributed within the closed interval
<span class="math notranslate nohighlight">\([0, n-1]\)</span>.</p>
<p>We can compute the value <span class="math notranslate nohighlight">\(\varphi(n)\)</span> by calling the sage function
<code class="docutils literal notranslate"><span class="pre">euler_phi(n)</span></code>, but for arbitrarily large prime numbers <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span>,
this can take an enormous amount of time. Indeed, the private key
can be quickly deduced from the public key once you know <span class="math notranslate nohighlight">\(\varphi(n)\)</span>,
so it is an important part of the security of the RSA cryptosystem that
<span class="math notranslate nohighlight">\(\varphi(n)\)</span> cannot be computed in a short time, if only <span class="math notranslate nohighlight">\(n\)</span> is known.
On the other hand, if the private key is available, we can compute
<span class="math notranslate nohighlight">\(\varphi(n)=(p-1)(q-1)\)</span> in a very short time.</p>
<p>Using a simple programming loop, we can compute the
required value of <span class="math notranslate nohighlight">\(e\)</span> as follows:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">31</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">61</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span> <span class="n">phi</span>
<span class="go">4951760152529835076874141700</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">ZZ</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">while</span> <span class="n">gcd</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
<span class="gp">....: </span>    <span class="n">e</span> <span class="o">=</span> <span class="n">ZZ</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="go">...</span>
<span class="gp">sage: </span><span class="n">e</span>  <span class="c1"># random</span>
<span class="go">1850567623300615966303954877</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">&lt;</span> <span class="n">n</span>
<span class="go">True</span>
</pre></div>
</div>
<p>As <code class="docutils literal notranslate"><span class="pre">e</span></code> is a pseudo-random integer, its numeric value changes
after each execution of <code class="docutils literal notranslate"><span class="pre">e</span> <span class="pre">=</span> <span class="pre">ZZ.random_element(phi)</span></code>.</p>
<p>To calculate a value for <code class="docutils literal notranslate"><span class="pre">d</span></code> in step 3 of the RSA algorithm, we use
the extended Euclidean algorithm.  By definition of congruence,
<span class="math notranslate nohighlight">\(de \equiv 1 \pmod{\varphi(n)}\)</span> is equivalent to</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[de - k \cdot \varphi(n) = 1\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(k \in \ZZ\)</span>.  From steps 1 and 2, we already know the numeric
values of <span class="math notranslate nohighlight">\(e\)</span> and <span class="math notranslate nohighlight">\(\varphi(n)\)</span>.  The extended Euclidean algorithm
allows us to compute <span class="math notranslate nohighlight">\(d\)</span> and <span class="math notranslate nohighlight">\(-k\)</span>.  In Sage, this can be accomplished
via the command <code class="docutils literal notranslate"><span class="pre">xgcd</span></code>.  Given two integers <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>,
<code class="docutils literal notranslate"><span class="pre">xgcd(x,</span> <span class="pre">y)</span></code> returns a 3-tuple <code class="docutils literal notranslate"><span class="pre">(g,</span> <span class="pre">s,</span> <span class="pre">t)</span></code> that satisfies
the Bézout identity <span class="math notranslate nohighlight">\(g = \gcd(x,y) = sx + ty\)</span>.  Having computed a
value for <code class="docutils literal notranslate"><span class="pre">d</span></code>, we then use the command
<code class="docutils literal notranslate"><span class="pre">mod(d*e,</span> <span class="pre">phi)</span></code> to check that <code class="docutils literal notranslate"><span class="pre">d*e</span></code> is indeed congruent
to 1 modulo <code class="docutils literal notranslate"><span class="pre">phi</span></code>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">4951760154835678088235319297</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="mi">1850567623300615966303954877</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="mi">4951760152529835076874141700</span>
<span class="gp">sage: </span><span class="n">bezout</span> <span class="o">=</span> <span class="n">xgcd</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">phi</span><span class="p">);</span> <span class="n">bezout</span>  <span class="c1"># random</span>
<span class="go">(1, 4460824882019967172592779313, -1667095708515377925087033035)</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="n">mod</span><span class="p">(</span><span class="n">bezout</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">phi</span><span class="p">))</span> <span class="p">;</span> <span class="n">d</span>  <span class="c1"># random</span>
<span class="go">4460824882019967172592779313</span>
<span class="gp">sage: </span><span class="n">mod</span><span class="p">(</span><span class="n">d</span> <span class="o">*</span> <span class="n">e</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Thus, our RSA public key is</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[(n, e)
=
(4951760154835678088235319297,\, 1850567623300615966303954877)\]</div>
</div>
<p>and our corresponding private key is</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[(p, q, d)
=
(2147483647,\, 2305843009213693951,\, 4460824882019967172592779313)\]</div>
</div>
</section>
<section id="encryption-and-decryption">
<h2>Encryption and decryption<a class="headerlink" href="#encryption-and-decryption" title="Permalink to this heading">#</a></h2>
<p>Suppose we want to scramble the message <code class="docutils literal notranslate"><span class="pre">HELLOWORLD</span></code> using RSA
encryption.  From the above ASCII table, our message maps to integers
of the ASCII encodings as given below.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>+----------------------------------------+
| H   E   L   L   O   W   O   R   L   D  |
| 72  69  76  76  79  87  79  82  76  68 |
+----------------------------------------+
</pre></div>
</div>
<p>Concatenating all the integers in the last table, our message can be
represented by the integer</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[m = 72697676798779827668\]</div>
</div>
<p>There are other more cryptographically secure means for representing
our message as an integer.  The above process is used for
demonstration purposes only and we strongly discourage its use in
practice. In Sage, we can obtain an integer representation of our
message as follows:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="s2">&quot;HELLOWORLD&quot;</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="p">[</span><span class="nb">ord</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">m</span><span class="p">];</span> <span class="n">m</span>
<span class="go">[72, 69, 76, 76, 79, 87, 79, 82, 76, 68]</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">m</span><span class="p">)),</span> <span class="mi">100</span><span class="p">)</span> <span class="p">;</span> <span class="n">m</span>
<span class="go">72697676798779827668</span>
</pre></div>
</div>
<p>To encrypt our message, we raise <span class="math notranslate nohighlight">\(m\)</span> to the power of <span class="math notranslate nohighlight">\(e\)</span> and reduce
the result modulo <span class="math notranslate nohighlight">\(n\)</span>.  The command <code class="docutils literal notranslate"><span class="pre">mod(a^b,</span> <span class="pre">n)</span></code> first computes
<code class="docutils literal notranslate"><span class="pre">a^b</span></code> and then reduces the result modulo <code class="docutils literal notranslate"><span class="pre">n</span></code>.  If the exponent
<code class="docutils literal notranslate"><span class="pre">b</span></code> is a “large” integer, say with more than 20 digits, then
performing modular exponentiation in this naive manner takes quite
some time.  Brute force (or naive) modular exponentiation is
inefficient and, when performed using a computer, can quickly
consume a huge quantity of the computer’s memory or result in overflow
messages.  For instance, if we perform naive modular exponentiation
using the command <code class="docutils literal notranslate"><span class="pre">mod(m^e,</span> <span class="pre">n)</span></code>, where <code class="docutils literal notranslate"><span class="pre">m</span></code>, <code class="docutils literal notranslate"><span class="pre">n</span></code> and <code class="docutils literal notranslate"><span class="pre">e</span></code> are as
given above, we would get an error message similar to the following:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">mod(m^e, n)</span>
<span class="go">Traceback (most recent call last)</span>
<span class="go">...&lt;ipython console&gt; in &lt;module&gt;()</span>
<span class="go">.../sage/rings/integer.so</span>
<span class="go">in sage.rings.integer.Integer.__pow__ (sage/rings/integer.c:9650)()</span>
<span class="go">RuntimeError: exponent must be at most 2147483647</span>
</pre></div>
</div>
<p>There is a trick to efficiently perform modular exponentiation, called
the method of repeated squaring, cf. page 879 of <a class="reference internal" href="#cormenetal2001" id="id8"><span>[CormenEtAl2001]</span></a>.
Suppose we want to compute <span class="math notranslate nohighlight">\(a^b \mod n\)</span>.  First, let
<span class="math notranslate nohighlight">\(d \mathrel{\mathop:}= 1\)</span> and obtain the binary representation of <span class="math notranslate nohighlight">\(b\)</span>,
say <span class="math notranslate nohighlight">\((b_1, b_2, \dots, b_k)\)</span> where each <span class="math notranslate nohighlight">\(b_i \in \ZZ/2\ZZ\)</span>.  For
<span class="math notranslate nohighlight">\(i \mathrel{\mathop:}= 1, \dots, k\)</span>, let
<span class="math notranslate nohighlight">\(d \mathrel{\mathop:}= d^2 \mod n\)</span> and if <span class="math notranslate nohighlight">\(b_i = 1\)</span> then let
<span class="math notranslate nohighlight">\(d \mathrel{\mathop:}= da \mod n\)</span>.  This algorithm is implemented in
the function <code class="docutils literal notranslate"><span class="pre">power_mod</span></code>. We now use the function <code class="docutils literal notranslate"><span class="pre">power_mod</span></code> to
encrypt our message:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="mi">72697676798779827668</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="mi">1850567623300615966303954877</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">4951760154835678088235319297</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">power_mod</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span> <span class="n">c</span>
<span class="go">630913632577520058415521090</span>
</pre></div>
</div>
<p>Thus <span class="math notranslate nohighlight">\(c = 630913632577520058415521090\)</span> is the ciphertext.  To recover
our plaintext, we raise <code class="docutils literal notranslate"><span class="pre">c</span></code> to the power of <code class="docutils literal notranslate"><span class="pre">d</span></code> and reduce the
result modulo <code class="docutils literal notranslate"><span class="pre">n</span></code>.  Again, we use modular exponentiation via
repeated squaring in the decryption process:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="mi">72697676798779827668</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="mi">630913632577520058415521090</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="mi">4460824882019967172592779313</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">4951760154835678088235319297</span>
<span class="gp">sage: </span><span class="n">power_mod</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="go">72697676798779827668</span>
<span class="gp">sage: </span><span class="n">power_mod</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">==</span> <span class="n">m</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Notice in the last output that the value 72697676798779827668 is the
same as the integer that represents our original message.  Hence we
have recovered our plaintext.</p>
</section>
<section id="acknowledgements">
<h2>Acknowledgements<a class="headerlink" href="#acknowledgements" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>2009-07-25: Ron Evans (Department of Mathematics, UCSD) reported
a typo in the definition of greatest common divisors. The revised
definition incorporates his suggestions.</p></li>
<li><p>2008-11-04: Martin Albrecht (Information Security Group, Royal
Holloway, University of London), John Cremona (Mathematics
Institute, University of Warwick) and William Stein (Department of
Mathematics, University of Washington) reviewed this tutorial. Many
of their invaluable suggestions have been incorporated into this
document.</p></li>
</ol>
</section>
<section id="bibliography">
<h2>Bibliography<a class="headerlink" href="#bibliography" title="Permalink to this heading">#</a></h2>
<div role="list" class="citation-list">
<div class="citation" id="cormenetal2001" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id8">CormenEtAl2001</a><span class="fn-bracket">]</span></span>
<p>T. H. Cormen, C. E. Leiserson, R. L. Rivest, and
C. Stein. <em>Introduction to Algorithms</em>. The MIT Press, USA, 2nd
edition, 2001.</p>
</div>
<div class="citation" id="menezesetal1996" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>MenezesEtAl1996<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id1">1</a>,<a role="doc-backlink" href="#id5">2</a>)</span>
<p>A. J. Menezes, P. C. van Oorschot, and
S. A. Vanstone. <em>Handbook of Applied Cryptography</em>. CRC Press, Boca
Raton, FL, USA, 1996.</p>
</div>
<div class="citation" id="stinson2006" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Stinson2006<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id2">1</a>,<a role="doc-backlink" href="#id6">2</a>)</span>
<p>D. R. Stinson. <em>Cryptography: Theory and Practice</em>.
Chapman &amp; Hall/CRC, Boca Raton, USA, 3rd edition, 2006.</p>
</div>
<div class="citation" id="trappewashington2006" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>TrappeWashington2006<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id3">1</a>,<a role="doc-backlink" href="#id4">2</a>,<a role="doc-backlink" href="#id7">3</a>)</span>
<p>W. Trappe and L. C. Washington. <em>Introduction
to Cryptography with Coding Theory</em>. Pearson Prentice Hall, Upper
Saddle River, New Jersey, USA, 2nd edition, 2006.</p>
</div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="coding_theory.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Coding Theory in Sage</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="linear_programming.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Linear Programming (Mixed Integer)</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2023, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Number Theory and the RSA Public Key Cryptosystem</a><ul>
<li><a class="reference internal" href="#elementary-number-theory">Elementary number theory</a><ul>
<li><a class="reference internal" href="#prime-numbers">Prime numbers</a></li>
<li><a class="reference internal" href="#greatest-common-divisors">Greatest common divisors</a></li>
<li><a class="reference internal" href="#congruences">Congruences</a></li>
<li><a class="reference internal" href="#euler-s-phi-function">Euler’s phi function</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-keep-a-secret">How to keep a secret?</a></li>
<li><a class="reference internal" href="#keeping-a-secret-with-two-keys">Keeping a secret with two keys</a></li>
<li><a class="reference internal" href="#generating-public-and-private-keys">Generating public and private keys</a></li>
<li><a class="reference internal" href="#encryption-and-decryption">Encryption and decryption</a></li>
<li><a class="reference internal" href="#acknowledgements">Acknowledgements</a></li>
<li><a class="reference internal" href="#bibliography">Bibliography</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "lcm": "\\mathop{\\operatorname{lcm}}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <script src="_static/jupyter-sphinx-furo.js"></script>
    </body>
</html>