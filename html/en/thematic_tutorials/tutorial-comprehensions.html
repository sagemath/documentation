<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=600, initial-scale=1">
    <title>Tutorial: Comprehensions, Iterators, and Iterables &mdash; Thematic Tutorials v7.4</title>
    
    <link rel="stylesheet" href="_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '7.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="Thematic Tutorials v7.4" href="index.html" />
    <link rel="up" title="Thematic tutorial document tree" href="toctree.html" />
    <link rel="next" title="Tutorial: Objects and Classes in Python and Sage" href="tutorial-objects-and-classes.html" />
    <link rel="prev" title="Tutorial: Programming in Python and Sage" href="tutorial-programming-python.html" />
    <link rel="icon" href="_static/sageicon.png" type="image/x-icon" />
    <script src="_static/thebe.js" type="text/javascript"></script>
    <script src="_static/thebe-sage.js" type="text/javascript"></script>

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="tutorial-objects-and-classes.html" title="Tutorial: Objects and Classes in Python and Sage"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tutorial-programming-python.html" title="Tutorial: Programming in Python and Sage"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../index.html"><img src="_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="index.html">Thematic Tutorials v7.4</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="toctree.html" accesskey="U">Thematic tutorial document tree</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tutorial-comprehensions-iterators-and-iterables">
<span id="tutorial-comprehensions"></span><h1>Tutorial: Comprehensions, Iterators, and Iterables<a class="headerlink" href="#tutorial-comprehensions-iterators-and-iterables" title="Permalink to this headline">¶</a></h1>
<p><em>Author: Florent Hivert &lt;<a class="reference external" href="mailto:florent&#46;hivert&#37;&#52;&#48;univ-rouen&#46;fr">florent<span>&#46;</span>hivert<span>&#64;</span>univ-rouen<span>&#46;</span>fr</a>&gt; and
Nicolas M. Thiéry &lt;nthiery at users.sf.net&gt;</em></p>
<div class="section" id="list-comprehensions">
<h2>List comprehensions<a class="headerlink" href="#list-comprehensions" title="Permalink to this headline">¶</a></h2>
<p><em>List comprehensions</em> are a very handy way to construct lists in
Python. You can use either of the following idioms:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="o">&lt;</span><span class="n">expr</span><span class="o">&gt;</span> <span class="k">for</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">iterable</span><span class="o">&gt;</span> <span class="p">]</span>
<span class="p">[</span> <span class="o">&lt;</span><span class="n">expr</span><span class="o">&gt;</span> <span class="k">for</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">iterable</span><span class="o">&gt;</span> <span class="k">if</span> <span class="o">&lt;</span><span class="n">condition</span><span class="o">&gt;</span> <span class="p">]</span>
</pre></div>
</div>
<p>For example, here are some lists of squares:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span> <span class="n">i</span><span class="o">^</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span> <span class="p">]</span>
<span class="go">[1, 9, 49]</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="n">i</span><span class="o">^</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>
<span class="go">[1, 4, 9, 16, 25, 36, 49, 64, 81]</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="n">i</span><span class="o">^</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
<span class="go">[1, 9, 25, 49, 81]</span>
</pre></div>
</div>
<p>And a variant on the latter:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">i</span><span class="o">^</span><span class="mi">2</span> <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="go">[2, 1, 2, 9, 2, 25, 2, 49, 2, 81]</span>
</pre></div>
</div>
<div class="topic">
<p class="topic-title first">Exercises</p>
<ol class="arabic">
<li><p class="first">Construct the list of the squares of the prime integers between 1 and 10:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># edit here</span>
</pre></div>
</div>
</li>
<li><p class="first">Construct the list of the perfect squares less than 100 (hint: use
<a class="reference external" href="../reference/misc/sage/arith/srange.html#sage.arith.srange.srange" title="(in Sage Reference Manual: Utilities v7.4)"><code class="xref py py-func docutils literal"><span class="pre">srange()</span></code></a> to get a list of Sage integers together with the
method <code class="docutils literal"><span class="pre">i.sqrtrem()</span></code>):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># edit here</span>
</pre></div>
</div>
</li>
</ol>
</div>
<p>One can use more than one iterable in a list comprehension:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="p">]</span>
<span class="go">[(2, 1), (3, 1), (3, 2), (4, 1), (4, 2), (4, 3), (5, 1), (5, 2), (5, 3), (5, 4)]</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Mind the order of the nested loop in the previous expression.</p>
</div>
<p>If instead one wants to build a list of lists, one can use nested lists as in:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span> <span class="p">[</span> <span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>
<span class="go">[[1],</span>
<span class="go">[1, 1],</span>
<span class="go">[1, 2, 1],</span>
<span class="go">[1, 3, 3, 1],</span>
<span class="go">[1, 4, 6, 4, 1],</span>
<span class="go">[1, 5, 10, 10, 5, 1],</span>
<span class="go">[1, 6, 15, 20, 15, 6, 1],</span>
<span class="go">[1, 7, 21, 35, 35, 21, 7, 1],</span>
<span class="go">[1, 8, 28, 56, 70, 56, 28, 8, 1],</span>
<span class="go">[1, 9, 36, 84, 126, 126, 84, 36, 9, 1]]</span>
</pre></div>
</div>
<div class="topic">
<p class="topic-title first">Exercises</p>
<ol class="arabic">
<li><p class="first">Compute the list of pairs <span class="math">\((i,j)\)</span> of non negative integers such
that <code class="docutils literal"><span class="pre">i</span></code> is at most <span class="math">\(5\)</span>, <code class="docutils literal"><span class="pre">j</span></code> is at most <code class="docutils literal"><span class="pre">8</span></code>, and <code class="docutils literal"><span class="pre">i</span></code> and
<code class="docutils literal"><span class="pre">j</span></code> are co-prime:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># edit here</span>
</pre></div>
</div>
</li>
<li><p class="first">Compute the same list for <span class="math">\(i &lt; j &lt; 10\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># edit here</span>
</pre></div>
</div>
</li>
</ol>
</div>
</div>
<div class="section" id="iterators">
<h2>Iterators<a class="headerlink" href="#iterators" title="Permalink to this headline">¶</a></h2>
<div class="section" id="definition">
<h3>Definition<a class="headerlink" href="#definition" title="Permalink to this headline">¶</a></h3>
<p>To build a comprehension, Python actually uses an <em>iterator</em>. This is
a device which runs through a bunch of objects, returning one at each
call to the <code class="docutils literal"><span class="pre">next</span></code> method. Iterators are built using parentheses:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">it</span> <span class="o">=</span> <span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<span class="go">8</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<span class="go">28</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<span class="go">56</span>
</pre></div>
</div>
<p>You can get the list of the results that are not yet <em>consumed</em>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<span class="go">[70, 56, 28, 8, 1]</span>
</pre></div>
</div>
<p>Asking for more elements triggers a <code class="docutils literal"><span class="pre">StopIteration</span></code> exception:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">StopIteration</span>
</pre></div>
</div>
<p>An iterator can be used as argument for a function. The two following
idioms give the same results; however, the second idiom is much more
memory efficient (for large examples) as it does not expand any list
in memory:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span> <span class="p">[</span> <span class="n">binomial</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="p">]</span> <span class="p">)</span>
<span class="go">256</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span> <span class="n">binomial</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="p">)</span>
<span class="go">256</span>
</pre></div>
</div>
<div class="topic">
<p class="topic-title first">Exercises</p>
<ol class="arabic">
<li><p class="first">Compute the sum of <span class="math">\(\binom{10}{i}\)</span> for all even <span class="math">\(i\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># edit here</span>
</pre></div>
</div>
</li>
<li><p class="first">Compute the sum of the gcd&#8217;s of all co-prime numbers <span class="math">\(i, j\)</span> for <span class="math">\(i&lt;j&lt;10\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># edit here</span>
</pre></div>
</div>
</li>
</ol>
</div>
</div>
<div class="section" id="typical-usage-of-iterators">
<h3>Typical usage of iterators<a class="headerlink" href="#typical-usage-of-iterators" title="Permalink to this headline">¶</a></h3>
<p>Iterators are very handy with the functions <a class="reference external" href="https://docs.python.org/library/functions.html#all" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">all()</span></code></a>, <a class="reference external" href="https://docs.python.org/library/functions.html#any" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">any()</span></code></a>,
and <a class="reference external" href="../reference/misc/sage/misc/misc.html#sage.misc.misc.exists" title="(in Sage Reference Manual: Utilities v7.4)"><code class="xref py py-func docutils literal"><span class="pre">exists()</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">all</span><span class="p">([</span><span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">([</span><span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">])</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">any</span><span class="p">([</span><span class="bp">False</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">False</span><span class="p">])</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="nb">any</span><span class="p">([</span><span class="bp">False</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Let&#8217;s check that all the prime numbers larger than 2 are odd:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span> <span class="n">is_odd</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_prime</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="ow">and</span> <span class="n">p</span><span class="o">&gt;</span><span class="mi">2</span> <span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>It is well know that if <code class="docutils literal"><span class="pre">2^p-1</span></code> is prime then <code class="docutils literal"><span class="pre">p</span></code> is prime:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">def</span> <span class="nf">mersenne</span><span class="p">(</span><span class="n">p</span><span class="p">):</span> <span class="k">return</span> <span class="mi">2</span><span class="o">^</span><span class="n">p</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="n">is_prime</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_prime</span><span class="p">(</span><span class="n">mersenne</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="p">]</span>
<span class="go">[True, True, True, True, True, True, True]</span>
</pre></div>
</div>
<p>The converse is not true:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span> <span class="n">is_prime</span><span class="p">(</span><span class="n">mersenne</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_prime</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Using a list would be much slower here:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="o">%</span><span class="n">time</span> <span class="nb">all</span><span class="p">(</span> <span class="n">is_prime</span><span class="p">(</span><span class="n">mersenne</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_prime</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="p">)</span>    <span class="c1"># not tested</span>
<span class="go">CPU times: user 0.00 s, sys: 0.00 s, total: 0.00 s</span>
<span class="go">Wall time: 0.00 s</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="o">%</span><span class="n">time</span> <span class="nb">all</span><span class="p">(</span> <span class="p">[</span> <span class="n">is_prime</span><span class="p">(</span><span class="n">mersenne</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_prime</span><span class="p">(</span><span class="n">p</span><span class="p">)]</span> <span class="p">)</span> <span class="c1"># not tested</span>
<span class="go">CPU times: user 0.72 s, sys: 0.00 s, total: 0.73 s</span>
<span class="go">Wall time: 0.73 s</span>
<span class="go">False</span>
</pre></div>
</div>
<p>You can get the counterexample using <a class="reference external" href="../reference/misc/sage/misc/misc.html#sage.misc.misc.exists" title="(in Sage Reference Manual: Utilities v7.4)"><code class="xref py py-func docutils literal"><span class="pre">exists()</span></code></a>. It takes two
arguments: an iterator and a function which tests the property that
should hold:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">exists</span><span class="p">(</span> <span class="p">(</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_prime</span><span class="p">(</span><span class="n">p</span><span class="p">)),</span> <span class="k">lambda</span> <span class="n">p</span><span class="p">:</span> <span class="ow">not</span> <span class="n">is_prime</span><span class="p">(</span><span class="n">mersenne</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="p">)</span>
<span class="go">(True, 11)</span>
</pre></div>
</div>
<p>An alternative way to achieve this is:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">counter_examples</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_prime</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_prime</span><span class="p">(</span><span class="n">mersenne</span><span class="p">(</span><span class="n">p</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">counter_examples</span><span class="p">)</span>
<span class="go">11</span>
</pre></div>
</div>
<div class="topic">
<p class="topic-title first">Exercises</p>
<ol class="arabic">
<li><p class="first">Build the list <span class="math">\(\{i^3 \mid -10&lt;i&lt;10\}\)</span>. Can you find two of those
cubes <span class="math">\(u\)</span> and <span class="math">\(v\)</span> such that <span class="math">\(u + v = 218\)</span>?</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># edit here</span>
</pre></div>
</div>
</li>
</ol>
</div>
</div>
<div class="section" id="itertools">
<h3>itertools<a class="headerlink" href="#itertools" title="Permalink to this headline">¶</a></h3>
<p>At its name suggests <a class="reference external" href="https://docs.python.org/library/itertools.html#module-itertools" title="(in Python v2.7)"><code class="xref py py-mod docutils literal"><span class="pre">itertools</span></code></a> is a module which defines
several handy tools for manipulating iterators:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">234</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">23</span><span class="p">]</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">))]</span>
<span class="go">[(0, 3), (1, 234), (2, 12), (3, 53), (4, 23)]</span>
</pre></div>
</div>
<p>The same results can be obtained using <a class="reference external" href="https://docs.python.org/library/functions.html#enumerate" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">enumerate()</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
<span class="go">[(0, 3), (1, 234), (2, 12), (3, 53), (4, 23)]</span>
</pre></div>
</div>
<p>Here is the analogue of list slicing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">Permutations</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">[[1, 2, 3], [1, 3, 2], [2, 1, 3], [2, 3, 1], [3, 1, 2], [3, 2, 1]]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">Permutations</span><span class="p">(</span><span class="mi">3</span><span class="p">))[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
<span class="go">[[1, 3, 2], [2, 1, 3], [2, 3, 1]]</span>

<span class="gp">sage: </span><span class="kn">import</span> <span class="nn">itertools</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">islice</span><span class="p">(</span><span class="n">Permutations</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="go">[[1, 3, 2], [2, 1, 3], [2, 3, 1]]</span>
</pre></div>
</div>
<p>The behaviour of the functions <a class="reference external" href="https://docs.python.org/library/functions.html#map" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">map()</span></code></a> and <a class="reference external" href="https://docs.python.org/library/functions.html#filter" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">filter()</span></code></a> has
changed between Python 2 and Python 3. In Python 3, they return an
iterator. If you want to use this new behaviour in Python 2, and keep
your code compatible with Python3, you can use the compatibility
library <code class="docutils literal"><span class="pre">six</span></code> as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">six.moves</span> <span class="kn">import</span> <span class="nb">map</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="n">z</span><span class="o">.</span><span class="n">cycle_type</span><span class="p">(),</span> <span class="n">Permutations</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<span class="go">[[1, 1, 1], [2, 1], [2, 1], [3], [3], [2, 1]]</span>

<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">six.moves</span> <span class="kn">import</span> <span class="nb">filter</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="n">z</span><span class="o">.</span><span class="n">has_pattern</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="n">Permutations</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<span class="go">[[1, 2, 3], [1, 3, 2], [2, 1, 3], [2, 3, 1], [3, 1, 2]]</span>
</pre></div>
</div>
<div class="topic">
<p class="topic-title first">Exercises</p>
<ol class="arabic">
<li><p class="first">Define an iterator for the <span class="math">\(i\)</span>-th prime for <span class="math">\(5&lt;i&lt;10\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># edit here</span>
</pre></div>
</div>
</li>
</ol>
</div>
</div>
<div class="section" id="defining-new-iterators">
<h3>Defining new iterators<a class="headerlink" href="#defining-new-iterators" title="Permalink to this headline">¶</a></h3>
<p>One can very easily write new iterators using the keyword
<code class="docutils literal"><span class="pre">yield</span></code>. The following function does nothing interesting beyond
demonstrating the use of <code class="docutils literal"><span class="pre">yield</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="go">....:   for i in range(n):</span>
<span class="go">....:       yield i</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="n">u</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">f</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">]</span>
<span class="go">[0, 1, 2, 3, 4]</span>
</pre></div>
</div>
<p>Iterators can be recursive:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">def</span> <span class="nf">words</span><span class="p">(</span><span class="n">alphabet</span><span class="p">,</span><span class="n">l</span><span class="p">):</span>
<span class="go">....:    if l == 0:</span>
<span class="go">....:        yield []</span>
<span class="go">....:    else:</span>
<span class="go">....:        for word in words(alphabet, l-1):</span>
<span class="go">....:            for a in alphabet:</span>
<span class="go">....:                yield word + [a]</span>

<span class="gp">sage: </span><span class="p">[</span> <span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="mi">3</span><span class="p">)</span> <span class="p">]</span>
<span class="go">[[&#39;a&#39;, &#39;a&#39;, &#39;a&#39;], [&#39;a&#39;, &#39;a&#39;, &#39;b&#39;], [&#39;a&#39;, &#39;a&#39;, &#39;c&#39;], [&#39;a&#39;, &#39;b&#39;, &#39;a&#39;], [&#39;a&#39;, &#39;b&#39;, &#39;b&#39;], [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], [&#39;a&#39;, &#39;c&#39;, &#39;a&#39;], [&#39;a&#39;, &#39;c&#39;, &#39;b&#39;], [&#39;a&#39;, &#39;c&#39;, &#39;c&#39;], [&#39;b&#39;, &#39;a&#39;, &#39;a&#39;], [&#39;b&#39;, &#39;a&#39;, &#39;b&#39;], [&#39;b&#39;, &#39;a&#39;, &#39;c&#39;], [&#39;b&#39;, &#39;b&#39;, &#39;a&#39;], [&#39;b&#39;, &#39;b&#39;, &#39;b&#39;], [&#39;b&#39;, &#39;b&#39;, &#39;c&#39;], [&#39;b&#39;, &#39;c&#39;, &#39;a&#39;], [&#39;b&#39;, &#39;c&#39;, &#39;b&#39;], [&#39;b&#39;, &#39;c&#39;, &#39;c&#39;], [&#39;c&#39;, &#39;a&#39;, &#39;a&#39;], [&#39;c&#39;, &#39;a&#39;, &#39;b&#39;], [&#39;c&#39;, &#39;a&#39;, &#39;c&#39;], [&#39;c&#39;, &#39;b&#39;, &#39;a&#39;], [&#39;c&#39;, &#39;b&#39;, &#39;b&#39;], [&#39;c&#39;, &#39;b&#39;, &#39;c&#39;], [&#39;c&#39;, &#39;c&#39;, &#39;a&#39;], [&#39;c&#39;, &#39;c&#39;, &#39;b&#39;], [&#39;c&#39;, &#39;c&#39;, &#39;c&#39;]]</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="mi">3</span><span class="p">))</span>
<span class="go">27</span>
</pre></div>
</div>
<p>Here is another recursive iterator:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">def</span> <span class="nf">dyck_words</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
<span class="go">....:     if l==0:</span>
<span class="go">....:         yield &#39;&#39;</span>
<span class="go">....:     else:</span>
<span class="go">....:         for k in range(l):</span>
<span class="go">....:             for w1 in dyck_words(k):</span>
<span class="go">....:                 for w2 in dyck_words(l-k-1):</span>
<span class="go">....:                     yield &#39;(&#39;+w1+&#39;)&#39;+w2</span>

<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">dyck_words</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="go">[&#39;()()()()&#39;,</span>
<span class="go">&#39;()()(())&#39;,</span>
<span class="go">&#39;()(())()&#39;,</span>
<span class="go">&#39;()(()())&#39;,</span>
<span class="go">&#39;()((()))&#39;,</span>
<span class="go">&#39;(())()()&#39;,</span>
<span class="go">&#39;(())(())&#39;,</span>
<span class="go">&#39;(()())()&#39;,</span>
<span class="go">&#39;((()))()&#39;,</span>
<span class="go">&#39;(()()())&#39;,</span>
<span class="go">&#39;(()(()))&#39;,</span>
<span class="go">&#39;((())())&#39;,</span>
<span class="go">&#39;((()()))&#39;,</span>
<span class="go">&#39;(((())))&#39;]</span>

<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">dyck_words</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">42</span>
</pre></div>
</div>
<div class="topic">
<p class="topic-title first">Exercises</p>
<ol class="arabic">
<li><p class="first">Write an iterator with two parameters <span class="math">\(n\)</span>, <span class="math">\(l\)</span> iterating
through the set of nondecreasing lists of integers smaller
than <span class="math">\(n\)</span> of length <span class="math">\(l\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># edit here</span>
</pre></div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="section" id="standard-iterables">
<h2>Standard Iterables<a class="headerlink" href="#standard-iterables" title="Permalink to this headline">¶</a></h2>
<p>Finally, many standard Python and Sage objects are <em>iterable</em>; that is
one may iterate through their elements:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span> <span class="n">x</span><span class="o">^</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">Subsets</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="p">)</span>
<span class="go">x^8 + 8*x^7 + 28*x^6 + 56*x^5 + 70*x^4 + 56*x^3 + 28*x^2 + 8*x + 1</span>

<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span> <span class="n">x</span><span class="o">^</span><span class="n">p</span><span class="o">.</span><span class="n">length</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">Permutations</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span>
<span class="go">x^3 + 2*x^2 + 2*x + 1</span>

<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span> <span class="n">x</span><span class="o">^</span><span class="n">p</span><span class="o">.</span><span class="n">length</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">Permutations</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">))</span>
<span class="go">(x^2 + x + 1)*(x + 1)</span>

<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">Permutations</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">P</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">P</span> <span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">GL</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="k">print</span><span class="p">(</span><span class="n">p</span><span class="p">);</span> <span class="k">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="go">[1 0]</span>
<span class="go">[0 1]</span>

<span class="go">[0 1]</span>
<span class="go">[1 0]</span>

<span class="go">[0 1]</span>
<span class="go">[1 1]</span>

<span class="go">[1 1]</span>
<span class="go">[0 1]</span>

<span class="go">[1 1]</span>
<span class="go">[1 0]</span>

<span class="go">[1 0]</span>
<span class="go">[1 1]</span>


<span class="gp">sage: </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">Partitions</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span> <span class="k">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">[3]</span>
<span class="go">[2, 1]</span>
<span class="go">[1, 1, 1]</span>
</pre></div>
</div>
<p>Beware of infinite loops:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">Partitions</span><span class="p">():</span> <span class="k">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>          <span class="c1"># not tested</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">Primes</span><span class="p">():</span> <span class="k">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>              <span class="c1"># not tested</span>
</pre></div>
</div>
<p>Infinite loops can nevertheless be very useful:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">exists</span><span class="p">(</span> <span class="n">Primes</span><span class="p">(),</span> <span class="k">lambda</span> <span class="n">p</span><span class="p">:</span> <span class="ow">not</span> <span class="n">is_prime</span><span class="p">(</span><span class="n">mersenne</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="p">)</span>
<span class="go">(True, 11)</span>


<span class="gp">sage: </span><span class="n">counter_examples</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">Primes</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_prime</span><span class="p">(</span><span class="n">mersenne</span><span class="p">(</span><span class="n">p</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">counter_examples</span><span class="p">)</span>
<span class="go">11</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">Tutorial: Comprehensions, Iterators, and Iterables</a><ul>
<li><a class="reference internal" href="#list-comprehensions">List comprehensions</a></li>
<li><a class="reference internal" href="#iterators">Iterators</a><ul>
<li><a class="reference internal" href="#definition">Definition</a></li>
<li><a class="reference internal" href="#typical-usage-of-iterators">Typical usage of iterators</a></li>
<li><a class="reference internal" href="#itertools">itertools</a></li>
<li><a class="reference internal" href="#defining-new-iterators">Defining new iterators</a></li>
</ul>
</li>
<li><a class="reference internal" href="#standard-iterables">Standard Iterables</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="tutorial-programming-python.html"
                                  title="previous chapter">Tutorial: Programming in Python and Sage</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="tutorial-objects-and-classes.html"
                                  title="next chapter">Tutorial: Objects and Classes in Python and Sage</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/tutorial-comprehensions.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <!-- The shading of the "Go" button should be consistent -->
                <!-- with the colour of the header and footer. See the file -->
                <!-- doc/common/themes/sage/theme.conf for colours used by -->
                <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="tutorial-objects-and-classes.html" title="Tutorial: Objects and Classes in Python and Sage"
             >next</a> |</li>
        <li class="right" >
          <a href="tutorial-programming-python.html" title="Tutorial: Programming in Python and Sage"
             >previous</a> |</li>
  
    
      <a href="../index.html"><img src="_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="index.html">Thematic Tutorials v7.4</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="toctree.html" >Thematic tutorial document tree</a> &raquo;</li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &copy; Copyright 2005--2016, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.4.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>