<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Affine Root System Basics" href="affine.html" /><link rel="prev" title="Weyl Groups, Coxeter Groups and the Bruhat Order" href="weyl_groups.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>Classical Crystals - Thematic Tutorials</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom-furo.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZGD13B5572"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-ZGD13B5572');
</script></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Thematic Tutorials</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 9.8 Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../index.html">Home - Thematic Tutorials</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../toctree.html">Thematic tutorial document tree</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../algebraic_combinatorics.html">Algebraic Combinatorics in Sage</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../algebraic_combinatorics/walks.html">Walks in graphs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../algebraic_combinatorics/n_cube.html"><span class="math notranslate nohighlight">\(n\)</span>-Cube</a></li>
<li class="toctree-l3"><a class="reference internal" href="../algebraic_combinatorics/tsetlin_library.html">The Tsetlin library</a></li>
<li class="toctree-l3"><a class="reference internal" href="../algebraic_combinatorics/rsk.html">Young’s lattice and the RSK algorithm</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../sandpile.html">Abelian Sandpile Model</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../group_theory.html">Group Theory and Sage</a></li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="../lie.html">Lie Methods and Related Combinatorics in Sage</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="introduction.html">The Scope of this Document</a></li>
<li class="toctree-l3"><a class="reference internal" href="lie_basics.html">Lie Group Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="weyl_character_ring.html">The Weyl Character Ring</a></li>
<li class="toctree-l3"><a class="reference internal" href="branching_rules.html">Maximal Subgroups and Branching Rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="weyl_groups.html">Weyl Groups, Coxeter Groups and the Bruhat Order</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Classical Crystals</a></li>
<li class="toctree-l3"><a class="reference internal" href="affine.html">Affine Root System Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="integrable.html">Integrable Highest Weight Representations of Affine Lie algebras</a></li>
<li class="toctree-l3"><a class="reference internal" href="affine_finite_crystals.html">Affine Finite Crystals</a></li>
<li class="toctree-l3"><a class="reference internal" href="affine_hw_crystals.html">Affine Highest Weight Crystals</a></li>
<li class="toctree-l3"><a class="reference internal" href="elementary_crystals.html">Elementary crystals</a></li>
<li class="toctree-l3"><a class="reference internal" href="infinity_crystals.html">Infinity Crystals</a></li>
<li class="toctree-l3"><a class="reference internal" href="iwahori_hecke_algebra.html">Iwahori Hecke Algebras</a></li>
<li class="toctree-l3"><a class="reference internal" href="kazhdan_lusztig_polynomials.html">Kazhdan-Lusztig Polynomials</a></li>
<li class="toctree-l3"><a class="reference internal" href="bibliography.html">Bibliography</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../vector_calculus.html">Tutorial: Vector Calculus in Euclidean Spaces</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../vector_calculus/vector_calc_cartesian.html">How to compute a gradient, a divergence or a curl</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vector_calculus/vector_calc_curvilinear.html">How to perform vector calculus in curvilinear coordinates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vector_calculus/vector_calc_change.html">How to change coordinates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vector_calculus/vector_calc_advanced.html">Advanced aspects: the Euclidean space as a Riemannian manifold</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vector_calculus/vector_calc_plane.html">Vector calculus in the Euclidean plane</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../linear_programming.html">Linear Programming (Mixed Integer)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../numtheory_rsa.html">Number Theory and the RSA Public Key Cryptosystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../coding_theory.html">Coding Theory in Sage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../structures_in_coding_theory.html">How to write your own classes for coding theory</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../geometry.html">Polyhedra</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../geometry/polyhedra_quicktutorial.html">A Brief Introduction to Polytopes in Sage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/polyhedra_tutorial.html">A Longer Introduction to Polyhedral Computations in Sage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/polyhedra_quickref.html">Quick reference for polyhedra in Sage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/tips.html">Polyhedra tips and tricks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/visualization.html">Visualization of polyhedron objects in Sage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/polytope_tikz.html">Draw polytopes in LaTeX using TikZ</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../steenrod_algebra_modules.html">Steenrod Algebra Modules</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial-programming-python.html">Tutorial: Programming in Python and Sage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial-comprehensions.html">Tutorial: Comprehensions, Iterators, and Iterables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial-objects-and-classes.html">Tutorial: Objects and Classes in Python and Sage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../functional_programming.html">Functional Programming for Mathematicians</a></li>
<li class="toctree-l2"><a class="reference internal" href="../coercion_and_categories.html">How to implement new algebraic structures in Sage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial-implementing-algebraic-structures.html">Tutorial: Implementing Algebraic Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cython_interface.html">How to call a C code (or a compiled library) from Sage ?</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../numerical_sage/index.html">Numerical Computing with Sage</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../numerical_sage/numerical_tools.html">Numerical Tools</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../numerical_sage/numpy.html">NumPy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../numerical_sage/scipy.html">SciPy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../numerical_sage/cvxopt.html">Cvxopt</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../numerical_sage/using_compiled_code_iteractively.html">Using Compiled Code Interactively</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../numerical_sage/f2py.html">f2py</a></li>
<li class="toctree-l4"><a class="reference internal" href="../numerical_sage/f2py_examples.html">More Interesting Examples with f2py</a></li>
<li class="toctree-l4"><a class="reference internal" href="../numerical_sage/ctypes.html">Ctypes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../numerical_sage/ctypes_examples.html">More complicated ctypes example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../numerical_sage/comparison_to_cython.html">Comparison to Cython/Pyrex</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../numerical_sage/parallel_computation.html">Parallel Computation</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../numerical_sage/mpi4py.html">mpi4py</a></li>
<li class="toctree-l4"><a class="reference internal" href="../numerical_sage/parallel_laplace_solver.html">Parallel Laplace Solver</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../explicit_methods_in_number_theory/index.html">Three Lectures about Explicit Methods in Number Theory Using Sage</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../explicit_methods_in_number_theory/introduction.html">Introduction</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../explicit_methods_in_number_theory/number_fields.html">Number Fields</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/nf_introduction.html">Introduction to Number Fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/nf_galois_groups.html">Number Fields: Galois Groups and Class Groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/nf_orders.html">Orders and Relative Extensions</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../explicit_methods_in_number_theory/birds_eye_view.html">A Bird’s Eye View</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/integer_factorization.html">Integer Factorization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/elliptic_curves.html">Elliptic Curves</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/birds_other.html">The Matrix of Frobenius on Hyperelliptic Curves</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/birds_other.html#modular-symbols">Modular Symbols</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/birds_other.html#enumerating-totally-real-number-fields">Enumerating Totally Real Number Fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/birds_other.html#bernoulli-numbers">Bernoulli Numbers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/birds_other.html#polynomial-arithmetic">Polynomial Arithmetic</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../explicit_methods_in_number_theory/modular_forms.html">Modular Forms</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/modular_forms_and_hecke_operators.html">Modular Forms and Hecke Operators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/modular_symbols.html">Modular Symbols</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/method_of_graphs.html">Method of Graphs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/level_one_forms.html">Level One Modular Forms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/half_integral.html">Half Integral Weight Forms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/generators_for_rings.html">Generators for Rings of Modular Forms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/l_series.html"><span class="math notranslate nohighlight">\(L\)</span>-series</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/modabvar.html">Modular Abelian Varieties</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../profiling.html">Profiling in Sage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sws2rst.html">Creating a Tutorial from an old Sage Worksheet (.sws)</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="classical-crystals">
<h1>Classical Crystals<a class="headerlink" href="#classical-crystals" title="Permalink to this heading">#</a></h1>
<p>A classical crystal is one coming from the finite (classical) types
<span class="math notranslate nohighlight">\(A_r, B_r, C_r, D_r, E_{6,7,8}, F_4\)</span>, and <span class="math notranslate nohighlight">\(G_2\)</span>. Here we
describe some background before going into the general theory of crystals
and the type dependent combinatorics.</p>
<section id="tableaux-and-representations-of-gl-n">
<h2>Tableaux and representations of <span class="math notranslate nohighlight">\(GL(n)\)</span><a class="headerlink" href="#tableaux-and-representations-of-gl-n" title="Permalink to this heading">#</a></h2>
<p>Let <span class="math notranslate nohighlight">\(\lambda\)</span> be a partition. The <em>Young diagram</em> of <span class="math notranslate nohighlight">\(\lambda\)</span> is the
array of boxes having <span class="math notranslate nohighlight">\(\lambda_i\)</span> boxes in the <span class="math notranslate nohighlight">\(i\)</span>-th row, left
adjusted. Thus if <span class="math notranslate nohighlight">\(\lambda = (3, 2)\)</span> the diagram is:</p>
<a class="reference internal image-reference" href="../_images/tableau1.png"><img alt="../_images/tableau1.png" class="align-center" src="../_images/tableau1.png" style="width: 81.75px; height: 55.5px;" /></a>
<p>A <em>semi-standard Young tableau</em> of shape <span class="math notranslate nohighlight">\(\lambda\)</span> is a filling of the
box by integers in which the rows are weakly increasing and the
columns are strictly increasing. Thus</p>
<a class="reference internal image-reference" href="../_images/tableau2.png"><img alt="../_images/tableau2.png" class="align-center" src="../_images/tableau2.png" style="width: 81.75px; height: 55.5px;" /></a>
<p>is a semistandard Young tableau. Sage has a <a class="reference external" href="../../reference/combinat/sage/combinat/tableau.html#sage.combinat.tableau.Tableau" title="(in Combinatorics v9.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tableau</span></code></a> class,
and you may create this tableau as follows:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">Tableau</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]]);</span> <span class="n">T</span>
<span class="go">[[1, 2, 2], [2, 3]]</span>
</pre></div>
</div>
<p>A partition of length <span class="math notranslate nohighlight">\(\le r+1\)</span> is a dominant weight for
<span class="math notranslate nohighlight">\(GL(r+1, \mathbf{C})\)</span> according to the description of the ambient
space in <a class="reference internal" href="lie_basics.html#standard-realizations"><span class="std std-ref">Standard realizations of the ambient spaces</span></a>. Therefore it corresponds to an
irreducible representation <span class="math notranslate nohighlight">\(\pi_\lambda = \pi_\lambda^{GL(r+1)}\)</span> of
<span class="math notranslate nohighlight">\(GL(r+1, \mathbf{C})\)</span>.</p>
<p>It is true that not every dominant weight <span class="math notranslate nohighlight">\(\lambda\)</span> is a partition,
since a dominant weight might have some values <span class="math notranslate nohighlight">\(\lambda_i\)</span>
negative. The dominant weight <span class="math notranslate nohighlight">\(\lambda\)</span> is a partition if and only if
the character of <span class="math notranslate nohighlight">\(\lambda\)</span> is a polynomial as a function on the space
<span class="math notranslate nohighlight">\(\hbox{Mat}_n(\mathbf{C})\)</span>. Thus for example <span class="math notranslate nohighlight">\(\det^{-1} = \pi_\lambda\)</span>
with <span class="math notranslate nohighlight">\(\lambda = (-1, \dots, -1)\)</span>, which is a dominant weight but not
a partition, and the character is not a polynomial function on
<span class="math notranslate nohighlight">\(\hbox{Mat}_n(\mathbf{C})\)</span>.</p>
<p><strong>Theorem</strong> [Littlewood] If <span class="math notranslate nohighlight">\(\lambda\)</span> is a partition, then the number
of semi-standard Young tableaux with shape <span class="math notranslate nohighlight">\(\lambda\)</span> and entries in
<span class="math notranslate nohighlight">\(\{1,2,\ldots,r+1\}\)</span> is the dimension of <span class="math notranslate nohighlight">\(\pi_\lambda\)</span>.</p>
<p>For example, if <span class="math notranslate nohighlight">\(\lambda = (3,2)\)</span> and <span class="math notranslate nohighlight">\(r = 2\)</span>, then we find 15
tableaux with shape <span class="math notranslate nohighlight">\(\lambda\)</span> and entries in <span class="math notranslate nohighlight">\(\{1,2,3\}\)</span>:</p>
<a class="reference internal image-reference" href="../_images/tableaux.png"><img alt="../_images/tableaux.png" class="align-center" src="../_images/tableaux.png" style="width: 430.5px; height: 183.0px;" /></a>
<p>This is consistent with the theorem since the dimension of the
irreducible representation of <span class="math notranslate nohighlight">\(GL(3)\)</span> with highest weight <span class="math notranslate nohighlight">\((3,2,0)\)</span>
has dimension 15:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2</span> <span class="o">=</span> <span class="n">WeylCharacterRing</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A2</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">15</span>
</pre></div>
</div>
<p>In fact we may obtain the character of the representation from the set
of tableaux. Indeed, one of the definitions of the Schur polynomial
(due to Littlewood) is the following combinatorial one. If <span class="math notranslate nohighlight">\(T\)</span> is a
tableaux, define the <em>weight</em> of <span class="math notranslate nohighlight">\(T\)</span> to be
<span class="math notranslate nohighlight">\(\hbox{wt}(T) = (k_1,\dots,k_n)\)</span> where <span class="math notranslate nohighlight">\(k_i\)</span> is the number of <span class="math notranslate nohighlight">\(i\)</span>’s
in the tableaux. Then the multiplicity of <span class="math notranslate nohighlight">\(\mu\)</span> in the character
<span class="math notranslate nohighlight">\(\chi_\lambda\)</span> is the number of tableaux of weight <span class="math notranslate nohighlight">\(\lambda\)</span>. Thus if
<span class="math notranslate nohighlight">\(\mathbf{z} = (z_1,\dots,z_n)\)</span>, we have</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\chi_\lambda(\mathbf{z}) = \sum_T \mathbf{z}^{\hbox{wt}(T)}\]</div>
</div>
<p>where the sum is over all semi-standard Young tableaux of shape
<span class="math notranslate nohighlight">\(\lambda\)</span> that have entries in <span class="math notranslate nohighlight">\(\{1, 2, \ldots, r+1\}\)</span>.</p>
</section>
<section id="frobenius-schur-duality">
<h2>Frobenius-Schur Duality<a class="headerlink" href="#frobenius-schur-duality" title="Permalink to this heading">#</a></h2>
<p>Frobenius-Schur duality is a relationship between the representation
theories of the symmetric group and general linear group. We will relate this
to tableaux in the next section.</p>
<p>Representations of the symmetric group <span class="math notranslate nohighlight">\(S_k\)</span> are parametrized by
partitions <span class="math notranslate nohighlight">\(\lambda\)</span> of <span class="math notranslate nohighlight">\(k\)</span>. The parametrization may be characterized
as follows. Let <span class="math notranslate nohighlight">\(n\)</span> be any integer <span class="math notranslate nohighlight">\(\ge k\)</span>. Then both
<span class="math notranslate nohighlight">\(GL(n,\mathbf{C})\)</span> and <span class="math notranslate nohighlight">\(S_k\)</span> act on <span class="math notranslate nohighlight">\(\otimes^k V\)</span> where
<span class="math notranslate nohighlight">\(V = \mathbf{C}^n\)</span>. Indeed, <span class="math notranslate nohighlight">\(GL(n)\)</span> acts on each <span class="math notranslate nohighlight">\(V\)</span> and <span class="math notranslate nohighlight">\(S_k\)</span>
permutes them. Then if <span class="math notranslate nohighlight">\(\pi_\lambda^{GL(n)}\)</span> is the representation of
<span class="math notranslate nohighlight">\(GL(n,\mathbf{C})\)</span> with highest weight vector <span class="math notranslate nohighlight">\(\lambda\)</span> and
<span class="math notranslate nohighlight">\(\pi_\lambda^{S_k}\)</span> is the irreducible representation of <span class="math notranslate nohighlight">\(S_k\)</span>
parametrized by <span class="math notranslate nohighlight">\(\lambda\)</span> then</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\otimes^k V
\cong
\bigoplus_{\lambda\vdash k}\pi^{GL(n)}_\lambda\otimes\pi^{S_k}_\lambda\]</div>
</div>
<p>as bimodules for the two groups. This is <em>Frobenius-Schur duality</em> and
it serves to characterize the parametrization of the irreducible
representations of <span class="math notranslate nohighlight">\(S_k\)</span> by partitions of <span class="math notranslate nohighlight">\(k\)</span>.</p>
</section>
<section id="counting-pairs-of-tableaux">
<h2>Counting pairs of tableaux<a class="headerlink" href="#counting-pairs-of-tableaux" title="Permalink to this heading">#</a></h2>
<p>In both the representation theory of <span class="math notranslate nohighlight">\(GL(n)\)</span> and the representation
theory of <span class="math notranslate nohighlight">\(S_k\)</span>, the degrees of irreducible representations can be
expressed in terms of the number of tableaux of the appropriate
type. We have already stated the theorem for <span class="math notranslate nohighlight">\(GL(n)\)</span>. For <span class="math notranslate nohighlight">\(S_k\)</span>,
it goes as follows.</p>
<p>Let us say that a semistandard Young tableau <span class="math notranslate nohighlight">\(T\)</span> of shape <span class="math notranslate nohighlight">\(\lambda\vdash k\)</span> is
<em>standard</em> if <span class="math notranslate nohighlight">\(T\)</span> contains each entry <span class="math notranslate nohighlight">\(1,2,\dots,k\)</span> exactly once.
Thus both rows and columns are strictly increasing.</p>
<p><strong>Theorem</strong> [Young, 1927] The degree of <span class="math notranslate nohighlight">\(\pi_\lambda\)</span> is the number of
standard tableaux of shape <span class="math notranslate nohighlight">\(\lambda\)</span>.</p>
<p>Now let us consider the implications of Frobenius-Schur duality.
The dimension of <span class="math notranslate nohighlight">\(\otimes^k V\)</span> is <span class="math notranslate nohighlight">\(n^k\)</span>. Therefore <span class="math notranslate nohighlight">\(n^k\)</span> is equal
to the number of pairs <span class="math notranslate nohighlight">\((T1,T2)\)</span> of tableaux of the same shape
<span class="math notranslate nohighlight">\(\lambda\vdash k\)</span>, where the first tableaux is standard (in the
alphabet <span class="math notranslate nohighlight">\(1,2,\ldots,k\)</span>), and the second the second semistandard (in the
alphabet <span class="math notranslate nohighlight">\(1,2,\ldots,n\)</span>).</p>
</section>
<section id="the-robinson-schensted-knuth-correspondence">
<h2>The Robinson-Schensted-Knuth correspondence<a class="headerlink" href="#the-robinson-schensted-knuth-correspondence" title="Permalink to this heading">#</a></h2>
<p>The last purely combinatorial statement has a combinatorial proof,
based on the Robinson-Schensted-Knuth (RSK) correspondence.</p>
<p>References:</p>
<ul class="simple">
<li><p><a class="reference internal" href="bibliography.html#knuth1998" id="id1"><span>[Knuth1998]</span></a>, section “Tableaux and Involutions”.</p></li>
<li><p><a class="reference internal" href="bibliography.html#knuth1970" id="id2"><span>[Knuth1970]</span></a></p></li>
<li><p><a class="reference internal" href="bibliography.html#fulton1997" id="id3"><span>[Fulton1997]</span></a></p></li>
<li><p><a class="reference internal" href="bibliography.html#stanley1999" id="id4"><span>[Stanley1999]</span></a></p></li>
</ul>
<p>The RSK correspondence gives bijections between
pairs of tableaux of various types and combinatorial objects of
different types. We will not review the correspondence in detail here,
but see the references. We note that Schensted insertion is
implemented as the method <code class="docutils literal notranslate"><span class="pre">schensted_insertion</span></code> of Tableau class in
Sage.</p>
<p>Thus we have the following bijections:</p>
<ul class="simple">
<li><p>Pairs of tableaux <span class="math notranslate nohighlight">\(T_1\)</span> and <span class="math notranslate nohighlight">\(T_2\)</span> of shape <span class="math notranslate nohighlight">\(\lambda\)</span> where <span class="math notranslate nohighlight">\(\lambda\)</span>
runs through the partitions of <span class="math notranslate nohighlight">\(k\)</span> such that <span class="math notranslate nohighlight">\(T_1\)</span> is a standard
tableau and <span class="math notranslate nohighlight">\(T_2\)</span> is a semistandard tableau in <span class="math notranslate nohighlight">\(1,2,\dots,n\)</span> are in
bijection with the <span class="math notranslate nohighlight">\(n^k\)</span> words of length <span class="math notranslate nohighlight">\(k\)</span> in <span class="math notranslate nohighlight">\(1,2,\dots,n\)</span>.</p></li>
<li><p>Pairs of standard tableaux of the same shape <span class="math notranslate nohighlight">\(\lambda\)</span> as <span class="math notranslate nohighlight">\(\lambda\)</span>
runs through the partitions of <span class="math notranslate nohighlight">\(k\)</span> are in bijection with the <span class="math notranslate nohighlight">\(k!\)</span>
elements of <span class="math notranslate nohighlight">\(S_k\)</span>.</p></li>
<li><p>Pairs of tableaux <span class="math notranslate nohighlight">\(T_1\)</span> and <span class="math notranslate nohighlight">\(T_2\)</span> of the same shape <span class="math notranslate nohighlight">\(\lambda\)</span> but
arbitrary size in <span class="math notranslate nohighlight">\(1,2,3,\dots,n\)</span> are in bijection with <span class="math notranslate nohighlight">\(n \times n\)</span>
positive integer matrices.</p></li>
<li><p>Pairs of tableaux <span class="math notranslate nohighlight">\(T_1\)</span> and <span class="math notranslate nohighlight">\(T_2\)</span> of conjugate shapes <span class="math notranslate nohighlight">\(\lambda\)</span> and
<span class="math notranslate nohighlight">\(\lambda'\)</span> are in bijection with <span class="math notranslate nohighlight">\(n \times n\)</span> matrices with entries
<span class="math notranslate nohighlight">\(0\)</span> or <span class="math notranslate nohighlight">\(1\)</span>.</p></li>
</ul>
<p>The second of these four bijection gives a combinatorial proof of
the fact explained above, that the number of pairs <span class="math notranslate nohighlight">\((T1,T2)\)</span> of tableaux of
the same shape <span class="math notranslate nohighlight">\(\lambda\vdash k\)</span>, where the first tableaux is standard (in the
alphabet <span class="math notranslate nohighlight">\(1,2,\cdots,k\)</span>), and the second the second semistandard (in the
alphabet <span class="math notranslate nohighlight">\(1,2,\cdots,n\)</span>). So this second bijection is a <em>combinatorial
analog of Frobenius-Schur duality</em>.</p>
</section>
<section id="analogies-between-representation-theory-and-combinatorics">
<h2>Analogies between representation theory and combinatorics<a class="headerlink" href="#analogies-between-representation-theory-and-combinatorics" title="Permalink to this heading">#</a></h2>
<p>The four combinatorial bijections (variants of RSK) cited above have the
following analogs in representation theory.</p>
<ul class="simple">
<li><p>The first combinatorial fact corresponds to Frobenius-Schur duality, as we
have already explained.</p></li>
<li><p>The second combinatorial fact also has an analog in representation theory.
The group algebra <span class="math notranslate nohighlight">\(\mathbf{C}[S_k]\)</span> is an <span class="math notranslate nohighlight">\(S_k \times S_k\)</span> bimodule with
of dimension <span class="math notranslate nohighlight">\(k!\)</span>. It decomposes as a direct sum of
<span class="math notranslate nohighlight">\(\pi_\lambda^{S_k} \otimes \pi_\lambda^{S_k}\)</span>.</p></li>
</ul>
<p>Both the combinatorial fact and the decomposition of <span class="math notranslate nohighlight">\(\mathbf{C}[S_k]\)</span>
show that the number of pairs of standard tableaux of size <span class="math notranslate nohighlight">\(k\)</span> and
the same shape equals <span class="math notranslate nohighlight">\(k!\)</span>.</p>
<ul class="simple">
<li><p>The third combinatorial fact is analogous to the decomposition of the
ring of polynomial functions on <span class="math notranslate nohighlight">\(\hbox{Mat}(n, \mathbf{C})\)</span> on which
<span class="math notranslate nohighlight">\(GL(n, \mathbf{C}) \times GL(n, \mathbf{C})\)</span> acts by
<span class="math notranslate nohighlight">\((g_1, g_2)f(X) = f({^t g_1}X g_2)\)</span>. The polynomial ring decomposes
into the direct sum of
<span class="math notranslate nohighlight">\(\pi^{GL(n)}_\lambda \otimes \pi^{GL(n)}_\lambda\)</span>.</p></li>
</ul>
<p>Taking traces gives the <em>Cauchy identity</em>:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\sum_\lambda s_\lambda(x_1,\cdots,x_n) s_\lambda(y_1,\cdots,y_n) =\prod_{i,j}(1-x_i y_j)^{-1}\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(x_i\)</span> are the eigenvalues of <span class="math notranslate nohighlight">\(g_1\)</span> and <span class="math notranslate nohighlight">\(y_j\)</span> are the eigenvalues of <span class="math notranslate nohighlight">\(g_2\)</span>. The sum
is over all partitions <span class="math notranslate nohighlight">\(\lambda\)</span>.</p>
<ul class="simple">
<li><p>The last combinatorial fact is analogous to the decomposition of
the exterior algebra over <span class="math notranslate nohighlight">\(\hbox{Mat}(n, \mathbf{C})\)</span>.</p></li>
</ul>
<p>Taking traces gives the <em>dual Cauchy identity</em>:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\sum_\lambda s_\lambda(x_1,\cdots,x_n) s_{\lambda'}(y_1,\cdots,y_n) =\prod_{i,j}(1+x_i y_j).\]</div>
</div>
<p>Again the sum is over partitions <span class="math notranslate nohighlight">\(\lambda\)</span> and here <span class="math notranslate nohighlight">\(\lambda'\)</span> is the conjugate partition.</p>
</section>
<section id="interpolating-between-representation-theory-and-combinatorics">
<h2>Interpolating between representation theory and combinatorics<a class="headerlink" href="#interpolating-between-representation-theory-and-combinatorics" title="Permalink to this heading">#</a></h2>
<p>The theory of quantum groups interpolates between the representation
theoretic picture and the combinatorial picture, and thereby explains
these analogies. The representation <span class="math notranslate nohighlight">\(\pi_\lambda^{GL(n)}\)</span> is
reinterpreted as a module for the quantized enveloping algebra
<span class="math notranslate nohighlight">\(U_q(\mathfrak{gl}_n(\mathbf{C}))\)</span>, and the representation
<span class="math notranslate nohighlight">\(\pi_\lambda^{S_k}\)</span> is reinterpreted as a module for the Iwahori
Hecke algebra. Then Frobenius-Schur duality persists. See
<a class="reference internal" href="bibliography.html#jimbo1986" id="id5"><span>[Jimbo1986]</span></a>. When <span class="math notranslate nohighlight">\(q \to 1\)</span>, we recover the representation
story. When <span class="math notranslate nohighlight">\(q \to 0\)</span>, we recover the combinatorial story.</p>
</section>
<section id="kashiwara-crystals">
<h2>Kashiwara crystals<a class="headerlink" href="#kashiwara-crystals" title="Permalink to this heading">#</a></h2>
<p>References:</p>
<ul class="simple">
<li><p><a class="reference internal" href="bibliography.html#kashiwara1995" id="id6"><span>[Kashiwara1995]</span></a></p></li>
<li><p><a class="reference internal" href="bibliography.html#kashiwaranakashima1994" id="id7"><span>[KashiwaraNakashima1994]</span></a></p></li>
<li><p><a class="reference internal" href="bibliography.html#hongkang2002" id="id8"><span>[HongKang2002]</span></a></p></li>
</ul>
<p>Kashiwara considered the highest weight modules of quantized
enveloping algebras <span class="math notranslate nohighlight">\(U_q(\mathfrak{g})\)</span> in the limit when
<span class="math notranslate nohighlight">\(q \to 0\)</span>. The enveloping algebra cannot be defined when <span class="math notranslate nohighlight">\(q = 0\)</span>, but
a limiting structure can still be detected. This is the
<em>crystal basis</em> of the module.</p>
<p>Kashiwara’s crystal bases have a combinatorial structure that sheds
light even on purely combinatorial constructions on tableaux that
predated quantum groups. It gives a good generalization to other
Cartan types (or more generally to Kac-Moody algebras).</p>
<p>Let <span class="math notranslate nohighlight">\(\Lambda\)</span> be the weight lattice of a Cartan type with root system <span class="math notranslate nohighlight">\(\Phi\)</span>.
We now define a <em>crystal</em> of type <span class="math notranslate nohighlight">\(\Phi\)</span>. Let <span class="math notranslate nohighlight">\(\mathcal{B}\)</span> be a set,
and let <span class="math notranslate nohighlight">\(0 \notin \mathcal{B}\)</span> be an auxiliary element. For each index
<span class="math notranslate nohighlight">\(1 \le i \le r\)</span> we assume there given maps
<span class="math notranslate nohighlight">\(e_i, f_i : \mathcal{B} \longrightarrow \mathcal{B} \cup \{0\}\)</span>, maps
<span class="math notranslate nohighlight">\(\varepsilon_i, \varphi_i : \mathcal{B} \longrightarrow \mathbf{Z}\)</span> and a
map <span class="math notranslate nohighlight">\(\hbox{wt} : \mathcal{B} \longrightarrow \Lambda\)</span> satisfying
certain assumptions, which we now describe. It is assumed that if
<span class="math notranslate nohighlight">\(x, y \in \mathcal{B}\)</span> then <span class="math notranslate nohighlight">\(e_i (x) = y\)</span> if and only if
<span class="math notranslate nohighlight">\(f_i (y) = x\)</span>. In this case, it is assumed that</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\hbox{wt} (y) = \hbox{wt} (x) + \alpha_i,
\qquad
\varepsilon_i (x) = \varepsilon_i (y) + 1,
\qquad \varphi_i (x) = \varphi_i (y) - 1.\]</div>
</div>
<p>Moreover, we assume that</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\varphi_i (x) - \varepsilon_i (x)
=
\left\langle \hbox{wt} (x), \alpha^{\vee}_i \right\rangle\]</div>
</div>
<p>for all <span class="math notranslate nohighlight">\(x \in \mathcal{B}\)</span>.</p>
<p>We call a crystal <em>regular</em> if it satisfies the additional assumption that
<span class="math notranslate nohighlight">\(\varepsilon_i(v)\)</span> is the number of times that <span class="math notranslate nohighlight">\(e_i\)</span> may be applied to <span class="math notranslate nohighlight">\(v\)</span>, and
that <span class="math notranslate nohighlight">\(\phi_i(v)\)</span> is the number of times that <span class="math notranslate nohighlight">\(f_i\)</span> may be applied. That is,
<span class="math notranslate nohighlight">\(\varphi_i (x) = \max \{k | f_i^k x \neq 0\}\)</span> and <span class="math notranslate nohighlight">\(\varepsilon_i (x) =
\max \{k | e_i^k (x) \neq 0\}\)</span>. Kashiwara also allows <span class="math notranslate nohighlight">\(\varepsilon_i\)</span>
and <span class="math notranslate nohighlight">\(\varphi_i\)</span> to take the value <span class="math notranslate nohighlight">\(-\infty\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Most of the crystals that we are concerned with here are regular.</p>
</div>
<p>Given the crystal <span class="math notranslate nohighlight">\(\mathcal{B}\)</span>, the <em>character</em> <span class="math notranslate nohighlight">\(\chi_{\mathcal{B}}\)</span> is:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\sum_{v\in\mathcal{B}} {\mathbf{z}}^{wt(v)}.\]</div>
</div>
<p>Given any highest weight <span class="math notranslate nohighlight">\(\lambda\)</span>, constructions of Kashiwara and
Nakashima, Littelmann and others produce a crystal
<span class="math notranslate nohighlight">\(\chi_{\mathcal{B}_\lambda}\)</span> such that
<span class="math notranslate nohighlight">\(\chi_{\mathcal{B}_\lambda} = \chi_\lambda\)</span>, where <span class="math notranslate nohighlight">\(\chi_\lambda\)</span> is
the irreducible character with highest weight <span class="math notranslate nohighlight">\(\lambda\)</span>, as in
<a class="reference internal" href="lie_basics.html#representations"><span class="std std-ref">Representations and characters</span></a>.</p>
<p>The crystal <span class="math notranslate nohighlight">\(\mathcal{B}_\lambda\)</span> is not uniquely characterized by the
properties that we have stated so far. For Cartan types <span class="math notranslate nohighlight">\(A, D, E\)</span>
(more generally, any simply-laced type) it may
be characterized by these properties together with certain other
<em>Stembridge axioms</em>. We will take it for granted that there is a
unique “correct” crystal <span class="math notranslate nohighlight">\(\mathcal{B}_\lambda\)</span> and discuss how these
are constructed in Sage.</p>
</section>
<section id="installing-dot2tex">
<h2>Installing dot2tex<a class="headerlink" href="#installing-dot2tex" title="Permalink to this heading">#</a></h2>
<p>Before giving examples of crystals, we digress to help you install
<code class="docutils literal notranslate"><span class="pre">dot2tex</span></code>, which you will need in order to make latex images of
crystals.</p>
<p><code class="docutils literal notranslate"><span class="pre">dot2tex</span></code> is an optional package of sage and the latest version
can be installed via:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sage -i dot2tex
</pre></div>
</div>
<p>This also requires various LaTeX packages. The following command
checks whether those are available:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.graph_latex</span> <span class="kn">import</span> <span class="n">check_tkz_graph</span>
<span class="gp">sage: </span><span class="n">check_tkz_graph</span><span class="p">()</span> <span class="c1"># random</span>
</pre></div>
</div>
</section>
<section id="crystals-of-tableaux-in-sage">
<h2>Crystals of tableaux in Sage<a class="headerlink" href="#crystals-of-tableaux-in-sage" title="Permalink to this heading">#</a></h2>
<p>All crystals that are currently in Sage can be accessed by <code class="docutils literal notranslate"><span class="pre">crystals.&lt;tab&gt;</span></code>.</p>
<p>For type <span class="math notranslate nohighlight">\(A_r\)</span>, Kashiwara and Nakashima put a crystal structure on the
set of tableaux with shape <span class="math notranslate nohighlight">\(\lambda\)</span> in <span class="math notranslate nohighlight">\(1, 2, \ldots, r+1\)</span>, and this is a
realization of <span class="math notranslate nohighlight">\(\mathcal{B}_{\lambda}\)</span>. Moreover, this construction
extends to other Cartan types, as we will explain. At the moment, we
will consider how to draw pictures of these crystals.</p>
<p>Once you have <code class="docutils literal notranslate"><span class="pre">dot2tex</span></code> installed, you may make images pictures of crystals
with a command such as this:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fn</span> <span class="o">=</span> <span class="n">tmp_filename</span><span class="p">(</span><span class="n">ext</span><span class="o">=</span><span class="s2">&quot;.tex&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">crystals</span><span class="o">.</span><span class="n">Tableaux</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">latex_file</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
</pre></div>
</div>
<p>Here <span class="math notranslate nohighlight">\(\lambda = (2,1)=(2,1,0)\)</span>. The crystal <code class="docutils literal notranslate"><span class="pre">C</span></code> is
<span class="math notranslate nohighlight">\(\mathcal{B}_{\lambda}\)</span>. The character <span class="math notranslate nohighlight">\(\chi_\lambda\)</span> will therefore
be the eight-dimensional irreducible character with this highest
weight. Then you may run pdflatex on the file <code class="docutils literal notranslate"><span class="pre">a2rho.tex</span></code>.
This can also be achieved without the detour of saving the latex file via:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">Tableaux</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">view</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">tightpage</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># optional - dot2tex graphviz, not tested (opens external window)</span>
</pre></div>
</div>
<p>This produces the crystal graph:</p>
<a class="reference internal image-reference" href="../_images/a2rho_color.png"><img alt="../_images/a2rho_color.png" class="align-center" src="../_images/a2rho_color.png" style="width: 92.39999999999999px; height: 480.0px;" /></a>
<p>You may also wish to color the edges in different colors by specifying further latex options:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">Tableaux</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">digraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">set_latex_options</span><span class="p">(</span><span class="n">color_by_label</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="s2">&quot;yellow&quot;</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">view</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">tightpage</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># optional - dot2tex graphviz, not tested (opens external window)</span>
</pre></div>
</div>
<p>As you can see, the elements of this crystal are exactly the eight
tableaux of shape <span class="math notranslate nohighlight">\(\lambda\)</span> with entries in <span class="math notranslate nohighlight">\(\{1,2,3\}\)</span>. The
convention is that if <span class="math notranslate nohighlight">\(x,y \in \mathcal{B}\)</span> and <span class="math notranslate nohighlight">\(f_i(x) = y\)</span>, or
equivalently <span class="math notranslate nohighlight">\(e_i(y) = x\)</span>, then we draw an arrow from <span class="math notranslate nohighlight">\(x \to y\)</span>. Thus
the highest weight tableau is the one with no incoming arrows. Indeed,
this is:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\]</div>
</div>
<a class="reference internal image-reference" href="../_images/tableau3.png"><img alt="../_images/tableau3.png" class="align-center" src="../_images/tableau3.png" style="width: 55.5px; height: 55.5px;" /></a>
<p>We recall that the weight of the tableau is <span class="math notranslate nohighlight">\((k_1,k_2,k_3)\)</span> where
<span class="math notranslate nohighlight">\(k_i\)</span> is the number of <span class="math notranslate nohighlight">\(i\)</span>’s in the tableau, so this tableau has
weight <span class="math notranslate nohighlight">\((2,1,0)\)</span>, which indeed equals <span class="math notranslate nohighlight">\(\lambda\)</span>.</p>
<p>Once the crystal is created, you have access to the ambient space and
its methods through the method <code class="docutils literal notranslate"><span class="pre">weight_lattice_realization()</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">Tableaux</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">weight_lattice_realization</span><span class="p">();</span> <span class="n">L</span>
<span class="go">Ambient space of the Root system of type [&#39;A&#39;, 2]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="go">Finite family {1: (1, 0, 0), 2: (1, 1, 0)}</span>
</pre></div>
</div>
<p>The highest weight vector is available as follows:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">Tableaux</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">highest_weight_vector</span><span class="p">();</span> <span class="n">v</span>
<span class="go">[[1, 1], [2]]</span>
</pre></div>
</div>
<p>or more simply:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">Tableaux</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">[[1, 1], [2]]</span>
</pre></div>
</div>
<p>Now we may apply the operators <span class="math notranslate nohighlight">\(e_i\)</span> and <span class="math notranslate nohighlight">\(f_i\)</span> to move around in the
crystal:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">Tableaux</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">highest_weight_vector</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[[1, 2], [2]]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[[1, 3], [2]]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[[1, 3], [3]]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[[2, 3], [3]]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">v</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>You can construct the character if you first make a Weyl character
ring:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2</span> <span class="o">=</span> <span class="n">WeylCharacterRing</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">Tableaux</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">character</span><span class="p">(</span><span class="n">A2</span><span class="p">)</span>
<span class="go">A2(2,1,0)</span>
</pre></div>
</div>
</section>
<section id="crystals-of-letters">
<h2>Crystals of letters<a class="headerlink" href="#crystals-of-letters" title="Permalink to this heading">#</a></h2>
<p>For each of the classical Cartan types there is a <em>standard crystal</em>
<span class="math notranslate nohighlight">\(\mathcal{B}_{\hbox{standard}}\)</span> from which other crystals can be built
up by taking tensor products and extracting constituent irreducible
crystals. This procedure is sufficient for Cartan types <span class="math notranslate nohighlight">\(A_r\)</span> and
<span class="math notranslate nohighlight">\(C_r\)</span>. For types <span class="math notranslate nohighlight">\(B_r\)</span> and <span class="math notranslate nohighlight">\(D_r\)</span> the standard crystal must be
supplemented with <em>spin crystals</em>. See <a class="reference internal" href="bibliography.html#kashiwaranakashima1994" id="id9"><span>[KashiwaraNakashima1994]</span></a> or
<a class="reference internal" href="bibliography.html#hongkang2002" id="id10"><span>[HongKang2002]</span></a> for further details.</p>
<p>Here is the standard crystal of type <span class="math notranslate nohighlight">\(A_r\)</span>.</p>
<a class="reference internal image-reference" href="../_images/stand-a.png"><img alt="../_images/stand-a.png" class="align-center" src="../_images/stand-a.png" style="width: 247.5px; height: 22.5px;" /></a>
<p>You may create the crystal and work with it as follows:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">Letters</span><span class="p">(</span><span class="s2">&quot;A6&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v0</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">highest_weight_vector</span><span class="p">();</span> <span class="n">v0</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">v0</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">v0</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">v0</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1..6</span><span class="p">]]</span>
<span class="go">[None, None, 4, None, None, None]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">v0</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">e</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1..6</span><span class="p">]]</span>
<span class="go">[None, 2, None, None, None, None]</span>
</pre></div>
</div>
<p>Here is the standard crystal of type <span class="math notranslate nohighlight">\(B_r\)</span>.</p>
<a class="reference internal image-reference" href="../_images/stand-b.png"><img alt="../_images/stand-b.png" class="align-center" src="../_images/stand-b.png" style="width: 416.25px; height: 22.5px;" /></a>
<p>There is, additionally, a spin crystal for <span class="math notranslate nohighlight">\(B_r\)</span>, corresponding to
the <span class="math notranslate nohighlight">\(2^r\)</span>-dimensional spin representation. We will not draw it, but
we will describe it. Its elements are vectors
<span class="math notranslate nohighlight">\(\epsilon_1\otimes\cdots\otimes\epsilon_r\)</span>, where each <code class="docutils literal notranslate"><span class="pre">spin</span></code>
<span class="math notranslate nohighlight">\(\epsilon_i=\pm\)</span>.</p>
<p>If <span class="math notranslate nohighlight">\(i&lt;r\)</span>, then the effect of the operator
<span class="math notranslate nohighlight">\(f_i\)</span> is to annihilate <span class="math notranslate nohighlight">\(v = \epsilon_1 \otimes \cdots \otimes \epsilon_r\)</span>
unless <span class="math notranslate nohighlight">\(\epsilon_i \otimes \epsilon_{i+1} = + \otimes -\)</span>. If this is
so, then <span class="math notranslate nohighlight">\(f_i(v)\)</span> is obtained from <span class="math notranslate nohighlight">\(v\)</span> by replacing
<span class="math notranslate nohighlight">\(\epsilon_i \otimes \epsilon_{i+1}\)</span> by <span class="math notranslate nohighlight">\(- \otimes +\)</span>. If <span class="math notranslate nohighlight">\(i=r\)</span>, then
<span class="math notranslate nohighlight">\(f_r\)</span> annihilates <span class="math notranslate nohighlight">\(v\)</span> unless <span class="math notranslate nohighlight">\(\epsilon_r=+\)</span>, in which case it
replaces <span class="math notranslate nohighlight">\(\epsilon_r\)</span> by <span class="math notranslate nohighlight">\(-\)</span>.</p>
<p>Create the spin crystal as follows. The crystal elements are represented
in the signature representation listing the <span class="math notranslate nohighlight">\(\epsilon_i\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">Spins</span><span class="p">(</span><span class="s2">&quot;B3&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="go">[+++, ++-, +-+, -++, +--, -+-, --+, ---]</span>
</pre></div>
</div>
<p>Here is the standard crystal of type <span class="math notranslate nohighlight">\(C_r\)</span>.</p>
<a class="reference internal image-reference" href="../_images/stand-c.png"><img alt="../_images/stand-c.png" class="align-center" src="../_images/stand-c.png" style="width: 360.0px; height: 22.5px;" /></a>
<p>Here is the standard crystal of type <span class="math notranslate nohighlight">\(D_r\)</span>.</p>
<a class="reference internal image-reference" href="../_images/stand-d.png"><img alt="../_images/stand-d.png" class="align-center" src="../_images/stand-d.png" style="width: 472.5px; height: 97.5px;" /></a>
<p>There are two spin crystals for type <span class="math notranslate nohighlight">\(D_r\)</span>. Each consists of
<span class="math notranslate nohighlight">\(\epsilon_1 \otimes \cdots \otimes \epsilon_r\)</span> with <span class="math notranslate nohighlight">\(\epsilon_i = \pm\)</span>, and
the number of spins either always even or always odd. We will not describe
the effect of the root operators <span class="math notranslate nohighlight">\(f_i\)</span>, but you are invited to create them
and play around with them to guess the rule:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Cplus</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">SpinsPlus</span><span class="p">(</span><span class="s2">&quot;D4&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Cminus</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">SpinsMinus</span><span class="p">(</span><span class="s2">&quot;D4&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>It is also possible to construct the standard crystal for type
<span class="math notranslate nohighlight">\(G_2\)</span>, <span class="math notranslate nohighlight">\(E_6\)</span>, and <span class="math notranslate nohighlight">\(E_7\)</span>. Here is the one for type <span class="math notranslate nohighlight">\(G_2\)</span> (corresponding
to the representation of degree 7):</p>
<a class="reference internal image-reference" href="../_images/stand-g.png"><img alt="../_images/stand-g.png" class="align-center" src="../_images/stand-g.png" style="width: 360.0px; height: 22.5px;" /></a>
<p>The crystal of letters is a special case of the crystal of tableaux
in the sense that <span class="math notranslate nohighlight">\(\mathcal{B}_{\hbox{standard}}\)</span> is isomorphic to
the crystal of tableaux whose highest weight <span class="math notranslate nohighlight">\(\lambda\)</span> is the highest
weight vector of the standard representation. Thus compare:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">crystals</span><span class="o">.</span><span class="n">Letters</span><span class="p">(</span><span class="s2">&quot;A3&quot;</span><span class="p">)</span>
<span class="go">The crystal of letters for type [&#39;A&#39;, 3]</span>
<span class="gp">sage: </span><span class="n">crystals</span><span class="o">.</span><span class="n">Tableaux</span><span class="p">(</span><span class="s2">&quot;A3&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">The crystal of tableaux of type [&#39;A&#39;, 3] and shape(s) [[1]]</span>
</pre></div>
</div>
<p>These two crystals are different in implementation, but they are
isomorphic. In fact the second crystal is constructed from the
first. We can test isomorphisms between crystals as follows:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Cletter</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">Letters</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Ctableaux</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">Tableaux</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">shape</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Cletter</span><span class="o">.</span><span class="n">digraph</span><span class="p">()</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">Ctableaux</span><span class="o">.</span><span class="n">digraph</span><span class="p">())</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Cletter</span><span class="o">.</span><span class="n">digraph</span><span class="p">()</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">Ctableaux</span><span class="o">.</span><span class="n">digraph</span><span class="p">(),</span> <span class="n">certificate</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">(True, {1: [[1]], 2: [[2]], 3: [[3]], 4: [[4]]})</span>
</pre></div>
</div>
<p>where in the last step the explicit map between the vertices of the crystals is given.</p>
<p>Crystals of letters have a special role in the theory since
they are particularly simple, yet as Kashiwara and Nakashima showed,
the crystals of tableaux can be created from them.  We will review how
this works.</p>
</section>
<section id="tensor-products-of-crystals">
<h2>Tensor products of crystals<a class="headerlink" href="#tensor-products-of-crystals" title="Permalink to this heading">#</a></h2>
<p>Kashiwara defined the tensor product of crystals in a purely
combinatorial way. The beauty of this construction is that it exactly
parallels the tensor product of crystals of representations. That is,
if <span class="math notranslate nohighlight">\(\lambda\)</span> and <span class="math notranslate nohighlight">\(\mu\)</span> are dominant weights, then
<span class="math notranslate nohighlight">\(\mathcal{B}_\lambda \otimes \mathcal{B}_\mu\)</span> is a (usually
disconnected) crystal, which may contain multiple copies of
<span class="math notranslate nohighlight">\(\mathcal{B}_\nu\)</span> (for another dominant weight <span class="math notranslate nohighlight">\(\nu\)</span>), and the number
of copies of <span class="math notranslate nohighlight">\(\mathcal{B}_\nu\)</span> is exactly the multiplicity of
<span class="math notranslate nohighlight">\(\chi_\nu\)</span> in <span class="math notranslate nohighlight">\(\chi_\lambda \chi_\mu\)</span>.</p>
<p>We will describe two conventions for the tensor product of
crystals.</p>
<section id="kashiwara-s-definition">
<h3>Kashiwara’s definition<a class="headerlink" href="#kashiwara-s-definition" title="Permalink to this heading">#</a></h3>
<p>As a set, the tensor product <span class="math notranslate nohighlight">\(\mathcal{B} \otimes \mathcal{C}\)</span> of
crystals <span class="math notranslate nohighlight">\(\mathcal{B}\)</span> and <span class="math notranslate nohighlight">\(\mathcal{C}\)</span> is the Cartesian product, but
we denote the ordered pair <span class="math notranslate nohighlight">\((x, y)\)</span> with <span class="math notranslate nohighlight">\(x \in \mathcal{B}\)</span> and
<span class="math notranslate nohighlight">\(y \in \mathcal{C}\)</span> by <span class="math notranslate nohighlight">\(x \otimes y\)</span>. We define
<span class="math notranslate nohighlight">\(\hbox{wt} (x \otimes y) = \hbox{wt} (x) + \hbox{wt}(y)\)</span>. We define</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}f_i (x \otimes y)
=
\begin{cases}
f_i (x) \otimes y &amp; \text{if $\varphi_i (x) &gt; \varepsilon_i (y)$},\\
x \otimes f_i (y) &amp; \text{if $\varphi_i (x) \le \varepsilon_i (y)$},
\end{cases}\end{split}\]</div>
</div>
<p>and</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}e_i (x \otimes y)
=
\begin{cases}
e_i (x) \otimes y &amp; \text{if $\varphi_i (x) \ge \varepsilon_i (y)$},\\
x \otimes e_i (y) &amp; \text{if $\varphi_i (x) &lt; \varepsilon_i (y)$}.
\end{cases}\end{split}\]</div>
</div>
<p>It is understood that <span class="math notranslate nohighlight">\(x \otimes 0 = 0 \otimes x = 0\)</span>. We also define:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\varphi_i (x \otimes y)
=
\max (\varphi_i (y), \varphi_i (x) + \varphi_i (y) - \varepsilon_i (y)),\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\varepsilon_i (x \otimes y)
=
\max (\varepsilon_i (x), \varepsilon_i (x) + \varepsilon_i (y)
- \varphi_i (x)) .\]</div>
</div>
</section>
<section id="alternative-definition">
<h3>Alternative definition<a class="headerlink" href="#alternative-definition" title="Permalink to this heading">#</a></h3>
<p>As a set, the tensor product <span class="math notranslate nohighlight">\(\mathcal{B} \otimes \mathcal{C}\)</span> of
crystals <span class="math notranslate nohighlight">\(\mathcal{B}\)</span> and <span class="math notranslate nohighlight">\(\mathcal{C}\)</span> is the Cartesian product, but
we denote the ordered pair <span class="math notranslate nohighlight">\((y, x)\)</span> with <span class="math notranslate nohighlight">\(y \in \mathcal{B}\)</span> and
<span class="math notranslate nohighlight">\(x \in \mathcal{C}\)</span> by <span class="math notranslate nohighlight">\(x \otimes y\)</span>. We define
<span class="math notranslate nohighlight">\(\hbox{wt} (x \otimes y) = \hbox{wt} (y) + \hbox{wt}(x)\)</span>. We define</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}f_i (x \otimes y)
=
\begin{cases}
f_i (x) \otimes y &amp; \text{if $\varphi_i (y) \le \varepsilon_i (x)$},\\
x \otimes f_i (y) &amp; \text{if $\varphi_i (y) &gt; \varepsilon_i (x)$},
\end{cases}\end{split}\]</div>
</div>
<p>and</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}e_i (x \otimes y)
=
\begin{cases}
e_i (x) \otimes y &amp; \text{if $\varphi_i (y) &lt; \varepsilon_i (x)$},\\
x \otimes e_i (y) &amp; \text{if $\varphi_i (y) \ge \varepsilon_i (x)$}.
\end{cases}\end{split}\]</div>
</div>
<p>It is understood that <span class="math notranslate nohighlight">\(y \otimes 0 = 0 \otimes y = 0\)</span>. We also define</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\varphi_i (x \otimes y)
=
\max (\varphi_i (x), \varphi_i (y) + \varphi_i (x) - \varepsilon_i (x)),\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\varepsilon_i (x \otimes y)
=
\max (\varepsilon_i (y), \varepsilon_i (y) + \varepsilon_i (x)
- \varphi_i (y)).\]</div>
</div>
<p>The tensor product is associative:
<span class="math notranslate nohighlight">\((x \otimes y) \otimes z \mapsto x \otimes(y \otimes z)\)</span> is an
isomorphism
<span class="math notranslate nohighlight">\((\mathcal{B} \otimes \mathcal{C}) \otimes \mathcal{D} \to \mathcal{B} \otimes (\mathcal{C} \otimes \mathcal{D})\)</span>,
and so we may consider tensor products of arbitrary numbers of crystals.</p>
</section>
<section id="the-relationship-between-the-two-definitions">
<h3>The relationship between the two definitions<a class="headerlink" href="#the-relationship-between-the-two-definitions" title="Permalink to this heading">#</a></h3>
<p>The relationship between the two definitions is simply that the
Kashiwara tensor product <span class="math notranslate nohighlight">\(\mathcal{B} \otimes \mathcal{C}\)</span> is the
alternate tensor product <span class="math notranslate nohighlight">\(\mathcal{C} \otimes \mathcal{B}\)</span> in reverse
order. Sage uses the alternative tensor product. Even though the
tensor product construction is <em>a priori</em> asymmetrical, both
constructions produce isomorphic crystals, and in particular Sage’s
crystals of tableaux are identical to Kashiwara’s.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using abstract crystals (i.e. they satisfy the axioms but do not arise
from a representation of <span class="math notranslate nohighlight">\(U_q(\mathfrak{g})\)</span>), we can construct crystals
<span class="math notranslate nohighlight">\(\mathcal{B}, \mathcal{C}\)</span> such that <span class="math notranslate nohighlight">\(\mathcal{B} \otimes \mathcal{C}
\neq \mathcal{C} \otimes \mathcal{B}\)</span> (of course, using the
same convention).</p>
</div>
</section>
<section id="tensor-products-of-crystals-in-sage">
<h3>Tensor products of crystals in Sage<a class="headerlink" href="#tensor-products-of-crystals-in-sage" title="Permalink to this heading">#</a></h3>
<p>You may construct the tensor product of several crystals in Sage using
<code class="docutils literal notranslate"><span class="pre">crystals.TensorProduct</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">Letters</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">TensorProduct</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">C</span><span class="p">);</span> <span class="n">T</span>
<span class="go">Full tensor product of the crystals [The crystal of letters for type [&#39;A&#39;, 2],</span>
<span class="go">The crystal of letters for type [&#39;A&#39;, 2], The crystal of letters for type [&#39;A&#39;, 2]]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">27</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">highest_weight_vectors</span><span class="p">()</span>
<span class="go">([1, 1, 1], [2, 1, 1], [1, 2, 1], [3, 2, 1])</span>
</pre></div>
</div>
<p>This crystal has four highest weight vectors. We may understand this
as follows:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2</span> <span class="o">=</span> <span class="n">WeylCharacterRing</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">Letters</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">TensorProduct</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">C</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">chi_C</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">character</span><span class="p">(</span><span class="n">A2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">chi_T</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">character</span><span class="p">(</span><span class="n">A2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">chi_C</span>
<span class="go">A2(1,0,0)</span>
<span class="gp">sage: </span><span class="n">chi_T</span>
<span class="go">A2(1,1,1) + 2*A2(2,1,0) + A2(3,0,0)</span>
<span class="gp">sage: </span><span class="n">chi_T</span> <span class="o">==</span> <span class="n">chi_C</span><span class="o">^</span><span class="mi">3</span>
<span class="go">True</span>
</pre></div>
</div>
<p>As expected, the character of <code class="docutils literal notranslate"><span class="pre">T</span></code> is the cube of the character of
<code class="docutils literal notranslate"><span class="pre">C</span></code>, and representations with highest weight <span class="math notranslate nohighlight">\((1,1,1)\)</span>, <span class="math notranslate nohighlight">\((3,0,0)\)</span>
and <span class="math notranslate nohighlight">\((2,1,0)\)</span>. This decomposition is predicted by Frobenius-Schur
duality: the multiplicity of <span class="math notranslate nohighlight">\(\pi_\lambda^{GL(n)}\)</span> in
<span class="math notranslate nohighlight">\(\otimes^3\mathbf{C}^3\)</span> is the degree of <span class="math notranslate nohighlight">\(\pi_\lambda^{S_3}\)</span>.</p>
<p>It is useful to be able to select one irreducible constitutent of
<code class="docutils literal notranslate"><span class="pre">T</span></code>. If we only want one of the irreducible constituents of <code class="docutils literal notranslate"><span class="pre">T</span></code>,
we can specify a list of highest weight vectors by the option
<code class="docutils literal notranslate"><span class="pre">generators</span></code>. If the list has only one element, then we get an
irreducible crystal. We can make four such crystals:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2</span> <span class="o">=</span> <span class="n">WeylCharacterRing</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">Letters</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">TensorProduct</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">C</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="p">,</span><span class="n">T3</span><span class="p">,</span><span class="n">T4</span><span class="p">]</span> <span class="o">=</span> \
<span class="go">  [crystals.TensorProduct(C,C,C,generators=[v]) for v in T.highest_weight_vectors()]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">B</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span> <span class="k">for</span> <span class="n">B</span> <span class="ow">in</span> <span class="p">[</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="p">,</span><span class="n">T3</span><span class="p">,</span><span class="n">T4</span><span class="p">]]</span>
<span class="go">[10, 8, 8, 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">B</span><span class="o">.</span><span class="n">character</span><span class="p">(</span><span class="n">A2</span><span class="p">)</span> <span class="k">for</span> <span class="n">B</span> <span class="ow">in</span> <span class="p">[</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="p">,</span><span class="n">T3</span><span class="p">,</span><span class="n">T4</span><span class="p">]]</span>
<span class="go">[A2(3,0,0), A2(2,1,0), A2(2,1,0), A2(1,1,1)]</span>
</pre></div>
</div>
<p>We see that two of these crystals are isomorphic, with character
<code class="docutils literal notranslate"><span class="pre">A2(2,1,0)</span></code>. Try:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2</span> <span class="o">=</span> <span class="n">WeylCharacterRing</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">Letters</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">TensorProduct</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">C</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">T1</span><span class="p">,</span><span class="n">T2</span><span class="p">,</span><span class="n">T3</span><span class="p">,</span><span class="n">T4</span><span class="p">]</span> <span class="o">=</span> \
<span class="go">  [crystals.TensorProduct(C,C,C,generators=[v]) for v in T.highest_weight_vectors()]</span>
<span class="gp">sage: </span><span class="n">T1</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="go">Graphics object consisting of 35 graphics primitives</span>
<span class="gp">sage: </span><span class="n">T2</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="go">Graphics object consisting of 25 graphics primitives</span>
<span class="gp">sage: </span><span class="n">T3</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="go">Graphics object consisting of 25 graphics primitives</span>
<span class="gp">sage: </span><span class="n">T4</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="go">Graphics object consisting of 2 graphics primitives</span>
</pre></div>
</div>
<p>Elements of <code class="docutils literal notranslate"><span class="pre">crystals.TensorProduct(A,B,C,</span> <span class="pre">...)</span></code> are represented by
sequences <code class="docutils literal notranslate"><span class="pre">[a,b,c,</span> <span class="pre">...]</span></code> with <code class="docutils literal notranslate"><span class="pre">a</span></code> in <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code> in <code class="docutils literal notranslate"><span class="pre">B</span></code>, etc.
This of course represents <span class="math notranslate nohighlight">\(a \otimes b \otimes c \otimes \cdots\)</span>.</p>
</section>
</section>
<section id="crystals-of-tableaux-as-tensor-products-of-crystals">
<h2>Crystals of tableaux as tensor products of crystals<a class="headerlink" href="#crystals-of-tableaux-as-tensor-products-of-crystals" title="Permalink to this heading">#</a></h2>
<p>Sage implements the
<a class="reference external" href="../../reference/combinat/sage/combinat/crystals/tensor_product.html#sage.combinat.crystals.tensor_product.CrystalOfTableaux" title="(in Combinatorics v9.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrystalOfTableaux</span></code></a> as
a subcrystal of a tensor product of the
<a class="reference external" href="../../reference/combinat/sage/combinat/crystals/letters.html#sage.combinat.crystals.letters.ClassicalCrystalOfLetters" title="(in Combinatorics v9.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClassicalCrystalOfLetters</span></code></a>.
You can see how its done as follows:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">Tableaux</span><span class="p">(</span><span class="s2">&quot;A4&quot;</span><span class="p">,</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">highest_weight_vector</span><span class="p">()</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">v</span>
<span class="go">[[1, 2, 5], [3, 4]]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">[3, 1, 4, 2, 5]</span>
</pre></div>
</div>
<p>We’ve looked at the internal representation of <span class="math notranslate nohighlight">\(v\)</span>, where it is
represented as an element of the fourth tensor power of the
<a class="reference external" href="../../reference/combinat/sage/combinat/crystals/letters.html#sage.combinat.crystals.letters.ClassicalCrystalOfLetters" title="(in Combinatorics v9.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClassicalCrystalOfLetters</span></code></a>.
We see that the tableau:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\]</div>
</div>
<a class="reference internal image-reference" href="../_images/tableau4.png"><img alt="../_images/tableau4.png" class="align-center" src="../_images/tableau4.png" style="width: 81.75px; height: 55.5px;" /></a>
<p>is interpreted as the tensor:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\]</div>
</div>
<a class="reference internal image-reference" href="../_images/tensor.png"><img alt="../_images/tensor.png" class="align-center" src="../_images/tensor.png" style="width: 239.25px; height: 29.25px;" /></a>
<p>The elements of the tableau are read from bottom to top and from left
to right. This is the <em>inverse middle-Eastern reading</em> of the
tableau. See Hong and Kang, <em>loc. cit.</em> for discussion of the readings
of a tableau.</p>
</section>
<section id="spin-crystals">
<h2>Spin crystals<a class="headerlink" href="#spin-crystals" title="Permalink to this heading">#</a></h2>
<p>For the Cartan types <span class="math notranslate nohighlight">\(A_r\)</span>, <span class="math notranslate nohighlight">\(C_r\)</span> or <span class="math notranslate nohighlight">\(G_2\)</span>,
<a class="reference external" href="../../reference/combinat/sage/combinat/crystals/tensor_product.html#sage.combinat.crystals.tensor_product.CrystalOfTableaux" title="(in Combinatorics v9.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrystalOfTableaux</span></code></a> are
capable of making any finite crystal. (For type <span class="math notranslate nohighlight">\(A_r\)</span> it is necessary
that the highest weight <span class="math notranslate nohighlight">\(\lambda\)</span> be a partition.)</p>
<p>For Cartan types <span class="math notranslate nohighlight">\(B_r\)</span> and <span class="math notranslate nohighlight">\(D_r\)</span>, there also exist spin representations.
The corresponding crystals are implemented as <em>spin crystals</em>.
For these types,
<a class="reference external" href="../../reference/combinat/sage/combinat/crystals/tensor_product.html#sage.combinat.crystals.tensor_product.CrystalOfTableaux" title="(in Combinatorics v9.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrystalOfTableaux</span></code></a> also allows
the input shape <span class="math notranslate nohighlight">\(\lambda\)</span> to be half-integral if it is of height <span class="math notranslate nohighlight">\(r\)</span>.
For example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">Tableaux</span><span class="p">([</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">shape</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="go">[[++, [[1]]], [++, [[2]]], [++, [[0]]], [++, [[-2]]], [++, [[-1]]], [+-, [[-2]]],</span>
<span class="go">[+-, [[-1]]], [-+, [[-1]]], [+-, [[1]]], [+-, [[2]]], [-+, [[2]]], [+-, [[0]]],</span>
<span class="go">[-+, [[0]]], [-+, [[-2]]], [--, [[-2]]], [--, [[-1]]]]</span>
</pre></div>
</div>
<p>Here the first list of <span class="math notranslate nohighlight">\(+\)</span> and <span class="math notranslate nohighlight">\(-\)</span> gives a spin column that is discussed in more detail
in the next section and the second entry is a crystal of tableau element for
<span class="math notranslate nohighlight">\(\lambda = (\lfloor \lambda_1 \rfloor, \lfloor \lambda_2 \rfloor, \ldots )\)</span>.
For type <span class="math notranslate nohighlight">\(D_r\)</span>, we have the additional feature that there are two types of spin
crystals. Hence in
<a class="reference external" href="../../reference/combinat/sage/combinat/crystals/tensor_product.html#sage.combinat.crystals.tensor_product.CrystalOfTableaux" title="(in Combinatorics v9.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrystalOfTableaux</span></code></a>
the <span class="math notranslate nohighlight">\(r\)</span>-th entry of <span class="math notranslate nohighlight">\(\lambda\)</span> in this case can also take negative values:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">Tableaux</span><span class="p">([</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">shape</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="go">[[++-, []], [+-+, []], [-++, []], [---, []]]</span>
</pre></div>
</div>
<p>For rank two Cartan types, we also have <code class="docutils literal notranslate"><span class="pre">crystals.FastRankTwo</span></code> which gives
a different fast implementation of these crystals:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">FastRankTwo</span><span class="p">([</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">]);</span> <span class="n">B</span>
<span class="go">The fast crystal for B2 with shape [3/2,1/2]</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">highest_weight_vector</span><span class="p">();</span> <span class="n">v</span><span class="o">.</span><span class="n">weight</span><span class="p">()</span>
<span class="go">(3/2, 1/2)</span>
</pre></div>
</div>
<section id="type-b-spin-crystal">
<h3>Type B spin crystal<a class="headerlink" href="#type-b-spin-crystal" title="Permalink to this heading">#</a></h3>
<p>The spin crystal has highest weight <span class="math notranslate nohighlight">\((1/2,\dots,1/2)\)</span>. This is the
last fundamental weight. The irreducible representation with this
weight is the spin representation of degree <span class="math notranslate nohighlight">\(2^r\)</span>. Its crystal is
hand-coded in Sage:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Cspin</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">Spins</span><span class="p">(</span><span class="s2">&quot;B3&quot;</span><span class="p">);</span> <span class="n">Cspin</span>
<span class="go">The crystal of spins for type [&#39;B&#39;, 3]</span>
<span class="gp">sage: </span><span class="n">Cspin</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">8</span>
</pre></div>
</div>
<p>The crystals with highest weight <span class="math notranslate nohighlight">\(\lambda\)</span>, where <span class="math notranslate nohighlight">\(\lambda\)</span> is a half-integral weight,
are constructed as a tensor product of a spin column and the highest weight crystal
of the integer part of <span class="math notranslate nohighlight">\(\lambda\)</span>. For example, suppose that <span class="math notranslate nohighlight">\(\lambda = (3/2, 3/2, 1/2)\)</span>.
The corresponding irreducible character will have degree 112:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B3</span> <span class="o">=</span> <span class="n">WeylCharacterRing</span><span class="p">(</span><span class="s2">&quot;B3&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B3</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">112</span>
</pre></div>
</div>
<p>So <span class="math notranslate nohighlight">\(\mathcal{B}_\lambda\)</span> will have 112 elements. We can find it as a
subcrystal of <code class="docutils literal notranslate"><span class="pre">Cspin</span></code> <span class="math notranslate nohighlight">\(\otimes \mathcal{B}_\mu\)</span>, where
<span class="math notranslate nohighlight">\(\mu = \lambda-(1/2,1/2,1/2) = (1,1,0)\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B3</span> <span class="o">=</span> <span class="n">WeylCharacterRing</span><span class="p">(</span><span class="s2">&quot;B3&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B3</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="n">B3</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">B3(1/2,1/2,1/2) + B3(3/2,1/2,1/2) + B3(3/2,3/2,1/2)</span>
</pre></div>
</div>
<p>We see that just taking the tensor product of these two crystals will
produce a reducible crystal with three constitutents, and we want to
extract the one we want. We do that as follows:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B3</span> <span class="o">=</span> <span class="n">WeylCharacterRing</span><span class="p">(</span><span class="s2">&quot;B3&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C1</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">Tableaux</span><span class="p">(</span><span class="s2">&quot;B3&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Cspin</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">Spins</span><span class="p">(</span><span class="s2">&quot;B3&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">TensorProduct</span><span class="p">(</span><span class="n">C1</span><span class="p">,</span> <span class="n">Cspin</span><span class="p">,</span> <span class="n">generators</span><span class="o">=</span><span class="p">[[</span><span class="n">C1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Cspin</span><span class="p">[</span><span class="mi">0</span><span class="p">]]])</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">112</span>
</pre></div>
</div>
<p>Alternatively, we can get this directly from
<a class="reference external" href="../../reference/combinat/sage/combinat/crystals/tensor_product.html#sage.combinat.crystals.tensor_product.CrystalOfTableaux" title="(in Combinatorics v9.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrystalOfTableaux</span></code></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">Tableaux</span><span class="p">([</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">shape</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">112</span>
</pre></div>
</div>
<p>This is the desired crystal.</p>
</section>
<section id="type-d-spin-crystals">
<h3>Type D spin crystals<a class="headerlink" href="#type-d-spin-crystals" title="Permalink to this heading">#</a></h3>
<p>A similar situation pertains for type <span class="math notranslate nohighlight">\(D_r\)</span>, but now there are two
spin crystals, both of degree <span class="math notranslate nohighlight">\(2^{r-1}\)</span>. These are hand-coded in sage:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">SpinPlus</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">SpinsPlus</span><span class="p">(</span><span class="s2">&quot;D4&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">SpinMinus</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">SpinsMinus</span><span class="p">(</span><span class="s2">&quot;D4&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">SpinPlus</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="p">()</span>
<span class="go">(1/2, 1/2, 1/2, 1/2)</span>
<span class="gp">sage: </span><span class="n">SpinMinus</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="p">()</span>
<span class="go">(1/2, 1/2, 1/2, -1/2)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">C</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span> <span class="k">for</span> <span class="n">C</span> <span class="ow">in</span> <span class="p">[</span><span class="n">SpinPlus</span><span class="p">,</span><span class="n">SpinMinus</span><span class="p">]]</span>
<span class="go">[8, 8]</span>
</pre></div>
</div>
<p>Similarly to type B crystal, we obtain crystal with spin weight by allowing for partitions
with half-integer values, and the last entry can be negative depending on the type of the spin.</p>
</section>
</section>
<section id="lusztig-involution">
<h2>Lusztig involution<a class="headerlink" href="#lusztig-involution" title="Permalink to this heading">#</a></h2>
<p>The Lusztig involution on a finite-dimensional highest weight crystal <span class="math notranslate nohighlight">\(B(\lambda)\)</span> of highest weight <span class="math notranslate nohighlight">\(\lambda\)</span>
maps the highest weight vector to the lowest weight vector and the Kashiwara operator <span class="math notranslate nohighlight">\(f_i\)</span> to
<span class="math notranslate nohighlight">\(e_{i^*}\)</span>, where <span class="math notranslate nohighlight">\(i^*\)</span> is defined as <span class="math notranslate nohighlight">\(\alpha_{i^*} = -w_0(\alpha_i)\)</span>. Here <span class="math notranslate nohighlight">\(w_0\)</span> is the longest element
of the Weyl group acting on the <span class="math notranslate nohighlight">\(i\)</span>-th simple root <span class="math notranslate nohighlight">\(\alpha_i\)</span>. For example, for type <span class="math notranslate nohighlight">\(A_n\)</span> we have <span class="math notranslate nohighlight">\(i^*=n+1-i\)</span>,
whereas for type <span class="math notranslate nohighlight">\(C_n\)</span> we have <span class="math notranslate nohighlight">\(i^*=i\)</span>. For type <span class="math notranslate nohighlight">\(D_n\)</span> and <span class="math notranslate nohighlight">\(n\)</span> even also have <span class="math notranslate nohighlight">\(i^*=i\)</span>, but for <span class="math notranslate nohighlight">\(n\)</span> odd this
map interchanges nodes <span class="math notranslate nohighlight">\(n-1\)</span> and <span class="math notranslate nohighlight">\(n\)</span>. Here is how to achieve this in Sage:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">Tableaux</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">B</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">lusztig_involution</span><span class="p">()</span>
<span class="go">[[2, 4], [3]]</span>
</pre></div>
</div>
<p>For type <span class="math notranslate nohighlight">\(A_n\)</span>, the Lusztig involution is the same as the Schuetzenberger involution (which in Sage is
defined on tableaux):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">Tableau</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">schuetzenberger_involution</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="go">[[2, 4], [3]]</span>
</pre></div>
</div>
<p>For all tableaux in a given crystal, this can be tested via:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">Tableaux</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">lusztig_involution</span><span class="p">()</span><span class="o">.</span><span class="n">to_tableau</span><span class="p">()</span> <span class="o">==</span> <span class="n">b</span><span class="o">.</span><span class="n">to_tableau</span><span class="p">()</span><span class="o">.</span><span class="n">schuetzenberger_involution</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">B</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The Lusztig involution is also defined for finite-dimensional highest weight crystals of exceptional
type:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">CartanType</span><span class="p">([</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">La</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">root_system</span><span class="p">()</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">HighestWeight</span><span class="p">(</span><span class="n">La</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span> <span class="n">t</span>
<span class="go">[(-2, 5)]</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">lusztig_involution</span><span class="p">()</span>
<span class="go">[(-3, 2)]</span>
</pre></div>
</div>
</section>
<section id="levi-branching-rules-for-crystals">
<h2>Levi branching rules for crystals<a class="headerlink" href="#levi-branching-rules-for-crystals" title="Permalink to this heading">#</a></h2>
<p>Let <span class="math notranslate nohighlight">\(G\)</span> be a Lie group and <span class="math notranslate nohighlight">\(H\)</span> a Levi subgroup. We have already seen
that the Dynkin diagram of <span class="math notranslate nohighlight">\(H\)</span> is obtained from that of <span class="math notranslate nohighlight">\(G\)</span> by erasing
one or more nodes.</p>
<p>If <span class="math notranslate nohighlight">\(\mathcal{C}\)</span> is a crystal for <span class="math notranslate nohighlight">\(G\)</span>, then we may obtain the
corresponding crystal for <span class="math notranslate nohighlight">\(H\)</span> by a similar process. For example if the
Dynkin diagram for <span class="math notranslate nohighlight">\(H\)</span> is obtained from the Dynkin diagram for <span class="math notranslate nohighlight">\(G\)</span> by
erasing the <span class="math notranslate nohighlight">\(i\)</span>-th node, then if we erase all the edges in the crystal
<span class="math notranslate nohighlight">\(\mathcal{C}\)</span> that are labeled with <span class="math notranslate nohighlight">\(i\)</span>, we obtain a crystal for <span class="math notranslate nohighlight">\(H\)</span>.</p>
<p>In Sage this is achieved by specifying the index set used in the digraph method:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">Tableaux</span><span class="p">([</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">digraph</span><span class="p">(</span><span class="n">index_set</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<p>We see that the type <span class="math notranslate nohighlight">\(D_4\)</span> crystal indeed decomposes into two type <span class="math notranslate nohighlight">\(A_3\)</span> components.</p>
<a class="reference internal image-reference" href="../_images/parabolic_subcrystal.png"><img alt="../_images/parabolic_subcrystal.png" class="align-center" src="../_images/parabolic_subcrystal.png" style="width: 102.75px; height: 387.0px;" /></a>
<p>For more on branching rules, see <a class="reference internal" href="branching_rules.html#branch-rules"><span class="std std-ref">Maximal Subgroups and Branching Rules</span></a> or
<a class="reference internal" href="branching_rules.html#levi-branch-rules"><span class="std std-ref">Levi subgroups</span></a> for specifics on the Levi subgroups.</p>
</section>
<section id="subcrystals">
<h2>Subcrystals<a class="headerlink" href="#subcrystals" title="Permalink to this heading">#</a></h2>
<p>Sometimes it might be desirable to work with a subcrystal of a crystal. For example,
one might want to look at all <span class="math notranslate nohighlight">\(\{2,3,\ldots,n\}\)</span> highest elements of a crystal
and look at a particular such component:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">Tableaux</span><span class="p">([</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">hw</span> <span class="o">=</span> <span class="p">[</span> <span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">T</span> <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">is_highest_weight</span><span class="p">(</span><span class="n">index_set</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span> <span class="p">];</span> <span class="n">hw</span>
<span class="go">[[[1, 1], [2]],</span>
<span class="go"> [[1, 2], [2]],</span>
<span class="go"> [[2, -1], [-2]],</span>
<span class="go"> [[2, -1], [-1]],</span>
<span class="go"> [[1, -1], [2]],</span>
<span class="go"> [[2, -1], [3]],</span>
<span class="go"> [[1, 2], [3]],</span>
<span class="go"> [[2, 2], [3]],</span>
<span class="go"> [[1, 2], [-2]],</span>
<span class="go"> [[2, 2], [-2]],</span>
<span class="go"> [[2, 2], [-1]]]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">subcrystal</span><span class="p">(</span><span class="n">generators</span> <span class="o">=</span> <span class="p">[</span><span class="n">T</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">3</span><span class="p">]])],</span> <span class="n">index_set</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">digraph</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="n">C</span><span class="p">,</span> <span class="n">index_set</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="affine.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Affine Root System Basics</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="weyl_groups.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Weyl Groups, Coxeter Groups and the Bruhat Order</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2023, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Classical Crystals</a><ul>
<li><a class="reference internal" href="#tableaux-and-representations-of-gl-n">Tableaux and representations of <span class="math notranslate nohighlight">\(GL(n)\)</span></a></li>
<li><a class="reference internal" href="#frobenius-schur-duality">Frobenius-Schur Duality</a></li>
<li><a class="reference internal" href="#counting-pairs-of-tableaux">Counting pairs of tableaux</a></li>
<li><a class="reference internal" href="#the-robinson-schensted-knuth-correspondence">The Robinson-Schensted-Knuth correspondence</a></li>
<li><a class="reference internal" href="#analogies-between-representation-theory-and-combinatorics">Analogies between representation theory and combinatorics</a></li>
<li><a class="reference internal" href="#interpolating-between-representation-theory-and-combinatorics">Interpolating between representation theory and combinatorics</a></li>
<li><a class="reference internal" href="#kashiwara-crystals">Kashiwara crystals</a></li>
<li><a class="reference internal" href="#installing-dot2tex">Installing dot2tex</a></li>
<li><a class="reference internal" href="#crystals-of-tableaux-in-sage">Crystals of tableaux in Sage</a></li>
<li><a class="reference internal" href="#crystals-of-letters">Crystals of letters</a></li>
<li><a class="reference internal" href="#tensor-products-of-crystals">Tensor products of crystals</a><ul>
<li><a class="reference internal" href="#kashiwara-s-definition">Kashiwara’s definition</a></li>
<li><a class="reference internal" href="#alternative-definition">Alternative definition</a></li>
<li><a class="reference internal" href="#the-relationship-between-the-two-definitions">The relationship between the two definitions</a></li>
<li><a class="reference internal" href="#tensor-products-of-crystals-in-sage">Tensor products of crystals in Sage</a></li>
</ul>
</li>
<li><a class="reference internal" href="#crystals-of-tableaux-as-tensor-products-of-crystals">Crystals of tableaux as tensor products of crystals</a></li>
<li><a class="reference internal" href="#spin-crystals">Spin crystals</a><ul>
<li><a class="reference internal" href="#type-b-spin-crystal">Type B spin crystal</a></li>
<li><a class="reference internal" href="#type-d-spin-crystals">Type D spin crystals</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lusztig-involution">Lusztig involution</a></li>
<li><a class="reference internal" href="#levi-branching-rules-for-crystals">Levi branching rules for crystals</a></li>
<li><a class="reference internal" href="#subcrystals">Subcrystals</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="../_static/mathjax/tex-chtml.js"></script>
    </body>
</html>