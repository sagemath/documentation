<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Affine Finite Crystals" href="affine_finite_crystals.html" /><link rel="prev" title="Affine Root System Basics" href="affine.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>Integrable Highest Weight Representations of Affine Lie algebras - Thematic Tutorials</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom-furo.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom-jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom-codemirror-monokai.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Thematic Tutorials</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 10.2 Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../index.html">Home - Thematic Tutorials</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../toctree.html">Thematic tutorial document tree</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../algebraic_combinatorics.html">Algebraic Combinatorics in Sage</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../algebraic_combinatorics/walks.html">Walks in graphs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../algebraic_combinatorics/n_cube.html"><span class="math notranslate nohighlight">\(n\)</span>-Cube</a></li>
<li class="toctree-l3"><a class="reference internal" href="../algebraic_combinatorics/tsetlin_library.html">The Tsetlin library</a></li>
<li class="toctree-l3"><a class="reference internal" href="../algebraic_combinatorics/rsk.html">Young’s lattice and the RSK algorithm</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../sandpile.html">Abelian Sandpile Model</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../group_theory.html">Group Theory and Sage</a></li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="../lie.html">Lie Methods and Related Combinatorics in Sage</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="introduction.html">The Scope of this Document</a></li>
<li class="toctree-l3"><a class="reference internal" href="lie_basics.html">Lie Group Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="weyl_character_ring.html">The Weyl Character Ring</a></li>
<li class="toctree-l3"><a class="reference internal" href="branching_rules.html">Maximal Subgroups and Branching Rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="weyl_groups.html">Weyl Groups, Coxeter Groups and the Bruhat Order</a></li>
<li class="toctree-l3"><a class="reference internal" href="crystals.html">Classical Crystals</a></li>
<li class="toctree-l3"><a class="reference internal" href="affine.html">Affine Root System Basics</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Integrable Highest Weight Representations of Affine Lie algebras</a></li>
<li class="toctree-l3"><a class="reference internal" href="affine_finite_crystals.html">Affine Finite Crystals</a></li>
<li class="toctree-l3"><a class="reference internal" href="affine_hw_crystals.html">Affine Highest Weight Crystals</a></li>
<li class="toctree-l3"><a class="reference internal" href="elementary_crystals.html">Elementary crystals</a></li>
<li class="toctree-l3"><a class="reference internal" href="infinity_crystals.html">Infinity Crystals</a></li>
<li class="toctree-l3"><a class="reference internal" href="iwahori_hecke_algebra.html">Iwahori Hecke Algebras</a></li>
<li class="toctree-l3"><a class="reference internal" href="kazhdan_lusztig_polynomials.html">Kazhdan-Lusztig Polynomials</a></li>
<li class="toctree-l3"><a class="reference internal" href="bibliography.html">Bibliography</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../vector_calculus.html">Tutorial: Vector Calculus in Euclidean Spaces</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../vector_calculus/vector_calc_cartesian.html">How to compute a gradient, a divergence or a curl</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vector_calculus/vector_calc_curvilinear.html">How to perform vector calculus in curvilinear coordinates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vector_calculus/vector_calc_change.html">How to change coordinates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vector_calculus/vector_calc_advanced.html">Advanced aspects: the Euclidean space as a Riemannian manifold</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vector_calculus/vector_calc_plane.html">Vector calculus in the Euclidean plane</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../linear_programming.html">Linear Programming (Mixed Integer)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../numtheory_rsa.html">Number Theory and the RSA Public Key Cryptosystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../coding_theory.html">Coding Theory in Sage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../structures_in_coding_theory.html">How to write your own classes for coding theory</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../geometry.html">Polyhedra</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../geometry/polyhedra_quicktutorial.html">A Brief Introduction to Polytopes in Sage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/polyhedra_tutorial.html">A Longer Introduction to Polyhedral Computations in Sage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/polyhedra_quickref.html">Quick reference for polyhedra in Sage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/tips.html">Polyhedra tips and tricks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/visualization.html">Visualization of polyhedron objects in Sage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/polytope_tikz.html">Draw polytopes in LaTeX using TikZ</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../steenrod_algebra_modules.html">Steenrod Algebra Modules</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial-programming-python.html">Tutorial: Programming in Python and Sage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial-comprehensions.html">Tutorial: Comprehensions, Iterators, and Iterables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial-objects-and-classes.html">Tutorial: Objects and Classes in Python and Sage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../functional_programming.html">Functional Programming for Mathematicians</a></li>
<li class="toctree-l2"><a class="reference internal" href="../coercion_and_categories.html">How to implement new algebraic structures in Sage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial-implementing-algebraic-structures.html">Tutorial: Implementing Algebraic Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cython_interface.html">How to call a C code (or a compiled library) from Sage ?</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../numerical_sage/index.html">Numerical Computing with Sage</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../numerical_sage/numerical_tools.html">Numerical Tools</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../numerical_sage/numpy.html">NumPy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../numerical_sage/scipy.html">SciPy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../numerical_sage/cvxopt.html">Cvxopt</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../numerical_sage/using_compiled_code_iteractively.html">Using Compiled Code Interactively</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../numerical_sage/f2py.html">f2py</a></li>
<li class="toctree-l4"><a class="reference internal" href="../numerical_sage/f2py_examples.html">More Interesting Examples with f2py</a></li>
<li class="toctree-l4"><a class="reference internal" href="../numerical_sage/ctypes.html">Ctypes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../numerical_sage/ctypes_examples.html">More complicated ctypes example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../numerical_sage/comparison_to_cython.html">Comparison to Cython/Pyrex</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../numerical_sage/parallel_computation.html">Parallel Computation</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../numerical_sage/mpi4py.html">mpi4py</a></li>
<li class="toctree-l4"><a class="reference internal" href="../numerical_sage/parallel_laplace_solver.html">Parallel Laplace Solver</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../explicit_methods_in_number_theory/index.html">Three Lectures about Explicit Methods in Number Theory Using Sage</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../explicit_methods_in_number_theory/introduction.html">Introduction</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../explicit_methods_in_number_theory/number_fields.html">Number Fields</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/nf_introduction.html">Introduction to Number Fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/nf_galois_groups.html">Number Fields: Galois Groups and Class Groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/nf_orders.html">Orders and Relative Extensions</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../explicit_methods_in_number_theory/birds_eye_view.html">A Bird’s Eye View</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/integer_factorization.html">Integer Factorization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/elliptic_curves.html">Elliptic Curves</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/birds_other.html">The Matrix of Frobenius on Hyperelliptic Curves</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/birds_other.html#modular-symbols">Modular Symbols</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/birds_other.html#enumerating-totally-real-number-fields">Enumerating Totally Real Number Fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/birds_other.html#bernoulli-numbers">Bernoulli Numbers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/birds_other.html#polynomial-arithmetic">Polynomial Arithmetic</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../explicit_methods_in_number_theory/modular_forms.html">Modular Forms</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/modular_forms_and_hecke_operators.html">Modular Forms and Hecke Operators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/modular_symbols.html">Modular Symbols</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/method_of_graphs.html">Method of Graphs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/level_one_forms.html">Level One Modular Forms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/half_integral.html">Half Integral Weight Forms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/generators_for_rings.html">Generators for Rings of Modular Forms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/l_series.html"><span class="math notranslate nohighlight">\(L\)</span>-series</a></li>
<li class="toctree-l4"><a class="reference internal" href="../explicit_methods_in_number_theory/modabvar.html">Modular Abelian Varieties</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../profiling.html">Profiling in Sage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sws2rst.html">Creating a Tutorial from an old Sage Worksheet (.sws)</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="integrable-highest-weight-representations-of-affine-lie-algebras">
<h1>Integrable Highest Weight Representations of Affine Lie algebras<a class="headerlink" href="#integrable-highest-weight-representations-of-affine-lie-algebras" title="Permalink to this heading">#</a></h1>
<p>In this section <span class="math notranslate nohighlight">\(\mathfrak{g}\)</span> can be an arbitrary Kac-Moody Lie Algebra
made with a symmetrizable, indecomposable Cartan matrix.</p>
<p>Suppose that <span class="math notranslate nohighlight">\(V\)</span> is a representation with a weight space decomposition
as in <a class="reference internal" href="affine.html#roots-and-weights"><span class="std std-ref">Roots and Weights</span></a>.  Let <span class="math notranslate nohighlight">\(\alpha\)</span> be a real root, and let
<span class="math notranslate nohighlight">\(\mathfrak{g}_\alpha\)</span> be the corresponding root space, that is,
the one-dimensional weight space for <span class="math notranslate nohighlight">\(\alpha\)</span> in the adjoint
representation of <span class="math notranslate nohighlight">\(\mathfrak{g}\)</span> on itself. Then <span class="math notranslate nohighlight">\(-\alpha\)</span> is also
a root. The two one-dimensional spaces <span class="math notranslate nohighlight">\(\mathfrak{g}_\alpha\)</span> and
<span class="math notranslate nohighlight">\(\mathfrak{g}_{-\alpha}\)</span> generate a Lie algebra isomorphic to
<span class="math notranslate nohighlight">\(\mathfrak{sl}_2\)</span>. The module <span class="math notranslate nohighlight">\(V\)</span> is called <em>integrable</em> if for each
such <span class="math notranslate nohighlight">\(\alpha\)</span> the representation of <span class="math notranslate nohighlight">\(\mathfrak{sl}_2\)</span> obtained this
way integrates to a representation of the Lie group <span class="math notranslate nohighlight">\(\operatorname{SL}_2\)</span>.
Since this group contains an element that stabilizes <span class="math notranslate nohighlight">\(\mathfrak{h}\)</span>
and induces the corresponding simple reflection on the weight lattice,
integrability implies that the weight multiplicities are invariant
under the action of the Weyl group.</p>
<p>If the Kac-Moody Lie algebra <span class="math notranslate nohighlight">\(\mathfrak{g}\)</span> is finite-dimensional
then the integrable highest weight representations are
just the irreducible finite-dimensional ones. For a general
Kac-Moody Lie algebra the integrable highest weight representations
are the analogs of the finite-dimensional ones, that is,
with <a class="reference external" href="../../reference/combinat/sage/combinat/root_system/weyl_characters.html#sage.combinat.root_system.weyl_characters.WeylCharacterRing" title="(in Combinatorics v10.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">WeylCharacterRing</span></code></a> elements. Their
theory has many aspects in common with the finite-dimensional
representations of finite-dimensional simple Lie algebras,
such as the parametrization by dominant weights, and
generalizations of the Weyl denominator and character
formulas, due to Macdonald and Kac respectively.</p>
<p>If <span class="math notranslate nohighlight">\(\Lambda\)</span> is a dominant weight, then the irreducible
highest weight module <span class="math notranslate nohighlight">\(L(\Lambda)\)</span> defined in <a class="reference internal" href="affine.html#roots-and-weights"><span class="std std-ref">Roots and Weights</span></a>
is integrable. Moreover every highest weight integrable representation
arises this way, so these representations are in bijection with the
cone <span class="math notranslate nohighlight">\(P^+\)</span> of dominant weights.</p>
<section id="the-affine-case">
<h2>The affine case<a class="headerlink" href="#the-affine-case" title="Permalink to this heading">#</a></h2>
<p>Now we assume that <span class="math notranslate nohighlight">\(\mathfrak{g}\)</span> is affine. The integrable
highest weight representations (and their crystals) are
extremely interesting. Integrable highest weight representations of
<span class="math notranslate nohighlight">\(\mathfrak{g}\)</span> arise in a variety of contexts, from string
theory to the modular representation theory of the symmetric
groups, and the theory of modular forms. The representation <span class="math notranslate nohighlight">\(L(\Lambda_0)\)</span>
is particularly ubiquitous and is called the <em>basic representation</em>.</p>
<p>Therefore in <a class="reference internal" href="bibliography.html#kmps" id="id1"><span>[KMPS]</span></a> (published in 1990) tabulated data for
many of these representations. They wrote</p>
<blockquote>
<div><p>We present a vast quantity of numerical data in tabular form, this
being the only source for such information. The computations are tedious
and not particularly straightforward when it is necessary to carry them
out individually. We hope the appearance of this book will spur interest
in a field that has become, in barely 20 years, deeply rewarding and
full of promise for the future. It would indeed be gratifying if these
tables were to appear to the scientists of 2040 as obsolete as the
dust-gathering compilations of transcendental functions appear for us
today because of their availability on every pocket calculator.</p>
</div></blockquote>
<p>As we will explain, Sage can reproduce the contents of these tables.
Moreover the tables in <a class="reference internal" href="bibliography.html#kmps" id="id2"><span>[KMPS]</span></a> are limited to the untwisted types,
but Sage also implements the twisted types.</p>
<p>Although Sage can reproduce the tables in the second volume of <a class="reference internal" href="bibliography.html#kmps" id="id3"><span>[KMPS]</span></a>,
the work remains very useful. The first volume is a down-to-earth
and very helpful exposition of the theory of integrable representations
of affine Lie algebras with explicit examples and explanations of the
connections with mathematical physics and vertex operators.</p>
</section>
<section id="the-support-of-an-integrable-highest-weight-representation">
<span id="support-integrable"></span><h2>The support of an integrable highest weight representation<a class="headerlink" href="#the-support-of-an-integrable-highest-weight-representation" title="Permalink to this heading">#</a></h2>
<p>Let <span class="math notranslate nohighlight">\(\Lambda \in P^+\)</span> and let <span class="math notranslate nohighlight">\(V = L(\Lambda)\)</span> be the integrable
representation with highest weight <span class="math notranslate nohighlight">\(\Lambda\)</span>. If <span class="math notranslate nohighlight">\(\mu\)</span> is another
weight, let <span class="math notranslate nohighlight">\(\operatorname{mult}(\mu)\)</span> denote the multiplicity of
the weight <span class="math notranslate nohighlight">\(\mu\)</span> in <span class="math notranslate nohighlight">\(L(\Lambda)\)</span>. Define the <em>support</em> of the
representation <span class="math notranslate nohighlight">\(\operatorname{supp}(V)\)</span> to be the set of <span class="math notranslate nohighlight">\(\mu\)</span>
such that <span class="math notranslate nohighlight">\(\operatorname{mult}(\mu) &gt; 0\)</span>.</p>
<p>If <span class="math notranslate nohighlight">\(\operatorname{mult}(\mu) &gt; 0\)</span> then <span class="math notranslate nohighlight">\(\lambda-\mu\)</span> is a linear
combination of the simple roots with nonnegative integer coefficients.
Moreover <span class="math notranslate nohighlight">\(\operatorname{supp}(V)\)</span> is contained in the paraboloid</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[(\Lambda+\rho | \Lambda+\rho) - (\mu+\rho | \mu+\rho) \geq 0\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\((\, | \,)\)</span> is the invariant inner product on the weight
lattice and <span class="math notranslate nohighlight">\(\rho\)</span> is the Weyl vector (<a class="reference internal" href="affine.html#untwisted-affine"><span class="std std-ref">Untwisted Affine Kac-Moody Lie Algebras</span></a>).
Moreover if <span class="math notranslate nohighlight">\(\mu \in \operatorname{supp}(V)\)</span> then <span class="math notranslate nohighlight">\(\Lambda - \mu\)</span>
is an element of the root lattice <span class="math notranslate nohighlight">\(Q\)</span> (<a class="reference internal" href="bibliography.html#kac" id="id4"><span>[Kac]</span></a>, Propositions 11.3 and 11.4).</p>
<p>We organize the weight multiplicities into sequences called
<em>string functions</em> or <em>strings</em> as follows. By <a class="reference internal" href="bibliography.html#kac" id="id5"><span>[Kac]</span></a>, Proposition 11.3
or Corollary 11.9, for fixed <span class="math notranslate nohighlight">\(\mu\)</span> the function
<span class="math notranslate nohighlight">\(\operatorname{mult}(\mu - k\delta)\)</span> of <span class="math notranslate nohighlight">\(k\)</span> is an increasing sequence.
We adjust <span class="math notranslate nohighlight">\(\mu\)</span> by a multiple of <span class="math notranslate nohighlight">\(\delta\)</span> to the beginning
of the positive part of the sequence. Thus we define <span class="math notranslate nohighlight">\(\mu\)</span> to be
<em>maximal</em> if <span class="math notranslate nohighlight">\(\operatorname{mult}(\mu) \neq 0\)</span> but
<span class="math notranslate nohighlight">\(\operatorname{mult}(\mu + \delta) = 0\)</span>.</p>
<p>Since <span class="math notranslate nohighlight">\(\delta\)</span> is fixed under the action of the affine Weyl group, and
since the weight multiplicities are Weyl group invariant, the function
<span class="math notranslate nohighlight">\(k \mapsto \operatorname{mult}(\mu - k \delta)\)</span> is unchanged if <span class="math notranslate nohighlight">\(\mu\)</span>
is replaced by <span class="math notranslate nohighlight">\(w(\mu)\)</span> for some Weyl group element <span class="math notranslate nohighlight">\(w\)</span>. Now every
Weyl orbit contains a dominant weight.  Therefore in enumerating the
string we may assume that the weight <span class="math notranslate nohighlight">\(\mu\)</span> is dominant. There are only
a finite number of dominant maximal weights. Thus there are only a
finite number of such strings to be computed.</p>
</section>
<section id="modular-forms">
<h2>Modular Forms<a class="headerlink" href="#modular-forms" title="Permalink to this heading">#</a></h2>
<p>Remarkably, <a class="reference internal" href="bibliography.html#kacpeterson" id="id6"><span>[KacPeterson]</span></a> showed that each string is the set of
Fourier coefficients of a weakly holomorphic modular form; see also
<a class="reference internal" href="bibliography.html#kac" id="id7"><span>[Kac]</span></a> Chapters 12 and 13. Here <em>weakly holomorphic modular</em> means
that the form is allowed to have poles at cusps.</p>
<p>To this end we define the <em>modular characteristic</em></p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[m_\Lambda = \frac{|\Lambda+\rho|^2}{2(k+h^\vee)} - \frac{|\rho|^2}{2h^\vee}.\]</div>
</div>
<p>Here <span class="math notranslate nohighlight">\(k = (\Lambda | \delta)\)</span> is the <em>level</em> of the representation and
<span class="math notranslate nohighlight">\(h^\vee\)</span> is the dual Coxeter number (<a class="reference internal" href="affine.html#coxeternumber"><span class="std std-ref">Labels and Coxeter Number</span></a>).
If <span class="math notranslate nohighlight">\(\mu\)</span> is a weight, define</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[m_{\Lambda,\mu} = m_\Lambda - \frac{|\mu|^2}{2k}.\]</div>
</div>
<p>Let <span class="math notranslate nohighlight">\(\Lambda\)</span> be a weight, which we may assume maximal. Then Kac
and Peterson defined the <em>string function</em></p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[c_\mu^\Lambda = q^{m_{\Lambda,\mu}}
    \sum_{n\in\ZZ} \operatorname{mult}(\mu - n\delta) q^n.\]</div>
</div>
<p>Although these do arise as partition functions in string theory, the
term “string” here does not refer to physical strings.</p>
<p>The string function <span class="math notranslate nohighlight">\(c_\mu^\Lambda\)</span> is a weakly holomorphic modular
form, possibly of half-integral weight. See <a class="reference internal" href="bibliography.html#kac" id="id8"><span>[Kac]</span></a>, Corollary 13.10,
or <a class="reference internal" href="bibliography.html#kacpeterson" id="id9"><span>[KacPeterson]</span></a>. It can have poles at infinity, but multiplying
<span class="math notranslate nohighlight">\(c_\mu^\Lambda\)</span> by <span class="math notranslate nohighlight">\(\eta(\tau)^{\dim\,\mathfrak{g}^\circ}\)</span> gives
a holomorphic modular form (for some level). Here <span class="math notranslate nohighlight">\(\eta\)</span> is the
Dedekind eta function:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\eta(\tau) = q^{1/24} \prod_{k=1}^\infty(1-q^k),
    \qquad q = e^{2\pi i \tau}.\]</div>
</div>
<p>The weight of this modular form <span class="math notranslate nohighlight">\(\eta(\tau)^{\dim\,\mathfrak{g}^\circ}
c^\Lambda_\lambda\)</span> is the number of positive roots of <span class="math notranslate nohighlight">\(\mathfrak{g}^\circ\)</span>.</p>
</section>
<section id="sage-methods-for-integrable-representations">
<h2>Sage methods for integrable representations<a class="headerlink" href="#sage-methods-for-integrable-representations" title="Permalink to this heading">#</a></h2>
<p>In this section we will show how to use Sage to compute with
integrable highest weight representations of affine Lie algebras.
For further documentation, see the reference manual
<a class="reference external" href="../../reference/combinat/sage/combinat/root_system/integrable_representations.html#sage.combinat.root_system.integrable_representations.IntegrableRepresentation" title="(in Combinatorics v10.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">IntegrableRepresentation</span></code></a>.</p>
<p>In the following example, we work with the integrable representation
with highest weight <span class="math notranslate nohighlight">\(2 \Lambda_0\)</span> for <span class="math notranslate nohighlight">\(\widehat{\mathfrak{sl}}_2\)</span>,
that is, <span class="math notranslate nohighlight">\(A_1^{(1)}\)</span>. First we create a dominant weight in
the extended weight lattice, then create the <code class="docutils literal notranslate"><span class="pre">IntegrableRepresentation</span></code>
class. We compute the strings. There are two, since there are two
dominant maximal weights. One of them is the highest weight <span class="math notranslate nohighlight">\(2\Lambda_0\)</span>,
and the other is <span class="math notranslate nohighlight">\(2\Lambda_1 - \delta\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">(</span><span class="s2">&quot;A1~&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Lambda</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">delta</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">null_root</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">weyl_group</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s0</span><span class="p">,</span> <span class="n">s1</span> <span class="o">=</span> <span class="n">W</span><span class="o">.</span><span class="n">simple_reflections</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">IntegrableRepresentation</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Lambda</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">strings</span><span class="p">()</span>
<span class="go">{2*Lambda[0]: [1, 1, 3, 5, 10, 16, 28, 43, 70, 105, 161, 236],</span>
<span class="go"> 2*Lambda[1] - delta: [1, 2, 4, 7, 13, 21, 35, 55, 86, 130, 196, 287]}</span>
<span class="gp">sage: </span><span class="n">mw1</span><span class="p">,</span> <span class="n">mw2</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">dominant_maximal_weights</span><span class="p">();</span> <span class="n">mw1</span><span class="p">,</span> <span class="n">mw2</span>
<span class="go">(2*Lambda[0], 2*Lambda[1] - delta)</span>
</pre></div>
</div>
<p>We see there are two dominant maximal weights, <span class="math notranslate nohighlight">\(2 \Lambda_0\)</span> and
<span class="math notranslate nohighlight">\(2 \Lambda_1 - \delta\)</span>. We obtain every maximal weight from these
by applying Weyl group elements. These lie inside the paraboloid
described in <a class="reference internal" href="#support-integrable"><span class="std std-ref">The support of an integrable highest weight representation</span></a>. Here are a few more
maximal weights:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="n">s0</span><span class="o">*</span><span class="n">s1</span><span class="o">*</span><span class="n">s0</span><span class="p">,</span> <span class="n">mw1</span><span class="p">),</span> <span class="p">(</span><span class="n">s0</span><span class="o">*</span><span class="n">s1</span><span class="p">,</span> <span class="n">mw2</span><span class="p">),</span> <span class="p">(</span><span class="n">s0</span><span class="p">,</span> <span class="n">mw1</span><span class="p">),</span> <span class="p">(</span><span class="n">W</span><span class="o">.</span><span class="n">one</span><span class="p">(),</span> <span class="n">mw2</span><span class="p">),</span>
<span class="gp">....: </span>         <span class="p">(</span><span class="n">W</span><span class="o">.</span><span class="n">one</span><span class="p">(),</span> <span class="n">mw1</span><span class="p">),</span> <span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">mw2</span><span class="p">),</span> <span class="p">(</span><span class="n">s1</span><span class="o">*</span><span class="n">s0</span><span class="p">,</span> <span class="n">mw1</span><span class="p">),</span> <span class="p">(</span><span class="n">s1</span><span class="o">*</span><span class="n">s0</span><span class="o">*</span><span class="n">s1</span><span class="p">,</span> <span class="n">mw2</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">mw</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">mw</span><span class="p">)</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">]</span>
<span class="go">[-6*Lambda[0] + 8*Lambda[1] - 8*delta,</span>
<span class="go"> -4*Lambda[0] + 6*Lambda[1] - 5*delta,</span>
<span class="go"> -2*Lambda[0] + 4*Lambda[1] - 2*delta,</span>
<span class="go"> 2*Lambda[1] - delta,</span>
<span class="go"> 2*Lambda[0],</span>
<span class="go"> 4*Lambda[0] - 2*Lambda[1] - delta,</span>
<span class="go"> 6*Lambda[0] - 4*Lambda[1] - 2*delta,</span>
<span class="go"> 8*Lambda[0] - 6*Lambda[1] - 5*delta]</span>
</pre></div>
</div>
<p>We confirm that the string function for one in the Weyl orbit
is the same as that for <code class="docutils literal notranslate"><span class="pre">mw2</span></code>, calculated above:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s1</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">mw2</span><span class="p">)</span>
<span class="go">4*Lambda[0] - 2*Lambda[1] - delta</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">V</span><span class="o">.</span><span class="n">mult</span><span class="p">(</span><span class="n">s0</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">mw2</span><span class="p">)</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">delta</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0..10</span><span class="p">]]</span>
<span class="go">[1, 2, 4, 7, 13, 21, 35, 55, 86, 130, 196]</span>
</pre></div>
</div>
<p>String functions of integrable representations often appear
in the Online Encyclopedia of Integer Sequences:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">oeis</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">V</span><span class="o">.</span><span class="n">strings</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>    <span class="c1"># optional - internet</span>
<span class="go">[0: A233758: Bisection of A006950 (the even part).,</span>
<span class="go"> 0: A233759: Bisection of A006950 (the odd part).]</span>
</pre></div>
</div>
<p>Reading what the OEIS tells us about the sequence <a class="reference external" href="https://oeis.org/A006950">OEIS sequence A006950</a>,
we learn that the two strings are the odd and even parts of the series</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\prod_{k=1}^\infty \frac{1+q^{2k-1}}{1-q^{2k}}
= \prod_{k=1}^\infty \frac{1-q^{2k}}{(1-q^k)(1-q^{4k})}
= q^{1/8} \frac{\eta(2\tau)}{\eta(\tau)\eta(4\tau)}\]</div>
</div>
<p>This is <em>not</em> a modular form because of the factor <span class="math notranslate nohighlight">\(q^{1/8}\)</span> in
front of the ratio of eta functions.</p>
<p>Let us confirm what the Online Encyclopedia tells us by computing
the above product:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">PS</span><span class="o">.&lt;</span><span class="n">q</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">prod</span><span class="p">([(</span><span class="mi">1</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1..20</span><span class="p">]])</span>
<span class="go">1 + q + q^2 + 2*q^3 + 3*q^4 + 4*q^5 + 5*q^6 + 7*q^7 + 10*q^8</span>
<span class="go"> + 13*q^9 + 16*q^10 + 21*q^11 + 28*q^12 + 35*q^13 + 43*q^14</span>
<span class="go"> + 55*q^15 + 70*q^16 + 86*q^17 + 105*q^18 + 130*q^19 + O(q^20)</span>
</pre></div>
</div>
<p>We see the values of the two strings interspersed in this
product, with the <span class="math notranslate nohighlight">\(2 \Lambda_0\)</span> string values in the even
positions and the <span class="math notranslate nohighlight">\(2 \Lambda_1 - \delta\)</span> values in the odd positions.</p>
<p>To compute <span class="math notranslate nohighlight">\(c^{2\Lambda_0}_\lambda\)</span>, which is guaranteed to be
a modular form, we must compute the modular characteristics.
We are interested in the cases where <span class="math notranslate nohighlight">\(\lambda\)</span> is one of the
two dominant maximal weights:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">V</span><span class="o">.</span><span class="n">modular_characteristic</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">Lambda</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="o">*</span><span class="n">Lambda</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">delta</span><span class="p">]]</span>
<span class="go">[-1/16, 7/16]</span>
</pre></div>
</div>
<p>This gives us the string functions</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
c^{2\Lambda_0}_{2\Lambda_0} &amp; = q^{-1/16}(1+q+3q^2+5q^3+10q^4+16q^5+\cdots),\\
c^{2\Lambda_0}_{2\Lambda_1-\delta} &amp; = q^{7/16}(1+2q+4q^2+7q^3+13q^4+21q^5+\cdots).
\end{aligned}\end{split}\]</div>
</div>
<p>These are both weakly holomorphic modular forms. Any linear combination
of these two is also a weakly holomorphic modular form. For example we
may replace <span class="math notranslate nohighlight">\(\tau\)</span> by <span class="math notranslate nohighlight">\(\tau/2\)</span> in our previous identity and get</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[c^{2\Lambda_0}_{2\Lambda_0} + c^{2\Lambda_0}_{2\Lambda_1-\delta}
= \frac{\eta(\tau)}{\eta(\tau/2)\eta(2\tau)}.\]</div>
</div>
<p>Many more examples may be found in <a class="reference internal" href="bibliography.html#kacpeterson" id="id10"><span>[KacPeterson]</span></a> and <a class="reference internal" href="bibliography.html#kmps" id="id11"><span>[KMPS]</span></a>.</p>
<p>Let <span class="math notranslate nohighlight">\(V\)</span> be the integrable highest weight representation with highest
weight <span class="math notranslate nohighlight">\(\Lambda\)</span>. If <span class="math notranslate nohighlight">\(\mu\)</span> is in the support of <span class="math notranslate nohighlight">\(V\)</span> then <span class="math notranslate nohighlight">\(\Lambda - \mu\)</span>
is of the form <span class="math notranslate nohighlight">\(\sum_i n_i\alpha_i\)</span> where <span class="math notranslate nohighlight">\(\alpha_i\)</span> are the simple roots.
Sage employs an internal representation of the weights as tuples
<span class="math notranslate nohighlight">\((n_0, n_1, \ldots)\)</span>. You can convert weights to and from this
notation as follows:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Lambda</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">delta</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">null_root</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">IntegrableRepresentation</span><span class="p">(</span><span class="n">Lambda</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">strings</span><span class="p">()</span>
<span class="go">{Lambda[0]: [1, 2, 7, 14, 35, 66, 140, 252, 485, 840, 1512, 2534]}</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">to_weight</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">Lambda[0] - 3*Lambda[1] + 4*Lambda[2] - 2*Lambda[3] + Lambda[4] - delta</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">from_weight</span><span class="p">(</span><span class="n">Lambda</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">Lambda</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">Lambda</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">Lambda</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">Lambda</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">-</span> <span class="n">delta</span><span class="p">)</span>
<span class="go">(1, 2, 0, 1, 0)</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">from_weight</span><span class="p">(</span><span class="n">Lambda</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">delta</span><span class="p">)</span>
<span class="go">(1, 2, 3, 2, 1)</span>
</pre></div>
</div>
<p>In reporting the strings, one may set the optional parameter depth to
get more or fewer values. In certain cases even the first coefficient
of the string is significant.  See <a class="reference internal" href="bibliography.html#jaynemisra2014" id="id12"><span>[JayneMisra2014]</span></a> and <a class="reference internal" href="bibliography.html#kimleeoh2017" id="id13"><span>[KimLeeOh2017]</span></a>.</p>
<p>Catalan numbers (<a class="reference external" href="https://oeis.org/A000108">OEIS sequence A000108</a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="n">true</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Lambda</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">IntegrableRepresentation</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Lambda</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">strings</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># long time</span>
<span class="go">{2*Lambda[0]: [1],</span>
<span class="go"> Lambda[1] + Lambda[12] - delta: [1],</span>
<span class="go"> Lambda[2] + Lambda[11] - 2*delta: [2],</span>
<span class="go"> Lambda[3] + Lambda[10] - 3*delta: [5],</span>
<span class="go"> Lambda[4] + Lambda[9] - 4*delta: [14],</span>
<span class="go"> Lambda[5] + Lambda[8] - 5*delta: [42],</span>
<span class="go"> Lambda[6] + Lambda[7] - 6*delta: [132]}</span>
</pre></div>
</div>
<p>Catalan triangle numbers (<a class="reference external" href="https://oeis.org/A000245">OEIS sequence A000245</a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">IntegrableRepresentation</span><span class="p">(</span><span class="n">Lambda</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">Lambda</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">strings</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="c1"># long time</span>
<span class="go">[[1], [3], [9], [12], [28], [90], [297]]</span>
</pre></div>
</div>
<p>Central binomial coefficients (<a class="reference external" href="https://oeis.org/A001700">OEIS sequence A001700</a>, <a class="reference external" href="https://oeis.org/A128015">OEIS sequence A128015</a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="n">true</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Lambda</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">IntegrableRepresentation</span><span class="p">(</span><span class="n">Lambda</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">Lambda</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">strings</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="c1"># long time</span>
<span class="go">[[1], [1], [1], [3], [3], [10], [10], [35], [35], [126]]</span>
</pre></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="affine_finite_crystals.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Affine Finite Crystals</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="affine.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Affine Root System Basics</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2023, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Integrable Highest Weight Representations of Affine Lie algebras</a><ul>
<li><a class="reference internal" href="#the-affine-case">The affine case</a></li>
<li><a class="reference internal" href="#the-support-of-an-integrable-highest-weight-representation">The support of an integrable highest weight representation</a></li>
<li><a class="reference internal" href="#modular-forms">Modular Forms</a></li>
<li><a class="reference internal" href="#sage-methods-for-integrable-representations">Sage methods for integrable representations</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "lcm": "\\mathop{\\operatorname{lcm}}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <script src="../_static/jupyter-sphinx-furo.js"></script>
    </body>
</html>