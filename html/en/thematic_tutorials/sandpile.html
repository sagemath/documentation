<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Group Theory and Sage" href="group_theory.html" /><link rel="prev" title="Young’s lattice and the RSK algorithm" href="algebraic_combinatorics/rsk.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>Abelian Sandpile Model - Thematic Tutorials</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="_static/custom-furo.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZGD13B5572"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-ZGD13B5572');
</script></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Thematic Tutorials</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 9.8 Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="index.html">Home - Thematic Tutorials</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="toctree.html">Thematic tutorial document tree</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="algebraic_combinatorics.html">Algebraic Combinatorics in Sage</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="algebraic_combinatorics/walks.html">Walks in graphs</a></li>
<li class="toctree-l3"><a class="reference internal" href="algebraic_combinatorics/n_cube.html"><span class="math notranslate nohighlight">\(n\)</span>-Cube</a></li>
<li class="toctree-l3"><a class="reference internal" href="algebraic_combinatorics/tsetlin_library.html">The Tsetlin library</a></li>
<li class="toctree-l3"><a class="reference internal" href="algebraic_combinatorics/rsk.html">Young’s lattice and the RSK algorithm</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children current-page"><a class="current reference internal" href="#">Abelian Sandpile Model</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="group_theory.html">Group Theory and Sage</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="lie.html">Lie Methods and Related Combinatorics in Sage</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="lie/introduction.html">The Scope of this Document</a></li>
<li class="toctree-l3"><a class="reference internal" href="lie/lie_basics.html">Lie Group Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="lie/weyl_character_ring.html">The Weyl Character Ring</a></li>
<li class="toctree-l3"><a class="reference internal" href="lie/branching_rules.html">Maximal Subgroups and Branching Rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="lie/weyl_groups.html">Weyl Groups, Coxeter Groups and the Bruhat Order</a></li>
<li class="toctree-l3"><a class="reference internal" href="lie/crystals.html">Classical Crystals</a></li>
<li class="toctree-l3"><a class="reference internal" href="lie/affine.html">Affine Root System Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="lie/integrable.html">Integrable Highest Weight Representations of Affine Lie algebras</a></li>
<li class="toctree-l3"><a class="reference internal" href="lie/affine_finite_crystals.html">Affine Finite Crystals</a></li>
<li class="toctree-l3"><a class="reference internal" href="lie/affine_hw_crystals.html">Affine Highest Weight Crystals</a></li>
<li class="toctree-l3"><a class="reference internal" href="lie/elementary_crystals.html">Elementary crystals</a></li>
<li class="toctree-l3"><a class="reference internal" href="lie/infinity_crystals.html">Infinity Crystals</a></li>
<li class="toctree-l3"><a class="reference internal" href="lie/iwahori_hecke_algebra.html">Iwahori Hecke Algebras</a></li>
<li class="toctree-l3"><a class="reference internal" href="lie/kazhdan_lusztig_polynomials.html">Kazhdan-Lusztig Polynomials</a></li>
<li class="toctree-l3"><a class="reference internal" href="lie/bibliography.html">Bibliography</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="vector_calculus.html">Tutorial: Vector Calculus in Euclidean Spaces</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="vector_calculus/vector_calc_cartesian.html">How to compute a gradient, a divergence or a curl</a></li>
<li class="toctree-l3"><a class="reference internal" href="vector_calculus/vector_calc_curvilinear.html">How to perform vector calculus in curvilinear coordinates</a></li>
<li class="toctree-l3"><a class="reference internal" href="vector_calculus/vector_calc_change.html">How to change coordinates</a></li>
<li class="toctree-l3"><a class="reference internal" href="vector_calculus/vector_calc_advanced.html">Advanced aspects: the Euclidean space as a Riemannian manifold</a></li>
<li class="toctree-l3"><a class="reference internal" href="vector_calculus/vector_calc_plane.html">Vector calculus in the Euclidean plane</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="linear_programming.html">Linear Programming (Mixed Integer)</a></li>
<li class="toctree-l2"><a class="reference internal" href="numtheory_rsa.html">Number Theory and the RSA Public Key Cryptosystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="coding_theory.html">Coding Theory in Sage</a></li>
<li class="toctree-l2"><a class="reference internal" href="structures_in_coding_theory.html">How to write your own classes for coding theory</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="geometry.html">Polyhedra</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="geometry/polyhedra_quicktutorial.html">A Brief Introduction to Polytopes in Sage</a></li>
<li class="toctree-l3"><a class="reference internal" href="geometry/polyhedra_tutorial.html">A Longer Introduction to Polyhedral Computations in Sage</a></li>
<li class="toctree-l3"><a class="reference internal" href="geometry/polyhedra_quickref.html">Quick reference for polyhedra in Sage</a></li>
<li class="toctree-l3"><a class="reference internal" href="geometry/tips.html">Polyhedra tips and tricks</a></li>
<li class="toctree-l3"><a class="reference internal" href="geometry/visualization.html">Visualization of polyhedron objects in Sage</a></li>
<li class="toctree-l3"><a class="reference internal" href="geometry/polytope_tikz.html">Draw polytopes in LaTeX using TikZ</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="steenrod_algebra_modules.html">Steenrod Algebra Modules</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial-programming-python.html">Tutorial: Programming in Python and Sage</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial-comprehensions.html">Tutorial: Comprehensions, Iterators, and Iterables</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial-objects-and-classes.html">Tutorial: Objects and Classes in Python and Sage</a></li>
<li class="toctree-l2"><a class="reference internal" href="functional_programming.html">Functional Programming for Mathematicians</a></li>
<li class="toctree-l2"><a class="reference internal" href="coercion_and_categories.html">How to implement new algebraic structures in Sage</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial-implementing-algebraic-structures.html">Tutorial: Implementing Algebraic Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="cython_interface.html">How to call a C code (or a compiled library) from Sage ?</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="numerical_sage/index.html">Numerical Computing with Sage</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="numerical_sage/numerical_tools.html">Numerical Tools</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="numerical_sage/numpy.html">NumPy</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical_sage/scipy.html">SciPy</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical_sage/cvxopt.html">Cvxopt</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="numerical_sage/using_compiled_code_iteractively.html">Using Compiled Code Interactively</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="numerical_sage/f2py.html">f2py</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical_sage/f2py_examples.html">More Interesting Examples with f2py</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical_sage/ctypes.html">Ctypes</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical_sage/ctypes_examples.html">More complicated ctypes example</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical_sage/comparison_to_cython.html">Comparison to Cython/Pyrex</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="numerical_sage/parallel_computation.html">Parallel Computation</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="numerical_sage/mpi4py.html">mpi4py</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical_sage/parallel_laplace_solver.html">Parallel Laplace Solver</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="explicit_methods_in_number_theory/index.html">Three Lectures about Explicit Methods in Number Theory Using Sage</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="explicit_methods_in_number_theory/introduction.html">Introduction</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="explicit_methods_in_number_theory/number_fields.html">Number Fields</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/nf_introduction.html">Introduction to Number Fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/nf_galois_groups.html">Number Fields: Galois Groups and Class Groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/nf_orders.html">Orders and Relative Extensions</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="explicit_methods_in_number_theory/birds_eye_view.html">A Bird’s Eye View</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/integer_factorization.html">Integer Factorization</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/elliptic_curves.html">Elliptic Curves</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/birds_other.html">The Matrix of Frobenius on Hyperelliptic Curves</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/birds_other.html#modular-symbols">Modular Symbols</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/birds_other.html#enumerating-totally-real-number-fields">Enumerating Totally Real Number Fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/birds_other.html#bernoulli-numbers">Bernoulli Numbers</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/birds_other.html#polynomial-arithmetic">Polynomial Arithmetic</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="explicit_methods_in_number_theory/modular_forms.html">Modular Forms</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/modular_forms_and_hecke_operators.html">Modular Forms and Hecke Operators</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/modular_symbols.html">Modular Symbols</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/method_of_graphs.html">Method of Graphs</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/level_one_forms.html">Level One Modular Forms</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/half_integral.html">Half Integral Weight Forms</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/generators_for_rings.html">Generators for Rings of Modular Forms</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/l_series.html"><span class="math notranslate nohighlight">\(L\)</span>-series</a></li>
<li class="toctree-l4"><a class="reference internal" href="explicit_methods_in_number_theory/modabvar.html">Modular Abelian Varieties</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="profiling.html">Profiling in Sage</a></li>
<li class="toctree-l2"><a class="reference internal" href="sws2rst.html">Creating a Tutorial from an old Sage Worksheet (.sws)</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="abelian-sandpile-model">
<span id="id1"></span><h1>Abelian Sandpile Model<a class="headerlink" href="#abelian-sandpile-model" title="Permalink to this heading">#</a></h1>
<p><em>Author: David Perkinson, Reed College</em></p>
<div class="toctree-wrapper compound">
</div>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p>These notes provide an introduction to Dhar’s abelian sandpile model (ASM) and
to Sage Sandpiles, a collection of tools in Sage for doing sandpile
calculations.  For a more thorough introduction to the theory of the ASM, the
papers <em>Chip-Firing and Rotor-Routing on Directed Graphs</em> <a class="reference internal" href="#h" id="id2"><span>[H]</span></a> by Holroyd et
al., and <em>Riemann-Roch and Abel-Jacobi Theory on a Finite Graph</em> by Baker and
Norine <a class="reference internal" href="#bn" id="id3"><span>[BN]</span></a> are recommended. See also <a class="reference internal" href="#ppw2013" id="id4"><span>[PPW2013]</span></a>.</p>
<p>To describe the ASM, we start with a <em>sandpile graph</em>: a directed multigraph
<span class="math notranslate nohighlight">\(\Gamma\)</span> with a vertex <span class="math notranslate nohighlight">\(s\)</span> that is accessible from every vertex.
By <em>multigraph</em>, we mean that each edge of <span class="math notranslate nohighlight">\(\Gamma\)</span> is assigned a nonnegative
integer weight.  To say <span class="math notranslate nohighlight">\(s\)</span> is <em>accessible</em> from some vertex <span class="math notranslate nohighlight">\(v\)</span> means that
there is a sequence (possibly empty) of directed edges starting at <span class="math notranslate nohighlight">\(v\)</span> and
ending at <span class="math notranslate nohighlight">\(s\)</span>.  We call <span class="math notranslate nohighlight">\(s\)</span> the <em>sink</em> of the sandpile graph, even though it
might have outgoing edges, for reasons that will be made clear in a moment.</p>
<p>We denote the vertex set of <span class="math notranslate nohighlight">\(\Gamma\)</span> by <span class="math notranslate nohighlight">\(V\)</span>, and define <span class="math notranslate nohighlight">\(\tilde{V} = V\setminus\{s\}\)</span>.
For any vertex <span class="math notranslate nohighlight">\(v\)</span>, we let <span class="math notranslate nohighlight">\(\mbox{out-degree}(v)\)</span> (the <em>out-degree</em> of
<span class="math notranslate nohighlight">\(v\)</span>) be the sum of the weights of all edges leaving <span class="math notranslate nohighlight">\(v\)</span>.</p>
<section id="configurations-and-divisors">
<h3>Configurations and divisors<a class="headerlink" href="#configurations-and-divisors" title="Permalink to this heading">#</a></h3>
<p>A <em>configuration</em> on <span class="math notranslate nohighlight">\(\Gamma\)</span> is an element of <span class="math notranslate nohighlight">\(\ZZ_{\geq 0} \tilde{V}\)</span>,
i.e., the assignment of a nonnegative integer to each nonsink vertex.
We think of each integer as a number of grains of sand being placed at
the corresponding vertex.  A <em>divisor</em> on <span class="math notranslate nohighlight">\(\Gamma\)</span> is an element of <span class="math notranslate nohighlight">\(\ZZ V\)</span>,
i.e., an element in the free abelian group on <em>all</em> of the vertices.
In the context of divisors, it is sometimes useful to think of a divisor
on <span class="math notranslate nohighlight">\(\Gamma\)</span> as assigning dollars to each vertex, with negative integers
signifying a debt.</p>
</section>
<section id="stabilization">
<h3>Stabilization<a class="headerlink" href="#stabilization" title="Permalink to this heading">#</a></h3>
<p>A configuration <span class="math notranslate nohighlight">\(c\)</span> is <em>stable</em> at a vertex <span class="math notranslate nohighlight">\(v\in\tilde{V}\)</span> if
<span class="math notranslate nohighlight">\(c(v) &lt; \mbox{out-degree}(v)\)</span>.  Otherwise, <span class="math notranslate nohighlight">\(c\)</span> is <em>unstable</em> at <span class="math notranslate nohighlight">\(v\)</span>.
A configuration <span class="math notranslate nohighlight">\(c\)</span> (in itself) is <em>stable</em> if it is stable
at each nonsink vertex.  Otherwise, <span class="math notranslate nohighlight">\(c\)</span> is <em>unstable</em>.
If <span class="math notranslate nohighlight">\(c\)</span> is unstable at <span class="math notranslate nohighlight">\(v\)</span>, the vertex <span class="math notranslate nohighlight">\(v\)</span> can be <em>fired</em> (<em>toppled</em>)
by removing <span class="math notranslate nohighlight">\(\mbox{out-degree}(v)\)</span> grains of sand from <span class="math notranslate nohighlight">\(v\)</span> and adding
grains of sand to the neighbors of <span class="math notranslate nohighlight">\(v\)</span>, determined by the weights of
the edges leaving <span class="math notranslate nohighlight">\(v\)</span> (each vertex <span class="math notranslate nohighlight">\(w\)</span> gets as many grains as
the weight of the edge <span class="math notranslate nohighlight">\((v, w)\)</span> is, if there is such an edge).
Note that grains that are added to the sink <span class="math notranslate nohighlight">\(s\)</span> are not counted (i.e.,
they “disappear”).</p>
<p>Despite our best intentions, we sometimes consider firing a stable vertex,
resulting in a “configuration” with a negative amount of sand at that vertex.
We may also <em>reverse-fire</em> a vertex, absorbing sand from the vertex’s
neighbors (including the sink).</p>
<p><strong>Example.</strong> Consider the graph:</p>
<figure class="align-center" id="id17">
<img alt="_images/example1.png" src="_images/example1.png" />
<figcaption>
<p><span class="caption-text"><span class="math notranslate nohighlight">\(\Gamma\)</span></span><a class="headerlink" href="#id17" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>All edges have weight <span class="math notranslate nohighlight">\(1\)</span> except for the edge from vertex 1 to vertex 3,
which has weight <span class="math notranslate nohighlight">\(2\)</span>.  If we let <span class="math notranslate nohighlight">\(c = (5,0,1)\)</span> with the indicated number of
grains of sand on vertices 1, 2, and 3, respectively, then only vertex 1,
whose out-degree is 4, is unstable.  Firing vertex 1 gives a new
configuration <span class="math notranslate nohighlight">\(c' = (1,1,3)\)</span>.  Here, <span class="math notranslate nohighlight">\(4\)</span> grains have left vertex 1.  One of
these has gone to the sink vertex (and forgotten), one has gone to vertex 2,
and two have gone to vertex 3, since the edge from 1 to 3 has weight <span class="math notranslate nohighlight">\(2\)</span>.
Vertex 3 in the new configuration is now unstable.  The Sage code for this
example follows.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:{},</span>
<span class="gp">....: </span>     <span class="mi">1</span><span class="p">:{</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">2</span><span class="p">},</span>
<span class="gp">....: </span>     <span class="mi">2</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>
<span class="gp">....: </span>     <span class="mi">3</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">1</span><span class="p">}}</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>   <span class="c1"># create the sandpile</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="n">true</span><span class="p">)</span>  <span class="c1"># display the graph</span>
</pre></div>
</div>
<p>Create the configuration:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">out_degree</span><span class="p">()</span>
<span class="go">{0: 0, 1: 4, 2: 2, 3: 2}</span>
</pre></div>
</div>
<p>Fire vertex <span class="math notranslate nohighlight">\(1\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">fire_vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">{1: 1, 2: 1, 3: 3}</span>
</pre></div>
</div>
<p>The configuration is unchanged:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">c</span>
<span class="go">{1: 5, 2: 0, 3: 1}</span>
</pre></div>
</div>
<p>Repeatedly fire vertices until the configuration becomes stable:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">stabilize</span><span class="p">()</span>
<span class="go">{1: 2, 2: 1, 3: 1}</span>
</pre></div>
</div>
<p>Alternatives:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="o">~</span><span class="n">c</span>             <span class="c1"># shorthand for c.stabilize()</span>
<span class="go">{1: 2, 2: 1, 3: 1}</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">stabilize</span><span class="p">(</span><span class="n">with_firing_vector</span><span class="o">=</span><span class="n">true</span><span class="p">)</span>
<span class="go">[{1: 2, 2: 1, 3: 1}, {1: 2, 2: 2, 3: 3}]</span>
</pre></div>
</div>
<p>Since vertex 3 has become unstable after firing vertex 1, it can be fired,
which causes vertex 2 to become unstable, etc.  Repeated firings eventually
lead to a stable configuration.  The last line of the Sage code, above, is a
list, the first element of which is the resulting stable configuration,
<span class="math notranslate nohighlight">\((2,1,1)\)</span>.  The second component records how many times each vertex fired in
the stabilization.</p>
<hr class="docutils" />
<p>Since the sink is accessible from each nonsink vertex and never fires, every
configuration will stabilize after a finite number of vertex-firings.  It is
not obvious, but the resulting stabilization is independent of the order in
which unstable vertices are fired.  Thus, each configuration stabilizes to a
unique stable configuration.</p>
</section>
<section id="laplacian">
<h3>Laplacian<a class="headerlink" href="#laplacian" title="Permalink to this heading">#</a></h3>
<p>Fix a total order on the vertices of <span class="math notranslate nohighlight">\(\Gamma\)</span>, thus leading to a labelling of the
vertices by the numbers <span class="math notranslate nohighlight">\(1, 2, \ldots, n\)</span> for some <span class="math notranslate nohighlight">\(n\)</span> (in the given order).
The <em>Laplacian</em> of <span class="math notranslate nohighlight">\(\Gamma\)</span> is</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[L := D-A\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(D\)</span> is the diagonal matrix of out-degrees of the vertices (i.e., the
diagonal <span class="math notranslate nohighlight">\(n \times n\)</span>-matrix whose <span class="math notranslate nohighlight">\((i, i)\)</span>-th entry is the out-degree of the
vertex <span class="math notranslate nohighlight">\(i\)</span>) and <span class="math notranslate nohighlight">\(A\)</span> is the
adjacency matrix whose <span class="math notranslate nohighlight">\((i,j)\)</span>-th entry is the weight of the edge from vertex
<span class="math notranslate nohighlight">\(i\)</span> to vertex <span class="math notranslate nohighlight">\(j\)</span>, which we take to be <span class="math notranslate nohighlight">\(0\)</span> if there is no edge.  The <em>reduced
Laplacian</em>, <span class="math notranslate nohighlight">\(\tilde{L}\)</span>, is the submatrix of the Laplacian formed by removing
the row and column corresponding to the sink vertex.  Firing a vertex of a
configuration is the same as subtracting the corresponding row of the reduced
Laplacian.</p>
<p><strong>Example.</strong> (Continued.)</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">vertices</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># the ordering of the vertices</span>
<span class="go">[0, 1, 2, 3]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">laplacian</span><span class="p">()</span>
<span class="go">[ 0  0  0  0]</span>
<span class="go">[-1  4 -1 -2]</span>
<span class="go">[ 0 -1  2 -1]</span>
<span class="go">[ 0 -1 -1  2]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">reduced_laplacian</span><span class="p">()</span>
<span class="go">[ 4 -1 -2]</span>
<span class="go">[-1  2 -1]</span>
<span class="go">[-1 -1  2]</span>
</pre></div>
</div>
<p>The configuration we considered previously:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span>
<span class="go">{1: 5, 2: 0, 3: 1}</span>
</pre></div>
</div>
<p>Firing vertex 1 is the same as subtracting the
corresponding row of the reduced Laplacian from the configuration
(regarded as a vector):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">fire_vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[1, 1, 3]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">reduced_laplacian</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">(4, -1, -2)</span>
<span class="gp">sage: </span><span class="n">vector</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="n">vector</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<span class="go">(1, 1, 3)</span>
</pre></div>
</div>
</section>
<section id="recurrent-elements">
<h3>Recurrent elements<a class="headerlink" href="#recurrent-elements" title="Permalink to this heading">#</a></h3>
<p>Imagine an experiment in which grains of sand are dropped one-at-a-time onto a
graph, pausing to allow the configuration to stabilize between drops.  Some
configurations will only be seen once in this process.  For example, for most
graphs, once sand is dropped on the graph, no sequence of additions of sand
and stabilizations will result in a graph empty of sand.
Other configurations—the so-called <em>recurrent configurations</em>—will be seen
infinitely often as the process is repeated indefinitely.</p>
<p>To be precise, a configuration <span class="math notranslate nohighlight">\(c\)</span> is <em>recurrent</em> if (i) it is stable, and
(ii) given any configuration <span class="math notranslate nohighlight">\(a\)</span>, there is a configuration <span class="math notranslate nohighlight">\(b\)</span> such that
<span class="math notranslate nohighlight">\(c = \mbox{stab}(a+b)\)</span>, the stabilization of <span class="math notranslate nohighlight">\(a + b\)</span>.</p>
<p>The <em>maximal-stable</em> configuration, denoted <span class="math notranslate nohighlight">\(c_{\mathrm{max}}\)</span>, is defined by
<span class="math notranslate nohighlight">\(c_{\mathrm{max}}(v)=\mbox{out-degree}(v)-1\)</span> for all nonsink vertices <span class="math notranslate nohighlight">\(v\)</span>.
It is clear that <span class="math notranslate nohighlight">\(c_{\mathrm{max}}\)</span> is recurrent.  Further, it is not hard
to see that a configuration is recurrent if and only if it has the form
<span class="math notranslate nohighlight">\(\mbox{stab}(a+c_{\mathrm{max}})\)</span> for some configuration <span class="math notranslate nohighlight">\(a\)</span>.</p>
<p><strong>Example.</strong> (Continued.)</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">recurrents</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">false</span><span class="p">)</span>
<span class="go">[[3, 1, 1], [2, 1, 1], [3, 1, 0]]</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span>
<span class="go">{1: 2, 2: 1, 3: 1}</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">is_recurrent</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span>
<span class="go">{1: 3, 2: 1, 3: 1}</span>
</pre></div>
</div>
<p>Adding any configuration to the max-stable configuration and stabilizing
yields a recurrent configuration:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">+</span> <span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span>
<span class="go">{1: 4, 2: 1, 3: 1}</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> to add and stabilize:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">x</span> <span class="o">&amp;</span> <span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">c</span>
<span class="go">{1: 3, 2: 1, 3: 0}</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">is_recurrent</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Note the various ways of performing addition and stabilization:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">stabilize</span><span class="p">()</span> <span class="o">==</span> <span class="o">~</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">stabilize</span><span class="p">()</span> <span class="o">==</span> <span class="n">x</span> <span class="o">&amp;</span> <span class="n">m</span>
<span class="go">True</span>
</pre></div>
</div>
</section>
<section id="burning-configuration">
<h3>Burning Configuration<a class="headerlink" href="#burning-configuration" title="Permalink to this heading">#</a></h3>
<p>A <em>burning configuration</em> is a <span class="math notranslate nohighlight">\(\ZZ_{\geq 0}\)</span>-linear combination <span class="math notranslate nohighlight">\(f\)</span> of the
rows of the reduced Laplacian matrix having nonnegative entries and such that
every vertex is accessible from some vertex in the support of <span class="math notranslate nohighlight">\(f\)</span>
(in other words, for each vertex <span class="math notranslate nohighlight">\(w\)</span>, there is a path from some
<span class="math notranslate nohighlight">\(v \in \operatorname{supp} f\)</span> to <span class="math notranslate nohighlight">\(w\)</span>).  The corresponding
<em>burning script</em> gives the coefficients in the <span class="math notranslate nohighlight">\(\ZZ_{\geq 0}\)</span>-linear
combination needed to obtain the burning configuration.  So if <span class="math notranslate nohighlight">\(b\)</span> is a burning
configuration, <span class="math notranslate nohighlight">\(\sigma\)</span> is its script, and <span class="math notranslate nohighlight">\(\tilde{L}\)</span> is the reduced
Laplacian, then <span class="math notranslate nohighlight">\(\sigma\,\tilde{L} = b\)</span>.
The <em>minimal burning configuration</em> is the one with the minimal script (each
of its components is no larger than the corresponding component of any other
script for a burning configuration).</p>
<p>Given a burning configuration <span class="math notranslate nohighlight">\(b\)</span> having script <span class="math notranslate nohighlight">\(\sigma\)</span>, and any
configuration <span class="math notranslate nohighlight">\(c\)</span> on the same graph, the following are equivalent:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(c\)</span> is recurrent;</p></li>
<li><p><span class="math notranslate nohighlight">\(c + b\)</span> stabilizes to <span class="math notranslate nohighlight">\(c\)</span>;</p></li>
<li><p>the firing vector for the stabilization of <span class="math notranslate nohighlight">\(c + b\)</span> is <span class="math notranslate nohighlight">\(\sigma\)</span>.</p></li>
</ul>
<p>The burning configuration and script are computed using a modified
version of Speer’s script algorithm.  This is a generalization to
directed multigraphs of Dhar’s burning algorithm.</p>
<p><strong>Example.</strong></p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:{},</span><span class="mi">1</span><span class="p">:{</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span><span class="mi">2</span><span class="p">:{</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>
<span class="gp">....: </span>     <span class="mi">3</span><span class="p">:{</span><span class="mi">2</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span><span class="mi">4</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span><span class="mi">5</span><span class="p">:{</span><span class="mi">2</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">}}</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">burning_config</span><span class="p">()</span>
<span class="go">{1: 2, 2: 0, 3: 1, 4: 1, 5: 0}</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">burning_config</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[2, 0, 1, 1, 0]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">burning_script</span><span class="p">()</span>
<span class="go">{1: 1, 2: 3, 3: 5, 4: 1, 5: 4}</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">burning_script</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[1, 3, 5, 1, 4]</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">burning_script</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">reduced_laplacian</span><span class="p">()</span>
<span class="go">[2 0 1 1 0]</span>
</pre></div>
</div>
</section>
<section id="sandpile-group">
<h3>Sandpile group<a class="headerlink" href="#sandpile-group" title="Permalink to this heading">#</a></h3>
<p>The collection of stable configurations forms a commutative monoid with
addition defined as ordinary addition followed by stabilization.  The identity
element is the all-zero configuration.  This monoid is a group
exactly when the underlying graph is a DAG (directed acyclic graph).</p>
<p>The recurrent elements form a submonoid which turns out to be a group.  This
group is called the <em>sandpile group</em> for <span class="math notranslate nohighlight">\(\Gamma\)</span>, denoted
<span class="math notranslate nohighlight">\(\mathcal{S}(\Gamma)\)</span>.  Its identity element is usually not the all-zero
configuration (again, only in the case that <span class="math notranslate nohighlight">\(\Gamma\)</span> is a DAG).  So finding the
identity element is an interesting problem.</p>
<p>Let <span class="math notranslate nohighlight">\(n=|V|-1\)</span> and fix an ordering of the nonsink vertices. Let
<span class="math notranslate nohighlight">\(\mathcal{\tilde{L}}\subset\ZZ^n\)</span> denote the column-span of
<span class="math notranslate nohighlight">\(\tilde{L}^t\)</span>, the transpose of the reduced Laplacian.  It is a theorem that</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\mathcal{S}(\Gamma)\approx \ZZ^n/\mathcal{\tilde{L}}.\]</div>
</div>
<p>Thus, the number of elements of the sandpile group is <span class="math notranslate nohighlight">\(\det{\tilde{L}}\)</span>, which
by the matrix-tree theorem is the number of weighted trees directed into the
sink.</p>
<p><strong>Example.</strong> (Continued.)</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">group_order</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">invariant_factors</span><span class="p">()</span>
<span class="go">[1, 1, 3]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">reduced_laplacian</span><span class="p">()</span><span class="o">.</span><span class="n">dense_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">smith_form</span><span class="p">()</span>
<span class="go">(</span>
<span class="go">[1 0 0]  [ 1  0  0]  [1 3 5]</span>
<span class="go">[0 1 0]  [ 0  1  0]  [1 4 6]</span>
<span class="go">[0 0 3], [ 0 -1  1], [1 4 7]</span>
<span class="go">)</span>
</pre></div>
</div>
<p>Adding the identity to any recurrent configuration and stabilizing yields
the same recurrent configuration:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="go">{1: 3, 2: 1, 3: 0}</span>
<span class="gp">sage: </span><span class="n">i</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">i</span> <span class="o">&amp;</span> <span class="n">m</span> <span class="o">==</span> <span class="n">m</span>
<span class="go">True</span>
</pre></div>
</div>
</section>
<section id="self-organized-criticality">
<h3>Self-organized criticality<a class="headerlink" href="#self-organized-criticality" title="Permalink to this heading">#</a></h3>
<p>The sandpile model was introduced by Bak, Tang, and Wiesenfeld in the paper,
<em>Self-organized criticality: an explanation of 1/ƒ noise</em> <a class="reference internal" href="#btw" id="id5"><span>[BTW]</span></a>.  The term
<em>self-organized criticality</em> has no precise definition, but can be
loosely taken to describe a system that naturally evolves to a state that is
barely stable and such that the instabilities are described by a power law.
In practice, <em>self-organized criticality</em> is often taken to mean <em>like the
sandpile model on a grid graph</em>.  The grid graph is just a grid with an extra
sink vertex.  The vertices on the interior of each side have one edge to the
sink, and the corner vertices have an edge of weight <span class="math notranslate nohighlight">\(2\)</span>.  Thus, every nonsink
vertex has out-degree <span class="math notranslate nohighlight">\(4\)</span>.</p>
<p>Imagine repeatedly dropping grains of sand on an empty grid graph, allowing
the sandpile to stabilize in between.  At first there is little activity, but
as time goes on, the size and extent of the avalanche caused by a single grain
of sand becomes hard to predict.  Computer experiments—I do not think there
is a proof, yet—indicate that the distribution of avalanche sizes obeys a
power law with exponent -1.  In the example below, the size of an avalanche is
taken to be the sum of the number of times each vertex fires.</p>
<p><strong>Example (distribution of avalanche sizes).</strong></p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Grid</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">):</span>  <span class="c1"># long time (15s on sage.math, 2012)</span>
<span class="gp">....: </span>    <span class="n">m</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">add_random</span><span class="p">()</span>
<span class="gp">....: </span>    <span class="n">m</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">stabilize</span><span class="p">(</span><span class="n">true</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
<span class="go">...</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">list_plot</span><span class="p">([[</span><span class="n">log</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">i</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">a</span><span class="p">)]</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">i</span><span class="p">)])</span>  <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">axes_labels</span><span class="p">([</span><span class="s1">&#39;log(N)&#39;</span><span class="p">,</span><span class="s1">&#39;log(D(N))&#39;</span><span class="p">])</span>  <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">p</span>  <span class="c1"># long time</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
</pre></div>
</div>
<figure class="align-center" id="id18">
<img alt="_images/btw.png" src="_images/btw.png" />
<figcaption>
<p><span class="caption-text">Distribution of avalanche sizes</span><a class="headerlink" href="#id18" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Note: In the above code, <code class="docutils literal notranslate"><span class="pre">m.stabilize(true)</span></code> returns a list consisting of the
stabilized configuration and the firing vector.  (Omitting <code class="docutils literal notranslate"><span class="pre">true</span></code> would give
just the stabilized configuration.)</p>
</section>
<section id="divisors-and-discrete-riemann-surfaces">
<span id="discrete-riemann-surfaces"></span><h3>Divisors and Discrete Riemann surfaces<a class="headerlink" href="#divisors-and-discrete-riemann-surfaces" title="Permalink to this heading">#</a></h3>
<p>A reference for this section is <em>Riemann-Roch and Abel-Jacobi theory on a finite
graph</em> <a class="reference internal" href="#bn" id="id6"><span>[BN]</span></a>.</p>
<p>A <em>divisor</em> on <span class="math notranslate nohighlight">\(\Gamma\)</span> is an element of the free abelian group on its
vertices, including the sink.  Suppose, as above, that the <span class="math notranslate nohighlight">\(n+1\)</span> vertices of
<span class="math notranslate nohighlight">\(\Gamma\)</span> have been ordered, and that <span class="math notranslate nohighlight">\(\mathcal{L}\)</span> is the column span of the
transpose of the Laplacian.  A divisor is then identified with an element
<span class="math notranslate nohighlight">\(D\in\ZZ^{n+1}\)</span>, and two divisors are <em>linearly equivalent</em> if they
differ by an element of <span class="math notranslate nohighlight">\(\mathcal{L}\)</span>.  A divisor <span class="math notranslate nohighlight">\(E\)</span> is <em>effective</em>, written
<span class="math notranslate nohighlight">\(E\geq0\)</span>, if <span class="math notranslate nohighlight">\(E(v)\geq0\)</span> for each <span class="math notranslate nohighlight">\(v\in V\)</span>, i.e.,
if <span class="math notranslate nohighlight">\(E\in\mathbb{Z}_{\geq 0}^{n+1}\)</span>.
The <em>degree</em> of a divisor <span class="math notranslate nohighlight">\(D\)</span> is <span class="math notranslate nohighlight">\(\deg(D) := \sum_{v\in V} D(v)\)</span>.   The
divisors of degree zero modulo linear equivalence form the <em>Picard group</em>, or
<em>Jacobian</em> of the graph. For an undirected graph, the Picard group is
isomorphic to the sandpile group.</p>
<p>The <em>complete linear system</em> for a divisor <span class="math notranslate nohighlight">\(D\)</span>, denoted <span class="math notranslate nohighlight">\(|D|\)</span>, is the
collection of effective divisors linearly equivalent to <span class="math notranslate nohighlight">\(D\)</span>.</p>
<section id="riemann-roch">
<h4>Riemann-Roch<a class="headerlink" href="#riemann-roch" title="Permalink to this heading">#</a></h4>
<p>To describe the Riemann-Roch theorem in this context, suppose that <span class="math notranslate nohighlight">\(\Gamma\)</span> is
an undirected, unweighted graph. The <em>dimension</em>, <span class="math notranslate nohighlight">\(r(D)\)</span>, of the linear system
<span class="math notranslate nohighlight">\(|D|\)</span> is <span class="math notranslate nohighlight">\(-1\)</span> if <span class="math notranslate nohighlight">\(|D|=\emptyset\)</span>, and otherwise is the greatest integer <span class="math notranslate nohighlight">\(s\)</span> such
that <span class="math notranslate nohighlight">\(|D-E|\neq0\)</span> for all effective divisors <span class="math notranslate nohighlight">\(E\)</span> of degree <span class="math notranslate nohighlight">\(s\)</span>.  Define the
<em>canonical divisor</em> by <span class="math notranslate nohighlight">\(K = \sum_{v\in V} (\deg(v)-2) v\)</span>, and the <em>genus</em> by
<span class="math notranslate nohighlight">\(g = \#(E) - \#(V) + 1\)</span>.  The Riemann-Roch theorem says that for any divisor
<span class="math notranslate nohighlight">\(D\)</span>,</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[r(D) - r(K-D) = \deg(D) + 1 - g.\]</div>
</div>
<p><strong>Example.</strong></p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># the sandpile on the complete graph with 5 vertices</span>
</pre></div>
</div>
<p>A divisor on the graph:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p>Verify the Riemann-Roch theorem:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">canonical_divisor</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="n">K</span> <span class="o">-</span> <span class="n">D</span><span class="p">)</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span> <span class="o">==</span> <span class="n">D</span><span class="o">.</span><span class="n">deg</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">G</span><span class="o">.</span><span class="n">genus</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The effective divisors linearly equivalent to <span class="math notranslate nohighlight">\(D\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">effective_div</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[[0, 1, 1, 4, 1], [1, 2, 2, 0, 2], [4, 0, 0, 3, 0]]</span>
</pre></div>
</div>
<p>The nonspecial divisors up to linear equivalence (divisors of degree
<span class="math notranslate nohighlight">\(g-1\)</span> with empty linear systems):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">nonspecial_divisors</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">for</span> <span class="n">E</span> <span class="ow">in</span> <span class="n">N</span><span class="p">[:</span><span class="mi">5</span><span class="p">]]</span>   <span class="c1"># the first few</span>
<span class="go">[[-1, 0, 1, 2, 3],</span>
<span class="go"> [-1, 0, 1, 3, 2],</span>
<span class="go"> [-1, 0, 2, 1, 3],</span>
<span class="go"> [-1, 0, 2, 3, 1],</span>
<span class="go"> [-1, 0, 3, 1, 2]]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="go">24</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">==</span> <span class="n">G</span><span class="o">.</span><span class="n">h_vector</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">True</span>
</pre></div>
</div>
</section>
<section id="picturing-linear-systems">
<h4>Picturing linear systems<a class="headerlink" href="#picturing-linear-systems" title="Permalink to this heading">#</a></h4>
<p>Fix a divisor <span class="math notranslate nohighlight">\(D\)</span>.  There are at least two natural graphs associated with the
linear system associated with <span class="math notranslate nohighlight">\(D\)</span>.  First, consider the directed graph with
vertex set <span class="math notranslate nohighlight">\(|D|\)</span> and with an edge from vertex <span class="math notranslate nohighlight">\(E\)</span> to vertex <span class="math notranslate nohighlight">\(F\)</span> if <span class="math notranslate nohighlight">\(F\)</span> is
attained from <span class="math notranslate nohighlight">\(E\)</span> by firing a single unstable vertex.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_alive</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">eff</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">effective_div</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">firing_graph</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">eff</span><span class="p">)</span><span class="o">.</span><span class="n">show3d</span><span class="p">(</span><span class="n">edge_size</span><span class="o">=</span><span class="mf">.005</span><span class="p">,</span><span class="n">vertex_size</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span><span class="n">iterations</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center" id="id19">
<img alt="_images/C_6.png" src="_images/C_6.png" />
<figcaption>
<p><span class="caption-text">Complete linear system for <span class="math notranslate nohighlight">\((1,1,1,1,2,0)\)</span> on <span class="math notranslate nohighlight">\(C_6\)</span>: single firings</span><a class="headerlink" href="#id19" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The <code class="docutils literal notranslate"><span class="pre">is_alive</span></code> method checks whether the divisor <span class="math notranslate nohighlight">\(D\)</span> is alive, i.e.,
whether every divisor linearly equivalent to <span class="math notranslate nohighlight">\(D\)</span> is unstable.</p>
<p>The second graph has the same set of vertices but with an edge from <span class="math notranslate nohighlight">\(E\)</span> to <span class="math notranslate nohighlight">\(F\)</span>
if <span class="math notranslate nohighlight">\(F\)</span> is obtained from <span class="math notranslate nohighlight">\(E\)</span> by firing all unstable vertices of <span class="math notranslate nohighlight">\(E\)</span>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">eff</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">effective_div</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">parallel_firing_graph</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">eff</span><span class="p">)</span><span class="o">.</span><span class="n">show3d</span><span class="p">(</span><span class="n">edge_size</span><span class="o">=</span><span class="mf">.005</span><span class="p">,</span><span class="n">vertex_size</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span><span class="n">iterations</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center" id="id20">
<img alt="_images/C_6-parallel.png" src="_images/C_6-parallel.png" />
<figcaption>
<p><span class="caption-text">Complete linear system for <span class="math notranslate nohighlight">\((1,1,1,1,2,0)\)</span> on <span class="math notranslate nohighlight">\(C_6\)</span>: parallel firings</span><a class="headerlink" href="#id20" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Note that in each of the examples above, starting at any divisor in the
linear system and following edges, one is eventually led into a cycle of
length <span class="math notranslate nohighlight">\(6\)</span> (cycling the divisor <span class="math notranslate nohighlight">\((1,1,1,1,2,0)\)</span>).  Thus, <code class="docutils literal notranslate"><span class="pre">D.alive()</span></code>
returns <code class="docutils literal notranslate"><span class="pre">True</span></code>.  In Sage, one would be able to rotate the above figures
to get a better idea of the structure.</p>
</section>
</section>
<section id="algebraic-geometry-of-sandpiles">
<h3>Algebraic geometry of sandpiles<a class="headerlink" href="#algebraic-geometry-of-sandpiles" title="Permalink to this heading">#</a></h3>
<section id="affine">
<h4>Affine<a class="headerlink" href="#affine" title="Permalink to this heading">#</a></h4>
<p>Let <span class="math notranslate nohighlight">\(n = |V| - 1\)</span>, and fix an ordering on the nonsink vertices of <span class="math notranslate nohighlight">\(\Gamma\)</span>.
Let <span class="math notranslate nohighlight">\(\tilde{\mathcal{L}} \subset \ZZ^n\)</span> denote the column-span of
<span class="math notranslate nohighlight">\(\tilde{L}^t\)</span>, the transpose of the reduced Laplacian.  Label vertex <span class="math notranslate nohighlight">\(i\)</span>
with the indeterminate <span class="math notranslate nohighlight">\(x_i\)</span>, and let <span class="math notranslate nohighlight">\(\CC[\Gamma_s] = \CC[x_1, \dots, x_n]\)</span>.
(Here, <span class="math notranslate nohighlight">\(s\)</span> denotes the sink vertex of <span class="math notranslate nohighlight">\(\Gamma\)</span>.) The <em>sandpile ideal</em> or
<em>toppling ideal</em>, first studied by Cori, Rossin, and Salvy <a class="reference internal" href="#crs" id="id7"><span>[CRS]</span></a> for
undirected graphs, is the lattice ideal for <span class="math notranslate nohighlight">\(\tilde{\mathcal{L}}\)</span>:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[I = I(\Gamma_s) := \CC[\Gamma_s] \cdot \{x^u-x^v : u-v \in
\tilde{\mathcal{L}}\}\subset\CC[\Gamma_s],\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(x^u := \prod_{i=1}^n x^{u_i}\)</span> for <span class="math notranslate nohighlight">\(u \in \ZZ^n\)</span>.</p>
<p>For each <span class="math notranslate nohighlight">\(c\in\ZZ^n\)</span> define <span class="math notranslate nohighlight">\(t(c) = x^{c^+} - x^{c^-}\)</span> where
<span class="math notranslate nohighlight">\(c^+_i = \max\{c_i,0\}\)</span> and <span class="math notranslate nohighlight">\(c^-_i = \max\{-c_i,0\}\)</span>, so that <span class="math notranslate nohighlight">\(c = c^+ - c^-\)</span>.
Then, for each <span class="math notranslate nohighlight">\(\sigma \in \ZZ^n\)</span>, define <span class="math notranslate nohighlight">\(T(\sigma) =
t(\tilde{L}^t\sigma)\)</span>.  It then turns out that</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[I = (T(e_1),\dots,T(e_n),x^b-1),\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(e_i\)</span> is the <span class="math notranslate nohighlight">\(i\)</span>-th standard basis vector and <span class="math notranslate nohighlight">\(b\)</span> is any burning
configuration.</p>
<p>The affine coordinate ring, <span class="math notranslate nohighlight">\(\CC[\Gamma_s]/I,\)</span> is isomorphic to the group
algebra of the sandpile group, <span class="math notranslate nohighlight">\(\CC[\mathcal{S}(\Gamma)]\)</span>.</p>
<p>The standard term-ordering on <span class="math notranslate nohighlight">\(\CC[\Gamma_s]\)</span> is graded reverse lexicographical
order with <span class="math notranslate nohighlight">\(x_i &gt; x_j\)</span> if vertex <span class="math notranslate nohighlight">\(v_i\)</span> is further from the sink than
vertex <span class="math notranslate nohighlight">\(v_j\)</span>. (There are choices to be made for vertices equidistant from
the sink.) If <span class="math notranslate nohighlight">\(\sigma_b\)</span> is the script for a burning configuration (not
necessarily minimal), then</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\{T(\sigma) : \sigma \leq \sigma_b\}\]</div>
</div>
<p>is a Gröbner basis for <span class="math notranslate nohighlight">\(I\)</span>.</p>
</section>
<section id="projective">
<h4>Projective<a class="headerlink" href="#projective" title="Permalink to this heading">#</a></h4>
<p>Now let <span class="math notranslate nohighlight">\(\CC[\Gamma] = \CC[x_0,x_1,\dots,x_n]\)</span>, where <span class="math notranslate nohighlight">\(x_0\)</span>
corresponds to the sink vertex.  The <em>homogeneous sandpile ideal</em>, denoted
<span class="math notranslate nohighlight">\(I^h\)</span>, is obtaining by homogenizing <span class="math notranslate nohighlight">\(I\)</span> with respect to <span class="math notranslate nohighlight">\(x_0\)</span>.  Let <span class="math notranslate nohighlight">\(L\)</span> be the
(full) Laplacian, and <span class="math notranslate nohighlight">\(\mathcal{L} \subset \ZZ^{n+1}\)</span> be the column span of
its transpose, <span class="math notranslate nohighlight">\(L^t.\)</span>  Then <span class="math notranslate nohighlight">\(I^h\)</span> is the lattice ideal for <span class="math notranslate nohighlight">\(\mathcal{L}\)</span>:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[I^h = I^h(\Gamma) := \CC[\Gamma] \cdot \{x^u-x^v: u-v \in\mathcal{L}\}
\subset \CC[\Gamma].\]</div>
</div>
<p>This ideal can be calculated by saturating the ideal</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[(T(e_i): i=0, \ldots, n)\]</div>
</div>
<p>with respect to the product of the indeterminates: <span class="math notranslate nohighlight">\(\prod_{i=0}^n x_i\)</span>
(extending the <span class="math notranslate nohighlight">\(T\)</span> operator in the obvious way).  A Gröbner basis with
respect to the degree lexicographic order described above (with <span class="math notranslate nohighlight">\(x_0\)</span>
the smallest vertex) is obtained by homogenizing each element of the
Gröbner basis for the non-homogeneous sandpile ideal with respect to <span class="math notranslate nohighlight">\(x_0\)</span>.</p>
<p><strong>Example.</strong></p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:{},</span><span class="mi">1</span><span class="p">:{</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span><span class="mi">2</span><span class="p">:{</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>
<span class="gp">....: </span>     <span class="mi">3</span><span class="p">:{</span><span class="mi">2</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span><span class="mi">4</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span><span class="mi">5</span><span class="p">:{</span><span class="mi">2</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">}}</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">ring</span><span class="p">()</span>
<span class="go">Multivariate Polynomial Ring in x5, x4, x3, x2, x1, x0 over Rational Field</span>
</pre></div>
</div>
<p>The homogeneous sandpile ideal:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">ideal</span><span class="p">()</span>
<span class="go">Ideal (x2 - x0, x3^2 - x5*x0, x5*x3 - x0^2, x4^2 - x3*x1, x5^2 - x3*x0,</span>
<span class="go">x1^3 - x4*x3*x0, x4*x1^2 - x5*x0^2) of Multivariate Polynomial Ring</span>
<span class="go">in x5, x4, x3, x2, x1, x0 over Rational Field</span>
</pre></div>
</div>
<p>The generators of the ideal:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">true</span><span class="p">)</span>
<span class="go">[x2 - x0,</span>
<span class="go"> x3^2 - x5*x0,</span>
<span class="go"> x5*x3 - x0^2,</span>
<span class="go"> x4^2 - x3*x1,</span>
<span class="go"> x5^2 - x3*x0,</span>
<span class="go"> x1^3 - x4*x3*x0,</span>
<span class="go"> x4*x1^2 - x5*x0^2]</span>
</pre></div>
</div>
<p>Its resolution:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">resolution</span><span class="p">()</span> <span class="c1"># long time</span>
<span class="go">&#39;R^1 &lt;-- R^7 &lt;-- R^19 &lt;-- R^25 &lt;-- R^16 &lt;-- R^4&#39;</span>
</pre></div>
</div>
<p>and Betti table:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">betti</span><span class="p">()</span> <span class="c1"># long time</span>
<span class="go">           0     1     2     3     4     5</span>
<span class="gt">------------------------------------------</span>
<span class="g g-Whitespace">    </span><span class="mi">0</span><span class="p">:</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="o">-</span>     <span class="o">-</span>     <span class="o">-</span>     <span class="o">-</span>
<span class="g g-Whitespace">    </span><span class="mi">1</span><span class="p">:</span>     <span class="o">-</span>     <span class="mi">4</span>     <span class="mi">6</span>     <span class="mi">2</span>     <span class="o">-</span>     <span class="o">-</span>
<span class="g g-Whitespace">    </span><span class="mi">2</span><span class="p">:</span>     <span class="o">-</span>     <span class="mi">2</span>     <span class="mi">7</span>     <span class="mi">7</span>     <span class="mi">2</span>     <span class="o">-</span>
<span class="g g-Whitespace">    </span><span class="mi">3</span><span class="p">:</span>     <span class="o">-</span>     <span class="o">-</span>     <span class="mi">6</span>    <span class="mi">16</span>    <span class="mi">14</span>     <span class="mi">4</span>
<span class="gt">------------------------------------------</span>
<span class="ne">total</span>:     1     7    19    25    16     4
</pre></div>
</div>
<p>The Hilbert function:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">hilbert_function</span><span class="p">()</span>
<span class="go">[1, 5, 11, 15]</span>
</pre></div>
</div>
<p>and its first differences (which count the number of superstable
configurations in each degree):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">h_vector</span><span class="p">()</span>
<span class="go">[1, 4, 6, 4]</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">deg</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">S</span><span class="o">.</span><span class="n">superstables</span><span class="p">()]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[0, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3]</span>
</pre></div>
</div>
<p>The degree in which the Hilbert function starts equalling the Hilbert
polynomial, the latter always being a constant in the case of a sandpile ideal:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">postulation</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
</section>
<section id="zeros">
<h4>Zeros<a class="headerlink" href="#zeros" title="Permalink to this heading">#</a></h4>
<p>The <em>zero set</em> for the sandpile ideal <span class="math notranslate nohighlight">\(I\)</span> is</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[Z(I) = \{ p\in\CC^n : f(p)=0\mbox{ for all $f\in I$} \},\]</div>
</div>
<p>the set of simultaneous zeros of the polynomials in <span class="math notranslate nohighlight">\(I\)</span>.  Letting <span class="math notranslate nohighlight">\(S^1\)</span> denote
the unit circle in the complex plane, <span class="math notranslate nohighlight">\(Z(I)\)</span> is a finite
subgroup of <span class="math notranslate nohighlight">\(S^1 \times \cdots \times S^1 \subset \CC^n\)</span>, isomorphic to
the sandpile group.  The zero set is actually linearly isomorphic to a
faithful representation of the sandpile group on <span class="math notranslate nohighlight">\(\CC^n\)</span>.</p>
<div class="admonition-todo admonition" id="id8">
<p class="admonition-title">Todo</p>
<p>The above is not quite true. <span class="math notranslate nohighlight">\(Z(I)\)</span> is neither finite
nor a subgroup of
<span class="math notranslate nohighlight">\(S^1 \times \cdots \times S^1 \subset \CC^n\)</span>.
What is probably meant is that the subset of <span class="math notranslate nohighlight">\(Z(I)\)</span> in
which the coordinate of <span class="math notranslate nohighlight">\(p\)</span> corresponding to the sink
is set to <span class="math notranslate nohighlight">\(1\)</span> is a finite subgroup of
<span class="math notranslate nohighlight">\(S^1 \times \cdots \times S^1 \subset \CC^{n-1}\)</span>.</p>
</div>
<p><strong>Example.</strong> (Continued.)</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">{},</span> <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">}},</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">ideal</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[x1^2 - x2^2, x1*x2^3 - x0^4, x2^5 - x1*x0^4]</span>
</pre></div>
</div>
<p>Approximation to the zero set (setting <code class="docutils literal notranslate"><span class="pre">x_0</span> <span class="pre">=</span> <span class="pre">1</span></code>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="go">[[-0.707107000000000 + 0.707107000000000*I,</span>
<span class="go">  0.707107000000000 - 0.707107000000000*I],</span>
<span class="go"> [-0.707107000000000 - 0.707107000000000*I,</span>
<span class="go">  0.707107000000000 + 0.707107000000000*I],</span>
<span class="go"> [-I, -I],</span>
<span class="go"> [I, I],</span>
<span class="go"> [0.707107000000000 + 0.707107000000000*I,</span>
<span class="go">  -0.707107000000000 - 0.707107000000000*I],</span>
<span class="go"> [0.707107000000000 - 0.707107000000000*I,</span>
<span class="go">  -0.707107000000000 + 0.707107000000000*I],</span>
<span class="go"> [1, 1],</span>
<span class="go"> [-1, -1]]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="o">==</span> <span class="n">S</span><span class="o">.</span><span class="n">group_order</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The zeros are generated as a group by a single vector:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">points</span><span class="p">()</span>
<span class="go">[[-(1/2*I + 1/2)*sqrt(2), (1/2*I + 1/2)*sqrt(2)]]</span>
</pre></div>
</div>
</section>
<section id="resolutions">
<h4>Resolutions<a class="headerlink" href="#resolutions" title="Permalink to this heading">#</a></h4>
<p>The homogeneous sandpile ideal, <span class="math notranslate nohighlight">\(I^h\)</span>, has a free resolution graded by the
divisors on <span class="math notranslate nohighlight">\(\Gamma\)</span> modulo linear equivalence.  (See the section on
<a class="reference internal" href="#discrete-riemann-surfaces"><span class="std std-ref">Discrete Riemann Surfaces</span></a> for the
language of divisors and linear equivalence.)  Let
<span class="math notranslate nohighlight">\(S = \CC[\Gamma] = \CC[x_0,\dots,x_n]\)</span>, as above, and let
<span class="math notranslate nohighlight">\(\mathfrak{S}\)</span> denote the group of divisors modulo rational equivalence.  Then
<span class="math notranslate nohighlight">\(S\)</span> is graded by <span class="math notranslate nohighlight">\(\mathfrak{S}\)</span> by letting <span class="math notranslate nohighlight">\(\deg(x^c) = c \in \mathfrak{S}\)</span>
for each monomial <span class="math notranslate nohighlight">\(x^c\)</span>.  The minimal free resolution of <span class="math notranslate nohighlight">\(I^h\)</span> has the form</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[0 \leftarrow I^h
\leftarrow \bigoplus_{D\in\mathfrak{S}} S(-D)^{\beta_{0,D}}
\leftarrow \bigoplus_{D\in\mathfrak{S}} S(-D)^{\beta_{1,D}}
\leftarrow \cdots
\leftarrow \bigoplus_{D\in\mathfrak{S}} S(-D)^{\beta_{r,D}}
\leftarrow 0,\]</div>
</div>
<p>where the <span class="math notranslate nohighlight">\(\beta_{i,D}\)</span> are the <em>Betti numbers</em> for <span class="math notranslate nohighlight">\(I^h\)</span>.</p>
<p>For each divisor class <span class="math notranslate nohighlight">\(D\in\mathfrak{S}\)</span>, define a simplicial complex</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\Delta_D := \{I\subseteq\{0,\dots,n\}: I\subseteq\mbox{supp}(E)
\mbox{ for some } E \in |D|\}.\]</div>
</div>
<p>The Betti number <span class="math notranslate nohighlight">\(\beta_{i,D}\)</span> equals the dimension over <span class="math notranslate nohighlight">\(\CC\)</span> of the
<span class="math notranslate nohighlight">\(i\)</span>-th reduced homology group of <span class="math notranslate nohighlight">\(\Delta_D\)</span>:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\beta_{i,D} = \dim_{\CC}\tilde{H}_i(\Delta_D;\CC).\]</div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">({</span><span class="mi">0</span><span class="p">:{},</span><span class="mi">1</span><span class="p">:{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span><span class="mi">2</span><span class="p">:{</span><span class="mi">3</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span><span class="mi">3</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">}},</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Representatives of all divisor classes with nontrivial homology:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">betti_complexes</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">[{0: -8, 1: 5, 2: 4, 3: 1},</span>
<span class="go"> Simplicial complex with vertex set (1, 2, 3) and facets {(3,), (1, 2)}]</span>
</pre></div>
</div>
<p>The homology associated with the first divisor in the list:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">effective_div</span><span class="p">()</span>
<span class="go">[{0: 0, 1: 0, 2: 0, 3: 2}, {0: 0, 1: 1, 2: 1, 3: 0}]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">support</span><span class="p">()</span> <span class="k">for</span> <span class="n">E</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">effective_div</span><span class="p">()]</span>
<span class="go">[[3], [1, 2]]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">Dcomplex</span><span class="p">()</span>
<span class="go">Simplicial complex with vertex set (1, 2, 3) and facets {(3,), (1, 2)}</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">Dcomplex</span><span class="p">()</span><span class="o">.</span><span class="n">homology</span><span class="p">()</span>
<span class="go">{0: Z, 1: 0}</span>
</pre></div>
</div>
<p>The minimal free resolution:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">resolution</span><span class="p">()</span>
<span class="go">&#39;R^1 &lt;-- R^5 &lt;-- R^5 &lt;-- R^1&#39;</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">betti</span><span class="p">()</span>
<span class="go">           0     1     2     3</span>
<span class="gt">------------------------------</span>
<span class="g g-Whitespace">    </span><span class="mi">0</span><span class="p">:</span>     <span class="mi">1</span>     <span class="o">-</span>     <span class="o">-</span>     <span class="o">-</span>
<span class="g g-Whitespace">    </span><span class="mi">1</span><span class="p">:</span>     <span class="o">-</span>     <span class="mi">5</span>     <span class="mi">5</span>     <span class="o">-</span>
<span class="g g-Whitespace">    </span><span class="mi">2</span><span class="p">:</span>     <span class="o">-</span>     <span class="o">-</span>     <span class="o">-</span>     <span class="mi">1</span>
<span class="gt">------------------------------</span>
<span class="ne">total</span>:     1     5     5     1
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">11</span>
</pre></div>
</div>
<p>The degrees and ranks of the homology groups for each element of the list
<code class="docutils literal notranslate"><span class="pre">p</span></code> (compare with the Betti table, above):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[[</span><span class="nb">sum</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">betti</span><span class="p">()]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">p</span><span class="p">]</span>
<span class="go">[[2, {0: 2, 1: 0}],</span>
<span class="go"> [3, {0: 1, 1: 1, 2: 0}],</span>
<span class="go"> [2, {0: 2, 1: 0}],</span>
<span class="go"> [3, {0: 1, 1: 1, 2: 0}],</span>
<span class="go"> [2, {0: 2, 1: 0}],</span>
<span class="go"> [3, {0: 1, 1: 1, 2: 0}],</span>
<span class="go"> [2, {0: 2, 1: 0}],</span>
<span class="go"> [3, {0: 1, 1: 1}],</span>
<span class="go"> [2, {0: 2, 1: 0}],</span>
<span class="go"> [3, {0: 1, 1: 1, 2: 0}],</span>
<span class="go"> [5, {0: 1, 1: 0, 2: 1}]]</span>
</pre></div>
</div>
</section>
<section id="complete-intersections-and-arithmetically-gorenstein-toppling-ideals">
<h4>Complete Intersections and Arithmetically Gorenstein toppling ideals<a class="headerlink" href="#complete-intersections-and-arithmetically-gorenstein-toppling-ideals" title="Permalink to this heading">#</a></h4>
<p>NOTE: in the previous section note that the resolution always has length <span class="math notranslate nohighlight">\(n\)</span>
since the ideal is Cohen-Macaulay.</p>
<p>To do.</p>
</section>
<section id="betti-numbers-for-undirected-graphs">
<h4>Betti numbers for undirected graphs<a class="headerlink" href="#betti-numbers-for-undirected-graphs" title="Permalink to this heading">#</a></h4>
<p>To do.</p>
</section>
</section>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this heading">#</a></h2>
<section id="initialization">
<h3>Initialization<a class="headerlink" href="#initialization" title="Permalink to this heading">#</a></h3>
<p>There are three main classes for sandpile structures in Sage: <code class="docutils literal notranslate"><span class="pre">Sandpile</span></code>,
<code class="docutils literal notranslate"><span class="pre">SandpileConfig</span></code>, and <code class="docutils literal notranslate"><span class="pre">SandpileDivisor</span></code>.  Initialization for <code class="docutils literal notranslate"><span class="pre">Sandpile</span></code>
has the form</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">.. skip</span>
</pre></div>
</div>
<blockquote>
<div><p>sage: S = Sandpile(graph, sink)</p>
</div></blockquote>
<p>where <code class="docutils literal notranslate"><span class="pre">graph</span></code> represents a graph and <code class="docutils literal notranslate"><span class="pre">sink</span></code> is the key for the sink
vertex.  There are four possible forms for <code class="docutils literal notranslate"><span class="pre">graph</span></code>:</p>
<ol class="arabic">
<li><p>a Python dictionary of dictionaries:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{},</span> <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
<span class="gp">....: </span>     <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">5</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">}}</span>
</pre></div>
</div>
<figure class="align-center">
<img alt="_images/initial.png" src="_images/initial.png" />
</figure>
<p>Graph from dictionary of dictionaries.</p>
<p>Each key is the name of a vertex.  Next to each vertex name <span class="math notranslate nohighlight">\(v\)</span> is a dictionary
consisting of pairs: <code class="docutils literal notranslate"><span class="pre">vertex:</span> <span class="pre">weight</span></code>.  Each pair represents a directed edge
emanating from <span class="math notranslate nohighlight">\(v\)</span> and ending at <code class="docutils literal notranslate"><span class="pre">vertex</span></code> having (non-negative integer) weight
equal to <code class="docutils literal notranslate"><span class="pre">weight</span></code>.  Loops are allowed.
In the example above, all of the weights are 1.</p>
</li>
<li><p>a Python dictionary of lists:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="gp">....: </span>     <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]}</span>
</pre></div>
</div>
<p>This is a short-hand when all of the edge-weights are equal to 1.  The above
example is for the same displayed graph.</p>
</li>
<li><p>a Sage graph (of type <code class="docutils literal notranslate"><span class="pre">sage.graphs.graph.Graph</span></code>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.graphs.graph.Graph&#39;&gt;</span>
</pre></div>
</div>
<p>To see the types of built-in graphs, type <code class="docutils literal notranslate"><span class="pre">graphs.</span></code>, including
the period, and hit TAB.</p>
</li>
<li><p>a Sage digraph:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">digraphs</span><span class="o">.</span><span class="n">RandomDirectedGNC</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center" id="id21">
<img alt="_images/random.png" src="_images/random.png" />
<figcaption>
<p><span class="caption-text">A random graph.</span><a class="headerlink" href="#id21" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>See
<a class="reference external" href="../reference/sage/graphs/graph_generators.html">sage.graphs.graph_generators</a>
for more information on the Sage graph library and graph constructors.</p>
</li>
</ol>
<p>Each of these four formats is preprocessed by the Sandpile class so that,
internally, the graph is represented by the dictionary of dictionaries format
first presented.  This internal format is returned by <code class="docutils literal notranslate"><span class="pre">dict()</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">({</span><span class="mi">0</span><span class="p">:[],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]},</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span>
<span class="go">{0: {},</span>
<span class="go"> 1: {0: 1, 3: 1, 4: 1},</span>
<span class="go"> 2: {0: 1, 3: 1, 5: 1},</span>
<span class="go"> 3: {2: 1, 5: 1},</span>
<span class="go"> 4: {1: 1, 3: 1},</span>
<span class="go"> 5: {2: 1, 3: 1}}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The user is responsible for assuring that each vertex has a directed path
into the designated sink.  If the sink has out-edges, these will be ignored
for the purposes of sandpile calculations (but not calculations on divisors).</p>
</div>
<p>Code for checking whether a given vertex is a sink:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">({</span><span class="mi">0</span><span class="p">:[],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]},</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">S</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">S</span><span class="o">.</span><span class="n">vertices</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span> <span class="c1"># 0 is a sink</span>
<span class="go">[0, 1, 1, 2, 2, 2]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">S</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">S</span><span class="o">.</span><span class="n">vertices</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span> <span class="c1"># 1 is not a sink</span>
<span class="go">[+Infinity, 0, +Infinity, +Infinity, 1, +Infinity]</span>
</pre></div>
</div>
</section>
<section id="methods">
<h3>Methods<a class="headerlink" href="#methods" title="Permalink to this heading">#</a></h3>
<p>Here are summaries of <code class="docutils literal notranslate"><span class="pre">Sandpile</span></code>, <code class="docutils literal notranslate"><span class="pre">SandpileConfig</span></code>, and <code class="docutils literal notranslate"><span class="pre">SandpileDivisor</span></code>
methods (functions).  Each summary is followed by a list of complete
descriptions of the methods.  There are many more methods available
for a Sandpile, e.g., those inherited from the class DiGraph.  To see them
all, enter <code class="docutils literal notranslate"><span class="pre">dir(Sandpile)</span></code> or type <code class="docutils literal notranslate"><span class="pre">Sandpile.</span></code>, including the period,
and hit TAB.</p>
<section id="sandpile">
<h4>Sandpile<a class="headerlink" href="#sandpile" title="Permalink to this heading">#</a></h4>
<p><strong>Summary of methods.</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="#all-k-config"><span class="std std-ref">all_k_config</span></a> — The constant configuration with all values set to k.</p></li>
<li><p><a class="reference internal" href="#all-k-div"><span class="std std-ref">all_k_div</span></a> — The divisor with all values set to k.</p></li>
<li><p><a class="reference internal" href="#avalanche-polynomial"><span class="std std-ref">avalanche_polynomial</span></a> — The avalanche polynomial.</p></li>
<li><p><a class="reference internal" href="#betti"><span class="std std-ref">betti</span></a> — The Betti table for the homogeneous toppling ideal.</p></li>
<li><p><a class="reference internal" href="#betti-complexes"><span class="std std-ref">betti_complexes</span></a> — The support-complexes with non-trivial homology.</p></li>
<li><p><a class="reference internal" href="#burning-config"><span class="std std-ref">burning_config</span></a> — The minimal burning configuration.</p></li>
<li><p><a class="reference internal" href="#burning-script"><span class="std std-ref">burning_script</span></a> — A script for the minimal burning configuration.</p></li>
<li><p><a class="reference internal" href="#canonical-divisor"><span class="std std-ref">canonical_divisor</span></a> — The canonical divisor.</p></li>
<li><p><a class="reference internal" href="#dict"><span class="std std-ref">dict</span></a> — A dictionary of dictionaries representing a directed graph.</p></li>
<li><p><a class="reference internal" href="#genus"><span class="std std-ref">genus</span></a> — The genus: (# non-loop edges) - (# vertices) + 1.</p></li>
<li><p><a class="reference internal" href="#groebner"><span class="std std-ref">groebner</span></a> — A Groebner basis for the homogeneous toppling ideal.</p></li>
<li><p><a class="reference internal" href="#group-gens"><span class="std std-ref">group_gens</span></a> — A minimal list of generators for the sandpile group.</p></li>
<li><p><a class="reference internal" href="#group-order"><span class="std std-ref">group_order</span></a> — The size of the sandpile group.</p></li>
<li><p><a class="reference internal" href="#h-vector"><span class="std std-ref">h_vector</span></a> — The number of superstable configurations in each degree.</p></li>
<li><p><a class="reference internal" href="#help"><span class="std std-ref">help</span></a> — List of Sandpile-specific methods (not inherited from Graph).</p></li>
<li><p><a class="reference internal" href="#hilbert-function"><span class="std std-ref">hilbert_function</span></a> — The Hilbert function of the homogeneous toppling ideal.</p></li>
<li><p><a class="reference internal" href="#ideal"><span class="std std-ref">ideal</span></a> — The saturated homogeneous toppling ideal.</p></li>
<li><p><a class="reference internal" href="#identity"><span class="std std-ref">identity</span></a> — The identity configuration.</p></li>
<li><p><a class="reference internal" href="#in-degree"><span class="std std-ref">in_degree</span></a> — The in-degree of a vertex or a list of all in-degrees.</p></li>
<li><p><a class="reference internal" href="#invariant-factors"><span class="std std-ref">invariant_factors</span></a> — The invariant factors of the sandpile group.</p></li>
<li><p><a class="reference internal" href="#is-undirected"><span class="std std-ref">is_undirected</span></a> — Is the underlying graph undirected?</p></li>
<li><p><a class="reference internal" href="#jacobian-representatives"><span class="std std-ref">jacobian_representatives</span></a> — Representatives for the elements of the Jacobian group.</p></li>
<li><p><a class="reference internal" href="#id9"><span class="std std-ref">laplacian</span></a> — The Laplacian matrix of the graph.</p></li>
<li><p><a class="reference internal" href="#markov-chain"><span class="std std-ref">markov_chain</span></a> — The sandpile Markov chain for configurations or divisors.</p></li>
<li><p><a class="reference internal" href="#max-stable"><span class="std std-ref">max_stable</span></a> — The maximal stable configuration.</p></li>
<li><p><a class="reference internal" href="#max-stable-div"><span class="std std-ref">max_stable_div</span></a> — The maximal stable divisor.</p></li>
<li><p><a class="reference internal" href="#max-superstables"><span class="std std-ref">max_superstables</span></a> — The maximal superstable configurations.</p></li>
<li><p><a class="reference internal" href="#min-recurrents"><span class="std std-ref">min_recurrents</span></a> — The minimal recurrent elements.</p></li>
<li><p><a class="reference internal" href="#nonsink-vertices"><span class="std std-ref">nonsink_vertices</span></a> — The nonsink vertices.</p></li>
<li><p><a class="reference internal" href="#nonspecial-divisors"><span class="std std-ref">nonspecial_divisors</span></a> — The nonspecial divisors.</p></li>
<li><p><a class="reference internal" href="#out-degree"><span class="std std-ref">out_degree</span></a> — The out-degree of a vertex or a list of all out-degrees.</p></li>
<li><p><a class="reference internal" href="#picard-representatives"><span class="std std-ref">picard_representatives</span></a> — Representatives of the divisor classes of degree d in the Picard group.</p></li>
<li><p><a class="reference internal" href="#points"><span class="std std-ref">points</span></a> — Generators for the multiplicative group of zeros of the sandpile ideal.</p></li>
<li><p><a class="reference internal" href="#postulation"><span class="std std-ref">postulation</span></a> — The postulation number of the toppling ideal.</p></li>
<li><p><a class="reference internal" href="#recurrents"><span class="std std-ref">recurrents</span></a> — The recurrent configurations.</p></li>
<li><p><a class="reference internal" href="#reduced-laplacian"><span class="std std-ref">reduced_laplacian</span></a> — The reduced Laplacian matrix of the graph.</p></li>
<li><p><a class="reference internal" href="#reorder-vertices"><span class="std std-ref">reorder_vertices</span></a> — A copy of the sandpile with vertex names permuted.</p></li>
<li><p><a class="reference internal" href="#resolution"><span class="std std-ref">resolution</span></a> — A minimal free resolution of the homogeneous toppling ideal.</p></li>
<li><p><a class="reference internal" href="#ring"><span class="std std-ref">ring</span></a> — The ring containing the homogeneous toppling ideal.</p></li>
<li><p><a class="reference internal" href="#show"><span class="std std-ref">show</span></a> — Draw the underlying graph.</p></li>
<li><p><a class="reference internal" href="#show3d"><span class="std std-ref">show3d</span></a> — Draw the underlying graph.</p></li>
<li><p><a class="reference internal" href="#sink"><span class="std std-ref">sink</span></a> — The sink vertex.</p></li>
<li><p><a class="reference internal" href="#smith-form"><span class="std std-ref">smith_form</span></a> — The Smith normal form for the Laplacian.</p></li>
<li><p><a class="reference internal" href="#solve"><span class="std std-ref">solve</span></a> — Approximations of the complex affine zeros of the sandpile ideal.</p></li>
<li><p><a class="reference internal" href="#stable-configs"><span class="std std-ref">stable_configs</span></a> — Generator for all stable configurations.</p></li>
<li><p><a class="reference internal" href="#stationary-density"><span class="std std-ref">stationary_density</span></a> — The stationary density of the sandpile.</p></li>
<li><p><a class="reference internal" href="#superstables"><span class="std std-ref">superstables</span></a> — The superstable configurations.</p></li>
<li><p><a class="reference internal" href="#symmetric-recurrents"><span class="std std-ref">symmetric_recurrents</span></a> — The symmetric recurrent configurations.</p></li>
<li><p><a class="reference internal" href="#tutte-polynomial"><span class="std std-ref">tutte_polynomial</span></a> — The Tutte polynomial.</p></li>
<li><p><a class="reference internal" href="#unsaturated-ideal"><span class="std std-ref">unsaturated_ideal</span></a> — The unsaturated, homogeneous toppling ideal.</p></li>
<li><p><a class="reference internal" href="#version"><span class="std std-ref">version</span></a> — The version number of Sage Sandpiles.</p></li>
<li><p><a class="reference internal" href="#zero-config"><span class="std std-ref">zero_config</span></a> — The all-zero configuration.</p></li>
<li><p><a class="reference internal" href="#zero-div"><span class="std std-ref">zero_div</span></a> — The all-zero divisor.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Complete descriptions of Sandpile methods.</strong></p>
<p>—</p>
<p id="all-k-config"><strong>all_k_config(k)</strong></p>
<p>The constant configuration with all values set to <span class="math notranslate nohighlight">\(k\)</span>.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">k</span></code> – integer</p>
<p>OUTPUT:</p>
<p>SandpileConfig</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Diamond</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">all_k_config</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">{1: 7, 2: 7, 3: 7}</span>
</pre></div>
</div>
<p>—</p>
<p id="all-k-div"><strong>all_k_div(k)</strong></p>
<p>The divisor with all values set to <span class="math notranslate nohighlight">\(k\)</span>.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">k</span></code> – integer</p>
<p>OUTPUT:</p>
<p>SandpileDivisor</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">House</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">all_k_div</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">{0: 7, 1: 7, 2: 7, 3: 7, 4: 7}</span>
</pre></div>
</div>
<p>—</p>
<p id="avalanche-polynomial"><strong>avalanche_polynomial(multivariable=True)</strong></p>
<p>The avalanche polynomial.  See NOTE for details.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">multivariable</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) boolean</p>
<p>OUTPUT:</p>
<p>polynomial</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">avalanche_polynomial</span><span class="p">()</span>
<span class="go">9*x0*x1*x2 + 2*x0*x1 + 2*x0*x2 + 2*x1*x2 + 3*x0 + 3*x1 + 3*x2 + 24</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">avalanche_polynomial</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="go">9*x0^3 + 6*x0^2 + 9*x0 + 24</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For each nonsink vertex <span class="math notranslate nohighlight">\(v\)</span>, let <span class="math notranslate nohighlight">\(x_v\)</span> be an indeterminate.
If <span class="math notranslate nohighlight">\((r,v)\)</span> is a pair consisting of a recurrent <span class="math notranslate nohighlight">\(r\)</span> and nonsink
vertex <span class="math notranslate nohighlight">\(v\)</span>, then for each nonsink vertex <span class="math notranslate nohighlight">\(w\)</span>, let <span class="math notranslate nohighlight">\(n_w\)</span> be the
number of times vertex <span class="math notranslate nohighlight">\(w\)</span> fires in the stabilization of <span class="math notranslate nohighlight">\(r + v\)</span>.
Let <span class="math notranslate nohighlight">\(M(r,v)\)</span> be the monomial <span class="math notranslate nohighlight">\(\prod_w x_w^{n_w}\)</span>, i.e., the exponent
records the vector of <span class="math notranslate nohighlight">\(n_w\)</span> as <span class="math notranslate nohighlight">\(w\)</span> ranges over the nonsink vertices.
The avalanche polynomial is then the sum of <span class="math notranslate nohighlight">\(M(r,v)\)</span> as <span class="math notranslate nohighlight">\(r\)</span> ranges
over the recurrents and <span class="math notranslate nohighlight">\(v\)</span> ranges over the nonsink vertices.  If
<code class="docutils literal notranslate"><span class="pre">multivariable</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, then set all the indeterminates equal
to each other (and, thus, only count the number of vertex firings in the
stabilizations, forgetting which particular vertices fired).</p>
</div>
<p>—</p>
<p id="betti"><strong>betti(verbose=True)</strong></p>
<p>The Betti table for the homogeneous toppling ideal.  If
<code class="docutils literal notranslate"><span class="pre">verbose</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, it prints the standard Betti table, otherwise,
it returns a less formatted table.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) boolean</p>
<p>OUTPUT:</p>
<p>Betti numbers for the sandpile</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Diamond</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">betti</span><span class="p">()</span>
<span class="go">           0     1     2     3</span>
<span class="gt">------------------------------</span>
<span class="g g-Whitespace">    </span><span class="mi">0</span><span class="p">:</span>     <span class="mi">1</span>     <span class="o">-</span>     <span class="o">-</span>     <span class="o">-</span>
<span class="g g-Whitespace">    </span><span class="mi">1</span><span class="p">:</span>     <span class="o">-</span>     <span class="mi">2</span>     <span class="o">-</span>     <span class="o">-</span>
<span class="g g-Whitespace">    </span><span class="mi">2</span><span class="p">:</span>     <span class="o">-</span>     <span class="mi">4</span>     <span class="mi">9</span>     <span class="mi">4</span>
<span class="gt">------------------------------</span>
<span class="ne">total</span>:     1     6     9     4
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">betti</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[1, 6, 9, 4]</span>
</pre></div>
</div>
<p>—</p>
<p id="betti-complexes"><strong>betti_complexes()</strong></p>
<p>The support-complexes with non-trivial homology.  (See NOTE.)</p>
<p>OUTPUT:</p>
<p>list (of pairs [divisors, corresponding simplicial complex])</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">({</span><span class="mi">0</span><span class="p">:{},</span><span class="mi">1</span><span class="p">:{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span><span class="mi">2</span><span class="p">:{</span><span class="mi">3</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span><span class="mi">3</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">}},</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">betti_complexes</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">[{0: -8, 1: 5, 2: 4, 3: 1}, Simplicial complex with vertex set (1, 2, 3) and facets {(3,), (1, 2)}]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">resolution</span><span class="p">()</span>
<span class="go">&#39;R^1 &lt;-- R^5 &lt;-- R^5 &lt;-- R^1&#39;</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">betti</span><span class="p">()</span>
<span class="go">           0     1     2     3</span>
<span class="gt">------------------------------</span>
<span class="g g-Whitespace">    </span><span class="mi">0</span><span class="p">:</span>     <span class="mi">1</span>     <span class="o">-</span>     <span class="o">-</span>     <span class="o">-</span>
<span class="g g-Whitespace">    </span><span class="mi">1</span><span class="p">:</span>     <span class="o">-</span>     <span class="mi">5</span>     <span class="mi">5</span>     <span class="o">-</span>
<span class="g g-Whitespace">    </span><span class="mi">2</span><span class="p">:</span>     <span class="o">-</span>     <span class="o">-</span>     <span class="o">-</span>     <span class="mi">1</span>
<span class="gt">------------------------------</span>
<span class="ne">total</span>:     1     5     5     1
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">11</span>
<span class="gp">sage: </span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">homology</span><span class="p">()</span>
<span class="go">{0: Z, 1: 0}</span>
<span class="gp">sage: </span><span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">homology</span><span class="p">()</span>
<span class="go">{0: 0, 1: 0, 2: Z}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A <code class="docutils literal notranslate"><span class="pre">support-complex</span></code> is the simplicial complex formed from the
supports of the divisors in a linear system.</p>
</div>
<p>—</p>
<p id="burning-config"><strong>burning_config()</strong></p>
<p>The minimal burning configuration.</p>
<p>OUTPUT:</p>
<p>dict (configuration)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:{},</span><span class="mi">1</span><span class="p">:{</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span><span class="mi">2</span><span class="p">:{</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span> \
<span class="go">           3:{2:1,5:1},4:{1:1,3:1},5:{2:1,3:1}}</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">burning_config</span><span class="p">()</span>
<span class="go">{1: 2, 2: 0, 3: 1, 4: 1, 5: 0}</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">burning_config</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[2, 0, 1, 1, 0]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">burning_script</span><span class="p">()</span>
<span class="go">{1: 1, 2: 3, 3: 5, 4: 1, 5: 4}</span>
<span class="gp">sage: </span><span class="n">script</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">burning_script</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">script</span>
<span class="go">[1, 3, 5, 1, 4]</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">script</span><span class="p">)</span><span class="o">*</span><span class="n">S</span><span class="o">.</span><span class="n">reduced_laplacian</span><span class="p">()</span>
<span class="go">[2 0 1 1 0]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The burning configuration and script are computed using a modified
version of Speer’s script algorithm.  This is a generalization to
directed multigraphs of Dhar’s burning algorithm.</p>
<p>A <em>burning configuration</em> is a nonnegative integer-linear
combination of the rows of the reduced Laplacian matrix having
nonnegative entries and such that every vertex has a path from some
vertex in its support.  The corresponding <em>burning script</em> gives
the integer-linear combination needed to obtain the burning
configuration.  So if <span class="math notranslate nohighlight">\(b\)</span> is the burning configuration, <span class="math notranslate nohighlight">\(\sigma\)</span> is its
script, and <span class="math notranslate nohighlight">\(\tilde{L}\)</span> is the reduced Laplacian, then <span class="math notranslate nohighlight">\(\sigma\cdot
\tilde{L} = b\)</span>.  The <em>minimal burning configuration</em> is the one
with the minimal script (its components are no larger than the
components of any other script
for a burning configuration).</p>
<p>The following are equivalent for a configuration <span class="math notranslate nohighlight">\(c\)</span> with burning
configuration <span class="math notranslate nohighlight">\(b\)</span> having script <span class="math notranslate nohighlight">\(\sigma\)</span>:</p>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(c\)</span> is recurrent;</p></li>
<li><p><span class="math notranslate nohighlight">\(c+b\)</span> stabilizes to <span class="math notranslate nohighlight">\(c\)</span>;</p></li>
<li><p>the firing vector for the stabilization of <span class="math notranslate nohighlight">\(c+b\)</span> is <span class="math notranslate nohighlight">\(\sigma\)</span>.</p></li>
</ul>
</div></blockquote>
</div>
<p>—</p>
<p id="burning-script"><strong>burning_script()</strong></p>
<p>A script for the minimal burning configuration.</p>
<p>OUTPUT:</p>
<p>dict</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:{},</span><span class="mi">1</span><span class="p">:{</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span><span class="mi">2</span><span class="p">:{</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>\
<span class="go">3:{2:1,5:1},4:{1:1,3:1},5:{2:1,3:1}}</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">burning_config</span><span class="p">()</span>
<span class="go">{1: 2, 2: 0, 3: 1, 4: 1, 5: 0}</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">burning_config</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[2, 0, 1, 1, 0]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">burning_script</span><span class="p">()</span>
<span class="go">{1: 1, 2: 3, 3: 5, 4: 1, 5: 4}</span>
<span class="gp">sage: </span><span class="n">script</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">burning_script</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">script</span>
<span class="go">[1, 3, 5, 1, 4]</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">script</span><span class="p">)</span><span class="o">*</span><span class="n">S</span><span class="o">.</span><span class="n">reduced_laplacian</span><span class="p">()</span>
<span class="go">[2 0 1 1 0]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The burning configuration and script are computed using a modified
version of Speer’s script algorithm.  This is a generalization to
directed multigraphs of Dhar’s burning algorithm.</p>
<p>A <em>burning configuration</em> is a nonnegative integer-linear
combination of the rows of the reduced Laplacian matrix having
nonnegative entries and such that every vertex has a path from some
vertex in its support.  The corresponding <em>burning script</em> gives the
integer-linear combination needed to obtain the burning configuration.
So if <span class="math notranslate nohighlight">\(b\)</span> is the burning configuration, <span class="math notranslate nohighlight">\(s\)</span> is its script, and
<span class="math notranslate nohighlight">\(L_{\mathrm{red}}\)</span> is the reduced Laplacian, then <span class="math notranslate nohighlight">\(s\cdot
L_{\mathrm{red}}= b\)</span>.  The <em>minimal burning configuration</em> is the one
with the minimal script (its components are no larger than the
components of any other script
for a burning configuration).</p>
<p>The following are equivalent for a configuration <span class="math notranslate nohighlight">\(c\)</span> with burning
configuration <span class="math notranslate nohighlight">\(b\)</span> having script <span class="math notranslate nohighlight">\(s\)</span>:</p>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(c\)</span> is recurrent;</p></li>
<li><p><span class="math notranslate nohighlight">\(c+b\)</span> stabilizes to <span class="math notranslate nohighlight">\(c\)</span>;</p></li>
<li><p>the firing vector for the stabilization of <span class="math notranslate nohighlight">\(c+b\)</span> is <span class="math notranslate nohighlight">\(s\)</span>.</p></li>
</ul>
</div></blockquote>
</div>
<p>—</p>
<p id="canonical-divisor"><strong>canonical_divisor()</strong></p>
<p>The canonical divisor.  This is the divisor with <span class="math notranslate nohighlight">\(\deg(v)-2\)</span> grains of
sand on each vertex (not counting loops).  Only for undirected graphs.</p>
<p>OUTPUT:</p>
<p>SandpileDivisor</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">canonical_divisor</span><span class="p">()</span>
<span class="go">{0: 1, 1: 1, 2: 1, 3: 1}</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]},</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">canonical_divisor</span><span class="p">()</span>  <span class="c1"># loops are disregarded</span>
<span class="go">{0: 0, 1: 0}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The underlying graph must be undirected.</p>
</div>
<p>—</p>
<p id="dict"><strong>dict()</strong></p>
<p>A dictionary of dictionaries representing a directed graph.</p>
<p>OUTPUT:</p>
<p>dict</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Diamond</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span>
<span class="go">{0: {1: 1, 2: 1},</span>
<span class="go"> 1: {0: 1, 2: 1, 3: 1},</span>
<span class="go"> 2: {0: 1, 1: 1, 3: 1},</span>
<span class="go"> 3: {1: 1, 2: 1}}</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">sink</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<p>—</p>
<p id="genus"><strong>genus()</strong></p>
<p>The genus: (# non-loop edges) - (# vertices) + 1.  Only defined for undirected graphs.</p>
<p>OUTPUT:</p>
<p>integer</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">genus</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">genus</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<p>—</p>
<p id="groebner"><strong>groebner()</strong></p>
<p>A Groebner basis for the homogeneous toppling ideal.  It is computed
with respect to the standard sandpile ordering (see <code class="docutils literal notranslate"><span class="pre">ring</span></code>).</p>
<p>OUTPUT:</p>
<p>Groebner basis</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Diamond</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">groebner</span><span class="p">()</span>
<span class="go">[x3*x2^2 - x1^2*x0, x2^3 - x3*x1*x0, x3*x1^2 - x2^2*x0, x1^3 - x3*x2*x0, x3^2 - x0^2, x2*x1 - x0^2]</span>
</pre></div>
</div>
<p>—</p>
<p id="group-gens"><strong>group_gens(verbose=True)</strong></p>
<p>A minimal list of generators for the sandpile group.  If <code class="docutils literal notranslate"><span class="pre">verbose</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>
then the generators are represented as lists of integers.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) boolean</p>
<p>OUTPUT:</p>
<p>list of SandpileConfig (or of lists of integers if <code class="docutils literal notranslate"><span class="pre">verbose</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">group_gens</span><span class="p">()</span>
<span class="go">[{1: 0, 2: 1, 3: 1, 4: 1}]</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">group_gens</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">group_gens</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[[2, 3, 2, 2], [2, 2, 3, 2], [2, 2, 2, 3]]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">group_gens</span><span class="p">()]</span>
<span class="go">[5, 5, 5]</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">invariant_factors</span><span class="p">()</span>
<span class="go">[1, 5, 5, 5]</span>
</pre></div>
</div>
<p>—</p>
<p id="group-order"><strong>group_order()</strong></p>
<p>The size of the sandpile group.</p>
<p>OUTPUT:</p>
<p>integer</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">House</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">group_order</span><span class="p">()</span>
<span class="go">11</span>
</pre></div>
</div>
<p>—</p>
<p id="h-vector"><strong>h_vector()</strong></p>
<p>The number of superstable configurations in each degree.  Equivalently,
this is the list of first differences of the Hilbert function of the
(homogeneous) toppling ideal.</p>
<p>OUTPUT:</p>
<p>list of nonnegative integers</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Grid</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">hilbert_function</span><span class="p">()</span>
<span class="go">[1, 5, 15, 35, 66, 106, 146, 178, 192]</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">h_vector</span><span class="p">()</span>
<span class="go">[1, 4, 10, 20, 31, 40, 40, 32, 14]</span>
</pre></div>
</div>
<p>—</p>
<p id="help"><strong>help(verbose=True)</strong></p>
<p>List of Sandpile-specific methods (not inherited from Graph).  If <code class="docutils literal notranslate"><span class="pre">verbose</span></code>, include short descriptions.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) boolean</p>
<p>OUTPUT:</p>
<p>printed string</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Sandpile</span><span class="o">.</span><span class="n">help</span><span class="p">()</span>
<span class="go">For detailed help with any method FOO listed below,</span>
<span class="go">enter &quot;Sandpile.FOO?&quot; or enter &quot;S.FOO?&quot; for any Sandpile S.</span>

<span class="go">all_k_config             -- The constant configuration with all values set to k.</span>
<span class="go">all_k_div                -- The divisor with all values set to k.</span>
<span class="go">avalanche_polynomial     -- The avalanche polynomial.</span>
<span class="go">betti                    -- The Betti table for the homogeneous toppling ideal.</span>
<span class="go">betti_complexes          -- The support-complexes with non-trivial homology.</span>
<span class="go">...</span>
<span class="go">unsaturated_ideal        -- The unsaturated, homogeneous toppling ideal.</span>
<span class="go">version                  -- The version number of Sage Sandpiles.</span>
<span class="go">zero_config              -- The all-zero configuration.</span>
<span class="go">zero_div                 -- The all-zero divisor.</span>
</pre></div>
</div>
<p>—</p>
<p id="hilbert-function"><strong>hilbert_function()</strong></p>
<p>The Hilbert function of the homogeneous toppling ideal.</p>
<p>OUTPUT:</p>
<p>list of nonnegative integers</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Wheel</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">hilbert_function</span><span class="p">()</span>
<span class="go">[1, 5, 15, 31, 45]</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">h_vector</span><span class="p">()</span>
<span class="go">[1, 4, 10, 16, 14]</span>
</pre></div>
</div>
<p>—</p>
<p id="ideal"><strong>ideal(gens=False)</strong></p>
<p>The saturated homogeneous toppling ideal.  If <code class="docutils literal notranslate"><span class="pre">gens</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, the
generators for the ideal are returned instead.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">gens</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) boolean</p>
<p>OUTPUT:</p>
<p>ideal or, optionally, the generators of an ideal</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Diamond</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">ideal</span><span class="p">()</span>
<span class="go">Ideal (x2*x1 - x0^2, x3^2 - x0^2, x1^3 - x3*x2*x0, x3*x1^2 - x2^2*x0, x2^3 - x3*x1*x0, x3*x2^2 - x1^2*x0) of Multivariate Polynomial Ring in x3, x2, x1, x0 over Rational Field</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[x2*x1 - x0^2, x3^2 - x0^2, x1^3 - x3*x2*x0, x3*x1^2 - x2^2*x0, x2^3 - x3*x1*x0, x3*x2^2 - x1^2*x0]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">ideal</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>  <span class="c1"># another way to get the generators</span>
<span class="go">[x2*x1 - x0^2, x3^2 - x0^2, x1^3 - x3*x2*x0, x3*x1^2 - x2^2*x0, x2^3 - x3*x1*x0, x3*x2^2 - x1^2*x0]</span>
</pre></div>
</div>
<p>—</p>
<p id="identity"><strong>identity(verbose=True)</strong></p>
<p>The identity configuration.  If <code class="docutils literal notranslate"><span class="pre">verbose</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, the
configuration are converted to a list of integers.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) boolean</p>
<p>OUTPUT:</p>
<p>SandpileConfig or a list of integers  If <code class="docutils literal notranslate"><span class="pre">verbose</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, the
configuration are converted to a list of integers.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Diamond</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="go">{1: 2, 2: 2, 3: 0}</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[2, 2, 0]</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">s</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span> <span class="o">==</span> <span class="n">s</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>—</p>
<p id="in-degree"><strong>in_degree(v=None)</strong></p>
<p>The in-degree of a vertex or a list of all in-degrees.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">v</span></code> – (optional) vertex name</p>
<p>OUTPUT:</p>
<p>integer or dict</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">House</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">in_degree</span><span class="p">()</span>
<span class="go">{0: 2, 1: 2, 2: 3, 3: 3, 4: 2}</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">in_degree</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>—</p>
<p id="invariant-factors"><strong>invariant_factors()</strong></p>
<p>The invariant factors of the sandpile group.</p>
<p>OUTPUT:</p>
<p>list of integers</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Grid</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">invariant_factors</span><span class="p">()</span>
<span class="go">[1, 1, 8, 24]</span>
</pre></div>
</div>
<p>—</p>
<p id="is-undirected"><strong>is_undirected()</strong></p>
<p>Is the underlying graph undirected?  <code class="docutils literal notranslate"><span class="pre">True</span></code> if <span class="math notranslate nohighlight">\((u,v)\)</span> is and edge if
and only if <span class="math notranslate nohighlight">\((v,u)\)</span> is an edge, each edge with the same weight.</p>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">is_undirected</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">0</span><span class="p">]},</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">is_undirected</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>—</p>
<p id="jacobian-representatives"><strong>jacobian_representatives(verbose=True)</strong></p>
<p>Representatives for the elements of the Jacobian group. If <code class="docutils literal notranslate"><span class="pre">verbose</span></code>
is <code class="docutils literal notranslate"><span class="pre">False</span></code>, then lists representing the divisors are returned.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) boolean</p>
<p>OUTPUT:</p>
<p>list of SandpileDivisor (or of lists representing divisors)</p>
<p>EXAMPLES:</p>
<p>For an undirected graph, divisors of the form <code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">-</span> <span class="pre">deg(s)*sink</span></code> as
<code class="docutils literal notranslate"><span class="pre">s</span></code> varies over the superstables forms a distinct set of
representatives for the Jacobian group.:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">superstables</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[[0, 0], [0, 1], [1, 0]]</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">jacobian_representatives</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[[0, 0, 0], [-1, 0, 1], [-1, 1, 0]]</span>
</pre></div>
</div>
<p>If the graph is directed, the representatives described above may by
equivalent modulo the rowspan of the Laplacian matrix:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">}},</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">group_order</span><span class="p">()</span>
<span class="go">28</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">jacobian_representatives</span><span class="p">()</span>
<span class="go">[{0: -5, 1: 3, 2: 2}, {0: -4, 1: 3, 2: 1}]</span>
</pre></div>
</div>
<p>Let <span class="math notranslate nohighlight">\(\tau\)</span> be the nonnegative generator of the kernel of the transpose of
the Laplacian, and let <span class="math notranslate nohighlight">\(tau_s\)</span> be it sink component, then the sandpile
group is isomorphic to the direct sum of the cyclic group of order
<span class="math notranslate nohighlight">\(\tau_s\)</span> and the Jacobian group.  In the example above, we have:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">laplacian</span><span class="p">()</span><span class="o">.</span><span class="n">left_kernel</span><span class="p">()</span>
<span class="go">Free module of degree 3 and rank 1 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[14  5  8]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Jacobian group is the set of all divisors of degree zero modulo the
integer rowspan of the Laplacian matrix.</p>
</div>
<p>—</p>
<p id="id9"><strong>laplacian()</strong></p>
<p>The Laplacian matrix of the graph.  Its <em>rows</em> encode the vertex firing rules.</p>
<p>OUTPUT:</p>
<p>matrix</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Diamond</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">laplacian</span><span class="p">()</span>
<span class="go">[ 2 -1 -1  0]</span>
<span class="go">[-1  3 -1 -1]</span>
<span class="go">[-1 -1  3 -1]</span>
<span class="go">[ 0 -1 -1  2]</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The function <code class="docutils literal notranslate"><span class="pre">laplacian_matrix</span></code> should be avoided.  It returns the
indegree version of the Laplacian.</p>
</div>
<p>—</p>
<p id="markov-chain"><strong>markov_chain(state, distrib=None)</strong></p>
<p>The sandpile Markov chain for configurations or divisors.
The chain starts at <code class="docutils literal notranslate"><span class="pre">state</span></code>.  See NOTE for details.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">state</span></code>  – SandpileConfig, SandpileDivisor, or list representing one of these</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">distrib</span></code> – (optional) list of nonnegative numbers summing to 1 (representing a prob. dist.)</p></li>
</ul>
<p>OUTPUT:</p>
<p>generator for Markov chain (see NOTE)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">markov_chain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>          <span class="c1"># random</span>
<span class="go">{1: 0, 2: 0, 3: 0}</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="c1"># random</span>
<span class="go">[0, 0, 0]</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="c1"># random</span>
<span class="go">[0, 0, 0]</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="c1"># random</span>
<span class="go">[0, 0, 0]</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="c1"># random</span>
<span class="go">[0, 1, 0]</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="c1"># random</span>
<span class="go">[0, 2, 0]</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="c1"># random</span>
<span class="go">[0, 2, 1]</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="c1"># random</span>
<span class="go">[1, 2, 1]</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="c1"># random</span>
<span class="go">[2, 2, 1]</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">markov_chain</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">zero_div</span><span class="p">(),</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="c1"># random</span>
<span class="go">[0, 0, 0, 1]</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="c1"># random</span>
<span class="go">[0, 0, 1, 1]</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="c1"># random</span>
<span class="go">[0, 0, 1, 2]</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="c1"># random</span>
<span class="go">[1, 1, 2, 0]</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="c1"># random</span>
<span class="go">[1, 1, 2, 1]</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="c1"># random</span>
<span class="go">[1, 1, 2, 2]</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="c1"># random</span>
<span class="go">[1, 1, 2, 3]</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="c1"># random</span>
<span class="go">[1, 1, 2, 4]</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="c1"># random</span>
<span class="go">[1, 1, 3, 4]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">closed</span> <span class="pre">sandpile</span> <span class="pre">Markov</span> <span class="pre">chain</span></code> has state space consisting of the configurations
on a sandpile.  It transitions from a state by choosing a vertex at random
(according to the probability distribution <code class="docutils literal notranslate"><span class="pre">distrib</span></code>), dropping a grain of sand at
that vertex, and stabilizing.  If the chosen vertex is the sink, the chain stays
at the current state.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">open</span> <span class="pre">sandpile</span> <span class="pre">Markov</span> <span class="pre">chain</span></code> has state space consisting of the recurrent elements,
i.e., the state space is the sandpile group.  It transitions from the configuration <span class="math notranslate nohighlight">\(c\)</span>
by choosing a vertex <span class="math notranslate nohighlight">\(v\)</span> at random according to <code class="docutils literal notranslate"><span class="pre">distrib</span></code>.  The next state is the
stabilization of <span class="math notranslate nohighlight">\(c+v\)</span>.  If <span class="math notranslate nohighlight">\(v\)</span> is the sink vertex, then the stabilization of <span class="math notranslate nohighlight">\(c+v\)</span>
is defined to be <span class="math notranslate nohighlight">\(c\)</span>.</p>
<p>Note that in either case, if <code class="docutils literal notranslate"><span class="pre">distrib</span></code> is specified, its length is equal to
the total number of vertices (including the sink).</p>
</div>
<p>REFERENCES:</p>
<div role="list" class="citation-list">
<div class="citation" id="levine2014" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>Levine2014<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id10">1</a>,<a role="doc-backlink" href="#id15">2</a>)</span>
<p>Lionel Levine. Threshold state and a conjecture of Poghosyan, Poghosyan,
Priezzhev and Ruelle, Communications in Mathematical Physics.
<a class="reference external" href="https://arxiv.org/abs/1402.3283">arXiv 1402.3283</a></p>
</div>
</div>
<p>—</p>
<p id="max-stable"><strong>max_stable()</strong></p>
<p>The maximal stable configuration.</p>
<p>OUTPUT:</p>
<p>SandpileConfig (the maximal stable configuration)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">House</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span>
<span class="go">{1: 1, 2: 2, 3: 2, 4: 1}</span>
</pre></div>
</div>
<p>—</p>
<p id="max-stable-div"><strong>max_stable_div()</strong></p>
<p>The maximal stable divisor.</p>
<p>OUTPUT:</p>
<p>SandpileDivisor (the maximal stable divisor)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Diamond</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">max_stable_div</span><span class="p">()</span>
<span class="go">{0: 1, 1: 2, 2: 2, 3: 1}</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">out_degree</span><span class="p">()</span>
<span class="go">{0: 2, 1: 3, 2: 3, 3: 2}</span>
</pre></div>
</div>
<p>—</p>
<p id="max-superstables"><strong>max_superstables(verbose=True)</strong></p>
<p>The maximal superstable configurations.  If the underlying graph is
undirected, these are the superstables of highest degree.  If
<code class="docutils literal notranslate"><span class="pre">verbose</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, the configurations are converted to lists of
integers.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) boolean</p>
<p>OUTPUT:</p>
<p>tuple of SandpileConfig</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Diamond</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">superstables</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[[0, 0, 0],</span>
<span class="go"> [0, 0, 1],</span>
<span class="go"> [1, 0, 1],</span>
<span class="go"> [0, 2, 0],</span>
<span class="go"> [2, 0, 0],</span>
<span class="go"> [0, 1, 1],</span>
<span class="go"> [1, 0, 0],</span>
<span class="go"> [0, 1, 0]]</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">max_superstables</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[[1, 0, 1], [0, 2, 0], [2, 0, 0], [0, 1, 1]]</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">h_vector</span><span class="p">()</span>
<span class="go">[1, 3, 4]</span>
</pre></div>
</div>
<p>—</p>
<p id="min-recurrents"><strong>min_recurrents(verbose=True)</strong></p>
<p>The minimal recurrent elements.  If the underlying graph is
undirected, these are the recurrent elements of least degree.
If <code class="docutils literal notranslate"><span class="pre">verbose</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, the configurations are converted
to lists of integers.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) boolean</p>
<p>OUTPUT:</p>
<p>list of SandpileConfig</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Diamond</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">recurrents</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[[2, 2, 1],</span>
<span class="go"> [2, 2, 0],</span>
<span class="go"> [1, 2, 0],</span>
<span class="go"> [2, 0, 1],</span>
<span class="go"> [0, 2, 1],</span>
<span class="go"> [2, 1, 0],</span>
<span class="go"> [1, 2, 1],</span>
<span class="go"> [2, 1, 1]]</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">min_recurrents</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[[1, 2, 0], [2, 0, 1], [0, 2, 1], [2, 1, 0]]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">deg</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">recurrents</span><span class="p">()]</span>
<span class="go">[5, 4, 3, 3, 3, 3, 4, 4]</span>
</pre></div>
</div>
<p>—</p>
<p id="nonsink-vertices"><strong>nonsink_vertices()</strong></p>
<p>The nonsink vertices.</p>
<p>OUTPUT:</p>
<p>list of vertices</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Grid</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">nonsink_vertices</span><span class="p">()</span>
<span class="go">[(1, 1), (1, 2), (1, 3), (2, 1), (2, 2), (2, 3)]</span>
</pre></div>
</div>
<p>—</p>
<p id="nonspecial-divisors"><strong>nonspecial_divisors(verbose=True)</strong></p>
<p>The nonspecial divisors. Only for undirected graphs.  (See NOTE.)</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) boolean</p>
<p>OUTPUT:</p>
<p>list (of divisors)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ns</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">nonspecial_divisors</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">ns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[-1, 0, 1, 2]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">deg</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">effective_div</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ns</span><span class="p">]</span>
<span class="go">[[], [], [], [], [], []]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The “nonspecial divisors” are those divisors of degree <span class="math notranslate nohighlight">\(g-1\)</span> with
empty linear system.  The term is only defined for undirected graphs.
Here, <span class="math notranslate nohighlight">\(g = |E| - |V| + 1\)</span> is the genus of the graph (not counting loops
as part of <span class="math notranslate nohighlight">\(|E|\)</span>).  If <code class="docutils literal notranslate"><span class="pre">verbose</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, the divisors are converted
to lists of integers.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The underlying graph must be undirected.</p>
</div>
<p>—</p>
<p id="out-degree"><strong>out_degree(v=None)</strong></p>
<p>The out-degree of a vertex or a list of all out-degrees.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">v</span></code> - (optional) vertex name</p>
<p>OUTPUT:</p>
<p>integer or dict</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">House</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">out_degree</span><span class="p">()</span>
<span class="go">{0: 2, 1: 2, 2: 3, 3: 3, 4: 2}</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">out_degree</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>—</p>
<p id="picard-representatives"><strong>picard_representatives(d, verbose=True)</strong></p>
<p>Representatives of the divisor classes of degree <span class="math notranslate nohighlight">\(d\)</span> in the Picard group.  (Also
see the documentation for <code class="docutils literal notranslate"><span class="pre">jacobian_representatives</span></code>.)</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">d</span></code> – integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) boolean</p></li>
</ul>
<p>OUTPUT:</p>
<p>list of SandpileDivisors (or lists representing divisors)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">superstables</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[[0, 0], [0, 1], [1, 0]]</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">jacobian_representatives</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[[0, 0, 0], [-1, 0, 1], [-1, 1, 0]]</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">picard_representatives</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[[3, 0, 0], [2, 0, 1], [2, 1, 0]]</span>
</pre></div>
</div>
<p>—</p>
<p id="points"><strong>points()</strong></p>
<p>Generators for the multiplicative group of zeros of the sandpile
ideal.</p>
<p>OUTPUT:</p>
<p>list of complex numbers</p>
<p>EXAMPLES:</p>
<p>The sandpile group in this example is cyclic, and hence there is a
single generator for the group of solutions.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">points</span><span class="p">()</span>
<span class="go">[[-I, I, 1], [-I, 1, I]]</span>
</pre></div>
</div>
<p>—</p>
<p id="postulation"><strong>postulation()</strong></p>
<p>The postulation number of the toppling ideal.  This is the
largest weight of a superstable configuration of the graph.</p>
<p>OUTPUT:</p>
<p>nonnegative integer</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">postulation</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
<p>—</p>
<p id="recurrents"><strong>recurrents(verbose=True)</strong></p>
<p>The recurrent configurations. If <code class="docutils literal notranslate"><span class="pre">verbose</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, the
configurations are converted to lists of integers.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) boolean</p>
<p>OUTPUT:</p>
<p>list of recurrent configurations</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">HouseXGraph</span><span class="p">(),</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">recurrents</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">r</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
<span class="go">[{1: 2, 2: 3, 3: 3, 4: 1}, {1: 1, 2: 3, 3: 3, 4: 0}, {1: 1, 2: 3, 3: 3, 4: 1}]</span>
<span class="gp">sage: </span><span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">recurrents</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[[2, 2, 2],</span>
<span class="go"> [2, 2, 1],</span>
<span class="go"> [2, 1, 2],</span>
<span class="go"> [1, 2, 2],</span>
<span class="go"> [2, 2, 0],</span>
<span class="go"> [2, 0, 2],</span>
<span class="go"> [0, 2, 2],</span>
<span class="go"> [2, 1, 1],</span>
<span class="go"> [1, 2, 1],</span>
<span class="go"> [1, 1, 2],</span>
<span class="go"> [2, 1, 0],</span>
<span class="go"> [2, 0, 1],</span>
<span class="go"> [1, 2, 0],</span>
<span class="go"> [1, 0, 2],</span>
<span class="go"> [0, 2, 1],</span>
<span class="go"> [0, 1, 2]]</span>
<span class="gp">sage: </span><span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">recurrents</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[[1, 1, 1], [0, 1, 1], [1, 0, 1], [1, 1, 0]]</span>
</pre></div>
</div>
<p>—</p>
<p id="reduced-laplacian"><strong>reduced_laplacian()</strong></p>
<p>The reduced Laplacian matrix of the graph.</p>
<p>OUTPUT:</p>
<p>matrix</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Diamond</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">laplacian</span><span class="p">()</span>
<span class="go">[ 2 -1 -1  0]</span>
<span class="go">[-1  3 -1 -1]</span>
<span class="go">[-1 -1  3 -1]</span>
<span class="go">[ 0 -1 -1  2]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">reduced_laplacian</span><span class="p">()</span>
<span class="go">[ 3 -1 -1]</span>
<span class="go">[-1  3 -1]</span>
<span class="go">[-1 -1  2]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is the Laplacian matrix with the row and column indexed by the
sink vertex removed.</p>
</div>
<p>—</p>
<p id="reorder-vertices"><strong>reorder_vertices()</strong></p>
<p>A copy of the sandpile with vertex names permuted.  After reordering,
vertex <span class="math notranslate nohighlight">\(u\)</span> comes before vertex <span class="math notranslate nohighlight">\(v\)</span> in the list of vertices if <span class="math notranslate nohighlight">\(u\)</span> is
closer to the sink.</p>
<p>OUTPUT:</p>
<p>Sandpile</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">2</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span>
<span class="go">{0: {1: 1}, 1: {2: 1}, 2: {0: 1, 1: 1}}</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">reorder_vertices</span><span class="p">()</span>
</pre></div>
</div>
<p>The vertices 1 and 2 have been swapped:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span>
<span class="go">{0: {1: 1}, 1: {0: 1, 2: 1}, 2: {0: 1}}</span>
</pre></div>
</div>
<p>—</p>
<p id="resolution"><strong>resolution(verbose=False)</strong></p>
<p>A minimal free resolution of the homogeneous toppling ideal.  If
<code class="docutils literal notranslate"><span class="pre">verbose</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, then all of the mappings are returned.
Otherwise, the resolution is summarized.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) boolean</p>
<p>OUTPUT:</p>
<p>free resolution of the toppling ideal</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">{},</span> <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span> <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">}},</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">resolution</span><span class="p">()</span>  <span class="c1"># a Gorenstein sandpile graph</span>
<span class="go">&#39;R^1 &lt;-- R^5 &lt;-- R^5 &lt;-- R^1&#39;</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">resolution</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">[ x1^2 - x3*x0 x3*x1 - x2*x0  x3^2 - x2*x1  x2*x3 - x0^2  x2^2 - x1*x0],</span>

<span class="go">[ x3  x2   0  x0   0]  [ x2^2 - x1*x0]</span>
<span class="go">[-x1 -x3  x2   0 -x0]  [-x2*x3 + x0^2]</span>
<span class="go">[ x0  x1   0  x2   0]  [-x3^2 + x2*x1]</span>
<span class="go">[  0   0 -x1 -x3  x2]  [x3*x1 - x2*x0]</span>
<span class="go">[  0   0  x0  x1 -x3], [ x1^2 - x3*x0]</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">resolution</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">[0 0 0 0 0]</span>
<span class="gp">sage: </span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">[0]</span>
<span class="go">[0]</span>
<span class="go">[0]</span>
<span class="go">[0]</span>
<span class="go">[0]</span>
</pre></div>
</div>
<p>—</p>
<p id="ring"><strong>ring()</strong></p>
<p>The ring containing the homogeneous toppling ideal.</p>
<p>OUTPUT:</p>
<p>ring</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Diamond</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">ring</span><span class="p">()</span>
<span class="go">Multivariate Polynomial Ring in x3, x2, x1, x0 over Rational Field</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">ring</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(x3, x2, x1, x0)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The indeterminate <code class="docutils literal notranslate"><span class="pre">xi</span></code> corresponds to the <span class="math notranslate nohighlight">\(i\)</span>-th vertex as listed my
the method <code class="docutils literal notranslate"><span class="pre">vertices</span></code>. The term-ordering is degrevlex with
indeterminates ordered according to their distance from the sink (larger
indeterminates are further from the sink).</p>
</div>
<p>—</p>
<p id="show"><strong>show(**kwds)</strong></p>
<p>Draw the underlying graph.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">kwds</span></code> – (optional) arguments passed to the show method for Graph or DiGraph</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">({</span><span class="mi">0</span><span class="p">:[],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">4</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">5</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">graph_border</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">edge_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>—</p>
<p id="show3d"><strong>show3d(**kwds)</strong></p>
<p>Draw the underlying graph.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">kwds</span></code> – (optional) arguments passed to the show method for Graph or DiGraph</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">House</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">show3d</span><span class="p">()</span>
</pre></div>
</div>
<p>—</p>
<p id="sink"><strong>sink()</strong></p>
<p>The sink vertex.</p>
<p>OUTPUT:</p>
<p>sink vertex</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">House</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">sink</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Grid</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">sink</span><span class="p">()</span>
<span class="go">(0, 0)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">sink</span><span class="p">())</span>
<span class="go">&lt;... &#39;tuple&#39;&gt;</span>
</pre></div>
</div>
<p>—</p>
<p id="smith-form"><strong>smith_form()</strong></p>
<p>The Smith normal form for the Laplacian.  In detail: a list of integer
matrices <span class="math notranslate nohighlight">\(D, U, V\)</span> such that <span class="math notranslate nohighlight">\(ULV = D\)</span> where <span class="math notranslate nohighlight">\(L\)</span> is the transpose of the
Laplacian, <span class="math notranslate nohighlight">\(D\)</span> is diagonal, and  <span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(V\)</span> are invertible over the
integers.</p>
<p>OUTPUT:</p>
<p>list of integer matrices</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">V</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">smith_form</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span>
<span class="go">[1 0 0 0]</span>
<span class="go">[0 4 0 0]</span>
<span class="go">[0 0 4 0]</span>
<span class="go">[0 0 0 0]</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">*</span><span class="n">s</span><span class="o">.</span><span class="n">laplacian</span><span class="p">()</span><span class="o">*</span><span class="n">V</span> <span class="o">==</span> <span class="n">D</span>  <span class="c1"># laplacian symmetric =&gt; transpose not necessary</span>
<span class="go">True</span>
</pre></div>
</div>
<p>—</p>
<p id="solve"><strong>solve()</strong></p>
<p>Approximations of the complex affine zeros of the sandpile
ideal.</p>
<p>OUTPUT:</p>
<p>list of complex numbers</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">{},</span> <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">}},</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="go">[[-0.707107000000000 + 0.707107000000000*I,</span>
<span class="go">  0.707107000000000 - 0.707107000000000*I],</span>
<span class="go"> [-0.707107000000000 - 0.707107000000000*I,</span>
<span class="go">  0.707107000000000 + 0.707107000000000*I],</span>
<span class="go"> [-I, -I],</span>
<span class="go"> [I, I],</span>
<span class="go"> [0.707107000000000 + 0.707107000000000*I,</span>
<span class="go">  -0.707107000000000 - 0.707107000000000*I],</span>
<span class="go"> [0.707107000000000 - 0.707107000000000*I,</span>
<span class="go">  -0.707107000000000 + 0.707107000000000*I],</span>
<span class="go"> [1, 1],</span>
<span class="go"> [-1, -1]]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">8</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">group_order</span><span class="p">()</span>
<span class="go">8</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The solutions form a multiplicative group isomorphic to the sandpile
group.  Generators for this group are given exactly by <code class="docutils literal notranslate"><span class="pre">points()</span></code>.</p>
</div>
<p>—</p>
<p id="stable-configs"><strong>stable_configs(smax=None)</strong></p>
<p>Generator for all stable configurations.  If <code class="docutils literal notranslate"><span class="pre">smax</span></code> is provided, then
the generator gives all stable configurations less than or equal to
<code class="docutils literal notranslate"><span class="pre">smax</span></code>.  If <code class="docutils literal notranslate"><span class="pre">smax</span></code> does not represent a stable configuration, then each
component of <code class="docutils literal notranslate"><span class="pre">smax</span></code> is replaced by the corresponding component of the
maximal stable configuration.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">smax</span></code> – (optional) SandpileConfig or list representing a SandpileConfig</p>
<p>OUTPUT:</p>
<p>generator for all stable configurations</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">stable_configs</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">{1: 0, 2: 0}</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a</span><span class="p">]</span>
<span class="go">[[0, 1], [1, 0], [1, 1]]</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">stable_configs</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">[{1: 0, 2: 0}, {1: 1, 2: 0}]</span>
</pre></div>
</div>
<p>—</p>
<p id="stationary-density"><strong>stationary_density()</strong></p>
<p>The stationary density of the sandpile.</p>
<p>OUTPUT:</p>
<p>rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">stationary_density</span><span class="p">()</span>
<span class="go">10/9</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">digraphs</span><span class="o">.</span><span class="n">DeBruijn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="s1">&#39;00&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">stationary_density</span><span class="p">()</span>
<span class="go">9/8</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The stationary density of a sandpile is the sum <span class="math notranslate nohighlight">\(\sum_c (\deg(c) + \deg(s))\)</span>
where <span class="math notranslate nohighlight">\(\deg(s)\)</span> is the degree of the sink and the sum is over all
recurrent configurations.</p>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#levine2014" id="id10"><span>[Levine2014]</span></a></p></li>
</ul>
<p>—</p>
<p id="superstables"><strong>superstables(verbose=True)</strong></p>
<p>The superstable configurations.  If <code class="docutils literal notranslate"><span class="pre">verbose</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, the
configurations are converted to lists of integers.  Superstables for
undirected graphs are also known as <code class="docutils literal notranslate"><span class="pre">G-parking</span> <span class="pre">functions</span></code>.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) boolean</p>
<p>OUTPUT:</p>
<p>list of SandpileConfig</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sp</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">HouseXGraph</span><span class="p">(),</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">superstables</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">sp</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
<span class="go">[{1: 0, 2: 0, 3: 0, 4: 0}, {1: 1, 2: 0, 3: 0, 4: 1}, {1: 1, 2: 0, 3: 0, 4: 0}]</span>
<span class="gp">sage: </span><span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">superstables</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[[0, 0, 0],</span>
<span class="go"> [0, 0, 1],</span>
<span class="go"> [0, 1, 0],</span>
<span class="go"> [1, 0, 0],</span>
<span class="go"> [0, 0, 2],</span>
<span class="go"> [0, 2, 0],</span>
<span class="go"> [2, 0, 0],</span>
<span class="go"> [0, 1, 1],</span>
<span class="go"> [1, 0, 1],</span>
<span class="go"> [1, 1, 0],</span>
<span class="go"> [0, 1, 2],</span>
<span class="go"> [0, 2, 1],</span>
<span class="go"> [1, 0, 2],</span>
<span class="go"> [1, 2, 0],</span>
<span class="go"> [2, 0, 1],</span>
<span class="go"> [2, 1, 0]]</span>
<span class="gp">sage: </span><span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">superstables</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[[0, 0, 0], [1, 0, 0], [0, 1, 0], [0, 0, 1]]</span>
</pre></div>
</div>
<p>—</p>
<p id="symmetric-recurrents"><strong>symmetric_recurrents(orbits)</strong></p>
<p>The symmetric recurrent configurations.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">orbits</span></code> - list of lists partitioning the vertices</p>
<p>OUTPUT:</p>
<p>list of recurrent configurations</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">{},</span>
<span class="gp">....: </span>             <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
<span class="gp">....: </span>             <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
<span class="gp">....: </span>             <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
<span class="gp">....: </span>             <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">}})</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">symmetric_recurrents</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">]])</span>
<span class="go">[{1: 2, 2: 2, 3: 2, 4: 1}, {1: 2, 2: 2, 3: 2, 4: 0}]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">recurrents</span><span class="p">()</span>
<span class="go">[{1: 2, 2: 2, 3: 2, 4: 1},</span>
<span class="go"> {1: 2, 2: 2, 3: 2, 4: 0},</span>
<span class="go"> {1: 2, 2: 1, 3: 2, 4: 0},</span>
<span class="go"> {1: 2, 2: 2, 3: 0, 4: 1},</span>
<span class="go"> {1: 2, 2: 0, 3: 2, 4: 1},</span>
<span class="go"> {1: 2, 2: 2, 3: 1, 4: 0},</span>
<span class="go"> {1: 2, 2: 1, 3: 2, 4: 1},</span>
<span class="go"> {1: 2, 2: 2, 3: 1, 4: 1}]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The user is responsible for ensuring that the list of orbits comes from
a group of symmetries of the underlying graph.</p>
</div>
<p>—</p>
<p id="tutte-polynomial"><strong>tutte_polynomial()</strong></p>
<p>The Tutte polynomial of the underlying graph.
Only defined for undirected sandpile graphs.</p>
<p>OUTPUT:</p>
<p>polynomial</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">tutte_polynomial</span><span class="p">()</span>
<span class="go">x^3 + y^3 + 3*x^2 + 4*x*y + 3*y^2 + 2*x + 2*y</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">tutte_polynomial</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">y^3 + 3*y^2 + 6*y + 6</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">tutte_polynomial</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">coefficients</span><span class="p">()</span> <span class="o">==</span> <span class="n">s</span><span class="o">.</span><span class="n">h_vector</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>—</p>
<p id="unsaturated-ideal"><strong>unsaturated_ideal()</strong></p>
<p>The unsaturated, homogeneous toppling ideal.</p>
<p>OUTPUT:</p>
<p>ideal</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Diamond</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">unsaturated_ideal</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[x1^3 - x3*x2*x0, x2^3 - x3*x1*x0, x3^2 - x2*x1]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">ideal</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[x2*x1 - x0^2, x3^2 - x0^2, x1^3 - x3*x2*x0, x3*x1^2 - x2^2*x0, x2^3 - x3*x1*x0, x3*x2^2 - x1^2*x0]</span>
</pre></div>
</div>
<p>—</p>
<p id="version"><strong>version()</strong></p>
<p>The version number of Sage Sandpiles.</p>
<p>OUTPUT:</p>
<p>string</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Sandpile</span><span class="o">.</span><span class="n">version</span><span class="p">()</span>
<span class="go">Sage Sandpiles Version 2.4</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">version</span><span class="p">()</span>
<span class="go">Sage Sandpiles Version 2.4</span>
</pre></div>
</div>
<p>—</p>
<p id="zero-config"><strong>zero_config()</strong></p>
<p>The all-zero configuration.</p>
<p>OUTPUT:</p>
<p>SandpileConfig</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Diamond</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">zero_config</span><span class="p">()</span>
<span class="go">{1: 0, 2: 0, 3: 0}</span>
</pre></div>
</div>
<p>—</p>
<p id="zero-div"><strong>zero_div()</strong></p>
<p>The all-zero divisor.</p>
<p>OUTPUT:</p>
<p>SandpileDivisor</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">House</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">zero_div</span><span class="p">()</span>
<span class="go">{0: 0, 1: 0, 2: 0, 3: 0, 4: 0}</span>
</pre></div>
</div>
<p>—</p>
</section>
<section id="sandpileconfig">
<h4>SandpileConfig<a class="headerlink" href="#sandpileconfig" title="Permalink to this heading">#</a></h4>
<p><strong>Summary of methods.</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="#id11"><span class="std std-ref">+</span></a> — Addition of configurations.</p></li>
<li><p><a class="reference internal" href="#id12"><span class="std std-ref">&amp;</span></a> — The stabilization of the sum.</p></li>
<li><p><a class="reference internal" href="#greater-equal"><span class="std std-ref">greater-equal</span></a> — <code class="docutils literal notranslate"><span class="pre">True</span></code> if every component of <code class="docutils literal notranslate"><span class="pre">self</span></code> is at least that of <code class="docutils literal notranslate"><span class="pre">other</span></code>.</p></li>
<li><p><a class="reference internal" href="#greater"><span class="std std-ref">greater</span></a> — <code class="docutils literal notranslate"><span class="pre">True</span></code> if every component of <code class="docutils literal notranslate"><span class="pre">self</span></code> is at least that of <code class="docutils literal notranslate"><span class="pre">other</span></code> and the two configurations are not equal.</p></li>
<li><p><a class="reference internal" href="#id13"><span class="std std-ref">~</span></a> — The stabilized configuration.</p></li>
<li><p><a class="reference internal" href="#less-equal"><span class="std std-ref">less-equal</span></a> — <code class="docutils literal notranslate"><span class="pre">True</span></code> if every component of <code class="docutils literal notranslate"><span class="pre">self</span></code> is at most that of <code class="docutils literal notranslate"><span class="pre">other</span></code>.</p></li>
<li><p><a class="reference internal" href="#less"><span class="std std-ref">less</span></a> — <code class="docutils literal notranslate"><span class="pre">True</span></code> if every component of <code class="docutils literal notranslate"><span class="pre">self</span></code> is at most that of <code class="docutils literal notranslate"><span class="pre">other</span></code> and the two configurations are not equal.</p></li>
<li><p><a class="reference internal" href="#mul"><span class="std std-ref">*</span></a> — The recurrent element equivalent to the sum.</p></li>
<li><p><a class="reference internal" href="#pow"><span class="std std-ref">^</span></a> — Exponentiation for the *-operator.</p></li>
<li><p><a class="reference internal" href="#neg"><span class="std std-ref">-</span></a> — The additive inverse of the configuration.</p></li>
<li><p><a class="reference internal" href="#id14"><span class="std std-ref">-</span></a> — Subtraction of configurations.</p></li>
<li><p><a class="reference internal" href="#add-random-config"><span class="std std-ref">add_random</span></a> — Add one grain of sand to a random vertex.</p></li>
<li><p><a class="reference internal" href="#burst-size-config"><span class="std std-ref">burst_size</span></a> — The burst size of the configuration with respect to the given vertex.</p></li>
<li><p><a class="reference internal" href="#deg-config"><span class="std std-ref">deg</span></a> — The degree of the configuration.</p></li>
<li><p><a class="reference internal" href="#dualize-config"><span class="std std-ref">dualize</span></a> — The difference with the maximal stable configuration.</p></li>
<li><p><a class="reference internal" href="#equivalent-recurrent-config"><span class="std std-ref">equivalent_recurrent</span></a> — The recurrent configuration equivalent to the given configuration.</p></li>
<li><p><a class="reference internal" href="#equivalent-superstable-config"><span class="std std-ref">equivalent_superstable</span></a> — The equivalent superstable configuration.</p></li>
<li><p><a class="reference internal" href="#fire-script-config"><span class="std std-ref">fire_script</span></a> — Fire the given script.</p></li>
<li><p><a class="reference internal" href="#fire-unstable-config"><span class="std std-ref">fire_unstable</span></a> — Fire all unstable vertices.</p></li>
<li><p><a class="reference internal" href="#fire-vertex-config"><span class="std std-ref">fire_vertex</span></a> — Fire the given vertex.</p></li>
<li><p><a class="reference internal" href="#help-config"><span class="std std-ref">help</span></a> — List of SandpileConfig methods.</p></li>
<li><p><a class="reference internal" href="#is-recurrent-config"><span class="std std-ref">is_recurrent</span></a> — Is the configuration recurrent?</p></li>
<li><p><a class="reference internal" href="#is-stable-config"><span class="std std-ref">is_stable</span></a> — Is the configuration stable?</p></li>
<li><p><a class="reference internal" href="#is-superstable-config"><span class="std std-ref">is_superstable</span></a> — Is the configuration superstable?</p></li>
<li><p><a class="reference internal" href="#is-symmetric-config"><span class="std std-ref">is_symmetric</span></a> — Is the configuration symmetric?</p></li>
<li><p><a class="reference internal" href="#order-config"><span class="std std-ref">order</span></a> — The order of the equivalent recurrent element.</p></li>
<li><p><a class="reference internal" href="#sandpile-config"><span class="std std-ref">sandpile</span></a> — The configuration’s underlying sandpile.</p></li>
<li><p><a class="reference internal" href="#show-config"><span class="std std-ref">show</span></a> — Show the configuration.</p></li>
<li><p><a class="reference internal" href="#stabilize-config"><span class="std std-ref">stabilize</span></a> — The stabilized configuration.</p></li>
<li><p><a class="reference internal" href="#support-config"><span class="std std-ref">support</span></a> — The vertices containing sand.</p></li>
<li><p><a class="reference internal" href="#unstable-config"><span class="std std-ref">unstable</span></a> — The unstable vertices.</p></li>
<li><p><a class="reference internal" href="#values-config"><span class="std std-ref">values</span></a> — The values of the configuration as a list.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Complete descriptions of SandpileConfig methods.</strong></p>
<p>—</p>
<p id="id11"><strong>+</strong></p>
<blockquote>
<div><p>Addition of configurations.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">other</span></code> – SandpileConfig</p>
<p>OUTPUT:</p>
<p>sum of <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">other</span></code></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">+</span> <span class="n">d</span>
<span class="go">{1: 4, 2: 4}</span>
</pre></div>
</div>
</div></blockquote>
<p>—</p>
<p id="id12"><strong>&amp;</strong></p>
<blockquote>
<div><p>The stabilization of the sum.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">other</span></code> – SandpileConfig</p>
<p>OUTPUT:</p>
<p>SandpileConfig</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">+</span> <span class="n">c</span>  <span class="c1"># ordinary addition</span>
<span class="go">{1: 2, 2: 0, 3: 0}</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">&amp;</span> <span class="n">c</span>  <span class="c1"># add and stabilize</span>
<span class="go">{1: 0, 2: 1, 3: 0}</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">*</span><span class="n">c</span>  <span class="c1"># add and find equivalent recurrent</span>
<span class="go">{1: 1, 2: 1, 3: 1}</span>
<span class="gp">sage: </span><span class="o">~</span><span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span> <span class="o">==</span> <span class="n">c</span> <span class="o">&amp;</span> <span class="n">c</span>
<span class="go">True</span>
</pre></div>
</div>
</div></blockquote>
<p>—</p>
<p id="greater-equal"><strong>&gt;=</strong></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if every component of <code class="docutils literal notranslate"><span class="pre">self</span></code> is at least that of
<code class="docutils literal notranslate"><span class="pre">other</span></code>.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">other</span></code> – SandpileConfig</p>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">&gt;=</span> <span class="n">c</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">&gt;=</span> <span class="n">c</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">&gt;=</span> <span class="n">d</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">&gt;=</span> <span class="n">c</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">&gt;=</span> <span class="n">e</span>
<span class="go">False</span>
</pre></div>
</div>
</div></blockquote>
<p>—</p>
<p id="greater"><strong>&gt;</strong></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if every component of <code class="docutils literal notranslate"><span class="pre">self</span></code> is at least that of
<code class="docutils literal notranslate"><span class="pre">other</span></code> and the two configurations are not equal.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">other</span></code> – SandpileConfig</p>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">&gt;</span> <span class="n">c</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">&gt;</span> <span class="n">c</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">&gt;</span> <span class="n">d</span>
<span class="go">False</span>
</pre></div>
</div>
</div></blockquote>
<p>—</p>
<p id="id13"><strong>~</strong></p>
<blockquote>
<div><p>The stabilized configuration.</p>
<p>OUTPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">SandpileConfig</span></code></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">House</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span> <span class="o">+</span> <span class="n">S</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="gp">sage: </span><span class="o">~</span><span class="n">c</span> <span class="o">==</span> <span class="n">c</span><span class="o">.</span><span class="n">stabilize</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div></blockquote>
<p>—</p>
<p id="less-equal"><strong>&lt;=</strong></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if every component of <code class="docutils literal notranslate"><span class="pre">self</span></code> is at most that of
<code class="docutils literal notranslate"><span class="pre">other</span></code>.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">other</span></code> – SandpileConfig</p>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">&lt;=</span> <span class="n">c</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">&lt;=</span> <span class="n">d</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">&lt;=</span> <span class="n">c</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">&lt;=</span> <span class="n">e</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">&lt;=</span> <span class="n">c</span>
<span class="go">False</span>
</pre></div>
</div>
</div></blockquote>
<p>—</p>
<p id="less"><strong>&lt;</strong></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if every component of <code class="docutils literal notranslate"><span class="pre">self</span></code> is at most that of
<code class="docutils literal notranslate"><span class="pre">other</span></code> and the two configurations are not equal.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">other</span></code> – SandpileConfig</p>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">&lt;</span> <span class="n">c</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">&lt;</span> <span class="n">d</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">&lt;</span> <span class="n">c</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">&lt;</span> <span class="n">c</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">&lt;</span> <span class="n">d</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">&lt;</span> <span class="n">c</span>
<span class="go">False</span>
</pre></div>
</div>
</div></blockquote>
<p>—</p>
<p id="mul"><strong>*</strong></p>
<blockquote>
<div><p>If <code class="docutils literal notranslate"><span class="pre">other</span></code> is an configuration, the recurrent element equivalent
to the sum.  If <code class="docutils literal notranslate"><span class="pre">other</span></code> is an integer, the sum of configuration with
itself <code class="docutils literal notranslate"><span class="pre">other</span></code> times.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">other</span></code> – SandpileConfig or Integer</p>
<p>OUTPUT:</p>
<p>SandpileConfig</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">+</span> <span class="n">c</span>  <span class="c1"># ordinary addition</span>
<span class="go">{1: 2, 2: 0, 3: 0}</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">&amp;</span> <span class="n">c</span>  <span class="c1"># add and stabilize</span>
<span class="go">{1: 0, 2: 1, 3: 0}</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">*</span><span class="n">c</span>  <span class="c1"># add and find equivalent recurrent</span>
<span class="go">{1: 1, 2: 1, 3: 1}</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">is_recurrent</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="p">)</span> <span class="o">==</span> <span class="n">S</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c</span>
<span class="go">{1: 1, 2: 0, 3: 0}</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">*</span><span class="mi">3</span>
<span class="go">{1: 3, 2: 0, 3: 0}</span>
</pre></div>
</div>
</div></blockquote>
<p>—</p>
<p id="pow"><strong>^</strong></p>
<blockquote>
<div><p>The recurrent element equivalent to the sum of the
configuration with itself <span class="math notranslate nohighlight">\(k\)</span> times.  If <span class="math notranslate nohighlight">\(k\)</span> is negative, do the
same for the negation of the configuration.  If <span class="math notranslate nohighlight">\(k\)</span> is zero, return
the identity of the sandpile group.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">k</span></code> – SandpileConfig</p>
<p>OUTPUT:</p>
<p>SandpileConfig</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">^</span><span class="mi">3</span>
<span class="go">{1: 1, 2: 1, 3: 0}</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="n">c</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span> <span class="o">==</span> <span class="n">c</span><span class="o">^</span><span class="mi">3</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="n">c</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">equivalent_recurrent</span><span class="p">()</span> <span class="o">==</span> <span class="n">c</span><span class="o">^</span><span class="mi">3</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">{1: 1, 2: 1, 3: 0}</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">^</span><span class="mi">0</span> <span class="o">==</span> <span class="n">S</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div></blockquote>
<p>—</p>
<p id="neg"><strong>_</strong></p>
<blockquote>
<div><p>The additive inverse of the configuration.</p>
<p>OUTPUT:</p>
<p>SandpileConfig</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="o">-</span><span class="n">c</span>
<span class="go">{1: -1, 2: -2}</span>
</pre></div>
</div>
</div></blockquote>
<p>—</p>
<p id="id14"><strong>-</strong></p>
<blockquote>
<div><p>Subtraction of configurations.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">other</span></code> – SandpileConfig</p>
<p>OUTPUT:</p>
<p>sum of <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">other</span></code></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">-</span> <span class="n">d</span>
<span class="go">{1: -2, 2: 0}</span>
</pre></div>
</div>
</div></blockquote>
<p>—</p>
<p id="add-random-config"><strong>add_random(distrib=None)</strong></p>
<p>Add one grain of sand to a random vertex.  Optionally, a probability
distribution, <code class="docutils literal notranslate"><span class="pre">distrib</span></code>, may be placed on the vertices or the nonsink vertices.
See NOTE for details.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">distrib</span></code> – (optional) list of nonnegative numbers summing to 1 (representing a prob. dist.)</p>
<p>OUTPUT:</p>
<p>SandpileConfig</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">zero_config</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">add_random</span><span class="p">()</span> <span class="c1"># random</span>
<span class="go">{1: 0, 2: 1, 3: 0}</span>
<span class="gp">sage: </span><span class="n">c</span>
<span class="go">{1: 0, 2: 0, 3: 0}</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">add_random</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.8</span><span class="p">])</span> <span class="c1"># random</span>
<span class="go">{1: 0, 2: 0, 3: 1}</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">add_random</span><span class="p">([</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">])</span> <span class="c1"># random</span>
<span class="go">{1: 0, 2: 0, 3: 0}</span>
</pre></div>
</div>
<p>We compute the “sizes” of the avalanches caused by adding random grains
of sand to the maximal stable configuration on a grid graph.  The
function <code class="docutils literal notranslate"><span class="pre">stabilize()</span></code> returns the firing vector of the
stabilization, a dictionary whose values say how many times each vertex
fires in the stabilization.:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Grid</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="n">m</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">add_random</span><span class="p">()</span>
<span class="gp">....: </span>    <span class="n">m</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">stabilize</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">list_plot</span><span class="p">([[</span><span class="n">log</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">i</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">a</span><span class="p">)]</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">i</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">axes_labels</span><span class="p">([</span><span class="s1">&#39;log(N)&#39;</span><span class="p">,</span><span class="s1">&#39;log(D(N))&#39;</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">text</span><span class="p">(</span><span class="s2">&quot;Distribution of avalanche sizes&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">show</span><span class="p">(</span><span class="n">p</span><span class="o">+</span><span class="n">t</span><span class="p">,</span><span class="n">axes_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;log(N)&#39;</span><span class="p">,</span><span class="s1">&#39;log(D(N))&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">distrib</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, then the probability is the uniform probability on the nonsink
vertices.  Otherwise, there are two possibilities:</p>
<p>(i) the length of <code class="docutils literal notranslate"><span class="pre">distrib</span></code> is equal to the number of vertices, and <code class="docutils literal notranslate"><span class="pre">distrib</span></code> represents
a probability distribution on all of the vertices.  In that case, the sink may be chosen
at random, in which case, the  configuration is unchanged.</p>
<p>(ii) Otherwise, the length of <code class="docutils literal notranslate"><span class="pre">distrib</span></code> must be equal to the number of nonsink vertices,
and <code class="docutils literal notranslate"><span class="pre">distrib</span></code> represents a probability distribution on the nonsink vertices.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If <code class="docutils literal notranslate"><span class="pre">distrib</span> <span class="pre">!=</span> <span class="pre">None</span></code>, the user is responsible for assuring the sum of its entries is
1 and that its length is equal to the number of sink vertices or the number of nonsink vertices.</p>
</div>
<p>—</p>
<p id="burst-size-config"><strong>burst_size(v)</strong></p>
<p>The burst size of the configuration with respect to the given vertex.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">v</span></code> – vertex</p>
<p>OUTPUT:</p>
<p>integer</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Diamond</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">burst_size</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">recurrents</span><span class="p">()]</span>
<span class="go">[1, 1, 1, 1, 1, 1, 1, 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">burst_size</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">recurrents</span><span class="p">()]</span>
<span class="go">[0, 0, 1, 2, 1, 2, 0, 2]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To define <code class="docutils literal notranslate"><span class="pre">c.burst(v)</span></code>, if <span class="math notranslate nohighlight">\(v\)</span> is not the sink, let <span class="math notranslate nohighlight">\(c'\)</span> be the unique
recurrent for which the stabilization of <span class="math notranslate nohighlight">\(c' + v\)</span> is <span class="math notranslate nohighlight">\(c\)</span>.  The
burst size is then the amount of sand that goes into the sink during this
stabilization.  If <span class="math notranslate nohighlight">\(v\)</span> is the sink, the burst size is defined to be 1.</p>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#levine2014" id="id15"><span>[Levine2014]</span></a></p></li>
</ul>
<p>—</p>
<p id="deg-config"><strong>deg()</strong></p>
<p>The degree of the configuration.</p>
<p>OUTPUT:</p>
<p>integer</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">deg</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
<p>—</p>
<p id="dualize-config"><strong>dualize()</strong></p>
<p>The difference with the maximal stable configuration.</p>
<p>OUTPUT:</p>
<p>SandpileConfig</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span>
<span class="go">{1: 1, 2: 1}</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">dualize</span><span class="p">()</span>
<span class="go">{1: 0, 2: -1}</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span> <span class="o">-</span> <span class="n">c</span> <span class="o">==</span> <span class="n">c</span><span class="o">.</span><span class="n">dualize</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>—</p>
<p id="equivalent-recurrent-config"><strong>equivalent_recurrent(with_firing_vector=False)</strong></p>
<p>The recurrent configuration equivalent to the given configuration.
Optionally, return the corresponding firing vector.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">with_firing_vector</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)  boolean</p>
<p>OUTPUT:</p>
<p>SandpileConfig or [SandpileConfig, firing_vector]</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Diamond</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">equivalent_recurrent</span><span class="p">()</span> <span class="o">==</span> <span class="n">S</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">equivalent_recurrent</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">S</span><span class="o">.</span><span class="n">nonsink_vertices</span><span class="p">()])</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">S</span><span class="o">.</span><span class="n">nonsink_vertices</span><span class="p">()])</span>
<span class="gp">sage: </span><span class="n">cv</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">==</span> <span class="n">cv</span> <span class="o">-</span> <span class="n">f</span><span class="o">*</span><span class="n">S</span><span class="o">.</span><span class="n">reduced_laplacian</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Let <span class="math notranslate nohighlight">\(L\)</span> be the reduced Laplacian, <span class="math notranslate nohighlight">\(c\)</span> the initial configuration, <span class="math notranslate nohighlight">\(r\)</span> the
returned configuration, and <span class="math notranslate nohighlight">\(f\)</span> the firing vector.  Then <span class="math notranslate nohighlight">\(r = c - f\cdot
L\)</span>.</p>
</div>
<p>—</p>
<p id="equivalent-superstable-config"><strong>equivalent_superstable(with_firing_vector=False)</strong></p>
<p>The equivalent superstable configuration. Optionally, return the
corresponding firing vector.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">with_firing_vector</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) boolean</p>
<p>OUTPUT:</p>
<p>SandpileConfig or [SandpileConfig, firing_vector]</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Diamond</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">equivalent_superstable</span><span class="p">()</span><span class="o">.</span><span class="n">is_superstable</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">equivalent_superstable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">mv</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">==</span> <span class="n">mv</span> <span class="o">-</span> <span class="n">f</span><span class="o">*</span><span class="n">S</span><span class="o">.</span><span class="n">reduced_laplacian</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Let <span class="math notranslate nohighlight">\(L\)</span> be the reduced Laplacian, <span class="math notranslate nohighlight">\(c\)</span> the initial configuration, <span class="math notranslate nohighlight">\(s\)</span> the
returned configuration, and <span class="math notranslate nohighlight">\(f\)</span> the firing vector.  Then <span class="math notranslate nohighlight">\(s = c - f\cdot
L\)</span>.</p>
</div>
<p>—</p>
<p id="fire-script-config"><strong>fire_script(sigma)</strong></p>
<p>Fire the given script.  In other words,  fire each vertex the number of
times indicated by <code class="docutils literal notranslate"><span class="pre">sigma</span></code>.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">sigma</span></code> – SandpileConfig or (list or dict representing a SandpileConfig)</p>
<p>OUTPUT:</p>
<p>SandpileConfig</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">unstable</span><span class="p">()</span>
<span class="go">[2, 3]</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">fire_script</span><span class="p">(</span><span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">{1: 2, 2: 1, 3: 2}</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">fire_script</span><span class="p">(</span><span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span> <span class="o">==</span> <span class="n">c</span><span class="o">.</span><span class="n">fire_vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fire_vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>—</p>
<p id="fire-unstable-config"><strong>fire_unstable()</strong></p>
<p>Fire all unstable vertices.</p>
<p>OUTPUT:</p>
<p>SandpileConfig</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">fire_unstable</span><span class="p">()</span>
<span class="go">{1: 2, 2: 1, 3: 2}</span>
</pre></div>
</div>
<p>—</p>
<p id="fire-vertex-config"><strong>fire_vertex(v)</strong></p>
<p>Fire the given vertex.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">v</span></code> – vertex</p>
<p>OUTPUT:</p>
<p>SandpileConfig</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">fire_vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">{1: 2, 2: 0}</span>
</pre></div>
</div>
<p>—</p>
<p id="help-config"><strong>help(verbose=True)</strong></p>
<p>List of SandpileConfig methods.  If <code class="docutils literal notranslate"><span class="pre">verbose</span></code>, include short descriptions.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) boolean</p>
<p>OUTPUT:</p>
<p>printed string</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">SandpileConfig</span><span class="o">.</span><span class="n">help</span><span class="p">()</span>
<span class="go">Shortcuts for SandpileConfig operations:</span>
<span class="go">~c    -- stabilize</span>
<span class="go">c &amp; d -- add and stabilize</span>
<span class="go">c * c -- add and find equivalent recurrent</span>
<span class="go">c^k   -- add k times and find equivalent recurrent</span>
<span class="go">         (taking inverse if k is negative)</span>

<span class="go">For detailed help with any method FOO listed below,</span>
<span class="go">enter &quot;SandpileConfig.FOO?&quot; or enter &quot;c.FOO?&quot; for any SandpileConfig c.</span>

<span class="go">add_random             -- Add one grain of sand to a random vertex.</span>
<span class="go">burst_size             -- The burst size of the configuration with respect to the given vertex.</span>
<span class="go">deg                    -- The degree of the configuration.</span>
<span class="go">dualize                -- The difference with the maximal stable configuration.</span>
<span class="go">equivalent_recurrent   -- The recurrent configuration equivalent to the given configuration.</span>
<span class="go">equivalent_superstable -- The equivalent superstable configuration.</span>
<span class="go">fire_script            -- Fire the given script.</span>
<span class="go">fire_unstable          -- Fire all unstable vertices.</span>
<span class="go">fire_vertex            -- Fire the given vertex.</span>
<span class="go">help                   -- List of SandpileConfig methods.</span>
<span class="go">is_recurrent           -- Is the configuration recurrent?</span>
<span class="go">is_stable              -- Is the configuration stable?</span>
<span class="go">is_superstable         -- Is the configuration superstable?</span>
<span class="go">is_symmetric           -- Is the configuration symmetric?</span>
<span class="go">order                  -- The order of the equivalent recurrent element.</span>
<span class="go">sandpile               -- The configuration&#39;s underlying sandpile.</span>
<span class="go">show                   -- Show the configuration.</span>
<span class="go">stabilize              -- The stabilized configuration.</span>
<span class="go">support                -- The vertices containing sand.</span>
<span class="go">unstable               -- The unstable vertices.</span>
<span class="go">values                 -- The values of the configuration as a list.</span>
</pre></div>
</div>
<p>—</p>
<p id="is-recurrent-config"><strong>is_recurrent()</strong></p>
<p>Is the configuration recurrent?</p>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Diamond</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span><span class="o">.</span><span class="n">is_recurrent</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">zero_config</span><span class="p">()</span><span class="o">.</span><span class="n">is_recurrent</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>—</p>
<p id="is-stable-config"><strong>is_stable()</strong></p>
<p>Is the configuration stable?</p>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Diamond</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span><span class="o">.</span><span class="n">is_stable</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">())</span><span class="o">.</span><span class="n">is_stable</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">())</span><span class="o">.</span><span class="n">is_stable</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>—</p>
<p id="is-superstable-config"><strong>is_superstable()</strong></p>
<p>Is the configuration superstable?</p>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Diamond</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">zero_config</span><span class="p">()</span><span class="o">.</span><span class="n">is_superstable</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>—</p>
<p id="is-symmetric-config"><strong>is_symmetric(orbits)</strong></p>
<p>Is the configuration symmetric?  Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if the values of the
configuration are constant over the vertices in each sublist of
<code class="docutils literal notranslate"><span class="pre">orbits</span></code>.</p>
<p>INPUT:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">orbits</span></code> – list of lists of vertices</p>
</div></blockquote>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">{},</span>
<span class="gp">....: </span>             <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
<span class="gp">....: </span>             <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
<span class="gp">....: </span>             <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
<span class="gp">....: </span>             <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">}})</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">is_symmetric</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
<span class="go">True</span>
</pre></div>
</div>
<p>—</p>
<p id="order-config"><strong>order()</strong></p>
<p>The order of the equivalent recurrent element.</p>
<p>OUTPUT:</p>
<p>integer</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Diamond</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="o">~</span><span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="n">c</span> <span class="o">+</span> <span class="n">c</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span> <span class="o">==</span> <span class="n">S</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">is_recurrent</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">equivalent_recurrent</span><span class="p">()</span> <span class="o">==</span> <span class="n">S</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>—</p>
<p id="sandpile-config"><strong>sandpile()</strong></p>
<p>The configuration’s underlying sandpile.</p>
<p>OUTPUT:</p>
<p>Sandpile</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Diamond</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">sandpile</span><span class="p">()</span>
<span class="go">Diamond sandpile graph: 4 vertices, sink = 0</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">sandpile</span><span class="p">()</span> <span class="o">==</span> <span class="n">S</span>
<span class="go">True</span>
</pre></div>
</div>
<p>—</p>
<p id="show-config"><strong>show(sink=True, colors=True, heights=False, directed=None, **kwds)</strong></p>
<p>Show the configuration.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sink</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) whether to show the sink</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">colors</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) whether to color-code the amount of sand on each vertex</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">heights</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) whether to label each vertex with the amount of sand</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">directed</span></code> – (optional) whether to draw directed edges</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kwds</span></code> – (optional) arguments passed to the show method for Graph</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Diamond</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">directed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">sink</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">colors</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">heights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>—</p>
<p id="stabilize-config"><strong>stabilize(with_firing_vector=False)</strong></p>
<p>The stabilized configuration. Optionally returns the
corresponding firing vector.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">with_firing_vector</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)  boolean</p>
<p>OUTPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">SandpileConfig</span></code> or <code class="docutils literal notranslate"><span class="pre">[SandpileConfig,</span> <span class="pre">firing_vector]</span></code></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">House</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">_set_stabilize</span><span class="p">()</span>
<span class="gp">sage: </span><span class="s1">&#39;_stabilize&#39;</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="vm">__dict__</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">House</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span> <span class="o">+</span> <span class="n">S</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">stabilize</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[{1: 1, 2: 2, 3: 2, 4: 1}, {1: 2, 2: 2, 3: 3, 4: 3}]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">max_stable</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">S</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span> <span class="o">==</span> <span class="n">c</span><span class="o">.</span><span class="n">stabilize</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="o">~</span><span class="n">c</span> <span class="o">==</span> <span class="n">c</span><span class="o">.</span><span class="n">stabilize</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>—</p>
<p id="support-config"><strong>support()</strong></p>
<p>The vertices containing sand.</p>
<p>OUTPUT:</p>
<p>list - support of the configuration</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Diamond</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">c</span>
<span class="go">{1: 2, 2: 2, 3: 0}</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">support</span><span class="p">()</span>
<span class="go">[1, 2]</span>
</pre></div>
</div>
<p>—</p>
<p id="unstable-config"><strong>unstable()</strong></p>
<p>The unstable vertices.</p>
<p>OUTPUT:</p>
<p>list of vertices</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">unstable</span><span class="p">()</span>
<span class="go">[2, 3]</span>
</pre></div>
</div>
<p>—</p>
<p id="values-config"><strong>values()</strong></p>
<p>The values of the configuration as a list.  The list is sorted in the
order of the vertices.</p>
<p>OUTPUT:</p>
<p>list of integers</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="s1">&#39;c&#39;</span><span class="p">:[</span><span class="s1">&#39;a&#39;</span><span class="p">]},</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">SandpileConfig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">c</span>
<span class="go">{&#39;b&#39;: 1, &#39;c&#39;: 2}</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[1, 2]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">nonsink_vertices</span><span class="p">()</span>
<span class="go">[&#39;b&#39;, &#39;c&#39;]</span>
</pre></div>
</div>
<p>—</p>
</section>
<section id="sandpiledivisor">
<h4>SandpileDivisor<a class="headerlink" href="#sandpiledivisor" title="Permalink to this heading">#</a></h4>
<p><strong>Summary of methods.</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="#divisor"><span class="std std-ref">+</span></a> — Addition of divisors.</p></li>
<li><p><a class="reference internal" href="#greater-equal-divisor"><span class="std std-ref">greater-equal</span></a> — <code class="docutils literal notranslate"><span class="pre">True</span></code> if every component of <code class="docutils literal notranslate"><span class="pre">self</span></code> is at least that of <code class="docutils literal notranslate"><span class="pre">other</span></code>.</p></li>
<li><p><a class="reference internal" href="#greater-divisor"><span class="std std-ref">greater</span></a> — <code class="docutils literal notranslate"><span class="pre">True</span></code> if every component of <code class="docutils literal notranslate"><span class="pre">self</span></code> is at least that of <code class="docutils literal notranslate"><span class="pre">other</span></code> and the two divisors are not equal.</p></li>
<li><p><a class="reference internal" href="#less-equal-divisor"><span class="std std-ref">less-equal</span></a> — <code class="docutils literal notranslate"><span class="pre">True</span></code> if every component of <code class="docutils literal notranslate"><span class="pre">self</span></code> is at most that of <code class="docutils literal notranslate"><span class="pre">other</span></code>.</p></li>
<li><p><a class="reference internal" href="#less-divisor"><span class="std std-ref">less</span></a> — <code class="docutils literal notranslate"><span class="pre">True</span></code> if every component of <code class="docutils literal notranslate"><span class="pre">self</span></code> is at most that of <code class="docutils literal notranslate"><span class="pre">other</span></code> and the two divisors are not equal.</p></li>
<li><p><a class="reference internal" href="#neg-divisor"><span class="std std-ref">-</span></a> — The additive inverse of the divisor.</p></li>
<li><p><a class="reference internal" href="#sub-divisor"><span class="std std-ref">-</span></a> — Subtraction of divisors.</p></li>
<li><p><a class="reference internal" href="#dcomplex-divisor"><span class="std std-ref">Dcomplex</span></a> — The support-complex.</p></li>
<li><p><a class="reference internal" href="#add-random-divisor"><span class="std std-ref">add_random</span></a> — Add one grain of sand to a random vertex.</p></li>
<li><p><a class="reference internal" href="#betti-divisor"><span class="std std-ref">betti</span></a> — The Betti numbers for the support-complex.</p></li>
<li><p><a class="reference internal" href="#deg-divisor"><span class="std std-ref">deg</span></a> — The degree of the divisor.</p></li>
<li><p><a class="reference internal" href="#dualize-divisor"><span class="std std-ref">dualize</span></a> — The difference with the maximal stable divisor.</p></li>
<li><p><a class="reference internal" href="#effective-div-divisor"><span class="std std-ref">effective_div</span></a> — All linearly equivalent effective divisors.</p></li>
<li><p><a class="reference internal" href="#fire-script-divisor"><span class="std std-ref">fire_script</span></a> — Fire the given script.</p></li>
<li><p><a class="reference internal" href="#fire-unstable-divisor"><span class="std std-ref">fire_unstable</span></a> — Fire all unstable vertices.</p></li>
<li><p><a class="reference internal" href="#fire-vertex-divisor"><span class="std std-ref">fire_vertex</span></a> — Fire the given vertex.</p></li>
<li><p><a class="reference internal" href="#help-divisor"><span class="std std-ref">help</span></a> — List of SandpileDivisor methods.</p></li>
<li><p><a class="reference internal" href="#is-alive-divisor"><span class="std std-ref">is_alive</span></a> — Is the divisor stabilizable?</p></li>
<li><p><a class="reference internal" href="#is-linearly-equivalent-divisor"><span class="std std-ref">is_linearly_equivalent</span></a> — Is the given divisor linearly equivalent?</p></li>
<li><p><a class="reference internal" href="#is-q-reduced-divisor"><span class="std std-ref">is_q_reduced</span></a> — Is the divisor q-reduced?</p></li>
<li><p><a class="reference internal" href="#is-symmetric-divisor"><span class="std std-ref">is_symmetric</span></a> — Is the divisor symmetric?</p></li>
<li><p><a class="reference internal" href="#is-weierstrass-pt-divisor"><span class="std std-ref">is_weierstrass_pt</span></a> — Is the given vertex a Weierstrass point?</p></li>
<li><p><a class="reference internal" href="#polytope-divisor"><span class="std std-ref">polytope</span></a> — The polytope determining the complete linear system.</p></li>
<li><p><a class="reference internal" href="#polytope-integer-pts-divisor"><span class="std std-ref">polytope_integer_pts</span></a> — The integer points inside divisor’s polytope.</p></li>
<li><p><a class="reference internal" href="#q-reduced-divisor"><span class="std std-ref">q_reduced</span></a> — The linearly equivalent q-reduced divisor.</p></li>
<li><p><a class="reference internal" href="#rank-divisor"><span class="std std-ref">rank</span></a> — The rank of the divisor.</p></li>
<li><p><a class="reference internal" href="#sandpile-divisor"><span class="std std-ref">sandpile</span></a> — The divisor’s underlying sandpile.</p></li>
<li><p><a class="reference internal" href="#show-divisor"><span class="std std-ref">show</span></a> — Show the divisor.</p></li>
<li><p><a class="reference internal" href="#simulate-threshold-divisor"><span class="std std-ref">simulate_threshold</span></a> — The first unstabilizable divisor in the closed Markov chain.</p></li>
<li><p><a class="reference internal" href="#stabilize-divisor"><span class="std std-ref">stabilize</span></a> — The stabilization of the divisor.</p></li>
<li><p><a class="reference internal" href="#support-divisor"><span class="std std-ref">support</span></a> — List of vertices at which the divisor is nonzero.</p></li>
<li><p><a class="reference internal" href="#unstable-divisor"><span class="std std-ref">unstable</span></a> — The unstable vertices.</p></li>
<li><p><a class="reference internal" href="#values-divisor"><span class="std std-ref">values</span></a> — The values of the divisor as a list.</p></li>
<li><p><a class="reference internal" href="#weierstrass-div-divisor"><span class="std std-ref">weierstrass_div</span></a> — The Weierstrass divisor.</p></li>
<li><p><a class="reference internal" href="#weierstrass-gap-seq-divisor"><span class="std std-ref">weierstrass_gap_seq</span></a> — The Weierstrass gap sequence at the given vertex.</p></li>
<li><p><a class="reference internal" href="#weierstrass-pts-divisor"><span class="std std-ref">weierstrass_pts</span></a> — The Weierstrass points (vertices).</p></li>
<li><p><a class="reference internal" href="#weierstrass-rank-seq-divisor"><span class="std std-ref">weierstrass_rank_seq</span></a> — The Weierstrass rank sequence at the given vertex.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Complete descriptions of SandpileDivisor methods.</strong></p>
<p>—</p>
<p id="divisor"><strong>+</strong></p>
<blockquote>
<div><p>Addition of divisors.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">other</span></code> – SandpileDivisor</p>
<p>OUTPUT:</p>
<p>sum of <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">other</span></code></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">+</span> <span class="n">E</span>
<span class="go">{0: 4, 1: 4, 2: 4}</span>
</pre></div>
</div>
</div></blockquote>
<p>—</p>
<p id="greater-equal-divisor"><strong>&gt;=</strong></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if every component of <code class="docutils literal notranslate"><span class="pre">self</span></code> is at least that of
<code class="docutils literal notranslate"><span class="pre">other</span></code>.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">other</span></code> – SandpileDivisor</p>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">&gt;=</span> <span class="n">D</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">&gt;=</span> <span class="n">D</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">&gt;=</span> <span class="n">E</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">&gt;=</span> <span class="n">D</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">&gt;=</span> <span class="n">F</span>
<span class="go">False</span>
</pre></div>
</div>
</div></blockquote>
<p>—</p>
<p id="greater-divisor"><strong>&gt;</strong></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if every component of <code class="docutils literal notranslate"><span class="pre">self</span></code> is at least that of
<code class="docutils literal notranslate"><span class="pre">other</span></code> and the two divisors are not equal.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">other</span></code> – SandpileDivisor</p>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">&gt;</span> <span class="n">D</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">&gt;</span> <span class="n">D</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">&gt;</span> <span class="n">E</span>
<span class="go">False</span>
</pre></div>
</div>
</div></blockquote>
<p>—</p>
<p id="less-equal-divisor"><strong>&lt;=</strong></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if every component of <code class="docutils literal notranslate"><span class="pre">self</span></code> is at most that of
<code class="docutils literal notranslate"><span class="pre">other</span></code>.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">other</span></code> – SandpileDivisor</p>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">&lt;=</span> <span class="n">D</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">&lt;=</span> <span class="n">E</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">&lt;=</span> <span class="n">D</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">&lt;=</span> <span class="n">F</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">&lt;=</span> <span class="n">D</span>
<span class="go">False</span>
</pre></div>
</div>
</div></blockquote>
<p>—</p>
<p id="less-divisor"><strong>&lt;</strong></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if every component of <code class="docutils literal notranslate"><span class="pre">self</span></code> is at most that of
<code class="docutils literal notranslate"><span class="pre">other</span></code> and the two divisors are not equal.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">other</span></code> – SandpileDivisor</p>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">&lt;</span> <span class="n">D</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">&lt;</span> <span class="n">E</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">&lt;</span> <span class="n">D</span>
<span class="go">False</span>
</pre></div>
</div>
</div></blockquote>
<p>—</p>
<p id="neg-divisor"><strong>-</strong></p>
<blockquote>
<div><p>The additive inverse of the divisor.</p>
<p>OUTPUT:</p>
<p>SandpileDivisor</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="o">-</span><span class="n">D</span>
<span class="go">{0: -1, 1: -2, 2: -3}</span>
</pre></div>
</div>
</div></blockquote>
<p>—</p>
<p id="sub-divisor"><strong>-</strong></p>
<blockquote>
<div><p>Subtraction of divisors.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">other</span></code> – SandpileDivisor</p>
<p>OUTPUT:</p>
<p>Difference of <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">other</span></code></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">-</span> <span class="n">E</span>
<span class="go">{0: -2, 1: 0, 2: 2}</span>
</pre></div>
</div>
</div></blockquote>
<p>—</p>
<p id="dcomplex-divisor"><strong>Dcomplex()</strong></p>
<p>The support-complex. (See NOTE.)</p>
<p>OUTPUT:</p>
<p>simplicial complex</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">House</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">Dcomplex</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">homology</span><span class="p">()</span>
<span class="go">{0: 0, 1: Z x Z, 2: 0}</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">f_vector</span><span class="p">()</span>
<span class="go">[1, 5, 10, 4]</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">betti</span><span class="p">()</span>
<span class="go">{0: 1, 1: 2, 2: 0}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The “support-complex” is the simplicial complex determined by the
supports of the linearly equivalent effective divisors.</p>
</div>
<p>—</p>
<p id="add-random-divisor"><strong>add_random(distrib=None)</strong></p>
<p>Add one grain of sand to a random vertex.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">distrib</span></code> – (optional) list of nonnegative numbers representing a probability distribution on the vertices</p>
<p>OUTPUT:</p>
<p>SandpileDivisor</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">zero_div</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_random</span><span class="p">()</span> <span class="c1"># random</span>
<span class="go">{0: 0, 1: 0, 2: 1, 3: 0}</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_random</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.7</span><span class="p">])</span> <span class="c1"># random</span>
<span class="go">{0: 0, 1: 0, 2: 0, 3: 1}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If <code class="docutils literal notranslate"><span class="pre">distrib</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, the user is responsible for assuring the sum of its entries is 1.</p>
</div>
<p>—</p>
<p id="betti-divisor"><strong>betti()</strong></p>
<p>The Betti numbers for the support-complex.  (See NOTE.)</p>
<p>OUTPUT:</p>
<p>dictionary of integers</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">betti</span><span class="p">()</span>
<span class="go">{0: 1, 1: 1}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The “support-complex” is the simplicial complex determined by the
supports of the linearly equivalent effective divisors.</p>
</div>
<p>—</p>
<p id="deg-divisor"><strong>deg()</strong></p>
<p>The degree of the divisor.</p>
<p>OUTPUT:</p>
<p>integer</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">deg</span><span class="p">()</span>
<span class="go">6</span>
</pre></div>
</div>
<p>—</p>
<p id="dualize-divisor"><strong>dualize()</strong></p>
<p>The difference with the maximal stable divisor.</p>
<p>OUTPUT:</p>
<p>SandpileDivisor</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">dualize</span><span class="p">()</span>
<span class="go">{0: 0, 1: -1, 2: -2}</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">max_stable_div</span><span class="p">()</span> <span class="o">-</span> <span class="n">D</span> <span class="o">==</span> <span class="n">D</span><span class="o">.</span><span class="n">dualize</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>—</p>
<p id="effective-div-divisor"><strong>effective_div(verbose=True, with_firing_vectors=False)</strong></p>
<p>All linearly equivalent effective divisors.  If <code class="docutils literal notranslate"><span class="pre">verbose</span></code>
is <code class="docutils literal notranslate"><span class="pre">False</span></code>, the divisors are converted to lists of integers.
If <code class="docutils literal notranslate"><span class="pre">with_firing_vectors</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code> then a list of firing vectors
is also given, each of which prescribes the vertices to be fired
in order to obtain an effective divisor.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) boolean</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">with_firing_vectors</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) boolean</p></li>
</ul>
<p>OUTPUT:</p>
<p>list (of divisors)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">s</span><span class="p">,[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">effective_div</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<span class="go">[{0: 0, 1: 2, 2: 0, 3: 4},</span>
<span class="go"> {0: 0, 1: 2, 2: 4, 3: 0},</span>
<span class="go"> {0: 0, 1: 6, 2: 0, 3: 0},</span>
<span class="go"> {0: 1, 1: 3, 2: 1, 3: 1},</span>
<span class="go"> {0: 2, 1: 0, 2: 2, 3: 2},</span>
<span class="go"> {0: 4, 1: 2, 2: 0, 3: 0}]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">effective_div</span><span class="p">(</span><span class="kc">False</span><span class="p">))</span>
<span class="go">[[0, 2, 0, 4],</span>
<span class="go"> [0, 2, 4, 0],</span>
<span class="go"> [0, 6, 0, 0],</span>
<span class="go"> [1, 3, 1, 1],</span>
<span class="go"> [2, 0, 2, 2],</span>
<span class="go"> [4, 2, 0, 0]]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">effective_div</span><span class="p">(</span><span class="n">with_firing_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<span class="go">[({0: 0, 1: 2, 2: 0, 3: 4}, (0, -1, -1, -2)),</span>
<span class="go"> ({0: 0, 1: 2, 2: 4, 3: 0}, (0, -1, -2, -1)),</span>
<span class="go"> ({0: 0, 1: 6, 2: 0, 3: 0}, (0, -2, -1, -1)),</span>
<span class="go"> ({0: 1, 1: 3, 2: 1, 3: 1}, (0, -1, -1, -1)),</span>
<span class="go"> ({0: 2, 1: 0, 2: 2, 3: 2}, (0, 0, -1, -1)),</span>
<span class="go"> ({0: 4, 1: 2, 2: 0, 3: 0}, (0, 0, 0, 0))]</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[0, 6, 0, 0]</span>
<span class="gp">sage: </span><span class="n">vector</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">-</span> <span class="n">s</span><span class="o">.</span><span class="n">laplacian</span><span class="p">()</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">(0, 6, 0, 0)</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">effective_div</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>
<span class="go">[([0, 2, 0, 4], (0, -1, -1, -2)),</span>
<span class="go"> ([0, 2, 4, 0], (0, -1, -2, -1)),</span>
<span class="go"> ([0, 6, 0, 0], (0, -2, -1, -1)),</span>
<span class="go"> ([1, 3, 1, 1], (0, -1, -1, -1)),</span>
<span class="go"> ([2, 0, 2, 2], (0, 0, -1, -1)),</span>
<span class="go"> ([4, 2, 0, 0], (0, 0, 0, 0))]</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">s</span><span class="p">,[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">effective_div</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>—</p>
<p id="fire-script-divisor"><strong>fire_script(sigma)</strong></p>
<p>Fire the given script.  In other words, fire each vertex the number of
times indicated by <code class="docutils literal notranslate"><span class="pre">sigma</span></code>.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">sigma</span></code> – SandpileDivisor or (list or dict representing a SandpileDivisor)</p>
<p>OUTPUT:</p>
<p>SandpileDivisor</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">unstable</span><span class="p">()</span>
<span class="go">[1, 2]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">fire_script</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">{0: 3, 1: 1, 2: 2}</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">fire_script</span><span class="p">(</span><span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span> <span class="o">==</span> <span class="n">D</span><span class="o">.</span><span class="n">fire_vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">fire_vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>—</p>
<p id="fire-unstable-divisor"><strong>fire_unstable()</strong></p>
<p>Fire all unstable vertices.</p>
<p>OUTPUT:</p>
<p>SandpileDivisor</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">fire_unstable</span><span class="p">()</span>
<span class="go">{0: 3, 1: 1, 2: 2}</span>
</pre></div>
</div>
<p>—</p>
<p id="fire-vertex-divisor"><strong>fire_vertex(v)</strong></p>
<p>Fire the given vertex.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">v</span></code> – vertex</p>
<p>OUTPUT:</p>
<p>SandpileDivisor</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">fire_vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">{0: 2, 1: 0, 2: 4}</span>
</pre></div>
</div>
<p>—</p>
<p id="help-divisor"><strong>help(verbose=True)</strong></p>
<p>List of SandpileDivisor methods.  If <code class="docutils literal notranslate"><span class="pre">verbose</span></code>, include short descriptions.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) boolean</p>
<p>OUTPUT:</p>
<p>printed string</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">SandpileDivisor</span><span class="o">.</span><span class="n">help</span><span class="p">()</span>
<span class="go">For detailed help with any method FOO listed below,</span>
<span class="go">enter &quot;SandpileDivisor.FOO?&quot; or enter &quot;D.FOO?&quot; for any SandpileDivisor D.</span>

<span class="go">Dcomplex               -- The support-complex.</span>
<span class="go">add_random             -- Add one grain of sand to a random vertex.</span>
<span class="go">betti                  -- The Betti numbers for the support-complex.</span>
<span class="go">deg                    -- The degree of the divisor.</span>
<span class="go">dualize                -- The difference with the maximal stable divisor.</span>
<span class="go">effective_div          -- All linearly equivalent effective divisors.</span>
<span class="go">fire_script            -- Fire the given script.</span>
<span class="go">fire_unstable          -- Fire all unstable vertices.</span>
<span class="go">fire_vertex            -- Fire the given vertex.</span>
<span class="go">help                   -- List of SandpileDivisor methods.</span>
<span class="go">is_alive               -- Is the divisor stabilizable?</span>
<span class="go">is_linearly_equivalent -- Is the given divisor linearly equivalent?</span>
<span class="go">is_q_reduced           -- Is the divisor q-reduced?</span>
<span class="go">is_symmetric           -- Is the divisor symmetric?</span>
<span class="go">is_weierstrass_pt      -- Is the given vertex a Weierstrass point?</span>
<span class="go">polytope               -- The polytope determining the complete linear system.</span>
<span class="go">polytope_integer_pts   -- The integer points inside divisor&#39;s polytope.</span>
<span class="go">q_reduced              -- The linearly equivalent q-reduced divisor.</span>
<span class="go">rank                   -- The rank of the divisor.</span>
<span class="go">sandpile               -- The divisor&#39;s underlying sandpile.</span>
<span class="go">show                   -- Show the divisor.</span>
<span class="go">simulate_threshold     -- The first unstabilizable divisor in the closed Markov chain.</span>
<span class="go">stabilize              -- The stabilization of the divisor.</span>
<span class="go">support                -- List of vertices at which the divisor is nonzero.</span>
<span class="go">unstable               -- The unstable vertices.</span>
<span class="go">values                 -- The values of the divisor as a list.</span>
<span class="go">weierstrass_div        -- The Weierstrass divisor.</span>
<span class="go">weierstrass_gap_seq    -- The Weierstrass gap sequence at the given vertex.</span>
<span class="go">weierstrass_pts        -- The Weierstrass points (vertices).</span>
<span class="go">weierstrass_rank_seq   -- The Weierstrass rank sequence at the given vertex.</span>
</pre></div>
</div>
<p>—</p>
<p id="is-alive-divisor"><strong>is_alive(cycle=False)</strong></p>
<p>Is the divisor stabilizable?  In other words, will the divisor stabilize
under repeated firings of all unstable vertices?  Optionally returns the
resulting cycle.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">cycle</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) boolean</p>
<p>OUTPUT:</p>
<p>boolean or optionally, a list of SandpileDivisors</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_alive</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_alive</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[{0: 4, 1: 3, 2: 3, 3: 2}, {0: 3, 1: 2, 2: 2, 3: 5}, {0: 1, 1: 4, 2: 4, 3: 3}]</span>
</pre></div>
</div>
<p>—</p>
<p id="is-linearly-equivalent-divisor"><strong>is_linearly_equivalent(D, with_firing_vector=False)</strong></p>
<p>Is the given divisor linearly equivalent?  Optionally, returns the
firing vector.  (See NOTE.)</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">D</span></code> – SandpileDivisor or list, tuple, etc. representing a divisor</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">with_firing_vector</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) boolean</p></li>
</ul>
<p>OUTPUT:</p>
<p>boolean or integer vector</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">s</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_linearly_equivalent</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_linearly_equivalent</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(0, -1, -1)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">is_linearly_equivalent</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="kc">True</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">vector</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">-</span> <span class="n">s</span><span class="o">.</span><span class="n">laplacian</span><span class="p">()</span><span class="o">*</span><span class="n">v</span>
<span class="go">(0, 1, 1)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_linearly_equivalent</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_linearly_equivalent</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="kc">True</span><span class="p">)</span>
<span class="go">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">with_firing_vector</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, returns either <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">with_firing_vector</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code> then: (i) if <code class="docutils literal notranslate"><span class="pre">self</span></code> is linearly
equivalent to <span class="math notranslate nohighlight">\(D\)</span>, returns a vector <span class="math notranslate nohighlight">\(v\)</span> such that <code class="docutils literal notranslate"><span class="pre">self</span> <span class="pre">-</span> <span class="pre">v*self.laplacian().transpose()</span> <span class="pre">=</span> <span class="pre">D</span></code>.
Otherwise, (ii) if <code class="docutils literal notranslate"><span class="pre">self</span></code> is not linearly equivalent to <span class="math notranslate nohighlight">\(D\)</span>, the output is the empty vector, <code class="docutils literal notranslate"><span class="pre">()</span></code>.</p></li>
</ul>
</div>
<p>—</p>
<p id="is-q-reduced-divisor"><strong>is_q_reduced()</strong></p>
<p>Is the divisor <span class="math notranslate nohighlight">\(q\)</span>-reduced?  This would mean that <span class="math notranslate nohighlight">\(self = c + kq\)</span> where
<span class="math notranslate nohighlight">\(c\)</span> is superstable, <span class="math notranslate nohighlight">\(k\)</span> is an integer, and <span class="math notranslate nohighlight">\(q\)</span> is the sink vertex.</p>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">s</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_q_reduced</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">s</span><span class="p">,[</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">is_q_reduced</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>For undirected or, more generally, Eulerian graphs, <span class="math notranslate nohighlight">\(q\)</span>-reduced divisors are
linearly equivalent if and only if they are equal.  The same does not hold for
general directed graphs:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">s</span><span class="p">,[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Z</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">zero_div</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_q_reduced</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Z</span><span class="o">.</span><span class="n">is_q_reduced</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">==</span> <span class="n">Z</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_linearly_equivalent</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>—</p>
<p id="is-symmetric-divisor"><strong>is_symmetric(orbits)</strong></p>
<p>Is the divisor symmetric?  Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if the values of the
configuration are constant over the vertices in each sublist of
<code class="docutils literal notranslate"><span class="pre">orbits</span></code>.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">orbits</span></code> – list of lists of vertices</p>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">House</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span>
<span class="go">{0: {1: 1, 2: 1},</span>
<span class="go"> 1: {0: 1, 3: 1},</span>
<span class="go"> 2: {0: 1, 3: 1, 4: 1},</span>
<span class="go"> 3: {1: 1, 2: 1, 4: 1},</span>
<span class="go"> 4: {2: 1, 3: 1}}</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_symmetric</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">]])</span>
<span class="go">True</span>
</pre></div>
</div>
<p>—</p>
<p id="is-weierstrass-pt-divisor"><strong>is_weierstrass_pt(v=’sink’)</strong></p>
<p>Is the given vertex a Weierstrass point?</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">v</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">sink</span></code>) vertex</p>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">House</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">canonical_divisor</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">weierstrass_rank_seq</span><span class="p">()</span>  <span class="c1"># sequence at the sink vertex, 0</span>
<span class="go">(1, 0, -1)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">is_weierstrass_pt</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">weierstrass_rank_seq</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">(1, 0, 0, -1)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">is_weierstrass_pt</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The vertex <span class="math notranslate nohighlight">\(v\)</span> is a (generalized) Weierstrass point for divisor <span class="math notranslate nohighlight">\(D\)</span> if the
sequence of ranks <span class="math notranslate nohighlight">\(r(D - nv)\)</span>
for <span class="math notranslate nohighlight">\(n = 0, 1, 2, \dots\)</span> is not <span class="math notranslate nohighlight">\(r(D), r(D)-1, \dots, 0, -1, -1, \dots\)</span>.</p>
</div>
<p>—</p>
<p id="polytope-divisor"><strong>polytope()</strong></p>
<p>The polytope determining the complete linear system.</p>
<p>OUTPUT:</p>
<p>polytope</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">s</span><span class="p">,[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">polytope</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">inequalities</span><span class="p">()</span>
<span class="go">(An inequality (-3, 1, 1) x + 2 &gt;= 0,</span>
<span class="go"> An inequality (1, 1, 1) x + 4 &gt;= 0,</span>
<span class="go"> An inequality (1, -3, 1) x + 0 &gt;= 0,</span>
<span class="go"> An inequality (1, 1, -3) x + 0 &gt;= 0)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">s</span><span class="p">,[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">polytope</span><span class="p">()</span>
<span class="go">The empty polyhedron in QQ^3</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For a divisor <span class="math notranslate nohighlight">\(D\)</span>, this is the intersection of (i) the polyhedron
determined by the system of inequalities <span class="math notranslate nohighlight">\(L^t x \leq D\)</span> where <span class="math notranslate nohighlight">\(L^t\)</span>
is the transpose of the Laplacian with (ii) the hyperplane
<span class="math notranslate nohighlight">\(x_{\mathrm{sink\_vertex}} = 0\)</span>. The polytope is thought of as sitting in
<span class="math notranslate nohighlight">\((n-1)\)</span>-dimensional Euclidean space where <span class="math notranslate nohighlight">\(n\)</span> is the number of
vertices.</p>
</div>
<p>—</p>
<p id="polytope-integer-pts-divisor"><strong>polytope_integer_pts()</strong></p>
<p>The integer points inside divisor’s polytope.  The polytope referred to
here is the one determining the divisor’s complete linear system (see the
documentation for <code class="docutils literal notranslate"><span class="pre">polytope</span></code>).</p>
<p>OUTPUT:</p>
<p>tuple of integer vectors</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">s</span><span class="p">,[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">polytope_integer_pts</span><span class="p">())</span>
<span class="go">[(-2, -1, -1),</span>
<span class="go"> (-1, -2, -1),</span>
<span class="go"> (-1, -1, -2),</span>
<span class="go"> (-1, -1, -1),</span>
<span class="go"> (0, -1, -1),</span>
<span class="go"> (0, 0, 0)]</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">s</span><span class="p">,[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">polytope_integer_pts</span><span class="p">()</span>
<span class="go">()</span>
</pre></div>
</div>
<p>—</p>
<p id="q-reduced-divisor"><strong>q_reduced(verbose=True)</strong></p>
<p>The linearly equivalent <span class="math notranslate nohighlight">\(q\)</span>-reduced divisor.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) boolean</p>
<p>OUTPUT:</p>
<p>SandpileDivisor or list representing SandpileDivisor</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">s</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">q_reduced</span><span class="p">()</span>
<span class="go">{0: -2, 1: 1, 2: 2, 3: 0}</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">q_reduced</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[-2, 1, 2, 0]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The divisor <span class="math notranslate nohighlight">\(D\)</span> is <span class="math notranslate nohighlight">\(qreduced if `D = c + kq\)</span> where <span class="math notranslate nohighlight">\(c\)</span>
is superstable, <span class="math notranslate nohighlight">\(k\)</span> is an integer, and <span class="math notranslate nohighlight">\(q\)</span> is the sink.</p>
</div>
<p>—</p>
<p id="rank-divisor"><strong>rank(with_witness=False)</strong></p>
<p>The rank of the divisor.  Optionally returns an effective divisor <span class="math notranslate nohighlight">\(E\)</span> such
that <span class="math notranslate nohighlight">\(D - E\)</span> is not winnable (has an empty complete linear system).</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">with_witness</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) boolean</p>
<p>OUTPUT:</p>
<p>integer or (integer, SandpileDivisor)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">   sage: S = sandpiles.Complete(4)</span>
<span class="go">   sage: D = SandpileDivisor(S,[4,2,0,0])</span>
<span class="go">   sage: D.rank()</span>
<span class="go">   3</span>
<span class="go">   sage: D.rank(True)</span>
<span class="go">   (3, {0: 3, 1: 0, 2: 1, 3: 0})</span>
<span class="go">   sage: E = _[1]</span>
<span class="go">   sage: (D - E).rank()</span>
<span class="go">   -1</span>

<span class="go">Riemann-Roch theorem::</span>

<span class="go">   sage: D.rank() - (S.canonical_divisor()-D).rank() == D.deg() + 1 - S.genus()</span>
<span class="go">   True</span>

<span class="go">Riemann-Roch theorem::</span>

<span class="go">   sage: D.rank() - (S.canonical_divisor()-D).rank() == D.deg() + 1 - S.genus()</span>
<span class="go">   True</span>
<span class="go">   sage: S = Sandpile({0:[1,1,1,2],1:[0,0,0,1,1,1,2,2],2:[2,2,1,1,0]},0) # multigraph with loops</span>
<span class="go">   sage: D = SandpileDivisor(S,[4,2,0])</span>
<span class="go">   sage: D.rank(True)</span>
<span class="go">   (2, {0: 1, 1: 1, 2: 1})</span>
<span class="go">   sage: S = Sandpile({0:[1,2], 1:[0,2,2], 2: [0,1]},0) # directed graph</span>
<span class="go">   sage: S.is_undirected()</span>
<span class="go">   False</span>
<span class="go">   sage: D = SandpileDivisor(S,[0,2,0])</span>
<span class="go">   sage: D.effective_div()</span>
<span class="go">   [{0: 0, 1: 2, 2: 0}, {0: 2, 1: 0, 2: 0}]</span>
<span class="go">   sage: D.rank(True)</span>
<span class="go">   (0, {0: 0, 1: 0, 2: 1})</span>
<span class="go">   sage: E = D.rank(True)[1]</span>
<span class="go">   sage: (D - E).effective_div()</span>
<span class="go">   []</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The rank of a divisor <span class="math notranslate nohighlight">\(D\)</span> is -1 if <span class="math notranslate nohighlight">\(D\)</span> is not linearly equivalent to an effective divisor
(i.e., the dollar game represented by <span class="math notranslate nohighlight">\(D\)</span> is unwinnable).  Otherwise, the rank of <span class="math notranslate nohighlight">\(D\)</span> is
the largest integer <span class="math notranslate nohighlight">\(r\)</span> such that <span class="math notranslate nohighlight">\(D - E\)</span> is linearly equivalent to an effective divisor
for all effective divisors <span class="math notranslate nohighlight">\(E\)</span> with <span class="math notranslate nohighlight">\(\deg(E) = r\)</span>.</p>
</div>
<p>—</p>
<p id="sandpile-divisor"><strong>sandpile()</strong></p>
<p>The divisor’s underlying sandpile.</p>
<p>OUTPUT:</p>
<p>Sandpile</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Diamond</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">sandpile</span><span class="p">()</span>
<span class="go">Diamond sandpile graph: 4 vertices, sink = 0</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">sandpile</span><span class="p">()</span> <span class="o">==</span> <span class="n">S</span>
<span class="go">True</span>
</pre></div>
</div>
<p>—</p>
<p id="show-divisor"><strong>show(heights=True, directed=None, **kwds)</strong></p>
<p>Show the divisor.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">heights</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) whether to label each vertex with the amount of sand</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">directed</span></code> – (optional) whether to draw directed edges</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kwds</span></code> – (optional) arguments passed to the show method for Graph</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Diamond</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">graph_border</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">vertex_size</span><span class="o">=</span><span class="mi">700</span><span class="p">,</span><span class="n">directed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>—</p>
<p id="simulate-threshold-divisor"><strong>simulate_threshold(distrib=None)</strong></p>
<p>The first unstabilizable divisor in the closed Markov chain.
(See NOTE.)</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">distrib</span></code> – (optional)  list of nonnegative numbers representing a probability distribution on the vertices</p>
<p>OUTPUT:</p>
<p>SandpileDivisor</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">zero_div</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">simulate_threshold</span><span class="p">()</span>  <span class="c1"># random</span>
<span class="go">{0: 2, 1: 3, 2: 1, 3: 2}</span>
<span class="gp">sage: </span><span class="n">n</span><span class="p">(</span><span class="n">mean</span><span class="p">([</span><span class="n">D</span><span class="o">.</span><span class="n">simulate_threshold</span><span class="p">()</span><span class="o">.</span><span class="n">deg</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]))</span>  <span class="c1"># random</span>
<span class="go">7.10000000000000</span>
<span class="gp">sage: </span><span class="n">n</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">stationary_density</span><span class="p">()</span><span class="o">*</span><span class="n">s</span><span class="o">.</span><span class="n">num_verts</span><span class="p">())</span>
<span class="go">6.93750000000000</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Starting at <code class="docutils literal notranslate"><span class="pre">self</span></code>, repeatedly choose a vertex and add a grain of
sand to it.  Return the first unstabilizable divisor that is
reached.  Also see the <code class="docutils literal notranslate"><span class="pre">markov_chain</span></code> method for the underlying
sandpile.</p>
</div>
<p>—</p>
<p id="stabilize-divisor"><strong>stabilize(with_firing_vector=False)</strong></p>
<p>The stabilization of the divisor.  If not stabilizable, return an error.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">with_firing_vector</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">s</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">stabilize</span><span class="p">()</span>
<span class="go">{0: 1, 1: 0, 2: 1, 3: 1}</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">stabilize</span><span class="p">(</span><span class="n">with_firing_vector</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[{0: 1, 1: 0, 2: 1, 3: 1}, {0: 0, 1: 1, 2: 0, 3: 0}]</span>
</pre></div>
</div>
<p>—</p>
<p id="support-divisor"><strong>support()</strong></p>
<p>List of vertices at which the divisor is nonzero.</p>
<p>OUTPUT:</p>
<p>list representing the support of the divisor</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">support</span><span class="p">()</span>
<span class="go">[2, 3]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">vertices</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[0, 1, 2, 3]</span>
</pre></div>
</div>
<p>—</p>
<p id="unstable-divisor"><strong>unstable()</strong></p>
<p>The unstable vertices.</p>
<p>OUTPUT:</p>
<p>list of vertices</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">unstable</span><span class="p">()</span>
<span class="go">[1, 2]</span>
</pre></div>
</div>
<p>—</p>
<p id="values-divisor"><strong>values()</strong></p>
<p>The values of the divisor as a list.  The list is sorted in the order of
the vertices.</p>
<p>OUTPUT:</p>
<p>list of integers</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="s1">&#39;c&#39;</span><span class="p">:[</span><span class="s1">&#39;a&#39;</span><span class="p">]},</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">D</span>
<span class="go">{&#39;a&#39;: 0, &#39;b&#39;: 1, &#39;c&#39;: 2}</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[0, 1, 2]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">vertices</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]</span>
</pre></div>
</div>
<p>—</p>
<p id="weierstrass-div-divisor"><strong>weierstrass_div(verbose=True)</strong></p>
<p>The Weierstrass divisor.  Its value at a vertex is the weight of that
vertex as a Weierstrass point.  (See
<code class="docutils literal notranslate"><span class="pre">SandpileDivisor.weierstrass_gap_seq</span></code>.)</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) boolean</p>
<p>OUTPUT:</p>
<p>SandpileDivisor</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Diamond</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">s</span><span class="p">,[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">D</span><span class="o">.</span><span class="n">weierstrass_rank_seq</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">s</span><span class="p">]</span>
<span class="go">[(5, 4, 3, 2, 1, 0, 0, -1),</span>
<span class="go"> (5, 4, 3, 2, 1, 0, -1),</span>
<span class="go"> (5, 4, 3, 2, 1, 0, 0, 0, -1),</span>
<span class="go"> (5, 4, 3, 2, 1, 0, 0, -1)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">weierstrass_div</span><span class="p">()</span>
<span class="go">{0: 1, 1: 0, 2: 2, 3: 1}</span>
<span class="gp">sage: </span><span class="n">k5</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">k5</span><span class="o">.</span><span class="n">canonical_divisor</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">weierstrass_div</span><span class="p">()</span>
<span class="go">{0: 9, 1: 9, 2: 9, 3: 9, 4: 9}</span>
</pre></div>
</div>
<p>—</p>
<p id="weierstrass-gap-seq-divisor"><strong>weierstrass_gap_seq(v=’sink’, weight=True)</strong></p>
<p>The Weierstrass gap sequence at the given vertex.  If <code class="docutils literal notranslate"><span class="pre">weight</span></code> is
<code class="docutils literal notranslate"><span class="pre">True</span></code>, then also compute the weight of each gap value.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">sink</span></code>) vertex</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weight</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) boolean</p></li>
</ul>
<p>OUTPUT:</p>
<p>list or (list of list) of integers</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">s</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">D</span><span class="o">.</span><span class="n">weierstrass_gap_seq</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">vertices</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
<span class="go">[(1, 3), (1, 2), (1, 3), (1, 2)]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">D</span><span class="o">.</span><span class="n">weierstrass_gap_seq</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">vertices</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
<span class="go">[((1, 3), 1), ((1, 2), 0), ((1, 3), 1), ((1, 2), 0)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">weierstrass_gap_seq</span><span class="p">()</span>  <span class="c1"># gap sequence at sink vertex, 0</span>
<span class="go">((1, 3), 1)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">weierstrass_rank_seq</span><span class="p">()</span>  <span class="c1"># rank sequence at the sink vertex</span>
<span class="go">(1, 0, 0, -1)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The integer <span class="math notranslate nohighlight">\(k\)</span> is a Weierstrass gap for the divisor <span class="math notranslate nohighlight">\(D\)</span> at vertex <span class="math notranslate nohighlight">\(v\)</span> if the rank
of <span class="math notranslate nohighlight">\(D - (k-1)v\)</span> does not equal the rank of <span class="math notranslate nohighlight">\(D - kv\)</span>.  Let <span class="math notranslate nohighlight">\(r\)</span> be the rank of <span class="math notranslate nohighlight">\(D\)</span> and
let <span class="math notranslate nohighlight">\(k_i\)</span> be the <span class="math notranslate nohighlight">\(i\)</span>-th gap at <span class="math notranslate nohighlight">\(v\)</span>.  The Weierstrass weight of <span class="math notranslate nohighlight">\(v\)</span> for <span class="math notranslate nohighlight">\(D\)</span> is the
sum of <span class="math notranslate nohighlight">\((k_i - i)\)</span> as <span class="math notranslate nohighlight">\(i\)</span> ranges from <span class="math notranslate nohighlight">\(1\)</span> to <span class="math notranslate nohighlight">\(r + 1\)</span>.  It measure the difference
between the sequence <span class="math notranslate nohighlight">\(r, r - 1, ..., 0, -1, -1, ...\)</span> and the rank sequence
<span class="math notranslate nohighlight">\(\mathrm{rank}(D), \mathrm{rank}(D - v), \mathrm{rank}(D - 2v), \dots\)</span></p>
</div>
<p>—</p>
<p id="weierstrass-pts-divisor"><strong>weierstrass_pts(with_rank_seq=False)</strong></p>
<p>The Weierstrass points (vertices). Optionally, return the corresponding rank sequences.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">with_rank_seq</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) boolean</p>
<p>OUTPUT:</p>
<p>tuple of vertices or list of (vertex, rank sequence)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">House</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">canonical_divisor</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">weierstrass_pts</span><span class="p">()</span>
<span class="go">(4,)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">weierstrass_pts</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[(4, (1, 0, 0, -1))]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The vertex <span class="math notranslate nohighlight">\(v\)</span> is a (generalized) Weierstrass point for divisor <span class="math notranslate nohighlight">\(D\)</span> if the
sequence of ranks <span class="math notranslate nohighlight">\(r(D - nv)\)</span>
for <span class="math notranslate nohighlight">\(n = 0, 1, 2, \dots\)</span> is not <span class="math notranslate nohighlight">\(r(D), r(D)-1, \dots, 0, -1, -1, \dots\)</span></p>
</div>
<p>—</p>
<p id="weierstrass-rank-seq-divisor"><strong>weierstrass_rank_seq(v=’sink’)</strong></p>
<p>The Weierstrass rank sequence at the given vertex.  Computes the rank of
the divisor <span class="math notranslate nohighlight">\(D - nv\)</span> starting with <span class="math notranslate nohighlight">\(n=0\)</span> and ending when the rank is
<span class="math notranslate nohighlight">\(-1\)</span>.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">v</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">sink</span></code>) vertex</p>
<p>OUTPUT:</p>
<p>tuple of int</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">House</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">canonical_divisor</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">K</span><span class="o">.</span><span class="n">weierstrass_rank_seq</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">vertices</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
<span class="go">[(1, 0, -1), (1, 0, -1), (1, 0, -1), (1, 0, -1), (1, 0, 0, -1)]</span>
</pre></div>
</div>
<p>—</p>
</section>
<section id="other">
<h4>Other<a class="headerlink" href="#other" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p><a class="reference internal" href="#firing-graph"><span class="std std-ref">firing_graph</span></a> — The firing graph.</p></li>
<li><p><a class="reference internal" href="#parallel-firing-graph"><span class="std std-ref">parallel_firing_graph</span></a> — The parallel-firing graph.</p></li>
<li><p><a class="reference internal" href="#sandpiles"><span class="std std-ref">sandpiles</span></a> — Some examples of sandpiles.</p></li>
<li><p><a class="reference internal" href="#wilmes-algorithm"><span class="std std-ref">wilmes_algorithm</span></a> — Find matrix with the
same integer row span as <code class="docutils literal notranslate"><span class="pre">M</span></code> that is the reduced Laplacian of a digraph.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Complete descriptions of methods.</strong></p>
<p id="firing-graph"><strong>firing_graph(S, eff)</strong></p>
<blockquote>
<div><p>Creates a digraph with divisors as vertices and edges between two divisors
<span class="math notranslate nohighlight">\(D\)</span> and <span class="math notranslate nohighlight">\(E\)</span> if firing a single vertex in <span class="math notranslate nohighlight">\(D\)</span> gives <span class="math notranslate nohighlight">\(E\)</span>.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">S</span></code> – Sandpile
<code class="docutils literal notranslate"><span class="pre">eff</span></code> – list of divisors</p>
<p>OUTPUT:</p>
<p>DiGraph</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">eff</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">effective_div</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">firing_graph</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">eff</span><span class="p">)</span><span class="o">.</span><span class="n">show3d</span><span class="p">(</span><span class="n">edge_size</span><span class="o">=</span><span class="mf">.005</span><span class="p">,</span><span class="n">vertex_size</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>—</p>
<p id="parallel-firing-graph"><strong>parallel_firing_graph(S,eff)</strong></p>
<blockquote>
<div><p>Creates a digraph with divisors as vertices and edges between two
divisors <code class="docutils literal notranslate"><span class="pre">D</span></code> and <code class="docutils literal notranslate"><span class="pre">E</span></code> if firing all unstable vertices in <code class="docutils literal notranslate"><span class="pre">D</span></code> gives
<code class="docutils literal notranslate"><span class="pre">E</span></code>.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">S</span></code> - Sandpile
<code class="docutils literal notranslate"><span class="pre">eff</span></code> - list of divisors</p>
<p>OUTPUT:</p>
<p>DiGraph</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Sandpile</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">SandpileDivisor</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">eff</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">effective_div</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">parallel_firing_graph</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">eff</span><span class="p">)</span><span class="o">.</span><span class="n">show3d</span><span class="p">(</span><span class="n">edge_size</span><span class="o">=</span><span class="mf">.005</span><span class="p">,</span><span class="n">vertex_size</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>—</p>
<p id="sandpiles"><strong>sandpiles</strong></p>
<blockquote>
<div><p>Some examples of sandpiles.</p>
<p>Here are the available examples; you can also type “sandpiles.”
and hit tab to get a list:</p>
<ul class="simple">
<li><p>“Complete()”</p></li>
<li><p>“Cycle()”</p></li>
<li><p>“Diamond()”</p></li>
<li><p>“Grid()”</p></li>
<li><p>“House()”</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sandpiles</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">invariant_factors</span><span class="p">()</span>
<span class="go">[1, 4, 4]</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">laplacian</span><span class="p">()</span>
<span class="go">[ 3 -1 -1 -1]</span>
<span class="go">[-1  3 -1 -1]</span>
<span class="go">[-1 -1  3 -1]</span>
<span class="go">[-1 -1 -1  3]</span>
</pre></div>
</div>
</div></blockquote>
<p>—</p>
<p id="wilmes-algorithm"><strong>wilmes_algorithm(M)</strong></p>
<blockquote>
<div><p>Computes an integer matrix <code class="docutils literal notranslate"><span class="pre">L</span></code> with the same integer row span as <code class="docutils literal notranslate"><span class="pre">M</span></code>
and such that <code class="docutils literal notranslate"><span class="pre">L</span></code> is the reduced laplacian of a directed multigraph.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">M</span></code> - square integer matrix of full rank</p>
<p>OUTPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">L</span></code> - integer matrix</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">wilmes_algorithm</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">[ 3279   -79 -1599 -1600]</span>
<span class="go">[   -1  1539  -136 -1402]</span>
<span class="go">[    0    -1  1650 -1649]</span>
<span class="go">[    0     0 -1658  1658]</span>
</pre></div>
</div>
<p>NOTE:</p>
<p>The algorithm is due to John Wilmes.</p>
</div></blockquote>
</section>
</section>
<section id="id16">
<h3>Help<a class="headerlink" href="#id16" title="Permalink to this heading">#</a></h3>
<p>Documentation for each method is available through the Sage online help system:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span>SandpileConfig.fire_vertex<span class="o">?</span>
<span class="go">Base Class:     &lt;class &#39;instancemethod&#39;&gt;</span>
<span class="go">String Form:    &lt;unbound method SandpileConfig.fire_vertex&gt;</span>
<span class="go">Namespace:      Interactive</span>
<span class="go">File:           /usr/local/sage-4.7/local/lib/python2.6/site-packages/sage/sandpiles/sandpile.py</span>
<span class="go">Definition:     SandpileConfig.fire_vertex(self, v)</span>
<span class="go">Docstring:</span>
<span class="go">       Fire the vertex ``v``.</span>

<span class="go">       INPUT:</span>

<span class="go">       ``v`` - vertex</span>

<span class="go">       OUTPUT:</span>

<span class="go">       SandpileConfig</span>

<span class="go">       EXAMPLES:</span>

<span class="go">          sage: S = Sandpile(graphs.CycleGraph(3), 0)</span>
<span class="go">          sage: c = SandpileConfig(S, [1,2])</span>
<span class="go">          sage: c.fire_vertex(2)</span>
<span class="go">          {1: 2, 2: 0}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>An alternative to <code class="docutils literal notranslate"><span class="pre">SandpileConfig.fire_vertex?</span></code> in the preceding code example
would be <code class="docutils literal notranslate"><span class="pre">c.fire_vertex?</span></code>, if <code class="docutils literal notranslate"><span class="pre">c</span></code> is any SandpileConfig.</p>
</div>
<p>Enter <code class="docutils literal notranslate"><span class="pre">Sandpile.help()</span></code>, <code class="docutils literal notranslate"><span class="pre">SandpileConfig.help()</span></code>, and <code class="docutils literal notranslate"><span class="pre">SandpileDivisor.help()</span></code> for lists of available Sandpile-specific methods.</p>
<p>General Sage documentation can be found at <a class="reference external" href="http://doc.sagemath.org/html/en/">http://doc.sagemath.org/html/en/</a>.</p>
</section>
</section>
<section id="contact">
<h2>Contact<a class="headerlink" href="#contact" title="Permalink to this heading">#</a></h2>
<p>Please contact <a class="reference external" href="mailto:davidp&#37;&#52;&#48;reed&#46;edu">davidp<span>&#64;</span>reed<span>&#46;</span>edu</a> with questions, bug reports, and suggestions for
additional features and other improvements.</p>
<div role="list" class="citation-list">
<div class="citation" id="bn" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>BN<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id3">1</a>,<a role="doc-backlink" href="#id6">2</a>)</span>
<p>Matthew Baker, Serguei Norine, <a class="reference external" href="http://people.math.gatech.edu/~mbaker/papers.html">Riemann-Roch and Abel-Jacobi Theory on a
Finite Graph</a>,
Advances in Mathematics 215 (2007), 766–788.</p>
</div>
<div class="citation" id="btw" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">BTW</a><span class="fn-bracket">]</span></span>
<p>Per Bak, Chao Tang and Kurt Wiesenfeld (1987).
<em>Self-organized criticality: an explanation of 1/f noise</em>,
Physical Review Letters 60: 381–384;
<a class="reference external" href="https://en.wikipedia.org/wiki/Bak-Tang-Wiesenfeld_sandpile">Wikipedia article Bak-Tang-Wiesenfeld_sandpile</a>.</p>
</div>
<div class="citation" id="crs" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id7">CRS</a><span class="fn-bracket">]</span></span>
<p>Robert Cori, Dominique Rossin, and Bruno Salvy, <em>Polynomial ideals for
sandpiles and their Gröbner bases</em>,
Theoretical Computer Science, 276 (2002) no. 1–2, 1–15.</p>
</div>
<div class="citation" id="h" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">H</a><span class="fn-bracket">]</span></span>
<p>Alexander E. Holroyd, Lionel Levine, Karola Meszaros, Yuval Peres,
James Propp, David B. Wilson,
<em>Chip-Firing and Rotor-Routing on Directed Graphs</em>, <a class="reference external" href="https://arxiv.org/abs/0801.3306">arXiv 0801.3306</a>.
An older version of this paper appears in <em>In and out of Equilibrium II</em>,
Eds. V. Sidoravicius, M. E. Vares, in the Series Progress in Probability,
Birkhauser (2008).</p>
</div>
<div class="citation" id="ppw2013" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">PPW2013</a><span class="fn-bracket">]</span></span>
<p>D. Perkinson, J. Perlman, and J. Wilmes.
<em>Primer for the algebraic geometry of sandpiles</em>.
Tropical and Non-Archimedean
Geometry, Contemp. Math., 605, Amer. Math. Soc.,
Providence, RI, 2013.
<a class="reference external" href="https://arxiv.org/abs/1112.6163">arXiv 1112.6163</a>.</p>
</div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="group_theory.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Group Theory and Sage</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="algebraic_combinatorics/rsk.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Young’s lattice and the RSK algorithm</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2023, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Abelian Sandpile Model</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a><ul>
<li><a class="reference internal" href="#configurations-and-divisors">Configurations and divisors</a></li>
<li><a class="reference internal" href="#stabilization">Stabilization</a></li>
<li><a class="reference internal" href="#laplacian">Laplacian</a></li>
<li><a class="reference internal" href="#recurrent-elements">Recurrent elements</a></li>
<li><a class="reference internal" href="#burning-configuration">Burning Configuration</a></li>
<li><a class="reference internal" href="#sandpile-group">Sandpile group</a></li>
<li><a class="reference internal" href="#self-organized-criticality">Self-organized criticality</a></li>
<li><a class="reference internal" href="#divisors-and-discrete-riemann-surfaces">Divisors and Discrete Riemann surfaces</a><ul>
<li><a class="reference internal" href="#riemann-roch">Riemann-Roch</a></li>
<li><a class="reference internal" href="#picturing-linear-systems">Picturing linear systems</a></li>
</ul>
</li>
<li><a class="reference internal" href="#algebraic-geometry-of-sandpiles">Algebraic geometry of sandpiles</a><ul>
<li><a class="reference internal" href="#affine">Affine</a></li>
<li><a class="reference internal" href="#projective">Projective</a></li>
<li><a class="reference internal" href="#zeros">Zeros</a></li>
<li><a class="reference internal" href="#resolutions">Resolutions</a></li>
<li><a class="reference internal" href="#complete-intersections-and-arithmetically-gorenstein-toppling-ideals">Complete Intersections and Arithmetically Gorenstein toppling ideals</a></li>
<li><a class="reference internal" href="#betti-numbers-for-undirected-graphs">Betti numbers for undirected graphs</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#usage">Usage</a><ul>
<li><a class="reference internal" href="#initialization">Initialization</a></li>
<li><a class="reference internal" href="#methods">Methods</a><ul>
<li><a class="reference internal" href="#sandpile">Sandpile</a></li>
<li><a class="reference internal" href="#sandpileconfig">SandpileConfig</a></li>
<li><a class="reference internal" href="#sandpiledivisor">SandpileDivisor</a></li>
<li><a class="reference internal" href="#other">Other</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id16">Help</a></li>
</ul>
</li>
<li><a class="reference internal" href="#contact">Contact</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script src="_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="_static/mathjax/tex-chtml.js"></script>
    </body>
</html>