<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Modular Symbols" href="modular_symbols.html" /><link rel="prev" title="Modular Forms" href="modular_forms.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>Modular Forms and Hecke Operators - Thematic Tutorials</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom-furo.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Thematic Tutorials</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 10.0 Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../index.html">Home - Thematic Tutorials</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../toctree.html">Thematic tutorial document tree</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../algebraic_combinatorics.html">Algebraic Combinatorics in Sage</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../algebraic_combinatorics/walks.html">Walks in graphs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../algebraic_combinatorics/n_cube.html"><span class="math notranslate nohighlight">\(n\)</span>-Cube</a></li>
<li class="toctree-l3"><a class="reference internal" href="../algebraic_combinatorics/tsetlin_library.html">The Tsetlin library</a></li>
<li class="toctree-l3"><a class="reference internal" href="../algebraic_combinatorics/rsk.html">Young’s lattice and the RSK algorithm</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../sandpile.html">Abelian Sandpile Model</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../group_theory.html">Group Theory and Sage</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../lie.html">Lie Methods and Related Combinatorics in Sage</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../lie/introduction.html">The Scope of this Document</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lie/lie_basics.html">Lie Group Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lie/weyl_character_ring.html">The Weyl Character Ring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lie/branching_rules.html">Maximal Subgroups and Branching Rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lie/weyl_groups.html">Weyl Groups, Coxeter Groups and the Bruhat Order</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lie/crystals.html">Classical Crystals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lie/affine.html">Affine Root System Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lie/integrable.html">Integrable Highest Weight Representations of Affine Lie algebras</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lie/affine_finite_crystals.html">Affine Finite Crystals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lie/affine_hw_crystals.html">Affine Highest Weight Crystals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lie/elementary_crystals.html">Elementary crystals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lie/infinity_crystals.html">Infinity Crystals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lie/iwahori_hecke_algebra.html">Iwahori Hecke Algebras</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lie/kazhdan_lusztig_polynomials.html">Kazhdan-Lusztig Polynomials</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lie/bibliography.html">Bibliography</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../vector_calculus.html">Tutorial: Vector Calculus in Euclidean Spaces</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../vector_calculus/vector_calc_cartesian.html">How to compute a gradient, a divergence or a curl</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vector_calculus/vector_calc_curvilinear.html">How to perform vector calculus in curvilinear coordinates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vector_calculus/vector_calc_change.html">How to change coordinates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vector_calculus/vector_calc_advanced.html">Advanced aspects: the Euclidean space as a Riemannian manifold</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vector_calculus/vector_calc_plane.html">Vector calculus in the Euclidean plane</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../linear_programming.html">Linear Programming (Mixed Integer)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../numtheory_rsa.html">Number Theory and the RSA Public Key Cryptosystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../coding_theory.html">Coding Theory in Sage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../structures_in_coding_theory.html">How to write your own classes for coding theory</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../geometry.html">Polyhedra</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../geometry/polyhedra_quicktutorial.html">A Brief Introduction to Polytopes in Sage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/polyhedra_tutorial.html">A Longer Introduction to Polyhedral Computations in Sage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/polyhedra_quickref.html">Quick reference for polyhedra in Sage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/tips.html">Polyhedra tips and tricks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/visualization.html">Visualization of polyhedron objects in Sage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geometry/polytope_tikz.html">Draw polytopes in LaTeX using TikZ</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../steenrod_algebra_modules.html">Steenrod Algebra Modules</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial-programming-python.html">Tutorial: Programming in Python and Sage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial-comprehensions.html">Tutorial: Comprehensions, Iterators, and Iterables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial-objects-and-classes.html">Tutorial: Objects and Classes in Python and Sage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../functional_programming.html">Functional Programming for Mathematicians</a></li>
<li class="toctree-l2"><a class="reference internal" href="../coercion_and_categories.html">How to implement new algebraic structures in Sage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial-implementing-algebraic-structures.html">Tutorial: Implementing Algebraic Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cython_interface.html">How to call a C code (or a compiled library) from Sage ?</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../numerical_sage/index.html">Numerical Computing with Sage</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../numerical_sage/numerical_tools.html">Numerical Tools</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../numerical_sage/numpy.html">NumPy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../numerical_sage/scipy.html">SciPy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../numerical_sage/cvxopt.html">Cvxopt</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../numerical_sage/using_compiled_code_iteractively.html">Using Compiled Code Interactively</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../numerical_sage/f2py.html">f2py</a></li>
<li class="toctree-l4"><a class="reference internal" href="../numerical_sage/f2py_examples.html">More Interesting Examples with f2py</a></li>
<li class="toctree-l4"><a class="reference internal" href="../numerical_sage/ctypes.html">Ctypes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../numerical_sage/ctypes_examples.html">More complicated ctypes example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../numerical_sage/comparison_to_cython.html">Comparison to Cython/Pyrex</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../numerical_sage/parallel_computation.html">Parallel Computation</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../numerical_sage/mpi4py.html">mpi4py</a></li>
<li class="toctree-l4"><a class="reference internal" href="../numerical_sage/parallel_laplace_solver.html">Parallel Laplace Solver</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">Three Lectures about Explicit Methods in Number Theory Using Sage</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="number_fields.html">Number Fields</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="nf_introduction.html">Introduction to Number Fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="nf_galois_groups.html">Number Fields: Galois Groups and Class Groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="nf_orders.html">Orders and Relative Extensions</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="birds_eye_view.html">A Bird’s Eye View</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="integer_factorization.html">Integer Factorization</a></li>
<li class="toctree-l4"><a class="reference internal" href="elliptic_curves.html">Elliptic Curves</a></li>
<li class="toctree-l4"><a class="reference internal" href="birds_other.html">The Matrix of Frobenius on Hyperelliptic Curves</a></li>
<li class="toctree-l4"><a class="reference internal" href="birds_other.html#modular-symbols">Modular Symbols</a></li>
<li class="toctree-l4"><a class="reference internal" href="birds_other.html#enumerating-totally-real-number-fields">Enumerating Totally Real Number Fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="birds_other.html#bernoulli-numbers">Bernoulli Numbers</a></li>
<li class="toctree-l4"><a class="reference internal" href="birds_other.html#polynomial-arithmetic">Polynomial Arithmetic</a></li>
</ul>
</li>
<li class="toctree-l3 current has-children"><a class="reference internal" href="modular_forms.html">Modular Forms</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l4 current current-page"><a class="current reference internal" href="#">Modular Forms and Hecke Operators</a></li>
<li class="toctree-l4"><a class="reference internal" href="modular_symbols.html">Modular Symbols</a></li>
<li class="toctree-l4"><a class="reference internal" href="method_of_graphs.html">Method of Graphs</a></li>
<li class="toctree-l4"><a class="reference internal" href="level_one_forms.html">Level One Modular Forms</a></li>
<li class="toctree-l4"><a class="reference internal" href="half_integral.html">Half Integral Weight Forms</a></li>
<li class="toctree-l4"><a class="reference internal" href="generators_for_rings.html">Generators for Rings of Modular Forms</a></li>
<li class="toctree-l4"><a class="reference internal" href="l_series.html"><span class="math notranslate nohighlight">\(L\)</span>-series</a></li>
<li class="toctree-l4"><a class="reference internal" href="modabvar.html">Modular Abelian Varieties</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../profiling.html">Profiling in Sage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sws2rst.html">Creating a Tutorial from an old Sage Worksheet (.sws)</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="modular-forms-and-hecke-operators">
<h1>Modular Forms and Hecke Operators<a class="headerlink" href="#modular-forms-and-hecke-operators" title="Permalink to this heading">#</a></h1>
<section id="congruence-subgroups">
<h2>Congruence subgroups<a class="headerlink" href="#congruence-subgroups" title="Permalink to this heading">#</a></h2>
<section id="definition">
<h3>Definition<a class="headerlink" href="#definition" title="Permalink to this heading">#</a></h3>
<p>A congruence subgroup is a subgroup of the group
<span class="math notranslate nohighlight">\(\mathrm{SL}_2(\ZZ)\)</span> of determinant <span class="math notranslate nohighlight">\(\pm 1\)</span> integer
matrices that contains</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\Gamma(N) = \mathrm{Ker}(\mathrm{SL}_2(\ZZ) \to \mathrm{SL}_2(\ZZ/N\ZZ))\]</div>
</div>
<p>for some positive integer <span class="math notranslate nohighlight">\(N\)</span>. Since <span class="math notranslate nohighlight">\(\Gamma(N)\)</span> has
finite index in <span class="math notranslate nohighlight">\(\mathrm{SL}_2(\ZZ)\)</span>, all congruence subgroups
have finite index. The converse is not true, though in many other
settings it is true (see [paper of Serre]).</p>
<p>The inverse image <span class="math notranslate nohighlight">\(\Gamma_0(N)\)</span> of the subgroup of upper
triangular matrices in <span class="math notranslate nohighlight">\(\mathrm{SL}_2(\ZZ/N\ZZ)\)</span>
is a congruence subgroup, as is the inverse image <span class="math notranslate nohighlight">\(\Gamma_1(N)\)</span>
of the subgroup of matrices of the form
<span class="math notranslate nohighlight">\(\left(\begin{smallmatrix}1&amp;*\\0&amp;1\end{smallmatrix}\right)\)</span>. Also,
for any subgroup <span class="math notranslate nohighlight">\(H\subset (\ZZ/N\ZZ)^*\)</span>, the
inverse image <span class="math notranslate nohighlight">\(\Gamma_H(N)\)</span> of the subgroup of
<span class="math notranslate nohighlight">\(\mathrm{SL}_2(\ZZ/N\ZZ)\)</span> of all elements of the
form <span class="math notranslate nohighlight">\(\left(\begin{smallmatrix}a&amp;*\\0&amp;d\end{smallmatrix}\right)\)</span>
with <span class="math notranslate nohighlight">\(d \in H\)</span> is a congruence subgroup.</p>
<p>We can create each of the above congruence subgroups in Sage, using
the Gamma0, Gamma1, and GammaH commands.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Gamma0</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="go">Congruence Subgroup Gamma0(8)</span>
<span class="gp">sage: </span><span class="n">Gamma1</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="go">Congruence Subgroup Gamma1(13)</span>
<span class="gp">sage: </span><span class="n">GammaH</span><span class="p">(</span><span class="mi">11</span><span class="p">,[</span><span class="mi">3</span><span class="p">])</span>
<span class="go">Congruence Subgroup Gamma_H(11) with H generated by [3]</span>
</pre></div>
</div>
<p>The second argument to the GammaH command is a list of generators of
the subgroup <span class="math notranslate nohighlight">\(H\)</span> of <span class="math notranslate nohighlight">\((\ZZ/N\ZZ)^*\)</span>.</p>
</section>
<section id="generators">
<h3>Generators<a class="headerlink" href="#generators" title="Permalink to this heading">#</a></h3>
<p>Sage can compute a list of generators for these subgroups. The
algorithm Sage uses is a straightforward generic procedure that uses
coset representatives for the congruence subgroup (which are easy to
enumerate) to obtain a list of generators [[ref my modular forms
book]].</p>
<p>The list of generators Sage computes is unfortunately large. Improving this
would be an excellent Sage development project, which would involve much
beautiful mathematics.</p>
<p>UPDATE (March 2012): The project referred to above has been carried out (by
several people, notably Hartmut Monien, building on earlier work of Chris
Kurth). Sage now uses a much more advanced algorithm based on Farey symbols
which calculates a <em>minimal</em> set of generators.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Gamma0</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(</span>
<span class="go">[1 1]  [ 1 -1]</span>
<span class="go">[0 1], [ 2 -1]</span>
<span class="go">)</span>
<span class="gp">sage: </span><span class="n">Gamma0</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;todd-coxeter&quot;</span><span class="p">)</span> <span class="c1"># the old implementation</span>
<span class="go">(</span>
<span class="go">[1 1]  [-1  0]  [ 1 -1]  [ 1 -1]  [-1  1]</span>
<span class="go">[0 1], [ 0 -1], [ 0  1], [ 2 -1], [-2  1]</span>
<span class="go">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">Gamma1</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">())</span>
<span class="go">15</span>
</pre></div>
</div>
</section>
</section>
<section id="modular-forms">
<h2>Modular Forms<a class="headerlink" href="#modular-forms" title="Permalink to this heading">#</a></h2>
<section id="id1">
<h3>Definition<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<p>A modular form on a congruence subgroup
<span class="math notranslate nohighlight">\(\Gamma\)</span> of integer weight <span class="math notranslate nohighlight">\(k\)</span> is a holomorphic
function <span class="math notranslate nohighlight">\(f(z)\)</span> on the upper half plane</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\mathfrak{h}^* = \{z \in \CC : \Im(z) &gt; 0\}\cup \QQ \cup\{i\infty\}\]</div>
</div>
<p>such that for every matrix
<span class="math notranslate nohighlight">\(\left(\begin{smallmatrix}a&amp;b\\c&amp;d\end{smallmatrix}\right)\in\Gamma\)</span>,
we have</p>
<div class="math-wrapper docutils container" id="modform">
<div class="math notranslate nohighlight" id="modform">
\[f\left(\frac{az+b}{cz+d}\right) = (cz+d)^{k} f(z).\]</div>
</div>
<p>A cusp form is a modular form that vanishes at all of the cusps
<span class="math notranslate nohighlight">\(\QQ \cup \{i\infty\}\)</span>.</p>
<p>If <span class="math notranslate nohighlight">\(\Gamma\)</span> contains <span class="math notranslate nohighlight">\(\Gamma_1(N)\)</span> for some <span class="math notranslate nohighlight">\(N\)</span>,
then
<span class="math notranslate nohighlight">\(\left(\begin{smallmatrix}1&amp;1\\0&amp;1\end{smallmatrix}\right)\in\Gamma\)</span>,
so <a class="reference internal" href="#modform"><span class="std std-ref">the modular form condition</span></a> implies that <span class="math notranslate nohighlight">\(f(z) = f(z+1)\)</span>. This, coupled
with the holomorphicity condition, implies that <span class="math notranslate nohighlight">\(f(z)\)</span> has a
Fourier expansion</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[f(z) = \sum_{n=0}^{\infty} a_n e^{2\pi i n z}\]</div>
</div>
<p>with <span class="math notranslate nohighlight">\(a_n\in\CC\)</span>. We let <span class="math notranslate nohighlight">\(q = e^{2\pi i z}\)</span>, and
call <span class="math notranslate nohighlight">\(f = \sum_{n=0}^{\infty} a_n q^n\)</span> the <span class="math notranslate nohighlight">\(q\)</span>-expansion
of <span class="math notranslate nohighlight">\(f\)</span>.</p>
</section>
<section id="creation-in-sage">
<h3>Creation in Sage<a class="headerlink" href="#creation-in-sage" title="Permalink to this heading">#</a></h3>
<p>Henceforth we assume that
<span class="math notranslate nohighlight">\(\Gamma\)</span> is either <span class="math notranslate nohighlight">\(\Gamma_1(N)\)</span>,
<span class="math notranslate nohighlight">\(\Gamma_0(N)\)</span>, or <span class="math notranslate nohighlight">\(\Gamma_H(N)\)</span> for some
<span class="math notranslate nohighlight">\(H\)</span> and <span class="math notranslate nohighlight">\(N\)</span>. The complex vector space
<span class="math notranslate nohighlight">\(M_k(\Gamma)\)</span> of all modular forms of weight <span class="math notranslate nohighlight">\(k\)</span>
on <span class="math notranslate nohighlight">\(\Gamma\)</span> is a finite dimensional vector space.</p>
<p>We create the space <span class="math notranslate nohighlight">\(M_k(\Gamma)\)</span> in Sage by typing
<code class="docutils literal notranslate"><span class="pre">ModularForms(G,</span> <span class="pre">k)</span></code> where <span class="math notranslate nohighlight">\(G\)</span> is the congruence subgroup
and <span class="math notranslate nohighlight">\(k\)</span> is the weight.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ModularForms</span><span class="p">(</span><span class="n">Gamma0</span><span class="p">(</span><span class="mi">25</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">Modular Forms space of dimension 11 for ...</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">CuspForms</span><span class="p">(</span><span class="n">Gamma0</span><span class="p">(</span><span class="mi">25</span><span class="p">),</span><span class="mi">4</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">15</span><span class="p">);</span> <span class="n">S</span>
<span class="go">Cuspidal subspace of dimension 5 of Modular Forms space ...</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">q + q^9 - 8*q^11 - 8*q^14 + O(q^15),</span>
<span class="go">q^2 - q^7 - q^8 - 7*q^12 + 7*q^13 + O(q^15),</span>
<span class="go">q^3 + q^7 - 2*q^8 - 6*q^12 - 5*q^13 + O(q^15),</span>
<span class="go">q^4 - q^6 - 3*q^9 + 5*q^11 - 2*q^14 + O(q^15),</span>
<span class="go">q^5 - 4*q^10 + O(q^15)</span>
<span class="go">]</span>
</pre></div>
</div>
</section>
<section id="dimension-formulas">
<h3>Dimension Formulas<a class="headerlink" href="#dimension-formulas" title="Permalink to this heading">#</a></h3>
<p>Sage computes the dimensions of all these spaces using simple
arithmetic formulas instead of actually computing bases for the spaces
in question. In fact, Sage has the most general collection of modular
forms dimension formulas of any software; type <code class="docutils literal notranslate"><span class="pre">help(sage.modular.dims)</span></code>
to see a list of arithmetic functions that are used to implement these
dimension formulas.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ModularForms</span><span class="p">(</span><span class="n">Gamma1</span><span class="p">(</span><span class="mi">949284</span><span class="p">),</span> <span class="mi">456</span><span class="p">)</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">11156973844800</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.dims</span> <span class="kn">import</span> <span class="n">dimension_cusp_forms</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">dimension_cusp_forms</span><span class="p">(</span><span class="n">Gamma0</span><span class="p">(</span><span class="n">N</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1..25</span><span class="p">]];</span> <span class="n">a</span>
<span class="go">[0, 0, ..., 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 2, 2, 1, 0]</span>
<span class="gp">sage: </span><span class="n">oeis</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>                                       <span class="c1"># optional - internet</span>
<span class="go">0: A001617: Genus of modular group Gamma_0(n). Or, genus of modular curve X_0(n).</span>
</pre></div>
</div>
<p>Sage does not have simple formulas for dimensions of spaces of modular
forms of weight <span class="math notranslate nohighlight">\(1\)</span>, since such formulas perhaps do not exist.</p>
</section>
<section id="diamond-bracket-operators">
<h3>Diamond Bracket Operators<a class="headerlink" href="#diamond-bracket-operators" title="Permalink to this heading">#</a></h3>
<p>The space
<span class="math notranslate nohighlight">\(M_k(\Gamma_1(N))\)</span> is equipped with an action of
<span class="math notranslate nohighlight">\((\ZZ/N\ZZ)^*\)</span> by diamond bracket operators
<span class="math notranslate nohighlight">\(\langle d \rangle\)</span>, and this induces a decomposition</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[M_k(\Gamma_1(N)) = \bigoplus_{\varepsilon:(\ZZ/N\ZZ)^* \to \CC^*} M_k(N,\varepsilon),\]</div>
</div>
<p>where the sum is over all complex characters of the
finite abelian group <span class="math notranslate nohighlight">\((\ZZ/N\ZZ)^*\)</span>. These
characters are called Dirichlet characters, which are central in
number theory.</p>
<p>The factors <span class="math notranslate nohighlight">\(M_k(N,\varepsilon)\)</span> then have bases whose
<span class="math notranslate nohighlight">\(q\)</span>-expansions are elements of <span class="math notranslate nohighlight">\(R[[q]]\)</span>, where
<span class="math notranslate nohighlight">\(R = \ZZ[\varepsilon]\)</span> is the ring generated over
<span class="math notranslate nohighlight">\(\ZZ\)</span> by the image of <span class="math notranslate nohighlight">\(\varepsilon\)</span>. We illustrate
this with <span class="math notranslate nohighlight">\(N=k=5\)</span> below, where DirichletGroup will be
described later.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CuspForms</span><span class="p">(</span><span class="n">DirichletGroup</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="mf">.0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">q + (-zeta4 - 1)*q^2 + (6*zeta4 - 6)*q^3 - ... + O(q^6)</span>
<span class="go">]</span>
</pre></div>
</div>
</section>
<section id="dirichlet-characters">
<h3>Dirichlet Characters<a class="headerlink" href="#dirichlet-characters" title="Permalink to this heading">#</a></h3>
<p>Use the command DirichletGroup(N,R) to create the group of all
Dirichlet characters of modulus <span class="math notranslate nohighlight">\(N\)</span> taking values in the
ring <span class="math notranslate nohighlight">\(R\)</span>. If <span class="math notranslate nohighlight">\(R\)</span> is omitted, it defaults to a
cyclotomic field.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DirichletGroup</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Group of Dirichlet characters modulo 8 with values in Cyclotomic Field of order 2 and degree 1</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">list</span><span class="p">();</span> <span class="n">v</span>
<span class="go">[Dirichlet character modulo 8 of conductor 1 mapping 7 |--&gt; 1, 5 |--&gt; 1,</span>
<span class="go">Dirichlet character modulo 8 of conductor 4 mapping 7 |--&gt; -1, 5 |--&gt; 1,</span>
<span class="go">Dirichlet character modulo 8 of conductor 8 mapping 7 |--&gt; 1, 5 |--&gt; -1,</span>
<span class="go">Dirichlet character modulo 8 of conductor 8 mapping 7 |--&gt; -1, 5 |--&gt; -1]</span>
<span class="gp">sage: </span><span class="n">eps</span> <span class="o">=</span> <span class="n">G</span><span class="mf">.0</span><span class="p">;</span> <span class="n">eps</span>
<span class="go">Dirichlet character modulo 8 of conductor 4 mapping 7 |--&gt; -1, 5 |--&gt; 1</span>
<span class="gp">sage: </span><span class="n">eps</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[0, 1, 0, -1, 0, 1, 0, -1]</span>
</pre></div>
</div>
<p>Sage both represents Dirichlet characters by giving a “matrix”,
i.e., the list of images of canonical generators of
<span class="math notranslate nohighlight">\((\ZZ/N\ZZ)^*\)</span>, and as vectors modulo an
integer <span class="math notranslate nohighlight">\(n\)</span>. For years, I was torn between these two
representations, until J. Quer and I realized that the best
approach is to use both and make it easy to convert between them.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">eps</span><span class="o">.</span><span class="n">element</span><span class="p">())</span>
<span class="go">Vector space of dimension 2 over Ring of integers modulo 2</span>
</pre></div>
</div>
<p>Given a Dirichlet character, Sage also lets you compute the
associated Jacobi and Gauss sums, generalized Bernoulli numbers,
the conductor, Galois orbit, etc.</p>
</section>
<section id="decomposing-m-k-gamma-1-n">
<h3>Decomposing <span class="math notranslate nohighlight">\(M_k(\Gamma_1(N))\)</span><a class="headerlink" href="#decomposing-m-k-gamma-1-n" title="Permalink to this heading">#</a></h3>
<p>Recall that
Dirichlet characters give a decomposition</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[M_k(\Gamma_1(N)) = \bigoplus_{\varepsilon:(\ZZ/N\ZZ)^* \to \CC^*} M_k(N,\varepsilon).\]</div>
</div>
<p>Given a Dirichlet character <span class="math notranslate nohighlight">\(\varepsilon\)</span> we type
ModularForms(eps, weight) to create the space of modular forms with
that character and a given integer weight. For example, we create
the space of forms of weight <span class="math notranslate nohighlight">\(5\)</span> with the character modulo
<span class="math notranslate nohighlight">\(8\)</span> above that is <span class="math notranslate nohighlight">\(-1\)</span> on <span class="math notranslate nohighlight">\(3\)</span> and
<span class="math notranslate nohighlight">\(1\)</span> on <span class="math notranslate nohighlight">\(5\)</span> as follows.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ModularForms</span><span class="p">(</span><span class="n">eps</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Modular Forms space of dimension 6, character [-1, 1] and</span>
<span class="go">weight 5 over Rational Field</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">([</span><span class="n">ModularForms</span><span class="p">(</span><span class="n">eps</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span> <span class="k">for</span> <span class="n">eps</span> <span class="ow">in</span> <span class="n">v</span><span class="p">])</span>
<span class="go">11</span>
<span class="gp">sage: </span><span class="n">ModularForms</span><span class="p">(</span><span class="n">Gamma1</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Modular Forms space of dimension 11 ...</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Exercise: Compute the dimensions of all spaces <span class="math notranslate nohighlight">\(M_2(37,\varepsilon)\)</span>
for all Dirichlet characters <span class="math notranslate nohighlight">\(\varepsilon\)</span>.</p>
</div>
</section>
<section id="hecke-operators">
<h3>Hecke Operators<a class="headerlink" href="#hecke-operators" title="Permalink to this heading">#</a></h3>
<p>The space <span class="math notranslate nohighlight">\(M_k(\Gamma)\)</span>
is equipped with an action of a commuting ring <span class="math notranslate nohighlight">\(\mathbb{T}\)</span> of
Hecke operators <span class="math notranslate nohighlight">\(T_n\)</span> for <span class="math notranslate nohighlight">\(n\geq 1\)</span>. A standard
computational problem in the theory of modular forms is to compute
an explicit basis of <span class="math notranslate nohighlight">\(q\)</span>-expansion for
<span class="math notranslate nohighlight">\(M_k(\Gamma)\)</span> along with matrices for the action of any
Hecke operator <span class="math notranslate nohighlight">\(T_n\)</span>, and to compute the subspace
<span class="math notranslate nohighlight">\(S_k(\Gamma)\)</span> of cusp forms.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">ModularForms</span><span class="p">(</span><span class="n">Gamma0</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">q + 3*q^3 - 6*q^4 - 7*q^5 + O(q^6),</span>
<span class="go">q^2 - 4*q^3 + 2*q^4 + 8*q^5 + O(q^6),</span>
<span class="go">1 + O(q^6),</span>
<span class="go">q + 9*q^2 + 28*q^3 + 73*q^4 + 126*q^5 + O(q^6)</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">hecke_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[0 2 0 0]</span>
<span class="go">[1 2 0 0]</span>
<span class="go">[0 0 9 0]</span>
<span class="go">[0 0 0 9]</span>
</pre></div>
</div>
<p>We can also compute Hecke operators on the cuspidal subspace.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">cuspidal_subspace</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">hecke_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[0 2]</span>
<span class="go">[1 2]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">hecke_matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[ 3 -8]</span>
<span class="go">[-4 -5]</span>
</pre></div>
</div>
</section>
<section id="hecke-operator-on-m-k-gamma-1-n">
<h3>Hecke Operator on <span class="math notranslate nohighlight">\(M_k(\Gamma_1(N))\)</span><a class="headerlink" href="#hecke-operator-on-m-k-gamma-1-n" title="Permalink to this heading">#</a></h3>
<p>At the time these lectures were first written, Sage didn’t yet implement
computation of the Hecke operators on <span class="math notranslate nohighlight">\(M_k(\Gamma_1(N))\)</span>, but these have
subsequently been added:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">ModularForms</span><span class="p">(</span><span class="n">Gamma1</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span>
<span class="go">Modular Forms space of dimension 3 for Congruence Subgroup</span>
<span class="go">Gamma1(5) of weight 2 over Rational Field</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">hecke_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[ -21    0 -240]</span>
<span class="go">[  -2    0  -23]</span>
<span class="go">[   2    1   24]</span>
</pre></div>
</div>
<p>These are calculated by first calculating Hecke operators on modular symbols
for <span class="math notranslate nohighlight">\(\Gamma_1(N)\)</span>, which is a <span class="math notranslate nohighlight">\(\mathbb{T}\)</span>-module that is
isomorphic to <span class="math notranslate nohighlight">\(M_k(\Gamma_1(N))\)</span> (see <a class="reference internal" href="modular_symbols.html#sec-modsym"><span class="std std-ref">Modular Symbols</span></a>).</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ModularSymbols</span><span class="p">(</span><span class="n">Gamma1</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="mi">2</span><span class="p">,</span><span class="n">sign</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">hecke_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[ 2  1  1]</span>
<span class="go">[ 1  2 -1]</span>
<span class="go">[ 0  0 -1]</span>
</pre></div>
</div>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="modular_symbols.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Modular Symbols</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="modular_forms.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Modular Forms</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2023, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Modular Forms and Hecke Operators</a><ul>
<li><a class="reference internal" href="#congruence-subgroups">Congruence subgroups</a><ul>
<li><a class="reference internal" href="#definition">Definition</a></li>
<li><a class="reference internal" href="#generators">Generators</a></li>
</ul>
</li>
<li><a class="reference internal" href="#modular-forms">Modular Forms</a><ul>
<li><a class="reference internal" href="#id1">Definition</a></li>
<li><a class="reference internal" href="#creation-in-sage">Creation in Sage</a></li>
<li><a class="reference internal" href="#dimension-formulas">Dimension Formulas</a></li>
<li><a class="reference internal" href="#diamond-bracket-operators">Diamond Bracket Operators</a></li>
<li><a class="reference internal" href="#dirichlet-characters">Dirichlet Characters</a></li>
<li><a class="reference internal" href="#decomposing-m-k-gamma-1-n">Decomposing <span class="math notranslate nohighlight">\(M_k(\Gamma_1(N))\)</span></a></li>
<li><a class="reference internal" href="#hecke-operators">Hecke Operators</a></li>
<li><a class="reference internal" href="#hecke-operator-on-m-k-gamma-1-n">Hecke Operator on <span class="math notranslate nohighlight">\(M_k(\Gamma_1(N))\)</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="../_static/mathjax/tex-chtml.js"></script>
    </body>
</html>