<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="Binary quadratic forms with integer coefficients" href="binary_qf.html" /><link rel="prev" title="Quadratic Forms" href="../../index.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>Quadratic forms overview - Quadratic Forms</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom-furo.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Quadratic Forms</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 10.0 Reference Manual</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../index.html">Home - Quadratic Forms</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Quadratic forms overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="binary_qf.html">Binary quadratic forms with integer coefficients</a></li>
<li class="toctree-l1"><a class="reference internal" href="constructions.html">Constructions of quadratic forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="random_quadraticform.html">Random quadratic forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="special_values.html">Routines for computing special values of <span class="math notranslate nohighlight">\(L\)</span>-functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="count_local_2.html">Optimized counting of congruence solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="extras.html">Extra functions for quadratic forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="genera/genus.html">Genus</a></li>
<li class="toctree-l1"><a class="reference internal" href="genera/normal_form.html">Normal forms for <span class="math notranslate nohighlight">\(p\)</span>-adic quadratic and bilinear forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="qfsolve.html">Solving quadratic equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="ternary.html">Helper code for ternary quadratic forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="ternary_qf.html">Ternary quadratic form with integer coefficients</a></li>
<li class="toctree-l1"><a class="reference internal" href="quadratic_form__evaluate.html">Evaluation</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="quadratic-forms-overview">
<span id="sage-quadratic-forms-quadratic-form"></span><h1>Quadratic forms overview<a class="headerlink" href="#quadratic-forms-overview" title="Permalink to this heading">#</a></h1>
<span class="target" id="module-sage.quadratic_forms.quadratic_form"></span><p>AUTHORS:</p>
<ul class="simple">
<li><p>Jon Hanke (2007-06-19)</p></li>
<li><p>Anna Haensch (2010-07-01): Formatting and ReSTification</p></li>
<li><p>Simon Brandhorst (2019-10-15): <a class="reference internal" href="#sage.quadratic_forms.quadratic_form.quadratic_form_from_invariants" title="sage.quadratic_forms.quadratic_form.quadratic_form_from_invariants"><code class="xref py py-meth docutils literal notranslate"><span class="pre">quadratic_form_from_invariants()</span></code></a></p></li>
</ul>
<dl class="py function">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.DiagonalQuadraticForm">
<span class="sig-prename descclassname"><span class="pre">sage.quadratic_forms.quadratic_form.</span></span><span class="sig-name descname"><span class="pre">DiagonalQuadraticForm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.DiagonalQuadraticForm" title="Permalink to this definition">#</a></dt>
<dd><p>Return a quadratic form over <span class="math notranslate nohighlight">\(R\)</span> which is a sum of squares.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">R</span></code> – ring</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">diag</span></code> – list/tuple of elements coercible to <span class="math notranslate nohighlight">\(R\)</span></p></li>
</ul>
<p>OUTPUT: quadratic form</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]);</span> <span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 0 0 ]</span>
<span class="go">[ * 3 0 0 ]</span>
<span class="go">[ * * 5 0 ]</span>
<span class="go">[ * * * 7 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.quadratic_forms.quadratic_form.</span></span><span class="sig-name descname"><span class="pre">QuadraticForm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unsafe_initialization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_automorphisms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">determinant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Parents and Elements v10.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SageObject</span></code></a></p>
<p>The <code class="docutils literal notranslate"><span class="pre">QuadraticForm</span></code> class represents a quadratic form in <span class="math notranslate nohighlight">\(n\)</span> variables with
coefficients in the ring <span class="math notranslate nohighlight">\(R\)</span>.</p>
<p>INPUT:</p>
<p>The constructor may be called in any of the following ways.</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">QuadraticForm(R,</span> <span class="pre">n,</span> <span class="pre">entries)</span></code>, where</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">R</span></code> – ring for which the quadratic form is defined</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – an integer <span class="math notranslate nohighlight">\(\geq 0\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">entries</span></code> – a list of <span class="math notranslate nohighlight">\(n(n+1)/2\)</span> coefficients of the quadratic form
in <span class="math notranslate nohighlight">\(R\)</span> (given lexicographically, or equivalently, by rows of the
matrix)</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">QuadraticForm(p)</span></code>, where</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a homogeneous polynomial of degree <span class="math notranslate nohighlight">\(2\)</span></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">QuadraticForm(R,</span> <span class="pre">n)</span></code>, where</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">R</span></code> – a ring</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – a symmetric <span class="math notranslate nohighlight">\(n \times n\)</span> matrix with even diagonal (relative to
<span class="math notranslate nohighlight">\(R\)</span>)</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">QuadraticForm(R)</span></code>, where</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">R</span></code> – a symmetric <span class="math notranslate nohighlight">\(n \times n\)</span> matrix with even diagonal (relative to
its base ring)</p></li>
</ul>
</li>
</ol>
<p>If the keyword argument <code class="docutils literal notranslate"><span class="pre">unsafe_initialize</span></code> is True, then the subsequent
fields may by used to force the external initialization of various fields
of the quadratic form. Currently the only fields which can be set are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">number_of_automorphisms</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">determinant</span></code></p></li>
</ul>
<p>OUTPUT: quadratic form</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]);</span> <span class="n">Q</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 2 3 ]</span>
<span class="go">[ * 4 5 ]</span>
<span class="go">[ * * 6 ]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]);</span> <span class="n">Q</span>
<span class="go">Quadratic form in 3 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 2 3 ]</span>
<span class="go">[ * 4/3 5 ]</span>
<span class="go">[ * * 6 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Rational Field</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">28</span><span class="p">));</span> <span class="n">Q</span>
<span class="go">Quadratic form in 7 variables over Rational Field with coefficients:</span>
<span class="go">[ 0 1 2 3 4 5 6 ]</span>
<span class="go">[ * 7 8 9 10 11 12 ]</span>
<span class="go">[ * * 13 14 15 16 17 ]</span>
<span class="go">[ * * * 18 19 20 21 ]</span>
<span class="go">[ * * * * 22 23 24 ]</span>
<span class="go">[ * * * * * 25 26 ]</span>
<span class="go">[ * * * * * * 27 ]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">Quadratic form in 2 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 -2 ]</span>
<span class="go">[ * 3 ]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="go">[2 5]</span>
<span class="go">[5 8]</span>
<span class="gp">sage: </span><span class="n">QuadraticForm</span><span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 5 ]</span>
<span class="go">[ * 4 ]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">z</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="o">/</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">QuadraticForm</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">Quadratic form in 3 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 2 1/2 ]</span>
<span class="go">[ * 1 1/3 ]</span>
<span class="go">[ * * 0 ]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">m</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 5 ]</span>
<span class="go">[ * 4 ]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="n">m</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
<span class="go">Quadratic form in 2 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 5 ]</span>
<span class="go">[ * 4 ]</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.CS_genus_symbol_list">
<span class="sig-name descname"><span class="pre">CS_genus_symbol_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">force_recomputation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.CS_genus_symbol_list" title="Permalink to this definition">#</a></dt>
<dd><p>Return the list of Conway-Sloane genus symbols in increasing order of primes dividing 2*det.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">CS_genus_symbol_list</span><span class="p">()</span>
<span class="go">[Genus symbol at 2:    [2^-2 4^1 8^1]_6, Genus symbol at 3:     1^3 3^-1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.GHY_mass__maximal">
<span class="sig-name descname"><span class="pre">GHY_mass__maximal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.GHY_mass__maximal" title="Permalink to this definition">#</a></dt>
<dd><p>Use the GHY formula to compute the mass of a (maximal?) quadratic
lattice. This works for any number field.</p>
<p>REFERENCES:</p>
<p>See [GHY, Prop 7.4 and 7.5, p121] and [GY, Thrm 10.20, p25].</p>
<p>OUTPUT:</p>
<p>a rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">GHY_mass__maximal</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.Gram_det">
<span class="sig-name descname"><span class="pre">Gram_det</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.Gram_det" title="Permalink to this definition">#</a></dt>
<dd><p>Return the determinant of the Gram matrix of <span class="math notranslate nohighlight">\(Q\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is defined over the fraction field of the ring of
the quadratic form, but is often not defined over the same
ring as the quadratic form.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">Gram_det</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.Gram_matrix">
<span class="sig-name descname"><span class="pre">Gram_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.Gram_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Return a (symmetric) Gram matrix <span class="math notranslate nohighlight">\(A\)</span> for the quadratic form <span class="math notranslate nohighlight">\(Q\)</span>,
meaning that</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[Q(x) = x^t\cdot A\cdot x,\]</div>
</div>
<p>defined over the base ring of <span class="math notranslate nohighlight">\(Q\)</span>.  If this is not possible,
then a <a class="reference external" href="https://docs.python.org/library/exceptions.html#TypeError" title="(in Python v3.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeError</span></code></a> is raised.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">Gram_matrix</span><span class="p">();</span> <span class="n">A</span>
<span class="go">[1 0 0 0]</span>
<span class="go">[0 3 0 0]</span>
<span class="go">[0 0 5 0]</span>
<span class="go">[0 0 0 7]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.Gram_matrix_rational">
<span class="sig-name descname"><span class="pre">Gram_matrix_rational</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.Gram_matrix_rational" title="Permalink to this definition">#</a></dt>
<dd><p>Return a (symmetric) Gram matrix <span class="math notranslate nohighlight">\(A\)</span> for the quadratic form <span class="math notranslate nohighlight">\(Q\)</span>,
meaning that</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[Q(x) = x^t\cdot A\cdot x,\]</div>
</div>
<p>defined over the fraction field of the base ring.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">Gram_matrix_rational</span><span class="p">();</span> <span class="n">A</span>
<span class="go">[1 0 0 0]</span>
<span class="go">[0 3 0 0]</span>
<span class="go">[0 0 5 0]</span>
<span class="go">[0 0 0 7]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.Hessian_matrix">
<span class="sig-name descname"><span class="pre">Hessian_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.Hessian_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Hessian matrix <span class="math notranslate nohighlight">\(A\)</span> for which <span class="math notranslate nohighlight">\(Q(X) = (1/2) X^t\cdot A\cdot X\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">));</span> <span class="n">Q</span>
<span class="go">Quadratic form in 2 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 2 ]</span>
<span class="go">[ * 3 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">Hessian_matrix</span><span class="p">()</span>
<span class="go">[2 2]</span>
<span class="go">[2 6]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.Kitaoka_mass_at_2">
<span class="sig-name descname"><span class="pre">Kitaoka_mass_at_2</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.Kitaoka_mass_at_2" title="Permalink to this definition">#</a></dt>
<dd><p>Return the local mass of the quadratic form when <span class="math notranslate nohighlight">\(p=2\)</span>, according
to Theorem 5.6.3 on pp108–9 of Kitaoka’s Book “The Arithmetic of
Quadratic Forms”.</p>
<p>OUTPUT: a rational number &gt; 0</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">Kitaoka_mass_at_2</span><span class="p">()</span>   <span class="c1"># WARNING:  WE NEED TO CHECK THIS CAREFULLY!</span>
<span class="go">1/2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.Pall_mass_density_at_odd_prime">
<span class="sig-name descname"><span class="pre">Pall_mass_density_at_odd_prime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.Pall_mass_density_at_odd_prime" title="Permalink to this definition">#</a></dt>
<dd><p>Return the local representation density of a form (for
representing itself) defined over <span class="math notranslate nohighlight">\(\ZZ\)</span>, at some prime <span class="math notranslate nohighlight">\(p&gt;2\)</span>.</p>
<p>REFERENCES:</p>
<p>Pall’s article “The Weight of a Genus of Positive n-ary Quadratic Forms”
appearing in Proc. Symp. Pure Math. VIII (1965), pp95–105.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number &gt; 2</p></li>
</ul>
<p>OUTPUT: a rational number.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">Pall_mass_density_at_odd_prime</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[(0, Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 0 ]</span>
<span class="go">[ * 1 0 ]</span>
<span class="go">[ * * 1 ])] [(0, 3, 8)] [8/9] 8/9</span>
<span class="go">8/9</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.Watson_mass_at_2">
<span class="sig-name descname"><span class="pre">Watson_mass_at_2</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.Watson_mass_at_2" title="Permalink to this definition">#</a></dt>
<dd><p>Return the local mass of the quadratic form when <span class="math notranslate nohighlight">\(p=2\)</span>, according
to Watson’s Theorem 1 of “The 2-adic density of a quadratic form”
in Mathematika 23 (1976), pp 94–106.</p>
<p>OUTPUT: a rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">Watson_mass_at_2</span><span class="p">()</span>  <span class="c1"># WARNING:  WE NEED TO CHECK THIS CAREFULLY!    # optional - sage.symbolic</span>
<span class="go">384</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.add_symmetric">
<span class="sig-name descname"><span class="pre">add_symmetric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_place</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.add_symmetric" title="Permalink to this definition">#</a></dt>
<dd><p>Perform the substitution <span class="math notranslate nohighlight">\(x_j \longmapsto x_j + c\cdot x_i\)</span>, which has the
effect (on associated matrices) of symmetrically adding
<span class="math notranslate nohighlight">\(c\)</span> times the <span class="math notranslate nohighlight">\(j\)</span>-th row/column to the <span class="math notranslate nohighlight">\(i\)</span>-th row/column.</p>
<p>NOTE: This is meant for compatibility with previous code,
which implemented a matrix model for this class.  It is used
in the method <a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_normal_form" title="sage.quadratic_forms.quadratic_form.QuadraticForm.local_normal_form"><code class="xref py py-meth docutils literal notranslate"><span class="pre">local_normal_form()</span></code></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">c</span></code> – an element of <code class="docutils literal notranslate"><span class="pre">self.base_ring()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i</span></code>, <code class="docutils literal notranslate"><span class="pre">j</span></code> – integers <span class="math notranslate nohighlight">\(\geq 0\)</span></p></li>
</ul>
<p>OUTPUT:</p>
<p>a <a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm" title="sage.quadratic_forms.quadratic_form.QuadraticForm"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuadraticForm</span></code></a> (by default, otherwise none)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">));</span> <span class="n">Q</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 2 3 ]</span>
<span class="go">[ * 4 5 ]</span>
<span class="go">[ * * 6 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">add_symmetric</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 3 ]</span>
<span class="go">[ * 3 2 ]</span>
<span class="go">[ * * 6 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">add_symmetric</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>     <span class="c1"># ERROR: -3/2 isn&#39;t in the base ring ZZ</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">RuntimeError: this coefficient cannot be coerced</span>
<span class="go">to an element of the base ring for the quadratic form</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">));</span> <span class="n">Q</span>
<span class="go">Quadratic form in 3 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 2 3 ]</span>
<span class="go">[ * 4 5 ]</span>
<span class="go">[ * * 6 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">add_symmetric</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">Quadratic form in 3 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 2 0 ]</span>
<span class="go">[ * 4 2 ]</span>
<span class="go">[ * * 15/4 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.adjoint">
<span class="sig-name descname"><span class="pre">adjoint</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.adjoint" title="Permalink to this definition">#</a></dt>
<dd><p>This gives the adjoint (integral) quadratic form associated to the
given form, essentially defined by taking the adjoint of the matrix.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">adjoint</span><span class="p">()</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 5 -2 ]</span>
<span class="go">[ * 1 ]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">adjoint</span><span class="p">()</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 39 2 8 ]</span>
<span class="go">[ * 19 4 ]</span>
<span class="go">[ * * 8 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.adjoint_primitive">
<span class="sig-name descname"><span class="pre">adjoint_primitive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.adjoint_primitive" title="Permalink to this definition">#</a></dt>
<dd><p>Return the primitive adjoint of the quadratic form, which is
the smallest discriminant integer-valued quadratic form whose
matrix is a scalar multiple of the inverse of the matrix of
the given quadratic form.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">adjoint_primitive</span><span class="p">()</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 3 -2 ]</span>
<span class="go">[ *  1 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.anisotropic_primes">
<span class="sig-name descname"><span class="pre">anisotropic_primes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.anisotropic_primes" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list with all of the anisotropic primes of the quadratic form.</p>
<p>The infinite place is denoted by <span class="math notranslate nohighlight">\(-1\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">anisotropic_primes</span><span class="p">()</span>                                                <span class="c1"># optional - sage.libs.pari</span>
<span class="go">[2, -1]</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">anisotropic_primes</span><span class="p">()</span>                                                <span class="c1"># optional - sage.libs.pari</span>
<span class="go">[2, -1]</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">anisotropic_primes</span><span class="p">()</span>                                                <span class="c1"># optional - sage.libs.pari</span>
<span class="go">[-1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.antiadjoint">
<span class="sig-name descname"><span class="pre">antiadjoint</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.antiadjoint" title="Permalink to this definition">#</a></dt>
<dd><p>This gives an (integral) form such that its adjoint is the given form.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">adjoint</span><span class="p">()</span><span class="o">.</span><span class="n">antiadjoint</span><span class="p">()</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 -1 ]</span>
<span class="go">[ * 2 -1 ]</span>
<span class="go">[ * * 5 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">antiadjoint</span><span class="p">()</span>                                                       <span class="c1"># optional - sage.symbolic</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: not an adjoint</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.automorphism_group">
<span class="sig-name descname"><span class="pre">automorphism_group</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.automorphism_group" title="Permalink to this definition">#</a></dt>
<dd><p>Return the group of automorphisms of the quadratic form.</p>
<p>OUTPUT: a <code class="xref py py-class docutils literal notranslate"><span class="pre">MatrixGroup</span></code></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">()</span>
<span class="go">Matrix group over Rational Field with 3 generators (</span>
<span class="go">[ 0  0  1]  [1 0 0]  [ 1  0  0]</span>
<span class="go">[-1  0  0]  [0 0 1]  [ 0 -1  0]</span>
<span class="go">[ 0  1  0], [0 1 0], [ 0  0  1]</span>
<span class="go">)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">()</span>
<span class="go">Matrix group over Rational Field with 4 generators (</span>
<span class="go">[-1  0  0  0]  [ 1  0  0  0]  [ 1  0  0  0]  [ 1  0  0  0]</span>
<span class="go">[ 0 -1  0  0]  [ 0 -1  0  0]  [ 0  1  0  0]  [ 0  1  0  0]</span>
<span class="go">[ 0  0 -1  0]  [ 0  0  1  0]  [ 0  0 -1  0]  [ 0  0  1  0]</span>
<span class="go">[ 0  0  0 -1], [ 0  0  0  1], [ 0  0  0  1], [ 0  0  0 -1]</span>
<span class="go">)</span>
</pre></div>
</div>
<p>The smallest possible automorphism group has order two, since we
can always change all signs:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">()</span>
<span class="go">Matrix group over Rational Field with 1 generators (</span>
<span class="go">[-1  0  0]</span>
<span class="go">[ 0 -1  0]</span>
<span class="go">[ 0  0 -1]</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.automorphisms">
<span class="sig-name descname"><span class="pre">automorphisms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.automorphisms" title="Permalink to this definition">#</a></dt>
<dd><p>Return the list of the automorphisms of the quadratic form.</p>
<p>OUTPUT: a list of matrices</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">number_of_automorphisms</span><span class="p">()</span>
<span class="go">48</span>
<span class="gp">sage: </span><span class="mi">2</span><span class="o">^</span><span class="mi">3</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">48</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">automorphisms</span><span class="p">())</span>
<span class="go">48</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">number_of_automorphisms</span><span class="p">()</span>
<span class="go">16</span>
<span class="gp">sage: </span><span class="n">aut</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">automorphisms</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">aut</span><span class="p">)</span>
<span class="go">16</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">Q</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">==</span> <span class="n">Q</span> <span class="k">for</span> <span class="n">M</span> <span class="ow">in</span> <span class="n">aut</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">automorphisms</span><span class="p">())</span>
<span class="go">[</span>
<span class="go">[-1  0  0]  [1 0 0]</span>
<span class="go">[ 0 -1  0]  [0 1 0]</span>
<span class="go">[ 0  0 -1], [0 0 1]</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.base_change_to">
<span class="sig-name descname"><span class="pre">base_change_to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.base_change_to" title="Permalink to this definition">#</a></dt>
<dd><p>Deprecated: Use <a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.change_ring" title="sage.quadratic_forms.quadratic_form.QuadraticForm.change_ring"><code class="xref py py-func docutils literal notranslate"><span class="pre">change_ring()</span></code></a> instead.
See <a class="reference external" href="https://github.com/sagemath/sage/issues/35248">github issue #35248</a> for details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.base_ring">
<span class="sig-name descname"><span class="pre">base_ring</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.base_ring" title="Permalink to this definition">#</a></dt>
<dd><p>Return the ring over which the quadratic form is defined.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.basiclemma">
<span class="sig-name descname"><span class="pre">basiclemma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.basiclemma" title="Permalink to this definition">#</a></dt>
<dd><p>Find a number represented by self and coprime to <span class="math notranslate nohighlight">\(M\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">basiclemma</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="go">71</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.basiclemmavec">
<span class="sig-name descname"><span class="pre">basiclemmavec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.basiclemmavec" title="Permalink to this definition">#</a></dt>
<dd><p>Find a vector where the value of the quadratic form is coprime to <span class="math notranslate nohighlight">\(M\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">basiclemmavec</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">(6, 5)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">227</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.basis_of_short_vectors">
<span class="sig-name descname"><span class="pre">basis_of_short_vectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">show_lengths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.basis_of_short_vectors" title="Permalink to this definition">#</a></dt>
<dd><p>Return a basis for <span class="math notranslate nohighlight">\(\ZZ^n\)</span> made of vectors with minimal lengths <span class="math notranslate nohighlight">\(Q(v)\)</span>.</p>
<p>OUTPUT:</p>
<p>a tuple of vectors, and optionally a tuple of values for each vector.</p>
<p>This uses <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/qfminim">pari:qfminim</a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">basis_of_short_vectors</span><span class="p">()</span>
<span class="go">((1, 0, 0, 0), (0, 1, 0, 0), (0, 0, 1, 0), (0, 0, 0, 1))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">basis_of_short_vectors</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(((1, 0, 0, 0), (0, 1, 0, 0), (0, 0, 1, 0), (0, 0, 0, 1)), (1, 3, 5, 7))</span>
</pre></div>
</div>
<p>The returned vectors are immutable:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">basis_of_short_vectors</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">v</span>
<span class="go">(1, 0, 0, 0)</span>
<span class="gp">sage: </span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: vector is immutable; please change a copy instead (use copy())</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.bilinear_map">
<span class="sig-name descname"><span class="pre">bilinear_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.bilinear_map" title="Permalink to this definition">#</a></dt>
<dd><p>Return the value of the associated bilinear map on two vectors</p>
<p>Given a quadratic form <span class="math notranslate nohighlight">\(Q\)</span> over some base ring <span class="math notranslate nohighlight">\(R\)</span> with
characteristic not equal to 2, this gives the image of two
vectors with coefficients in <span class="math notranslate nohighlight">\(R\)</span> under the associated bilinear
map <span class="math notranslate nohighlight">\(B\)</span>, given by the relation <span class="math notranslate nohighlight">\(2 B(v,w) = Q(v) + Q(w) - Q(v+w)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code>, <code class="docutils literal notranslate"><span class="pre">w</span></code> – two vectors</p></li>
</ul>
<p>OUTPUT: an element of the base ring <span class="math notranslate nohighlight">\(R\)</span>.</p>
<p>EXAMPLES:</p>
<p>First, an example over <span class="math notranslate nohighlight">\(\ZZ\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">bilinear_map</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<span class="go">8</span>
</pre></div>
</div>
<p>This also works over <span class="math notranslate nohighlight">\(\QQ\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">bilinear_map</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<span class="go">19/4</span>
</pre></div>
</div>
<p>The vectors must have the correct length:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">bilinear_map</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: vectors must have length 3</span>
</pre></div>
</div>
<p>This does not work if the characteristic is 2:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>                             <span class="c1"># optional - sage.rings.finite_rings</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>                                                   <span class="c1"># optional - sage.rings.finite_rings</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>                                                   <span class="c1"># optional - sage.rings.finite_rings</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">bilinear_map</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>                                                  <span class="c1"># optional - sage.rings.finite_rings</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: not defined for rings of characteristic 2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.change_ring">
<span class="sig-name descname"><span class="pre">change_ring</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.change_ring" title="Permalink to this definition">#</a></dt>
<dd><p>Alters the quadratic form to have all coefficients
defined over the new base ring <span class="math notranslate nohighlight">\(R\)</span>.  Here <span class="math notranslate nohighlight">\(R\)</span> must be
coercible to from the current base ring.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is preferable to performing an explicit
coercion through the <a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.base_ring" title="sage.quadratic_forms.quadratic_form.QuadraticForm.base_ring"><code class="xref py py-meth docutils literal notranslate"><span class="pre">base_ring()</span></code></a> method, which does
not affect the individual coefficients.  This is
particularly useful for performing fast modular
arithmetic evaluations.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">R</span></code> – a ring</p></li>
</ul>
<p>OUTPUT: quadratic form</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span> <span class="n">Q</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 ]</span>
<span class="go">[ * 1 ]</span>

<span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">IntegerModRing</span><span class="p">(</span><span class="mi">5</span><span class="p">));</span> <span class="n">Q1</span>
<span class="go">Quadratic form in 2 variables over Ring of integers modulo 5 with coefficients:</span>
<span class="go">[ 1 0 ]</span>
<span class="go">[ * 1 ]</span>

<span class="gp">sage: </span><span class="n">Q1</span><span class="p">([</span><span class="mi">35</span><span class="p">,</span><span class="mi">11</span><span class="p">])</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.cholesky_decomposition">
<span class="sig-name descname"><span class="pre">cholesky_decomposition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bit_prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">53</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.cholesky_decomposition" title="Permalink to this definition">#</a></dt>
<dd><p>Give the Cholesky decomposition of this quadratic form <span class="math notranslate nohighlight">\(Q\)</span> as a real matrix
of precision <code class="docutils literal notranslate"><span class="pre">bit_prec</span></code>.</p>
<p>RESTRICTIONS:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(Q\)</span> must be given as a <a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm" title="sage.quadratic_forms.quadratic_form.QuadraticForm"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuadraticForm</span></code></a> defined over <span class="math notranslate nohighlight">\(\ZZ\)</span>, <span class="math notranslate nohighlight">\(\QQ\)</span>, or some
real field. If it is over some real field, then an error is raised if
the precision given is not less than the defined precision of the real
field defining the quadratic form!</p>
</div></blockquote>
<p>REFERENCE:</p>
<ul class="simple">
<li><p>Cohen’s “A Course in Computational Algebraic Number Theory” book, p 103.</p></li>
</ul>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bit_prec</span></code> – a natural number (default 53)</p></li>
</ul>
<p>OUTPUT: an upper triangular real matrix of precision <code class="docutils literal notranslate"><span class="pre">bit_prec</span></code>.</p>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>If we only care about working over the real double field (<code class="docutils literal notranslate"><span class="pre">RDF</span></code>), then we
can use the method <code class="xref py py-meth docutils literal notranslate"><span class="pre">cholesky()</span></code> present for square matrices over that.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is a note in the original code reading</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">Finds the Cholesky decomposition of a quadratic form -- as an upper-triangular matrix!</span>
<span class="go">(It&#39;s assumed to be global, hence twice the form it refers to.)  &lt;-- Python revision asks:  Is this true?!? =|</span>
</pre></div>
</div>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">cholesky_decomposition</span><span class="p">()</span>
<span class="go">[ 1.00000000000000 0.000000000000000 0.000000000000000]</span>
<span class="go">[0.000000000000000  1.00000000000000 0.000000000000000]</span>
<span class="go">[0.000000000000000 0.000000000000000  1.00000000000000]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">));</span> <span class="n">Q</span>
<span class="go">Quadratic form in 3 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 2 3 ]</span>
<span class="go">[ * 4 5 ]</span>
<span class="go">[ * * 6 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">cholesky_decomposition</span><span class="p">()</span>
<span class="go">[ 1.00000000000000  1.00000000000000  1.50000000000000]</span>
<span class="go">[0.000000000000000  3.00000000000000 0.333333333333333]</span>
<span class="go">[0.000000000000000 0.000000000000000  3.41666666666667]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.clifford_conductor">
<span class="sig-name descname"><span class="pre">clifford_conductor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.clifford_conductor" title="Permalink to this definition">#</a></dt>
<dd><p>This is the product of all primes where the Clifford invariant is <span class="math notranslate nohighlight">\(-1\)</span></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For ternary forms, this is the discriminant of the
quaternion algebra associated to the quadratic space
(i.e. the even Clifford algebra).</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">clifford_invariant</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>                                               <span class="c1"># optional - sage.libs.pari</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">clifford_invariant</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>                                              <span class="c1"># optional - sage.libs.pari</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">clifford_conductor</span><span class="p">()</span>                                                <span class="c1"># optional - sage.libs.pari</span>
<span class="go">37</span>

<span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">clifford_conductor</span><span class="p">()</span>             <span class="c1"># optional - sage.libs.pari</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">clifford_conductor</span><span class="p">()</span>        <span class="c1"># optional - sage.libs.pari</span>
<span class="go">30</span>
</pre></div>
</div>
<p>For hyperbolic spaces, the Clifford conductor is 1:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">clifford_conductor</span><span class="p">()</span>                                                <span class="c1"># optional - sage.libs.pari</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">H</span> <span class="o">+</span> <span class="n">H</span><span class="p">)</span><span class="o">.</span><span class="n">clifford_conductor</span><span class="p">()</span>                                          <span class="c1"># optional - sage.libs.pari</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">H</span> <span class="o">+</span> <span class="n">H</span> <span class="o">+</span> <span class="n">H</span><span class="p">)</span><span class="o">.</span><span class="n">clifford_conductor</span><span class="p">()</span>                                      <span class="c1"># optional - sage.libs.pari</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">H</span> <span class="o">+</span> <span class="n">H</span> <span class="o">+</span> <span class="n">H</span> <span class="o">+</span> <span class="n">H</span><span class="p">)</span><span class="o">.</span><span class="n">clifford_conductor</span><span class="p">()</span>                                  <span class="c1"># optional - sage.libs.pari</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.clifford_invariant">
<span class="sig-name descname"><span class="pre">clifford_invariant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.clifford_invariant" title="Permalink to this definition">#</a></dt>
<dd><p>This is the Clifford invariant, i.e. the class in the Brauer group of the
Clifford algebra for even dimension, of the even Clifford Algebra for odd dimension.</p>
<p>See Lam (AMS GSM 67) p. 117 for the definition, and p. 119 for the formula
relating it to the Hasse invariant.</p>
<p>EXAMPLES:</p>
<p>For hyperbolic spaces, the Clifford invariant is +1:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">clifford_invariant</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>                                               <span class="c1"># optional - sage.libs.pari</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">H</span> <span class="o">+</span> <span class="n">H</span><span class="p">)</span><span class="o">.</span><span class="n">clifford_invariant</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>                                         <span class="c1"># optional - sage.libs.pari</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">H</span> <span class="o">+</span> <span class="n">H</span> <span class="o">+</span> <span class="n">H</span><span class="p">)</span><span class="o">.</span><span class="n">clifford_invariant</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>                                     <span class="c1"># optional - sage.libs.pari</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">H</span> <span class="o">+</span> <span class="n">H</span> <span class="o">+</span> <span class="n">H</span> <span class="o">+</span> <span class="n">H</span><span class="p">)</span><span class="o">.</span><span class="n">clifford_invariant</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>                                 <span class="c1"># optional - sage.libs.pari</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.coefficients">
<span class="sig-name descname"><span class="pre">coefficients</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.coefficients" title="Permalink to this definition">#</a></dt>
<dd><p>Return the matrix of upper triangular coefficients,
by reading across the rows from the main diagonal.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">coefficients</span><span class="p">()</span>
<span class="go">[1, 2, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.complementary_subform_to_vector">
<span class="sig-name descname"><span class="pre">complementary_subform_to_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.complementary_subform_to_vector" title="Permalink to this definition">#</a></dt>
<dd><p>Find the <span class="math notranslate nohighlight">\((n-1)\)</span>-dimensional quadratic form orthogonal to the vector <span class="math notranslate nohighlight">\(v\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is usually not a direct summand!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is a minor difference in the cancellation
code here (form the C++ version) since the notation <code class="docutils literal notranslate"><span class="pre">Q[i,j]</span></code> indexes
coefficients of the quadratic polynomial here, not the symmetric
matrix.  Also, it produces a better splitting now, for the full
lattice (as opposed to a sublattice in the C++ code) since we
now extend <span class="math notranslate nohighlight">\(v\)</span> to a unimodular matrix.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code> – a list of <code class="docutils literal notranslate"><span class="pre">self.dim()</span></code> integers</p></li>
</ul>
<p>OUTPUT: a <a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm" title="sage.quadratic_forms.quadratic_form.QuadraticForm"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuadraticForm</span></code></a> over <span class="math notranslate nohighlight">\(\ZZ\)</span></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">complementary_subform_to_vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 7 0 0 ]</span>
<span class="go">[ * 5 0 ]</span>
<span class="go">[ * * 3 ]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">complementary_subform_to_vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 7 0 0 ]</span>
<span class="go">[ * 5 0 ]</span>
<span class="go">[ * * 12 ]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">complementary_subform_to_vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 880 -480 -160 ]</span>
<span class="go">[ * 624 -96 ]</span>
<span class="go">[ * * 240 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.compute_definiteness">
<span class="sig-name descname"><span class="pre">compute_definiteness</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.compute_definiteness" title="Permalink to this definition">#</a></dt>
<dd><p>Compute whether the given quadratic form is positive-definite,
negative-definite, indefinite, degenerate, or the zero form.</p>
<p>This caches one of the following strings in <code class="docutils literal notranslate"><span class="pre">self.__definiteness_string</span></code>:
“pos_def”, “neg_def”, “indef”, “zero”, “degenerate”.  It is called
from all routines like: <a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_positive_definite" title="sage.quadratic_forms.quadratic_form.QuadraticForm.is_positive_definite"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_positive_definite()</span></code></a>, <a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_negative_definite" title="sage.quadratic_forms.quadratic_form.QuadraticForm.is_negative_definite"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_negative_definite()</span></code></a>,
<a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_indefinite" title="sage.quadratic_forms.quadratic_form.QuadraticForm.is_indefinite"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_indefinite()</span></code></a>, etc.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A degenerate form is considered neither definite nor indefinite.</p>
</div>
<p>OUTPUT: boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">compute_definiteness</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_positive_definite</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_negative_definite</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_indefinite</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_definite</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">compute_definiteness</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_positive_definite</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_negative_definite</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_indefinite</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_definite</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">compute_definiteness</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_positive_definite</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_negative_definite</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_indefinite</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_definite</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.compute_definiteness_string_by_determinants">
<span class="sig-name descname"><span class="pre">compute_definiteness_string_by_determinants</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.compute_definiteness_string_by_determinants" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the (positive) definiteness of a quadratic form by looking
at the signs of all of its upper-left subdeterminants.  See also
<a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.compute_definiteness" title="sage.quadratic_forms.quadratic_form.QuadraticForm.compute_definiteness"><code class="xref py py-meth docutils literal notranslate"><span class="pre">compute_definiteness()</span></code></a> for more documentation.</p>
<p>OUTPUT: string describing the definiteness</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">compute_definiteness_string_by_determinants</span><span class="p">()</span>
<span class="go">&#39;pos_def&#39;</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">compute_definiteness_string_by_determinants</span><span class="p">()</span>
<span class="go">&#39;zero&#39;</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">compute_definiteness_string_by_determinants</span><span class="p">()</span>
<span class="go">&#39;degenerate&#39;</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">compute_definiteness_string_by_determinants</span><span class="p">()</span>
<span class="go">&#39;indefinite&#39;</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">compute_definiteness_string_by_determinants</span><span class="p">()</span>
<span class="go">&#39;neg_def&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.content">
<span class="sig-name descname"><span class="pre">content</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.content" title="Permalink to this definition">#</a></dt>
<dd><p>Return the GCD of the coefficients of the quadratic form.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Only works over Euclidean domains (probably just <span class="math notranslate nohighlight">\(\ZZ\)</span>).</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span><span class="o">.</span><span class="n">gcd</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">content</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">primitive</span><span class="p">()</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 ]</span>
<span class="go">[ * 2 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.conway_cross_product_doubled_power">
<span class="sig-name descname"><span class="pre">conway_cross_product_doubled_power</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_cross_product_doubled_power" title="Permalink to this definition">#</a></dt>
<dd><p>Compute twice the power of <span class="math notranslate nohighlight">\(p\)</span> which evaluates the ‘cross product’
term in Conway’s mass formula.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number &gt; 0</p></li>
</ul>
<p>OUTPUT: a rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_cross_product_doubled_power</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">18</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_cross_product_doubled_power</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_cross_product_doubled_power</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_cross_product_doubled_power</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_cross_product_doubled_power</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_cross_product_doubled_power</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.conway_diagonal_factor">
<span class="sig-name descname"><span class="pre">conway_diagonal_factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_diagonal_factor" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the diagonal factor of Conway’s <span class="math notranslate nohighlight">\(p\)</span>-mass.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number &gt; 0</p></li>
</ul>
<p>OUTPUT: a rational number &gt; 0</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_diagonal_factor</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">81/256</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.conway_mass">
<span class="sig-name descname"><span class="pre">conway_mass</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_mass" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the mass by using the Conway-Sloane mass formula.</p>
<p>OUTPUT: a rational number &gt; 0</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_mass</span><span class="p">()</span>                                                       <span class="c1"># optional - sage.symbolic</span>
<span class="go">1/48</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_mass</span><span class="p">()</span>                                                       <span class="c1"># optional - sage.symbolic</span>
<span class="go">3/16</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_mass</span><span class="p">()</span>                                                       <span class="c1"># optional - sage.symbolic</span>
<span class="go">3/32</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_mass</span><span class="p">()</span>                                                       <span class="c1"># optional - sage.symbolic</span>
<span class="go">1/12</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.conway_octane_of_this_unimodular_Jordan_block_at_2">
<span class="sig-name descname"><span class="pre">conway_octane_of_this_unimodular_Jordan_block_at_2</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_octane_of_this_unimodular_Jordan_block_at_2" title="Permalink to this definition">#</a></dt>
<dd><p>Determines the ‘octane’ of this full unimodular Jordan block at
the prime <span class="math notranslate nohighlight">\(p=2\)</span>.  This is an invariant defined (mod 8), ad.</p>
<p>This assumes that the form is given as a block diagonal form with
unimodular blocks of size <span class="math notranslate nohighlight">\(\leq 2\)</span> and the <span class="math notranslate nohighlight">\(1 \times 1\)</span> blocks are all in the upper
leftmost position.</p>
<p>OUTPUT: an integer <span class="math notranslate nohighlight">\(0 \leq x \leq 7\)</span></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_octane_of_this_unimodular_Jordan_block_at_2</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">13</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_octane_of_this_unimodular_Jordan_block_at_2</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">13</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_octane_of_this_unimodular_Jordan_block_at_2</span><span class="p">()</span>
<span class="go">7</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.conway_p_mass">
<span class="sig-name descname"><span class="pre">conway_p_mass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_p_mass" title="Permalink to this definition">#</a></dt>
<dd><p>Compute Conway’s <span class="math notranslate nohighlight">\(p\)</span>-mass.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number &gt; 0</p></li>
</ul>
<p>OUTPUT: a rational number &gt; 0</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_p_mass</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">16/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_p_mass</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">729/256</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.conway_species_list_at_2">
<span class="sig-name descname"><span class="pre">conway_species_list_at_2</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_species_list_at_2" title="Permalink to this definition">#</a></dt>
<dd><p>Return an integer called the ‘species’ which determines the type
of the orthogonal group over the finite field <span class="math notranslate nohighlight">\(\GF{p}\)</span>.</p>
<p>This assumes that the given quadratic form is a unimodular Jordan
block at an odd prime <span class="math notranslate nohighlight">\(p\)</span>.  When the dimension is odd then this
number is always positive, otherwise it may be positive or
negative.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The species of a zero dimensional form is always 0+, so we
interpret the return value of zero as positive here! =)</p>
</div>
<p>OUTPUT: a list of integers</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_species_list_at_2</span><span class="p">()</span>
<span class="go">[1, 5, 1, 1, 1, 1]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_species_list_at_2</span><span class="p">()</span>
<span class="go">[1, 3, 1, 1, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.conway_species_list_at_odd_prime">
<span class="sig-name descname"><span class="pre">conway_species_list_at_odd_prime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_species_list_at_odd_prime" title="Permalink to this definition">#</a></dt>
<dd><p>Return an integer called the ‘species’ which determines the type
of the orthogonal group over the finite field <span class="math notranslate nohighlight">\(\GF{p}\)</span>.</p>
<p>This assumes that the given quadratic form is a unimodular Jordan
block at an odd prime <span class="math notranslate nohighlight">\(p\)</span>.  When the dimension is odd then this
number is always positive, otherwise it may be positive or
negative (or zero, but that is considered positive by convention).</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a positive prime number</p></li>
</ul>
<p>OUTPUT: a list of integers</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_species_list_at_odd_prime</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[6, 2, 1]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_species_list_at_odd_prime</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[5, 2]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_species_list_at_odd_prime</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[-6, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.conway_standard_mass">
<span class="sig-name descname"><span class="pre">conway_standard_mass</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_standard_mass" title="Permalink to this definition">#</a></dt>
<dd><p>Return the infinite product of the standard mass factors.</p>
<p>OUTPUT: a rational number &gt; 0</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_standard_mass</span><span class="p">()</span>                                              <span class="c1"># optional - sage.symbolic</span>
<span class="go">1/6</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_standard_mass</span><span class="p">()</span>                                              <span class="c1"># optional - sage.symbolic</span>
<span class="go">1/6</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.conway_standard_p_mass">
<span class="sig-name descname"><span class="pre">conway_standard_p_mass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_standard_p_mass" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the standard (generic) Conway-Sloane <span class="math notranslate nohighlight">\(p\)</span>-mass.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number &gt; 0</p></li>
</ul>
<p>OUTPUT: a rational number &gt; 0</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_standard_p_mass</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">2/3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.conway_type_factor">
<span class="sig-name descname"><span class="pre">conway_type_factor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_type_factor" title="Permalink to this definition">#</a></dt>
<dd><p>This is a special factor only present in the mass formula when <span class="math notranslate nohighlight">\(p=2\)</span>.</p>
<p>OUTPUT: a rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_type_factor</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions">
<span class="sig-name descname"><span class="pre">count_congruence_solutions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nzvec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions" title="Permalink to this definition">#</a></dt>
<dd><p>Count all solutions of <span class="math notranslate nohighlight">\(Q(x) = m\)</span> (mod <span class="math notranslate nohighlight">\(p^k\)</span>) satisfying the
additional congruence conditions described in
<a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions_as_vector" title="sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions_as_vector"><code class="xref py py-meth docutils literal notranslate"><span class="pre">QuadraticForm.count_congruence_solutions_as_vector()</span></code></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – prime number &gt; 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">k</span></code> – an integer &gt; 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> – an integer (depending only on mod <span class="math notranslate nohighlight">\(p^k\)</span>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">zvec</span></code>, <code class="docutils literal notranslate"><span class="pre">nzvec</span></code> – lists of integers in <code class="docutils literal notranslate"><span class="pre">range(self.dim())</span></code>, or <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">15</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__bad_type">
<span class="sig-name descname"><span class="pre">count_congruence_solutions__bad_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nzvec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__bad_type" title="Permalink to this definition">#</a></dt>
<dd><p>Count the bad-type solutions of <span class="math notranslate nohighlight">\(Q(x) = m\)</span> (mod <span class="math notranslate nohighlight">\(p^k\)</span>) satisfying the
additional congruence conditions described in
<a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions_as_vector" title="sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions_as_vector"><code class="xref py py-meth docutils literal notranslate"><span class="pre">QuadraticForm.count_congruence_solutions_as_vector()</span></code></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – prime number &gt; 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">k</span></code> – an integer &gt; 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> – an integer (depending only on mod <span class="math notranslate nohighlight">\(p^k\)</span>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">zvec</span></code>, <code class="docutils literal notranslate"><span class="pre">nzvec</span></code> – lists of integers up to dim(<span class="math notranslate nohighlight">\(Q\)</span>)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions__bad_type</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__bad_type_I">
<span class="sig-name descname"><span class="pre">count_congruence_solutions__bad_type_I</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nzvec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__bad_type_I" title="Permalink to this definition">#</a></dt>
<dd><p>Count the bad-typeI solutions of <span class="math notranslate nohighlight">\(Q(x) = m\)</span> (mod <span class="math notranslate nohighlight">\(p^k\)</span>) satisfying
the additional congruence conditions described in
<a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions_as_vector" title="sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions_as_vector"><code class="xref py py-meth docutils literal notranslate"><span class="pre">QuadraticForm.count_congruence_solutions_as_vector()</span></code></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – prime number &gt; 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">k</span></code> – an integer &gt; 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> – an integer (depending only on mod <span class="math notranslate nohighlight">\(p^k\)</span>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">zvec</span></code>, <code class="docutils literal notranslate"><span class="pre">nzvec</span></code> – lists of integers up to dim(<span class="math notranslate nohighlight">\(Q\)</span>)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions__bad_type_I</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__bad_type_II">
<span class="sig-name descname"><span class="pre">count_congruence_solutions__bad_type_II</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nzvec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__bad_type_II" title="Permalink to this definition">#</a></dt>
<dd><p>Count the bad-typeII solutions of <span class="math notranslate nohighlight">\(Q(x) = m\)</span> (mod <span class="math notranslate nohighlight">\(p^k\)</span>) satisfying
the additional congruence conditions described in
<a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions_as_vector" title="sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions_as_vector"><code class="xref py py-meth docutils literal notranslate"><span class="pre">QuadraticForm.count_congruence_solutions_as_vector()</span></code></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – prime number &gt; 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">k</span></code> – an integer &gt; 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> – an integer (depending only on mod <span class="math notranslate nohighlight">\(p^k\)</span>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">zvec</span></code>, <code class="docutils literal notranslate"><span class="pre">nzvec</span></code> – lists of integers up to dim(<span class="math notranslate nohighlight">\(Q\)</span>)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions__bad_type_II</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__good_type">
<span class="sig-name descname"><span class="pre">count_congruence_solutions__good_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nzvec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__good_type" title="Permalink to this definition">#</a></dt>
<dd><p>Count the good-type solutions of <span class="math notranslate nohighlight">\(Q(x) = m\)</span> (mod <span class="math notranslate nohighlight">\(p^k\)</span>) satisfying the
additional congruence conditions described in
<a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions_as_vector" title="sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions_as_vector"><code class="xref py py-meth docutils literal notranslate"><span class="pre">QuadraticForm.count_congruence_solutions_as_vector()</span></code></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – prime number &gt; 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">k</span></code> – an integer &gt; 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> – an integer (depending only on mod <span class="math notranslate nohighlight">\(p^k\)</span>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">zvec</span></code>, <code class="docutils literal notranslate"><span class="pre">nzvec</span></code> – lists of integers up to dim(<span class="math notranslate nohighlight">\(Q\)</span>)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions__good_type</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">12</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__zero_type">
<span class="sig-name descname"><span class="pre">count_congruence_solutions__zero_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nzvec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__zero_type" title="Permalink to this definition">#</a></dt>
<dd><p>Count the zero-type solutions of <span class="math notranslate nohighlight">\(Q(x) = m\)</span> (mod <span class="math notranslate nohighlight">\(p^k\)</span>) satisfying the
additional congruence conditions described in
<a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions_as_vector" title="sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions_as_vector"><code class="xref py py-meth docutils literal notranslate"><span class="pre">QuadraticForm.count_congruence_solutions_as_vector()</span></code></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – prime number &gt; 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">k</span></code> – an integer &gt; 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> – an integer (depending only on mod <span class="math notranslate nohighlight">\(p^k\)</span>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">zvec</span></code>, <code class="docutils literal notranslate"><span class="pre">nzvec</span></code> – lists of integers up to dim(<span class="math notranslate nohighlight">\(Q\)</span>)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions__zero_type</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions_as_vector">
<span class="sig-name descname"><span class="pre">count_congruence_solutions_as_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nzvec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions_as_vector" title="Permalink to this definition">#</a></dt>
<dd><p>Return the number of integer solution vectors <span class="math notranslate nohighlight">\(x\)</span> satisfying the
congruence <span class="math notranslate nohighlight">\(Q(x) = m\)</span> (mod <span class="math notranslate nohighlight">\(p^k\)</span>) of each solution type (i.e. All,
Good, Zero, Bad, BadI, BadII) which satisfy the additional
congruence conditions of having certain coefficients = 0 (mod <span class="math notranslate nohighlight">\(p\)</span>)
and certain collections of coefficients not congruent to the zero
vector (mod <span class="math notranslate nohighlight">\(p\)</span>).</p>
<p>A solution vector <span class="math notranslate nohighlight">\(x\)</span> satisfies the additional congruence conditions
specified by <code class="docutils literal notranslate"><span class="pre">zvec</span></code> and <code class="docutils literal notranslate"><span class="pre">nzvec</span></code> (and therefore is counted) iff both of
the following conditions hold:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(x_i = 0\)</span> (mod <span class="math notranslate nohighlight">\(p\)</span>) for all <span class="math notranslate nohighlight">\(i\)</span> in <code class="docutils literal notranslate"><span class="pre">zvec</span></code></p></li>
<li><p><span class="math notranslate nohighlight">\(x_i \neq 0\)</span> (mod <span class="math notranslate nohighlight">\(p\)</span>) for all <span class="math notranslate nohighlight">\(i\)</span> in <code class="docutils literal notranslate"><span class="pre">nzvec</span></code></p></li>
</ol>
<p>REFERENCES:</p>
<p>See Hanke’s (????) paper “Local Densities and explicit bounds…”, p??? for
the definitions of the solution types and congruence conditions.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – prime number &gt; 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">k</span></code> – an integer &gt; 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> – an integer (depending only on mod <span class="math notranslate nohighlight">\(p^k\)</span>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">zvec</span></code>, <code class="docutils literal notranslate"><span class="pre">nzvec</span></code> – lists of integers in <code class="docutils literal notranslate"><span class="pre">range(self.dim())</span></code>, or <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
<p>OUTPUT:</p>
<p>a list of six integers <span class="math notranslate nohighlight">\(\geq 0\)</span> representing the solution types:
[All, Good, Zero, Bad, BadI, BadII]</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions_as_vector</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[])</span>
<span class="go">[0, 0, 0, 0, 0, 0]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions_as_vector</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">[])</span>
<span class="go">[0, 0, 0, 0, 0, 0]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions_as_vector</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[],</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">[6, 6, 0, 0, 0, 0]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions_as_vector</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">[6, 6, 0, 0, 0, 0]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions_as_vector</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">[6, 6, 0, 0, 0, 0]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions_as_vector</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">[15, 12, 1, 2, 0, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.count_modp_solutions__by_Gauss_sum">
<span class="sig-name descname"><span class="pre">count_modp_solutions__by_Gauss_sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_modp_solutions__by_Gauss_sum" title="Permalink to this definition">#</a></dt>
<dd><p>Return the number of solutions of <span class="math notranslate nohighlight">\(Q(x) = m\)</span> (mod <span class="math notranslate nohighlight">\(p\)</span>) of a
non-degenerate quadratic form over the finite field <span class="math notranslate nohighlight">\(\ZZ/p\ZZ\)</span>,
where <span class="math notranslate nohighlight">\(p\)</span> is a prime number &gt; 2.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We adopt the useful convention that a zero-dimensional
quadratic form has exactly one solution always (i.e. the empty
vector).</p>
</div>
<p>These are defined in Table 1 on p363 of Hanke’s “Local Densities…” paper.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number &gt; 2</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> – an integer</p></li>
</ul>
<p>OUTPUT: an integer <span class="math notranslate nohighlight">\(\geq 0\)</span></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">count_modp_solutions__by_Gauss_sum</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>  <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="go">[9, 6, 12]</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">count_modp_solutions__by_Gauss_sum</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>  <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="go">[9, 12, 6]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.delta">
<span class="sig-name descname"><span class="pre">delta</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.delta" title="Permalink to this definition">#</a></dt>
<dd><p>This is the omega of the adjoint form,
which is the same as the omega of the reciprocal form.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">37</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">delta</span><span class="p">()</span>
<span class="go">148</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.det">
<span class="sig-name descname"><span class="pre">det</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.det" title="Permalink to this definition">#</a></dt>
<dd><p>Return the determinant of the Gram matrix of <span class="math notranslate nohighlight">\(2\cdot Q\)</span>, or
equivalently the determinant of the Hessian matrix of <span class="math notranslate nohighlight">\(Q\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
<span class="go">8</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.dim">
<span class="sig-name descname"><span class="pre">dim</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.dim" title="Permalink to this definition">#</a></dt>
<dd><p>Return the number of variables of the quadratic form.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">dim</span><span class="p">())</span>
<span class="go">Integer Ring</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">matrix</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">dim</span><span class="p">())</span>
<span class="go">Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.disc">
<span class="sig-name descname"><span class="pre">disc</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.disc" title="Permalink to this definition">#</a></dt>
<dd><p>Return the discriminant of the quadratic form, defined as</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\((-1)^n {\rm det}(B)\)</span> for even dimension <span class="math notranslate nohighlight">\(2n\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\({\rm det}(B)/2\)</span> for odd dimension</p></li>
</ul>
<p>where <span class="math notranslate nohighlight">\(2Q(x) = x^t B x\)</span>.</p>
<p>This agrees with the usual discriminant for binary and ternary quadratic forms.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">disc</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">disc</span><span class="p">()</span>
<span class="go">-4</span>
<span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">disc</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">disc</span><span class="p">()</span>
<span class="go">16</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.discrec">
<span class="sig-name descname"><span class="pre">discrec</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.discrec" title="Permalink to this definition">#</a></dt>
<dd><p>Return the discriminant of the reciprocal form.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">37</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">disc</span><span class="p">()</span>
<span class="go">148</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">discrec</span><span class="p">()</span>
<span class="go">5476</span>
<span class="gp">sage: </span><span class="p">[</span><span class="mi">4</span> <span class="o">*</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">37</span><span class="o">^</span><span class="mi">2</span><span class="p">]</span>
<span class="go">[148, 5476]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.divide_variable">
<span class="sig-name descname"><span class="pre">divide_variable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_place</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.divide_variable" title="Permalink to this definition">#</a></dt>
<dd><p>Replace the variables <span class="math notranslate nohighlight">\(x_i\)</span> by <span class="math notranslate nohighlight">\((x_i)/c\)</span> in the quadratic form
(replacing the original form if the <code class="docutils literal notranslate"><span class="pre">in_place</span></code> flag is True).</p>
<p>Here <span class="math notranslate nohighlight">\(c\)</span> must be an element of the base ring defining the
quadratic form, and the division must be defined in the base
ring.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">c</span></code> – an element of <code class="docutils literal notranslate"><span class="pre">self.base_ring()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i</span></code> – an integer <span class="math notranslate nohighlight">\(\geq 0\)</span></p></li>
</ul>
<p>OUTPUT:</p>
<p>a <a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm" title="sage.quadratic_forms.quadratic_form.QuadraticForm"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuadraticForm</span></code></a> (by default, otherwise none)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">divide_variable</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 0 0 ]</span>
<span class="go">[ * 1 0 0 ]</span>
<span class="go">[ * * 5 0 ]</span>
<span class="go">[ * * * 7 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.elementary_substitution">
<span class="sig-name descname"><span class="pre">elementary_substitution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_place</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.elementary_substitution" title="Permalink to this definition">#</a></dt>
<dd><p>Perform the substitution <span class="math notranslate nohighlight">\(x_i \longmapsto x_i + c\cdot x_j\)</span> (replacing the
original form if the <code class="docutils literal notranslate"><span class="pre">in_place</span></code> flag is True).</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">c</span></code> – an element of <code class="docutils literal notranslate"><span class="pre">self.base_ring()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i</span></code>, <code class="docutils literal notranslate"><span class="pre">j</span></code> – integers <span class="math notranslate nohighlight">\(\geq 0\)</span></p></li>
</ul>
<p>OUTPUT:</p>
<p>a <a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm" title="sage.quadratic_forms.quadratic_form.QuadraticForm"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuadraticForm</span></code></a> (by default, otherwise none)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">));</span> <span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 2 3 4 ]</span>
<span class="go">[ * 5 6 7 ]</span>
<span class="go">[ * * 8 9 ]</span>
<span class="go">[ * * * 10 ]</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">elementary_substitution</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 2 3 6 ]</span>
<span class="go">[ * 5 6 9 ]</span>
<span class="go">[ * * 8 12 ]</span>
<span class="go">[ * * * 15 ]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">));</span> <span class="n">R</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 2 3 4 ]</span>
<span class="go">[ * 5 6 7 ]</span>
<span class="go">[ * * 8 9 ]</span>
<span class="go">[ * * * 10 ]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span> <span class="n">M</span>
<span class="go">[1 0 0 1]</span>
<span class="go">[0 1 0 0]</span>
<span class="go">[0 0 1 0]</span>
<span class="go">[0 0 0 1]</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 2 3 6 ]</span>
<span class="go">[ * 5 6 9 ]</span>
<span class="go">[ * * 8 12 ]</span>
<span class="go">[ * * * 15 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.extract_variables">
<span class="sig-name descname"><span class="pre">extract_variables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">QF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_indices</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.extract_variables" title="Permalink to this definition">#</a></dt>
<dd><p>Extract the variables (in order) whose indices are listed in
<code class="docutils literal notranslate"><span class="pre">var_indices</span></code>, to give a new quadratic form.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">var_indices</span></code> – a list of integers <span class="math notranslate nohighlight">\(\geq 0\)</span></p></li>
</ul>
<p>OUTPUT: a <a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm" title="sage.quadratic_forms.quadratic_form.QuadraticForm"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuadraticForm</span></code></a></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span> <span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 0 1 2 3 ]</span>
<span class="go">[ * 4 5 6 ]</span>
<span class="go">[ * * 7 8 ]</span>
<span class="go">[ * * * 9 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">extract_variables</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 4 6 ]</span>
<span class="go">[ * 9 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.find_entry_with_minimal_scale_at_prime">
<span class="sig-name descname"><span class="pre">find_entry_with_minimal_scale_at_prime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.find_entry_with_minimal_scale_at_prime" title="Permalink to this definition">#</a></dt>
<dd><p>Finds the entry of the quadratic form with minimal scale at the
prime <span class="math notranslate nohighlight">\(p\)</span>, preferring diagonal entries in case of a tie.  (I.e.  If
we write the quadratic form as a symmetric matrix <span class="math notranslate nohighlight">\(M\)</span>, then this
entry <code class="docutils literal notranslate"><span class="pre">M[i,j]</span></code> has the minimal valuation at the prime <span class="math notranslate nohighlight">\(p\)</span>.)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This answer is independent of the kind of matrix (Gram or
Hessian) associated to the form.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number &gt; 0</p></li>
</ul>
<p>OUTPUT: a pair of integers <span class="math notranslate nohighlight">\(\geq 0\)</span></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">]);</span> <span class="n">Q</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">  [ 6 2 ]</span>
<span class="go">  [ * 20 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">find_entry_with_minimal_scale_at_prime</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(0, 1)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">find_entry_with_minimal_scale_at_prime</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(1, 1)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">find_entry_with_minimal_scale_at_prime</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">(0, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.find_p_neighbor_from_vec">
<span class="sig-name descname"><span class="pre">find_p_neighbor_from_vec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.find_p_neighbor_from_vec" title="Permalink to this definition">#</a></dt>
<dd><p>Return the <span class="math notranslate nohighlight">\(p\)</span>-neighbor of <code class="docutils literal notranslate"><span class="pre">self</span></code> defined by <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
<p>Let <span class="math notranslate nohighlight">\((L,q)\)</span> be a lattice with <span class="math notranslate nohighlight">\(b(L,L) \subseteq \ZZ\)</span> which is maximal at <span class="math notranslate nohighlight">\(p\)</span>.
Let <span class="math notranslate nohighlight">\(y \in L\)</span> with <span class="math notranslate nohighlight">\(b(y,y) \in p^2\ZZ\)</span> then the <span class="math notranslate nohighlight">\(p\)</span>-neighbor of
<span class="math notranslate nohighlight">\(L\)</span> at <span class="math notranslate nohighlight">\(y\)</span> is given by
<span class="math notranslate nohighlight">\(\ZZ y/p + L_y\)</span> where <span class="math notranslate nohighlight">\(L_y = \{x \in L | b(x,y) \in p \ZZ \}\)</span>
and <span class="math notranslate nohighlight">\(b(x,y) = q(x+y)-q(x)-q(y)\)</span> is the bilinear form associated to <span class="math notranslate nohighlight">\(q\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code> – a vector with <span class="math notranslate nohighlight">\(q(y) \in p \ZZ\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">odd</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) if <span class="math notranslate nohighlight">\(p=2\)</span>, return also odd neighbors</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">find_p_neighbor_from_vec</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span> <span class="n">X</span>                               <span class="c1"># optional - sage.libs.pari</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 0 0 ]</span>
<span class="go">[ * 1 4 4 ]</span>
<span class="go">[ * * 5 12 ]</span>
<span class="go">[ * * * 9 ]</span>
</pre></div>
</div>
<p>Since the base ring and the domain are not yet separate,
for rational, half integral forms we just pretend
the base ring is <span class="math notranslate nohighlight">\(\ZZ\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="n">matrix</span><span class="o">.</span><span class="n">diagonal</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">find_p_neighbor_from_vec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>                                      <span class="c1"># optional - sage.libs.pari</span>
<span class="go">Quadratic form in 4 variables over Rational Field with coefficients:</span>
<span class="go">[ 1/2 1 1 1 ]</span>
<span class="go">[ * 1 1 2 ]</span>
<span class="go">[ * * 1 2 ]</span>
<span class="go">[ * * * 2 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.find_primitive_p_divisible_vector__next">
<span class="sig-name descname"><span class="pre">find_primitive_p_divisible_vector__next</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.find_primitive_p_divisible_vector__next" title="Permalink to this definition">#</a></dt>
<dd><p>Find the next <span class="math notranslate nohighlight">\(p\)</span>-primitive vector (up to scaling) in <span class="math notranslate nohighlight">\(L/pL\)</span> whose
value is <span class="math notranslate nohighlight">\(p\)</span>-divisible, where the last vector returned was <span class="math notranslate nohighlight">\(v\)</span>.  For
an initial call, no <span class="math notranslate nohighlight">\(v\)</span> needs to be passed.</p>
<p>Return vectors whose last non-zero entry is normalized to 0 or 1 (so no
lines are counted repeatedly).  The ordering is by increasing the
first non-normalized entry.  If we have tested all (lines of)
vectors, then return None.</p>
<p>OUTPUT: vector or None</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">find_primitive_p_divisible_vector__next</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span> <span class="n">v</span>
<span class="go">(1, 1)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">find_primitive_p_divisible_vector__next</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span> <span class="n">v</span>
<span class="go">(1, 0)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">find_primitive_p_divisible_vector__next</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span> <span class="n">v</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="n">matrix</span><span class="o">.</span><span class="n">diagonal</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">find_primitive_p_divisible_vector__next</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.find_primitive_p_divisible_vector__random">
<span class="sig-name descname"><span class="pre">find_primitive_p_divisible_vector__random</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.find_primitive_p_divisible_vector__random" title="Permalink to this definition">#</a></dt>
<dd><p>Find a random <span class="math notranslate nohighlight">\(p\)</span>-primitive vector in <span class="math notranslate nohighlight">\(L/pL\)</span> whose value is <span class="math notranslate nohighlight">\(p\)</span>-divisible.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since there are about <span class="math notranslate nohighlight">\(p^{(n-2)}\)</span> of these lines, we have a <span class="math notranslate nohighlight">\(1/p\)</span>
chance of randomly finding an appropriate vector.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">find_primitive_p_divisible_vector__random</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="mf">5.</span><span class="n">divides</span><span class="p">(</span><span class="n">Q</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="n">matrix</span><span class="o">.</span><span class="n">diagonal</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">find_primitive_p_divisible_vector__random</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.from_polynomial">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_polynomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">poly</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.from_polynomial" title="Permalink to this definition">#</a></dt>
<dd><p>Construct a <a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm" title="sage.quadratic_forms.quadratic_form.QuadraticForm"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuadraticForm</span></code></a> from a multivariate
polynomial. Inverse of <a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.polynomial" title="sage.quadratic_forms.quadratic_form.QuadraticForm.polynomial"><code class="xref py py-meth docutils literal notranslate"><span class="pre">polynomial()</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">z</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">9</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="o">.</span><span class="n">from_polynomial</span><span class="p">(</span><span class="n">f</span><span class="p">);</span> <span class="n">Q</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 5 0 -1 ]</span>
<span class="go">[ * -2 -3 ]</span>
<span class="go">[ * * 9 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">polynomial</span><span class="p">()</span>
<span class="go">5*x0^2 - 2*x1^2 - x0*x2 - 3*x1*x2 + 9*x2^2</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">polynomial</span><span class="p">()(</span><span class="n">R</span><span class="o">.</span><span class="n">gens</span><span class="p">())</span> <span class="o">==</span> <span class="n">f</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The method fails if the given polynomial is not a quadratic form:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuadraticForm</span><span class="o">.</span><span class="n">from_polynomial</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: polynomial has monomials of degree != 2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.gcd">
<span class="sig-name descname"><span class="pre">gcd</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.gcd" title="Permalink to this definition">#</a></dt>
<dd><p>Return the greatest common divisor of the coefficients of the
quadratic form (as a polynomial).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">gcd</span><span class="p">()</span>
<span class="go">1</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">gcd</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.genera">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">genera</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sig_pair</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">determinant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">even</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.genera" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list of all global genera with the given conditions.</p>
<p>Here a genus is called global if it is non-empty.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sig_pair</span></code> – a pair of non-negative integers giving the signature</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">determinant</span></code> – an integer; the sign is ignored</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_scale</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) an integer; the maximum scale of a
jordan block</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">even</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p></li>
</ul>
<p>OUTPUT:</p>
<p>A list of all (non-empty) global genera with the given conditions.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuadraticForm</span><span class="o">.</span><span class="n">genera</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="mi">125</span><span class="p">,</span> <span class="n">even</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[Genus of</span>
<span class="go">None</span>
<span class="go">Signature:  (4, 0)</span>
<span class="go">Genus symbol at 2:    1^-4</span>
<span class="go">Genus symbol at 5:     1^1 5^3, Genus of</span>
<span class="go">None</span>
<span class="go">Signature:  (4, 0)</span>
<span class="go">Genus symbol at 2:    1^-4</span>
<span class="go">Genus symbol at 5:     1^-2 5^1 25^-1, Genus of</span>
<span class="go">None</span>
<span class="go">Signature:  (4, 0)</span>
<span class="go">Genus symbol at 2:    1^-4</span>
<span class="go">Genus symbol at 5:     1^2 5^1 25^1, Genus of</span>
<span class="go">None</span>
<span class="go">Signature:  (4, 0)</span>
<span class="go">Genus symbol at 2:    1^-4</span>
<span class="go">Genus symbol at 5:     1^3 125^1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.global_genus_symbol">
<span class="sig-name descname"><span class="pre">global_genus_symbol</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.global_genus_symbol" title="Permalink to this definition">#</a></dt>
<dd><p>Return the genus of two times a quadratic form over <span class="math notranslate nohighlight">\(\ZZ\)</span>.</p>
<p>These are defined by a collection of local genus symbols (a la
Chapter 15 of Conway-Sloane <a class="reference internal" href="../../../references/index.html#cs1999" id="id2"><span>[CS1999]</span></a>), and a signature.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">global_genus_symbol</span><span class="p">()</span>
<span class="go">Genus of</span>
<span class="go">[2 0 0 0]</span>
<span class="go">[0 4 0 0]</span>
<span class="go">[0 0 6 0]</span>
<span class="go">[0 0 0 8]</span>
<span class="go">Signature:  (4, 0)</span>
<span class="go">Genus symbol at 2:    [2^-2 4^1 8^1]_6</span>
<span class="go">Genus symbol at 3:     1^3 3^-1</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">global_genus_symbol</span><span class="p">()</span>
<span class="go">Genus of</span>
<span class="go">[ 0  1  2  3]</span>
<span class="go">[ 1  8  5  6]</span>
<span class="go">[ 2  5 14  8]</span>
<span class="go">[ 3  6  8 18]</span>
<span class="go">Signature:  (3, 1)</span>
<span class="go">Genus symbol at 2:    1^-4</span>
<span class="go">Genus symbol at 563:     1^3 563^-1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.has_equivalent_Jordan_decomposition_at_prime">
<span class="sig-name descname"><span class="pre">has_equivalent_Jordan_decomposition_at_prime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.has_equivalent_Jordan_decomposition_at_prime" title="Permalink to this definition">#</a></dt>
<dd><p>Determine if the given quadratic form has a Jordan decomposition
equivalent to that of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> – a <a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm" title="sage.quadratic_forms.quadratic_form.QuadraticForm"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuadraticForm</span></code></a></p></li>
</ul>
<p>OUTPUT: boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q3</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q1</span><span class="o">.</span><span class="n">level</span><span class="p">(),</span> <span class="n">Q2</span><span class="o">.</span><span class="n">level</span><span class="p">(),</span> <span class="n">Q3</span><span class="o">.</span><span class="n">level</span><span class="p">()]</span>
<span class="go">[44, 44, 44]</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">has_equivalent_Jordan_decomposition_at_prime</span><span class="p">(</span><span class="n">Q2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>                <span class="c1"># optional - sage.libs.pari</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">has_equivalent_Jordan_decomposition_at_prime</span><span class="p">(</span><span class="n">Q2</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>               <span class="c1"># optional - sage.libs.pari</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">has_equivalent_Jordan_decomposition_at_prime</span><span class="p">(</span><span class="n">Q3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>                <span class="c1"># optional - sage.libs.pari</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">has_equivalent_Jordan_decomposition_at_prime</span><span class="p">(</span><span class="n">Q3</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>               <span class="c1"># optional - sage.libs.pari</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q2</span><span class="o">.</span><span class="n">has_equivalent_Jordan_decomposition_at_prime</span><span class="p">(</span><span class="n">Q3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>                <span class="c1"># optional - sage.libs.pari</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q2</span><span class="o">.</span><span class="n">has_equivalent_Jordan_decomposition_at_prime</span><span class="p">(</span><span class="n">Q3</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>               <span class="c1"># optional - sage.libs.pari</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.has_integral_Gram_matrix">
<span class="sig-name descname"><span class="pre">has_integral_Gram_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.has_integral_Gram_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Return whether the quadratic form has an integral Gram matrix (with respect to its base ring).</p>
<p>A warning is issued if the form is defined over a field, since in that case the return is trivially true.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">has_integral_Gram_matrix</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">has_integral_Gram_matrix</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.hasse_conductor">
<span class="sig-name descname"><span class="pre">hasse_conductor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.hasse_conductor" title="Permalink to this definition">#</a></dt>
<dd><p>This is the product of all primes where the Hasse invariant equals <span class="math notranslate nohighlight">\(-1\)</span></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>                                                  <span class="c1"># optional - sage.libs.pari</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>                                                 <span class="c1"># optional - sage.libs.pari</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_conductor</span><span class="p">()</span>                                                   <span class="c1"># optional - sage.libs.pari</span>
<span class="go">74</span>

<span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">hasse_conductor</span><span class="p">()</span>                <span class="c1"># optional - sage.libs.pari</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">hasse_conductor</span><span class="p">()</span>           <span class="c1"># optional - sage.libs.pari</span>
<span class="go">10</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.hasse_invariant">
<span class="sig-name descname"><span class="pre">hasse_invariant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.hasse_invariant" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the Hasse invariant at a prime <span class="math notranslate nohighlight">\(p\)</span> or at infinity, as given on p55 of
Cassels’s book.  If <span class="math notranslate nohighlight">\(Q\)</span> is diagonal with coefficients <span class="math notranslate nohighlight">\(a_i\)</span>, then the
(Cassels) Hasse invariant is given by</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[c_p = \prod_{i &lt; j} (a_i, a_j)_p\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\((a,b)_p\)</span> is the Hilbert symbol at <span class="math notranslate nohighlight">\(p\)</span>.  The underlying
quadratic form must be non-degenerate over <span class="math notranslate nohighlight">\(\QQ_p\)</span> for this to make
sense.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is different from the O’Meara Hasse invariant, which
allows <span class="math notranslate nohighlight">\(i \leq j\)</span> in the product.  That is given by the method
<a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.hasse_invariant__OMeara" title="sage.quadratic_forms.quadratic_form.QuadraticForm.hasse_invariant__OMeara"><code class="xref py py-meth docutils literal notranslate"><span class="pre">hasse_invariant__OMeara()</span></code></a>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We should really rename this <code class="docutils literal notranslate"><span class="pre">hasse_invariant__Cassels</span></code>, and
set <a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.hasse_invariant" title="sage.quadratic_forms.quadratic_form.QuadraticForm.hasse_invariant"><code class="xref py py-meth docutils literal notranslate"><span class="pre">hasse_invariant()</span></code></a> as a front-end to it.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number &gt; 0 or <span class="math notranslate nohighlight">\(-1\)</span> for the infinite place</p></li>
</ul>
<p>OUTPUT: <span class="math notranslate nohighlight">\(1\)</span> or <span class="math notranslate nohighlight">\(-1\)</span></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">rational_diagonal_form</span><span class="p">()</span>
<span class="go">Quadratic form in 2 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 0 ]</span>
<span class="go">[ * 2 ]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>                       <span class="c1"># optional - sage.libs.pari</span>
<span class="go">[1, 1, 1, 1, 1, 1, 1, 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant__OMeara</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>               <span class="c1"># optional - sage.libs.pari</span>
<span class="go">[1, 1, 1, 1, 1, 1, 1, 1]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>                       <span class="c1"># optional - sage.libs.pari</span>
<span class="go">[1, 1, 1, 1, 1, 1, 1, 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant__OMeara</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>               <span class="c1"># optional - sage.libs.pari</span>
<span class="go">[-1, 1, 1, 1, 1, 1, 1, 1]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>                       <span class="c1"># optional - sage.libs.pari</span>
<span class="go">[1, 1, 1, 1, 1, 1, 1, 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant__OMeara</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>               <span class="c1"># optional - sage.libs.pari</span>
<span class="go">[-1, 1, 1, 1, 1, 1, 1, 1]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">23</span><span class="p">)</span>                                         <span class="c1"># optional - sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span>                             <span class="c1"># optional - sage.rings.number_field</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">19</span><span class="p">)]</span>                    <span class="c1"># optional - sage.rings.number_field</span>
<span class="go">[-1, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.hasse_invariant__OMeara">
<span class="sig-name descname"><span class="pre">hasse_invariant__OMeara</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.hasse_invariant__OMeara" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the O’Meara Hasse invariant at a prime <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>This is defined on
p167 of O’Meara’s book. If <span class="math notranslate nohighlight">\(Q\)</span> is diagonal with coefficients <span class="math notranslate nohighlight">\(a_i\)</span>,
then the (Cassels) Hasse invariant is given by</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[c_p = \prod_{i \leq j} (a_i, a_j)_p\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\((a,b)_p\)</span> is the Hilbert symbol at <span class="math notranslate nohighlight">\(p\)</span>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is different from the (Cassels) Hasse invariant, which
only allows <span class="math notranslate nohighlight">\(i &lt; j\)</span> in the product.  That is given by the method
hasse_invariant(p).</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number &gt; 0 or <span class="math notranslate nohighlight">\(-1\)</span> for the infinite place</p></li>
</ul>
<p>OUTPUT: <span class="math notranslate nohighlight">\(1\)</span> or <span class="math notranslate nohighlight">\(-1\)</span></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">rational_diagonal_form</span><span class="p">()</span>
<span class="go">Quadratic form in 2 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 0 ]</span>
<span class="go">[ * 2 ]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>                       <span class="c1"># optional - sage.libs.pari</span>
<span class="go">[1, 1, 1, 1, 1, 1, 1, 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant__OMeara</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>               <span class="c1"># optional - sage.libs.pari</span>
<span class="go">[1, 1, 1, 1, 1, 1, 1, 1]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>                       <span class="c1"># optional - sage.libs.pari</span>
<span class="go">[1, 1, 1, 1, 1, 1, 1, 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant__OMeara</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>               <span class="c1"># optional - sage.libs.pari</span>
<span class="go">[-1, 1, 1, 1, 1, 1, 1, 1]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>                       <span class="c1"># optional - sage.libs.pari</span>
<span class="go">[-1, 1, 1, 1, 1, 1, 1, 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant__OMeara</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>               <span class="c1"># optional - sage.libs.pari</span>
<span class="go">[-1, 1, 1, 1, 1, 1, 1, 1]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">23</span><span class="p">)</span>                                         <span class="c1"># optional - sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span>                             <span class="c1"># optional - sage.rings.number_field</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant__OMeara</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">19</span><span class="p">)]</span>            <span class="c1"># optional - sage.rings.number_field</span>
<span class="go">[1, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_adjoint">
<span class="sig-name descname"><span class="pre">is_adjoint</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_adjoint" title="Permalink to this definition">#</a></dt>
<dd><p>Determine if the given form is the adjoint of another form.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_adjoint</span><span class="p">()</span>                                                        <span class="c1"># optional - sage.symbolic</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">adjoint</span><span class="p">()</span><span class="o">.</span><span class="n">is_adjoint</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_anisotropic">
<span class="sig-name descname"><span class="pre">is_anisotropic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_anisotropic" title="Permalink to this definition">#</a></dt>
<dd><p>Check if the quadratic form is anisotropic over the <span class="math notranslate nohighlight">\(p\)</span>-adic numbers <span class="math notranslate nohighlight">\(\QQ_p\)</span> or <span class="math notranslate nohighlight">\(\RR\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number &gt; 0 or <span class="math notranslate nohighlight">\(-1\)</span> for the infinite place</p></li>
</ul>
<p>OUTPUT: boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_anisotropic</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>                                                   <span class="c1"># optional - sage.libs.pari</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_anisotropic</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                                                   <span class="c1"># optional - sage.libs.pari</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_anisotropic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>                                                   <span class="c1"># optional - sage.libs.pari</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_anisotropic</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>                                                   <span class="c1"># optional - sage.libs.pari</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_anisotropic</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                                                   <span class="c1"># optional - sage.libs.pari</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_anisotropic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>                                                   <span class="c1"># optional - sage.libs.pari</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span>                                            <span class="c1"># optional - sage.libs.pari</span>
<span class="gp">....: </span>                       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">least_quadratic_nonresidue</span><span class="p">(</span><span class="n">p</span><span class="p">)])</span><span class="o">.</span><span class="n">is_anisotropic</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">....: </span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">30</span><span class="p">)]</span>
<span class="go">[True, True, True, True, True, True, True, True, True]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">least_quadratic_nonresidue</span><span class="p">(</span><span class="n">p</span><span class="p">),</span>        <span class="c1"># optional - sage.libs.pari</span>
<span class="gp">....: </span>                            <span class="n">p</span><span class="p">,</span> <span class="o">-</span><span class="n">p</span><span class="o">*</span><span class="n">least_quadratic_nonresidue</span><span class="p">(</span><span class="n">p</span><span class="p">)])</span><span class="o">.</span><span class="n">is_anisotropic</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">....: </span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">30</span><span class="p">)]</span>
<span class="go">[True, True, True, True, True, True, True, True, True]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_definite">
<span class="sig-name descname"><span class="pre">is_definite</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_definite" title="Permalink to this definition">#</a></dt>
<dd><p>Determines if the given quadratic form is (positive or negative) definite.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A degenerate form is considered neither definite nor indefinite.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The zero-dimensional form is considered indefinite.</p>
</div>
<p>OUTPUT: boolean – True or False</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_definite</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_definite</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_even">
<span class="sig-name descname"><span class="pre">is_even</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allow_rescaling_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_even" title="Permalink to this definition">#</a></dt>
<dd><p>Return true iff after rescaling by some appropriate factor, the
form represents no odd integers.  For more details, see <a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.parity" title="sage.quadratic_forms.quadratic_form.QuadraticForm.parity"><code class="xref py py-meth docutils literal notranslate"><span class="pre">parity()</span></code></a>.</p>
<p>Requires that <span class="math notranslate nohighlight">\(Q\)</span> is defined over <span class="math notranslate nohighlight">\(\ZZ\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_even</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_even</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_globally_equivalent_to">
<span class="sig-name descname"><span class="pre">is_globally_equivalent_to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_globally_equivalent_to" title="Permalink to this definition">#</a></dt>
<dd><p>Determine if the current quadratic form is equivalent to the
given form over <span class="math notranslate nohighlight">\(\ZZ\)</span>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">return_matrix</span></code> is True, then we return the transformation
matrix <span class="math notranslate nohighlight">\(M\)</span> so that <code class="docutils literal notranslate"><span class="pre">self(M)</span> <span class="pre">==</span> <span class="pre">other</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code>, <code class="docutils literal notranslate"><span class="pre">other</span></code> – positive definite integral quadratic forms</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">return_matrix</span></code> – (boolean, default <code class="docutils literal notranslate"><span class="pre">False</span></code>) return
the transformation matrix instead of a boolean</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>if <code class="docutils literal notranslate"><span class="pre">return_matrix</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>: a boolean</p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">return_matrix</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>: either <code class="docutils literal notranslate"><span class="pre">False</span></code> or the
transformation matrix</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">Q</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_globally_equivalent_to</span><span class="p">(</span><span class="n">Q1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">MM</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">is_globally_equivalent_to</span><span class="p">(</span><span class="n">Q1</span><span class="p">,</span> <span class="n">return_matrix</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">(</span><span class="n">MM</span><span class="p">)</span> <span class="o">==</span> <span class="n">Q1</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q3</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_globally_equivalent_to</span><span class="p">(</span><span class="n">Q2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_globally_equivalent_to</span><span class="p">(</span><span class="n">Q2</span><span class="p">,</span> <span class="n">return_matrix</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_globally_equivalent_to</span><span class="p">(</span><span class="n">Q3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Q1</span><span class="o">.</span><span class="n">is_globally_equivalent_to</span><span class="p">(</span><span class="n">Q3</span><span class="p">,</span> <span class="kc">True</span><span class="p">);</span> <span class="n">M</span>
<span class="go">[-1 -1  0]</span>
<span class="go">[ 1  1  1]</span>
<span class="go">[-1  0  0]</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">==</span> <span class="n">Q3</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_globally_equivalent_to</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: not a definite form in QuadraticForm.is_globally_equivalent_to()</span>
</pre></div>
</div>
<p>ALGORITHM: this uses the PARI function <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/qfisom">pari:qfisom</a>, implementing
an algorithm by Plesken and Souvignier.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_hyperbolic">
<span class="sig-name descname"><span class="pre">is_hyperbolic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_hyperbolic" title="Permalink to this definition">#</a></dt>
<dd><p>Check if the quadratic form is a sum of hyperbolic planes over
the <span class="math notranslate nohighlight">\(p\)</span>-adic numbers <span class="math notranslate nohighlight">\(\QQ_p\)</span> or over the real numbers <span class="math notranslate nohighlight">\(\RR\)</span>.</p>
<p>REFERENCES:</p>
<p>This criterion follows from Cassels’s “Rational Quadratic Forms”:</p>
<ul class="simple">
<li><p>local invariants for hyperbolic plane (Lemma 2.4, p58)</p></li>
<li><p>direct sum formulas (Lemma 2.3, p58)</p></li>
</ul>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number &gt; 0 or <span class="math notranslate nohighlight">\(-1\)</span> for the infinite place</p></li>
</ul>
<p>OUTPUT: boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_hyperbolic</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>                                                   <span class="c1"># optional - sage.libs.pari</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_hyperbolic</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>                                                    <span class="c1"># optional - sage.libs.pari</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_hyperbolic</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                                                    <span class="c1"># optional - sage.libs.pari</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_hyperbolic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>     <span class="c1"># Here -1 is a square, so it&#39;s true.           # optional - sage.libs.pari</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_hyperbolic</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>                                                    <span class="c1"># optional - sage.libs.pari</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_hyperbolic</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>    <span class="c1"># Here -1 is a square, so it&#39;s true.           # optional - sage.libs.pari</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_indefinite">
<span class="sig-name descname"><span class="pre">is_indefinite</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_indefinite" title="Permalink to this definition">#</a></dt>
<dd><p>Determines if the given quadratic form is indefinite.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A degenerate form is considered neither definite nor indefinite.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The zero-dimensional form is not considered indefinite.</p>
</div>
<p>OUTPUT: boolean – True or False</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_indefinite</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_indefinite</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_isotropic">
<span class="sig-name descname"><span class="pre">is_isotropic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_isotropic" title="Permalink to this definition">#</a></dt>
<dd><p>Checks if <span class="math notranslate nohighlight">\(Q\)</span> is isotropic over the <span class="math notranslate nohighlight">\(p\)</span>-adic numbers <span class="math notranslate nohighlight">\(\QQ_p\)</span> or <span class="math notranslate nohighlight">\(\RR\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number &gt; 0 or <span class="math notranslate nohighlight">\(-1\)</span> for the infinite place</p></li>
</ul>
<p>OUTPUT: boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_isotropic</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>                                                     <span class="c1"># optional - sage.libs.pari</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_isotropic</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                                                     <span class="c1"># optional - sage.libs.pari</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_isotropic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>                                                     <span class="c1"># optional - sage.libs.pari</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_isotropic</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>                                                     <span class="c1"># optional - sage.libs.pari</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_isotropic</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                                                     <span class="c1"># optional - sage.libs.pari</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_isotropic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>                                                     <span class="c1"># optional - sage.libs.pari</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span>                                            <span class="c1"># optional - sage.libs.pari</span>
<span class="gp">....: </span>                       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">least_quadratic_nonresidue</span><span class="p">(</span><span class="n">p</span><span class="p">)])</span><span class="o">.</span><span class="n">is_isotropic</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">....: </span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">30</span><span class="p">)]</span>
<span class="go">[False, False, False, False, False, False, False, False, False]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">least_quadratic_nonresidue</span><span class="p">(</span><span class="n">p</span><span class="p">),</span>        <span class="c1"># optional - sage.libs.pari</span>
<span class="gp">....: </span>                            <span class="n">p</span><span class="p">,</span> <span class="o">-</span><span class="n">p</span><span class="o">*</span><span class="n">least_quadratic_nonresidue</span><span class="p">(</span><span class="n">p</span><span class="p">)])</span><span class="o">.</span><span class="n">is_isotropic</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">....: </span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">30</span><span class="p">)]</span>
<span class="go">[False, False, False, False, False, False, False, False, False]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_equivalent_to">
<span class="sig-name descname"><span class="pre">is_locally_equivalent_to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_primes_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_jordan_equivalence_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_equivalent_to" title="Permalink to this definition">#</a></dt>
<dd><p>Determine if the current quadratic form (defined over <span class="math notranslate nohighlight">\(\ZZ\)</span>) is
locally equivalent to the given form over the real numbers and the
<span class="math notranslate nohighlight">\(p\)</span>-adic integers for every prime <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>This works by comparing the local Jordan decompositions at every
prime, and the dimension and signature at the real place.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> – a <a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm" title="sage.quadratic_forms.quadratic_form.QuadraticForm"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuadraticForm</span></code></a></p></li>
</ul>
<p>OUTPUT: boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_globally_equivalent_to</span><span class="p">(</span><span class="n">Q2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_locally_equivalent_to</span><span class="p">(</span><span class="n">Q2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_represented_number">
<span class="sig-name descname"><span class="pre">is_locally_represented_number</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_represented_number" title="Permalink to this definition">#</a></dt>
<dd><p>Determine if the rational number <span class="math notranslate nohighlight">\(m\)</span> is locally represented
by the quadratic form.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> – an integer</p></li>
</ul>
<p>OUTPUT: boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_represented_number_at_place">
<span class="sig-name descname"><span class="pre">is_locally_represented_number_at_place</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_represented_number_at_place" title="Permalink to this definition">#</a></dt>
<dd><p>Determine if the rational number <span class="math notranslate nohighlight">\(m\)</span> is locally represented by the
quadratic form at the (possibly infinite) prime <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> – an integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number &gt; 0 or ‘infinity’</p></li>
</ul>
<p>OUTPUT: boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number_at_place</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">infinity</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number_at_place</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number_at_place</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number_at_place</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number_at_place</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">infinity</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number_at_place</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number_at_place</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">infinity</span><span class="p">)</span>     <span class="c1"># long time (8.5 s)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number_at_place</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>            <span class="c1"># long time</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number_at_place</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>            <span class="c1"># long time</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number_at_place</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>            <span class="c1"># long time</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_universal_at_all_places">
<span class="sig-name descname"><span class="pre">is_locally_universal_at_all_places</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_universal_at_all_places" title="Permalink to this definition">#</a></dt>
<dd><p>Determine if the quadratic form represents <span class="math notranslate nohighlight">\(\ZZ_p\)</span> for all
finite/non-archimedean primes, and represents all real numbers.</p>
<p>OUTPUT: boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_all_places</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_all_places</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_all_places</span><span class="p">()</span>        <span class="c1"># long time (8.5 s)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_universal_at_all_primes">
<span class="sig-name descname"><span class="pre">is_locally_universal_at_all_primes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_universal_at_all_primes" title="Permalink to this definition">#</a></dt>
<dd><p>Determine if the quadratic form represents <span class="math notranslate nohighlight">\(\ZZ_p\)</span> for all finite/non-archimedean primes.</p>
<p>OUTPUT: boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_all_primes</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_all_primes</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_all_primes</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_universal_at_prime">
<span class="sig-name descname"><span class="pre">is_locally_universal_at_prime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_universal_at_prime" title="Permalink to this definition">#</a></dt>
<dd><p>Determine if the (integer-valued/rational) quadratic form represents all of <span class="math notranslate nohighlight">\(\ZZ_p\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a positive prime number or “infinity”</p></li>
</ul>
<p>OUTPUT: boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_prime</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_prime</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_prime</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_prime</span><span class="p">(</span><span class="n">infinity</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_prime</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_prime</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_prime</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_prime</span><span class="p">(</span><span class="n">infinity</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_prime</span><span class="p">(</span><span class="n">infinity</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_negative_definite">
<span class="sig-name descname"><span class="pre">is_negative_definite</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_negative_definite" title="Permalink to this definition">#</a></dt>
<dd><p>Determines if the given quadratic form is negative-definite.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A degenerate form is considered neither definite nor indefinite.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The zero-dimensional form is considered both positive definite and negative definite.</p>
</div>
<p>OUTPUT: boolean – True or False</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_negative_definite</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_negative_definite</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_odd">
<span class="sig-name descname"><span class="pre">is_odd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allow_rescaling_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_odd" title="Permalink to this definition">#</a></dt>
<dd><p>Return true iff after rescaling by some appropriate factor, the
form represents some odd integers.  For more details, see <a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.parity" title="sage.quadratic_forms.quadratic_form.QuadraticForm.parity"><code class="xref py py-meth docutils literal notranslate"><span class="pre">parity()</span></code></a>.</p>
<p>Requires that <span class="math notranslate nohighlight">\(Q\)</span> is defined over <span class="math notranslate nohighlight">\(\ZZ\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_odd</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_odd</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_positive_definite">
<span class="sig-name descname"><span class="pre">is_positive_definite</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_positive_definite" title="Permalink to this definition">#</a></dt>
<dd><p>Determines if the given quadratic form is positive-definite.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A degenerate form is considered neither definite nor indefinite.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The zero-dimensional form is considered both positive definite and negative definite.</p>
</div>
<p>OUTPUT: boolean – True or False</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_positive_definite</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_positive_definite</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_primitive">
<span class="sig-name descname"><span class="pre">is_primitive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_primitive" title="Permalink to this definition">#</a></dt>
<dd><p>Determines if the given integer-valued form is primitive
(i.e. not an integer (<span class="math notranslate nohighlight">\(&gt; 1\)</span>) multiple of another integer-valued
quadratic form).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_rationally_isometric">
<span class="sig-name descname"><span class="pre">is_rationally_isometric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_rationally_isometric" title="Permalink to this definition">#</a></dt>
<dd><p>Determine if two regular quadratic forms over a number field are isometric.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> – a quadratic form over a number field</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">return_matrix</span></code> – (boolean, default <code class="docutils literal notranslate"><span class="pre">False</span></code>) return
the transformation matrix instead of a boolean; this is currently only implemented for forms over <code class="docutils literal notranslate"><span class="pre">QQ</span></code></p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>if <code class="docutils literal notranslate"><span class="pre">return_matrix</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>: a boolean</p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">return_matrix</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>: either <code class="docutils literal notranslate"><span class="pre">False</span></code> or the
transformation matrix</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">is_rationally_isometric</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>                                          <span class="c1"># optional - sage.libs.pari</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>                                          <span class="c1"># optional - sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]);</span> <span class="n">V</span>          <span class="c1"># optional - sage.rings.number_field</span>
<span class="go">Quadratic form in 4 variables over Number Field in a</span>
<span class="go"> with defining polynomial x^2 - 3 with coefficients:</span>
<span class="go">[ 1 0 0 0 ]</span>
<span class="go">[ * 2*a 0 0 ]</span>
<span class="go">[ * * a 0 ]</span>
<span class="go">[ * * * 2 ]</span>
<span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">]);</span> <span class="n">W</span>         <span class="c1"># optional - sage.rings.number_field</span>
<span class="go">Quadratic form in 4 variables over Number Field in a</span>
<span class="go"> with defining polynomial x^2 - 3 with coefficients:</span>
<span class="go">[ 1 2*a 4 6 ]</span>
<span class="go">[ * 3 10 2 ]</span>
<span class="go">[ * * 1 2 ]</span>
<span class="go">[ * * * 5 ]</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">is_rationally_isometric</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>                                          <span class="c1"># optional - sage.rings.number_field</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">6</span><span class="p">)</span>                                    <span class="c1"># optional - sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]);</span> <span class="n">V</span>                      <span class="c1"># optional - sage.rings.number_field</span>
<span class="go">Quadratic form in 5 variables over Number Field in a</span>
<span class="go"> with defining polynomial x^4 + 2*x + 6 with coefficients:</span>
<span class="go">[ a 0 0 0 0 ]</span>
<span class="go">[ * 2 0 0 0 ]</span>
<span class="go">[ * * 3 0 0 ]</span>
<span class="go">[ * * * 2 0 ]</span>
<span class="go">[ * * * * 1 ]</span>
<span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]);</span> <span class="n">W</span>                      <span class="c1"># optional - sage.rings.number_field</span>
<span class="go">Quadratic form in 5 variables over Number Field in a</span>
<span class="go"> with defining polynomial x^4 + 2*x + 6 with coefficients:</span>
<span class="go">[ a 0 0 0 0 ]</span>
<span class="go">[ * a 0 0 0 ]</span>
<span class="go">[ * * a 0 0 ]</span>
<span class="go">[ * * * 2 0 ]</span>
<span class="go">[ * * * * 1 ]</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">is_rationally_isometric</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>                                          <span class="c1"># optional - sage.rings.number_field</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>                                          <span class="c1"># optional - sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">])</span>                           <span class="c1"># optional - sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">a</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">])</span>                           <span class="c1"># optional - sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">is_rationally_isometric</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>                                          <span class="c1"># optional - sage.rings.number_field</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>                              <span class="c1"># optional - sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>                              <span class="c1"># optional - sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">is_rationally_isometric</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="kc">True</span><span class="p">);</span> <span class="n">T</span>                             <span class="c1"># optional - sage.rings.number_field</span>
<span class="go">[   0    0    1]</span>
<span class="go">[-1/2 -1/2    0]</span>
<span class="go">[ 1/2 -1/2    0]</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">Gram_matrix</span><span class="p">()</span> <span class="o">==</span> <span class="n">T</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">*</span> <span class="n">W</span><span class="o">.</span><span class="n">Gram_matrix</span><span class="p">()</span> <span class="o">*</span> <span class="n">T</span>                <span class="c1"># optional - sage.rings.number_field</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">W</span><span class="o">.</span><span class="n">is_rationally_isometric</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="kc">True</span><span class="p">);</span> <span class="n">T</span>                             <span class="c1"># optional - sage.rings.number_field</span>
<span class="go">[ 0 -1  1]</span>
<span class="go">[ 0 -1 -1]</span>
<span class="go">[ 1  0  0]</span>
<span class="gp">sage: </span><span class="n">W</span><span class="o">.</span><span class="n">Gram_matrix</span><span class="p">()</span> <span class="o">==</span> <span class="n">T</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">V</span><span class="o">.</span><span class="n">Gram_matrix</span><span class="p">()</span> <span class="o">*</span> <span class="n">T</span>                          <span class="c1"># optional - sage.rings.number_field</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">is_rationally_isometric</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>                                    <span class="c1"># optional - sage.libs.pari</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">81</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">is_rationally_isometric</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="kc">True</span><span class="p">);</span> <span class="n">T</span>                             <span class="c1"># optional - sage.libs.pari</span>
<span class="go">[  1  -2]</span>
<span class="go">[  0 1/3]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">Gram_matrix</span><span class="p">()</span> <span class="o">==</span> <span class="n">T</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">B</span><span class="o">.</span><span class="n">Gram_matrix</span><span class="p">()</span> <span class="o">*</span> <span class="n">T</span>                          <span class="c1"># optional - sage.libs.pari</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">is_rationally_isometric</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="kc">True</span><span class="p">);</span> <span class="n">T</span>                             <span class="c1"># optional - sage.libs.pari</span>
<span class="go">[   0 -5/6  1/2]</span>
<span class="go">[   0  1/6  1/2]</span>
<span class="go">[  -1    0    0]</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">Gram_matrix</span><span class="p">()</span> <span class="o">==</span> <span class="n">T</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">D</span><span class="o">.</span><span class="n">Gram_matrix</span><span class="p">()</span> <span class="o">*</span> <span class="n">T</span>                          <span class="c1"># optional - sage.libs.pari</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">is_rationally_isometric</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="kc">True</span><span class="p">);</span> <span class="n">T</span>                             <span class="c1"># optional - sage.libs.pari</span>
<span class="go">[     -4 -189/17]</span>
<span class="go">[     -1  -43/17]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">Gram_matrix</span><span class="p">()</span> <span class="o">==</span> <span class="n">T</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">E</span><span class="o">.</span><span class="n">Gram_matrix</span><span class="p">()</span> <span class="o">*</span> <span class="n">T</span>                          <span class="c1"># optional - sage.libs.pari</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_zero">
<span class="sig-name descname"><span class="pre">is_zero</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_zero" title="Permalink to this definition">#</a></dt>
<dd><p>Determine if the vector <span class="math notranslate nohighlight">\(v\)</span> is on the conic <span class="math notranslate nohighlight">\(Q(x) = 0\)</span> (mod <span class="math notranslate nohighlight">\(p\)</span>).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_zero</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_zero</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_zero</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_zero_nonsingular">
<span class="sig-name descname"><span class="pre">is_zero_nonsingular</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_zero_nonsingular" title="Permalink to this definition">#</a></dt>
<dd><p>Determine if the vector <span class="math notranslate nohighlight">\(v\)</span> is on the conic <span class="math notranslate nohighlight">\(Q(x) = 0\)</span> (mod <span class="math notranslate nohighlight">\(p\)</span>),
and that this point is non-singular point of the conic.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_zero_nonsingular</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_zero</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">37</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_zero_nonsingular</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">37</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_zero_singular">
<span class="sig-name descname"><span class="pre">is_zero_singular</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_zero_singular" title="Permalink to this definition">#</a></dt>
<dd><p>Determine if the vector <span class="math notranslate nohighlight">\(v\)</span> is on the conic <span class="math notranslate nohighlight">\(Q(x) = 0\)</span> (mod <span class="math notranslate nohighlight">\(p\)</span>),
and that this point is singular point of the conic.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_zero</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_zero_singular</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_zero_singular</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">37</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.jordan_blocks_by_scale_and_unimodular">
<span class="sig-name descname"><span class="pre">jordan_blocks_by_scale_and_unimodular</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">safe_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.jordan_blocks_by_scale_and_unimodular" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list of pairs <span class="math notranslate nohighlight">\((s_i, L_i)\)</span> where <span class="math notranslate nohighlight">\(L_i\)</span> is a maximal
<span class="math notranslate nohighlight">\(p^{s_i}\)</span>-unimodular Jordan component which is further decomposed into
block diagonals of block size <span class="math notranslate nohighlight">\(\le 2\)</span>.</p>
<p>For each <span class="math notranslate nohighlight">\(L_i\)</span> the <span class="math notranslate nohighlight">\(2 \times 2\)</span> blocks are listed after the <span class="math notranslate nohighlight">\(1 \times 1\)</span> blocks
(which follows from the convention of the
<a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_normal_form" title="sage.quadratic_forms.quadratic_form.QuadraticForm.local_normal_form"><code class="xref py py-meth docutils literal notranslate"><span class="pre">local_normal_form()</span></code></a> method).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The decomposition of each <span class="math notranslate nohighlight">\(L_i\)</span> into smaller blocks is not unique!</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">safe_flag</span></code> argument allows us to select whether we want a copy of
the output, or the original output.  By default <code class="docutils literal notranslate"><span class="pre">safe_flag</span> <span class="pre">=</span> <span class="pre">True</span></code>, so we
return a copy of the cached information.  If this is set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, then
the routine is much faster but the return values are vulnerable to being
corrupted by the user.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number &gt; 0</p></li>
</ul>
<p>OUTPUT:</p>
<p>A list of pairs <span class="math notranslate nohighlight">\((s_i, L_i)\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(s_i\)</span> is an integer,</p></li>
<li><p><span class="math notranslate nohighlight">\(L_i\)</span> is a block-diagonal unimodular quadratic form over <span class="math notranslate nohighlight">\(\ZZ_p\)</span>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These forms <span class="math notranslate nohighlight">\(L_i\)</span> are defined over the <span class="math notranslate nohighlight">\(p\)</span>-adic integers, but by a
matrix over <span class="math notranslate nohighlight">\(\ZZ\)</span> (or <span class="math notranslate nohighlight">\(\QQ\)</span>?).</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">jordan_blocks_by_scale_and_unimodular</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[(0, Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">       [ 1 0 0 ]</span>
<span class="go">       [ * 5 0 ]</span>
<span class="go">       [ * * 7 ]),</span>
<span class="go"> (2, Quadratic form in 1 variables over Integer Ring with coefficients:</span>
<span class="go">       [ 1 ])]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q2</span><span class="o">.</span><span class="n">jordan_blocks_by_scale_and_unimodular</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[(-1, Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">        [ 2 2 ]</span>
<span class="go">        [ * 2 ])]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">Q2</span> <span class="o">+</span> <span class="n">Q2</span><span class="o">.</span><span class="n">scale_by_factor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">jordan_blocks_by_scale_and_unimodular</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[(-1, Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">        [ 2 2 ]</span>
<span class="go">        [ * 2 ]),</span>
<span class="go"> (0, Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">        [ 2 2 ]</span>
<span class="go">        [ * 2 ])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.jordan_blocks_in_unimodular_list_by_scale_power">
<span class="sig-name descname"><span class="pre">jordan_blocks_in_unimodular_list_by_scale_power</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.jordan_blocks_in_unimodular_list_by_scale_power" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list of Jordan components, whose component at index <span class="math notranslate nohighlight">\(i\)</span>
should be scaled by the factor <span class="math notranslate nohighlight">\(p^i\)</span>.</p>
<p>This is only defined for integer-valued quadratic forms
(i.e., forms with base ring <span class="math notranslate nohighlight">\(\ZZ\)</span>), and the indexing only works
correctly for <span class="math notranslate nohighlight">\(p=2\)</span> when the form has an integer Gram matrix.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – a quadratic form over <span class="math notranslate nohighlight">\(\ZZ\)</span>, which has integer Gram matrix if <span class="math notranslate nohighlight">\(p = 2\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number &gt; 0</p></li>
</ul>
<p>OUTPUT: a list of <span class="math notranslate nohighlight">\(p\)</span>-unimodular quadratic forms</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">jordan_blocks_in_unimodular_list_by_scale_power</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: the given quadratic form has a Jordan component with a negative scale exponent</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">scale_by_factor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">jordan_blocks_in_unimodular_list_by_scale_power</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">   [ 0 2 ]</span>
<span class="go">   [ * 0 ],</span>
<span class="go"> Quadratic form in 0 variables over Integer Ring with coefficients:</span>
<span class="go">   ,</span>
<span class="go"> Quadratic form in 1 variables over Integer Ring with coefficients:</span>
<span class="go">   [ 345 ]]</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">jordan_blocks_in_unimodular_list_by_scale_power</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">   [ 2 0 ]</span>
<span class="go">   [ * 10 ],</span>
<span class="go"> Quadratic form in 1 variables over Integer Ring with coefficients:</span>
<span class="go">   [ 2 ]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.level">
<span class="sig-name descname"><span class="pre">level</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.level" title="Permalink to this definition">#</a></dt>
<dd><p>Determines the level of the quadratic form over a PID, which is a
generator for the smallest ideal <span class="math notranslate nohighlight">\(N\)</span> of <span class="math notranslate nohighlight">\(R\)</span> such that <span class="math notranslate nohighlight">\(N\cdot (\)</span> the matrix of
<span class="math notranslate nohighlight">\(2*Q\)</span> <span class="math notranslate nohighlight">\()^{(-1)}\)</span> is in <span class="math notranslate nohighlight">\(R\)</span> with diagonal in <span class="math notranslate nohighlight">\(2R\)</span>.</p>
<p>Over <span class="math notranslate nohighlight">\(\ZZ\)</span> this returns a non-negative number.</p>
<p>(Caveat: This always returns the unit ideal when working over a field!)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">level</span><span class="p">()</span>
<span class="go">8</span>

<span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">level</span><span class="p">()</span>      <span class="c1"># random</span>
<span class="go">UserWarning: Warning -- The level of a quadratic form over a field is always 1.</span>
<span class="go">Do you really want to do this?!?</span>
<span class="go">1</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">level</span><span class="p">()</span>
<span class="go">420</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.level__Tornaria">
<span class="sig-name descname"><span class="pre">level__Tornaria</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.level__Tornaria" title="Permalink to this definition">#</a></dt>
<dd><p>Return the level of the quadratic form,
defined as</p>
<ul class="simple">
<li><p>level(<span class="math notranslate nohighlight">\(B\)</span>)    for even dimension,</p></li>
<li><p>level(<span class="math notranslate nohighlight">\(B\)</span>)/4  for odd dimension,</p></li>
</ul>
<p>where <span class="math notranslate nohighlight">\(2Q(x) = x^t\cdot B\cdot x\)</span>.</p>
<p>This agrees with the usual level for even dimension…</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">level__Tornaria</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">level__Tornaria</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">level__Tornaria</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">level__Tornaria</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.level_ideal">
<span class="sig-name descname"><span class="pre">level_ideal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.level_ideal" title="Permalink to this definition">#</a></dt>
<dd><p>Determine the level of the quadratic form (over <span class="math notranslate nohighlight">\(R\)</span>), which is the
smallest ideal <span class="math notranslate nohighlight">\(N\)</span> of <span class="math notranslate nohighlight">\(R\)</span> such that <span class="math notranslate nohighlight">\(N \cdot (\)</span> the matrix of <span class="math notranslate nohighlight">\(2Q\)</span> <span class="math notranslate nohighlight">\()^{(-1)}\)</span> is
in <span class="math notranslate nohighlight">\(R\)</span> with diagonal in <span class="math notranslate nohighlight">\(2R\)</span>.
(Caveat: This always returns the principal ideal when working over a field!)</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This only works over a PID ring of integers for now!
(Waiting for Sage fractional ideal support.)</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">level_ideal</span><span class="p">()</span>
<span class="go">Principal ideal (8) of Integer Ring</span>

<span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">level_ideal</span><span class="p">()</span>
<span class="go">Principal ideal (1) of Rational Field</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">level_ideal</span><span class="p">()</span>
<span class="go">Principal ideal (420) of Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.list_external_initializations">
<span class="sig-name descname"><span class="pre">list_external_initializations</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.list_external_initializations" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list of the fields which were set externally at
creation, and not created through the usual <a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm" title="sage.quadratic_forms.quadratic_form.QuadraticForm"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuadraticForm</span></code></a>
methods.  These fields are as good as the external process
that made them, and are thus not guaranteed to be correct.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">list_external_initializations</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">theta_series</span><span class="p">()</span>                                                  <span class="c1"># optional - sage.libs.pari</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">list_external_initializations</span><span class="p">()</span>                                     <span class="c1"># optional - sage.libs.pari</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">unsafe_initialization</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>        <span class="c1"># optional - sage.libs.pari</span>
<span class="gp">....: </span>                  <span class="n">number_of_automorphisms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">determinant</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">list_external_initializations</span><span class="p">()</span>                                     <span class="c1"># optional - sage.libs.pari</span>
<span class="go">[]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">unsafe_initialization</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>        <span class="c1"># optional - sage.libs.pari</span>
<span class="gp">....: </span>                  <span class="n">number_of_automorphisms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">determinant</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">list_external_initializations</span><span class="p">()</span>                                     <span class="c1"># optional - sage.libs.pari</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">unsafe_initialization</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>         <span class="c1"># optional - sage.libs.pari</span>
<span class="gp">....: </span>                  <span class="n">number_of_automorphisms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">determinant</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">list_external_initializations</span><span class="p">()</span>                                     <span class="c1"># optional - sage.libs.pari</span>
<span class="go">[&#39;number_of_automorphisms&#39;, &#39;determinant&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.lll">
<span class="sig-name descname"><span class="pre">lll</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.lll" title="Permalink to this definition">#</a></dt>
<dd><p>Return an LLL-reduced form of <span class="math notranslate nohighlight">\(Q\)</span> (using PARI).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_definite</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">lll</span><span class="p">()</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 1 0 ]</span>
<span class="go">[ * 4 3 3 ]</span>
<span class="go">[ * * 6 3 ]</span>
<span class="go">[ * * * 6 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_badII_density_congruence">
<span class="sig-name descname"><span class="pre">local_badII_density_congruence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NZvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_badII_density_congruence" title="Permalink to this definition">#</a></dt>
<dd><p>Find the Bad-type II local density of <span class="math notranslate nohighlight">\(Q\)</span> representing <span class="math notranslate nohighlight">\(m\)</span> at <span class="math notranslate nohighlight">\(p\)</span>.
(Assuming that <span class="math notranslate nohighlight">\(p &gt; 2\)</span> and <span class="math notranslate nohighlight">\(Q\)</span> is given in local diagonal form.)</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – quadratic form <span class="math notranslate nohighlight">\(Q\)</span>, assumed to be block diagonal and <span class="math notranslate nohighlight">\(p\)</span>-integral</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> – an integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Zvec</span></code>, <code class="docutils literal notranslate"><span class="pre">NZvec</span></code> – non-repeating lists of integers in <code class="docutils literal notranslate"><span class="pre">range(self.dim())</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
<p>OUTPUT: a rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/27</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/9</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_badI_density_congruence">
<span class="sig-name descname"><span class="pre">local_badI_density_congruence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NZvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_badI_density_congruence" title="Permalink to this definition">#</a></dt>
<dd><p>Find the Bad-type I local density of <span class="math notranslate nohighlight">\(Q\)</span> representing <span class="math notranslate nohighlight">\(m\)</span> at <span class="math notranslate nohighlight">\(p\)</span>.
(Assuming that <span class="math notranslate nohighlight">\(p &gt; 2\)</span> and <span class="math notranslate nohighlight">\(Q\)</span> is given in local diagonal form.)</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – quadratic form <span class="math notranslate nohighlight">\(Q\)</span>, assumed to be block diagonal and <span class="math notranslate nohighlight">\(p\)</span>-integral</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> – an integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Zvec</span></code>, <code class="docutils literal notranslate"><span class="pre">NZvec</span></code> – non-repeating lists of integers in <code class="docutils literal notranslate"><span class="pre">range(self.dim())</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
<p>OUTPUT: a rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_bad_density_congruence">
<span class="sig-name descname"><span class="pre">local_bad_density_congruence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NZvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_bad_density_congruence" title="Permalink to this definition">#</a></dt>
<dd><p>Find the Bad-type local density of <span class="math notranslate nohighlight">\(Q\)</span> representing
<span class="math notranslate nohighlight">\(m\)</span> at <span class="math notranslate nohighlight">\(p\)</span>, allowing certain congruence conditions mod <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – quadratic form <span class="math notranslate nohighlight">\(Q\)</span>, assumed to be block diagonal and <span class="math notranslate nohighlight">\(p\)</span>-integral</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> – an integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Zvec</span></code>, <code class="docutils literal notranslate"><span class="pre">NZvec</span></code> – non-repeating lists of integers in <code class="docutils literal notranslate"><span class="pre">range(self.dim())</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
<p>OUTPUT: a rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/27</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/9</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">8/27</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_density">
<span class="sig-name descname"><span class="pre">local_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_density" title="Permalink to this definition">#</a></dt>
<dd><p>Return the local density.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This screens for imprimitive forms, and puts the quadratic
form in local normal form, which is a <em>requirement</em> of the
routines performing the computations!</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number &gt; 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> – an integer</p></li>
</ul>
<p>OUTPUT: a rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>   <span class="c1"># NOTE: This is already in local normal form for *all* primes p!</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">8/9</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">24/25</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">48/49</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">120/121</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_density_congruence">
<span class="sig-name descname"><span class="pre">local_density_congruence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NZvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_density_congruence" title="Permalink to this definition">#</a></dt>
<dd><p>Find the local density of <span class="math notranslate nohighlight">\(Q\)</span> representing <span class="math notranslate nohighlight">\(m\)</span> at <span class="math notranslate nohighlight">\(p\)</span>,
allowing certain congruence conditions mod <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – quadratic form <span class="math notranslate nohighlight">\(Q\)</span>, assumed to be block diagonal and <span class="math notranslate nohighlight">\(p\)</span>-integral</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> – an integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Zvec</span></code>, <code class="docutils literal notranslate"><span class="pre">NZvec</span></code> – non-repeating lists of integers in <code class="docutils literal notranslate"><span class="pre">range(self.dim())</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
<p>OUTPUT: a rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zvec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">NZvec</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zvec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">NZvec</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">8/9</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zvec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">NZvec</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">24/25</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zvec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">NZvec</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">48/49</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zvec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">NZvec</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">120/121</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">3/2</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">2/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">14/9</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">2/9</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/9</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_genus_symbol">
<span class="sig-name descname"><span class="pre">local_genus_symbol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_genus_symbol" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Conway-Sloane genus symbol of 2 times a quadratic form
defined over <span class="math notranslate nohighlight">\(\ZZ\)</span> at a prime number <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>This is defined (in the class
<a class="reference internal" href="genera/genus.html#sage.quadratic_forms.genera.genus.Genus_Symbol_p_adic_ring" title="sage.quadratic_forms.genera.genus.Genus_Symbol_p_adic_ring"><code class="xref py py-class docutils literal notranslate"><span class="pre">Genus_Symbol_p_adic_ring</span></code></a>)
to be a list of tuples (one for each Jordan component
<span class="math notranslate nohighlight">\(p^m\cdot A\)</span> at <span class="math notranslate nohighlight">\(p\)</span>, where <span class="math notranslate nohighlight">\(A\)</span> is a unimodular symmetric matrix with
coefficients the <span class="math notranslate nohighlight">\(p\)</span>-adic integers) of the following form:</p>
<ul class="simple">
<li><p>If <span class="math notranslate nohighlight">\(p&gt;2\)</span>, then return triples of the form [<span class="math notranslate nohighlight">\(m\)</span>, <span class="math notranslate nohighlight">\(n\)</span>, <span class="math notranslate nohighlight">\(d\)</span>] where</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(m\)</span> = valuation of the component</p></li>
<li><p><span class="math notranslate nohighlight">\(n\)</span> = rank of <span class="math notranslate nohighlight">\(A\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(d\)</span> = det(<span class="math notranslate nohighlight">\(A\)</span>) in {1, <span class="math notranslate nohighlight">\(u\)</span>} for normalized quadratic non-residue <span class="math notranslate nohighlight">\(u\)</span>.</p></li>
</ul>
</li>
<li><p>If <span class="math notranslate nohighlight">\(p=2\)</span>, then return quintuples of the form [<span class="math notranslate nohighlight">\(m\)</span>, <span class="math notranslate nohighlight">\(n\)</span>, <span class="math notranslate nohighlight">\(s\)</span>, <span class="math notranslate nohighlight">\(d\)</span>, <span class="math notranslate nohighlight">\(o\)</span>] where</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(m\)</span> = valuation of the component</p></li>
<li><p><span class="math notranslate nohighlight">\(n\)</span> = rank of <span class="math notranslate nohighlight">\(A\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(d\)</span> = det(<span class="math notranslate nohighlight">\(A\)</span>) in {1, 3, 5, 7}</p></li>
<li><p><span class="math notranslate nohighlight">\(s\)</span> = 0 (or 1) if <span class="math notranslate nohighlight">\(A\)</span> is even (or odd)</p></li>
<li><p><span class="math notranslate nohighlight">\(o\)</span> = oddity of <span class="math notranslate nohighlight">\(A\)</span> (= 0 if <span class="math notranslate nohighlight">\(s\)</span> = 0) in <span class="math notranslate nohighlight">\(\ZZ/8\ZZ\)</span> = the trace of the diagonalization of <span class="math notranslate nohighlight">\(A\)</span></p></li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Conway-Sloane convention for describing the prime <span class="math notranslate nohighlight">\(p = -1\)</span>
is not supported here, and neither is the convention for
including the ‘prime’ Infinity.  See note on p370 of Conway-Sloane
(3rd ed) <a class="reference internal" href="../../../references/index.html#cs1999" id="id3"><span>[CS1999]</span></a> for a discussion of this convention.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number &gt; 0</p></li>
</ul>
<p>OUTPUT:</p>
<p>a Conway-Sloane genus symbol at <span class="math notranslate nohighlight">\(p\)</span>, which is an
instance of the class <a class="reference internal" href="genera/genus.html#sage.quadratic_forms.genera.genus.Genus_Symbol_p_adic_ring" title="sage.quadratic_forms.genera.genus.Genus_Symbol_p_adic_ring"><code class="xref py py-class docutils literal notranslate"><span class="pre">Genus_Symbol_p_adic_ring</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_genus_symbol</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Genus symbol at 2:    [2^-2 4^1 8^1]_6</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_genus_symbol</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Genus symbol at 3:     1^3 3^-1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_genus_symbol</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Genus symbol at 5:     1^4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_good_density_congruence">
<span class="sig-name descname"><span class="pre">local_good_density_congruence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NZvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_good_density_congruence" title="Permalink to this definition">#</a></dt>
<dd><p>Find the Good-type local density of <span class="math notranslate nohighlight">\(Q\)</span> representing <span class="math notranslate nohighlight">\(m\)</span> at <span class="math notranslate nohighlight">\(p\)</span>.
(Front end routine for parity specific routines for <span class="math notranslate nohighlight">\(p\)</span>.)</p>
<div class="admonition-todo admonition" id="id4">
<p class="admonition-title">Todo</p>
<p>Add documentation about the additional congruence
conditions <code class="docutils literal notranslate"><span class="pre">Zvec</span></code> and <code class="docutils literal notranslate"><span class="pre">NZvec</span></code>.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – quadratic form <span class="math notranslate nohighlight">\(Q\)</span>, assumed to be block diagonal and <span class="math notranslate nohighlight">\(p\)</span>-integral</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> – an integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Zvec</span></code>, <code class="docutils literal notranslate"><span class="pre">NZvec</span></code> – non-repeating lists of integers in <code class="docutils literal notranslate"><span class="pre">range(self.dim())</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
<p>OUTPUT: a rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">2/3</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">8/9</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_good_density_congruence_even">
<span class="sig-name descname"><span class="pre">local_good_density_congruence_even</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NZvec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_good_density_congruence_even" title="Permalink to this definition">#</a></dt>
<dd><p>Find the Good-type local density of <span class="math notranslate nohighlight">\(Q\)</span> representing <span class="math notranslate nohighlight">\(m\)</span> at <span class="math notranslate nohighlight">\(p=2\)</span>.
(Assuming <span class="math notranslate nohighlight">\(Q\)</span> is given in local diagonal form.)</p>
<p>The additional congruence condition arguments <code class="docutils literal notranslate"><span class="pre">Zvec</span></code> and <code class="docutils literal notranslate"><span class="pre">NZvec</span></code> can
be either a list of indices or None.  <code class="docutils literal notranslate"><span class="pre">Zvec=[]</span></code> is equivalent to
<code class="docutils literal notranslate"><span class="pre">Zvec=None</span></code> which both impose no additional conditions, but
<code class="docutils literal notranslate"><span class="pre">NZvec=[]</span></code> returns no solutions always while <code class="docutils literal notranslate"><span class="pre">NZvec=None</span></code> imposes no
additional condition.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Here the indices passed in <code class="docutils literal notranslate"><span class="pre">Zvec</span></code> and <code class="docutils literal notranslate"><span class="pre">NZvec</span></code> represent
indices of the solution vector <span class="math notranslate nohighlight">\(x\)</span> of <span class="math notranslate nohighlight">\(Q(x) = m\)</span> (mod <span class="math notranslate nohighlight">\(p^k\)</span>), and <em>not</em>
the Jordan components of <span class="math notranslate nohighlight">\(Q\)</span>.  They therefore are required (and
assumed) to include either all or none of the indices of a given
Jordan component of <span class="math notranslate nohighlight">\(Q\)</span>.  This is only important when <span class="math notranslate nohighlight">\(p=2\)</span> since
otherwise all Jordan blocks are <span class="math notranslate nohighlight">\(1 \times 1\)</span>, and so there the indices and
Jordan blocks coincide.</p>
</div>
<div class="admonition-todo admonition" id="id5">
<p class="admonition-title">Todo</p>
<p>Add type checking for <code class="docutils literal notranslate"><span class="pre">Zvec</span></code> and <code class="docutils literal notranslate"><span class="pre">NZvec</span></code>, and that <span class="math notranslate nohighlight">\(Q\)</span> is in local
normal form.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – quadratic form <span class="math notranslate nohighlight">\(Q\)</span>, assumed to be block diagonal and 2-integral</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> – an integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Zvec</span></code>, <code class="docutils literal notranslate"><span class="pre">NZvec</span></code> – non-repeating lists of integers in <code class="docutils literal notranslate"><span class="pre">range(self.dim())</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
<p>OUTPUT: a rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence_even</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence_even</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence_even</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">3/2</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence_even</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence_even</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1/2</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">15</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 5 1 2 3 ]</span>
<span class="go">[ * 10 5 6 ]</span>
<span class="go">[ * * 15 8 ]</span>
<span class="go">[ * * * 20 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>                                                    <span class="c1"># optional - sage.libs.pari</span>
<span class="go">1 + 2*q^5 + 2*q^10 + 2*q^14 + 2*q^15 + 2*q^16 + 2*q^18 + O(q^20)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_normal_form</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>                                                <span class="c1"># optional - sage.libs.pari sage.rings.padics</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 0 1 0 0 ]</span>
<span class="go">[ * 0 0 0 ]</span>
<span class="go">[ * * 0 1 ]</span>
<span class="go">[ * * * 0 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence_even</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">3/4</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence_even</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence_even</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">3/4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_good_density_congruence_odd">
<span class="sig-name descname"><span class="pre">local_good_density_congruence_odd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NZvec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_good_density_congruence_odd" title="Permalink to this definition">#</a></dt>
<dd><p>Find the Good-type local density of <span class="math notranslate nohighlight">\(Q\)</span> representing <span class="math notranslate nohighlight">\(m\)</span> at <span class="math notranslate nohighlight">\(p\)</span>.
(Assuming that <span class="math notranslate nohighlight">\(p &gt; 2\)</span> and <span class="math notranslate nohighlight">\(Q\)</span> is given in local diagonal form.)</p>
<p>The additional congruence condition arguments <code class="docutils literal notranslate"><span class="pre">Zvec</span></code> and <code class="docutils literal notranslate"><span class="pre">NZvec</span></code> can
be either a list of indices or None.  <code class="docutils literal notranslate"><span class="pre">Zvec=[]</span></code> is equivalent to
<code class="docutils literal notranslate"><span class="pre">Zvec=None</span></code>, which both impose no additional conditions, but
<code class="docutils literal notranslate"><span class="pre">NZvec=[]</span></code> returns no solutions always while <code class="docutils literal notranslate"><span class="pre">NZvec=None</span></code> imposes no
additional condition.</p>
<div class="admonition-todo admonition" id="id6">
<p class="admonition-title">Todo</p>
<p>Add type checking for <code class="docutils literal notranslate"><span class="pre">Zvec</span></code>, <code class="docutils literal notranslate"><span class="pre">NZvec</span></code>, and that <span class="math notranslate nohighlight">\(Q\)</span> is in local
normal form.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – quadratic form <span class="math notranslate nohighlight">\(Q\)</span>, assumed to be diagonal and <span class="math notranslate nohighlight">\(p\)</span>-integral</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> – an integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Zvec</span></code>, <code class="docutils literal notranslate"><span class="pre">NZvec</span></code> – non-repeating lists of integers in <code class="docutils literal notranslate"><span class="pre">range(self.dim())</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
<p>OUTPUT: a rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence_odd</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">2/3</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence_odd</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">8/9</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_normal_form">
<span class="sig-name descname"><span class="pre">local_normal_form</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_normal_form" title="Permalink to this definition">#</a></dt>
<dd><p>Return a locally integrally equivalent quadratic form over
the <span class="math notranslate nohighlight">\(p\)</span>-adic integers <span class="math notranslate nohighlight">\(\ZZ_p\)</span> which gives the Jordan decomposition.</p>
<p>The Jordan components are written as sums of blocks of size <span class="math notranslate nohighlight">\(\leq 2\)</span>
and are arranged by increasing scale, and then by increasing norm.
This is equivalent to saying that we put the <span class="math notranslate nohighlight">\(1 \times 1\)</span> blocks before
the <span class="math notranslate nohighlight">\(2 \times 2\)</span> blocks in each Jordan component.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a positive prime number</p></li>
</ul>
<p>OUTPUT: a quadratic form over <span class="math notranslate nohighlight">\(\ZZ\)</span></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Currently this only works for quadratic forms defined over <span class="math notranslate nohighlight">\(\ZZ\)</span>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_normal_form</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">  [ 1 0 ]</span>
<span class="go">  [ * 6 ]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_normal_form</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">  [ 10 0 ]</span>
<span class="go">  [ * 15 ]</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_normal_form</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">  [ 1 0 ]</span>
<span class="go">  [ * 6 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_primitive_density">
<span class="sig-name descname"><span class="pre">local_primitive_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_primitive_density" title="Permalink to this definition">#</a></dt>
<dd><p>Return the local primitive density – should be called by the user. =)</p>
<p>NOTE: This screens for imprimitive forms, and puts the
quadratic form in local normal form, which is a <em>requirement</em> of
the routines performing the computations!</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number &gt; 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> – an integer</p></li>
</ul>
<p>OUTPUT: a rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">15</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 5 1 2 3 ]</span>
<span class="go">[ * 10 5 6 ]</span>
<span class="go">[ * * 15 8 ]</span>
<span class="go">[ * * * 20 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>                                                    <span class="c1"># optional - sage.libs.pari</span>
<span class="go">1 + 2*q^5 + 2*q^10 + 2*q^14 + 2*q^15 + 2*q^16 + 2*q^18 + O(q^20)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_normal_form</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 0 1 0 0 ]</span>
<span class="go">[ * 0 0 0 ]</span>
<span class="go">[ * * 0 1 ]</span>
<span class="go">[ * * * 0 ]</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">3/4</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">24/25</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">3/4</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">3/4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_primitive_density_congruence">
<span class="sig-name descname"><span class="pre">local_primitive_density_congruence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NZvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_primitive_density_congruence" title="Permalink to this definition">#</a></dt>
<dd><p>Find the primitive local density of <span class="math notranslate nohighlight">\(Q\)</span> representing
<span class="math notranslate nohighlight">\(m\)</span> at <span class="math notranslate nohighlight">\(p\)</span>, allowing certain congruence conditions mod <span class="math notranslate nohighlight">\(p\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following routine is not used internally, but is included for consistency.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – quadratic form <span class="math notranslate nohighlight">\(Q\)</span>, assumed to be block diagonal and <span class="math notranslate nohighlight">\(p\)</span>-integral</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> – an integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Zvec</span></code>, <code class="docutils literal notranslate"><span class="pre">NZvec</span></code> – non-repeating lists of integers in <code class="docutils literal notranslate"><span class="pre">range(self.dim())</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
<p>OUTPUT: a rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zvec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">NZvec</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zvec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">NZvec</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">8/9</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zvec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">NZvec</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">24/25</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zvec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">NZvec</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">48/49</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zvec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">NZvec</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">120/121</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">2/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/3</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/27</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/9</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">8/27</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">8/27</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">243</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">8/27</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_representation_conditions">
<span class="sig-name descname"><span class="pre">local_representation_conditions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recompute_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">silent_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_representation_conditions" title="Permalink to this definition">#</a></dt>
<dd><div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This only works correctly for forms in &gt;=3 variables,
which are locally universal at almost all primes!</p>
</div>
<p>This class finds the local conditions for a number to be integrally
represented by an integer-valued quadratic form.  These conditions
are stored in <code class="docutils literal notranslate"><span class="pre">self.__local_representability_conditions</span></code> and
consist of a list of 9 element vectors, with one for each prime
with a local obstruction (though only the first 5 are meaningful
unless <span class="math notranslate nohighlight">\(p=2\)</span>).  The first element is always the prime <span class="math notranslate nohighlight">\(p\)</span> where the
local obstruction occurs, and the next 8 (or 4) entries represent
square-classes in the <span class="math notranslate nohighlight">\(p\)</span>-adic integers <span class="math notranslate nohighlight">\(\ZZ_p\)</span>, and are labeled by the
<span class="math notranslate nohighlight">\(\QQ_p\)</span> square-classes <span class="math notranslate nohighlight">\(t\cdot (\QQ_p)^2\)</span> with <span class="math notranslate nohighlight">\(t\)</span> given as follows:</p>
<ul class="simple">
<li><p>for <span class="math notranslate nohighlight">\(p &gt; 2\)</span>, <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">*</span>&#160; <span class="pre">1</span>&#160; <span class="pre">u</span>&#160; <span class="pre">p</span>&#160; <span class="pre">u</span> <span class="pre">p</span>&#160; <span class="pre">*</span>&#160; <span class="pre">*</span>&#160; <span class="pre">*</span>&#160; <span class="pre">*</span> <span class="pre">]</span></code>,</p></li>
<li><p>for <span class="math notranslate nohighlight">\(p = 2\)</span>, <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">*</span>&#160; <span class="pre">1</span>&#160; <span class="pre">3</span>&#160; <span class="pre">5</span>&#160; <span class="pre">7</span>&#160; <span class="pre">2</span>&#160; <span class="pre">6</span>&#160; <span class="pre">10</span>&#160; <span class="pre">14</span> <span class="pre">]</span></code>.</p></li>
</ul>
<p>The integer appearing in each place tells us how <span class="math notranslate nohighlight">\(p\)</span>-divisible a
number needs to be in that square-class in order to be locally
represented by <span class="math notranslate nohighlight">\(Q\)</span>.  A negative number indicates that the entire <span class="math notranslate nohighlight">\(\QQ_p\)</span>
square-class is not represented, while a positive number <span class="math notranslate nohighlight">\(x\)</span> indicates
that <span class="math notranslate nohighlight">\(t\cdot p^{(2\cdot x)} (\ZZ_p)^2\)</span> is locally represented but <span class="math notranslate nohighlight">\(t\cdot p^{(2\cdot (x-1))}\)</span>
<span class="math notranslate nohighlight">\((\ZZ_p)^2\)</span> is not.</p>
<p>As an example, the vector <code class="docutils literal notranslate"><span class="pre">[2</span>&#160; <span class="pre">3</span>&#160; <span class="pre">0</span>&#160; <span class="pre">0</span>&#160; <span class="pre">0</span>&#160; <span class="pre">0</span>&#160; <span class="pre">2</span>&#160; <span class="pre">0</span>&#160; <span class="pre">infinity]</span></code>
tells us that all positive integers are locally represented at <span class="math notranslate nohighlight">\(p=2\)</span>
except those of the forms:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(2^6\cdot u\cdot r^2\)</span> with <span class="math notranslate nohighlight">\(u = 1\)</span> (mod 8)</p></li>
<li><p><span class="math notranslate nohighlight">\(2^5\cdot u\cdot r^2\)</span> with <span class="math notranslate nohighlight">\(u = 3\)</span> (mod 8)</p></li>
<li><p><span class="math notranslate nohighlight">\(2\cdot u\cdot r^2\)</span> with <span class="math notranslate nohighlight">\(u = 7\)</span> (mod 8)</p></li>
</ul>
<p>At the real numbers, the vector which looks like <code class="docutils literal notranslate"><span class="pre">[infinity,</span> <span class="pre">0,</span> <span class="pre">infinity,</span> <span class="pre">None,</span> <span class="pre">None,</span> <span class="pre">None,</span> <span class="pre">None,</span> <span class="pre">None,</span> <span class="pre">None]</span></code>
means that <span class="math notranslate nohighlight">\(Q\)</span> is negative definite (i.e., the 0 tells us all
positive reals are represented).  The real vector always appears,
and is listed before the other ones.</p>
<p>OUTPUT:</p>
<p>A list of 9-element vectors describing the representation
obstructions at primes dividing the level.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_representation_conditions</span><span class="p">()</span>
<span class="go">This 0-dimensional form only represents zero.</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_representation_conditions</span><span class="p">()</span>
<span class="go">This 1-dimensional form only represents square multiples of 5.</span>

<span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">local_representation_conditions</span><span class="p">()</span>
<span class="go">This 2-dimensional form represents the p-adic integers of even</span>
<span class="go">valuation for all primes p except [2].</span>
<span class="go">For these and the reals, we have:</span>
<span class="go"> Reals:   [0, +Infinity]</span>
<span class="go"> p = 2:   [0, +Infinity, 0, +Infinity, 0, +Infinity, 0, +Infinity]</span>

<span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">local_representation_conditions</span><span class="p">()</span>
<span class="go">This form represents the p-adic integers Z_p for all primes p except</span>
<span class="go">[2].  For these and the reals, we have:</span>
<span class="go"> Reals:   [0, +Infinity]</span>
<span class="go"> p = 2:   [0, 0, 0, +Infinity, 0, 0, 0, 0]</span>

<span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">local_representation_conditions</span><span class="p">()</span>
<span class="go">This form represents the p-adic integers Z_p for all primes p except</span>
<span class="go">[].  For these and the reals, we have:</span>
<span class="go"> Reals:   [0, +Infinity]</span>

<span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">local_representation_conditions</span><span class="p">()</span>
<span class="go">This form represents the p-adic integers Z_p for all primes p except</span>
<span class="go">[3].  For these and the reals, we have:</span>
<span class="go"> Reals:   [0, +Infinity]</span>
<span class="go"> p = 3:   [0, 1, 0, 0]</span>

<span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q2</span><span class="o">.</span><span class="n">local_representation_conditions</span><span class="p">()</span>
<span class="go">This form represents the p-adic integers Z_p for all primes p except</span>
<span class="go">[3].  For these and the reals, we have:</span>
<span class="go"> Reals:   [0, +Infinity]</span>
<span class="go"> p = 3:   [1, 0, 0, 0]</span>

<span class="gp">sage: </span><span class="n">Q3</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q3</span><span class="o">.</span><span class="n">local_representation_conditions</span><span class="p">()</span>
<span class="go">This form represents the p-adic integers Z_p for all primes p except</span>
<span class="go">[].  For these and the reals, we have:</span>
<span class="go"> Reals:   [0, +Infinity]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_zero_density_congruence">
<span class="sig-name descname"><span class="pre">local_zero_density_congruence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NZvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_zero_density_congruence" title="Permalink to this definition">#</a></dt>
<dd><p>Find the Zero-type local density of <span class="math notranslate nohighlight">\(Q\)</span> representing <span class="math notranslate nohighlight">\(m\)</span> at <span class="math notranslate nohighlight">\(p\)</span>,
allowing certain congruence conditions mod <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – quadratic form <span class="math notranslate nohighlight">\(Q\)</span>, assumed to be block diagonal and <span class="math notranslate nohighlight">\(p\)</span>-integral</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> – an integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Zvec</span></code>, <code class="docutils literal notranslate"><span class="pre">NZvec</span></code> – non-repeating lists of integers in <code class="docutils literal notranslate"><span class="pre">range(self.dim())</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
<p>OUTPUT: a rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_zero_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_zero_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1/2</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_zero_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_zero_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">2/9</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_zero_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_zero_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1/4</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_zero_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_zero_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">8/81</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.mass__by_Siegel_densities">
<span class="sig-name descname"><span class="pre">mass__by_Siegel_densities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">odd_algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Pall'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">even_algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Watson'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.mass__by_Siegel_densities" title="Permalink to this definition">#</a></dt>
<dd><p>Return the mass of transformations (det 1 and -1).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is broken right now…</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">odd_algorithm</span></code> – algorithm to be used when <span class="math notranslate nohighlight">\(p&gt;2\)</span>; <code class="docutils literal notranslate"><span class="pre">&quot;Pall&quot;</span></code> (only one choice for now)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">even_algorithm</span></code> – algorithm to be used when <span class="math notranslate nohighlight">\(p=2\)</span>;
either <code class="docutils literal notranslate"><span class="pre">&quot;Kitaoka&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;Watson&quot;</span></code> (the default)</p></li>
</ul>
<p>REFERENCES:</p>
<ul class="simple">
<li><p>Nipp’s Book “Tables of Quaternary Quadratic Forms”.</p></li>
<li><p>Papers of Pall (only for <span class="math notranslate nohighlight">\(p&gt;2\)</span>) and Watson (for <span class="math notranslate nohighlight">\(p=2\)</span> – tricky!).</p></li>
<li><p>Siegel, Milnor-Hussemoller, Conway-Sloane Paper IV, Kitoaka (all of which
have problems…)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">mass__by_Siegel_densities</span><span class="p">();</span> <span class="n">m</span>                                  <span class="c1"># optional - sage.symbolic</span>
<span class="go">1/384</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="n">Q</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">dim</span><span class="p">()))</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>                             <span class="c1"># optional - sage.symbolic</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">mass__by_Siegel_densities</span><span class="p">();</span> <span class="n">m</span>                                  <span class="c1"># optional - sage.symbolic</span>
<span class="go">1/48</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="n">Q</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">dim</span><span class="p">()))</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>                             <span class="c1"># optional - sage.symbolic</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.mass_at_two_by_counting_mod_power">
<span class="sig-name descname"><span class="pre">mass_at_two_by_counting_mod_power</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.mass_at_two_by_counting_mod_power" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the local mass at <span class="math notranslate nohighlight">\(p=2\)</span> assuming that it’s stable (mod <span class="math notranslate nohighlight">\(2^k\)</span>).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is <strong>way</strong> too slow to be useful, even when <span class="math notranslate nohighlight">\(k=1\)</span>.</p>
</div>
<div class="admonition-todo admonition" id="id7">
<p class="admonition-title">Todo</p>
<p>Remove this routine, or try to compile it!</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">k</span></code> – an integer <span class="math notranslate nohighlight">\(\geq 1\)</span></p></li>
</ul>
<p>OUTPUT: a rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">mass_at_two_by_counting_mod_power</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.matrix">
<span class="sig-name descname"><span class="pre">matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Hessian matrix <span class="math notranslate nohighlight">\(A\)</span> for which <span class="math notranslate nohighlight">\(Q(X) = (1/2) X^t\cdot A\cdot X\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[ 0  1  2]</span>
<span class="go">[ 1  6  4]</span>
<span class="go">[ 2  4 10]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.minkowski_reduction">
<span class="sig-name descname"><span class="pre">minkowski_reduction</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.minkowski_reduction" title="Permalink to this definition">#</a></dt>
<dd><p>Find a Minkowski-reduced form equivalent to the given one.
This means that</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[Q(v_k) \leq Q(s_1\cdot v_1 + ... + s_n\cdot v_n)\]</div>
</div>
<p>for all <span class="math notranslate nohighlight">\(s_i\)</span> where <span class="math notranslate nohighlight">\(\gcd(s_k, ... s_n) = 1\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When <span class="math notranslate nohighlight">\(Q\)</span> has dim <span class="math notranslate nohighlight">\(\leq 4\)</span> we can take all <span class="math notranslate nohighlight">\(s_i\)</span> in <span class="math notranslate nohighlight">\(\{1, 0, -1\}\)</span>.</p>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li><p>Schulze-Pillot’s paper on “An algorithm for computing genera
of ternary and quaternary quadratic forms”, p138.</p></li>
<li><p>Donaldson’s 1979 paper “Minkowski Reduction of Integral Matrices”, p203.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">110</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 30 17 11 12 ]</span>
<span class="go">[ * 29 25 62 ]</span>
<span class="go">[ * * 64 25 ]</span>
<span class="go">[ * * * 110 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">minkowski_reduction</span><span class="p">()</span>
<span class="go">(</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 30 17 11 -5 ]</span>
<span class="go">[ * 29 25 4 ]</span>
<span class="go">[ * * 64 0 ]</span>
<span class="go">[ * * * 77 ]                                                       ,</span>

<span class="go">[ 1  0  0  0]</span>
<span class="go">[ 0  1  0 -1]</span>
<span class="go">[ 0  0  1  0]</span>
<span class="go">[ 0  0  0  1]</span>
<span class="go">)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">4</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 -2 0 0 ]</span>
<span class="go">[ * 2 0 0 ]</span>
<span class="go">[ * * 2 0 ]</span>
<span class="go">[ * * * 2 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">minkowski_reduction</span><span class="p">()</span>
<span class="go">(</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 0 0 ]</span>
<span class="go">[ * 1 0 0 ]</span>
<span class="go">[ * * 2 0 ]</span>
<span class="go">[ * * * 2 ]                                                        ,</span>

<span class="go">[1 1 0 0]</span>
<span class="go">[0 1 0 0]</span>
<span class="go">[0 0 1 0]</span>
<span class="go">[0 0 0 1]</span>
<span class="go">)</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">5</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">Gram_matrix</span><span class="p">()</span>
<span class="go">[2 1 0 0 0]</span>
<span class="go">[1 2 1 0 0]</span>
<span class="go">[0 1 2 1 0]</span>
<span class="go">[0 0 1 2 1]</span>
<span class="go">[0 0 0 1 2]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">minkowski_reduction</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError: this algorithm is only for dimensions less than 5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.minkowski_reduction_for_4vars__SP">
<span class="sig-name descname"><span class="pre">minkowski_reduction_for_4vars__SP</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.minkowski_reduction_for_4vars__SP" title="Permalink to this definition">#</a></dt>
<dd><p>Find a Minkowski-reduced form equivalent to the given one.
This means that</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[Q(v_k) \leq Q(s_1\cdot v_1 + ... + s_n\cdot v_n)\]</div>
</div>
<p>for all <span class="math notranslate nohighlight">\(s_i\)</span> where GCD(<span class="math notranslate nohighlight">\(s_k, ... s_n\)</span>) = 1.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When <span class="math notranslate nohighlight">\(Q\)</span> has dim <span class="math notranslate nohighlight">\(\leq 4\)</span>, we can take all <span class="math notranslate nohighlight">\(s_i\)</span> in <span class="math notranslate nohighlight">\(\{1, 0, -1\}\)</span>.</p>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li><p>Schulze-Pillot’s paper on “An algorithm for computing genera
of ternary and quaternary quadratic forms”, p138.</p></li>
<li><p>Donaldson’s 1979 paper “Minkowski Reduction of Integral Matrices”, p203.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">29</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">62</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">110</span><span class="p">]);</span> <span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 30 17 11 12 ]</span>
<span class="go">[ * 29 25 62 ]</span>
<span class="go">[ * * 64 25 ]</span>
<span class="go">[ * * * 110 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">minkowski_reduction_for_4vars__SP</span><span class="p">()</span>
<span class="go">(</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 29 -17 25 4 ]</span>
<span class="go">[ * 30 -11 5 ]</span>
<span class="go">[ * * 64 0 ]</span>
<span class="go">[ * * * 77 ]                                                       ,</span>

<span class="go">[ 0  1  0  0]</span>
<span class="go">[ 1  0  0 -1]</span>
<span class="go">[ 0  0  1  0]</span>
<span class="go">[ 0  0  0  1]</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.multiply_variable">
<span class="sig-name descname"><span class="pre">multiply_variable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_place</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.multiply_variable" title="Permalink to this definition">#</a></dt>
<dd><p>Replace the variables <span class="math notranslate nohighlight">\(x_i\)</span> by <span class="math notranslate nohighlight">\(c\cdot x_i\)</span> in the quadratic form
(replacing the original form if the <code class="docutils literal notranslate"><span class="pre">in_place</span></code> flag is True).</p>
<p>Here <span class="math notranslate nohighlight">\(c\)</span> must be an element of the base ring defining the
quadratic form.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">c</span></code> – an element of <code class="docutils literal notranslate"><span class="pre">self.base_ring()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i</span></code> – an integer <span class="math notranslate nohighlight">\(\geq 0\)</span></p></li>
</ul>
<p>OUTPUT: a <a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm" title="sage.quadratic_forms.quadratic_form.QuadraticForm"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuadraticForm</span></code></a> (by default, otherwise none)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">multiply_variable</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 25 0 0 0 ]</span>
<span class="go">[ * 9 0 0 ]</span>
<span class="go">[ * * 5 0 ]</span>
<span class="go">[ * * * 7 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.neighbor_iteration">
<span class="sig-name descname"><span class="pre">neighbor_iteration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seeds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_neighbors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.neighbor_iteration" title="Permalink to this definition">#</a></dt>
<dd><p>Return all classes in the <span class="math notranslate nohighlight">\(p\)</span>-neighbor graph of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>Starting from the given seeds, this function successively
finds <span class="math notranslate nohighlight">\(p\)</span>-neighbors until no new quadratic form (class) is obtained.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">seeds</span></code> – a list of quadratic forms in the same genus</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mass</span></code> – (optional) a rational number; the mass of this genus</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_classes</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">1000</span></code>) break the computation when <code class="docutils literal notranslate"><span class="pre">max_classes</span></code> are found</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – (optional) one of <code class="docutils literal notranslate"><span class="pre">'orbits'</span></code>, <code class="docutils literal notranslate"><span class="pre">'random'</span></code>, <code class="docutils literal notranslate"><span class="pre">'exhaustion'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_random_trys</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">1000</span></code>) the maximum number of neighbors
computed for a single lattice</p></li>
</ul>
<p>OUTPUT: a list of quadratic forms</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.quadratic_form__neighbors</span> <span class="kn">import</span> <span class="n">neighbor_iteration</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
<span class="go">46</span>
<span class="gp">sage: </span><span class="n">mass</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">conway_mass</span><span class="p">()</span>                                                <span class="c1"># optional - sage.symbolic</span>
<span class="gp">sage: </span><span class="n">g1</span> <span class="o">=</span> <span class="n">neighbor_iteration</span><span class="p">([</span><span class="n">Q</span><span class="p">],</span> <span class="mi">3</span><span class="p">,</span>                          <span class="c1"># long time  # optional - sage.symbolic</span>
<span class="gp">....: </span>                        <span class="n">mass</span><span class="o">=</span><span class="n">mass</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;random&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g2</span> <span class="o">=</span> <span class="n">neighbor_iteration</span><span class="p">([</span><span class="n">Q</span><span class="p">],</span> <span class="mi">3</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;exhaustion&#39;</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">g3</span> <span class="o">=</span> <span class="n">neighbor_iteration</span><span class="p">([</span><span class="n">Q</span><span class="p">],</span> <span class="mi">3</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;orbits&#39;</span><span class="p">)</span>                   <span class="c1"># optional - sage.libs.gap</span>
<span class="gp">sage: </span><span class="n">mass</span> <span class="o">==</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">q</span><span class="o">.</span><span class="n">number_of_automorphisms</span><span class="p">()</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">g1</span><span class="p">)</span>   <span class="c1"># long time  # optional - sage.symbolic</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">mass</span> <span class="o">==</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">q</span><span class="o">.</span><span class="n">number_of_automorphisms</span><span class="p">()</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">g2</span><span class="p">)</span>   <span class="c1"># long time  # optional - sage.symbolic</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">mass</span> <span class="o">==</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">q</span><span class="o">.</span><span class="n">number_of_automorphisms</span><span class="p">()</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">g3</span><span class="p">)</span>                <span class="c1"># optional - sage.libs.gap sage.symbolic</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.number_of_automorphisms">
<span class="sig-name descname"><span class="pre">number_of_automorphisms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.number_of_automorphisms" title="Permalink to this definition">#</a></dt>
<dd><p>Return the number of automorphisms (of det <span class="math notranslate nohighlight">\(1\)</span> and <span class="math notranslate nohighlight">\(-1\)</span>) of
the quadratic form.</p>
<p>OUTPUT: an integer <span class="math notranslate nohighlight">\(\geq 2\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">unsafe_initialization</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">number_of_automorphisms</span><span class="p">()</span>
<span class="go">48</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">number_of_automorphisms</span><span class="p">()</span>
<span class="go">384</span>
<span class="gp">sage: </span><span class="mi">2</span><span class="o">^</span><span class="mi">4</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">384</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.omega">
<span class="sig-name descname"><span class="pre">omega</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.omega" title="Permalink to this definition">#</a></dt>
<dd><p>This is the content of the adjoint of the primitive associated quadratic form.</p>
<p>Ref: See Dickson’s “Studies in Number Theory”.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">37</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">omega</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.orbits_lines_mod_p">
<span class="sig-name descname"><span class="pre">orbits_lines_mod_p</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.orbits_lines_mod_p" title="Permalink to this definition">#</a></dt>
<dd><p>Let <span class="math notranslate nohighlight">\((L, q)\)</span> be a lattice. This returns representatives of the
orbits of lines in <span class="math notranslate nohighlight">\(L/pL\)</span> under the orthogonal group of <span class="math notranslate nohighlight">\(q\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number</p></li>
</ul>
<p>OUTPUT: a list of vectors over <code class="docutils literal notranslate"><span class="pre">GF(p)</span></code></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.quadratic_form__neighbors</span> <span class="kn">import</span> <span class="n">orbits_lines_mod_p</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">orbits_lines_mod_p</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>                                               <span class="c1"># optional - sage.libs.gap sage.libs.pari</span>
<span class="go">[(0, 0, 1),</span>
<span class="go">(0, 1, 0),</span>
<span class="go">(0, 1, 1),</span>
<span class="go">(1, 0, 0),</span>
<span class="go">(1, 0, 1),</span>
<span class="go">(1, 1, 0),</span>
<span class="go">(1, 1, 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.parity">
<span class="sig-name descname"><span class="pre">parity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allow_rescaling_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.parity" title="Permalink to this definition">#</a></dt>
<dd><p>Return the parity (“even” or “odd”) of an integer-valued quadratic
form over <span class="math notranslate nohighlight">\(\ZZ\)</span>, defined up to similitude/rescaling of the form so that
its Jordan component of smallest scale is unimodular.  After this
rescaling, we say a form is even if it only represents even numbers,
and odd if it represents some odd number.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">allow_rescaling_flag</span></code> is set to False, then we require that
the quadratic form have a Gram matrix with coefficients in <span class="math notranslate nohighlight">\(\ZZ\)</span>, and
look at the unimodular Jordan block to determine its parity.  This
returns an error if the form is not integer-matrix, meaning that it
has Jordan components at <span class="math notranslate nohighlight">\(p=2\)</span> which do not have an integer scale.</p>
<p>We determine the parity by looking for a <span class="math notranslate nohighlight">\(1 \times 1\)</span> block in the 0-th
Jordan component, after a possible rescaling.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – a quadratic form with base ring <span class="math notranslate nohighlight">\(\ZZ\)</span>, which we may
require to have integer Gram matrix.</p></li>
</ul>
<p>OUTPUT:</p>
<p>One of the strings: “even” or “odd”</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]);</span> <span class="n">Q</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 4 -2 0 ]</span>
<span class="go">[ * 2 3 ]</span>
<span class="go">[ * * 2 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">parity</span><span class="p">()</span>
<span class="go">&#39;even&#39;</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]);</span> <span class="n">Q</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 4 -2 0 ]</span>
<span class="go">[ * 2 3 ]</span>
<span class="go">[ * * 1 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">parity</span><span class="p">()</span>
<span class="go">&#39;even&#39;</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]);</span> <span class="n">Q</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 4 -2 0 ]</span>
<span class="go">[ * 2 2 ]</span>
<span class="go">[ * * 2 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">parity</span><span class="p">()</span>
<span class="go">&#39;even&#39;</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]);</span> <span class="n">Q</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 4 -2 0 ]</span>
<span class="go">[ * 2 2 ]</span>
<span class="go">[ * * 1 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">parity</span><span class="p">()</span>
<span class="go">&#39;odd&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.polynomial">
<span class="sig-name descname"><span class="pre">polynomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.polynomial" title="Permalink to this definition">#</a></dt>
<dd><p>Return the quadratic form as a polynomial in <span class="math notranslate nohighlight">\(n\)</span> variables.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> - a quadratic form over a commutative ring</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">names</span></code> - specification of the names of the variables; see <a class="reference external" href="../../../polynomial_rings/sage/rings/polynomial/polynomial_ring_constructor.html#sage.rings.polynomial.polynomial_ring_constructor.PolynomialRing" title="(in Polynomials v10.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">PolynomialRing()</span></code></a></p></li>
</ul>
<p>OUTPUT: The polynomial form of the quadratic form.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">polynomial</span><span class="p">();</span> <span class="n">P</span>
<span class="go">x0^2 + 3*x1^2 + 5*x2^2 + 7*x3^2</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>                                          <span class="c1"># optional - sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">Z</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">ring_of_integers</span><span class="p">()</span>                                              <span class="c1"># optional - sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span>             <span class="c1"># optional - sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">polynomial</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">);</span> <span class="n">P</span>                                        <span class="c1"># optional - sage.rings.number_field</span>
<span class="go">2*a*y0^2 + 3*a*y0*y1 + (-a + 1)*y1^2 + (2*a + 4)*y2^2</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>                                               <span class="c1"># optional - sage.rings.number_field</span>
<span class="gp">....: </span>                  <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">polynomial</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>                                               <span class="c1"># optional - sage.rings.number_field</span>
<span class="go">a*z0^2 + (3*a)*z0*z1 + (a - 3)*z1^2 + (a + 4)*z2^2</span>
<span class="go">+ (-a + 1)*z0*z3 + (2*a + 4)*z1*z3 + z3^2</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>                                <span class="c1"># optional - sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span>             <span class="c1"># optional - sage.rings.number_field</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">polynomial</span><span class="p">()</span>                                                        <span class="c1"># optional - sage.rings.number_field</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Can only create polynomial rings over commutative rings.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.primitive">
<span class="sig-name descname"><span class="pre">primitive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.primitive" title="Permalink to this definition">#</a></dt>
<dd><p>Return a primitive version of an integer-valued quadratic form, defined over <span class="math notranslate nohighlight">\(\ZZ\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">primitive</span><span class="p">()</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 2 3 ]</span>
<span class="go">[ * 4 ]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">primitive</span><span class="p">()</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 2 ]</span>
<span class="go">[ * 4 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.rational_diagonal_form">
<span class="sig-name descname"><span class="pre">rational_diagonal_form</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">return_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.rational_diagonal_form" title="Permalink to this definition">#</a></dt>
<dd><p>Return a diagonal form equivalent to the given quadratic from
over the fraction field of its defining ring.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">return_matrix</span></code> – (boolean, default: False) also return the
transformation matrix</p></li>
</ul>
<p>OUTPUT: either the diagonal quadratic form <span class="math notranslate nohighlight">\(D\)</span> (if <code class="docutils literal notranslate"><span class="pre">return_matrix</span></code> is false)
or the pair <span class="math notranslate nohighlight">\((D, T)\)</span> (if <code class="docutils literal notranslate"><span class="pre">return_matrix</span></code> is true) where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(D\)</span> – the diagonalized form of this quadratic form</p></li>
<li><p><span class="math notranslate nohighlight">\(T\)</span> – transformation matrix. This is such that
<code class="docutils literal notranslate"><span class="pre">T.transpose()</span> <span class="pre">*</span> <span class="pre">self.matrix()</span> <span class="pre">*</span> <span class="pre">T</span></code> gives <code class="docutils literal notranslate"><span class="pre">D.matrix()</span></code>.</p></li>
</ul>
<p>Both <span class="math notranslate nohighlight">\(D\)</span> and <span class="math notranslate nohighlight">\(T\)</span> are defined over the fraction field of the
base ring of the given form.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 0 1 ]</span>
<span class="go">[ * -1 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">rational_diagonal_form</span><span class="p">()</span>
<span class="go">Quadratic form in 2 variables over Rational Field with coefficients:</span>
<span class="go">[ 1/4 0 ]</span>
<span class="go">[ * -1 ]</span>
</pre></div>
</div>
<p>If we start with a diagonal form, we get back the same form defined
over the fraction field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">rational_diagonal_form</span><span class="p">()</span>
<span class="go">Quadratic form in 4 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 0 0 0 ]</span>
<span class="go">[ * 3 0 0 ]</span>
<span class="go">[ * * 5 0 ]</span>
<span class="go">[ * * * 7 ]</span>
</pre></div>
</div>
<p>In the following example, we check the consistency of the
transformation matrix:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">rational_diagonal_form</span><span class="p">(</span><span class="n">return_matrix</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span>
<span class="go">Quadratic form in 4 variables over Rational Field with coefficients:</span>
<span class="go">[ -1/16 0 0 0 ]</span>
<span class="go">[ * 4 0 0 ]</span>
<span class="go">[ * * 13 0 ]</span>
<span class="go">[ * * * 563/52 ]</span>
<span class="gp">sage: </span><span class="n">T</span>
<span class="go">[     1      0     11 149/26]</span>
<span class="go">[  -1/8      1     -2 -10/13]</span>
<span class="go">[     0      0      1 -29/26]</span>
<span class="go">[     0      0      0      1]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">*</span> <span class="n">Q</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span> <span class="o">*</span> <span class="n">T</span>
<span class="go">[  -1/8      0      0      0]</span>
<span class="go">[     0      8      0      0]</span>
<span class="go">[     0      0     26      0]</span>
<span class="go">[     0      0      0 563/26]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[  -1/8      0      0      0]</span>
<span class="go">[     0      8      0      0]</span>
<span class="go">[     0      0     26      0]</span>
<span class="go">[     0      0      0 563/26]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">18</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 1 0 0 ]</span>
<span class="go">[ * 1 0 0 ]</span>
<span class="go">[ * * 1 0 ]</span>
<span class="go">[ * * * 18 ]</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">rational_diagonal_form</span><span class="p">(</span><span class="n">return_matrix</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">Quadratic form in 4 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 0 0 0 ]</span>
<span class="go">[ * 3/4 0 0 ]</span>
<span class="go">[ * * 1 0 ]</span>
<span class="go">[ * * * 18 ]                                                         ,</span>

<span class="go">[   1 -1/2    0    0]</span>
<span class="go">[   0    1    0    0]</span>
<span class="go">[   0    0    1    0]</span>
<span class="go">[   0    0    0    1]</span>
<span class="go">)</span>
</pre></div>
</div>
<p>PARI returns a singular transformation matrix for this case:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">rational_diagonal_form</span><span class="p">()</span>
<span class="go">Quadratic form in 2 variables over Rational Field with coefficients:</span>
<span class="go">[ 1/2 0 ]</span>
<span class="go">[ * 0 ]</span>
</pre></div>
</div>
<p>This example cannot be computed by PARI:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">RIF</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">__pari__</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">rational_diagonal_form</span><span class="p">()</span>
<span class="go">Quadratic form in 4 variables over Real Interval Field with 53 bits of precision</span>
<span class="go">with coefficients:</span>
<span class="go">[ 5 0.?e-14 0.?e-13 0.?e-13 ]</span>
<span class="go">[ * -0.05000000000000? 0.?e-12 0.?e-12 ]</span>
<span class="go">[ * * 13.00000000000? 0.?e-10 ]</span>
<span class="go">[ * * * 10.8269230769? ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.reciprocal">
<span class="sig-name descname"><span class="pre">reciprocal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.reciprocal" title="Permalink to this definition">#</a></dt>
<dd><p>This gives the reciprocal quadratic form associated to the given form.
This is defined as the multiple of the primitive adjoint with the same
content as the given form.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">37</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">()</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 37 0 0 ]</span>
<span class="go">[ * 37 0 ]</span>
<span class="go">[ * * 1 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">()</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">()</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 0 ]</span>
<span class="go">[ * 1 0 ]</span>
<span class="go">[ * * 37 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">()</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">()</span> <span class="o">==</span> <span class="n">Q</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.reduced_binary_form">
<span class="sig-name descname"><span class="pre">reduced_binary_form</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.reduced_binary_form" title="Permalink to this definition">#</a></dt>
<dd><p>Find a form which is reduced in the sense that no further binary
form reductions can be done to reduce the original form.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">reduced_binary_form</span><span class="p">()</span>                   <span class="c1"># optional - sage.symbolic</span>
<span class="go">(</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 2 -1 ]</span>
<span class="go">[ * 2 ]                                                            ,</span>

<span class="go">[ 0 -1]</span>
<span class="go">[ 1  1]</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.reduced_binary_form1">
<span class="sig-name descname"><span class="pre">reduced_binary_form1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.reduced_binary_form1" title="Permalink to this definition">#</a></dt>
<dd><p>Reduce the form <span class="math notranslate nohighlight">\(ax^2 + bxy+cy^2\)</span> to satisfy the reduced condition <span class="math notranslate nohighlight">\(|b| \le
a \le c\)</span>, with <span class="math notranslate nohighlight">\(b \ge 0\)</span> if <span class="math notranslate nohighlight">\(a = c\)</span>. This reduction occurs within the
proper class, so all transformations are taken to have determinant 1.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">reduced_binary_form1</span><span class="p">()</span>                  <span class="c1"># optional - sage.symbolic</span>
<span class="go">(</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 2 -1 ]</span>
<span class="go">[ * 2 ]                                                            ,</span>

<span class="go">[ 0 -1]</span>
<span class="go">[ 1  1]</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.reduced_ternary_form__Dickson">
<span class="sig-name descname"><span class="pre">reduced_ternary_form__Dickson</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.reduced_ternary_form__Dickson" title="Permalink to this definition">#</a></dt>
<dd><p>Find the unique reduced ternary form according to the conditions
of Dickson’s “Studies in the Theory of Numbers”, pp164-171.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">reduced_ternary_form__Dickson</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.representation_number_list">
<span class="sig-name descname"><span class="pre">representation_number_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.representation_number_list" title="Permalink to this definition">#</a></dt>
<dd><p>Return the vector of representation numbers &lt; B.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">representation_number_list</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>                                      <span class="c1"># optional - sage.libs.pari</span>
<span class="go">[1, 16, 112, 448, 1136, 2016, 3136, 5504, 9328, 12112]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.representation_vector_list">
<span class="sig-name descname"><span class="pre">representation_vector_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxvectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.representation_vector_list" title="Permalink to this definition">#</a></dt>
<dd><p>Find all vectors <span class="math notranslate nohighlight">\(v\)</span> where <span class="math notranslate nohighlight">\(Q(v) &lt; B\)</span>.</p>
<p>This only works for positive definite quadratic forms.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">representation_vector_list</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>                                      <span class="c1"># optional - sage.libs.pari</span>
<span class="go">[[(0, 0)],</span>
<span class="go"> [(0, 1), (0, -1), (1, 0), (-1, 0)],</span>
<span class="go"> [(1, 1), (-1, -1), (1, -1), (-1, 1)],</span>
<span class="go"> [],</span>
<span class="go"> [(0, 2), (0, -2), (2, 0), (-2, 0)],</span>
<span class="go"> [(1, 2), (-1, -2), (1, -2), (-1, 2), (2, 1), (-2, -1), (2, -1), (-2, 1)],</span>
<span class="go"> [],</span>
<span class="go"> [],</span>
<span class="go"> [(2, 2), (-2, -2), (2, -2), (-2, 2)],</span>
<span class="go"> [(0, 3), (0, -3), (3, 0), (-3, 0)]]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">_</span><span class="p">))</span>                                                     <span class="c1"># optional - sage.libs.pari</span>
<span class="go">[1, 4, 4, 0, 4, 8, 0, 0, 4, 4]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">representation_number_list</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>                                      <span class="c1"># optional - sage.libs.pari</span>
<span class="go">[1, 4, 4, 0, 4, 8, 0, 0, 4, 4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.scale_by_factor">
<span class="sig-name descname"><span class="pre">scale_by_factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">change_value_ring_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.scale_by_factor" title="Permalink to this definition">#</a></dt>
<dd><p>Scale the values of the quadratic form by the number <span class="math notranslate nohighlight">\(c\)</span>, if
this is possible while still being defined over its base ring.</p>
<p>If the flag is set to true, then this will alter the value ring
to be the field of fractions of the original ring (if necessary).</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">c</span></code> – a scalar in the fraction field of the value ring of the form</p></li>
</ul>
<p>OUTPUT: a quadratic form of the same dimension</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">27</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">scale_by_factor</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 9 0 0 0 ]</span>
<span class="go">[ * 27 0 0 ]</span>
<span class="go">[ * * 54 0 ]</span>
<span class="go">[ * * * 81 ]</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">scale_by_factor</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 0 0 ]</span>
<span class="go">[ * 3 0 0 ]</span>
<span class="go">[ * * 6 0 ]</span>
<span class="go">[ * * * 9 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.set_number_of_automorphisms">
<span class="sig-name descname"><span class="pre">set_number_of_automorphisms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_autos</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.set_number_of_automorphisms" title="Permalink to this definition">#</a></dt>
<dd><p>Set the number of automorphisms to be the value given.  No error
checking is performed, to this may lead to erroneous results.</p>
<p>The fact that this result was set externally is recorded in the
internal list of external initializations, accessible by the
method <a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.list_external_initializations" title="sage.quadratic_forms.quadratic_form.QuadraticForm.list_external_initializations"><code class="xref py py-meth docutils literal notranslate"><span class="pre">list_external_initializations()</span></code></a>.</p>
<p>OUTPUT: None</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">list_external_initializations</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">set_number_of_automorphisms</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">number_of_automorphisms</span><span class="p">()</span>
<span class="go">-3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">list_external_initializations</span><span class="p">()</span>
<span class="go">[&#39;number_of_automorphisms&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.shimura_mass__maximal">
<span class="sig-name descname"><span class="pre">shimura_mass__maximal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.shimura_mass__maximal" title="Permalink to this definition">#</a></dt>
<dd><p>Use Shimura’s exact mass formula to compute the mass of a maximal
quadratic lattice. This works for any totally real number field,
but has a small technical restriction when <span class="math notranslate nohighlight">\(n\)</span> is odd.</p>
<p>OUTPUT:</p>
<p>a rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">shimura_mass__maximal</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.short_primitive_vector_list_up_to_length">
<span class="sig-name descname"><span class="pre">short_primitive_vector_list_up_to_length</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">len_bound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">up_to_sign_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.short_primitive_vector_list_up_to_length" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list of lists of short primitive vectors <span class="math notranslate nohighlight">\(v\)</span>, sorted by length, with
<span class="math notranslate nohighlight">\(Q(v) &lt;\)</span> <code class="docutils literal notranslate"><span class="pre">len_bound</span></code>.  The list in output <span class="math notranslate nohighlight">\([i]\)</span> indexes all vectors of
length <span class="math notranslate nohighlight">\(i\)</span>.  If the <code class="docutils literal notranslate"><span class="pre">up_to_sign_flag</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, then only one of
the vectors of the pair <span class="math notranslate nohighlight">\([v, -v]\)</span> is listed.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This processes the PARI/GP output to always give elements of type <span class="math notranslate nohighlight">\(\ZZ\)</span>.</p>
</div>
<p>OUTPUT: a list of lists of vectors.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">[[(0, 0, 0, 0)],</span>
<span class="go"> [(1, 0, 0, 0)],</span>
<span class="go"> [],</span>
<span class="go"> [(0, 1, 0, 0)],</span>
<span class="go"> [(1, 1, 0, 0), (1, -1, 0, 0), (2, 0, 0, 0)]]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">short_primitive_vector_list_up_to_length</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">[[], [(1, 0, 0, 0)], [], [(0, 1, 0, 0)], [(1, 1, 0, 0), (1, -1, 0, 0)]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.short_vector_list_up_to_length">
<span class="sig-name descname"><span class="pre">short_vector_list_up_to_length</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">len_bound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">up_to_sign_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.short_vector_list_up_to_length" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list of lists of short vectors <span class="math notranslate nohighlight">\(v\)</span>, sorted by length, with
<span class="math notranslate nohighlight">\(Q(v) &lt;\)</span> <code class="docutils literal notranslate"><span class="pre">len_bound</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">len_bound</span></code> – bound for the length of the vectors</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">up_to_sign_flag</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) if set to True, then
only one of the vectors of the pair <span class="math notranslate nohighlight">\([v, -v]\)</span> is listed.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A list of lists of vectors such that entry <span class="math notranslate nohighlight">\([i]\)</span> contains all
vectors of length <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[[(0, 0, 0, 0)], [(1, 0, 0, 0), (-1, 0, 0, 0)], []]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">[[(0, 0, 0, 0)],</span>
<span class="go"> [(1, 0, 0, 0), (-1, 0, 0, 0)],</span>
<span class="go"> [],</span>
<span class="go"> [(0, 1, 0, 0), (0, -1, 0, 0)]]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[[(0, 0, 0, 0)],</span>
<span class="go"> [(1, 0, 0, 0), (-1, 0, 0, 0)],</span>
<span class="go"> [],</span>
<span class="go"> [(0, 1, 0, 0), (0, -1, 0, 0)],</span>
<span class="go"> [(1, 1, 0, 0),</span>
<span class="go">  (-1, -1, 0, 0),</span>
<span class="go">  (1, -1, 0, 0),</span>
<span class="go">  (-1, 1, 0, 0),</span>
<span class="go">  (2, 0, 0, 0),</span>
<span class="go">  (-2, 0, 0, 0)]]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">[[(0, 0, 0, 0)],</span>
<span class="go"> [(1, 0, 0, 0)],</span>
<span class="go"> [],</span>
<span class="go"> [(0, 1, 0, 0)],</span>
<span class="go"> [(1, 1, 0, 0), (1, -1, 0, 0), (2, 0, 0, 0)]]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">matrix</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">vs</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">vs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vs</span><span class="p">))]</span>
<span class="go">[1, 72, 270, 720, 936, 2160, 2214, 3600]</span>
<span class="gp">sage: </span><span class="n">vs</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>  <span class="c1"># long time (28s on sage.math, 2014)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">vs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vs</span><span class="p">))]</span>       <span class="c1"># long time</span>
<span class="go">[1, 72, 270, 720, 936, 2160, 2214, 3600, 4590, 6552, 5184, 10800, 9360, 12240, 13500, 17712, 14760, 25920, 19710, 26064, 28080, 36000, 25920, 47520, 37638, 43272, 45900, 59040, 46800, 75600]</span>
</pre></div>
</div>
<p>The cases of <code class="docutils literal notranslate"><span class="pre">len_bound</span> <span class="pre">&lt;</span> <span class="pre">2</span></code> led to exception or infinite runtime before.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[[(0, 0, 0, 0, 0, 0)]]</span>
</pre></div>
</div>
<p>In the case of quadratic forms that are not positive definite an error is raised.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuadraticForm</span><span class="p">(</span><span class="n">matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]))</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Quadratic form must be positive definite in order to enumerate short vectors</span>
</pre></div>
</div>
<p>Check that PARI does not return vectors which are too long:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">72</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">120</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">len_bound_pari</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="mi">22953421</span> <span class="o">-</span> <span class="mi">2</span><span class="p">;</span> <span class="n">len_bound_pari</span>
<span class="go">45906840</span>
<span class="gp">sage: </span><span class="n">vs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">__pari__</span><span class="p">()</span><span class="o">.</span><span class="n">qfminim</span><span class="p">(</span><span class="n">len_bound_pari</span><span class="p">)[</span><span class="mi">2</span><span class="p">])</span>  <span class="c1"># long time (18s on sage.math, 2014)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">vs</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">v</span>  <span class="c1"># long time</span>
<span class="go">[66, -623]~</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">Vec</span><span class="p">()</span> <span class="o">*</span> <span class="n">Q</span><span class="o">.</span><span class="n">__pari__</span><span class="p">()</span> <span class="o">*</span> <span class="n">v</span>  <span class="c1"># long time</span>
<span class="go">45902280</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.siegel_product">
<span class="sig-name descname"><span class="pre">siegel_product</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.siegel_product" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the infinite product of local densities of the quadratic
form for the number <span class="math notranslate nohighlight">\(u\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">1 + 8*q + 24*q^2 + 32*q^3 + 24*q^4 + 48*q^5 + 96*q^6 + 64*q^7 + 24*q^8 + 104*q^9 + 144*q^10 + O(q^11)</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">siegel_product</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">8</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">siegel_product</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>      <span class="c1"># This one is wrong -- expect 24, and the higher powers of 2 don&#39;t work... =(</span>
<span class="go">24</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">siegel_product</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">32</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">siegel_product</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">48</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">siegel_product</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="go">96</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">siegel_product</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">64</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">siegel_product</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="go">104</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span> <span class="nb">len</span><span class="p">([</span><span class="n">v</span>  <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">mrange</span><span class="p">([</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">])</span>  <span class="k">if</span> <span class="n">Q</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">%</span> <span class="n">M</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">M</span><span class="o">^</span><span class="mi">3</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span> <span class="nb">len</span><span class="p">([</span><span class="n">v</span>  <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">mrange</span><span class="p">([</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">])</span>  <span class="k">if</span> <span class="n">Q</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">%</span> <span class="n">M</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">M</span><span class="o">^</span><span class="mi">3</span>  <span class="c1"># long time (2s on sage.math, 2014)</span>
<span class="go">1</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">3/2</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span> <span class="nb">len</span><span class="p">([</span><span class="n">v</span>  <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">mrange</span><span class="p">([</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">])</span>  <span class="k">if</span> <span class="n">Q</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">%</span> <span class="n">M</span> <span class="o">==</span> <span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">M</span><span class="o">^</span><span class="mi">3</span>
<span class="go">3/2</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span> <span class="nb">len</span><span class="p">([</span><span class="n">v</span>  <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">mrange</span><span class="p">([</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">])</span>  <span class="k">if</span> <span class="n">Q</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">%</span> <span class="n">M</span> <span class="o">==</span> <span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">M</span><span class="o">^</span><span class="mi">3</span>  <span class="c1"># long time (2s on sage.math, 2014)</span>
<span class="go">3/2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.signature">
<span class="sig-name descname"><span class="pre">signature</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.signature" title="Permalink to this definition">#</a></dt>
<dd><p>Return the signature of the quadratic form, defined as:</p>
<blockquote>
<div><p>number of positive eigenvalues <span class="math notranslate nohighlight">\(-\)</span> number of negative eigenvalues</p>
</div></blockquote>
<p>of the matrix of the quadratic form.</p>
<p>OUTPUT: an integer</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">signature</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">signature</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span> <span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 0 1 2 3 ]</span>
<span class="go">[ * 4 5 6 ]</span>
<span class="go">[ * * 7 8 ]</span>
<span class="go">[ * * * 9 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">signature</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.signature_vector">
<span class="sig-name descname"><span class="pre">signature_vector</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.signature_vector" title="Permalink to this definition">#</a></dt>
<dd><p>Return the triple <span class="math notranslate nohighlight">\((p, n, z)\)</span> of integers where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p\)</span> = number of positive eigenvalues</p></li>
<li><p><span class="math notranslate nohighlight">\(n\)</span> = number of negative eigenvalues</p></li>
<li><p><span class="math notranslate nohighlight">\(z\)</span> = number of zero eigenvalues</p></li>
</ul>
<p>for the symmetric matrix associated to <span class="math notranslate nohighlight">\(Q\)</span>.</p>
<p>OUTPUT: a triple of integers <span class="math notranslate nohighlight">\(\geq 0\)</span></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">signature_vector</span><span class="p">()</span>
<span class="go">(1, 1, 2)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">signature_vector</span><span class="p">()</span>
<span class="go">(2, 2, 0)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span> <span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 0 1 2 3 ]</span>
<span class="go">[ * 4 5 6 ]</span>
<span class="go">[ * * 7 8 ]</span>
<span class="go">[ * * * 9 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">signature_vector</span><span class="p">()</span>
<span class="go">(3, 1, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.solve" title="Permalink to this definition">#</a></dt>
<dd><p>Return a vector <span class="math notranslate nohighlight">\(x\)</span> such that <code class="docutils literal notranslate"><span class="pre">self(x)</span> <span class="pre">==</span> <span class="pre">c</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">c</span></code> – (default: 0) a rational number</p></li>
</ul>
<p>OUTPUT: A non-zero vector <span class="math notranslate nohighlight">\(x\)</span> satisfying <code class="docutils literal notranslate"><span class="pre">self(x)</span> <span class="pre">==</span> <span class="pre">c</span></code>.</p>
<p>ALGORITHM:</p>
<p>Uses PARI’s <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/qfsolve">pari:qfsolve</a>. Algorithm described by Jeroen Demeyer; see comments on <a class="reference external" href="https://github.com/sagemath/sage/issues/19112">github issue #19112</a></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]);</span> <span class="n">F</span>
<span class="go">Quadratic form in 2 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 0 ]</span>
<span class="go">[ * -1 ]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="go">(1, 1)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(1, 0)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(3/2, -1/2)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(2, -1)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">(1, 2, -1, -1)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ArithmeticError: no solution found (local obstruction at -1)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span> <span class="n">x</span>
<span class="go">(17, -6)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">5</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ArithmeticError: no solution found (local obstruction at 3)</span>

<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span> <span class="n">x</span>
<span class="go">(3/2, -1/2, 1/2)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">10</span>

<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">solve</span><span class="p">();</span> <span class="n">x</span>
<span class="go">(2, 1)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]);</span> <span class="n">F</span>
<span class="go">Quadratic form in 4 variables over Rational Field with coefficients:</span>
<span class="go">[ 0 0 1 0 ]</span>
<span class="go">[ * 0 0 1 ]</span>
<span class="go">[ * * 0 0 ]</span>
<span class="go">[ * * * 0 ]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
<span class="go">(23, 0, 1, 0)</span>
</pre></div>
</div>
<p>Other fields besides the rationals are currently not supported:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: solving quadratic forms is only implemented over QQ</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.split_local_cover">
<span class="sig-name descname"><span class="pre">split_local_cover</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.split_local_cover" title="Permalink to this definition">#</a></dt>
<dd><p>Tries to find subform of the given (positive definite quaternary)
quadratic form <span class="math notranslate nohighlight">\(Q\)</span> of the form</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[d\cdot x^2 + T(y,z,w)\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(d &gt; 0\)</span> is as small as possible.</p>
<p>This is done by exhaustive search on small vectors, and then
comparing the local conditions of its sum with its complementary
lattice and the original quadratic form <span class="math notranslate nohighlight">\(Q\)</span>.</p>
<p>OUTPUT: a <a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm" title="sage.quadratic_forms.quadratic_form.QuadraticForm"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuadraticForm</span></code></a> over <span class="math notranslate nohighlight">\(\ZZ\)</span></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">split_local_cover</span><span class="p">()</span>                                                <span class="c1"># optional - sage.symbolic</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 3 0 0 ]</span>
<span class="go">[ * 5 0 ]</span>
<span class="go">[ * * 7 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.sum_by_coefficients_with">
<span class="sig-name descname"><span class="pre">sum_by_coefficients_with</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">right</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.sum_by_coefficients_with" title="Permalink to this definition">#</a></dt>
<dd><p>Return the sum (on coefficients) of two quadratic forms of the same size.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">10</span><span class="p">]);</span> <span class="n">Q</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 4 ]</span>
<span class="go">[ * 10 ]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">+</span> <span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 4 0 0 ]</span>
<span class="go">[ * 10 0 0 ]</span>
<span class="go">[ * * 1 4 ]</span>
<span class="go">[ * * * 10 ]</span>

<span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">sum_by_coefficients_with</span><span class="p">(</span><span class="n">Q2</span><span class="p">)</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 2 8 ]</span>
<span class="go">[ * 0 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.swap_variables">
<span class="sig-name descname"><span class="pre">swap_variables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_place</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.swap_variables" title="Permalink to this definition">#</a></dt>
<dd><p>Switch the variables <span class="math notranslate nohighlight">\(x_r\)</span> and <span class="math notranslate nohighlight">\(x_s\)</span> in the quadratic form
(replacing the original form if the <code class="docutils literal notranslate"><span class="pre">in_place</span></code> flag is True).</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">r</span></code>, <code class="docutils literal notranslate"><span class="pre">s</span></code> – integers <span class="math notranslate nohighlight">\(\geq 0\)</span></p></li>
</ul>
<p>OUTPUT:</p>
<p>a <a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm" title="sage.quadratic_forms.quadratic_form.QuadraticForm"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuadraticForm</span></code></a> (by default, otherwise none)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 2 3 4 ]</span>
<span class="go">[ * 5 6 7 ]</span>
<span class="go">[ * * 8 9 ]</span>
<span class="go">[ * * * 10 ]</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">swap_variables</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 8 6 3 9 ]</span>
<span class="go">[ * 5 2 7 ]</span>
<span class="go">[ * * 1 4 ]</span>
<span class="go">[ * * * 10 ]</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">swap_variables</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">swap_variables</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 2 3 4 ]</span>
<span class="go">[ * 5 6 7 ]</span>
<span class="go">[ * * 8 9 ]</span>
<span class="go">[ * * * 10 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.theta_by_cholesky">
<span class="sig-name descname"><span class="pre">theta_by_cholesky</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_prec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.theta_by_cholesky" title="Permalink to this definition">#</a></dt>
<dd><p>Uses the real Cholesky decomposition to compute (the <span class="math notranslate nohighlight">\(q\)</span>-expansion of) the
theta function of the quadratic form as a power series in <span class="math notranslate nohighlight">\(q\)</span> with terms
correct up to the power <span class="math notranslate nohighlight">\(q^{\text{q\_prec}}\)</span>. (So its error is <span class="math notranslate nohighlight">\(O(q^
{\text{q\_prec} + 1})\)</span>.)</p>
<p>REFERENCE:</p>
<p>Cohen’s “A Course in Computational Algebraic Number Theory” book, p 102.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go"># Check the sum of 4 squares form against Jacobi&#39;s formula</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Theta</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">theta_by_cholesky</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Theta</span>
<span class="go">1 + 8*q + 24*q^2 + 32*q^3 + 24*q^4 + 48*q^5 + 96*q^6</span>
<span class="go"> + 64*q^7 + 24*q^8 + 104*q^9 + 144*q^10</span>
<span class="gp">sage: </span><span class="n">Expected</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">8</span><span class="o">*</span><span class="nb">sum</span><span class="p">([</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">divisors</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">if</span> <span class="n">d</span><span class="o">%</span><span class="k">4</span> != 0])
<span class="gp">....: </span>                  <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">Expected</span>
<span class="go">[1, 8, 24, 32, 24, 48, 96, 64, 24, 104, 144]</span>
<span class="gp">sage: </span><span class="n">Theta</span><span class="o">.</span><span class="n">list</span><span class="p">()</span> <span class="o">==</span> <span class="n">Expected</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go"># Check the form x^2 + 3y^2 + 5z^2 + 7w^2 represents everything except 2 and 22.</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Theta</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">theta_by_cholesky</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Theta_list</span> <span class="o">=</span> <span class="n">Theta</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">m</span>  <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Theta_list</span><span class="p">))</span>  <span class="k">if</span> <span class="n">Theta_list</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
<span class="go">[2, 22]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.theta_by_pari">
<span class="sig-name descname"><span class="pre">theta_by_pari</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_str</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'q'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">safe_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.theta_by_pari" title="Permalink to this definition">#</a></dt>
<dd><p>Use PARI/GP to compute the theta function as a power series (or
vector) up to the precision <span class="math notranslate nohighlight">\(O(q^{Max})\)</span>.  This also caches the result
for future computations.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">var_str</span></code> = <code class="docutils literal notranslate"><span class="pre">''</span></code>, then we return a vector <span class="math notranslate nohighlight">\(v\)</span> where <code class="docutils literal notranslate"><span class="pre">v[i]</span></code> counts the
number of vectors of length <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">safe_flag</span></code> allows us to select whether we want a copy of the
output, or the original output.  It is only meaningful when a
vector is returned, otherwise a copy is automatically made in
creating the power series.  By default <code class="docutils literal notranslate"><span class="pre">safe_flag=True</span></code>, so we
return a copy of the cached information.  If this is set to False,
then the routine is much faster but the return values are
vulnerable to being corrupted by the user.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Max</span></code> – an integer <span class="math notranslate nohighlight">\(\geq 0\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">var_str</span></code> – a string</p></li>
</ul>
<p>OUTPUT: a power series or a vector</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Prec</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">sage: </span><span class="n">compute</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">theta_by_pari</span><span class="p">(</span><span class="n">Prec</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>                                   <span class="c1"># optional - sage.libs.pari</span>
<span class="gp">sage: </span><span class="n">exact</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">8</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">([</span><span class="n">d</span>  <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">divisors</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>  <span class="k">if</span> <span class="n">d</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">])</span>      <span class="c1"># optional - sage.libs.pari</span>
<span class="gp">....: </span>               <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Prec</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">compute</span> <span class="o">==</span> <span class="n">exact</span>                                                      <span class="c1"># optional - sage.libs.pari</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.theta_series">
<span class="sig-name descname"><span class="pre">theta_series</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_str</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'q'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">safe_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.theta_series" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the theta series as a power series in the variable given
in <code class="docutils literal notranslate"><span class="pre">var_str</span></code> (which defaults to <code class="docutils literal notranslate"><span class="pre">'q'</span></code>), up to the specified precision
<span class="math notranslate nohighlight">\(O(q^{Max})\)</span>.</p>
<p>This uses the PARI/GP function <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/qfrep">pari:qfrep</a>, wrapped by the
theta_by_pari() method. This caches the result for future
computations.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">safe_flag</span></code> allows us to select whether we want a copy of the
output, or the original output.  It is only meaningful when a
vector is returned, otherwise a copy is automatically made in
creating the power series.  By default <code class="docutils literal notranslate"><span class="pre">safe_flag</span></code> = True, so we
return a copy of the cached information.  If this is set to False,
then the routine is much faster but the return values are
vulnerable to being corrupted by the user.</p>
<div class="admonition-todo admonition" id="id8">
<p class="admonition-title">Todo</p>
<p>Allow the option <code class="docutils literal notranslate"><span class="pre">Max='mod_form'</span></code> to give enough coefficients
to ensure we determine the theta series as a modular form.  This
is related to the Sturm bound, but we will need to be careful about
this (particularly for half-integral weights!).</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">theta_series</span><span class="p">()</span>                                                      <span class="c1"># optional - sage.libs.pari</span>
<span class="go">1 + 2*q + 2*q^3 + 6*q^4 + 2*q^5 + 4*q^6 + 6*q^7 + 8*q^8 + 14*q^9 + O(q^10)</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>                                                    <span class="c1"># optional - sage.libs.pari</span>
<span class="go">1 + 2*q + 2*q^3 + 6*q^4 + 2*q^5 + 4*q^6 + 6*q^7 + 8*q^8 + 14*q^9 + 4*q^10</span>
<span class="go">+ 12*q^11 + 18*q^12 + 12*q^13 + 12*q^14 + 8*q^15 + 34*q^16 + 12*q^17 + 8*q^18</span>
<span class="go">+ 32*q^19 + 10*q^20 + 28*q^21 + 16*q^23 + 44*q^24 + O(q^25)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.theta_series_degree_2">
<span class="sig-name descname"><span class="pre">theta_series_degree_2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.theta_series_degree_2" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the theta series of degree 2 for the quadratic form <span class="math notranslate nohighlight">\(Q\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> – an integer</p></li>
</ul>
<p>OUTPUT:</p>
<p>dictionary, where:</p>
<ul class="simple">
<li><p>keys are <span class="math notranslate nohighlight">\({\rm GL}_2(\ZZ)\)</span>-reduced binary quadratic forms (given as triples of
coefficients)</p></li>
<li><p>values are coefficients</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Q2</span><span class="o">.</span><span class="n">theta_series_degree_2</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)]</span>
<span class="go">24</span>
<span class="gp">sage: </span><span class="n">S</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span>
<span class="go">144</span>
<span class="gp">sage: </span><span class="n">S</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span>
<span class="go">192</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Gonzalo Tornaria (2010-03-23)</p></li>
</ul>
<p>REFERENCE:</p>
<ul class="simple">
<li><p>Raum, Ryan, Skoruppa, Tornaria, ‘On Formal Siegel Modular Forms’
(preprint)</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.vectors_by_length">
<span class="sig-name descname"><span class="pre">vectors_by_length</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bound</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.vectors_by_length" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list of short vectors together with their values.</p>
<p>This is a naive algorithm which uses the Cholesky decomposition,
but does not use the LLL-reduction algorithm.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bound</span></code> – an integer <span class="math notranslate nohighlight">\(\geq 0\)</span></p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a list <code class="docutils literal notranslate"><span class="pre">L</span></code> of length (<code class="docutils literal notranslate"><span class="pre">bound</span></code> + 1) whose entry <code class="docutils literal notranslate"><span class="pre">L[i]</span></code> is a list of
all vectors of length <span class="math notranslate nohighlight">\(i\)</span>.</p></li>
</ul>
<p>REFERENCES:</p>
<p>This is a slightly modified version of Cohn’s Algorithm
2.7.5 in “A Course in Computational Number Theory”, with the
increment step moved around and slightly re-indexed to allow clean
looping.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We could speed this up for very skew matrices by using LLL
first, and then changing coordinates back, but for our purposes
the simpler method is efficient enough.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">vectors_by_length</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>                                                <span class="c1"># optional - sage.symbolic</span>
<span class="go">[[[0, 0]],</span>
<span class="go"> [[0, -1], [-1, 0]],</span>
<span class="go"> [[-1, -1], [1, -1]],</span>
<span class="go"> [],</span>
<span class="go"> [[0, -2], [-2, 0]],</span>
<span class="go"> [[-1, -2], [1, -2], [-2, -1], [2, -1]]]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">vectors_by_length</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>                                               <span class="c1"># optional - sage.symbolic</span>
<span class="go">[[[0, 0, 0, 0]],</span>
<span class="go"> [[-1, 0, 0, 0]],</span>
<span class="go"> [],</span>
<span class="go"> [[0, -1, 0, 0]],</span>
<span class="go"> [[-1, -1, 0, 0], [1, -1, 0, 0], [-2, 0, 0, 0]],</span>
<span class="go"> [[0, 0, -1, 0]]]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">Q</span><span class="o">.</span><span class="n">vectors_by_length</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>                                <span class="c1"># optional - sage.symbolic</span>
<span class="go">[1, 12, 12]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">Q</span><span class="o">.</span><span class="n">vectors_by_length</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>                                <span class="c1"># optional - sage.symbolic</span>
<span class="go">[1, 3, 0, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.xi">
<span class="sig-name descname"><span class="pre">xi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.xi" title="Permalink to this definition">#</a></dt>
<dd><p>Return the value of the genus characters Xi_p… which may be missing one character.
We allow -1 as a prime.</p>
<p>REFERENCES:</p>
<p>Dickson’s “Studies in the Theory of Numbers”</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">14</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q1</span><span class="o">.</span><span class="n">omega</span><span class="p">(),</span> <span class="n">Q2</span><span class="o">.</span><span class="n">omega</span><span class="p">()]</span>
<span class="go">[5, 5]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q1</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>                   <span class="c1"># equivalent over Q_5       # optional - sage.libs.pari</span>
<span class="gp">....: </span> <span class="n">Q2</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
<span class="go">[1, 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q1</span><span class="o">.</span><span class="n">xi</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">Q2</span><span class="o">.</span><span class="n">xi</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>                      <span class="c1"># not equivalent over Z_5   # optional - sage.libs.pari</span>
<span class="go">[1, -1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.xi_rec">
<span class="sig-name descname"><span class="pre">xi_rec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.xi_rec" title="Permalink to this definition">#</a></dt>
<dd><p>Return Xi(<span class="math notranslate nohighlight">\(p\)</span>) for the reciprocal form.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">14</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q1</span><span class="o">.</span><span class="n">clifford_conductor</span><span class="p">(),</span>                 <span class="c1"># equivalent over Q         # optional - sage.libs.pari</span>
<span class="gp">....: </span> <span class="n">Q2</span><span class="o">.</span><span class="n">clifford_conductor</span><span class="p">()]</span>
<span class="go">[3, 3]</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_locally_equivalent_to</span><span class="p">(</span><span class="n">Q2</span><span class="p">)</span>           <span class="c1"># not in the same genus     # optional - sage.libs.pari</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q1</span><span class="o">.</span><span class="n">delta</span><span class="p">(),</span> <span class="n">Q2</span><span class="o">.</span><span class="n">delta</span><span class="p">()]</span>                                              <span class="c1"># optional - sage.libs.pari</span>
<span class="go">[480, 480]</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="mi">480</span><span class="p">)</span>                                                           <span class="c1"># optional - sage.libs.pari</span>
<span class="go">2^5 * 3 * 5</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">Q1</span><span class="o">.</span><span class="n">xi_rec</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]))</span>                                      <span class="c1"># optional - sage.libs.pari</span>
<span class="go">[-1, -1, -1, 1]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">Q2</span><span class="o">.</span><span class="n">xi_rec</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]))</span>                                      <span class="c1"># optional - sage.libs.pari</span>
<span class="go">[-1, -1, -1, -1]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.is_QuadraticForm">
<span class="sig-prename descclassname"><span class="pre">sage.quadratic_forms.quadratic_form.</span></span><span class="sig-name descname"><span class="pre">is_QuadraticForm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.is_QuadraticForm" title="Permalink to this definition">#</a></dt>
<dd><p>Determine if the object <code class="docutils literal notranslate"><span class="pre">Q</span></code> is an element of the <a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm" title="sage.quadratic_forms.quadratic_form.QuadraticForm"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuadraticForm</span></code></a> class.</p>
<p>This function is deprecated.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.quadratic_form</span> <span class="kn">import</span> <span class="n">is_QuadraticForm</span>
<span class="gp">sage: </span><span class="n">is_QuadraticForm</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="go">doctest:...: DeprecationWarning: the function is_QuadraticForm is deprecated;</span>
<span class="go">use isinstance(x, sage.quadratic_forms.quadratic_form.QuadraticForm) instead...</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_QuadraticForm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.quadratic_form_from_invariants">
<span class="sig-prename descclassname"><span class="pre">sage.quadratic_forms.quadratic_form.</span></span><span class="sig-name descname"><span class="pre">quadratic_form_from_invariants</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">F</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sminus</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.quadratic_form_from_invariants" title="Permalink to this definition">#</a></dt>
<dd><p>Return a rational quadratic form with given invariants.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">F</span></code> – the base field; currently only <code class="docutils literal notranslate"><span class="pre">QQ</span></code> is allowed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rk</span></code> – integer; the rank</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">det</span></code> – rational; the determinant</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">P</span></code> – a list of primes where Cassel’s Hasse invariant
is negative</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sminus</span></code> – integer; the number of negative eigenvalues
of any Gram matrix</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a quadratic form with the specified invariants</p></li>
</ul>
<p>Let <span class="math notranslate nohighlight">\((a_1, \ldots, a_n)\)</span> be the gram marix of a regular quadratic space.
Then Cassel’s Hasse invariant is defined as</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\prod_{i&lt;j} (a_i,a_j),\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\((a_i,a_j)\)</span> denotes the Hilbert symbol.</p>
<p>ALGORITHM:</p>
<p>We follow <a class="reference internal" href="../../../references/index.html#kir2016" id="id9"><span>[Kir2016]</span></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="n">quadratic_form_from_invariants</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">q</span>
<span class="go">Quadratic form in 2 variables over Rational Field with coefficients:</span>
<span class="go">[ 5 0 ]</span>
<span class="go">[ * -3 ]</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">P</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="binary_qf.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Binary quadratic forms with integer coefficients</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../../index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Home</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2023, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Quadratic forms overview</a><ul>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.DiagonalQuadraticForm"><code class="docutils literal notranslate"><span class="pre">DiagonalQuadraticForm()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm"><code class="docutils literal notranslate"><span class="pre">QuadraticForm</span></code></a><ul>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.CS_genus_symbol_list"><code class="docutils literal notranslate"><span class="pre">CS_genus_symbol_list()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.GHY_mass__maximal"><code class="docutils literal notranslate"><span class="pre">GHY_mass__maximal()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.Gram_det"><code class="docutils literal notranslate"><span class="pre">Gram_det()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.Gram_matrix"><code class="docutils literal notranslate"><span class="pre">Gram_matrix()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.Gram_matrix_rational"><code class="docutils literal notranslate"><span class="pre">Gram_matrix_rational()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.Hessian_matrix"><code class="docutils literal notranslate"><span class="pre">Hessian_matrix()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.Kitaoka_mass_at_2"><code class="docutils literal notranslate"><span class="pre">Kitaoka_mass_at_2()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.Pall_mass_density_at_odd_prime"><code class="docutils literal notranslate"><span class="pre">Pall_mass_density_at_odd_prime()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.Watson_mass_at_2"><code class="docutils literal notranslate"><span class="pre">Watson_mass_at_2()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.add_symmetric"><code class="docutils literal notranslate"><span class="pre">add_symmetric()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.adjoint"><code class="docutils literal notranslate"><span class="pre">adjoint()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.adjoint_primitive"><code class="docutils literal notranslate"><span class="pre">adjoint_primitive()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.anisotropic_primes"><code class="docutils literal notranslate"><span class="pre">anisotropic_primes()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.antiadjoint"><code class="docutils literal notranslate"><span class="pre">antiadjoint()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.automorphism_group"><code class="docutils literal notranslate"><span class="pre">automorphism_group()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.automorphisms"><code class="docutils literal notranslate"><span class="pre">automorphisms()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.base_change_to"><code class="docutils literal notranslate"><span class="pre">base_change_to()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.base_ring"><code class="docutils literal notranslate"><span class="pre">base_ring()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.basiclemma"><code class="docutils literal notranslate"><span class="pre">basiclemma()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.basiclemmavec"><code class="docutils literal notranslate"><span class="pre">basiclemmavec()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.basis_of_short_vectors"><code class="docutils literal notranslate"><span class="pre">basis_of_short_vectors()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.bilinear_map"><code class="docutils literal notranslate"><span class="pre">bilinear_map()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.change_ring"><code class="docutils literal notranslate"><span class="pre">change_ring()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.cholesky_decomposition"><code class="docutils literal notranslate"><span class="pre">cholesky_decomposition()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.clifford_conductor"><code class="docutils literal notranslate"><span class="pre">clifford_conductor()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.clifford_invariant"><code class="docutils literal notranslate"><span class="pre">clifford_invariant()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.coefficients"><code class="docutils literal notranslate"><span class="pre">coefficients()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.complementary_subform_to_vector"><code class="docutils literal notranslate"><span class="pre">complementary_subform_to_vector()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.compute_definiteness"><code class="docutils literal notranslate"><span class="pre">compute_definiteness()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.compute_definiteness_string_by_determinants"><code class="docutils literal notranslate"><span class="pre">compute_definiteness_string_by_determinants()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.content"><code class="docutils literal notranslate"><span class="pre">content()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_cross_product_doubled_power"><code class="docutils literal notranslate"><span class="pre">conway_cross_product_doubled_power()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_diagonal_factor"><code class="docutils literal notranslate"><span class="pre">conway_diagonal_factor()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_mass"><code class="docutils literal notranslate"><span class="pre">conway_mass()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_octane_of_this_unimodular_Jordan_block_at_2"><code class="docutils literal notranslate"><span class="pre">conway_octane_of_this_unimodular_Jordan_block_at_2()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_p_mass"><code class="docutils literal notranslate"><span class="pre">conway_p_mass()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_species_list_at_2"><code class="docutils literal notranslate"><span class="pre">conway_species_list_at_2()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_species_list_at_odd_prime"><code class="docutils literal notranslate"><span class="pre">conway_species_list_at_odd_prime()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_standard_mass"><code class="docutils literal notranslate"><span class="pre">conway_standard_mass()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_standard_p_mass"><code class="docutils literal notranslate"><span class="pre">conway_standard_p_mass()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_type_factor"><code class="docutils literal notranslate"><span class="pre">conway_type_factor()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions"><code class="docutils literal notranslate"><span class="pre">count_congruence_solutions()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__bad_type"><code class="docutils literal notranslate"><span class="pre">count_congruence_solutions__bad_type()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__bad_type_I"><code class="docutils literal notranslate"><span class="pre">count_congruence_solutions__bad_type_I()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__bad_type_II"><code class="docutils literal notranslate"><span class="pre">count_congruence_solutions__bad_type_II()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__good_type"><code class="docutils literal notranslate"><span class="pre">count_congruence_solutions__good_type()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__zero_type"><code class="docutils literal notranslate"><span class="pre">count_congruence_solutions__zero_type()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions_as_vector"><code class="docutils literal notranslate"><span class="pre">count_congruence_solutions_as_vector()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_modp_solutions__by_Gauss_sum"><code class="docutils literal notranslate"><span class="pre">count_modp_solutions__by_Gauss_sum()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.delta"><code class="docutils literal notranslate"><span class="pre">delta()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.det"><code class="docutils literal notranslate"><span class="pre">det()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.dim"><code class="docutils literal notranslate"><span class="pre">dim()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.disc"><code class="docutils literal notranslate"><span class="pre">disc()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.discrec"><code class="docutils literal notranslate"><span class="pre">discrec()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.divide_variable"><code class="docutils literal notranslate"><span class="pre">divide_variable()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.elementary_substitution"><code class="docutils literal notranslate"><span class="pre">elementary_substitution()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.extract_variables"><code class="docutils literal notranslate"><span class="pre">extract_variables()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.find_entry_with_minimal_scale_at_prime"><code class="docutils literal notranslate"><span class="pre">find_entry_with_minimal_scale_at_prime()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.find_p_neighbor_from_vec"><code class="docutils literal notranslate"><span class="pre">find_p_neighbor_from_vec()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.find_primitive_p_divisible_vector__next"><code class="docutils literal notranslate"><span class="pre">find_primitive_p_divisible_vector__next()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.find_primitive_p_divisible_vector__random"><code class="docutils literal notranslate"><span class="pre">find_primitive_p_divisible_vector__random()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.from_polynomial"><code class="docutils literal notranslate"><span class="pre">from_polynomial()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.gcd"><code class="docutils literal notranslate"><span class="pre">gcd()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.genera"><code class="docutils literal notranslate"><span class="pre">genera()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.global_genus_symbol"><code class="docutils literal notranslate"><span class="pre">global_genus_symbol()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.has_equivalent_Jordan_decomposition_at_prime"><code class="docutils literal notranslate"><span class="pre">has_equivalent_Jordan_decomposition_at_prime()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.has_integral_Gram_matrix"><code class="docutils literal notranslate"><span class="pre">has_integral_Gram_matrix()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.hasse_conductor"><code class="docutils literal notranslate"><span class="pre">hasse_conductor()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.hasse_invariant"><code class="docutils literal notranslate"><span class="pre">hasse_invariant()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.hasse_invariant__OMeara"><code class="docutils literal notranslate"><span class="pre">hasse_invariant__OMeara()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_adjoint"><code class="docutils literal notranslate"><span class="pre">is_adjoint()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_anisotropic"><code class="docutils literal notranslate"><span class="pre">is_anisotropic()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_definite"><code class="docutils literal notranslate"><span class="pre">is_definite()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_even"><code class="docutils literal notranslate"><span class="pre">is_even()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_globally_equivalent_to"><code class="docutils literal notranslate"><span class="pre">is_globally_equivalent_to()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_hyperbolic"><code class="docutils literal notranslate"><span class="pre">is_hyperbolic()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_indefinite"><code class="docutils literal notranslate"><span class="pre">is_indefinite()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_isotropic"><code class="docutils literal notranslate"><span class="pre">is_isotropic()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_equivalent_to"><code class="docutils literal notranslate"><span class="pre">is_locally_equivalent_to()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_represented_number"><code class="docutils literal notranslate"><span class="pre">is_locally_represented_number()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_represented_number_at_place"><code class="docutils literal notranslate"><span class="pre">is_locally_represented_number_at_place()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_universal_at_all_places"><code class="docutils literal notranslate"><span class="pre">is_locally_universal_at_all_places()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_universal_at_all_primes"><code class="docutils literal notranslate"><span class="pre">is_locally_universal_at_all_primes()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_universal_at_prime"><code class="docutils literal notranslate"><span class="pre">is_locally_universal_at_prime()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_negative_definite"><code class="docutils literal notranslate"><span class="pre">is_negative_definite()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_odd"><code class="docutils literal notranslate"><span class="pre">is_odd()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_positive_definite"><code class="docutils literal notranslate"><span class="pre">is_positive_definite()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_primitive"><code class="docutils literal notranslate"><span class="pre">is_primitive()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_rationally_isometric"><code class="docutils literal notranslate"><span class="pre">is_rationally_isometric()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_zero"><code class="docutils literal notranslate"><span class="pre">is_zero()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_zero_nonsingular"><code class="docutils literal notranslate"><span class="pre">is_zero_nonsingular()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_zero_singular"><code class="docutils literal notranslate"><span class="pre">is_zero_singular()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.jordan_blocks_by_scale_and_unimodular"><code class="docutils literal notranslate"><span class="pre">jordan_blocks_by_scale_and_unimodular()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.jordan_blocks_in_unimodular_list_by_scale_power"><code class="docutils literal notranslate"><span class="pre">jordan_blocks_in_unimodular_list_by_scale_power()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.level"><code class="docutils literal notranslate"><span class="pre">level()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.level__Tornaria"><code class="docutils literal notranslate"><span class="pre">level__Tornaria()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.level_ideal"><code class="docutils literal notranslate"><span class="pre">level_ideal()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.list_external_initializations"><code class="docutils literal notranslate"><span class="pre">list_external_initializations()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.lll"><code class="docutils literal notranslate"><span class="pre">lll()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_badII_density_congruence"><code class="docutils literal notranslate"><span class="pre">local_badII_density_congruence()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_badI_density_congruence"><code class="docutils literal notranslate"><span class="pre">local_badI_density_congruence()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_bad_density_congruence"><code class="docutils literal notranslate"><span class="pre">local_bad_density_congruence()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_density"><code class="docutils literal notranslate"><span class="pre">local_density()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_density_congruence"><code class="docutils literal notranslate"><span class="pre">local_density_congruence()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_genus_symbol"><code class="docutils literal notranslate"><span class="pre">local_genus_symbol()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_good_density_congruence"><code class="docutils literal notranslate"><span class="pre">local_good_density_congruence()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_good_density_congruence_even"><code class="docutils literal notranslate"><span class="pre">local_good_density_congruence_even()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_good_density_congruence_odd"><code class="docutils literal notranslate"><span class="pre">local_good_density_congruence_odd()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_normal_form"><code class="docutils literal notranslate"><span class="pre">local_normal_form()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_primitive_density"><code class="docutils literal notranslate"><span class="pre">local_primitive_density()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_primitive_density_congruence"><code class="docutils literal notranslate"><span class="pre">local_primitive_density_congruence()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_representation_conditions"><code class="docutils literal notranslate"><span class="pre">local_representation_conditions()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_zero_density_congruence"><code class="docutils literal notranslate"><span class="pre">local_zero_density_congruence()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.mass__by_Siegel_densities"><code class="docutils literal notranslate"><span class="pre">mass__by_Siegel_densities()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.mass_at_two_by_counting_mod_power"><code class="docutils literal notranslate"><span class="pre">mass_at_two_by_counting_mod_power()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.matrix"><code class="docutils literal notranslate"><span class="pre">matrix()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.minkowski_reduction"><code class="docutils literal notranslate"><span class="pre">minkowski_reduction()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.minkowski_reduction_for_4vars__SP"><code class="docutils literal notranslate"><span class="pre">minkowski_reduction_for_4vars__SP()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.multiply_variable"><code class="docutils literal notranslate"><span class="pre">multiply_variable()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.neighbor_iteration"><code class="docutils literal notranslate"><span class="pre">neighbor_iteration()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.number_of_automorphisms"><code class="docutils literal notranslate"><span class="pre">number_of_automorphisms()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.omega"><code class="docutils literal notranslate"><span class="pre">omega()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.orbits_lines_mod_p"><code class="docutils literal notranslate"><span class="pre">orbits_lines_mod_p()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.parity"><code class="docutils literal notranslate"><span class="pre">parity()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.polynomial"><code class="docutils literal notranslate"><span class="pre">polynomial()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.primitive"><code class="docutils literal notranslate"><span class="pre">primitive()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.rational_diagonal_form"><code class="docutils literal notranslate"><span class="pre">rational_diagonal_form()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.reciprocal"><code class="docutils literal notranslate"><span class="pre">reciprocal()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.reduced_binary_form"><code class="docutils literal notranslate"><span class="pre">reduced_binary_form()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.reduced_binary_form1"><code class="docutils literal notranslate"><span class="pre">reduced_binary_form1()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.reduced_ternary_form__Dickson"><code class="docutils literal notranslate"><span class="pre">reduced_ternary_form__Dickson()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.representation_number_list"><code class="docutils literal notranslate"><span class="pre">representation_number_list()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.representation_vector_list"><code class="docutils literal notranslate"><span class="pre">representation_vector_list()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.scale_by_factor"><code class="docutils literal notranslate"><span class="pre">scale_by_factor()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.set_number_of_automorphisms"><code class="docutils literal notranslate"><span class="pre">set_number_of_automorphisms()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.shimura_mass__maximal"><code class="docutils literal notranslate"><span class="pre">shimura_mass__maximal()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.short_primitive_vector_list_up_to_length"><code class="docutils literal notranslate"><span class="pre">short_primitive_vector_list_up_to_length()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.short_vector_list_up_to_length"><code class="docutils literal notranslate"><span class="pre">short_vector_list_up_to_length()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.siegel_product"><code class="docutils literal notranslate"><span class="pre">siegel_product()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.signature"><code class="docutils literal notranslate"><span class="pre">signature()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.signature_vector"><code class="docutils literal notranslate"><span class="pre">signature_vector()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.solve"><code class="docutils literal notranslate"><span class="pre">solve()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.split_local_cover"><code class="docutils literal notranslate"><span class="pre">split_local_cover()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.sum_by_coefficients_with"><code class="docutils literal notranslate"><span class="pre">sum_by_coefficients_with()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.swap_variables"><code class="docutils literal notranslate"><span class="pre">swap_variables()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.theta_by_cholesky"><code class="docutils literal notranslate"><span class="pre">theta_by_cholesky()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.theta_by_pari"><code class="docutils literal notranslate"><span class="pre">theta_by_pari()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.theta_series"><code class="docutils literal notranslate"><span class="pre">theta_series()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.theta_series_degree_2"><code class="docutils literal notranslate"><span class="pre">theta_series_degree_2()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.vectors_by_length"><code class="docutils literal notranslate"><span class="pre">vectors_by_length()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.xi"><code class="docutils literal notranslate"><span class="pre">xi()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.xi_rec"><code class="docutils literal notranslate"><span class="pre">xi_rec()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.is_QuadraticForm"><code class="docutils literal notranslate"><span class="pre">is_QuadraticForm()</span></code></a></li>
<li><a class="reference internal" href="#sage.quadratic_forms.quadratic_form.quadratic_form_from_invariants"><code class="docutils literal notranslate"><span class="pre">quadratic_form_from_invariants()</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/scripts/furo.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="../../../_static/mathjax/tex-chtml.js"></script>
    </body>
</html>