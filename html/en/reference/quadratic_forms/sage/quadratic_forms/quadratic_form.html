<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Quadratic Forms Overview &mdash; Sage Reference Manual v6.8: Quadratic Forms</title>
    
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '6.8',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v6.8: Quadratic Forms" href="../../index.html" />
    <link rel="next" title="Binary Quadratic Forms with Integer Coefficients" href="binary_qf.html" />
    <link rel="prev" title="Quadratic Forms" href="../../index.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="binary_qf.html" title="Binary Quadratic Forms with Integer Coefficients"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../../index.html" title="Quadratic Forms"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../index.html">Quadratic Forms</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="quadratic-forms-overview">
<span id="sage-quadratic-forms-quadratic-form"></span><h1>Quadratic Forms Overview<a class="headerlink" href="#quadratic-forms-overview" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.quadratic_forms.quadratic_form"></span><p>AUTHORS:</p>
<ul class="simple">
<li>Jon Hanke (2007-06-19)</li>
<li>Anna Haensch (2010-07-01): Formatting and ReSTification</li>
</ul>
<dl class="function">
<dt id="sage.quadratic_forms.quadratic_form.DiagonalQuadraticForm">
<tt class="descclassname">sage.quadratic_forms.quadratic_form.</tt><tt class="descname">DiagonalQuadraticForm</tt><big>(</big><em>R</em>, <em>diag</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.DiagonalQuadraticForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a quadratic form over <span class="math">\(R\)</span> which is a sum of squares.</p>
<p>INPUT:</p>
<ul class="simple">
<li><span class="math">\(R\)</span> &#8211; ring</li>
<li><tt class="docutils literal"><span class="pre">diag</span></tt> &#8211; list/tuple of elements coercible to R</li>
</ul>
<p>OUTPUT:</p>
<p>quadratic form</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 0 0 ]</span>
<span class="go">[ * 3 0 0 ]</span>
<span class="go">[ * * 5 0 ]</span>
<span class="go">[ * * * 7 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm">
<em class="property">class </em><tt class="descclassname">sage.quadratic_forms.quadratic_form.</tt><tt class="descname">QuadraticForm</tt><big>(</big><em>R</em>, <em>n=None</em>, <em>entries=None</em>, <em>unsafe_initialization=False</em>, <em>number_of_automorphisms=None</em>, <em>determinant=None</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Sage Reference Manual: Basic Structures v6.8)"><tt class="xref py py-class docutils literal"><span class="pre">sage.structure.sage_object.SageObject</span></tt></a></p>
<p>The <tt class="docutils literal"><span class="pre">QuadraticForm</span></tt> class represents a quadratic form in n variables with
coefficients in the ring R.</p>
<p>INPUT:</p>
<p>The constructor may be called in any of the following ways.</p>
<ol class="arabic simple">
<li><tt class="docutils literal"><span class="pre">QuadraticForm(R,</span> <span class="pre">n,</span> <span class="pre">entries)</span></tt>, where<ul>
<li><span class="math">\(R\)</span> &#8211; ring for which the quadratic form is defined</li>
<li><span class="math">\(n\)</span> &#8211; an integer &gt;= 0</li>
<li><tt class="docutils literal"><span class="pre">entries</span></tt> &#8211; a list of <span class="math">\(n(n+1)/2\)</span> coefficients of the quadratic form
in <span class="math">\(R\)</span> (given lexographically, or equivalently, by rows of the matrix)</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">QuadraticForm(R,</span> <span class="pre">n)</span></tt>, where<ul>
<li><span class="math">\(R\)</span> &#8211; a ring</li>
<li><span class="math">\(n\)</span> &#8211; a symmetric <span class="math">\(n \times n\)</span> matrix with even diagonal (relative to
<span class="math">\(R\)</span>)</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">QuadraticForm(R)</span></tt>, where<ul>
<li><span class="math">\(R\)</span> &#8211; a symmetric <span class="math">\(n \times n\)</span> matrix with even diagonal (relative to
its base ring)</li>
</ul>
</li>
</ol>
<p>If the keyword argument <tt class="docutils literal"><span class="pre">unsafe_initialize</span></tt> is True, then the subsequent
fields may by used to force the external initialization of various fields
of the quadratic form. Currently the only fields which can be set are:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">number_of_automorphisms</span></tt></li>
<li><tt class="docutils literal"><span class="pre">determinant</span></tt></li>
</ul>
<p>OUTPUT:</p>
<p>quadratic form</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 2 3 ]</span>
<span class="go">[ * 4 5 ]</span>
<span class="go">[ * * 6 ]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">/</span><span class="mi">3</span> <span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 3 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 2 3 ]</span>
<span class="go">[ * 4/3 5 ]</span>
<span class="go">[ * * 6 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Rational Field</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">28</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 7 variables over Rational Field with coefficients:</span>
<span class="go">[ 0 1 2 3 4 5 6 ]</span>
<span class="go">[ * 7 8 9 10 11 12 ]</span>
<span class="go">[ * * 13 14 15 16 17 ]</span>
<span class="go">[ * * * 18 19 20 21 ]</span>
<span class="go">[ * * * * 22 23 24 ]</span>
<span class="go">[ * * * * * 25 26 ]</span>
<span class="go">[ * * * * * * 27 ]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">Quadratic form in 2 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 -2 ]</span>
<span class="go">[ * 3 ]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="go">[2 5]</span>
<span class="go">[5 8]</span>
<span class="gp">sage: </span><span class="n">QuadraticForm</span><span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 5 ]</span>
<span class="go">[ * 4 ]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">m</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 5 ]</span>
<span class="go">[ * 4 ]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="n">m</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
<span class="go">Quadratic form in 2 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 5 ]</span>
<span class="go">[ * 4 ]</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.CS_genus_symbol_list">
<tt class="descname">CS_genus_symbol_list</tt><big>(</big><em>force_recomputation=False</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.CS_genus_symbol_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of Conway-Sloane genus symbols in increasing order of primes dividing 2*det.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">CS_genus_symbol_list</span><span class="p">()</span>
<span class="go">[Genus symbol at 2 : [[1, 2, 3, 1, 4], [2, 1, 1, 1, 1], [3, 1, 1, 1, 1]],</span>
<span class="go">Genus symbol at 3 : [[0, 3, 1], [1, 1, -1]]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.GHY_mass__maximal">
<tt class="descname">GHY_mass__maximal</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.GHY_mass__maximal" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the GHY formula to compute the mass of a (maximal?) quadratic
lattice. This works for any number field.</p>
<p>Reference:  See [GHY, Prop 7.4 and 7.5, p121] and [GY, Thrm 10.20, p25].</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>none</dd>
<dt>OUTPUT:</dt>
<dd>a rational number</dd>
</dl>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">GHY_mass__maximal</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.Gram_det">
<tt class="descname">Gram_det</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.Gram_det" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives the determinant of the Gram matrix of Q.</p>
<p>(Note: This is defined over the fraction field of the ring of
the quadratic form, but is often not defined over the same
ring as the quadratic form.)</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">Gram_det</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.Gram_matrix">
<tt class="descname">Gram_matrix</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.Gram_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a (symmetric) Gram matrix A for the quadratic form Q,
meaning that</p>
<div class="math">
\[Q(x) = x^t * A * x,\]</div>
<p>defined over the base ring of Q.  If this is not possible,
then a TypeError is raised.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">Gram_matrix</span><span class="p">();</span> <span class="n">A</span>
<span class="go">[1 0 0 0]</span>
<span class="go">[0 3 0 0]</span>
<span class="go">[0 0 5 0]</span>
<span class="go">[0 0 0 7]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.Gram_matrix_rational">
<tt class="descname">Gram_matrix_rational</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.Gram_matrix_rational" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a (symmetric) Gram matrix A for the quadratic form Q,
meaning that</p>
<div class="math">
\[Q(x) = x^t * A * x,\]</div>
<p>defined over the fraction field of the base ring.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">Gram_matrix_rational</span><span class="p">();</span> <span class="n">A</span>
<span class="go">[1 0 0 0]</span>
<span class="go">[0 3 0 0]</span>
<span class="go">[0 0 5 0]</span>
<span class="go">[0 0 0 7]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.Hessian_matrix">
<tt class="descname">Hessian_matrix</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.Hessian_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Hessian matrix A for which Q(X) = <span class="math">\((1/2) * X^t * A * X\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 2 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 2 ]</span>
<span class="go">[ * 3 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">Hessian_matrix</span><span class="p">()</span>
<span class="go">[2 2]</span>
<span class="go">[2 6]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.Kitaoka_mass_at_2">
<tt class="descname">Kitaoka_mass_at_2</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.Kitaoka_mass_at_2" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the local mass of the quadratic form when <span class="math">\(p=2\)</span>, according
to Theorem 5.6.3 on pp108&#8211;9 of Kitaoka&#8217;s Book &#8220;The Arithmetic of
Quadratic Forms&#8221;.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>none</dd>
<dt>OUTPUT:</dt>
<dd>a rational number &gt; 0</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">Kitaoka_mass_at_2</span><span class="p">()</span>   <span class="c">## WARNING:  WE NEED TO CHECK THIS CAREFULLY!</span>
<span class="go">1/2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.Pall_mass_density_at_odd_prime">
<tt class="descname">Pall_mass_density_at_odd_prime</tt><big>(</big><em>p</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.Pall_mass_density_at_odd_prime" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the local representation density of a form (for
representing itself) defined over <span class="math">\(ZZ\)</span>, at some prime <span class="math">\(p&gt;2\)</span>.</p>
<dl class="docutils">
<dt>REFERENCES:</dt>
<dd>Pall&#8217;s article &#8220;The Weight of a Genus of Positive n-ary Quadratic Forms&#8221;
appearing in Proc. Symp. Pure Math. VIII (1965), pp95&#8211;105.</dd>
<dt>INPUT:</dt>
<dd><span class="math">\(p\)</span> &#8211; a prime number &gt; 2.</dd>
<dt>OUTPUT:</dt>
<dd>a rational number.</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">Pall_mass_density_at_odd_prime</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[(0, Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 0 ]</span>
<span class="go">[ * 1 0 ]</span>
<span class="go">[ * * 1 ])] [(0, 3, 8)] [8/9] 8/9</span>
<span class="go">8/9</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.Watson_mass_at_2">
<tt class="descname">Watson_mass_at_2</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.Watson_mass_at_2" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the local mass of the quadratic form when <span class="math">\(p=2\)</span>, according
to Watson&#8217;s Theorem 1 of &#8220;The 2-adic density of a quadratic form&#8221;
in Mathematika 23 (1976), pp 94&#8211;106.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>none</dd>
<dt>OUTPUT:</dt>
<dd>a rational number</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">Watson_mass_at_2</span><span class="p">()</span>               <span class="c">## WARNING:  WE NEED TO CHECK THIS CAREFULLY!</span>
<span class="go">384</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.add_symmetric">
<tt class="descname">add_symmetric</tt><big>(</big><em>c</em>, <em>i</em>, <em>j</em>, <em>in_place=False</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.add_symmetric" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the substitution <span class="math">\(x_j --&gt; x_j + c*x_i\)</span>, which has the
effect (on associated matrices) of symmetrically adding
<span class="math">\(c * j\)</span>-th row/column to the <span class="math">\(i\)</span>-th row/column.</p>
<p>NOTE: This is meant for compatibility with previous code,
which implemented a matrix model for this class.  It is used
in the local_normal_form() method.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><p class="first"><span class="math">\(c\)</span> &#8211; an element of Q.base_ring()</p>
<p class="last"><span class="math">\(i\)</span>, <span class="math">\(j\)</span> &#8211; integers &gt;= 0</p>
</dd>
<dt>OUTPUT:</dt>
<dd>a QuadraticForm (by default, otherwise none)</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">));</span> <span class="n">Q</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 2 3 ]</span>
<span class="go">[ * 4 5 ]</span>
<span class="go">[ * * 6 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">add_symmetric</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 3 ]</span>
<span class="go">[ * 3 2 ]</span>
<span class="go">[ * * 6 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">add_symmetric</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>     <span class="c">## ERROR: -3/2 isn&#39;t in the base ring ZZ</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">Oops!  This coefficient can&#39;t be coerced to an element of the base ring for the quadratic form.</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">));</span> <span class="n">Q</span>
<span class="go">Quadratic form in 3 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 2 3 ]</span>
<span class="go">[ * 4 5 ]</span>
<span class="go">[ * * 6 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">add_symmetric</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">Quadratic form in 3 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 2 0 ]</span>
<span class="go">[ * 4 2 ]</span>
<span class="go">[ * * 15/4 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.adjoint">
<tt class="descname">adjoint</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.adjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>This gives the adjoint (integral) quadratic form associated to the
given form, essentially defined by taking the adjoint of the matrix.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">adjoint</span><span class="p">()</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 5 -2 ]</span>
<span class="go">[ * 1 ]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">adjoint</span><span class="p">()</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 39 2 8 ]</span>
<span class="go">[ * 19 4 ]</span>
<span class="go">[ * * 8 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.adjoint_primitive">
<tt class="descname">adjoint_primitive</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.adjoint_primitive" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the primitive adjoint of the quadratic form, which is
the smallest discriminant integer-valued quadratic form whose
matrix is a scalar multiple of the inverse of the matrix of
the given quadratic form.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">adjoint_primitive</span><span class="p">()</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 3 -2 ]</span>
<span class="go">[ *  1 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.anisotropic_primes">
<tt class="descname">anisotropic_primes</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.anisotropic_primes" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list with all of the anisotropic primes of the quadratic form.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>None</dd>
<dt>OUTPUT:</dt>
<dd>Returns a list of prime numbers &gt;0.</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">anisotropic_primes</span><span class="p">()</span>
<span class="go">[2]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">anisotropic_primes</span><span class="p">()</span>
<span class="go">[2]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">anisotropic_primes</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.antiadjoint">
<tt class="descname">antiadjoint</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.antiadjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>This gives an (integral) form such that its adjoint is the given form.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">adjoint</span><span class="p">()</span><span class="o">.</span><span class="n">antiadjoint</span><span class="p">()</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 -1 ]</span>
<span class="go">[ * 2 -1 ]</span>
<span class="go">[ * * 5 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">antiadjoint</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">not an adjoint</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.automorphism_group">
<tt class="descname">automorphism_group</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.automorphism_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the group of automorphisms of the quadratic form.</p>
<p>OUTPUT: a <tt class="xref py py-class docutils literal"><span class="pre">MatrixGroup</span></tt></p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">()</span>
<span class="go">Matrix group over Rational Field with 3 generators (</span>
<span class="go">[-1  0  0]  [0 0 1]  [ 0  0  1]</span>
<span class="go">[ 0 -1  0]  [0 1 0]  [-1  0  0]</span>
<span class="go">[ 0  0 -1], [1 0 0], [ 0  1  0]</span>
<span class="go">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">()</span>
<span class="go">Matrix group over Rational Field with 4 generators (</span>
<span class="go">[-1  0  0  0]  [ 1  0  0  0]  [ 1  0  0  0]  [ 1  0  0  0]</span>
<span class="go">[ 0 -1  0  0]  [ 0 -1  0  0]  [ 0  1  0  0]  [ 0  1  0  0]</span>
<span class="go">[ 0  0 -1  0]  [ 0  0  1  0]  [ 0  0 -1  0]  [ 0  0  1  0]</span>
<span class="go">[ 0  0  0 -1], [ 0  0  0  1], [ 0  0  0  1], [ 0  0  0 -1]</span>
<span class="go">)</span>
</pre></div>
</div>
<p>The smallest possible automorphism group has order two, since we
can always change all signs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">()</span>
<span class="go">Matrix group over Rational Field with 1 generators (</span>
<span class="go">[-1  0  0]</span>
<span class="go">[ 0 -1  0]</span>
<span class="go">[ 0  0 -1]</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.automorphisms">
<tt class="descname">automorphisms</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.automorphisms" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of the automorphisms of the quadratic form.</p>
<p>OUTPUT: a list of matrices</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">number_of_automorphisms</span><span class="p">()</span>
<span class="go">48</span>
<span class="gp">sage: </span><span class="mi">2</span><span class="o">^</span><span class="mi">3</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">48</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">automorphisms</span><span class="p">())</span>
<span class="go">48</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">number_of_automorphisms</span><span class="p">()</span>
<span class="go">16</span>
<span class="gp">sage: </span><span class="n">aut</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">automorphisms</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">aut</span><span class="p">)</span>
<span class="go">16</span>
<span class="gp">sage: </span><span class="k">print</span><span class="p">([</span><span class="n">Q</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">==</span> <span class="n">Q</span> <span class="k">for</span> <span class="n">M</span> <span class="ow">in</span> <span class="n">aut</span><span class="p">])</span>
<span class="go">[True, True, True, True, True, True, True, True, True, True, True, True, True, True, True, True]</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">automorphisms</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">[1 0 0]  [-1  0  0]</span>
<span class="go">[0 1 0]  [ 0 -1  0]</span>
<span class="go">[0 0 1], [ 0  0 -1]</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.base_change_to">
<tt class="descname">base_change_to</tt><big>(</big><em>R</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.base_change_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Alters the quadratic form to have all coefficients
defined over the new base_ring R.  Here R must be
coercible to from the current base ring.</p>
<p>Note: This is preferable to performing an explicit
coercion through the base_ring() method, which does
not affect the individual coefficients.  This is
particularly useful for performing fast modular
arithmetic evaluations.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>R &#8211; a ring</dd>
<dt>OUTPUT:</dt>
<dd>quadratic form</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span> <span class="n">Q</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 ]</span>
<span class="go">[ * 1 ]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">base_change_to</span><span class="p">(</span><span class="n">IntegerModRing</span><span class="p">(</span><span class="mi">5</span><span class="p">));</span> <span class="n">Q1</span>
<span class="go">Quadratic form in 2 variables over Ring of integers modulo 5 with coefficients:</span>
<span class="go">[ 1 0 ]</span>
<span class="go">[ * 1 ]</span>

<span class="gp">sage: </span><span class="n">Q1</span><span class="p">([</span><span class="mi">35</span><span class="p">,</span><span class="mi">11</span><span class="p">])</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.base_ring">
<tt class="descname">base_ring</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.base_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives the ring over which the quadratic form is defined.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.basiclemma">
<tt class="descname">basiclemma</tt><big>(</big><em>M</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.basiclemma" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds a number represented by self and coprime to M.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">basiclemma</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="go">71</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.basiclemmavec">
<tt class="descname">basiclemmavec</tt><big>(</big><em>M</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.basiclemmavec" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds a vector where the value of the quadratic form is coprime to M.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">basiclemmavec</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">(6, 5)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">227</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.basis_of_short_vectors">
<tt class="descname">basis_of_short_vectors</tt><big>(</big><em>show_lengths=False</em>, <em>safe_flag=True</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.basis_of_short_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a basis for <span class="math">\(ZZ^n\)</span> made of vectors with minimal lengths Q(<span class="math">\(v\)</span>).</p>
<p>The safe_flag allows us to select whether we want a copy of the
output, or the original output.  By default safe_flag = True, so
we return a copy of the cached information.  If this is set to
False, then the routine is much faster but the return values are
vulnerable to being corrupted by the user.</p>
<dl class="docutils">
<dt>OUTPUT:</dt>
<dd>a list of vectors, and optionally a list of values for each vector.</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">basis_of_short_vectors</span><span class="p">()</span>
<span class="go">[(1, 0, 0, 0), (0, 1, 0, 0), (0, 0, 1, 0), (0, 0, 0, 1)]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">basis_of_short_vectors</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="go">([(1, 0, 0, 0), (0, 1, 0, 0), (0, 0, 1, 0), (0, 0, 0, 1)], [1, 3, 5, 7])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.bilinear_map">
<tt class="descname">bilinear_map</tt><big>(</big><em>v</em>, <em>w</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.bilinear_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the value of the associated bilinear map on two vectors</p>
<p>Given a quadratic form <span class="math">\(Q\)</span> over some base ring <span class="math">\(R\)</span> with
characteristic not equal to 2, this gives the image of two
vectors with coefficients in <span class="math">\(R\)</span> under the associated bilinear
map <span class="math">\(B\)</span>, given by the relation <span class="math">\(2 B(v,w) = Q(v) + Q(w) - Q(v+w)\)</span>.</p>
<p>INPUT:</p>
<p><span class="math">\(v, w\)</span> &#8211; two vectors</p>
<p>OUTPUT:</p>
<p>an element of the base ring <span class="math">\(R\)</span>.</p>
<p>EXAMPLES:</p>
<p>First, an example over <span class="math">\(\ZZ\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">bilinear_map</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">)</span>
<span class="go">8</span>
</pre></div>
</div>
<p>This also works over <span class="math">\(\QQ\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">QQ</span><span class="p">,(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">QQ</span><span class="p">,(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">bilinear_map</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">)</span>
<span class="go">19/4</span>
</pre></div>
</div>
<p>The vectors must have the correct length:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">bilinear_map</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">vectors must have length 3</span>
</pre></div>
</div>
<p>This does not work if the characteristic is 2:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">),[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">bilinear_map</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">not defined for rings of characteristic 2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.cholesky_decomposition">
<tt class="descname">cholesky_decomposition</tt><big>(</big><em>bit_prec=53</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.cholesky_decomposition" title="Permalink to this definition">¶</a></dt>
<dd><p>Give the Cholesky decomposition of this quadratic form <span class="math">\(Q\)</span> as a real matrix
of precision <tt class="docutils literal"><span class="pre">bit_prec</span></tt>.</p>
<dl class="docutils">
<dt>RESTRICTIONS:</dt>
<dd>Q must be given as a QuadraticForm defined over <span class="math">\(\ZZ\)</span>, <span class="math">\(\QQ\)</span>, or some
real field. If it is over some real field, then an error is raised if
the precision given is not less than the defined precision of the real
field defining the quadratic form!</dd>
<dt>REFERENCE:</dt>
<dd>From Cohen&#8217;s &#8220;A Course in Computational Algebraic Number Theory&#8221; book,
p 103.</dd>
<dt>INPUT:</dt>
<dd><tt class="docutils literal"><span class="pre">bit_prec</span></tt> &#8211; a natural number (default 53).</dd>
<dt>OUTPUT:</dt>
<dd>an upper triangular real matrix of precision <tt class="docutils literal"><span class="pre">bit_prec</span></tt>.</dd>
<dt>TO DO:</dt>
<dd>If we only care about working over the real double field (RDF), then we
can use the <tt class="docutils literal"><span class="pre">cholesky()</span></tt> method present for square matrices over that.</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>There is a note in the original code reading</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="c">##/////////////////////////////////////////////////////////////////////////////////////////////////</span>
<span class="c">##/// Finds the Cholesky decomposition of a quadratic form -- as an upper-triangular matrix!</span>
<span class="c">##/// (It&#39;s assumed to be global, hence twice the form it refers to.)  &lt;-- Python revision asks:  Is this true?!? =|</span>
<span class="c">##/////////////////////////////////////////////////////////////////////////////////////////////////</span>
</pre></div>
</div>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">cholesky_decomposition</span><span class="p">()</span>
<span class="go">[ 1.00000000000000 0.000000000000000 0.000000000000000]</span>
<span class="go">[0.000000000000000  1.00000000000000 0.000000000000000]</span>
<span class="go">[0.000000000000000 0.000000000000000  1.00000000000000]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">));</span> <span class="n">Q</span>
<span class="go">Quadratic form in 3 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 2 3 ]</span>
<span class="go">[ * 4 5 ]</span>
<span class="go">[ * * 6 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">cholesky_decomposition</span><span class="p">()</span>
<span class="go">[ 1.00000000000000  1.00000000000000  1.50000000000000]</span>
<span class="go">[0.000000000000000  3.00000000000000 0.333333333333333]</span>
<span class="go">[0.000000000000000 0.000000000000000  3.41666666666667]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.clifford_conductor">
<tt class="descname">clifford_conductor</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.clifford_conductor" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the product of all primes where the Clifford invariant is -1</p>
<p>Note: For ternary forms, this is the discriminant of the
quaternion algebra associated to the quadratic space
(i.e. the even Clifford algebra)</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">clifford_invariant</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">clifford_invariant</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">clifford_conductor</span><span class="p">()</span>
<span class="go">37</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">clifford_conductor</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">clifford_conductor</span><span class="p">()</span>
<span class="go">30</span>
</pre></div>
</div>
<p>For hyperbolic spaces, the clifford conductor is 1:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">clifford_conductor</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">H</span> <span class="o">+</span> <span class="n">H</span><span class="p">)</span><span class="o">.</span><span class="n">clifford_conductor</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">H</span> <span class="o">+</span> <span class="n">H</span> <span class="o">+</span> <span class="n">H</span><span class="p">)</span><span class="o">.</span><span class="n">clifford_conductor</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">H</span> <span class="o">+</span> <span class="n">H</span> <span class="o">+</span> <span class="n">H</span> <span class="o">+</span> <span class="n">H</span><span class="p">)</span><span class="o">.</span><span class="n">clifford_conductor</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.clifford_invariant">
<tt class="descname">clifford_invariant</tt><big>(</big><em>p</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.clifford_invariant" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the Clifford invariant, i.e. the class in the Brauer group of the
Clifford algebra for even dimension, of the even Clifford Algebra for odd dimension.</p>
<p>See Lam (AMS GSM 67) p. 117 for the definition, and p. 119 for the formula
relating it to the Hasse invariant.</p>
<p>EXAMPLES:</p>
<p>For hyperbolic spaces, the clifford invariant is +1:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">clifford_invariant</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">H</span> <span class="o">+</span> <span class="n">H</span><span class="p">)</span><span class="o">.</span><span class="n">clifford_invariant</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">H</span> <span class="o">+</span> <span class="n">H</span> <span class="o">+</span> <span class="n">H</span><span class="p">)</span><span class="o">.</span><span class="n">clifford_invariant</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">H</span> <span class="o">+</span> <span class="n">H</span> <span class="o">+</span> <span class="n">H</span> <span class="o">+</span> <span class="n">H</span><span class="p">)</span><span class="o">.</span><span class="n">clifford_invariant</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.coefficients">
<tt class="descname">coefficients</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.coefficients" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives the matrix of upper triangular coefficients,
by reading across the rows from the main diagonal.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">coefficients</span><span class="p">()</span>
<span class="go">[1, 2, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.complementary_subform_to_vector">
<tt class="descname">complementary_subform_to_vector</tt><big>(</big><em>v</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.complementary_subform_to_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the <span class="math">\((n-1)\)</span>-dim&#8217;l quadratic form orthogonal to the vector <span class="math">\(v\)</span>.</p>
<p>Note: This is usually not a direct summand!</p>
<p>Technical Notes: There is a minor difference in the cancellation
code here (form the C++ version) since the notation Q <span class="math">\([i,j]\)</span> indexes
coefficients of the quadratic polynomial here, not the symmetric
matrix.  Also, it produces a better splitting now, for the full
lattice (as opposed to a sublattice in the C++ code) since we
now extend <span class="math">\(v\)</span> to a unimodular matrix.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><span class="math">\(v\)</span> &#8211; a list of self.dim() integers</dd>
<dt>OUTPUT:</dt>
<dd>a QuadraticForm over <span class="math">\(ZZ\)</span></dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">complementary_subform_to_vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 3 0 0 ]</span>
<span class="go">[ * 5 0 ]</span>
<span class="go">[ * * 7 ]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">complementary_subform_to_vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 12 0 0 ]</span>
<span class="go">[ * 5 0 ]</span>
<span class="go">[ * * 7 ]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">complementary_subform_to_vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 624 -480 -672 ]</span>
<span class="go">[ * 880 -1120 ]</span>
<span class="go">[ * * 1008 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.compute_definiteness">
<tt class="descname">compute_definiteness</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.compute_definiteness" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes whether the given quadratic form is positive-definite,
negative-definite, indefinite, degenerate, or the zero form.</p>
<p>This caches one of the following strings in self.__definiteness_string:
&#8220;pos_def&#8221;, &#8220;neg_def&#8221;, &#8220;indef&#8221;, &#8220;zero&#8221;, &#8220;degenerate&#8221;.  It is called
from all routines like:</p>
<blockquote>
<div>is_positive_definite(), is_negative_definite(), is_indefinite(), etc.</div></blockquote>
<p>Note:  A degenerate form is considered neither definite nor indefinite.
Note:  The zero-dim&#8217;l form is considered both positive definite and negative definite.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>QuadraticForm</dd>
<dt>OUTPUT:</dt>
<dd>boolean</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">compute_definiteness</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_positive_definite</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_negative_definite</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_indefinite</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_definite</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">compute_definiteness</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_positive_definite</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_negative_definite</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_indefinite</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_definite</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">compute_definiteness</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_positive_definite</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_negative_definite</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_indefinite</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_definite</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.compute_definiteness_string_by_determinants">
<tt class="descname">compute_definiteness_string_by_determinants</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.compute_definiteness_string_by_determinants" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the (positive) definiteness of a quadratic form by looking
at the signs of all of its upper-left subdeterminants.  See also
self.compute_definiteness() for more documentation.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>None</dd>
<dt>OUTPUT:</dt>
<dd>string describing the definiteness</dd>
<dt>EXAMPLES:</dt>
<dd>sage: Q = DiagonalQuadraticForm(ZZ, [1,1,1,1,1])
sage: Q.compute_definiteness_string_by_determinants()
&#8216;pos_def&#8217;</dd>
</dl>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">compute_definiteness_string_by_determinants</span><span class="p">()</span>
<span class="go">&#39;zero&#39;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">compute_definiteness_string_by_determinants</span><span class="p">()</span>
<span class="go">&#39;degenerate&#39;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">compute_definiteness_string_by_determinants</span><span class="p">()</span>
<span class="go">&#39;indefinite&#39;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">compute_definiteness_string_by_determinants</span><span class="p">()</span>
<span class="go">&#39;neg_def&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.content">
<tt class="descname">content</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.content" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the GCD of the coefficients of the quadratic form.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Only works over Euclidean domains (probably just <span class="math">\(\ZZ\)</span>).</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span><span class="o">.</span><span class="n">gcd</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">content</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">primitive</span><span class="p">()</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 ]</span>
<span class="go">[ * 2 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.conway_cross_product_doubled_power">
<tt class="descname">conway_cross_product_doubled_power</tt><big>(</big><em>p</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_cross_product_doubled_power" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes twice the power of p which evaluates the &#8216;cross product&#8217;
term in Conway&#8217;s mass formula.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><span class="math">\(p\)</span> &#8211; a prime number &gt; 0</dd>
<dt>OUTPUT:</dt>
<dd>a rational number</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_cross_product_doubled_power</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">18</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_cross_product_doubled_power</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_cross_product_doubled_power</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_cross_product_doubled_power</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_cross_product_doubled_power</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_cross_product_doubled_power</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.conway_diagonal_factor">
<tt class="descname">conway_diagonal_factor</tt><big>(</big><em>p</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_diagonal_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the diagonal factor of Conway&#8217;s <span class="math">\(p\)</span>-mass.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><span class="math">\(p\)</span> &#8211; a prime number &gt; 0</dd>
<dt>OUTPUT:</dt>
<dd>a rational number &gt; 0</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_diagonal_factor</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">81/256</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.conway_mass">
<tt class="descname">conway_mass</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the mass by using the Conway-Sloane mass formula.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>none</dd>
<dt>OUTPUT:</dt>
<dd>a rational number &gt; 0</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_mass</span><span class="p">()</span>
<span class="go">1/48</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_mass</span><span class="p">()</span>
<span class="go">3/16</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_mass</span><span class="p">()</span>
<span class="go">3/32</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.conway_octane_of_this_unimodular_Jordan_block_at_2">
<tt class="descname">conway_octane_of_this_unimodular_Jordan_block_at_2</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_octane_of_this_unimodular_Jordan_block_at_2" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the &#8216;octane&#8217; of this full unimodular Jordan block at
the prime <span class="math">\(p=2\)</span>.  This is an invariant defined <span class="math">\((mod 8)\)</span>, ad.</p>
<p>This assumes that the form is given as a block diagonal form with
unimodular blocks of size &lt;= 2 and the 1x1 blocks are all in the upper
leftmost position.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>none</dd>
<dt>OUTPUT:</dt>
<dd>an integer 0 &lt;= x &lt;= 7</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_octane_of_this_unimodular_Jordan_block_at_2</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">13</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_octane_of_this_unimodular_Jordan_block_at_2</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">13</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_octane_of_this_unimodular_Jordan_block_at_2</span><span class="p">()</span>
<span class="go">7</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.conway_p_mass">
<tt class="descname">conway_p_mass</tt><big>(</big><em>p</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_p_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes Conway&#8217;s <span class="math">\(p\)</span>-mass.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><span class="math">\(p\)</span> &#8211; a prime number &gt; 0</dd>
<dt>OUTPUT:</dt>
<dd>a rational number &gt; 0</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_p_mass</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">16/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_p_mass</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">729/256</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.conway_species_list_at_2">
<tt class="descname">conway_species_list_at_2</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_species_list_at_2" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an integer called the &#8216;species&#8217; which determines the type
of the orthogonal group over the finite field <span class="math">\(F_p\)</span>.</p>
<p>This assumes that the given quadratic form is a unimodular Jordan
block at an odd prime <span class="math">\(p\)</span>.  When the dimension is odd then this
number is always positive, otherwise it may be positive or
negative.</p>
<p>Note: The species of a zero dim&#8217;l form is always 0+, so we
interpret the return value of zero as positive here! =)</p>
<dl class="docutils">
<dt>OUTPUT:</dt>
<dd>a list of integers</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_species_list_at_2</span><span class="p">()</span>
<span class="go">[1, 5, 1, 1, 1, 1]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_species_list_at_2</span><span class="p">()</span>
<span class="go">[1, 3, 1, 1, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.conway_species_list_at_odd_prime">
<tt class="descname">conway_species_list_at_odd_prime</tt><big>(</big><em>p</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_species_list_at_odd_prime" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an integer called the &#8216;species&#8217; which determines the type
of the orthogonal group over the finite field <span class="math">\(F_p\)</span>.</p>
<p>This assumes that the given quadratic form is a unimodular Jordan
block at an odd prime <span class="math">\(p\)</span>.  When the dimension is odd then this
number is always positive, otherwise it may be positive or
negative (or zero, but that is considered positive by convention).</p>
<p>Note: The species of a zero dim&#8217;l form is always 0+, so we
interpret the return value of zero as positive here! =)</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>a positive prime number</dd>
<dt>OUTPUT:</dt>
<dd>a list of integers</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_species_list_at_odd_prime</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[6, 2, 1]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_species_list_at_odd_prime</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[5, 2]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_species_list_at_odd_prime</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[-6, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.conway_standard_mass">
<tt class="descname">conway_standard_mass</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_standard_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the infinite product of the standard mass factors.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>none</dd>
<dt>OUTPUT:</dt>
<dd>a rational number &gt; 0</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_standard_mass</span><span class="p">()</span>
<span class="go">1/6</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_standard_mass</span><span class="p">()</span>
<span class="go">1/6</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.conway_standard_p_mass">
<tt class="descname">conway_standard_p_mass</tt><big>(</big><em>p</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_standard_p_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the standard (generic) Conway-Sloane <span class="math">\(p\)</span>-mass.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><span class="math">\(p\)</span> &#8211; a prime number &gt; 0</dd>
<dt>OUTPUT:</dt>
<dd>a rational number &gt; 0</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_standard_p_mass</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">2/3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.conway_type_factor">
<tt class="descname">conway_type_factor</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_type_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a special factor only present in the mass formula when <span class="math">\(p=2\)</span>.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>none</dd>
<dt>OUTPUT:</dt>
<dd>a rational number</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_type_factor</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions">
<tt class="descname">count_congruence_solutions</tt><big>(</big><em>p</em>, <em>k</em>, <em>m</em>, <em>zvec</em>, <em>nzvec</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions" title="Permalink to this definition">¶</a></dt>
<dd><p>Counts all solutions of Q(<span class="math">\(x\)</span>) <span class="math">\(= m (mod p^k)\)</span> satisfying the
additional congruence conditions described in
QuadraticForm.count_congruence_solutions_as_vector().</p>
<p>INPUT:</p>
<blockquote>
<div><p><span class="math">\(p\)</span> &#8211; prime number &gt; 0</p>
<p><span class="math">\(k\)</span> &#8211; an integer &gt; 0</p>
<p><span class="math">\(m\)</span> &#8211; an integer (depending only on mod <span class="math">\(p^k\)</span>)</p>
<p>zvec, nzvec &#8211; a list of integers in range(self.dim()), or None</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">15</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__bad_type">
<tt class="descname">count_congruence_solutions__bad_type</tt><big>(</big><em>p</em>, <em>k</em>, <em>m</em>, <em>zvec</em>, <em>nzvec</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__bad_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Counts the bad-type solutions of Q(<span class="math">\(x\)</span>) <span class="math">\(= m (mod p^k)\)</span> satisfying the
additional congruence conditions described in
QuadraticForm.count_congruence_solutions_as_vector().</p>
<p>INPUT:</p>
<blockquote>
<div><p><span class="math">\(p\)</span> &#8211; prime number &gt; 0</p>
<p><span class="math">\(k\)</span> &#8211; an integer &gt; 0</p>
<p><span class="math">\(m\)</span> &#8211; an integer (depending only on mod <span class="math">\(p^k\)</span>)</p>
<p>zvec, nzvec &#8211; a list of integers up to dim(Q)</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions__bad_type</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__bad_type_I">
<tt class="descname">count_congruence_solutions__bad_type_I</tt><big>(</big><em>p</em>, <em>k</em>, <em>m</em>, <em>zvec</em>, <em>nzvec</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__bad_type_I" title="Permalink to this definition">¶</a></dt>
<dd><p>Counts the bad-typeI solutions of Q(<span class="math">\(x\)</span>) = <span class="math">\(m (mod p^k)\)</span> satisfying
the additional congruence conditions described in
QuadraticForm.count_congruence_solutions_as_vector().</p>
<p>INPUT:</p>
<blockquote>
<div><p><span class="math">\(p\)</span> &#8211; prime number &gt; 0</p>
<p><span class="math">\(k\)</span> &#8211; an integer &gt; 0</p>
<p><span class="math">\(m\)</span> &#8211; an integer (depending only on mod <span class="math">\(p^k\)</span>)</p>
<p>zvec, nzvec &#8211; a list of integers up to dim(Q)</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions__bad_type_I</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__bad_type_II">
<tt class="descname">count_congruence_solutions__bad_type_II</tt><big>(</big><em>p</em>, <em>k</em>, <em>m</em>, <em>zvec</em>, <em>nzvec</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__bad_type_II" title="Permalink to this definition">¶</a></dt>
<dd><p>Counts the bad-typeII solutions of Q(<span class="math">\(x\)</span>) <span class="math">\(= m (mod p^k)\)</span> satisfying
the additional congruence conditions described in
QuadraticForm.count_congruence_solutions_as_vector().</p>
<p>INPUT:</p>
<blockquote>
<div><p><span class="math">\(p\)</span> &#8211; prime number &gt; 0</p>
<p><span class="math">\(k\)</span> &#8211; an integer &gt; 0</p>
<p><span class="math">\(m\)</span> &#8211; an integer (depending only on mod <span class="math">\(p^k\)</span>)</p>
<p>zvec, nzvec &#8211; a list of integers up to dim(Q)</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions__bad_type_II</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__good_type">
<tt class="descname">count_congruence_solutions__good_type</tt><big>(</big><em>p</em>, <em>k</em>, <em>m</em>, <em>zvec</em>, <em>nzvec</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__good_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Counts the good-type solutions of Q(x) = m (mod p^k) satisfying the
additional congruence conditions described in
QuadraticForm.count_congruence_solutions_as_vector().</p>
<p>INPUT:</p>
<blockquote>
<div><p><span class="math">\(p\)</span> &#8211; prime number &gt; 0</p>
<p><span class="math">\(k\)</span> &#8211; an integer &gt; 0</p>
<p><span class="math">\(m\)</span> &#8211; an integer (depending only on mod <span class="math">\(p^k\)</span>)</p>
<p>zvec, nzvec &#8211; a list of integers up to dim(Q)</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions__good_type</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">12</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__zero_type">
<tt class="descname">count_congruence_solutions__zero_type</tt><big>(</big><em>p</em>, <em>k</em>, <em>m</em>, <em>zvec</em>, <em>nzvec</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__zero_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Counts the zero-type solutions of Q(<span class="math">\(x\)</span>) = <span class="math">\(m (mod p^k)\)</span> satisfying the
additional congruence conditions described in
QuadraticForm.count_congruence_solutions_as_vector().</p>
<p>INPUT:</p>
<blockquote>
<div><p><span class="math">\(p\)</span> &#8211; prime number &gt; 0</p>
<p><span class="math">\(k\)</span> &#8211; an integer &gt; 0</p>
<p><span class="math">\(m\)</span> &#8211; an integer (depending only on mod <span class="math">\(p^k\)</span>)</p>
<p>zvec, nzvec &#8211; a list of integers up to dim(Q)</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions__zero_type</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions_as_vector">
<tt class="descname">count_congruence_solutions_as_vector</tt><big>(</big><em>p</em>, <em>k</em>, <em>m</em>, <em>zvec</em>, <em>nzvec</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions_as_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives the number of integer solution vectors <span class="math">\(x\)</span> satisfying the
congruence Q(<span class="math">\(x\)</span>) <span class="math">\(= m (mod p^k)\)</span> of each solution type (i.e. All,
Good, Zero, Bad, BadI, BadII) which satisfy the additional
congruence conditions of having certain coefficients = 0 (mod <span class="math">\(p\)</span>)
and certain collections of coefficients not congruent to the zero
vector (mod <span class="math">\(p\)</span>).</p>
<p>A solution vector <span class="math">\(x\)</span> satisfies the additional congruence conditions
specified by zvec and nzvec (and therefore is counted) iff both of
the following conditions hold:</p>
<blockquote>
<div><ol class="arabic simple">
<li><span class="math">\(x[i] == 0 (mod p)\)</span> for all <span class="math">\(i\)</span> in zvec</li>
<li><span class="math">\(x[i] != 0 (mod p) for all i\)</span> in nzvec</li>
</ol>
</div></blockquote>
<dl class="docutils">
<dt>REFERENCES: See Hanke&#8217;s (????) paper &#8220;Local Densities and explicit</dt>
<dd>bounds...&#8221;, p??? for the definitions of the solution types and
congruence conditions.</dd>
<dt>INPUT:</dt>
<dd><p class="first"><span class="math">\(p\)</span> &#8211; prime number &gt; 0</p>
<p><span class="math">\(k\)</span> &#8211; an integer &gt; 0</p>
<p><span class="math">\(m\)</span> &#8211; an integer (depending only on mod <span class="math">\(p^k\)</span>)</p>
<p class="last">zvec, nzvec &#8211; a list of integers in range(self.dim()), or None</p>
</dd>
<dt>OUTPUT:</dt>
<dd><dl class="first last docutils">
<dt>a list of six integers &gt;= 0 representing the solution types:</dt>
<dd>[All, Good, Zero, Bad, BadI, BadII]</dd>
</dl>
</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions_as_vector</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[])</span>
<span class="go">[0, 0, 0, 0, 0, 0]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions_as_vector</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="p">[])</span>
<span class="go">[0, 0, 0, 0, 0, 0]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions_as_vector</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[],</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">[6, 6, 0, 0, 0, 0]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions_as_vector</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">[6, 6, 0, 0, 0, 0]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions_as_vector</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">[6, 6, 0, 0, 0, 0]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions_as_vector</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">[15, 12, 1, 2, 0, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.count_modp_solutions__by_Gauss_sum">
<tt class="descname">count_modp_solutions__by_Gauss_sum</tt><big>(</big><em>p</em>, <em>m</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_modp_solutions__by_Gauss_sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of solutions of <span class="math">\(Q(x) = m (mod p)\)</span> of a
non-degenerate quadratic form over the finite field <span class="math">\(Z/pZ\)</span>,
where <span class="math">\(p\)</span> is a prime number &gt; 2.</p>
<p>Note: We adopt the useful convention that a zero-dimensional
quadratic form has exactly one solution always (i.e. the empty
vector).</p>
<p>These are defined in Table 1 on p363 of Hanke&#8217;s &#8220;Local
Densities...&#8221; paper.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><p class="first"><span class="math">\(p\)</span> &#8211; a prime number &gt; 2</p>
<p class="last"><span class="math">\(m\)</span> &#8211; an integer</p>
</dd>
<dt>OUTPUT:</dt>
<dd>an integer &gt;= 0</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">count_modp_solutions__by_Gauss_sum</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>  <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="go">[9, 6, 12]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">count_modp_solutions__by_Gauss_sum</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>  <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="go">[9, 12, 6]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.delta">
<tt class="descname">delta</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.delta" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the omega of the adjoint form,
which is the same as the omega of the reciprocal form.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">37</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">delta</span><span class="p">()</span>
<span class="go">148</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.det">
<tt class="descname">det</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.det" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives the determinant of the Gram matrix of 2*Q, or
equivalently the determinant of the Hessian matrix of Q.</p>
<p>(Note: This is always defined over the same ring as the
quadratic form.)</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
<span class="go">8</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.dim">
<tt class="descname">dim</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives the number of variables of the quadratic form.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.disc">
<tt class="descname">disc</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.disc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the discriminant of the quadratic form, defined as</p>
<ul class="simple">
<li><span class="math">\((-1)^n {\rm det}(B)\)</span> for even dimension <span class="math">\(2n\)</span></li>
<li><span class="math">\({\rm det}(B)/2\)</span> for odd dimension</li>
</ul>
<p>where <span class="math">\(2Q(x) = x^t B x\)</span>.</p>
<p>This agrees with the usual discriminant for binary and ternary quadratic forms.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">disc</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">disc</span><span class="p">()</span>
<span class="go">-4</span>
<span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">disc</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">disc</span><span class="p">()</span>
<span class="go">16</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.discrec">
<tt class="descname">discrec</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.discrec" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the discriminant of the reciprocal form.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">37</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">disc</span><span class="p">()</span>
<span class="go">148</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">discrec</span><span class="p">()</span>
<span class="go">5476</span>
<span class="gp">sage: </span><span class="p">[</span><span class="mi">4</span> <span class="o">*</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">37</span><span class="o">^</span><span class="mi">2</span><span class="p">]</span>
<span class="go">[148, 5476]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.divide_variable">
<tt class="descname">divide_variable</tt><big>(</big><em>c</em>, <em>i</em>, <em>in_place=False</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.divide_variable" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace the variables <span class="math">\(x_i\)</span> by <span class="math">\((x_i)/c\)</span> in the quadratic form
(replacing the original form if the in_place flag is True).</p>
<p>Here <span class="math">\(c\)</span> must be an element of the base_ring defining the
quadratic form, and the division must be defined in the base
ring.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><p class="first"><span class="math">\(c\)</span> &#8211; an element of Q.base_ring()</p>
<p class="last"><span class="math">\(i\)</span> &#8211; an integer &gt;= 0</p>
</dd>
<dt>OUTPUT:</dt>
<dd>a QuadraticForm (by default, otherwise none)</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">divide_variable</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 0 0 ]</span>
<span class="go">[ * 1 0 0 ]</span>
<span class="go">[ * * 5 0 ]</span>
<span class="go">[ * * * 7 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.elementary_substitution">
<tt class="descname">elementary_substitution</tt><big>(</big><em>c</em>, <em>i</em>, <em>j</em>, <em>in_place=False</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.elementary_substitution" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the substitution <span class="math">\(x_i --&gt; x_i + c*x_j\)</span> (replacing the
original form if the in_place flag is True).</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><p class="first"><span class="math">\(c\)</span> &#8211; an element of Q.base_ring()</p>
<p class="last"><span class="math">\(i\)</span>, <span class="math">\(j\)</span> &#8211; integers &gt;= 0</p>
</dd>
<dt>OUTPUT:</dt>
<dd>a QuadraticForm (by default, otherwise none)</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 2 3 4 ]</span>
<span class="go">[ * 5 6 7 ]</span>
<span class="go">[ * * 8 9 ]</span>
<span class="go">[ * * * 10 ]</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">elementary_substitution</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 2 3 6 ]</span>
<span class="go">[ * 5 6 9 ]</span>
<span class="go">[ * * 8 12 ]</span>
<span class="go">[ * * * 15 ]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">R</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 2 3 4 ]</span>
<span class="go">[ * 5 6 7 ]</span>
<span class="go">[ * * 8 9 ]</span>
<span class="go">[ * * * 10 ]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">M</span>
<span class="go">[1 0 0 1]</span>
<span class="go">[0 1 0 0]</span>
<span class="go">[0 0 1 0]</span>
<span class="go">[0 0 0 1]</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 2 3 6 ]</span>
<span class="go">[ * 5 6 9 ]</span>
<span class="go">[ * * 8 12 ]</span>
<span class="go">[ * * * 15 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.extract_variables">
<tt class="descname">extract_variables</tt><big>(</big><em>var_indices</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.extract_variables" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the variables (in order) whose indices are listed in
var_indices, to give a new quadratic form.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>var_indices &#8211; a list of integers &gt;= 0</dd>
<dt>OUTPUT:</dt>
<dd>a QuadraticForm</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span> <span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 0 1 2 3 ]</span>
<span class="go">[ * 4 5 6 ]</span>
<span class="go">[ * * 7 8 ]</span>
<span class="go">[ * * * 9 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">extract_variables</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 4 6 ]</span>
<span class="go">[ * 9 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.find_entry_with_minimal_scale_at_prime">
<tt class="descname">find_entry_with_minimal_scale_at_prime</tt><big>(</big><em>p</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.find_entry_with_minimal_scale_at_prime" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the entry of the quadratic form with minimal scale at the
prime p, preferring diagonal entries in case of a tie.  (I.e.  If
we write the quadratic form as a symmetric matrix M, then this
entry M[i,j] has the minimal valuation at the prime p.)</p>
<p>Note: This answer is independent of the kind of matrix (Gram or
Hessian) associated to the form.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><span class="math">\(p\)</span> &#8211; a prime number &gt; 0</dd>
<dt>OUTPUT:</dt>
<dd>a pair of integers &gt;= 0</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">]);</span> <span class="n">Q</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 6 2 ]</span>
<span class="go">[ * 20 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">find_entry_with_minimal_scale_at_prime</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(0, 1)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">find_entry_with_minimal_scale_at_prime</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(1, 1)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">find_entry_with_minimal_scale_at_prime</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">(0, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.find_p_neighbor_from_vec">
<tt class="descname">find_p_neighbor_from_vec</tt><big>(</big><em>p</em>, <em>v</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.find_p_neighbor_from_vec" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the <span class="math">\(p\)</span>-neighbor of this quadratic form associated to a given
vector <span class="math">\(v\)</span> satisfying:</p>
<ol class="arabic simple">
<li><span class="math">\(Q(v) = 0  \pmod p\)</span></li>
<li><span class="math">\(v\)</span> is a non-singular point of the conic <span class="math">\(Q(v) = 0 \pmod p\)</span>.</li>
</ol>
<p>Reference:  Gonzalo Tornaria&#8217;s Thesis, Thrm 3.5, p34.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">find_p_neighbor_from_vec</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">v</span><span class="p">);</span> <span class="n">X</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 3 10 0 -4 ]</span>
<span class="go">[ * 9 0 -6 ]</span>
<span class="go">[ * * 1 0 ]</span>
<span class="go">[ * * * 2 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.find_primitive_p_divisible_vector__next">
<tt class="descname">find_primitive_p_divisible_vector__next</tt><big>(</big><em>p</em>, <em>v=None</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.find_primitive_p_divisible_vector__next" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the next <span class="math">\(p\)</span>-primitive vector (up to scaling) in <span class="math">\(L/pL\)</span> whose
value is <span class="math">\(p\)</span>-divisible, where the last vector returned was <span class="math">\(v\)</span>.  For
an intial call, no <span class="math">\(v\)</span> needs to be passed.</p>
<p>Returns vectors whose last non-zero entry is normalized to 0 or 1 (so no
lines are counted repeatedly).  The ordering is by increasing the
first non-normalized entry.  If we have tested all (lines of)
vectors, then return None.</p>
<dl class="docutils">
<dt>OUTPUT:</dt>
<dd>vector or None</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">find_primitive_p_divisible_vector__next</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span> <span class="n">v</span>
<span class="go">(1, 1)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">find_primitive_p_divisible_vector__next</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span> <span class="n">v</span>
<span class="go">(1, 0)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">find_primitive_p_divisible_vector__next</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span> <span class="n">v</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.find_primitive_p_divisible_vector__random">
<tt class="descname">find_primitive_p_divisible_vector__random</tt><big>(</big><em>p</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.find_primitive_p_divisible_vector__random" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds a random <span class="math">\(p\)</span>-primitive vector in <span class="math">\(L/pL\)</span> whose value is <span class="math">\(p\)</span>-divisible.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Since there are about <span class="math">\(p^{(n-2)}\)</span> of these lines, we have a <span class="math">\(1/p\)</span>
chance of randomly finding an appropriate vector.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If there are local obstructions for this to happen, then this algorithm
will never terminate... =(  We should check for this too!</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">find_primitive_p_divisible_vector__random</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>    <span class="c"># random</span>
<span class="go">(1, 1)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">find_primitive_p_divisible_vector__random</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>    <span class="c"># random</span>
<span class="go">(1, 0)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">find_primitive_p_divisible_vector__random</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>    <span class="c"># random</span>
<span class="go">(2, 0)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">find_primitive_p_divisible_vector__random</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>    <span class="c"># random</span>
<span class="go">(2, 2)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">find_primitive_p_divisible_vector__random</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>    <span class="c"># random</span>
<span class="go">(3, 3)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">find_primitive_p_divisible_vector__random</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>    <span class="c"># random</span>
<span class="go">(3, 3)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">find_primitive_p_divisible_vector__random</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>    <span class="c"># random</span>
<span class="go">(2, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.gcd">
<tt class="descname">gcd</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.gcd" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the greatest common divisor of the coefficients of the
quadratic form (as a polynomial).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">gcd</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">gcd</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.global_genus_symbol">
<tt class="descname">global_genus_symbol</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.global_genus_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the genus of a two times a quadratic form over ZZ.  These
are defined by a collection of local genus symbols (a la Chapter
15 of Conway-Sloane), and a signature.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">global_genus_symbol</span><span class="p">()</span>
<span class="go">Genus of [2 0 0 0]</span>
<span class="go">[0 4 0 0]</span>
<span class="go">[0 0 6 0]</span>
<span class="go">[0 0 0 8]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">global_genus_symbol</span><span class="p">()</span>
<span class="go">Genus of [ 0  1  2  3]</span>
<span class="go">[ 1  8  5  6]</span>
<span class="go">[ 2  5 14  8]</span>
<span class="go">[ 3  6  8 18]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.has_equivalent_Jordan_decomposition_at_prime">
<tt class="descname">has_equivalent_Jordan_decomposition_at_prime</tt><big>(</big><em>other</em>, <em>p</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.has_equivalent_Jordan_decomposition_at_prime" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the given quadratic form has a Jordan decomposition
equivalent to that of self.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>a QuadraticForm</dd>
<dt>OUTPUT:</dt>
<dd>boolean</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q3</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q1</span><span class="o">.</span><span class="n">level</span><span class="p">(),</span> <span class="n">Q2</span><span class="o">.</span><span class="n">level</span><span class="p">(),</span> <span class="n">Q3</span><span class="o">.</span><span class="n">level</span><span class="p">()]</span>
<span class="go">[44, 44, 44]</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">has_equivalent_Jordan_decomposition_at_prime</span><span class="p">(</span><span class="n">Q2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">has_equivalent_Jordan_decomposition_at_prime</span><span class="p">(</span><span class="n">Q2</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">has_equivalent_Jordan_decomposition_at_prime</span><span class="p">(</span><span class="n">Q3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">has_equivalent_Jordan_decomposition_at_prime</span><span class="p">(</span><span class="n">Q3</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q2</span><span class="o">.</span><span class="n">has_equivalent_Jordan_decomposition_at_prime</span><span class="p">(</span><span class="n">Q3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q2</span><span class="o">.</span><span class="n">has_equivalent_Jordan_decomposition_at_prime</span><span class="p">(</span><span class="n">Q3</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.has_integral_Gram_matrix">
<tt class="descname">has_integral_Gram_matrix</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.has_integral_Gram_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns whether the quadratic form has an integral Gram matrix (with respect to its base ring).</p>
<p>A warning is issued if the form is defined over a field, since in that case the return is trivially true.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">has_integral_Gram_matrix</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">has_integral_Gram_matrix</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.hasse_conductor">
<tt class="descname">hasse_conductor</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.hasse_conductor" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the product of all primes where the Hasse invariant equals -1</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_conductor</span><span class="p">()</span>
<span class="go">74</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">hasse_conductor</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">hasse_conductor</span><span class="p">()</span>
<span class="go">10</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.hasse_invariant">
<tt class="descname">hasse_invariant</tt><big>(</big><em>p</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.hasse_invariant" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Hasse invariant at a prime <span class="math">\(p\)</span>, as given on p55 of
Cassels&#8217;s book.  If Q is diagonal with coefficients <span class="math">\(a_i\)</span>, then the
(Cassels) Hasse invariant is given by</p>
<div class="math">
\[\begin{split}c_p = \prod_{i &lt; j} (a_i, a_j)_p\end{split}\]</div>
<p>where <span class="math">\((a,b)_p\)</span> is the Hilbert symbol at <span class="math">\(p\)</span>.  The underlying
quadratic form must be non-degenerate over <span class="math">\(Q_p\)</span> for this to make
sense.</p>
<p>WARNING: This is different from the O&#8217;Meara Hasse invariant, which
allows <span class="math">\(i &lt;= j\)</span> in the product.  That is given by the method
hasse_invariant__OMeara(p).</p>
<p>NOTE: We should really rename this hasse_invariant__Cassels(), and
set hasse_invariant() as a front-end to it.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><span class="math">\(p\)</span> &#8211; a prime number &gt; 0</dd>
<dt>OUTPUT:</dt>
<dd>1 or -1</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">rational_diagonal_form</span><span class="p">()</span>
<span class="go">Quadratic form in 2 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 0 ]</span>
<span class="go">[ * 2 ]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[1, 1, 1, 1, 1, 1, 1, 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant__OMeara</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[1, 1, 1, 1, 1, 1, 1, 1]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[1, 1, 1, 1, 1, 1, 1, 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant__OMeara</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[-1, 1, 1, 1, 1, 1, 1, 1]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[1, 1, 1, 1, 1, 1, 1, 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant__OMeara</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[-1, 1, 1, 1, 1, 1, 1, 1]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">=</span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">K</span><span class="p">,[</span><span class="o">-</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">19</span><span class="p">)]</span>
<span class="go">[-1, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.hasse_invariant__OMeara">
<tt class="descname">hasse_invariant__OMeara</tt><big>(</big><em>p</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.hasse_invariant__OMeara" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the O&#8217;Meara Hasse invariant at a prime <span class="math">\(p\)</span>, as given on
p167 of O&#8217;Meara&#8217;s book.  If Q is diagonal with coefficients <span class="math">\(a_i\)</span>,
then the (Cassels) Hasse invariant is given by</p>
<div class="math">
\[\begin{split}c_p = \prod_{i &lt;= j} (a_i, a_j)_p\end{split}\]</div>
<p>where <span class="math">\((a,b)_p\)</span> is the Hilbert symbol at <span class="math">\(p\)</span>.</p>
<p>WARNING: This is different from the (Cassels) Hasse invariant, which
only allows <span class="math">\(i &lt; j\)</span> in the product.  That is given by the method
hasse_invariant(p).</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><span class="math">\(p\)</span> &#8211; a prime number &gt; 0</dd>
<dt>OUTPUT:</dt>
<dd>1 or -1</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">rational_diagonal_form</span><span class="p">()</span>
<span class="go">Quadratic form in 2 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 0 ]</span>
<span class="go">[ * 2 ]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[1, 1, 1, 1, 1, 1, 1, 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant__OMeara</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[1, 1, 1, 1, 1, 1, 1, 1]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[1, 1, 1, 1, 1, 1, 1, 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant__OMeara</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[-1, 1, 1, 1, 1, 1, 1, 1]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span><span class="o">=</span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[-1, 1, 1, 1, 1, 1, 1, 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant__OMeara</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[-1, 1, 1, 1, 1, 1, 1, 1]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">=</span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">K</span><span class="p">,[</span><span class="o">-</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant__OMeara</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">19</span><span class="p">)]</span>
<span class="go">[1, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_adjoint">
<tt class="descname">is_adjoint</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_adjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the given form is the adjoint of another form</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_adjoint</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">adjoint</span><span class="p">()</span><span class="o">.</span><span class="n">is_adjoint</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_anisotropic">
<tt class="descname">is_anisotropic</tt><big>(</big><em>p</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_anisotropic" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the quadratic form is anisotropic over the p-adic numbers <span class="math">\(Q_p\)</span>.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><span class="math">\(p\)</span> &#8211; a prime number &gt; 0</dd>
<dt>OUTPUT:</dt>
<dd>boolean</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_anisotropic</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_anisotropic</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_anisotropic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_anisotropic</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_anisotropic</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_anisotropic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="p">[</span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">least_quadratic_nonresidue</span><span class="p">(</span><span class="n">p</span><span class="p">)])</span><span class="o">.</span><span class="n">is_anisotropic</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>  <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">30</span><span class="p">)]</span>
<span class="go">[True, True, True, True, True, True, True, True, True]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="p">[</span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">least_quadratic_nonresidue</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="n">p</span><span class="p">,</span> <span class="o">-</span><span class="n">p</span><span class="o">*</span><span class="n">least_quadratic_nonresidue</span><span class="p">(</span><span class="n">p</span><span class="p">)])</span><span class="o">.</span><span class="n">is_anisotropic</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>  <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">30</span><span class="p">)]</span>
<span class="go">[True, True, True, True, True, True, True, True, True]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_definite">
<tt class="descname">is_definite</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_definite" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the given quadratic form is (positive or negative) definite.</p>
<p>Note:  A degenerate form is considered neither definite nor indefinite.
Note:  The zero-dim&#8217;l form is considered indefinite.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>None</dd>
<dt>OUTPUT:</dt>
<dd>boolean &#8211; True or False</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_definite</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_definite</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_even">
<tt class="descname">is_even</tt><big>(</big><em>allow_rescaling_flag=True</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_even" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns true iff after rescaling by some appropriate factor, the
form represents no odd integers.  For more details, see parity().</p>
<p>Requires that Q is defined over <span class="math">\(ZZ\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_even</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_even</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_globally_equivalent__souvigner">
<tt class="descname">is_globally_equivalent__souvigner</tt><big>(</big><em>other</em>, <em>return_transformation=False</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_globally_equivalent__souvigner" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the Souvigner code to compute the number of automorphisms.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>a QuadraticForm</dd>
<dt>OUTPUT:</dt>
<dd>boolean, and optionally a matrix</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">is_globally_equivalent__souvigner</span><span class="p">(</span><span class="n">Q1</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span> <span class="p">;</span> <span class="n">M</span>   <span class="c"># optional -- souvigner</span>
<span class="go">[ 0  0 -1]</span>
<span class="go">[ 1  0  0]</span>
<span class="go">[-1  1  1]</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">==</span> <span class="n">Q</span>                                              <span class="c"># optional -- souvigner</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_globally_equivalent_to">
<tt class="descname">is_globally_equivalent_to</tt><big>(</big><em>other</em>, <em>return_matrix=False</em>, <em>check_theta_to_precision='sturm'</em>, <em>check_local_equivalence=True</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_globally_equivalent_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the current quadratic form is equivalent to the
given form over ZZ.  If return_matrix is True, then we also return
the transformation matrix M so that self(M) == other.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>a QuadraticForm</dd>
<dt>OUTPUT:</dt>
<dd>boolean, and optionally a matrix</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">Q</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="p">(</span><span class="n">Q1</span><span class="p">)</span>                                                    <span class="c"># optional -- souvigner</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">MM</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">is_globally_equivalent_to</span><span class="p">(</span><span class="n">Q1</span><span class="p">,</span> <span class="n">return_matrix</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  <span class="c"># optional -- souvigner</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">(</span><span class="n">MM</span><span class="p">)</span> <span class="o">==</span> <span class="n">Q1</span>                                               <span class="c"># optional -- souvigner</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q3</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_globally_equivalent_to</span><span class="p">(</span><span class="n">Q2</span><span class="p">)</span>                          <span class="c"># optional -- souvigner</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_globally_equivalent_to</span><span class="p">(</span><span class="n">Q3</span><span class="p">)</span>                          <span class="c"># optional -- souvigner</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Q1</span><span class="o">.</span><span class="n">is_globally_equivalent_to</span><span class="p">(</span><span class="n">Q3</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span> <span class="p">;</span> <span class="n">M</span>            <span class="c"># optional -- souvigner</span>
<span class="go">[-1 -1  0]</span>
<span class="go">[ 1  1  1]</span>
<span class="go">[-1  0  0]</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">==</span> <span class="n">Q3</span>                                               <span class="c"># optional -- souvigner</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_globally_equivalent_to</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">not a definite form in QuadraticForm.is_globally_equivalent_to()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_hyperbolic">
<tt class="descname">is_hyperbolic</tt><big>(</big><em>p</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_hyperbolic" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the quadratic form is a sum of hyperbolic planes over
the p-adic numbers Q_p.</p>
<dl class="docutils">
<dt>REFERENCES:</dt>
<dd><dl class="first last docutils">
<dt>This criteria follows from Cassels&#8217;s &#8220;Rational Quadratic Forms&#8221;:</dt>
<dd><ul class="first last simple">
<li>local invariants for hyperbolic plane (Lemma 2.4, p58)</li>
<li>direct sum formulas (Lemma 2.3 on p58)</li>
</ul>
</dd>
</dl>
</dd>
<dt>INPUT:</dt>
<dd><span class="math">\(p\)</span> &#8211; a prime number &gt; 0</dd>
<dt>OUTPUT:</dt>
<dd>boolean</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_hyperbolic</span><span class="p">(</span><span class="s">&quot;infinity&quot;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_hyperbolic</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_hyperbolic</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_hyperbolic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>     <span class="c">## Here -1 is a square, so it&#39;s true.</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_hyperbolic</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_hyperbolic</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>    <span class="c">## Here -1 is a square, so it&#39;s true.</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_indefinite">
<tt class="descname">is_indefinite</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_indefinite" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the given quadratic form is indefinite.</p>
<p>Note:  A degenerate form is considered neither definite nor indefinite.
Note:  The zero-dim&#8217;l form is not considered indefinite.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>None</dd>
<dt>OUTPUT:</dt>
<dd>boolean &#8211; True or False</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_indefinite</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_indefinite</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_isotropic">
<tt class="descname">is_isotropic</tt><big>(</big><em>p</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_isotropic" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if Q is isotropic over the p-adic numbers <span class="math">\(Q_p\)</span>.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><span class="math">\(p\)</span> &#8211; a prime number &gt; 0</dd>
<dt>OUTPUT:</dt>
<dd>boolean</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_isotropic</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_isotropic</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_isotropic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_isotropic</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_isotropic</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_isotropic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="p">[</span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">least_quadratic_nonresidue</span><span class="p">(</span><span class="n">p</span><span class="p">)])</span><span class="o">.</span><span class="n">is_isotropic</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>  <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">30</span><span class="p">)]</span>
<span class="go">[False, False, False, False, False, False, False, False, False]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="p">[</span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">least_quadratic_nonresidue</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="n">p</span><span class="p">,</span> <span class="o">-</span><span class="n">p</span><span class="o">*</span><span class="n">least_quadratic_nonresidue</span><span class="p">(</span><span class="n">p</span><span class="p">)])</span><span class="o">.</span><span class="n">is_isotropic</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>  <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">30</span><span class="p">)]</span>
<span class="go">[False, False, False, False, False, False, False, False, False]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_equivalent_to">
<tt class="descname">is_locally_equivalent_to</tt><big>(</big><em>other</em>, <em>check_primes_only=False</em>, <em>force_jordan_equivalence_test=False</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_equivalent_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the current quadratic form (defined over ZZ) is
locally equivalent to the given form over the real numbers and the
<span class="math">\(p\)</span>-adic integers for every prime p.</p>
<p>This works by comparing the local Jordan decompositions at every
prime, and the dimension and signature at the real place.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>a QuadraticForm</dd>
<dt>OUTPUT:</dt>
<dd>boolean</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_globally_equivalent_to</span><span class="p">(</span><span class="n">Q2</span><span class="p">)</span>                           <span class="c"># optional -- souvigner</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_locally_equivalent_to</span><span class="p">(</span><span class="n">Q2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_represented_number">
<tt class="descname">is_locally_represented_number</tt><big>(</big><em>m</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_represented_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the rational number m is locally represented by the quadratic form.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><span class="math">\(m\)</span> &#8211; an integer</dd>
<dt>OUTPUT:</dt>
<dd>boolean</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_represented_number_at_place">
<tt class="descname">is_locally_represented_number_at_place</tt><big>(</big><em>m</em>, <em>p</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_represented_number_at_place" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the rational number m is locally represented by the
quadratic form at the (possibly infinite) prime <span class="math">\(p\)</span>.</p>
<p>INPUT:</p>
<blockquote>
<div><p><span class="math">\(m\)</span> &#8211; an integer</p>
<p><span class="math">\(p\)</span> &#8211; a prime number &gt; 0 or &#8216;infinity&#8217;</p>
</div></blockquote>
<dl class="docutils">
<dt>OUTPUT:</dt>
<dd>boolean</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number_at_place</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">infinity</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number_at_place</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number_at_place</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number_at_place</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number_at_place</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">infinity</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number_at_place</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number_at_place</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">infinity</span><span class="p">)</span>     <span class="c"># long time (8.5 s)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number_at_place</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>            <span class="c"># long time</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number_at_place</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>            <span class="c"># long time</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number_at_place</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>            <span class="c"># long time</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_universal_at_all_places">
<tt class="descname">is_locally_universal_at_all_places</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_universal_at_all_places" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the quadratic form represents <span class="math">\(Z_p\)</span> for all
finite/non-archimedean primes, and represents all real numbers.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>none</dd>
<dt>OUTPUT:</dt>
<dd>boolean</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_all_places</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_all_places</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_all_places</span><span class="p">()</span>        <span class="c"># long time (8.5 s)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_universal_at_all_primes">
<tt class="descname">is_locally_universal_at_all_primes</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_universal_at_all_primes" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the quadratic form represents <span class="math">\(Z_p\)</span> for all finite/non-archimedean primes.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>none</dd>
<dt>OUTPUT:</dt>
<dd>boolean</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_all_primes</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_all_primes</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_all_primes</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_universal_at_prime">
<tt class="descname">is_locally_universal_at_prime</tt><big>(</big><em>p</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_universal_at_prime" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the (integer-valued/rational) quadratic form represents all of <span class="math">\(Z_p\)</span>.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><span class="math">\(p\)</span> &#8211; a positive prime number or &#8220;infinity&#8221;.</dd>
<dt>OUTPUT:</dt>
<dd>boolean</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_prime</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_prime</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_prime</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_prime</span><span class="p">(</span><span class="n">infinity</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_prime</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_prime</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_prime</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_prime</span><span class="p">(</span><span class="n">infinity</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_prime</span><span class="p">(</span><span class="n">infinity</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_negative_definite">
<tt class="descname">is_negative_definite</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_negative_definite" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the given quadratic form is negative-definite.</p>
<p>Note:  A degenerate form is considered neither definite nor indefinite.
Note:  The zero-dim&#8217;l form is considered both positive definite and negative definite.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>None</dd>
<dt>OUTPUT:</dt>
<dd>boolean &#8211; True or False</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_negative_definite</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_negative_definite</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_odd">
<tt class="descname">is_odd</tt><big>(</big><em>allow_rescaling_flag=True</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_odd" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns true iff after rescaling by some appropriate factor, the
form represents some odd integers.  For more details, see parity().</p>
<p>Requires that Q is defined over <span class="math">\(ZZ\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_odd</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_odd</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_positive_definite">
<tt class="descname">is_positive_definite</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_positive_definite" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the given quadratic form is positive-definite.</p>
<p>Note:  A degenerate form is considered neither definite nor indefinite.
Note:  The zero-dim&#8217;l form is considered both positive definite and negative definite.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>None</dd>
<dt>OUTPUT:</dt>
<dd>boolean &#8211; True or False</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_positive_definite</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_positive_definite</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_primitive">
<tt class="descname">is_primitive</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_primitive" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the given integer-valued form is primitive
(i.e. not an integer (&gt;1) multiple of another integer-valued
quadratic form).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_zero">
<tt class="descname">is_zero</tt><big>(</big><em>v</em>, <em>p=0</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_zero" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the vector v is on the conic Q(x) = 0 (mod p).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_zero</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_zero</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_zero</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_zero_nonsingular">
<tt class="descname">is_zero_nonsingular</tt><big>(</big><em>v</em>, <em>p=0</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_zero_nonsingular" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the vector <span class="math">\(v\)</span> is on the conic Q(<span class="math">\(x\)</span>) = 0 (mod <span class="math">\(p\)</span>),
and that this point is non-singular point of the conic.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_zero_nonsingular</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_zero</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">37</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_zero_nonsingular</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">37</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_zero_singular">
<tt class="descname">is_zero_singular</tt><big>(</big><em>v</em>, <em>p=0</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_zero_singular" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the vector <span class="math">\(v\)</span> is on the conic Q(<span class="math">\(x\)</span>) = 0 (mod <span class="math">\(p\)</span>),
and that this point is singular point of the conic.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_zero</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_zero_singular</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_zero_singular</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">37</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.jordan_blocks_by_scale_and_unimodular">
<tt class="descname">jordan_blocks_by_scale_and_unimodular</tt><big>(</big><em>p</em>, <em>safe_flag=True</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.jordan_blocks_by_scale_and_unimodular" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of pairs <span class="math">\((s_i, L_i)\)</span> where <span class="math">\(L_i\)</span> is a maximal
<span class="math">\(p^{s_i}\)</span>-unimodular Jordan component which is further decomposed into
block diagonals of block size <span class="math">\(\le 2\)</span>. For each <span class="math">\(L_i\)</span> the 2x2 blocks are
listed after the 1x1 blocks (which follows from the convention of the
<a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_normal_form" title="sage.quadratic_forms.quadratic_form.QuadraticForm.local_normal_form"><tt class="xref py py-meth docutils literal"><span class="pre">local_normal_form()</span></tt></a> method).</p>
<p>..note</p>
<div class="highlight-python"><div class="highlight"><pre>The decomposition of each `L_i` into smaller block is not unique!
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">safe_flag</span></tt> argument allows us to select whether we want a copy of
the output, or the original output.  By default <tt class="docutils literal"><span class="pre">safe_flag</span> <span class="pre">=</span> <span class="pre">True</span></tt>, so we
return a copy of the cached information.  If this is set to <tt class="docutils literal"><span class="pre">False</span></tt>, then
the routine is much faster but the return values are vulnerable to being
corrupted by the user.</p>
<p>INPUT:</p>
<ul class="simple">
<li><span class="math">\(p\)</span> &#8211; a prime number &gt; 0.</li>
</ul>
<p>OUTPUT:</p>
<p>A list of pairs <span class="math">\((s_i, L_i)\)</span> where:</p>
<ul class="simple">
<li><span class="math">\(s_i\)</span> is an integer,</li>
<li><span class="math">\(L_i\)</span> is a block-diagonal unimodular quadratic form over <span class="math">\(\ZZ_p\)</span>.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">These forms <span class="math">\(L_i\)</span> are defined over the <span class="math">\(p\)</span>-adic integers, but by a
matrix over <span class="math">\(\ZZ\)</span> (or <span class="math">\(\QQ\)</span>?).</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">jordan_blocks_by_scale_and_unimodular</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[(0, Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 0 ]</span>
<span class="go">[ * 5 0 ]</span>
<span class="go">[ * * 7 ]), (2, Quadratic form in 1 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 ])]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q2</span><span class="o">.</span><span class="n">jordan_blocks_by_scale_and_unimodular</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[(-1, Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 2 2 ]</span>
<span class="go">[ * 2 ])]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">Q2</span> <span class="o">+</span> <span class="n">Q2</span><span class="o">.</span><span class="n">scale_by_factor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">jordan_blocks_by_scale_and_unimodular</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[(-1, Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 2 2 ]</span>
<span class="go">[ * 2 ]), (0, Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 2 2 ]</span>
<span class="go">[ * 2 ])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.jordan_blocks_in_unimodular_list_by_scale_power">
<tt class="descname">jordan_blocks_in_unimodular_list_by_scale_power</tt><big>(</big><em>p</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.jordan_blocks_in_unimodular_list_by_scale_power" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of Jordan components, whose component at index i
should be scaled by the factor p^i.</p>
<p>This is only defined for integer-valued quadratic forms
(i.e. forms with base_ring ZZ), and the indexing only works
correctly for p=2 when the form has an integer Gram matrix.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>self &#8211; a quadratic form over ZZ, which has integer Gram matrix if p == 2
<span class="math">\(p\)</span> &#8211; a prime number &gt; 0</dd>
<dt>OUTPUT:</dt>
<dd>a list of p-unimodular quadratic forms</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">jordan_blocks_in_unimodular_list_by_scale_power</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Oops!  The given quadratic form has a Jordan component with a negative scale exponent!</span>
<span class="go">This routine requires an integer-matrix quadratic form for the output indexing to work properly!</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">scale_by_factor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">jordan_blocks_in_unimodular_list_by_scale_power</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 0 2 ]</span>
<span class="go">[ * 0 ], Quadratic form in 0 variables over Integer Ring with coefficients:</span>
<span class="go">, Quadratic form in 1 variables over Integer Ring with coefficients:</span>
<span class="go">[ 345 ]]</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">jordan_blocks_in_unimodular_list_by_scale_power</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 2 0 ]</span>
<span class="go">[ * 10 ], Quadratic form in 1 variables over Integer Ring with coefficients:</span>
<span class="go">[ 2 ]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.level">
<tt class="descname">level</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.level" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the level of the quadratic form over a PID, which is a
generator for the smallest ideal <span class="math">\(N\)</span> of <span class="math">\(R\)</span> such that N * (the matrix of
2*Q)^(-1) is in R with diagonal in 2*R.</p>
<p>Over <span class="math">\(\ZZ\)</span> this returns a non-negative number.</p>
<p>(Caveat: This always returns the unit ideal when working over a field!)</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">level</span><span class="p">()</span>
<span class="go">8</span>

<span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">level</span><span class="p">()</span>      <span class="c"># random</span>
<span class="go">UserWarning: Warning -- The level of a quadratic form over a field is always 1.  Do you really want to do this?!?</span>
<span class="go">1</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">level</span><span class="p">()</span>
<span class="go">420</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.level__Tornaria">
<tt class="descname">level__Tornaria</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.level__Tornaria" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the level of the quadratic form,
defined as</p>
<blockquote>
<div>level(B)    for even dimension
level(B)/4  for odd dimension</div></blockquote>
<p>where 2Q(<span class="math">\(x\)</span>) <span class="math">\(= x^t * B * x\)</span>.</p>
<p>This agrees with the usual level for even dimension...</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">level__Tornaria</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">level__Tornaria</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">level__Tornaria</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">level__Tornaria</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.level_ideal">
<tt class="descname">level_ideal</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.level_ideal" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the level of the quadratic form (over R), which is the
smallest ideal N of R such that N * (the matrix of 2*Q)^(-1) is
in R with diagonal in 2*R.
(Caveat: This always returns the principal ideal when working over a field!)</p>
<dl class="docutils">
<dt>WARNING:  THIS ONLY WORKS OVER A PID RING OF INTEGERS FOR NOW!</dt>
<dd>(Waiting for Sage fractional ideal support.)</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">level_ideal</span><span class="p">()</span>
<span class="go">Principal ideal (8) of Integer Ring</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">level_ideal</span><span class="p">()</span>
<span class="go">Principal ideal (1) of Rational Field</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">level_ideal</span><span class="p">()</span>
<span class="go">Principal ideal (420) of Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.list_external_initializations">
<tt class="descname">list_external_initializations</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.list_external_initializations" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of the fields which were set externally at
creation, and not created through the usual QuadraticForm
methods.  These fields are as good as the external process
that made them, and are thus not guaranteed to be correct.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">list_external_initializations</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">theta_series</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">list_external_initializations</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">unsafe_initialization</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">number_of_automorphisms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">determinant</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">list_external_initializations</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">unsafe_initialization</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">number_of_automorphisms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">determinant</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">list_external_initializations</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">unsafe_initialization</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">number_of_automorphisms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">determinant</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">list_external_initializations</span><span class="p">()</span>
<span class="go">[&#39;number_of_automorphisms&#39;, &#39;determinant&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.lll">
<tt class="descname">lll</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.lll" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an LLL-reduced form of Q (using Pari).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_definite</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">lll</span><span class="p">()</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 1 0 ]</span>
<span class="go">[ * 4 3 3 ]</span>
<span class="go">[ * * 6 3 ]</span>
<span class="go">[ * * * 6 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_badII_density_congruence">
<tt class="descname">local_badII_density_congruence</tt><big>(</big><em>p</em>, <em>m</em>, <em>Zvec=None</em>, <em>NZvec=None</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_badII_density_congruence" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the Bad-type II local density of Q representing <span class="math">\(m\)</span> at <span class="math">\(p\)</span>.
(Assuming that <span class="math">\(p\)</span> &gt; 2 and Q is given in local diagonal form.)</p>
<blockquote>
<div><dl class="docutils">
<dt>INPUT:</dt>
<dd><p class="first">Q &#8211; quadratic form assumed to be block diagonal and p-integral</p>
<p><span class="math">\(p\)</span> &#8211; a prime number</p>
<p><span class="math">\(m\)</span> &#8211; an integer</p>
<p class="last">Zvec, NZvec &#8211; non-repeating lists of integers in range(self.dim()) or None</p>
</dd>
</dl>
</div></blockquote>
<dl class="docutils">
<dt>OUTPUT:</dt>
<dd>a rational number</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">4/27</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">4/9</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_badI_density_congruence">
<tt class="descname">local_badI_density_congruence</tt><big>(</big><em>p</em>, <em>m</em>, <em>Zvec=None</em>, <em>NZvec=None</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_badI_density_congruence" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the Bad-type I local density of Q representing <span class="math">\(m\)</span> at <span class="math">\(p\)</span>.
(Assuming that p &gt; 2 and Q is given in local diagonal form.)</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><p class="first">Q &#8211; quadratic form assumed to be block diagonal and <span class="math">\(p\)</span>-integral</p>
<p><span class="math">\(p\)</span> &#8211; a prime number</p>
<p><span class="math">\(m\)</span> &#8211; an integer</p>
<p class="last">Zvec, NZvec &#8211; non-repeating lists of integers in range(self.dim()) or None</p>
</dd>
<dt>OUTPUT:</dt>
<dd>a rational number</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_bad_density_congruence">
<tt class="descname">local_bad_density_congruence</tt><big>(</big><em>p</em>, <em>m</em>, <em>Zvec=None</em>, <em>NZvec=None</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_bad_density_congruence" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the Bad-type local density of Q representing
<span class="math">\(m\)</span> at <span class="math">\(p\)</span>, allowing certain congruence conditions mod <span class="math">\(p\)</span>.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><p class="first">Q &#8211; quadratic form assumed to be block diagonal and p-integral</p>
<p><span class="math">\(p\)</span> &#8211; a prime number</p>
<p><span class="math">\(m\)</span> &#8211; an integer</p>
<p class="last">Zvec, NZvec &#8211; non-repeating lists of integers in range(self.dim()) or None</p>
</dd>
<dt>OUTPUT:</dt>
<dd>a rational number</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">4/27</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">4/9</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">8/27</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_density">
<tt class="descname">local_density</tt><big>(</big><em>p</em>, <em>m</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives the local density &#8211; should be called by the user. =)</p>
<p>NOTE: This screens for imprimitive forms, and puts the quadratic
form in local normal form, which is a <em>requirement</em> of the
routines performing the computations!</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><span class="math">\(p\)</span> &#8211; a prime number &gt; 0
<span class="math">\(m\)</span> &#8211; an integer</dd>
<dt>OUTPUT:</dt>
<dd>a rational number</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>   <span class="c">## NOTE: This is already in local normal form for *all* primes p!</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">8/9</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">24/25</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">48/49</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">120/121</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_density_congruence">
<tt class="descname">local_density_congruence</tt><big>(</big><em>p</em>, <em>m</em>, <em>Zvec=None</em>, <em>NZvec=None</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_density_congruence" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the local density of Q representing <span class="math">\(m\)</span> at <span class="math">\(p\)</span>,
allowing certain congruence conditions mod <span class="math">\(p\)</span>.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><p class="first">Q &#8211; quadratic form assumed to be block diagonal and p-integral</p>
<p><span class="math">\(p\)</span> &#8211; a prime number</p>
<p><span class="math">\(m\)</span> &#8211; an integer</p>
<p class="last">Zvec, NZvec &#8211; non-repeating lists of integers in range(self.dim()) or None</p>
</dd>
<dt>OUTPUT:</dt>
<dd>a rational number</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zvec</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">NZvec</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zvec</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">NZvec</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="go">8/9</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zvec</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">NZvec</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="go">24/25</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zvec</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">NZvec</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="go">48/49</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zvec</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">NZvec</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="go">120/121</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">3/2</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">2/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">14/9</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">2/9</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">4/9</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_genus_symbol">
<tt class="descname">local_genus_symbol</tt><big>(</big><em>p</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_genus_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Conway-Sloane genus symbol of 2 times a quadratic form
defined over ZZ at a prime number p.  This is defined (in the
Genus_Symbol_p_adic_ring() class in the quadratic_forms/genera
subfolder) to be a list of tuples (one for each Jordan component
p^m*A at p, where A is a unimodular symmetric matrix with
coefficients the p-adic integers) of the following form:</p>
<blockquote>
<div><ol class="arabic">
<li><dl class="first docutils">
<dt>If p&gt;2 then return triples of the form [<span class="math">\(m\)</span>, <span class="math">\(n\)</span>, <span class="math">\(d\)</span>] where</dt>
<dd><p class="first"><span class="math">\(m\)</span> = valuation of the component</p>
<p><span class="math">\(n\)</span> = rank of A</p>
<p class="last"><span class="math">\(d\)</span> = det(A) in {1,u} for normalized quadratic non-residue u.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If p=2 then return quintuples of the form [<span class="math">\(m\)</span>,`n`,`s`, <span class="math">\(d\)</span>, <span class="math">\(o\)</span>] where</dt>
<dd><p class="first"><span class="math">\(m\)</span> = valuation of the component</p>
<p><span class="math">\(n\)</span> = rank of A</p>
<p><span class="math">\(d\)</span> = det(A) in {1,3,5,7}</p>
<p><span class="math">\(s\)</span> = 0 (or 1) if A is even (or odd)</p>
<dl class="last docutils">
<dt><span class="math">\(o\)</span> = oddity of A (= 0 if s = 0) in Z/8Z</dt>
<dd><p class="first last">= the trace of the diagonalization of A</p>
</dd>
</dl>
</dd>
</dl>
</li>
</ol>
</div></blockquote>
<p>NOTE: The Conway-Sloane convention for describing the prime &#8216;p =
-1&#8217; is not supported here, and neither is the convention for
including the &#8216;prime&#8217; Infinity.  See note on p370 of Conway-Sloane
(3rd ed) for a discussion of this convention.</p>
<p>INPUT:</p>
<blockquote>
<div>-<span class="math">\(p\)</span> &#8211; a prime number &gt; 0</div></blockquote>
<dl class="docutils">
<dt>OUTPUT:</dt>
<dd>Returns a Conway-Sloane genus symbol at p, which is an
instance of the Genus_Symbol_p_adic_ring class.</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_genus_symbol</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Genus symbol at 2 : [[1, 2, 3, 1, 4], [2, 1, 1, 1, 1], [3, 1, 1, 1, 1]]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_genus_symbol</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Genus symbol at 3 : [[0, 3, 1], [1, 1, -1]]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_genus_symbol</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Genus symbol at 5 : [[0, 4, 1]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_good_density_congruence">
<tt class="descname">local_good_density_congruence</tt><big>(</big><em>p</em>, <em>m</em>, <em>Zvec=None</em>, <em>NZvec=None</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_good_density_congruence" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the Good-type local density of Q representing <span class="math">\(m\)</span> at <span class="math">\(p\)</span>.
(Front end routine for parity specific routines for p.)</p>
<p>TO DO: Add Documentation about the additional congruence
conditions Zvec and NZvec.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><p class="first">Q &#8211; quadratic form assumed to be block diagonal and p-integral</p>
<p><span class="math">\(p\)</span> &#8211; a prime number</p>
<p><span class="math">\(m\)</span> &#8211; an integer</p>
<p class="last">Zvec, NZvec &#8211; non-repeating lists of integers in range(self.dim()) or None</p>
</dd>
<dt>OUTPUT:</dt>
<dd>a rational number</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">2/3</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">8/9</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_good_density_congruence_even">
<tt class="descname">local_good_density_congruence_even</tt><big>(</big><em>m</em>, <em>Zvec</em>, <em>NZvec</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_good_density_congruence_even" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the Good-type local density of Q representing <span class="math">\(m\)</span> at <span class="math">\(p=2\)</span>.
(Assuming Q is given in local diagonal form.)</p>
<p>The additional congruence condition arguments Zvec and NZvec can
be either a list of indices or None.  Zvec = [] is equivalent to
Zvec = None which both impose no additional conditions, but NZvec
= [] returns no solutions always while NZvec = None imposes no
additional condition.</p>
<p>WARNING: Here the indices passed in Zvec and NZvec represent
indices of the solution vector <span class="math">\(x\)</span> of Q(<span class="math">\(x\)</span>) = <span class="math">\(m (mod p^k)\)</span>, and <em>not</em>
the Jordan components of Q.  They therefore are required (and
assumed) to include either all or none of the indices of a given
Jordan component of Q.  This is only important when <span class="math">\(p=2\)</span> since
otherwise all Jordan blocks are 1x1, and so there the indices and
Jordan blocks coincide.</p>
<p>TO DO: Add type checking for Zvec, NZvec, and that Q is in local
normal form.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><p class="first">Q &#8211; quadratic form assumed to be block diagonal and 2-integral</p>
<p><span class="math">\(p\)</span> &#8211; a prime number</p>
<p><span class="math">\(m\)</span> &#8211; an integer</p>
<p class="last">Zvec, NZvec &#8211; non-repeating lists of integers in range(self.dim()) or None</p>
</dd>
<dt>OUTPUT:</dt>
<dd>a rational number</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence_even</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence_even</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence_even</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">3/2</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence_even</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence_even</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">1/2</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">15</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 5 1 2 3 ]</span>
<span class="go">[ * 10 5 6 ]</span>
<span class="go">[ * * 15 8 ]</span>
<span class="go">[ * * * 20 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">1 + 2*q^5 + 2*q^10 + 2*q^14 + 2*q^15 + 2*q^16 + 2*q^18 + O(q^20)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_normal_form</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 0 1 0 0 ]</span>
<span class="go">[ * 0 0 0 ]</span>
<span class="go">[ * * 0 1 ]</span>
<span class="go">[ * * * 0 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence_even</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">3/4</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence_even</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence_even</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">3/4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_good_density_congruence_odd">
<tt class="descname">local_good_density_congruence_odd</tt><big>(</big><em>p</em>, <em>m</em>, <em>Zvec</em>, <em>NZvec</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_good_density_congruence_odd" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the Good-type local density of Q representing <span class="math">\(m\)</span> at <span class="math">\(p\)</span>.
(Assuming that <span class="math">\(p\)</span> &gt; 2 and Q is given in local diagonal form.)</p>
<p>The additional congruence condition arguments Zvec and NZvec can
be either a list of indices or None.  Zvec = [] is equivalent to
Zvec = None which both impose no additional conditions, but NZvec
= [] returns no solutions always while NZvec = None imposes no
additional condition.</p>
<p>TO DO: Add type checking for Zvec, NZvec, and that Q is in local
normal form.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><p class="first">Q &#8211; quadratic form assumed to be diagonal and p-integral</p>
<p><span class="math">\(p\)</span> &#8211; a prime number</p>
<p><span class="math">\(m\)</span> &#8211; an integer</p>
<p class="last">Zvec, NZvec &#8211; non-repeating lists of integers in range(self.dim()) or None</p>
</dd>
<dt>OUTPUT:</dt>
<dd>a rational number</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence_odd</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">2/3</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence_odd</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">8/9</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_normal_form">
<tt class="descname">local_normal_form</tt><big>(</big><em>p</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_normal_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the a locally integrally equivalent quadratic form over
the p-adic integers Z_p which gives the Jordan decomposition.  The
Jordan components are written as sums of blocks of size &lt;= 2 and
are arranged by increasing scale, and then by increasing norm.
(This is equivalent to saying that we put the 1x1 blocks before
the 2x2 blocks in each Jordan component.)</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><span class="math">\(p\)</span> &#8211; a positive prime number.</dd>
<dt>OUTPUT:</dt>
<dd>a quadratic form over ZZ</dd>
</dl>
<p>WARNING:  Currently this only works for quadratic forms defined over ZZ.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_normal_form</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 ]</span>
<span class="go">[ * 6 ]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_normal_form</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 10 0 ]</span>
<span class="go">[ * 15 ]</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_normal_form</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 ]</span>
<span class="go">[ * 6 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_primitive_density">
<tt class="descname">local_primitive_density</tt><big>(</big><em>p</em>, <em>m</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_primitive_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives the local primitive density &#8211; should be called by the user. =)</p>
<p>NOTE: This screens for imprimitive forms, and puts the
quadratic form in local normal form, which is a <em>requirement</em> of
the routines performing the computations!</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><span class="math">\(p\)</span> &#8211; a prime number &gt; 0
<span class="math">\(m\)</span> &#8211; an integer</dd>
<dt>OUTPUT:</dt>
<dd>a rational number</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">15</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 5 1 2 3 ]</span>
<span class="go">[ * 10 5 6 ]</span>
<span class="go">[ * * 15 8 ]</span>
<span class="go">[ * * * 20 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">1 + 2*q^5 + 2*q^10 + 2*q^14 + 2*q^15 + 2*q^16 + 2*q^18 + O(q^20)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_normal_form</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 0 1 0 0 ]</span>
<span class="go">[ * 0 0 0 ]</span>
<span class="go">[ * * 0 1 ]</span>
<span class="go">[ * * * 0 ]</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">3/4</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">24/25</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">3/4</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">3/4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_primitive_density_congruence">
<tt class="descname">local_primitive_density_congruence</tt><big>(</big><em>p</em>, <em>m</em>, <em>Zvec=None</em>, <em>NZvec=None</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_primitive_density_congruence" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the primitive local density of Q representing
<span class="math">\(m\)</span> at <span class="math">\(p\)</span>, allowing certain congruence conditions mod <span class="math">\(p\)</span>.</p>
<p>Note: The following routine is not used internally, but is included for consistency.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><p class="first">Q &#8211; quadratic form assumed to be block diagonal and p-integral</p>
<p><span class="math">\(p\)</span> &#8211; a prime number</p>
<p><span class="math">\(m\)</span> &#8211; an integer</p>
<p class="last">Zvec, NZvec &#8211; non-repeating lists of integers in range(self.dim()) or None</p>
</dd>
<dt>OUTPUT:</dt>
<dd>a rational number</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zvec</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">NZvec</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zvec</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">NZvec</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="go">8/9</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zvec</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">NZvec</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="go">24/25</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zvec</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">NZvec</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="go">48/49</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zvec</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">NZvec</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="go">120/121</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">2/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">4/3</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">4/27</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">4/9</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">8/27</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">8/27</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">243</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">8/27</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_representation_conditions">
<tt class="descname">local_representation_conditions</tt><big>(</big><em>recompute_flag=False</em>, <em>silent_flag=False</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_representation_conditions" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>WARNING: THIS ONLY WORKS CORRECTLY FOR FORMS IN &gt;=3 VARIABLES,</dt>
<dd>WHICH ARE LOCALLY UNIVERSAL AT ALMOST ALL PRIMES!</dd>
</dl>
<p>This class finds the local conditions for a number to be integrally
represented by an integer-valued quadratic form.  These conditions
are stored in &#8220;self.__local_representability_conditions&#8221; and
consist of a list of 9 element vectors, with one for each prime
with a local obstruction (though only the first 5 are meaningful
unless <span class="math">\(p=2\)</span> ).  The first element is always the prime <span class="math">\(p\)</span> where the
local obstruction occurs, and the next 8 (or 4) entries represent
square-classes in the <span class="math">\(p\)</span>-adic integers <span class="math">\(Z_p\)</span>, and are labeled by the
<span class="math">\(Q_p\)</span> square-classes <span class="math">\(t*(Q_p)^2\)</span> with <span class="math">\(t\)</span> given as follows:</p>
<blockquote>
<div><p><span class="math">\(p &gt; 2\)</span>  ==&gt;  [ *  1  u  p  u p  *  *  *  * ]</p>
<p><span class="math">\(p = 2\)</span>  ==&gt;  [ *  1  3  5  7  2  6  10  14 ]</p>
</div></blockquote>
<p>The integer appearing in each place tells us how <span class="math">\(p\)</span>-divisible a
number needs to be in that square-class in order to be locally
represented by Q.  A negative number indicates that the entire <span class="math">\(Q_p\)</span>
square-class is not represented, while a positive number <span class="math">\(x\)</span> indicates
that <span class="math">\(t*p^{(2*x)} (Z_p)^2\)</span> is locally represented but <span class="math">\(t*p^{(2*(x-1))}\)</span>
<span class="math">\((Z_p)^2\)</span> is not.</p>
<p>As an example, the vector</p>
<blockquote>
<div>[2  3  0  0  0  0  2  0  infinity]</div></blockquote>
<p>tells us that all positive integers are locally represented at p=2
except those of the forms:</p>
<blockquote>
<div><p><span class="math">\(2^6 * u * r^2\)</span> with  <span class="math">\(u = 1 (mod 8)\)</span></p>
<p><span class="math">\(2^5 * u * r^2\)</span> with <span class="math">\(u = 3 (mod 8)\)</span></p>
<p><span class="math">\(2 * u * r^2\)</span> with <span class="math">\(u = 7 (mod 8)\)</span></p>
</div></blockquote>
<p>At the real numbers, the vector which looks like</p>
<blockquote>
<div>[infinity, 0, infinity, None, None, None, None, None, None]</div></blockquote>
<p>means that Q is negative definite (i.e. the 0 tells us all
positive reals are represented).  The real vector always appears,
and is listed before the other ones.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>none</dd>
<dt>OUTPUT:</dt>
<dd>A list of 9-element vectors describing the representation
obstructions at primes dividing the level.</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_representation_conditions</span><span class="p">()</span>
<span class="go">This 0-dimensional form only represents zero.</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_representation_conditions</span><span class="p">()</span>
<span class="go">This 1-dimensional form only represents square multiples of 5.</span>

<span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">local_representation_conditions</span><span class="p">()</span>
<span class="go">This 2-dimensional form represents the p-adic integers of even</span>
<span class="go">valuation for all primes p except [2].</span>
<span class="go">For these and the reals, we have:</span>
<span class="go"> Reals:   [0, +Infinity]</span>
<span class="go"> p = 2:   [0, +Infinity, 0, +Infinity, 0, +Infinity, 0, +Infinity]</span>


<span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">local_representation_conditions</span><span class="p">()</span>
<span class="go">This form represents the p-adic integers Z_p for all primes p except</span>
<span class="go">[2].  For these and the reals, we have:</span>
<span class="go"> Reals:   [0, +Infinity]</span>
<span class="go"> p = 2:   [0, 0, 0, +Infinity, 0, 0, 0, 0]</span>

<span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">local_representation_conditions</span><span class="p">()</span>
<span class="go">This form represents the p-adic integers Z_p for all primes p except</span>
<span class="go">[].  For these and the reals, we have:</span>
<span class="go"> Reals:   [0, +Infinity]</span>

<span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">local_representation_conditions</span><span class="p">()</span>
<span class="go">This form represents the p-adic integers Z_p for all primes p except</span>
<span class="go">[3].  For these and the reals, we have:</span>
<span class="go"> Reals:   [0, +Infinity]</span>
<span class="go"> p = 3:   [0, 1, 0, 0]</span>

<span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q2</span><span class="o">.</span><span class="n">local_representation_conditions</span><span class="p">()</span>
<span class="go">This form represents the p-adic integers Z_p for all primes p except</span>
<span class="go">[3].  For these and the reals, we have:</span>
<span class="go"> Reals:   [0, +Infinity]</span>
<span class="go"> p = 3:   [1, 0, 0, 0]</span>

<span class="gp">sage: </span><span class="n">Q3</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q3</span><span class="o">.</span><span class="n">local_representation_conditions</span><span class="p">()</span>
<span class="go">This form represents the p-adic integers Z_p for all primes p except</span>
<span class="go">[].  For these and the reals, we have:</span>
<span class="go"> Reals:   [0, +Infinity]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_zero_density_congruence">
<tt class="descname">local_zero_density_congruence</tt><big>(</big><em>p</em>, <em>m</em>, <em>Zvec=None</em>, <em>NZvec=None</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_zero_density_congruence" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the Zero-type local density of Q representing <span class="math">\(m\)</span> at <span class="math">\(p\)</span>,
allowing certain congruence conditions mod p.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><p class="first">Q &#8211; quadratic form assumed to be block diagonal and <span class="math">\(p\)</span>-integral</p>
<p><span class="math">\(p\)</span> &#8211; a prime number</p>
<p><span class="math">\(m\)</span> &#8211; an integer</p>
<p class="last">Zvec, NZvec &#8211; non-repeating lists of integers in range(self.dim()) or None</p>
</dd>
<dt>OUTPUT:</dt>
<dd>a rational number</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_zero_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_zero_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">1/2</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_zero_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_zero_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">2/9</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_zero_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_zero_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">1/4</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_zero_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_zero_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">8/81</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.mass__by_Siegel_densities">
<tt class="descname">mass__by_Siegel_densities</tt><big>(</big><em>odd_algorithm='Pall'</em>, <em>even_algorithm='Watson'</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.mass__by_Siegel_densities" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives the mass of transformations (det 1 and -1).</p>
<p>WARNING: THIS IS BROKEN RIGHT NOW... =(</p>
<p>Optional Arguments:</p>
<ul class="simple">
<li>When p &gt; 2  &#8211;  odd_algorithm = &#8220;Pall&#8221; (only one choice for now)</li>
<li>When p = 2  &#8211;  even_algorithm = &#8220;Kitaoka&#8221; or &#8220;Watson&#8221;</li>
</ul>
<p>REFERENCES:</p>
<ul class="simple">
<li>Nipp&#8217;s Book &#8220;Tables of Quaternary Quadratic Forms&#8221;.</li>
<li>Papers of Pall (only for p&gt;2) and Watson (for <span class="math">\(p=2\)</span> &#8211; tricky!).</li>
<li>Siegel, Milnor-Hussemoller, Conway-Sloane Paper IV, Kitoaka (all of which
have problems...)</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">mass__by_Siegel_densities</span><span class="p">()</span>
<span class="go">1/384</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">mass__by_Siegel_densities</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="n">Q</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">dim</span><span class="p">()))</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">mass__by_Siegel_densities</span><span class="p">()</span>
<span class="go">1/48</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">mass__by_Siegel_densities</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="n">Q</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">dim</span><span class="p">()))</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.mass_at_two_by_counting_mod_power">
<tt class="descname">mass_at_two_by_counting_mod_power</tt><big>(</big><em>k</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.mass_at_two_by_counting_mod_power" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the local mass at <span class="math">\(p=2\)</span> assuming that it&#8217;s stable <span class="math">\((mod 2^k)\)</span>.</p>
<p>Note: This is <strong>way</strong> too slow to be useful, even when k=1!!!</p>
<p>TO DO: Remove this routine, or try to compile it!</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>k &#8211; an integer &gt;= 1</dd>
<dt>OUTPUT:</dt>
<dd>a rational number</dd>
</dl>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">mass_at_two_by_counting_mod_power</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.matrix">
<tt class="descname">matrix</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Hessian matrix A for which Q(X) =  <span class="math">\((1/2) * X^t * A * X\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[ 0  1  2]</span>
<span class="go">[ 1  6  4]</span>
<span class="go">[ 2  4 10]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.minkowski_reduction">
<tt class="descname">minkowski_reduction</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.minkowski_reduction" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a Minkowski-reduced form equivalent to the given one.
This means that</p>
<div class="math">
\[\begin{split}Q(v_k) &lt;= Q(s_1 * v_1 + ... + s_n * v_n)\end{split}\]</div>
<p>for all <span class="math">\(s_i\)</span> where GCD`(s_k, ... s_n) = 1`.</p>
<p>Note: When Q has dim &lt;= 4 we can take all <span class="math">\(s_i\)</span> in {1, 0, -1}.</p>
<dl class="docutils">
<dt>References:</dt>
<dd><dl class="first last docutils">
<dt>Schulze-Pillot&#8217;s paper on &#8220;An algorithm for computing genera</dt>
<dd>of ternary and quaternary quadratic forms&#8221;, p138.</dd>
<dt>Donaldson&#8217;s 1979 paper &#8220;Minkowski Reduction of Integral</dt>
<dd>Matrices&#8221;, p203.</dd>
</dl>
</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">4</span><span class="p">,[</span><span class="mi">30</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">29</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">62</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">110</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 30 17 11 12 ]</span>
<span class="go">[ * 29 25 62 ]</span>
<span class="go">[ * * 64 25 ]</span>
<span class="go">[ * * * 110 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">minkowski_reduction</span><span class="p">()</span>
<span class="go">(</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 30 17 11 -5 ]</span>
<span class="go">[ * 29 25 4 ]</span>
<span class="go">[ * * 64 0 ]</span>
<span class="go">[ * * * 77 ]                                                       ,</span>

<span class="go">[ 1  0  0  0]</span>
<span class="go">[ 0  1  0 -1]</span>
<span class="go">[ 0  0  1  0]</span>
<span class="go">[ 0  0  0  1]</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.minkowski_reduction_for_4vars__SP">
<tt class="descname">minkowski_reduction_for_4vars__SP</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.minkowski_reduction_for_4vars__SP" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a Minkowski-reduced form equivalent to the given one.
This means that</p>
<blockquote>
<div>Q(<span class="math">\(v_k\)</span>) &lt;= Q(<span class="math">\(s_1 * v_1 + ... + s_n * v_n\)</span>)</div></blockquote>
<p>for all <span class="math">\(s_i\)</span> where GCD(<span class="math">\(s_k, ... s_n\)</span>) = 1.</p>
<p>Note: When Q has dim &lt;= 4 we can take all <span class="math">\(s_i\)</span> in {1, 0, -1}.</p>
<dl class="docutils">
<dt>References:</dt>
<dd><dl class="first last docutils">
<dt>Schulze-Pillot&#8217;s paper on &#8220;An algorithm for computing genera</dt>
<dd>of ternary and quaternary quadratic forms&#8221;, p138.</dd>
<dt>Donaldson&#8217;s 1979 paper &#8220;Minkowski Reduction of Integral</dt>
<dd>Matrices&#8221;, p203.</dd>
</dl>
</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">4</span><span class="p">,[</span><span class="mi">30</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">29</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">62</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">110</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 30 17 11 12 ]</span>
<span class="go">[ * 29 25 62 ]</span>
<span class="go">[ * * 64 25 ]</span>
<span class="go">[ * * * 110 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">minkowski_reduction_for_4vars__SP</span><span class="p">()</span>
<span class="go">(</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 29 -17 25 4 ]</span>
<span class="go">[ * 30 -11 5 ]</span>
<span class="go">[ * * 64 0 ]</span>
<span class="go">[ * * * 77 ]                                                       ,</span>

<span class="go">[ 0  1  0  0]</span>
<span class="go">[ 1  0  0 -1]</span>
<span class="go">[ 0  0  1  0]</span>
<span class="go">[ 0  0  0  1]</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.multiply_variable">
<tt class="descname">multiply_variable</tt><big>(</big><em>c</em>, <em>i</em>, <em>in_place=False</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.multiply_variable" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace the variables <span class="math">\(x_i\)</span> by <span class="math">\(c*x_i\)</span> in the quadratic form
(replacing the original form if the in_place flag is True).</p>
<p>Here <span class="math">\(c\)</span> must be an element of the base_ring defining the
quadratic form.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><p class="first"><span class="math">\(c\)</span> &#8211; an element of Q.base_ring()</p>
<p class="last"><span class="math">\(i\)</span> &#8211; an integer &gt;= 0</p>
</dd>
<dt>OUTPUT:</dt>
<dd>a QuadraticForm (by default, otherwise none)</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">multiply_variable</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 25 0 0 0 ]</span>
<span class="go">[ * 9 0 0 ]</span>
<span class="go">[ * * 5 0 ]</span>
<span class="go">[ * * * 7 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.number_of_automorphisms">
<tt class="descname">number_of_automorphisms</tt><big>(</big><em>recompute=None</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.number_of_automorphisms" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of the number of automorphisms (of det 1 and -1) of
the quadratic form.</p>
<dl class="docutils">
<dt>OUTPUT:</dt>
<dd>an integer &gt;= 2.</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">unsafe_initialization</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">number_of_automorphisms</span><span class="p">()</span>
<span class="go">48</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">number_of_automorphisms</span><span class="p">()</span>
<span class="go">384</span>
<span class="gp">sage: </span><span class="mi">2</span><span class="o">^</span><span class="mi">4</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">384</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.omega">
<tt class="descname">omega</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.omega" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the content of the adjoint of the primitive associated quadratic form.</p>
<p>Ref: See Dickson&#8217;s &#8220;Studies in Number Theory&#8221;.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">37</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">omega</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.parity">
<tt class="descname">parity</tt><big>(</big><em>allow_rescaling_flag=True</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.parity" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the parity (&#8220;even&#8221; or &#8220;odd&#8221;) of an integer-valued quadratic
form over <span class="math">\(ZZ\)</span>, defined up to similitude/rescaling of the form so that
its Jordan component of smallest scale is unimodular.  After this
rescaling, we say a form is even if it only represents even numbers,
and odd if it represents some odd number.</p>
<p>If the &#8216;allow_rescaling_flag&#8217; is set to False, then we require that
the quadratic form have a Gram matrix with coefficients in <span class="math">\(ZZ\)</span>, and
look at the unimodular Jordan block to determine its parity.  This
returns an error if the form is not integer-matrix, meaning that it
has Jordan components at <span class="math">\(p=2\)</span> which do not have an integer scale.</p>
<p>We determine the parity by looking for a 1x1 block in the 0-th
Jordan component, after a possible rescaling.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><dl class="first last docutils">
<dt>self &#8211; a quadratic form with base_ring <span class="math">\(ZZ\)</span>, which we may</dt>
<dd>require to have integer Gram matrix.</dd>
</dl>
</dd>
<dt>OUTPUT:</dt>
<dd>One of the strings: &#8220;even&#8221; or &#8220;odd&#8221;</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]);</span> <span class="n">Q</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 4 -2 0 ]</span>
<span class="go">[ * 2 3 ]</span>
<span class="go">[ * * 2 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">parity</span><span class="p">()</span>
<span class="go">&#39;even&#39;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]);</span> <span class="n">Q</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 4 -2 0 ]</span>
<span class="go">[ * 2 3 ]</span>
<span class="go">[ * * 1 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">parity</span><span class="p">()</span>
<span class="go">&#39;even&#39;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]);</span> <span class="n">Q</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 4 -2 0 ]</span>
<span class="go">[ * 2 2 ]</span>
<span class="go">[ * * 2 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">parity</span><span class="p">()</span>
<span class="go">&#39;even&#39;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]);</span> <span class="n">Q</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 4 -2 0 ]</span>
<span class="go">[ * 2 2 ]</span>
<span class="go">[ * * 1 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">parity</span><span class="p">()</span>
<span class="go">&#39;odd&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.polynomial">
<tt class="descname">polynomial</tt><big>(</big><em>names='x'</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the polynomial in &#8216;n&#8217; variables of the quadratic form in the ring &#8216;R[names].&#8217;</p>
<p>INPUT:</p>
<blockquote>
<div>-&#8216;self&#8217; - a quadratic form over a commatitive ring.
-&#8216;names&#8217; - the name of the variables. Digits will be appended to the name for each different canonical
variable e.g x1, x2, x3 etc.</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div>The polynomial form of the quadratic form.</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">polynomial</span><span class="p">();</span> <span class="n">P</span>
<span class="go">2*x0^2 + 6*x1^2 + 10*x2^2 + 14*x3^2</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Z</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">ring_of_integers</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">polynomial</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="s">&#39;y&#39;</span><span class="p">);</span> <span class="n">P</span>
<span class="go">4*a*y0^2 + 6*a*y0*y1 + (-2*a + 2)*y1^2 + (4*a + 8)*y2^2</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="mi">4</span><span class="p">,[</span><span class="n">a</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">polynomial</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="s">&#39;z&#39;</span><span class="p">)</span>
<span class="go">(2*a)*z0^2 + (6*a)*z0*z1 + (2*a - 6)*z1^2 + (2*a + 8)*z2^2 + (-2*a + 2)*z0*z3 + (4*a + 8)*z1*z3 + 2*z3^2</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">polynomial</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Can only create polynomial rings over commutative rings.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.primitive">
<tt class="descname">primitive</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.primitive" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a primitive version of an integer-valued quadratic form, defined over <span class="math">\(ZZ\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">primitive</span><span class="p">()</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 2 3 ]</span>
<span class="go">[ * 4 ]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">primitive</span><span class="p">()</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 2 ]</span>
<span class="go">[ * 4 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.rational_diagonal_form">
<tt class="descname">rational_diagonal_form</tt><big>(</big><em>return_matrix=False</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.rational_diagonal_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a diagonal form equivalent to Q over the fraction field of
its defining ring.  If the return_matrix is True, then we return
the transformation matrix performing the diagonalization as the
second argument.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>none</dd>
<dt>OUTPUT:</dt>
<dd>Q &#8211; the diagonalized form of this quadratic form
(optional) T &#8211; matrix which diagonalizes Q (over it&#8217;s fraction field)</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 0 1 ]</span>
<span class="go">[ * -1 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">rational_diagonal_form</span><span class="p">()</span>
<span class="go">Quadratic form in 2 variables over Rational Field with coefficients:</span>
<span class="go">[ -2 0 ]</span>
<span class="go">[ * 1/8 ]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">rational_diagonal_form</span><span class="p">(</span><span class="n">return_matrix</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">Quadratic form in 4 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 0 0 0 ]</span>
<span class="go">[ * 3 0 0 ]</span>
<span class="go">[ * * 5 0 ]</span>
<span class="go">[ * * * 7 ]                                                          ,</span>

<span class="go">[1 0 0 0]</span>
<span class="go">[0 1 0 0]</span>
<span class="go">[0 0 1 0]</span>
<span class="go">[0 0 0 1]</span>
<span class="go">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">18</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 1 0 0 ]</span>
<span class="go">[ * 1 0 0 ]</span>
<span class="go">[ * * 1 0 ]</span>
<span class="go">[ * * * 18 ]</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">rational_diagonal_form</span><span class="p">(</span><span class="n">return_matrix</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">Quadratic form in 4 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 0 0 0 ]</span>
<span class="go">[ * 3/4 0 0 ]</span>
<span class="go">[ * * 1 0 ]</span>
<span class="go">[ * * * 18 ]                                                         ,</span>

<span class="go">[   1 -1/2    0    0]</span>
<span class="go">[   0    1    0    0]</span>
<span class="go">[   0    0    1    0]</span>
<span class="go">[   0    0    0    1]</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.reciprocal">
<tt class="descname">reciprocal</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.reciprocal" title="Permalink to this definition">¶</a></dt>
<dd><p>This gives the reciprocal quadratic form associated to the given form.
This is defined as the multiple of the primitive adjoint with the same
content as the given form.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">37</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">()</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 37 0 0 ]</span>
<span class="go">[ * 37 0 ]</span>
<span class="go">[ * * 1 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">()</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">()</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 0 ]</span>
<span class="go">[ * 1 0 ]</span>
<span class="go">[ * * 37 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">()</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">()</span> <span class="o">==</span> <span class="n">Q</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.reduced_binary_form">
<tt class="descname">reduced_binary_form</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.reduced_binary_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a form which is reduced in the sense that no further binary
form reductions can be done to reduce the original form.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">reduced_binary_form</span><span class="p">()</span>
<span class="go">(</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 2 -1 ]</span>
<span class="go">[ * 2 ]                                                            ,</span>

<span class="go">[ 0 -1]</span>
<span class="go">[ 1  1]</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.reduced_binary_form1">
<tt class="descname">reduced_binary_form1</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.reduced_binary_form1" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce the form <span class="math">\(ax^2 + bxy+cy^2\)</span> to satisfy the reduced condition <span class="math">\(|b| \le
a \le c\)</span>, with <span class="math">\(b \ge 0\)</span> if <span class="math">\(a = c\)</span>. This reduction occurs within the
proper class, so all transformations are taken to have determinant 1.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">reduced_binary_form1</span><span class="p">()</span>
<span class="go">(</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 2 -1 ]</span>
<span class="go">[ * 2 ]                                                            ,</span>

<span class="go">[ 0 -1]</span>
<span class="go">[ 1  1]</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.reduced_ternary_form__Dickson">
<tt class="descname">reduced_ternary_form__Dickson</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.reduced_ternary_form__Dickson" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the unique reduced ternary form according to the conditions
of Dickson&#8217;s &#8220;Studies in the Theory of Numbers&#8221;, pp164-171.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">reduced_ternary_form__Dickson</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">TO DO</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.representation_number_list">
<tt class="descname">representation_number_list</tt><big>(</big><em>B</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.representation_number_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the vector of representation numbers &lt; B.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">representation_number_list</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[1, 16, 112, 448, 1136, 2016, 3136, 5504, 9328, 12112]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.representation_vector_list">
<tt class="descname">representation_vector_list</tt><big>(</big><em>B</em>, <em>maxvectors=100000000</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.representation_vector_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Find all vectors v where Q(v) &lt; B.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">representation_vector_list</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[[(0, 0)],</span>
<span class="go"> [(0, 1), (0, -1), (1, 0), (-1, 0)],</span>
<span class="go"> [(1, 1), (-1, -1), (-1, 1), (1, -1)],</span>
<span class="go"> [],</span>
<span class="go"> [(0, 2), (0, -2), (2, 0), (-2, 0)],</span>
<span class="go"> [(1, 2), (-1, -2), (-1, 2), (1, -2), (2, 1), (-2, -1), (-2, 1), (2, -1)],</span>
<span class="go"> [],</span>
<span class="go"> [],</span>
<span class="go"> [(2, 2), (-2, -2), (-2, 2), (2, -2)],</span>
<span class="go"> [(0, 3), (0, -3), (3, 0), (-3, 0)]]</span>
<span class="gp">sage: </span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span>
<span class="go">[1, 4, 4, 0, 4, 8, 0, 0, 4, 4]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">representation_number_list</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[1, 4, 4, 0, 4, 8, 0, 0, 4, 4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.scale_by_factor">
<tt class="descname">scale_by_factor</tt><big>(</big><em>c</em>, <em>change_value_ring_flag=False</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.scale_by_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Scale the values of the quadratic form by the number <span class="math">\(c\)</span>, if
this is possible while still being defined over its base ring.</p>
<p>If the flag is set to true, then this will alter the value ring
to be the field of fractions of the original ring (if necessary).</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><span class="math">\(c\)</span> &#8211; a scalar in the fraction field of the value ring of the form.</dd>
<dt>OUTPUT:</dt>
<dd>A quadratic form of the same dimension</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">27</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">scale_by_factor</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 9 0 0 0 ]</span>
<span class="go">[ * 27 0 0 ]</span>
<span class="go">[ * * 54 0 ]</span>
<span class="go">[ * * * 81 ]</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">scale_by_factor</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 0 0 ]</span>
<span class="go">[ * 3 0 0 ]</span>
<span class="go">[ * * 6 0 ]</span>
<span class="go">[ * * * 9 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.set_number_of_automorphisms">
<tt class="descname">set_number_of_automorphisms</tt><big>(</big><em>num_autos</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.set_number_of_automorphisms" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the number of automorphisms to be the value given.  No error
checking is performed, to this may lead to erroneous results.</p>
<p>The fact that this result was set externally is recorded in the
internal list of external initializations, accessible by the
method list_external_initializations().</p>
<p>Return a list of the number of
automorphisms (of det 1 and -1) of the quadratic form.</p>
<p>OUTPUT: None</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">list_external_initializations</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">set_number_of_automorphisms</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">number_of_automorphisms</span><span class="p">()</span>
<span class="go">-3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">list_external_initializations</span><span class="p">()</span>
<span class="go">[&#39;number_of_automorphisms&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.shimura_mass__maximal">
<tt class="descname">shimura_mass__maximal</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.shimura_mass__maximal" title="Permalink to this definition">¶</a></dt>
<dd><p>Use Shimura&#8217;s exact mass formula to compute the mass of a maximal
quadratic lattice. This works for any totally real number field,
but has a small technical restriction when <span class="math">\(n\)</span> is odd.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>none</dd>
<dt>OUTPUT:</dt>
<dd>a rational number</dd>
</dl>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">shimura_mass__maximal</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.short_primitive_vector_list_up_to_length">
<tt class="descname">short_primitive_vector_list_up_to_length</tt><big>(</big><em>len_bound</em>, <em>up_to_sign_flag=False</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.short_primitive_vector_list_up_to_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of lists of short primitive vectors <span class="math">\(v\)</span>, sorted by length, with
Q(<span class="math">\(v\)</span>) &lt; len_bound.  The list in output <span class="math">\([i]\)</span> indexes all vectors of
length <span class="math">\(i\)</span>.  If the up_to_sign_flag is set to True, then only one of
the vectors of the pair <span class="math">\([v, -v]\)</span> is listed.</p>
<p>Note:  This processes the PARI/GP output to always give elements of type <span class="math">\(ZZ\)</span>.</p>
<dl class="docutils">
<dt>OUTPUT:</dt>
<dd>a list of lists of vectors.</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">[[(0, 0, 0, 0)],</span>
<span class="go"> [(1, 0, 0, 0)],</span>
<span class="go"> [],</span>
<span class="go"> [(0, 1, 0, 0)],</span>
<span class="go"> [(1, 1, 0, 0), (-1, 1, 0, 0), (2, 0, 0, 0)]]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">short_primitive_vector_list_up_to_length</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">[[], [(1, 0, 0, 0)], [], [(0, 1, 0, 0)], [(1, 1, 0, 0), (-1, 1, 0, 0)]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.short_vector_list_up_to_length">
<tt class="descname">short_vector_list_up_to_length</tt><big>(</big><em>len_bound</em>, <em>up_to_sign_flag=False</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.short_vector_list_up_to_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of lists of short vectors <span class="math">\(v\)</span>, sorted by length, with
Q(<span class="math">\(v\)</span>) &lt; len_bound.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">len_bound</span></tt> &#8211; bound for the length of the vectors.</li>
<li><tt class="docutils literal"><span class="pre">up_to_sign_flag</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">False</span></tt>) if set to True, then
only one of the vectors of the pair <span class="math">\([v, -v]\)</span> is listed.</li>
</ul>
<p>OUTPUT:</p>
<p>A list of lists of vectors such that entry <span class="math">\([i]\)</span> contains all
vectors of length <span class="math">\(i\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[[(0, 0, 0, 0)], [(1, 0, 0, 0), (-1, 0, 0, 0)], []]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">[[(0, 0, 0, 0)],</span>
<span class="go"> [(1, 0, 0, 0), (-1, 0, 0, 0)],</span>
<span class="go"> [],</span>
<span class="go"> [(0, 1, 0, 0), (0, -1, 0, 0)]]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[[(0, 0, 0, 0)],</span>
<span class="go"> [(1, 0, 0, 0), (-1, 0, 0, 0)],</span>
<span class="go"> [],</span>
<span class="go"> [(0, 1, 0, 0), (0, -1, 0, 0)],</span>
<span class="go"> [(1, 1, 0, 0),</span>
<span class="go"> (-1, -1, 0, 0),</span>
<span class="go"> (-1, 1, 0, 0),</span>
<span class="go"> (1, -1, 0, 0),</span>
<span class="go"> (2, 0, 0, 0),</span>
<span class="go"> (-2, 0, 0, 0)]]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">[[(0, 0, 0, 0)],</span>
<span class="go"> [(1, 0, 0, 0)],</span>
<span class="go"> [],</span>
<span class="go"> [(0, 1, 0, 0)],</span>
<span class="go"> [(1, 1, 0, 0), (-1, 1, 0, 0), (2, 0, 0, 0)]]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">matrix</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">vs</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">vs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vs</span><span class="p">))]</span>
<span class="go">[1, 72, 270, 720, 936, 2160, 2214, 3600]</span>
<span class="gp">sage: </span><span class="n">vs</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>  <span class="c"># long time (28s on sage.math, 2014)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">vs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vs</span><span class="p">))]</span>       <span class="c"># long time</span>
<span class="go">[1, 72, 270, 720, 936, 2160, 2214, 3600, 4590, 6552, 5184, 10800, 9360, 12240, 13500, 17712, 14760, 25920, 19710, 26064, 28080, 36000, 25920, 47520, 37638, 43272, 45900, 59040, 46800, 75600]</span>
</pre></div>
</div>
<p>The cases of <tt class="docutils literal"><span class="pre">len_bound</span> <span class="pre">&lt;</span> <span class="pre">2</span></tt> led to exception or infinite runtime before.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[[(0, 0, 0, 0, 0, 0)]]</span>
</pre></div>
</div>
<p>In the case of quadratic forms that are not positive definite an error is raised.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">QuadraticForm</span><span class="p">(</span><span class="n">matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]))</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Quadratic form must be positive definite in order to enumerate short vectors</span>
</pre></div>
</div>
<p>Check that PARI doesn&#8217;t return vectors which are too long:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">72</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">120</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">len_bound_pari</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="mi">22953421</span> <span class="o">-</span> <span class="mi">2</span><span class="p">;</span> <span class="n">len_bound_pari</span>
<span class="go">45906840</span>
<span class="gp">sage: </span><span class="n">vs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">_pari_</span><span class="p">()</span><span class="o">.</span><span class="n">qfminim</span><span class="p">(</span><span class="n">len_bound_pari</span><span class="p">)[</span><span class="mi">2</span><span class="p">])</span>  <span class="c"># long time (18s on sage.math, 2014)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">vs</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">v</span>  <span class="c"># long time</span>
<span class="go">[-66, 623]~</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">Vec</span><span class="p">()</span> <span class="o">*</span> <span class="n">Q</span><span class="o">.</span><span class="n">_pari_</span><span class="p">()</span> <span class="o">*</span> <span class="n">v</span>  <span class="c"># long time</span>
<span class="go">45902280</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.siegel_product">
<tt class="descname">siegel_product</tt><big>(</big><em>u</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.siegel_product" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the infinite product of local densities of the quadratic
form for the number <span class="math">\(u\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">1 + 8*q + 24*q^2 + 32*q^3 + 24*q^4 + 48*q^5 + 96*q^6 + 64*q^7 + 24*q^8 + 104*q^9 + 144*q^10 + O(q^11)</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">siegel_product</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">8</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">siegel_product</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>      <span class="c">## This one is wrong -- expect 24, and the higher powers of 2 don&#39;t work... =(</span>
<span class="go">24</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">siegel_product</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">32</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">siegel_product</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">48</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">siegel_product</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="go">96</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">siegel_product</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">64</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">siegel_product</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="go">104</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span> <span class="nb">len</span><span class="p">([</span><span class="n">v</span>  <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">mrange</span><span class="p">([</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">])</span>  <span class="k">if</span> <span class="n">Q</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">%</span> <span class="n">M</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">M</span><span class="o">^</span><span class="mi">3</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span> <span class="nb">len</span><span class="p">([</span><span class="n">v</span>  <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">mrange</span><span class="p">([</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">])</span>  <span class="k">if</span> <span class="n">Q</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">%</span> <span class="n">M</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">M</span><span class="o">^</span><span class="mi">3</span>  <span class="c"># long time (2s on sage.math, 2014)</span>
<span class="go">1</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">3/2</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span> <span class="nb">len</span><span class="p">([</span><span class="n">v</span>  <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">mrange</span><span class="p">([</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">])</span>  <span class="k">if</span> <span class="n">Q</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">%</span> <span class="n">M</span> <span class="o">==</span> <span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">M</span><span class="o">^</span><span class="mi">3</span>
<span class="go">3/2</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span> <span class="nb">len</span><span class="p">([</span><span class="n">v</span>  <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">mrange</span><span class="p">([</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">])</span>  <span class="k">if</span> <span class="n">Q</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">%</span> <span class="n">M</span> <span class="o">==</span> <span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">M</span><span class="o">^</span><span class="mi">3</span>  <span class="c"># long time (2s on sage.math, 2014)</span>
<span class="go">3/2</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">siegel_product</span><span class="p">(</span><span class="n">ZZ</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>  <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">)]</span> <span class="o">==</span> <span class="n">Q</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>  <span class="c"># long time (2s on sage.math, 2014)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.signature">
<tt class="descname">signature</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.signature" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the signature of the quadratic form, defined as:</p>
<blockquote>
<div>number of positive eigenvalues - number of negative eigenvalues</div></blockquote>
<p>of the matrix of the quadratic form.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>None</dd>
<dt>OUTPUT:</dt>
<dd>an integer</dd>
<dt>EXAMPLES:</dt>
<dd>sage: Q = DiagonalQuadraticForm(ZZ, [1,0,0,-4,3,11,3])
sage: Q.signature()
3</dd>
</dl>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">signature</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span> <span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 0 1 2 3 ]</span>
<span class="go">[ * 4 5 6 ]</span>
<span class="go">[ * * 7 8 ]</span>
<span class="go">[ * * * 9 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">signature</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.signature_vector">
<tt class="descname">signature_vector</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.signature_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the triple <span class="math">\((p, n, z)\)</span> of integers where</p>
<ul class="simple">
<li><span class="math">\(p\)</span> = number of positive eigenvalues</li>
<li><span class="math">\(n\)</span> = number of negative eigenvalues</li>
<li><span class="math">\(z\)</span> = number of zero eigenvalues</li>
</ul>
<p>for the symmetric matrix associated to Q.</p>
<p>INPUT:</p>
<p>(none)</p>
<p>OUTPUT:</p>
<p>a triple of integers &gt;= 0</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">signature_vector</span><span class="p">()</span>
<span class="go">(1, 1, 2)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">signature_vector</span><span class="p">()</span>
<span class="go">(2, 2, 0)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span> <span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 0 1 2 3 ]</span>
<span class="go">[ * 4 5 6 ]</span>
<span class="go">[ * * 7 8 ]</span>
<span class="go">[ * * * 9 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">signature_vector</span><span class="p">()</span>
<span class="go">(3, 1, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.split_local_cover">
<tt class="descname">split_local_cover</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.split_local_cover" title="Permalink to this definition">¶</a></dt>
<dd><p>Tries to find subform of the given (positive definite quaternary)
quadratic form Q of the form</p>
<div class="math">
\[d*x^2 + T(y,z,w)\]</div>
<p>where <span class="math">\(d &gt; 0\)</span> is as small as possible.</p>
<p>This is done by exhaustive search on small vectors, and then
comparing the local conditions of its sum with it&#8217;s complementary
lattice and the original quadratic form Q.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>none</dd>
<dt>OUTPUT:</dt>
<dd>a QuadraticForm over ZZ</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">split_local_cover</span><span class="p">()</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 3 0 0 ]</span>
<span class="go">[ * 7 0 ]</span>
<span class="go">[ * * 5 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.sum_by_coefficients_with">
<tt class="descname">sum_by_coefficients_with</tt><big>(</big><em>right</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.sum_by_coefficients_with" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the sum (on coefficients) of two quadratic forms of the same size.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 4 ]</span>
<span class="go">[ * 10 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">+</span><span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 4 0 0 ]</span>
<span class="go">[ * 10 0 0 ]</span>
<span class="go">[ * * 1 4 ]</span>
<span class="go">[ * * * 10 ]</span>

<span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">sum_by_coefficients_with</span><span class="p">(</span><span class="n">Q2</span><span class="p">)</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 2 8 ]</span>
<span class="go">[ * 0 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.swap_variables">
<tt class="descname">swap_variables</tt><big>(</big><em>r</em>, <em>s</em>, <em>in_place=False</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.swap_variables" title="Permalink to this definition">¶</a></dt>
<dd><p>Switch the variables <span class="math">\(x_r\)</span> and <span class="math">\(x_s\)</span> in the quadratic form
(replacing the original form if the in_place flag is True).</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><span class="math">\(r\)</span>, <span class="math">\(s\)</span> &#8211; integers &gt;= 0</dd>
<dt>OUTPUT:</dt>
<dd>a QuadraticForm (by default, otherwise none)</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 2 3 4 ]</span>
<span class="go">[ * 5 6 7 ]</span>
<span class="go">[ * * 8 9 ]</span>
<span class="go">[ * * * 10 ]</span>


<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">swap_variables</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 8 6 3 9 ]</span>
<span class="go">[ * 5 2 7 ]</span>
<span class="go">[ * * 1 4 ]</span>
<span class="go">[ * * * 10 ]</span>


<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">swap_variables</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">swap_variables</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 2 3 4 ]</span>
<span class="go">[ * 5 6 7 ]</span>
<span class="go">[ * * 8 9 ]</span>
<span class="go">[ * * * 10 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.theta_by_cholesky">
<tt class="descname">theta_by_cholesky</tt><big>(</big><em>q_prec</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.theta_by_cholesky" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the real Cholesky decomposition to compute (the <span class="math">\(q\)</span>-expansion of) the
theta function of the quadratic form as a power series in <span class="math">\(q\)</span> with terms
correct up to the power <span class="math">\(q^{\text{q\_prec}}\)</span>. (So its error is <span class="math">\(O(q^
{\text{q\_prec} + 1})\)</span>.)</p>
<dl class="docutils">
<dt>REFERENCE:</dt>
<dd>From Cohen&#8217;s &#8220;A Course in Computational Algebraic Number Theory&#8221; book,
p 102.</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre>## Check the sum of 4 squares form against Jacobi&#39;s formula
sage: Q = DiagonalQuadraticForm(ZZ, [1,1,1,1])
sage: Theta = Q.theta_by_cholesky(10)
sage: Theta
1 + 8*q + 24*q^2 + 32*q^3 + 24*q^4 + 48*q^5 + 96*q^6 + 64*q^7 + 24*q^8 + 104*q^9 + 144*q^10
sage: Expected =  [1] + [8*sum([d for d in divisors(n) if d%4 != 0])  for n in range(1,11)]
sage: Expected
[1, 8, 24, 32, 24, 48, 96, 64, 24, 104, 144]
sage: Theta.list() == Expected
True
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>## Check the form x^2 + 3y^2 + 5z^2 + 7w^2 represents everything except 2 and 22.
sage: Q = DiagonalQuadraticForm(ZZ, [1,3,5,7])
sage: Theta = Q.theta_by_cholesky(50)
sage: Theta_list = Theta.list()
sage: [m  for m in range(len(Theta_list))  if Theta_list[m] == 0]
[2, 22]
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.theta_by_pari">
<tt class="descname">theta_by_pari</tt><big>(</big><em>Max</em>, <em>var_str='q'</em>, <em>safe_flag=True</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.theta_by_pari" title="Permalink to this definition">¶</a></dt>
<dd><p>Use PARI/GP to compute the theta function as a power series (or
vector) up to the precision <span class="math">\(O(q^Max)\)</span>.  This also caches the result
for future computations.</p>
<p>If var_str = &#8216;&#8217;, then we return a vector <span class="math">\(v\)</span> where <span class="math">\(v[i]\)</span> counts the
number of vectors of length <span class="math">\(i\)</span>.</p>
<p>The safe_flag allows us to select whether we want a copy of the
output, or the original output.  It is only meaningful when a
vector is returned, otherwise a copy is automatically made in
creating the power series.  By default safe_flag = True, so we
return a copy of the cached information.  If this is set to False,
then the routine is much faster but the return values are
vulnerable to being corrupted by the user.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>Max &#8211; an integer &gt;=0
var_str &#8211; a string</dd>
<dt>OUTPUT:</dt>
<dd>a power series or a vector</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Prec</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">sage: </span><span class="n">compute</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">theta_by_pari</span><span class="p">(</span><span class="n">Prec</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">exact</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">8</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">([</span><span class="n">d</span>  <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">divisors</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>  <span class="k">if</span> <span class="n">d</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">])</span>  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Prec</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">compute</span> <span class="o">==</span> <span class="n">exact</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.theta_series">
<tt class="descname">theta_series</tt><big>(</big><em>Max=10</em>, <em>var_str='q'</em>, <em>safe_flag=True</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.theta_series" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the theta series as a power series in the variable given
in var_str (which defaults to &#8216;<span class="math">\(q\)</span>&#8216;), up to the specified precision
<span class="math">\(O(q^max)\)</span>.</p>
<p>This uses the PARI/GP function qfrep, wrapped by the
theta_by_pari() method.  This caches the result for future
computations.</p>
<p>The safe_flag allows us to select whether we want a copy of the
output, or the original output.  It is only meaningful when a
vector is returned, otherwise a copy is automatically made in
creating the power series.  By default safe_flag = True, so we
return a copy of the cached information.  If this is set to False,
then the routine is much faster but the return values are
vulnerable to being corrupted by the user.</p>
<p>TO DO: Allow the option Max=&#8217;mod_form&#8217; to give enough coefficients
to ensure we determine the theta series as a modular form.  This
is related to the Sturm bound, but we&#8217;ll need to be careful about
this (particularly for half-integral weights!).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">theta_series</span><span class="p">()</span>
<span class="go">1 + 2*q + 2*q^3 + 6*q^4 + 2*q^5 + 4*q^6 + 6*q^7 + 8*q^8 + 14*q^9 + O(q^10)</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<span class="go">1 + 2*q + 2*q^3 + 6*q^4 + 2*q^5 + 4*q^6 + 6*q^7 + 8*q^8 + 14*q^9 + 4*q^10 + 12*q^11 + 18*q^12 + 12*q^13 + 12*q^14 + 8*q^15 + 34*q^16 + 12*q^17 + 8*q^18 + 32*q^19 + 10*q^20 + 28*q^21 + 16*q^23 + 44*q^24 + O(q^25)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.theta_series_degree_2">
<tt class="descname">theta_series_degree_2</tt><big>(</big><em>Q</em>, <em>prec</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.theta_series_degree_2" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the theta series of degree 2 for the quadratic form Q.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">prec</span></tt> &#8211; an integer.</li>
</ul>
<p>OUTPUT:</p>
<p>dictionary, where:</p>
<ul class="simple">
<li>keys are <span class="math">\({\rm GL}_2(\ZZ)\)</span>-reduced binary quadratic forms (given as triples of
coefficients)</li>
<li>values are coefficients</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Q2</span><span class="o">.</span><span class="n">theta_series_degree_2</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)]</span>
<span class="go">24</span>
<span class="gp">sage: </span><span class="n">S</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span>
<span class="go">144</span>
<span class="gp">sage: </span><span class="n">S</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span>
<span class="go">192</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Gonzalo Tornaria (2010-03-23)</li>
</ul>
<p>REFERENCE:</p>
<ul class="simple">
<li>Raum, Ryan, Skoruppa, Tornaria, &#8216;On Formal Siegel Modular Forms&#8217;
(preprint)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.vectors_by_length">
<tt class="descname">vectors_by_length</tt><big>(</big><em>bound</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.vectors_by_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of short vectors together with their values.</p>
<p>This is a naive algorithm which uses the Cholesky decomposition,
but does not use the LLL-reduction algorithm.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>bound &#8211; an integer &gt;= 0</dd>
<dt>OUTPUT:</dt>
<dd>A list L of length (bound + 1) whose entry L <span class="math">\([i]\)</span> is a list of
all vectors of length <span class="math">\(i\)</span>.</dd>
</dl>
<p>Reference: This is a slightly modified version of Cohn&#8217;s Algorithm
2.7.5 in &#8220;A Course in Computational Number Theory&#8221;, with the
increment step moved around and slightly re-indexed to allow clean
looping.</p>
<p>Note: We could speed this up for very skew matrices by using LLL
first, and then changing coordinates back, but for our purposes
the simpler method is efficient enough. =)</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">vectors_by_length</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[[[0, 0]],</span>
<span class="go"> [[0, -1], [-1, 0]],</span>
<span class="go"> [[-1, -1], [1, -1]],</span>
<span class="go"> [],</span>
<span class="go"> [[0, -2], [-2, 0]],</span>
<span class="go"> [[-1, -2], [1, -2], [-2, -1], [2, -1]]]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">vectors_by_length</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[[[0, 0, 0, 0]],</span>
<span class="go"> [[-1, 0, 0, 0]],</span>
<span class="go"> [],</span>
<span class="go"> [[0, -1, 0, 0]],</span>
<span class="go"> [[-1, -1, 0, 0], [1, -1, 0, 0], [-2, 0, 0, 0]],</span>
<span class="go"> [[0, 0, -1, 0]]]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">Q</span><span class="o">.</span><span class="n">vectors_by_length</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">[1, 12, 12]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">Q</span><span class="o">.</span><span class="n">vectors_by_length</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">[1, 3, 0, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.xi">
<tt class="descname">xi</tt><big>(</big><em>p</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.xi" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value of the genus characters Xi_p... which may be missing one character.
We allow -1 as a prime.</p>
<p>Reference: Dickson&#8217;s &#8220;Studies in the Theory of Numbers&#8221;</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">14</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q1</span><span class="o">.</span><span class="n">omega</span><span class="p">(),</span> <span class="n">Q2</span><span class="o">.</span><span class="n">omega</span><span class="p">()]</span>
<span class="go">[5, 5]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q1</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">Q2</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>    <span class="c"># equivalent over Q_5</span>
<span class="go">[1, 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q1</span><span class="o">.</span><span class="n">xi</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">Q2</span><span class="o">.</span><span class="n">xi</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>                              <span class="c"># not equivalent over Z_5</span>
<span class="go">[1, -1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm.xi_rec">
<tt class="descname">xi_rec</tt><big>(</big><em>p</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.xi_rec" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns Xi(<span class="math">\(p\)</span>) for the reciprocal form.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">14</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q1</span><span class="o">.</span><span class="n">clifford_conductor</span><span class="p">(),</span> <span class="n">Q2</span><span class="o">.</span><span class="n">clifford_conductor</span><span class="p">()]</span>   <span class="c"># equivalent over Q</span>
<span class="go">[3, 3]</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_locally_equivalent_to</span><span class="p">(</span><span class="n">Q2</span><span class="p">)</span>                <span class="c"># not in the same genus</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q1</span><span class="o">.</span><span class="n">delta</span><span class="p">(),</span> <span class="n">Q2</span><span class="o">.</span><span class="n">delta</span><span class="p">()]</span>
<span class="go">[480, 480]</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="mi">480</span><span class="p">)</span>
<span class="go">2^5 * 3 * 5</span>
<span class="gp">sage: </span><span class="nb">map</span><span class="p">(</span><span class="n">Q1</span><span class="o">.</span><span class="n">xi_rec</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="go">[-1, -1, -1, 1]</span>
<span class="gp">sage: </span><span class="nb">map</span><span class="p">(</span><span class="n">Q2</span><span class="o">.</span><span class="n">xi_rec</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="go">[-1, -1, -1, -1]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sage.quadratic_forms.quadratic_form.QuadraticForm__constructor">
<tt class="descclassname">sage.quadratic_forms.quadratic_form.</tt><tt class="descname">QuadraticForm__constructor</tt><big>(</big><em>R</em>, <em>n=None</em>, <em>entries=None</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm__constructor" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for the QuadraticForm class constructor.  This is meant
for internal use within the QuadraticForm class code only.  You
should instead directly call QuadraticForm().</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.quadratic_form</span> <span class="kn">import</span> <span class="n">QuadraticForm__constructor</span>
<span class="gp">sage: </span><span class="n">QuadraticForm__constructor</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>   <span class="c">## Makes a generic quadratic form over the integers</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 0 0 0 ]</span>
<span class="go">[ * 0 0 ]</span>
<span class="go">[ * * 0 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.quadratic_forms.quadratic_form.is_QuadraticForm">
<tt class="descclassname">sage.quadratic_forms.quadratic_form.</tt><tt class="descname">is_QuadraticForm</tt><big>(</big><em>Q</em><big>)</big><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.is_QuadraticForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the object Q is an element of the QuadraticForm class.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.quadratic_form</span> <span class="kn">import</span> <span class="n">is_QuadraticForm</span>
<span class="gp">sage: </span><span class="n">is_QuadraticForm</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>  <span class="c">##random</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_QuadraticForm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="c">##random</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="../../index.html"
                                  title="previous chapter">Quadratic Forms</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="binary_qf.html"
                                  title="next chapter">Binary Quadratic Forms with Integer Coefficients</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../_sources/sage/quadratic_forms/quadratic_form.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="binary_qf.html" title="Binary Quadratic Forms with Integer Coefficients"
             >next</a> |</li>
        <li class="right" >
          <a href="../../index.html" title="Quadratic Forms"
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../index.html">Quadratic Forms</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer">
        &copy; Copyright 2005--2015, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>