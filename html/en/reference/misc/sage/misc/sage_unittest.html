<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Unit testing for Sage objects &mdash; Sage Reference Manual v6.10: Utilities</title>
    
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '6.10',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v6.10: Utilities" href="../../index.html" />
    <link rel="next" title="Random testing" href="random_testing.html" />
    <link rel="prev" title="License" href="copying.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="random_testing.html" title="Random testing"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="copying.html" title="License"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../index.html">Utilities</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="unit-testing-for-sage-objects">
<span id="sage-misc-sage-unittest"></span><h1>Unit testing for Sage objects<a class="headerlink" href="#unit-testing-for-sage-objects" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.misc.sage_unittest"></span><dl class="class">
<dt id="sage.misc.sage_unittest.InstanceTester">
<em class="property">class </em><tt class="descclassname">sage.misc.sage_unittest.</tt><tt class="descname">InstanceTester</tt><big>(</big><em>instance</em>, <em>elements=None</em>, <em>verbose=False</em>, <em>prefix=''</em>, <em>max_runs=4096</em>, <em>**options</em><big>)</big><a class="headerlink" href="#sage.misc.sage_unittest.InstanceTester" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">unittest.case.TestCase</span></tt></p>
<p>A gadget attached to an instance providing it with testing utilities.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.misc.sage_unittest</span> <span class="kn">import</span> <span class="n">InstanceTester</span>
<span class="gp">sage: </span><span class="n">InstanceTester</span><span class="p">(</span><span class="n">instance</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">elements</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">Testing utilities for Integer Ring</span>
</pre></div>
</div>
<p>This is used by <tt class="docutils literal"><span class="pre">SageObject._tester</span></tt>, which see:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">QQ</span><span class="o">.</span><span class="n">_tester</span><span class="p">()</span>
<span class="go">Testing utilities for Rational Field</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.misc.sage_unittest.InstanceTester.info">
<tt class="descname">info</tt><big>(</big><em>message</em>, <em>newline=True</em><big>)</big><a class="headerlink" href="#sage.misc.sage_unittest.InstanceTester.info" title="Permalink to this definition">¶</a></dt>
<dd><p>Displays user information</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.misc.sage_unittest</span> <span class="kn">import</span> <span class="n">InstanceTester</span>
<span class="gp">sage: </span><span class="n">tester</span> <span class="o">=</span> <span class="n">InstanceTester</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">tester</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">);</span> <span class="n">tester</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;world&quot;</span><span class="p">)</span>
<span class="go">hello</span>
<span class="go">world</span>

<span class="gp">sage: </span><span class="n">tester</span> <span class="o">=</span> <span class="n">InstanceTester</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">tester</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">);</span> <span class="n">tester</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;world&quot;</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">tester</span> <span class="o">=</span> <span class="n">InstanceTester</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">tester</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">,</span> <span class="n">newline</span> <span class="o">=</span> <span class="bp">False</span><span class="p">);</span> <span class="n">tester</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot; world&quot;</span><span class="p">)</span>
<span class="go">hello world</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.misc.sage_unittest.InstanceTester.runTest">
<tt class="descname">runTest</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.misc.sage_unittest.InstanceTester.runTest" title="Permalink to this definition">¶</a></dt>
<dd><p>Trivial implementation of <tt class="xref py py-meth docutils literal"><span class="pre">unittest.TestCase.runTest()</span></tt> to
please the super class <tt class="xref py py-class docutils literal"><span class="pre">TestCase</span></tt>. That&#8217;s the price to
pay for abusively inheriting from it.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.misc.sage_unittest</span> <span class="kn">import</span> <span class="n">InstanceTester</span>
<span class="gp">sage: </span><span class="n">tester</span> <span class="o">=</span> <span class="n">InstanceTester</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">tester</span><span class="o">.</span><span class="n">runTest</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.misc.sage_unittest.InstanceTester.some_elements">
<tt class="descname">some_elements</tt><big>(</big><em>S=None</em><big>)</big><a class="headerlink" href="#sage.misc.sage_unittest.InstanceTester.some_elements" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list (or iterable) of elements of <tt class="docutils literal"><span class="pre">self</span></tt> on which
the tests should be run. This is only meaningful for container
objects like parents.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">S</span></tt> &#8211; a set of elements to select from.  By default this
will use the elements passed to this tester at creation
time, or the result of <a class="reference internal" href="#sage.misc.sage_unittest.InstanceTester.some_elements" title="sage.misc.sage_unittest.InstanceTester.some_elements"><tt class="xref py py-meth docutils literal"><span class="pre">some_elements()</span></tt></a> if no elements
were specified.</li>
</ul>
<p>OUTPUT:</p>
<p>A list of at most <tt class="docutils literal"><span class="pre">self._max_runs</span></tt> elements of <tt class="docutils literal"><span class="pre">S</span></tt>.</p>
<p>EXAMPLES:</p>
<p>By default, this calls <a class="reference internal" href="#sage.misc.sage_unittest.InstanceTester.some_elements" title="sage.misc.sage_unittest.InstanceTester.some_elements"><tt class="xref py py-meth docutils literal"><span class="pre">some_elements()</span></tt></a> on the instance:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.misc.sage_unittest</span> <span class="kn">import</span> <span class="n">InstanceTester</span>
<span class="gp">sage: </span><span class="k">class</span> <span class="nc">MyParent</span><span class="p">(</span><span class="n">Parent</span><span class="p">):</span>
<span class="gp">... </span>      <span class="k">def</span> <span class="nf">some_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>          <span class="k">return</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="gp">...</span>
<span class="gp">sage: </span><span class="n">tester</span> <span class="o">=</span> <span class="n">InstanceTester</span><span class="p">(</span><span class="n">MyParent</span><span class="p">())</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">tester</span><span class="o">.</span><span class="n">some_elements</span><span class="p">())</span>
<span class="go">[1, 2, 3, 4, 5]</span>

<span class="gp">sage: </span><span class="n">tester</span> <span class="o">=</span> <span class="n">InstanceTester</span><span class="p">(</span><span class="n">MyParent</span><span class="p">(),</span> <span class="n">max_runs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">tester</span><span class="o">.</span><span class="n">some_elements</span><span class="p">())</span>
<span class="go">[1, 2, 3]</span>

<span class="gp">sage: </span><span class="n">tester</span> <span class="o">=</span> <span class="n">InstanceTester</span><span class="p">(</span><span class="n">MyParent</span><span class="p">(),</span> <span class="n">max_runs</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">tester</span><span class="o">.</span><span class="n">some_elements</span><span class="p">())</span>
<span class="go">[1, 2, 3, 4, 5]</span>

<span class="gp">sage: </span><span class="n">tester</span> <span class="o">=</span> <span class="n">InstanceTester</span><span class="p">(</span><span class="n">MyParent</span><span class="p">(),</span> <span class="n">elements</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">tester</span><span class="o">.</span><span class="n">some_elements</span><span class="p">())</span>
<span class="go">[1, 3, 5]</span>

<span class="gp">sage: </span><span class="n">tester</span> <span class="o">=</span> <span class="n">InstanceTester</span><span class="p">(</span><span class="n">MyParent</span><span class="p">(),</span> <span class="n">elements</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">max_runs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">tester</span><span class="o">.</span><span class="n">some_elements</span><span class="p">())</span>
<span class="go">[1, 3]</span>

<span class="gp">sage: </span><span class="n">tester</span> <span class="o">=</span> <span class="n">InstanceTester</span><span class="p">(</span><span class="n">FiniteEnumeratedSet</span><span class="p">([</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">,</span><span class="s">&#39;d&#39;</span><span class="p">]),</span> <span class="n">max_runs</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">tester</span><span class="o">.</span><span class="n">some_elements</span><span class="p">()</span>
<span class="go">[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]</span>

<span class="gp">sage: </span><span class="n">tester</span> <span class="o">=</span> <span class="n">InstanceTester</span><span class="p">(</span><span class="n">FiniteEnumeratedSet</span><span class="p">([]))</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">tester</span><span class="o">.</span><span class="n">some_elements</span><span class="p">())</span>
<span class="go">[]</span>

<span class="gp">sage: </span><span class="n">tester</span> <span class="o">=</span> <span class="n">InstanceTester</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ZZ</span><span class="o">.</span><span class="n">some_elements</span><span class="p">()</span>             <span class="c"># yikes, shamelessly trivial ...</span>
<span class="go">&lt;generator object _some_elements_from_iterator at 0x...&gt;</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">tester</span><span class="o">.</span><span class="n">some_elements</span><span class="p">())</span>
<span class="go">[0, 1, -1, 2, -2, ..., 49, -49, 50]</span>

<span class="gp">sage: </span><span class="n">tester</span> <span class="o">=</span> <span class="n">InstanceTester</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">elements</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">,</span> <span class="n">max_runs</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">tester</span><span class="o">.</span><span class="n">some_elements</span><span class="p">())</span>
<span class="go">[0, 1, -1, 2, -2]</span>

<span class="gp">sage: </span><span class="n">tester</span> <span class="o">=</span> <span class="n">InstanceTester</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">elements</span> <span class="o">=</span> <span class="n">srange</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">max_runs</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">tester</span><span class="o">.</span><span class="n">some_elements</span><span class="p">())</span>
<span class="go">[0, 1, 2, 3, 4]</span>

<span class="gp">sage: </span><span class="n">tester</span> <span class="o">=</span> <span class="n">InstanceTester</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">elements</span> <span class="o">=</span> <span class="n">srange</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">max_runs</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">tester</span><span class="o">.</span><span class="n">some_elements</span><span class="p">())</span>
<span class="go">[0, 1, 2]</span>
</pre></div>
</div>
<p>Test for <a class="reference external" href="http://trac.sagemath.org/15919">trac ticket #15919</a>, <a class="reference external" href="http://trac.sagemath.org/16244">trac ticket #16244</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Z</span> <span class="o">=</span> <span class="n">IntegerModRing</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="c"># random.sample, which was used pre #16244, has a threshold at 21!</span>
<span class="gp">sage: </span><span class="n">Z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>                   <span class="c"># since #8389, indexed access is used for ring extensions</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">variable name &#39;1&#39; does not start with a letter</span>
<span class="gp">sage: </span><span class="n">tester</span> <span class="o">=</span> <span class="n">InstanceTester</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">elements</span><span class="o">=</span><span class="n">Z</span><span class="p">,</span> <span class="n">max_runs</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">tester</span><span class="o">.</span><span class="n">some_elements</span><span class="p">())</span>
<span class="go">[0, 1, 2, 3, 4]</span>

<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">cartesian_product</span><span class="p">([</span><span class="n">Z</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="go">390625</span>
<span class="gp">sage: </span><span class="n">tester</span> <span class="o">=</span> <span class="n">InstanceTester</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">elements</span> <span class="o">=</span> <span class="n">C</span><span class="p">,</span> <span class="n">max_runs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">tester</span><span class="o">.</span><span class="n">some_elements</span><span class="p">())</span>
<span class="go">[(0, 0, 0, 0), (0, 0, 0, 1), (0, 0, 0, 2), (0, 0, 0, 3)]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.misc.sage_unittest.PythonObjectWithTests">
<em class="property">class </em><tt class="descclassname">sage.misc.sage_unittest.</tt><tt class="descname">PythonObjectWithTests</tt><big>(</big><em>instance</em><big>)</big><a class="headerlink" href="#sage.misc.sage_unittest.PythonObjectWithTests" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>Utility class for running basis tests on a plain Python object
(that is not in SageObject). More test methods can be added here.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">TestSuite</span><span class="p">(</span><span class="s">&quot;bla&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.misc.sage_unittest.TestSuite">
<em class="property">class </em><tt class="descclassname">sage.misc.sage_unittest.</tt><tt class="descname">TestSuite</tt><big>(</big><em>instance</em><big>)</big><a class="headerlink" href="#sage.misc.sage_unittest.TestSuite" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>Test suites for Sage objects.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">TestSuite</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>No output means that all tests passed. Which tests?
In practice this calls all the methods <tt class="docutils literal"><span class="pre">._test_*</span></tt> of this
object, in alphabetic order:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">TestSuite</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">running ._test_category() . . . pass</span>
<span class="go">running ._test_eq() . . . pass</span>
<span class="go">running ._test_nonzero_equal() . . . pass</span>
<span class="go">running ._test_not_implemented_methods() . . . pass</span>
<span class="go">running ._test_pickling() . . . pass</span>
</pre></div>
</div>
<p>Those methods are typically implemented by abstract
super classes, in particular via categories, in order to
enforce standard behavior and API, or provide mathematical
sanity checks. For example if <tt class="docutils literal"><span class="pre">self</span></tt> is in the category of
finite semigroups, this checks that the multiplication is
associative (at least on some elements):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">FiniteSemigroups</span><span class="p">()</span><span class="o">.</span><span class="n">example</span><span class="p">(</span><span class="n">alphabet</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">TestSuite</span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">running ._test_an_element() . . . pass</span>
<span class="go">running ._test_associativity() . . . pass</span>
<span class="go">running ._test_cardinality() . . . pass</span>
<span class="go">running ._test_category() . . . pass</span>
<span class="go">running ._test_elements() . . .</span>
<span class="go">  Running the test suite of self.an_element()</span>
<span class="go">  running ._test_category() . . . pass</span>
<span class="go">  running ._test_eq() . . . pass</span>
<span class="go">  running ._test_not_implemented_methods() . . . pass</span>
<span class="go">  running ._test_pickling() . . . pass</span>
<span class="go">  pass</span>
<span class="go">running ._test_elements_eq_reflexive() . . . pass</span>
<span class="go">running ._test_elements_eq_symmetric() . . . pass</span>
<span class="go">running ._test_elements_eq_transitive() . . . pass</span>
<span class="go">running ._test_elements_neq() . . . pass</span>
<span class="go">running ._test_enumerated_set_contains() . . . pass</span>
<span class="go">running ._test_enumerated_set_iter_cardinality() . . . pass</span>
<span class="go">running ._test_enumerated_set_iter_list() . . . pass</span>
<span class="go">running ._test_eq() . . . pass</span>
<span class="go">running ._test_not_implemented_methods() . . . pass</span>
<span class="go">running ._test_pickling() . . . pass</span>
<span class="go">running ._test_some_elements() . . . pass</span>
</pre></div>
</div>
<p>The different test methods can be called independently:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">_test_associativity</span><span class="p">()</span>
</pre></div>
</div>
<p>Debugging tip: in case of failure of some test, use <tt class="docutils literal"><span class="pre">%pdb</span> <span class="pre">on</span></tt> to
turn on automatic debugging on error. Run the failing test
independtly: the debugger will stop right where the first
assertion fails. Then, introspection can be used to analyse what
exactly the problem is. See also the <tt class="docutils literal"><span class="pre">catch</span> <span class="pre">=</span> <span class="pre">False</span></tt> option to
<a class="reference internal" href="#sage.misc.sage_unittest.TestSuite.run" title="sage.misc.sage_unittest.TestSuite.run"><tt class="xref py py-meth docutils literal"><span class="pre">run()</span></tt></a>.</p>
<p>When meaningful, one can further customize on which elements
the tests are run. Here, we use it to <em>prove</em> that the
multiplication is indeed associative, by running the test on
all the elements:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">_test_associativity</span><span class="p">(</span><span class="n">elements</span> <span class="o">=</span> <span class="n">S</span><span class="p">)</span>
</pre></div>
</div>
<p>Adding a new test boils down to adding a new method in the class
of the object or any super class (e.g. in a category). This method
should use the utility <tt class="xref py py-meth docutils literal"><span class="pre">_tester()</span></tt> to handle standard options
and report test failures. See the code of
<tt class="xref py py-meth docutils literal"><span class="pre">_test_an_element()</span></tt> for an example. Note: Python&#8217;s testunit
convention is to look for methods called <tt class="docutils literal"><span class="pre">.test*</span></tt>; we use instead
<tt class="docutils literal"><span class="pre">._test_*</span></tt> so as not to pollute the object&#8217;s interface.</p>
<p>Eventually, every implementation of a <a class="reference external" href="../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Sage Reference Manual: Basic Structures v6.10)"><tt class="xref py py-class docutils literal"><span class="pre">SageObject</span></tt></a> should
run a <a class="reference internal" href="#sage.misc.sage_unittest.TestSuite" title="sage.misc.sage_unittest.TestSuite"><tt class="xref py py-class docutils literal"><span class="pre">TestSuite</span></tt></a> on one of its instances in its doctest
(replacing the current <tt class="docutils literal"><span class="pre">loads(dumps(x))</span></tt> tests).</p>
<p>Finally, running <tt class="docutils literal"><span class="pre">TestSuite</span></tt> on a standard Python object does
some basic sanity checks:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">TestSuite</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">running ._test_pickling() . . . pass</span>
</pre></div>
</div>
<p>TODO:</p>
<blockquote>
<div><ul class="simple">
<li>Allow for customized behavior in case of failing assertion
(warning, error, statistic accounting).
This involves reimplementing the methods fail / failIf / ...
of unittest.TestCase in InstanceTester</li>
<li>Don&#8217;t catch the exceptions if <tt class="docutils literal"><span class="pre">TestSuite(..).run()</span></tt> is called
under the debugger, or with <tt class="docutils literal"><span class="pre">%pdb</span></tt> on (how to detect this? see
<tt class="docutils literal"><span class="pre">get_ipython()</span></tt>, <tt class="docutils literal"><span class="pre">IPython.Magic.shell.call_pdb</span></tt>, ...)
In the mean time, see the <tt class="docutils literal"><span class="pre">catch=False</span></tt> option.</li>
<li>Run the tests according to the inheritance order, from most
generic to most specific, rather than alphabetically. Then, the
first failure will be the most relevant, the others being
usually consequences.</li>
<li>Improve integration with doctests (statistics on failing/passing tests)</li>
<li>Add proper support for nested testsuites.</li>
<li>Integration with unittest:
Make TestSuite inherit from unittest.TestSuite?
Make <tt class="docutils literal"><span class="pre">.run(...)</span></tt> accept a result object</li>
<li>Add some standard option <tt class="docutils literal"><span class="pre">proof</span> <span class="pre">=</span> <span class="pre">True</span></tt>, asking for the
test method to choose appropriately the elements so as to
prove the desired property. The test method may assume that
a parent implements properly all the super categories. For
example, the <tt class="docutils literal"><span class="pre">_test_commutative</span></tt> method of the category
<tt class="docutils literal"><span class="pre">CommutativeSemigroups()</span></tt> may just check that the
provided generators commute, implicitly assuming that
generators indeed generate the semigroup (as required by
<tt class="docutils literal"><span class="pre">Semigroups()</span></tt>).</li>
</ul>
</div></blockquote>
<dl class="method">
<dt id="sage.misc.sage_unittest.TestSuite.run">
<tt class="descname">run</tt><big>(</big><em>category=None</em>, <em>skip=</em>, <span class="optional">[</span><span class="optional">]</span><em>catch=True</em>, <em>raise_on_failure=False</em>, <em>**options</em><big>)</big><a class="headerlink" href="#sage.misc.sage_unittest.TestSuite.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run all the tests from this test suite:</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">category</span></tt>         - a category; reserved for future use</li>
<li><tt class="docutils literal"><span class="pre">skip</span></tt>             - a string or list (or iterable) of strings</li>
<li><tt class="docutils literal"><span class="pre">raise_on_failure</span></tt> - a boolean (default: False)</li>
<li><tt class="docutils literal"><span class="pre">catch</span></tt>            - a boolean (default: True)</li>
</ul>
</div></blockquote>
<p>All other options are passed down to the individual tests.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">TestSuite</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>We now use the <tt class="docutils literal"><span class="pre">verbose</span></tt> option:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">TestSuite</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">running ._test_category() . . . pass</span>
<span class="go">running ._test_eq() . . . pass</span>
<span class="go">running ._test_nonzero_equal() . . . pass</span>
<span class="go">running ._test_not_implemented_methods() . . . pass</span>
<span class="go">running ._test_pickling() . . . pass</span>
</pre></div>
</div>
<p>Some tests may be skipped using the <tt class="docutils literal"><span class="pre">skip</span></tt> option:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">TestSuite</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">skip</span> <span class="o">=</span><span class="s">&quot;_test_pickling&quot;</span><span class="p">)</span>
<span class="go">running ._test_category() . . . pass</span>
<span class="go">running ._test_eq() . . . pass</span>
<span class="go">running ._test_nonzero_equal() . . . pass</span>
<span class="go">running ._test_not_implemented_methods() . . . pass</span>
<span class="gp">sage: </span><span class="n">TestSuite</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">skip</span> <span class="o">=</span><span class="p">[</span><span class="s">&quot;_test_pickling&quot;</span><span class="p">,</span> <span class="s">&quot;_test_category&quot;</span><span class="p">])</span>
<span class="go">running ._test_eq() . . . pass</span>
<span class="go">running ._test_nonzero_equal() . . . pass</span>
<span class="go">running ._test_not_implemented_methods() . . . pass</span>
</pre></div>
</div>
<p>We now show (and test) some standard error reports:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">class</span> <span class="nc">Blah</span><span class="p">(</span><span class="n">SageObject</span><span class="p">):</span>
<span class="gp">... </span>      <span class="k">def</span> <span class="nf">_test_a</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tester</span><span class="p">):</span> <span class="k">pass</span>
<span class="gp">... </span>      <span class="k">def</span> <span class="nf">_test_b</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tester</span><span class="p">):</span> <span class="n">tester</span><span class="o">.</span><span class="n">fail</span><span class="p">()</span>
<span class="gp">... </span>      <span class="k">def</span> <span class="nf">_test_c</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tester</span><span class="p">):</span> <span class="k">pass</span>
<span class="gp">... </span>      <span class="k">def</span> <span class="nf">_test_d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tester</span><span class="p">):</span> <span class="n">tester</span><span class="o">.</span><span class="n">fail</span><span class="p">()</span>

<span class="gp">sage: </span><span class="n">TestSuite</span><span class="p">(</span><span class="n">Blah</span><span class="p">())</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="go">Failure in _test_b:</span>
<span class="gt">Traceback (most recent call last):</span>
  <span class="c">...</span>
<span class="gr">AssertionError</span>: <span class="n">None</span>
<span class="go">------------------------------------------------------------</span>
<span class="go">Failure in _test_d:</span>
<span class="gt">Traceback (most recent call last):</span>
  <span class="c">...</span>
<span class="gr">AssertionError</span>: <span class="n">None</span>
<span class="go">------------------------------------------------------------</span>
<span class="go">Failure in _test_pickling:</span>
<span class="gt">Traceback (most recent call last):</span>
  <span class="c">...</span>
<span class="gr">PicklingError</span>: <span class="n">Can&#39;t pickle &lt;class &#39;__main__.Blah&#39;&gt;: attribute lookup __main__.Blah failed</span>
<span class="go">------------------------------------------------------------</span>
<span class="go">The following tests failed: _test_b, _test_d, _test_pickling</span>

<span class="gp">sage: </span><span class="n">TestSuite</span><span class="p">(</span><span class="n">Blah</span><span class="p">())</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">running ._test_a() . . . pass</span>
<span class="go">running ._test_b() . . . fail</span>
<span class="gt">Traceback (most recent call last):</span>
  <span class="c">...</span>
<span class="gr">AssertionError</span>: <span class="n">None</span>
<span class="go">------------------------------------------------------------</span>
<span class="go">running ._test_c() . . . pass</span>
<span class="go">running ._test_category() . . . pass</span>
<span class="go">running ._test_d() . . . fail</span>
<span class="gt">Traceback (most recent call last):</span>
  <span class="c">...</span>
<span class="gr">AssertionError</span>: <span class="n">None</span>
<span class="go">------------------------------------------------------------</span>
<span class="go">running ._test_not_implemented_methods() . . . pass</span>
<span class="go">running ._test_pickling() . . . fail</span>
<span class="gt">Traceback (most recent call last):</span>
  <span class="c">...</span>
<span class="gr">PicklingError</span>: <span class="n">Can&#39;t pickle &lt;class &#39;__main__.Blah&#39;&gt;: attribute lookup __main__.Blah failed</span>
<span class="go">------------------------------------------------------------</span>
<span class="go">The following tests failed: _test_b, _test_d, _test_pickling</span>

<span class="go">File &quot;/opt/sage/local/lib/python/site-packages/sage/misc/sage_unittest.py&quot;, line 183, in run</span>
<span class="go">test_method(tester = tester)</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">catch=False</span></tt> option prevents <tt class="docutils literal"><span class="pre">TestSuite</span></tt> from
catching exceptions:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">TestSuite</span><span class="p">(</span><span class="n">Blah</span><span class="p">())</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">catch</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  <span class="c">...</span>
<span class="gr">  File ..., in _test_b</span>
<span class="gr">    def _test_b(self, tester)</span>: <span class="n">tester.fail()</span>
<span class="x">  ...</span>
<span class="x">AssertionError: None</span>
</pre></div>
</div>
<p>In conjonction with <tt class="docutils literal"><span class="pre">%pdb</span> <span class="pre">on</span></tt>, this allows for the debbuger
to jump directly to the first failure location.</p>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="sage.misc.sage_unittest.TestSuiteFailure">
<em class="property">exception </em><tt class="descclassname">sage.misc.sage_unittest.</tt><tt class="descname">TestSuiteFailure</tt><a class="headerlink" href="#sage.misc.sage_unittest.TestSuiteFailure" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/library/exceptions.html#exceptions.AssertionError" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">exceptions.AssertionError</span></tt></a></p>
</dd></dl>

<dl class="function">
<dt id="sage.misc.sage_unittest.instance_tester">
<tt class="descclassname">sage.misc.sage_unittest.</tt><tt class="descname">instance_tester</tt><big>(</big><em>instance</em>, <em>tester=None</em>, <em>**options</em><big>)</big><a class="headerlink" href="#sage.misc.sage_unittest.instance_tester" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a gadget attached to <tt class="docutils literal"><span class="pre">instance</span></tt> providing testing utilities.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.misc.sage_unittest</span> <span class="kn">import</span> <span class="n">instance_tester</span>
<span class="gp">sage: </span><span class="n">tester</span> <span class="o">=</span> <span class="n">instance_tester</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">tester</span><span class="o">.</span><span class="n">assert_</span><span class="p">(</span><span class="mi">1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">tester</span><span class="o">.</span><span class="n">assert_</span><span class="p">(</span><span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AssertionError</span>: <span class="n">False is not true</span>
<span class="gp">sage: </span><span class="n">tester</span><span class="o">.</span><span class="n">assert_</span><span class="p">(</span><span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;this is expected to fail&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AssertionError</span>: <span class="n">this is expected to fail</span>

<span class="gp">sage: </span><span class="n">tester</span><span class="o">.</span><span class="n">assertEquals</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">tester</span><span class="o">.</span><span class="n">assertEquals</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AssertionError</span>: <span class="n">1 != 0</span>
</pre></div>
</div>
<p>The available assertion testing facilities are the same as in
<a class="reference external" href="https://docs.python.org/library/unittest.html#unittest.TestCase" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">unittest.TestCase</span></tt></a> <a class="reference internal" href="#unittest" id="id1">[UNITTEST]</a>, which see (actually, by a slight
abuse, tester is currently an instance of this class).</p>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">instance_tester</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">tester</span> <span class="o">=</span> <span class="n">tester</span><span class="p">)</span> <span class="ow">is</span> <span class="n">tester</span>
<span class="go">True</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="unittest" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[UNITTEST]</a></td><td>unittest &#8211; Unit testing framework &#8211;
<a class="reference external" href="http://docs.python.org/library/unittest.html">http://docs.python.org/library/unittest.html</a></td></tr>
</tbody>
</table>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="copying.html"
                                  title="previous chapter">License</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="random_testing.html"
                                  title="next chapter">Random testing</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../_sources/sage/misc/sage_unittest.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="random_testing.html" title="Random testing"
             >next</a> |</li>
        <li class="right" >
          <a href="copying.html" title="License"
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../index.html">Utilities</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer">
        &copy; Copyright 2005--2015, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>