<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="Lazy format strings" href="lazy_format.html" /><link rel="prev" title="Verbosity System and Logging in SageMath" href="verbose.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>Lazy attributes - Utilities</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom-furo.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Utilities</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 10.0 Reference Manual</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../index.html">Home - Utilities</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="defaults.html">Default Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="functional.html">Functional notation</a></li>
<li class="toctree-l1"><a class="reference internal" href="randstate.html">Random Number States</a></li>
<li class="toctree-l1"><a class="reference internal" href="prandom.html">Random Numbers with Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="unknown.html">The Unknown truth value</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="abstract_method.html">Abstract methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="bindable_class.html">Bindable classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="decorators.html">Decorators</a></li>
<li class="toctree-l1"><a class="reference internal" href="constant_function.html">Constant functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="classcall_metaclass.html">Special Methods for Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="inherit_comparison.html">Metaclass for inheriting comparison functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="method_decorator.html">Base Class to Support Method Decorators</a></li>
<li class="toctree-l1"><a class="reference internal" href="object_multiplexer.html">Multiplex calls to one object to calls to many objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="fast_methods.html">Fast methods via Cython</a></li>
<li class="toctree-l1"><a class="reference internal" href="call.html">Attribute and method calling</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="callable_dict.html">Callable dictionaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="converting_dict.html">Converting Dictionary</a></li>
<li class="toctree-l1"><a class="reference internal" href="flatten.html">Flatten nested lists</a></li>
<li class="toctree-l1"><a class="reference internal" href="search.html">Searching a sorted list</a></li>
<li class="toctree-l1"><a class="reference internal" href="mrange.html">Multidimensional enumeration</a></li>
<li class="toctree-l1"><a class="reference internal" href="multireplace.html">multi_replace</a></li>
<li class="toctree-l1"><a class="reference internal" href="map_threaded.html">Threaded map function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../arith/srange.html">Ranges and the <code class="docutils literal notranslate"><span class="pre">[1,2,..,n]</span></code> notation</a></li>
<li class="toctree-l1"><a class="reference internal" href="element_with_label.html">Elements with labels.</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="temporary_file.html">Temporary file handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="remote_file.html">get_remote_file</a></li>
<li class="toctree-l1"><a class="reference internal" href="messaging.html">Message delivery</a></li>
<li class="toctree-l1"><a class="reference internal" href="sage_ostools.html">Miscellaneous operating system functions</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../databases/sql_db.html">Relational (sqlite) Databases Module</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../structure/graphics_file.html">Wrapper for Graphics Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../media/wav.html">Work with WAV files</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="stopgap.html">Stopgaps</a></li>
<li class="toctree-l1"><a class="reference internal" href="superseded.html">Handling Superseded Functionality</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="misc.html">Miscellaneous functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="misc_c.html">Miscellaneous functions (Cython)</a></li>
<li class="toctree-l1"><a class="reference internal" href="verbose.html">Verbosity System and Logging in SageMath</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Lazy attributes</a></li>
<li class="toctree-l1"><a class="reference internal" href="lazy_format.html">Lazy format strings</a></li>
<li class="toctree-l1"><a class="reference internal" href="lazy_import.html">Lazy imports</a></li>
<li class="toctree-l1"><a class="reference internal" href="lazy_import_cache.html">Lazy import cache</a></li>
<li class="toctree-l1"><a class="reference internal" href="lazy_list.html">Lazy lists</a></li>
<li class="toctree-l1"><a class="reference internal" href="lazy_string.html">Lazy strings</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="cachefunc.html">Cached Functions and Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="weak_dict.html">Fast and safe weak value dictionary</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ext/fast_callable.html">Fast Expression Evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ext/fast_eval.html">Fast Numerical Evaluation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../features.html">Testing for features of the environment at runtime</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/join_feature.html">Join features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/all.html">Enumeration of all defined features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/sagemath.html">Features for testing the presence of Python modules in the Sage library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/pkg_systems.html">Features for testing the presence of package systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/bliss.html">Features for testing the presence of <code class="docutils literal notranslate"><span class="pre">bliss</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/csdp.html">Feature for testing the presence of <code class="docutils literal notranslate"><span class="pre">csdp</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/databases.html">Features for testing the presence of various databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/dvipng.html">Feature for testing the presence of <code class="docutils literal notranslate"><span class="pre">dvipng</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/ffmpeg.html">Feature for testing the presence of <code class="docutils literal notranslate"><span class="pre">ffmpeg</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/four_ti_2.html">Features for testing the presence of <code class="docutils literal notranslate"><span class="pre">4ti2</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/gap.html">Features for testing the presence of GAP packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/graph_generators.html">Features for testing the presence of various graph generator programs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/graphviz.html">Features for testing the presence of <code class="docutils literal notranslate"><span class="pre">graphviz</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/imagemagick.html">Feature for testing the presence of <code class="docutils literal notranslate"><span class="pre">imagemagick</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/interfaces.html">Features for testing whether interpreter interfaces are functional</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/internet.html">Feature for testing if the Internet is available</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/kenzo.html">Feature for testing the presence of <code class="docutils literal notranslate"><span class="pre">kenzo</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/latex.html">Features for testing the presence of <code class="docutils literal notranslate"><span class="pre">latex</span></code> and equivalent programs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/latte.html">Features for testing the presence of <code class="docutils literal notranslate"><span class="pre">latte_int</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/lrs.html">Feature for testing the presence of <code class="docutils literal notranslate"><span class="pre">lrslib</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/mcqd.html">Features for testing the presence of <code class="docutils literal notranslate"><span class="pre">mcqd</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/meataxe.html">Feature for testing the presence of <code class="docutils literal notranslate"><span class="pre">meataxe</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/mip_backends.html">Features for testing the presence of <code class="xref py py-class docutils literal notranslate"><span class="pre">MixedIntegerLinearProgram</span></code> backends</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/normaliz.html">Feature for testing the presence of <code class="docutils literal notranslate"><span class="pre">pynormaliz</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/pandoc.html">Feature for testing the presence of <code class="docutils literal notranslate"><span class="pre">pandoc</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/pdf2svg.html">Feature for testing the presence of <code class="docutils literal notranslate"><span class="pre">pdf2svg</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/polymake.html">Feature for testing the presence of the Python interface to polymake</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/rubiks.html">Features for testing the presence of <code class="docutils literal notranslate"><span class="pre">rubiks</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/tdlib.html">Features for testing the presence of <code class="docutils literal notranslate"><span class="pre">tdlib</span></code></a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="cython.html">Cython support functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="inline_fortran.html">Fortran compiler</a></li>
<li class="toctree-l1"><a class="reference internal" href="parser.html">A parser for symbolic equations and expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="python.html">Evaluating Python code without any preparsing</a></li>
<li class="toctree-l1"><a class="reference internal" href="sage_eval.html">Evaluating a String in Sage</a></li>
<li class="toctree-l1"><a class="reference internal" href="sh.html">Evaluating shell scripts</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../typeset/symbols.html">Symbols for Character Art</a></li>
<li class="toctree-l1"><a class="reference internal" href="../typeset/character_art.html">Base Class for Character-Based Art</a></li>
<li class="toctree-l1"><a class="reference internal" href="../typeset/character_art_factory.html">Factory for Character-Based Art</a></li>
<li class="toctree-l1"><a class="reference internal" href="../typeset/ascii_art.html">ASCII Art</a></li>
<li class="toctree-l1"><a class="reference internal" href="../typeset/unicode_art.html">Unicode Art</a></li>
<li class="toctree-l1"><a class="reference internal" href="../typeset/unicode_characters.html">Unicode Characters</a></li>
<li class="toctree-l1"><a class="reference internal" href="repr.html">Repr formatting support</a></li>
<li class="toctree-l1"><a class="reference internal" href="sage_input.html">Sage Input Formatting</a></li>
<li class="toctree-l1"><a class="reference internal" href="table.html">Tables</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="html.html">HTML Fragments</a></li>
<li class="toctree-l1"><a class="reference internal" href="mathml.html">MathML output support</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../sagetex.html">Installing and using SageTeX</a></li>
<li class="toctree-l1"><a class="reference internal" href="latex.html">LaTeX printing support</a></li>
<li class="toctree-l1"><a class="reference internal" href="latex_macros.html">LaTeX macros</a></li>
<li class="toctree-l1"><a class="reference internal" href="latex_standalone.html">Standalone LaTeX Document class and TikzPicture</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="func_persist.html">Support for persistent functions in .sage files</a></li>
<li class="toctree-l1"><a class="reference internal" href="persist.html">Object persistence</a></li>
<li class="toctree-l1"><a class="reference internal" href="fpickle.html">Function pickling</a></li>
<li class="toctree-l1"><a class="reference internal" href="explain_pickle.html">A tool for inspecting Python pickles</a></li>
<li class="toctree-l1"><a class="reference internal" href="nested_class.html">Fixing pickle for nested classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="session.html">Loading and saving sessions and listing all variables</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="banner.html">SageMath version and banner info</a></li>
<li class="toctree-l1"><a class="reference internal" href="reset.html">Interpreter reset</a></li>
<li class="toctree-l1"><a class="reference internal" href="viewer.html">Determination of programs for viewing web pages, etc.</a></li>
<li class="toctree-l1"><a class="reference internal" href="pager.html">Pager for showing strings</a></li>
<li class="toctree-l1"><a class="reference internal" href="sagedoc.html">Format Sage documentation for viewing with IPython and the notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="sagedoc_conf.html">Sphinx configuration shared by sage.misc.sphinxify and sage_docbuild</a></li>
<li class="toctree-l1"><a class="reference internal" href="sphinxify.html">Process docstrings with Sphinx</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="package.html">Listing Sage packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="dist.html">Installing shortcut scripts</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="citation.html">Dependency usage tracking for citations</a></li>
<li class="toctree-l1"><a class="reference internal" href="copying.html">License</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="sage_unittest.html">Unit testing for Sage objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="random_testing.html">Random testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="test_nested_class.html">Test for nested class Parent</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="benchmark.html">Benchmarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="sage_timeit.html">Accurate timing information for Sage commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="sage_timeit_class.html">The <code class="docutils literal notranslate"><span class="pre">timeit</span></code> command</a></li>
<li class="toctree-l1"><a class="reference internal" href="profiler.html">Simple profiling tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="gperftools.html">C Function Profiler Using Google Perftools</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../docs/instancedoc.html">Dynamic documentation for instances of classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="sageinspect.html">Inspect Python, Sage, and Cython objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="edit_module.html">Edit the source code of Sage interactively</a></li>
<li class="toctree-l1"><a class="reference internal" href="classgraph.html">Class inheritance graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev_tools.html">Some tools for developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="function_mangling.html">Function Mangling</a></li>
<li class="toctree-l1"><a class="reference internal" href="rest_index_of_methods.html">ReST index of functions</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ext/memory.html">Low-level memory allocation functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="c3.html">The C3 algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="c3_controlled.html">The C3 algorithm, under control of a total order</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="lazy-attributes">
<span id="sage-misc-lazy-attribute"></span><h1>Lazy attributes<a class="headerlink" href="#lazy-attributes" title="Permalink to this heading">#</a></h1>
<span class="target" id="module-sage.misc.lazy_attribute"></span><p>AUTHORS:</p>
<ul class="simple">
<li><p>Nicolas Thiery (2008): Initial version</p></li>
<li><p>Nils Bruin (2013-05): Cython version</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="sage.misc.lazy_attribute.lazy_attribute">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.misc.lazy_attribute.</span></span><span class="sig-name descname"><span class="pre">lazy_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.misc.lazy_attribute.lazy_attribute" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">_lazy_attribute</span></code></p>
<p>A lazy attribute for an object is like a usual attribute, except
that, instead of being computed when the object is constructed
(i.e. in <code class="docutils literal notranslate"><span class="pre">__init__</span></code>), it is computed on the fly the first time it
is accessed.</p>
<p>For constant values attached to an object, lazy attributes provide
a shorter syntax and automatic caching (unlike methods), while
playing well with inheritance (like methods): a subclass can
easily override a given attribute; you don’t need to call the
super class constructor, etc.</p>
<p>Technically, a <a class="reference internal" href="#sage.misc.lazy_attribute.lazy_attribute" title="sage.misc.lazy_attribute.lazy_attribute"><code class="xref py py-class docutils literal notranslate"><span class="pre">lazy_attribute</span></code></a> is a non-data descriptor (see
Invoking Descriptors in the Python reference manual).</p>
<p>EXAMPLES:</p>
<p>We create a class whose instances have a lazy attribute <code class="docutils literal notranslate"><span class="pre">x</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">class</span> <span class="nc">A</span><span class="p">():</span>
<span class="gp">....: </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">....: </span>        <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">=</span><span class="mi">2</span> <span class="c1"># just to have some data to calculate from</span>
<span class="gp">....:</span>
<span class="gp">....: </span>    <span class="nd">@lazy_attribute</span>
<span class="gp">....: </span>    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">....: </span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;calculating x in A&quot;</span><span class="p">)</span>
<span class="gp">....: </span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">....:</span>
</pre></div>
</div>
<p>For an instance <code class="docutils literal notranslate"><span class="pre">a</span></code> of <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">a.x</span></code> is calculated the first time it
is accessed, and then stored as a usual attribute:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">x</span>
<span class="go">calculating x in A</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">x</span>
<span class="go">3</span>
</pre></div>
</div>
<p class="rubric">Implementation details</p>
<p>We redo the same example, but opening the hood to see what happens to
the internal dictionary of the object:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="vm">__dict__</span>
<span class="go">{&#39;a&#39;: 2}</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">x</span>
<span class="go">calculating x in A</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="vm">__dict__</span>
<span class="go">{&#39;a&#39;: 2, &#39;x&#39;: 3}</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">x</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;a.x&#39;</span><span class="p">)</span> <span class="c1"># random</span>
<span class="go">625 loops, best of 3: 89.6 ns per loop</span>
</pre></div>
</div>
<p>This shows that, after the first calculation, the attribute <code class="docutils literal notranslate"><span class="pre">x</span></code>
becomes a usual attribute; in particular, there is no time penalty
to access it.</p>
<p>A lazy attribute may be set as usual, even before its first access,
in which case the lazy calculation is completely ignored:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">x</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="vm">__dict__</span>
<span class="go">{&#39;a&#39;: 2, &#39;x&#39;: 4}</span>
</pre></div>
</div>
<p>Class binding results in the lazy attribute itself:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">x</span>
<span class="go">&lt;sage.misc.lazy_attribute.lazy_attribute object at ...&gt;</span>
</pre></div>
</div>
<p class="rubric">Conditional definitions</p>
<p>The function calculating the attribute may return NotImplemented
to declare that, after all, it is not able to do it. In that case,
the attribute lookup proceeds in the super class hierarchy:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="nd">@lazy_attribute</span>
<span class="gp">....: </span>    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">....: </span>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">):</span>
<span class="gp">....: </span>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;calculating x from y in B&quot;</span><span class="p">)</span>
<span class="gp">....: </span>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>
<span class="gp">....: </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">....: </span>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;y not there; B does not define x&quot;</span><span class="p">)</span>
<span class="gp">....: </span>            <span class="k">return</span> <span class="bp">NotImplemented</span>
<span class="gp">....:</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">B</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">x</span>
<span class="go">y not there; B does not define x</span>
<span class="go">calculating x in A</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">B</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">x</span>
<span class="go">calculating x from y in B</span>
<span class="go">1</span>
</pre></div>
</div>
<p class="rubric">Attribute existence testing</p>
<p>Testing for the existence of an attribute with hasattr currently
always triggers its full calculation, which may not be desirable
when the calculation is expensive:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">hasattr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="go">calculating x in A</span>
<span class="go">True</span>
</pre></div>
</div>
<p>It would be great if we could take over the control somehow, if at
all possible without a special implementation of hasattr, so as to
allow for something like:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">class</span> <span class="nc">A</span> <span class="p">():</span>
<span class="gp">....: </span>    <span class="nd">@lazy_attribute</span>
<span class="gp">....: </span>    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">existence_only</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="gp">....: </span>        <span class="k">if</span> <span class="n">existence_only</span><span class="p">:</span>
<span class="gp">....: </span>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;testing for x existence&quot;</span><span class="p">)</span>
<span class="gp">....: </span>            <span class="k">return</span> <span class="kc">True</span>
<span class="gp">....: </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">....: </span>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;calculating x in A&quot;</span><span class="p">)</span>
<span class="gp">....: </span>            <span class="k">return</span> <span class="mi">3</span>
<span class="gp">....:</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">hasattr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="c1"># todo: not implemented</span>
<span class="go">testing for x existence</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">x</span>
<span class="go">calculating x in A</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">x</span>
<span class="go">3</span>
</pre></div>
</div>
<p>Here is a full featured example, with both conditional definition
and existence testing:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="nd">@lazy_attribute</span>
<span class="gp">....: </span>    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">existence_only</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="gp">....: </span>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">):</span>
<span class="gp">....: </span>            <span class="k">if</span> <span class="n">existence_only</span><span class="p">:</span>
<span class="gp">....: </span>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;testing for x existence in B&quot;</span><span class="p">)</span>
<span class="gp">....: </span>                <span class="k">return</span> <span class="kc">True</span>
<span class="gp">....: </span>            <span class="k">else</span><span class="p">:</span>
<span class="gp">....: </span>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;calculating x from y in B&quot;</span><span class="p">)</span>
<span class="gp">....: </span>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>
<span class="gp">....: </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">....: </span>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;y not there; B does not define x&quot;</span><span class="p">)</span>
<span class="gp">....: </span>            <span class="k">return</span> <span class="bp">NotImplemented</span>
<span class="gp">....:</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">B</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">hasattr</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="c1"># todo: not implemented</span>
<span class="go">y not there; B does not define x</span>
<span class="go">testing for x existence</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">x</span>
<span class="go">y not there; B does not define x</span>
<span class="go">calculating x in A</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">B</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="nb">hasattr</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="c1"># todo: not implemented</span>
<span class="go">testing for x existence in B</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">x</span>
<span class="go">calculating x from y in B</span>
<span class="go">1</span>
</pre></div>
</div>
<p class="rubric">lazy attributes and introspection</p>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>Make the following work nicely:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="err">?</span>                <span class="c1"># todo: not implemented</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="err">??</span>               <span class="c1"># todo: not implemented</span>
</pre></div>
</div>
</div>
<p>Right now, the first one includes the doc of this class, and the
second one brings up the code of this class, both being not very
useful.</p>
<p class="rubric">Lazy attributes and Cython</p>
<p>This attempts to check that lazy attributes work with built-in
functions like cpdef methods:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">class</span> <span class="nc">A</span><span class="p">:</span>
<span class="gp">....: </span>    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">....: </span>        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="nb">len</span> <span class="o">=</span> <span class="n">lazy_attribute</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span>
<span class="gp">....:</span>
<span class="gp">sage: </span><span class="n">A</span><span class="p">()</span><span class="o">.</span><span class="n">len</span>
<span class="go">5</span>
</pre></div>
</div>
<p>Since <a class="reference external" href="https://github.com/sagemath/sage/issues/11115">github issue #11115</a>, extension classes derived from
<a class="reference external" href="../../../structure/sage/structure/parent.html#sage.structure.parent.Parent" title="(in Parents and Elements v10.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parent</span></code></a> can inherit a lazy attribute,
such as <code class="docutils literal notranslate"><span class="pre">element_class</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cython_code</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;from sage.structure.parent cimport Parent&quot;</span><span class="p">,</span>
<span class="gp">....: </span><span class="s2">&quot;from sage.structure.element cimport Element&quot;</span><span class="p">,</span>
<span class="gp">....: </span><span class="s2">&quot;cdef class MyElement(Element): pass&quot;</span><span class="p">,</span>
<span class="gp">....: </span><span class="s2">&quot;cdef class MyParent(Parent):&quot;</span><span class="p">,</span>
<span class="gp">....: </span><span class="s2">&quot;    Element = MyElement&quot;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">cython</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cython_code</span><span class="p">))</span>                                    <span class="c1"># optional - sage.misc.cython</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">MyParent</span><span class="p">(</span><span class="n">category</span><span class="o">=</span><span class="n">Rings</span><span class="p">())</span>                                    <span class="c1"># optional - sage.misc.cython</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">element_class</span>    <span class="c1"># indirect doctest                             # optional - sage.misc.cython</span>
<span class="go">&lt;class &#39;...MyElement&#39;&gt;</span>
</pre></div>
</div>
<p class="rubric">About descriptor specifications</p>
<p>The specifications of descriptors (see 3.4.2.3 Invoking
Descriptors in the Python reference manual) are incomplete
w.r.t. inheritance, and maybe even ill-implemented. We illustrate
this on a simple class hierarchy, with an instrumented descriptor:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">class</span> <span class="nc">descriptor</span><span class="p">():</span>
<span class="gp">....: </span>    <span class="k">def</span> <span class="fm">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
<span class="gp">....: </span>        <span class="nb">print</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
<span class="gp">....: </span>        <span class="k">return</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="k">class</span> <span class="nc">A</span><span class="p">():</span>
<span class="gp">....: </span>    <span class="n">x</span> <span class="o">=</span> <span class="n">descriptor</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="k">pass</span>
<span class="gp">....:</span>
</pre></div>
</div>
<p>This is fine:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">x</span>
<span class="go">&lt;class &#39;__main__.A&#39;&gt;</span>
<span class="go">1</span>
</pre></div>
</div>
<p>The behaviour for the following case is not specified (see Instance Binding)
when <code class="docutils literal notranslate"><span class="pre">x</span></code> is not in the dictionary of <code class="docutils literal notranslate"><span class="pre">B</span></code> but in that of some super
category:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="p">()</span><span class="o">.</span><span class="n">x</span>
<span class="go">&lt;class &#39;__main__.B&#39;&gt;</span>
<span class="go">1</span>
</pre></div>
</div>
<p>It would seem more natural (and practical!) to get <code class="docutils literal notranslate"><span class="pre">A</span></code> rather than <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p>
<p>From the specifications for Super Binding, it would be expected to
get <code class="docutils literal notranslate"><span class="pre">A</span></code> and not <code class="docutils literal notranslate"><span class="pre">B</span></code> as cls parameter:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">super</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">B</span><span class="p">())</span><span class="o">.</span><span class="n">x</span>
<span class="go">&lt;class &#39;__main__.B&#39;&gt;</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Due to this, the natural implementation runs into an infinite loop
in the following example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">class</span> <span class="nc">A</span><span class="p">():</span>
<span class="gp">....: </span>    <span class="nd">@lazy_attribute</span>
<span class="gp">....: </span>    <span class="k">def</span> <span class="nf">unimplemented_A</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">....: </span>        <span class="k">return</span> <span class="bp">NotImplemented</span>
<span class="gp">....: </span>    <span class="nd">@lazy_attribute</span>
<span class="gp">....: </span>    <span class="k">def</span> <span class="nf">unimplemented_AB</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">....: </span>        <span class="k">return</span> <span class="bp">NotImplemented</span>
<span class="gp">....: </span>    <span class="nd">@lazy_attribute</span>
<span class="gp">....: </span>    <span class="k">def</span> <span class="nf">unimplemented_B_implemented_A</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">....: </span>        <span class="k">return</span> <span class="mi">1</span>
<span class="gp">....:</span>
<span class="gp">sage: </span><span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="nd">@lazy_attribute</span>
<span class="gp">....: </span>    <span class="k">def</span> <span class="nf">unimplemented_B</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">....: </span>        <span class="k">return</span> <span class="bp">NotImplemented</span>
<span class="gp">....: </span>    <span class="nd">@lazy_attribute</span>
<span class="gp">....: </span>    <span class="k">def</span> <span class="nf">unimplemented_AB</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">....: </span>        <span class="k">return</span> <span class="bp">NotImplemented</span>
<span class="gp">....: </span>    <span class="nd">@lazy_attribute</span>
<span class="gp">....: </span>    <span class="k">def</span> <span class="nf">unimplemented_B_implemented_A</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">....: </span>        <span class="k">return</span> <span class="bp">NotImplemented</span>
<span class="gp">....:</span>
<span class="gp">sage: </span><span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">B</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="k">pass</span>
<span class="gp">....:</span>
</pre></div>
</div>
<p>This is the simplest case where, without workaround, we get an
infinite loop:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">hasattr</span><span class="p">(</span><span class="n">B</span><span class="p">(),</span> <span class="s2">&quot;unimplemented_A&quot;</span><span class="p">)</span> <span class="c1"># todo: not implemented</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p>Improve the error message:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="p">()</span><span class="o">.</span><span class="n">unimplemented_A</span> <span class="c1"># todo: not implemented</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">AttributeError: &#39;super&#39; object has no attribute &#39;unimplemented_A&#39;</span>
</pre></div>
</div>
</div>
<p>We now make some systematic checks:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="p">()</span><span class="o">.</span><span class="n">unimplemented_A</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">AttributeError: &#39;...&#39; object has no attribute &#39;unimplemented_A&#39;</span>
<span class="gp">sage: </span><span class="n">B</span><span class="p">()</span><span class="o">.</span><span class="n">unimplemented_B</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">AttributeError: &#39;...&#39; object has no attribute &#39;unimplemented_B&#39;</span>
<span class="gp">sage: </span><span class="n">B</span><span class="p">()</span><span class="o">.</span><span class="n">unimplemented_AB</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">AttributeError: &#39;...&#39; object has no attribute &#39;unimplemented_AB&#39;</span>
<span class="gp">sage: </span><span class="n">B</span><span class="p">()</span><span class="o">.</span><span class="n">unimplemented_B_implemented_A</span>
<span class="go">1</span>

<span class="gp">sage: </span><span class="n">C</span><span class="p">()</span><span class="o">.</span><span class="n">unimplemented_A</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">AttributeError: &#39;...&#39; object has no attribute &#39;unimplemented_A&#39;</span>
<span class="gp">sage: </span><span class="n">C</span><span class="p">()</span><span class="o">.</span><span class="n">unimplemented_B</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">AttributeError: &#39;...&#39; object has no attribute &#39;unimplemented_B&#39;</span>
<span class="gp">sage: </span><span class="n">C</span><span class="p">()</span><span class="o">.</span><span class="n">unimplemented_AB</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">AttributeError: &#39;...&#39; object has no attribute &#39;unimplemented_AB&#39;</span>
<span class="gp">sage: </span><span class="n">C</span><span class="p">()</span><span class="o">.</span><span class="n">unimplemented_B_implemented_A</span> <span class="c1"># todo: not implemented</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.misc.lazy_attribute.lazy_class_attribute">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.misc.lazy_attribute.</span></span><span class="sig-name descname"><span class="pre">lazy_class_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.misc.lazy_attribute.lazy_class_attribute" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.misc.lazy_attribute.lazy_attribute" title="sage.misc.lazy_attribute.lazy_attribute"><code class="xref py py-class docutils literal notranslate"><span class="pre">lazy_attribute</span></code></a></p>
<p>A lazy class attribute for an class is like a usual class attribute,
except that, instead of being computed when the class is constructed, it
is computed on the fly the first time it is accessed, either through the
class itself or trough on of its objects.</p>
<p>This is very similar to <a class="reference internal" href="#sage.misc.lazy_attribute.lazy_attribute" title="sage.misc.lazy_attribute.lazy_attribute"><code class="xref py py-class docutils literal notranslate"><span class="pre">lazy_attribute</span></code></a> except that the attribute
is a class attribute. More precisely, once computed, the lazy class
attribute is stored in the class rather than in the object. The lazy class
attribute is only computed once for all the objects:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">class</span> <span class="nc">Cl</span><span class="p">():</span>
<span class="gp">....: </span>    <span class="nd">@lazy_class_attribute</span>
<span class="gp">....: </span>    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="gp">....: </span>         <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;computing x&quot;</span><span class="p">)</span>
<span class="gp">....: </span>         <span class="k">return</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">Cl</span><span class="o">.</span><span class="n">x</span>
<span class="go">computing x</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Cl</span><span class="o">.</span><span class="n">x</span>
<span class="go">1</span>
</pre></div>
</div>
<p>As for a any usual class attribute it is also possible to access it from
an object:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">Cl</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">x</span>
<span class="go">1</span>
</pre></div>
</div>
<p>First access from an object also properly triggers the computation:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">class</span> <span class="nc">Cl1</span><span class="p">():</span>
<span class="gp">....: </span>    <span class="nd">@lazy_class_attribute</span>
<span class="gp">....: </span>    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="gp">....: </span>         <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;computing x&quot;</span><span class="p">)</span>
<span class="gp">....: </span>         <span class="k">return</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">Cl1</span><span class="p">()</span><span class="o">.</span><span class="n">x</span>
<span class="go">computing x</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Cl1</span><span class="p">()</span><span class="o">.</span><span class="n">x</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The behavior of lazy class attributes with respect to inheritance is
not specified. It currently depends on the evaluation order:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">class</span> <span class="nc">A</span><span class="p">():</span>
<span class="gp">....: </span>    <span class="nd">@lazy_class_attribute</span>
<span class="gp">....: </span>    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="gp">....: </span>         <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;computing x&quot;</span><span class="p">)</span>
<span class="gp">....: </span>         <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="nd">@lazy_class_attribute</span>
<span class="gp">....: </span>    <span class="k">def</span> <span class="nf">y</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="gp">....: </span>         <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;computing y&quot;</span><span class="p">)</span>
<span class="gp">....: </span>         <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="k">pass</span>

<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">x</span>
<span class="go">computing x</span>
<span class="go">&quot;&lt;class &#39;__main__.A&#39;&gt;&quot;</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">x</span>
<span class="go">&quot;&lt;class &#39;__main__.A&#39;&gt;&quot;</span>

<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">y</span>
<span class="go">computing y</span>
<span class="go">&quot;&lt;class &#39;__main__.B&#39;&gt;&quot;</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">y</span>
<span class="go">computing y</span>
<span class="go">&quot;&lt;class &#39;__main__.A&#39;&gt;&quot;</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">y</span>
<span class="go">&quot;&lt;class &#39;__main__.B&#39;&gt;&quot;</span>
</pre></div>
</div>
</div>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="lazy_format.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Lazy format strings</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="verbose.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Verbosity System and Logging in SageMath</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2023, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Lazy attributes</a><ul>
<li><a class="reference internal" href="#sage.misc.lazy_attribute.lazy_attribute"><code class="docutils literal notranslate"><span class="pre">lazy_attribute</span></code></a></li>
<li><a class="reference internal" href="#sage.misc.lazy_attribute.lazy_class_attribute"><code class="docutils literal notranslate"><span class="pre">lazy_class_attribute</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/scripts/furo.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    </body>
</html>