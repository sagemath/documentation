<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=600, initial-scale=1">
    <title>Isogeny class of elliptic curves over number fields &mdash; Sage Reference Manual v7.3: Plane curves</title>
    
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '7.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v7.3: Plane curves" href="../../../index.html" />
    <link rel="next" title="Tate-Shafarevich group" href="sha_tate.html" />
    <link rel="prev" title="Galois representations for elliptic curves over number fields." href="gal_reps_number_field.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="sha_tate.html" title="Tate-Shafarevich group"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="gal_reps_number_field.html" title="Galois representations for elliptic curves over number fields."
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Plane curves</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="isogeny-class-of-elliptic-curves-over-number-fields">
<span id="sage-schemes-elliptic-curves-isogeny-class"></span><h1>Isogeny class of elliptic curves over number fields<a class="headerlink" href="#isogeny-class-of-elliptic-curves-over-number-fields" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.schemes.elliptic_curves.isogeny_class"></span><p>AUTHORS:</p>
<ul class="simple">
<li>David Roe (2012-03-29) &#8211; initial version.</li>
<li>John Cremona (2014-08) &#8211; extend to number fields.</li>
</ul>
<dl class="class">
<dt id="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC">
<em class="property">class </em><code class="descclassname">sage.schemes.elliptic_curves.isogeny_class.</code><code class="descname">IsogenyClass_EC</code><span class="sig-paren">(</span><em>E</em>, <em>label=None</em>, <em>empty=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Sage Reference Manual: Basic Structures v7.3)"><code class="xref py py-class docutils literal"><span class="pre">sage.structure.sage_object.SageObject</span></code></a></p>
<p>Isogeny class of an elliptic curve.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The current implementation chooses a curve from each isomorphism
class in the isogeny class. Over <span class="math">\(\QQ\)</span> this is a unique reduced
minimal model in each isomorphism class.  Over number fields the
model chosen may change in future.</p>
</div>
<dl class="method">
<dt id="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC.graph">
<code class="descname">graph</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC.graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a graph whose vertices correspond to curves in this
class, and whose edges correspond to prime degree isogenies.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">isocls</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;15a3&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">isocls</span><span class="o">.</span><span class="n">graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">_pos</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="go">[(1, [-0.8660254, 0.5]), (2, [-0.8660254, 1.5]), (3, [-1.7320508, 0]), (4, [0, 0]), (5, [0, -1]), (6, [0.8660254, 0.5]), (7, [0.8660254, 1.5]), (8, [1.7320508, 0])]</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="m78" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[M78]</td><td>B. Mazur.  Rational Isogenies of Prime Degree.
<em>Inventiones mathematicae</em> 44,129-162 (1978).</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC.index">
<code class="descname">index</code><span class="sig-paren">(</span><em>C</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC.index" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the index of a curve in this class.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">C</span></code> &#8211; an elliptic curve in this isogeny class.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">i</span></code> &#8211; an integer so that the <code class="docutils literal"><span class="pre">i</span></code> th curve in the class
is isomorphic to <code class="docutils literal"><span class="pre">C</span></code></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;990j1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">iso</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="s2">&quot;lmfdb&quot;</span><span class="p">)</span> <span class="c1"># orders lexicographically on a-invariants</span>
<span class="gp">sage: </span><span class="n">iso</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">short_weierstrass_model</span><span class="p">())</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC.isogenies">
<code class="descname">isogenies</code><span class="sig-paren">(</span><em>fill=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC.isogenies" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of lists of isogenies and 0s, corresponding to
the entries of <a class="reference internal" href="#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC.matrix" title="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC.matrix"><code class="xref py py-meth docutils literal"><span class="pre">matrix()</span></code></a></p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">fill</span></code> &#8211; boolean (default False).  Whether to only return
prime degree isogenies.  Currently only implemented for
<code class="docutils literal"><span class="pre">fill=False</span></code>.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a list of lists, where the <code class="docutils literal"><span class="pre">j</span></code> th entry of the <code class="docutils literal"><span class="pre">i</span></code> th list
is either zero or a prime degree isogeny from the <code class="docutils literal"><span class="pre">i</span></code> th curve
in this class to the <code class="docutils literal"><span class="pre">j</span></code> th curve.</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The domains and codomains of the isogenies will have the same
Weierstrass equation as the curves in this class, but they
may not be identical python objects in the current
implementation.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">isocls</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;15a3&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">isocls</span><span class="o">.</span><span class="n">isogenies</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">];</span> <span class="n">f</span>
<span class="go">Isogeny of degree 2 from Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 - 5*x + 2 over Rational Field to Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 - 80*x + 242 over Rational Field</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span> <span class="o">==</span> <span class="n">isocls</span><span class="o">.</span><span class="n">curves</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span> <span class="o">==</span> <span class="n">isocls</span><span class="o">.</span><span class="n">curves</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC.matrix">
<code class="descname">matrix</code><span class="sig-paren">(</span><em>fill=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC.matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the matrix whose entries give the minimal degrees of
isogenies between curves in this class.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">fill</span></code> &#8211; boolean (default True).  If False then the
matrix will contain only zeros and prime entries; if True it
will fill in the other degrees.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">isocls</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;15a3&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">isocls</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[ 1  2  2  2  4  4  8  8]</span>
<span class="go">[ 2  1  4  4  8  8 16 16]</span>
<span class="go">[ 2  4  1  4  8  8 16 16]</span>
<span class="go">[ 2  4  4  1  2  2  4  4]</span>
<span class="go">[ 4  8  8  2  1  4  8  8]</span>
<span class="go">[ 4  8  8  2  4  1  2  2]</span>
<span class="go">[ 8 16 16  4  8  2  1  4]</span>
<span class="go">[ 8 16 16  4  8  2  4  1]</span>
<span class="gp">sage: </span><span class="n">isocls</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[0 2 2 2 0 0 0 0]</span>
<span class="go">[2 0 0 0 0 0 0 0]</span>
<span class="go">[2 0 0 0 0 0 0 0]</span>
<span class="go">[2 0 0 0 2 2 0 0]</span>
<span class="go">[0 0 0 2 0 0 0 0]</span>
<span class="go">[0 0 0 2 0 0 2 2]</span>
<span class="go">[0 0 0 0 0 2 0 0]</span>
<span class="go">[0 0 0 0 0 2 0 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC.qf_matrix">
<code class="descname">qf_matrix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC.qf_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the array whose entries are quadratic forms
representing the degrees of isogenies between curves in this
class (CM case only).</p>
<p>OUTPUT:</p>
<p>a <span class="math">\(2x2\)</span> array (list of lists) of list, each of the form [2] or
[2,1,3] representing the coefficients of an integral quadratic
form in 1 or 2 variables whose values are the possible isogeny
degrees between the i&#8217;th and j&#8217;th curve in the class.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">pol</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">)([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">c</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">pol</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1480640</span><span class="o">+</span><span class="mi">565760</span><span class="o">*</span><span class="n">c</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">j</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">qf_matrix</span><span class="p">()</span>
<span class="go">[[[1], [2, 2, 3]], [[2, 2, 3], [1]]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC.reorder">
<code class="descname">reorder</code><span class="sig-paren">(</span><em>order</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC.reorder" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new isogeny class with the curves reordered.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">order</span></code> &#8211; None, a string or an iterable over all curves
in this class.  See
<a class="reference internal" href="ell_rational_field.html#sage.schemes.elliptic_curves.ell_rational_field.EllipticCurve_rational_field.isogeny_class" title="sage.schemes.elliptic_curves.ell_rational_field.EllipticCurve_rational_field.isogeny_class"><code class="xref py py-meth docutils literal"><span class="pre">sage.schemes.elliptic_curves.ell_rational_field.EllipticCurve_rational_field.isogeny_class()</span></code></a>
for more details.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>Another <a class="reference internal" href="#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC" title="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC"><code class="xref py py-class docutils literal"><span class="pre">IsogenyClass_EC</span></code></a> with the curves reordered
(and matrices and maps changed as appropriate)</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">isocls</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;15a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">repr</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="k">for</span> <span class="n">C</span> <span class="ow">in</span> <span class="n">isocls</span><span class="o">.</span><span class="n">curves</span><span class="p">]))</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 - 10*x - 10 over Rational Field</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 - 5*x + 2 over Rational Field</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 + 35*x - 28 over Rational Field</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 - 135*x - 660 over Rational Field</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 - 80*x + 242 over Rational Field</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 over Rational Field</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 - 110*x - 880 over Rational Field</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 - 2160*x - 39540 over Rational Field</span>
<span class="gp">sage: </span><span class="n">isocls2</span> <span class="o">=</span> <span class="n">isocls</span><span class="o">.</span><span class="n">reorder</span><span class="p">(</span><span class="s1">&#39;lmfdb&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">repr</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="k">for</span> <span class="n">C</span> <span class="ow">in</span> <span class="n">isocls2</span><span class="o">.</span><span class="n">curves</span><span class="p">]))</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 - 2160*x - 39540 over Rational Field</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 - 135*x - 660 over Rational Field</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 - 110*x - 880 over Rational Field</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 - 80*x + 242 over Rational Field</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 - 10*x - 10 over Rational Field</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 - 5*x + 2 over Rational Field</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 over Rational Field</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 + 35*x - 28 over Rational Field</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC_NumberField">
<em class="property">class </em><code class="descclassname">sage.schemes.elliptic_curves.isogeny_class.</code><code class="descname">IsogenyClass_EC_NumberField</code><span class="sig-paren">(</span><em>E</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC_NumberField" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC" title="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC"><code class="xref py py-class docutils literal"><span class="pre">sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC</span></code></a></p>
<p>Isogeny classes for elliptic curves over number fields.</p>
<dl class="method">
<dt id="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC_NumberField.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC_NumberField.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy (mostly used in reordering).</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C2</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="ow">is</span> <span class="n">C2</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">==</span> <span class="n">C2</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC_Rational">
<em class="property">class </em><code class="descclassname">sage.schemes.elliptic_curves.isogeny_class.</code><code class="descname">IsogenyClass_EC_Rational</code><span class="sig-paren">(</span><em>E</em>, <em>algorithm='sage'</em>, <em>label=None</em>, <em>empty=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC_Rational" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC_NumberField" title="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC_NumberField"><code class="xref py py-class docutils literal"><span class="pre">sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC_NumberField</span></code></a></p>
<p>Isogeny classes for elliptic curves over <span class="math">\(\QQ\)</span>.</p>
<dl class="method">
<dt id="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC_Rational.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC_Rational.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy (mostly used in reordering).</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C2</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="ow">is</span> <span class="n">C2</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">==</span> <span class="n">C2</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.isogeny_class.possible_isogeny_degrees">
<code class="descclassname">sage.schemes.elliptic_curves.isogeny_class.</code><code class="descname">possible_isogeny_degrees</code><span class="sig-paren">(</span><em>E</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.isogeny_class.possible_isogeny_degrees" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of primes <span class="math">\(\ell\)</span> sufficient to generate the
isogeny class of <span class="math">\(E\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">E</span></code> &#8211; An elliptic curve defined over a number field.</li>
</ul>
<p>OUTPUT:</p>
<p>A finite list of primes <span class="math">\(\ell\)</span> such that every curve isogenous to
this curve can be obtained by a finite sequence of isogenies of
degree one of the primes in the list.</p>
<p>ALGORITHM:</p>
<p>For curves without CM, the set may be taken to be the finite set
of primes at which the Galois representation is not surjective,
since the existence of an <span class="math">\(\ell\)</span>-isogeny is equivalent to the
image of the mod-<span class="math">\(\ell\)</span> Galois representation being contained in a
Borel subgroup.</p>
<p>For curves with CM by the order <span class="math">\(O\)</span> of discriminant <span class="math">\(d\)</span>, the
Galois representation is always non-surjective and the curve will
admit <span class="math">\(\ell\)</span>-isogenies for infinitely many primes <span class="math">\(\ell\)</span>, but
there are (of course) only finitely many codomains <span class="math">\(E'\)</span>.  The
primes can be divided according to the discriminant <span class="math">\(d'\)</span> of the CM
order <span class="math">\(O'\)</span> associated to <span class="math">\(E\)</span>: either <span class="math">\(O=O'\)</span>, or one contains the
other with index <span class="math">\(\ell\)</span>, since <span class="math">\(\ell O\subset O'\)</span> and vice versa.</p>
<p>Case (1): <span class="math">\(O=O'\)</span>.  The degrees of all isogenies between <span class="math">\(E\)</span> and
<span class="math">\(E'\)</span> are precisely the integers represented by one of the classes
of binary quadratic forms <span class="math">\(Q\)</span> of discriminant <span class="math">\(d\)</span>.  Hence to
obtain all possible isomorphism classes of codomain <span class="math">\(E'\)</span>, we need
only use one prime <span class="math">\(\ell\)</span> represented by each such class <span class="math">\(Q\)</span>.  It
would in fact suffice to use primes represented by forms which
generate the class group.  Here we simply omit the principal class
and one from each pair of inverse classes, and include a prime
represented by each of the remaining forms.</p>
<p>Case (2): <span class="math">\([O':O]=\ell\)</span>: so <span class="math">\(d=\ell^2d;\)</span>.  We include all prime
divisors of <span class="math">\(d\)</span>.</p>
<p>Case (3): <span class="math">\([O:O']=\ell\)</span>: we may assume that <span class="math">\(\ell\)</span> does not divide
<span class="math">\(d\)</span> as we have already included these, so <span class="math">\(\ell\)</span> either splits or
is inert in <span class="math">\(O\)</span>; the class numbers satisfy <span class="math">\(h(O')=(\ell\pm1)h(O)\)</span>
accordingly.  We include all primes <span class="math">\(\ell\)</span> such that <span class="math">\(\ell\pm1\)</span>
divides the degree <span class="math">\([K:\QQ]\)</span>.</p>
<p>For curves with only potential CM we proceed as in the CM case,
using <span class="math">\(2[K:\QQ]\)</span> instead of <span class="math">\([K:\QQ]\)</span>.</p>
<p>EXAMPLES:</p>
<p>For curves without CM we determine the primes at which the mod <span class="math">\(p\)</span>
Galois representation is reducible, i.e. contained in a Borel
subgroup:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.isogeny_class</span> <span class="kn">import</span> <span class="n">possible_isogeny_degrees</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">possible_isogeny_degrees</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">[5]</span>
</pre></div>
</div>
<p>We check that in this case <span class="math">\(E\)</span> really does have rational
<span class="math">\(5\)</span>-isogenies:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">phi</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span> <span class="k">for</span> <span class="n">phi</span> <span class="ow">in</span> <span class="n">E</span><span class="o">.</span><span class="n">isogenies_prime_degree</span><span class="p">()]</span>
<span class="go">[5, 5]</span>
</pre></div>
</div>
<p>Over an extension field:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E3</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">possible_isogeny_degrees</span><span class="p">(</span><span class="n">E3</span><span class="p">)</span>
<span class="go">[5]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">phi</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span> <span class="k">for</span> <span class="n">phi</span> <span class="ow">in</span> <span class="n">E3</span><span class="o">.</span><span class="n">isogenies_prime_degree</span><span class="p">()]</span>
<span class="go">[5, 5]</span>
</pre></div>
</div>
<p>For curves with CM by a quadratic order of class number greater
than <span class="math">\(1\)</span>, we use the structure of the class group to only give one
prime in each ideal class:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">pol</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">)([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">pol</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">j</span> <span class="o">=</span> <span class="n">hilbert_class_polynomial</span><span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">)</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">multiplicities</span><span class="o">=</span><span class="bp">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">j</span><span class="p">)</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.isogeny_class</span> <span class="kn">import</span> <span class="n">possible_isogeny_degrees</span>
<span class="gp">sage: </span><span class="n">possible_isogeny_degrees</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">CM case, discriminant = -23</span>
<span class="go">initial primes: {2}</span>
<span class="go">upward primes: {}</span>
<span class="go">downward ramified primes: {}</span>
<span class="go">downward split primes: {2, 3}</span>
<span class="go">downward inert primes: {5}</span>
<span class="go">primes generating the class group: [2]</span>
<span class="go">Complete set of primes: {2, 3, 5}</span>
<span class="go">[2, 3, 5]</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="gal_reps_number_field.html"
                                  title="previous chapter">Galois representations for elliptic curves over number fields.</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="sha_tate.html"
                                  title="next chapter">Tate-Shafarevich group</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../_sources/sage/schemes/elliptic_curves/isogeny_class.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="sha_tate.html" title="Tate-Shafarevich group"
             >next</a> |</li>
        <li class="right" >
          <a href="gal_reps_number_field.html" title="Galois representations for elliptic curves over number fields."
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Plane curves</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &copy; Copyright 2005--2016, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.4.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>