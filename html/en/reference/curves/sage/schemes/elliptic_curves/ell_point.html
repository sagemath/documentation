<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=600, initial-scale=1">
    <title>Points on elliptic curves &#8212; Sage Reference Manual v8.0: Plane curves</title>
    
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '8.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Elliptic curves over a general ring" href="ell_generic.html" />
    <link rel="prev" title="Construct elliptic curves as Jacobians" href="jacobian.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ell_generic.html" title="Elliptic curves over a general ring"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="jacobian.html" title="Construct elliptic curves as Jacobians"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Plane curves</a> &#187;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="points-on-elliptic-curves">
<span id="sage-schemes-elliptic-curves-ell-point"></span><h1>Points on elliptic curves<a class="headerlink" href="#points-on-elliptic-curves" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.schemes.elliptic_curves.ell_point"></span><p>The base class <code class="docutils literal"><span class="pre">EllipticCurvePoint_field</span></code>, derived from
<code class="docutils literal"><span class="pre">AdditiveGroupElement</span></code>, provides support for points on elliptic
curves defined over general fields.  The derived classes
<code class="docutils literal"><span class="pre">EllipticCurvePoint_number_field</span></code> and
<code class="docutils literal"><span class="pre">EllipticCurvePoint_finite_field</span></code> provide further support for point
on curves defined over number fields (including the rational field
<span class="math">\(\QQ\)</span>) and over finite fields.</p>
<p>The class <code class="docutils literal"><span class="pre">EllipticCurvePoint</span></code>, which is based on
<code class="docutils literal"><span class="pre">SchemeMorphism_point_projective_ring</span></code>, currently has little extra
functionality.</p>
<p>EXAMPLES:</p>
<p>An example over <span class="math">\(\QQ\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span> <span class="n">P</span>
<span class="go">(-1 : 1 : 1)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span> <span class="n">Q</span>
<span class="go">(0 : -1 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">+</span><span class="n">Q</span>
<span class="go">(4 : 8 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">-</span><span class="n">Q</span>
<span class="go">(1 : 0 : 1)</span>
<span class="gp">sage: </span><span class="mi">3</span><span class="o">*</span><span class="n">P</span><span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="n">Q</span>
<span class="go">(328/361 : -2800/6859 : 1)</span>
</pre></div>
</div>
<p>An example over a number field:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">);</span> <span class="n">P</span>
<span class="go">(0 : i : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="mi">101</span><span class="o">*</span><span class="n">P</span><span class="o">-</span><span class="mi">100</span><span class="o">*</span><span class="n">P</span><span class="o">==</span><span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>An example over a finite field:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">101</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">40</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">69</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">84</span> <span class="p">,</span> <span class="mi">58</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">73</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">45</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">1032210</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">1032210</span>
</pre></div>
</div>
<p>Arithmetic with a point over an extension of a finite field:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">k</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + x over Finite Field in a of size 5^2</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="mi">5</span><span class="o">*</span><span class="n">P</span>
<span class="go">(2*a + 3 : 2*a : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">*</span><span class="mi">5</span>
<span class="go">(2*a + 3 : 2*a : 1)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">+</span> <span class="n">P</span> <span class="o">+</span> <span class="n">P</span> <span class="o">+</span> <span class="n">P</span> <span class="o">+</span> <span class="n">P</span>
<span class="go">(2*a + 3 : 2*a : 1)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Zmod</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="kn">import</span> <span class="nn">sys</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">n</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Arithmetic over <span class="math">\(\ZZ/N\ZZ\)</span> with composite <span class="math">\(N\)</span> is supported.  When an
operation tries to invert a non-invertible element, a
ZeroDivisionError is raised and a factorization of the modulus appears
in the error message:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1715761513</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">N</span><span class="p">),[</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">13</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">LCM</span><span class="p">([</span><span class="mf">2.</span><span class="o">.</span><span class="mi">60</span><span class="p">])</span><span class="o">*</span><span class="n">P</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ZeroDivisionError</span>: <span class="n">Inverse of 1520944668 does not exist (characteristic = 1715761513 = 26927*63719)</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>William Stein (2005) &#8211; Initial version</li>
<li>Robert Bradshaw et al....</li>
<li>John Cremona (Feb 2008) &#8211; Point counting and group structure for
non-prime fields, Frobenius endomorphism and order, elliptic logs</li>
<li>John Cremona (Aug 2008) &#8211; Introduced <code class="docutils literal"><span class="pre">EllipticCurvePoint_number_field</span></code> class</li>
<li>Tobias Nagel, Michael Mardaus, John Cremona (Dec 2008) &#8211; <span class="math">\(p\)</span>-adic elliptic logarithm over <span class="math">\(\QQ\)</span></li>
<li>David Hansen (Jan 2009) &#8211; Added <code class="docutils literal"><span class="pre">weil_pairing</span></code> function to <code class="docutils literal"><span class="pre">EllipticCurvePoint_finite_field</span></code> class</li>
<li>Mariah Lenox (March 2011) &#8211; Added <code class="docutils literal"><span class="pre">tate_pairing</span></code> and <code class="docutils literal"><span class="pre">ate_pairing</span></code>
functions to <code class="docutils literal"><span class="pre">EllipticCurvePoint_finite_field</span></code> class</li>
</ul>
<dl class="class">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint">
<em class="property">class </em><code class="descclassname">sage.schemes.elliptic_curves.ell_point.</code><code class="descname">EllipticCurvePoint</code><span class="sig-paren">(</span><em>X</em>, <em>v</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../schemes/sage/schemes/projective/projective_point.html#sage.schemes.projective.projective_point.SchemeMorphism_point_projective_ring" title="(in Sage Reference Manual: Schemes v8.0)"><code class="xref py py-class docutils literal"><span class="pre">sage.schemes.projective.projective_point.SchemeMorphism_point_projective_ring</span></code></a></p>
<p>A point on an elliptic curve.</p>
</dd></dl>

<dl class="class">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field">
<em class="property">class </em><code class="descclassname">sage.schemes.elliptic_curves.ell_point.</code><code class="descname">EllipticCurvePoint_field</code><span class="sig-paren">(</span><em>curve</em>, <em>v</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../schemes/sage/schemes/projective/projective_point.html#sage.schemes.projective.projective_point.SchemeMorphism_point_abelian_variety_field" title="(in Sage Reference Manual: Schemes v8.0)"><code class="xref py py-class docutils literal"><span class="pre">sage.schemes.projective.projective_point.SchemeMorphism_point_abelian_variety_field</span></code></a></p>
<p>A point on an elliptic curve over a field.  The point has coordinates
in the base field.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">(0 : 0 : 1)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>               <span class="c1"># brackets are optional</span>
<span class="go">(0 : 0 : 1)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">([</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">0</span><span class="p">])</span>     <span class="c1"># entries are coerced</span>
<span class="go">(0 : 0 : 1)</span>

<span class="gp">sage: </span><span class="n">E</span><span class="p">(</span><span class="mf">0.000</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">(0 : 0 : 1)</span>

<span class="gp">sage: </span><span class="n">E</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Coordinates [1, 0, 0] do not define a point on</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 - x over Rational Field</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">QQ</span><span class="p">);</span> <span class="n">S</span>
<span class="go">Abelian group of points on Elliptic Curve defined by y^2 + y = x^3 - x over Rational Field</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">160</span><span class="p">,</span><span class="mi">308</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">E</span><span class="p">(</span><span class="mi">26</span><span class="p">,</span><span class="o">-</span><span class="mi">120</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">=</span><span class="n">E</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="mi">12</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="o">-</span><span class="mi">36</span><span class="o">+</span><span class="mi">48</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="o">==</span> <span class="n">Q</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="o">==</span> <span class="mi">4</span>  <span class="c1"># long time (3s)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="o">==</span><span class="mi">2</span><span class="o">*</span><span class="n">Q</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;=</span><span class="n">FractionField</span><span class="p">(</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">P</span>
<span class="go">((0 : t : 1), (0 : -t : 1), (0 : 1 : 0))</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.additive_order">
<code class="descname">additive_order</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.additive_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the order of this point on the elliptic curve.</p>
<p>If the point is zero, returns 1, otherwise raise a
NotImplementedError.</p>
<p>For curves over number fields and finite fields, see below.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.additive_order" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.additive_order"><code class="xref py py-meth docutils literal"><span class="pre">additive_order()</span></code></a> is a synonym for <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.order" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.order"><code class="xref py py-meth docutils literal"><span class="pre">order()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;=</span><span class="n">FractionField</span><span class="p">(</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">E</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">Computation of order of a point not implemented over general fields.</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">additive_order</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.ate_pairing">
<code class="descname">ate_pairing</code><span class="sig-paren">(</span><em>Q</em>, <em>n</em>, <em>k</em>, <em>t</em>, <em>q=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.ate_pairing" title="Permalink to this definition">¶</a></dt>
<dd><p>Return ate pairing of <span class="math">\(n\)</span>-torsion points <span class="math">\(P=self\)</span> and <span class="math">\(Q\)</span>.</p>
<p>Also known as the <span class="math">\(n\)</span>-th modified ate pairing. <span class="math">\(P\)</span> is <span class="math">\(GF(q)\)</span>-rational,
and <span class="math">\(Q\)</span> must be an element of <span class="math">\(Ker(\pi-p)\)</span>, where <span class="math">\(\pi\)</span> is the
<span class="math">\(q\)</span>-frobenius map (and hence <span class="math">\(Q\)</span> is <span class="math">\(GF(q^k)\)</span>-rational).</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">P=self</span></code> &#8211; a point of order <span class="math">\(n\)</span>, in <span class="math">\(ker(\pi-1)\)</span>, where
<span class="math">\(\pi\)</span> is the <span class="math">\(q\)</span>-Frobenius map (e.g., <span class="math">\(P\)</span> is <span class="math">\(q-rational\)</span>).</li>
<li><code class="docutils literal"><span class="pre">Q</span></code> &#8211; a point of order <span class="math">\(n\)</span> in <span class="math">\(ker(\pi-q)\)</span></li>
<li><code class="docutils literal"><span class="pre">n</span></code> &#8211; the order of <span class="math">\(P\)</span> and <span class="math">\(Q\)</span>.</li>
<li><code class="docutils literal"><span class="pre">k</span></code> &#8211; the embedding degree.</li>
<li><code class="docutils literal"><span class="pre">t</span></code> &#8211; the trace of Frobenius of the curve over <span class="math">\(GF(q)\)</span>.</li>
<li><code class="docutils literal"><span class="pre">q</span></code> &#8211; (default:None) the size of base field (the &#8220;big&#8221;
field is <span class="math">\(GF(q^k)\)</span>). <span class="math">\(q\)</span> needs to be set only if its value
cannot be deduced.</li>
</ul>
<p>OUTPUT:</p>
<p>FiniteFieldElement in <span class="math">\(GF(q^k)\)</span> &#8211; the ate pairing of <span class="math">\(P\)</span> and <span class="math">\(Q\)</span>.</p>
<p>EXAMPLES:</p>
<p>An example with embedding degree 6:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">7549</span><span class="p">;</span> <span class="n">A</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">157</span><span class="p">;</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">14</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">);</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">F</span><span class="p">[];</span> <span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="o">^</span><span class="n">k</span><span class="p">,</span> <span class="n">modulus</span><span class="o">=</span><span class="n">x</span><span class="o">^</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="mi">3050</span><span class="p">,</span> <span class="mi">5371</span><span class="p">);</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="mi">6908</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3231</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="go">6708*a^5 + 4230*a^4 + 4350*a^3 + 2064*a^2 + 4022*a + 6733</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="n">randrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span><span class="o">^</span><span class="n">s</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Another example with embedding degree 7 and positive trace:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">2213</span><span class="p">;</span> <span class="n">A</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="mi">49</span><span class="p">;</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">1093</span><span class="p">;</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">28</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">);</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">F</span><span class="p">[];</span> <span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="o">^</span><span class="n">k</span><span class="p">,</span> <span class="n">modulus</span><span class="o">=</span><span class="n">x</span><span class="o">^</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="mi">1583</span><span class="p">,</span> <span class="mi">1734</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Qx</span> <span class="o">=</span> <span class="mi">1729</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="mi">1767</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">245</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">980</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1592</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1883</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">722</span>
<span class="gp">sage: </span><span class="n">Qy</span> <span class="o">=</span> <span class="mi">1299</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="mi">1877</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1030</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">1513</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1457</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">309</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">1636</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="n">Qx</span><span class="p">,</span> <span class="n">Qy</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="go">1665*a^6 + 1538*a^5 + 1979*a^4 + 239*a^3 + 2134*a^2 + 2151*a + 654</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="n">randrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span><span class="o">^</span><span class="n">s</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Another example with embedding degree 7 and negative trace:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">2017</span><span class="p">;</span> <span class="n">A</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">29</span><span class="p">;</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span> <span class="n">t</span> <span class="o">=</span> <span class="o">-</span><span class="mi">70</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">);</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">F</span><span class="p">[];</span> <span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="o">^</span><span class="n">k</span><span class="p">,</span> <span class="n">modulus</span><span class="o">=</span><span class="n">x</span><span class="o">^</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="mi">369</span><span class="p">,</span> <span class="mi">716</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Qx</span> <span class="o">=</span> <span class="mi">1226</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="mi">1778</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">660</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">1791</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1750</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">867</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">770</span>
<span class="gp">sage: </span><span class="n">Qy</span> <span class="o">=</span> <span class="mi">1764</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="mi">198</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1206</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">406</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1200</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">273</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">1712</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="n">Qx</span><span class="p">,</span> <span class="n">Qy</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="go">1794*a^6 + 1161*a^5 + 576*a^4 + 488*a^3 + 1950*a^2 + 1905*a + 1315</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="n">randrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span><span class="o">^</span><span class="n">s</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Using the same data, we show that the ate pairing is a power of the
Tate pairing (see <a class="reference internal" href="#hsv" id="id1">[HSV]</a> end of section 3.1):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">p</span><span class="o">^</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">n</span><span class="p">);</span> <span class="n">T</span> <span class="o">=</span> <span class="n">t</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="n">T</span><span class="o">^</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="o">^</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">((</span><span class="n">T</span><span class="o">^</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">N</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="p">(</span><span class="n">L</span><span class="o">*</span><span class="n">s</span><span class="o">*</span><span class="n">c</span><span class="o">.</span><span class="n">inverse_mod</span><span class="p">(</span><span class="n">n</span><span class="p">))</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="o">==</span> <span class="n">Q</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">^</span><span class="n">M</span>
<span class="go">True</span>
</pre></div>
</div>
<p>An example where we have to pass the base field size (and we again have
agreement with the Tate pairing). Note that though <span class="math">\(Px\)</span> is not
<span class="math">\(F\)</span>-rational, (it is the homomorphic image of an <span class="math">\(F\)</span>-rational point) it
is nonetheless in <span class="math">\(ker(\pi-1)\)</span>, and so is a legitimate input:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="mi">5</span><span class="p">;</span> <span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">GF</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">41</span><span class="p">;</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span> <span class="n">t</span> <span class="o">=</span> <span class="o">-</span><span class="mi">8</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Fx</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;=</span><span class="n">GF</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="n">k</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Ex</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">Fx</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">=</span><span class="n">Hom</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">Fx</span><span class="p">)(</span><span class="n">F</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">Fx</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Px</span><span class="o">=</span><span class="n">Ex</span><span class="p">(</span><span class="n">phi</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">xy</span><span class="p">()[</span><span class="mi">0</span><span class="p">]),</span><span class="n">phi</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">xy</span><span class="p">()[</span><span class="mi">1</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">Qx</span> <span class="o">=</span> <span class="n">Ex</span><span class="p">(</span><span class="n">b</span><span class="o">^</span><span class="mi">19</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">18</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">16</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">12</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">10</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">9</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">8</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">^</span><span class="mi">18</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">13</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">10</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">8</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Qx</span> <span class="o">=</span> <span class="n">Ex</span><span class="p">(</span><span class="n">Qx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">^</span><span class="n">q</span><span class="p">,</span> <span class="n">Qx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="n">q</span><span class="p">)</span> <span class="o">-</span> <span class="n">Qx</span>  <span class="c1"># ensure Qx is in ker(pi - q)</span>
<span class="gp">sage: </span><span class="n">Px</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Qx</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Unexpected field degree: set keyword argument q equal to the size of the base field (big field is GF(q^4)).</span>
<span class="gp">sage: </span><span class="n">Px</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Qx</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
<span class="go">b^19 + b^18 + b^17 + b^16 + b^15 + b^14 + b^13 + b^12 + b^11 + b^9 + b^8 + b^5 + b^4 + b^2 + b + 1</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="n">randrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">Px</span><span class="p">)</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Qx</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="o">==</span> <span class="n">Px</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">Qx</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Px</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">Qx</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="o">==</span> <span class="n">Px</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Qx</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span><span class="o">^</span><span class="n">s</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">n</span><span class="p">);</span> <span class="n">T</span> <span class="o">=</span> <span class="n">t</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="n">T</span><span class="o">^</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="o">^</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">((</span><span class="n">T</span><span class="o">^</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">N</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="p">(</span><span class="n">L</span><span class="o">*</span><span class="n">s</span><span class="o">*</span><span class="n">c</span><span class="o">.</span><span class="n">inverse_mod</span><span class="p">(</span><span class="n">n</span><span class="p">))</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Px</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Qx</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="o">==</span> <span class="n">Qx</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">Px</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span><span class="o">^</span><span class="n">M</span>
<span class="go">True</span>
</pre></div>
</div>
<p>It is an error if <span class="math">\(Q\)</span> is not in the kernel of <span class="math">\(\pi - p\)</span>, where <span class="math">\(\pi\)</span> is
the Frobenius automorphism:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">29</span><span class="p">;</span> <span class="n">A</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">);</span> <span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">F</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">]);</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="o">^</span><span class="n">k</span><span class="p">,</span> <span class="n">modulus</span><span class="o">=</span><span class="n">x</span><span class="o">^</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">);</span> <span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Point (13 : 21 : 1) not in Ker(pi - q)</span>
</pre></div>
</div>
<p>It is also an error if <span class="math">\(P\)</span> is not in the kernel os <span class="math">\(\pi - 1\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">29</span><span class="p">;</span> <span class="n">A</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">);</span> <span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">F</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">]);</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="o">^</span><span class="n">k</span><span class="p">,</span> <span class="n">modulus</span><span class="o">=</span><span class="n">x</span><span class="o">^</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">);</span> <span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="o">*</span><span class="n">a</span><span class="p">);</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">ate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">This point (14 : 10*a : 1) is not in Ker(pi - 1)</span>
</pre></div>
</div>
<p>NOTES:</p>
<p>First defined in the paper of <a class="reference internal" href="#hsv" id="id2">[HSV]</a>, the ate pairing can be
computationally effective in those cases when the trace of the curve
over the base field is significantly smaller than the expected
value. This implementation is simply Miller&#8217;s algorithm followed by a
naive exponentiation, and makes no claims towards efficiency.</p>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="hsv" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[HSV]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id2">2</a>)</em> Hess, Smart, Vercauteren, &#8220;The Eta Pairing Revisited&#8221;,
IEEE Trans. Information Theory, 52(10): 4595-4602, 2006.</td></tr>
</tbody>
</table>
<p>AUTHORS:</p>
<ul class="simple">
<li>Mariah Lenox (2011-03-08)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.curve">
<code class="descname">curve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.curve" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the curve that this point is on.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">curve</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 + x^2 - 2*x over Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.division_points">
<code class="descname">division_points</code><span class="sig-paren">(</span><em>m</em>, <em>poly_only=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.division_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of all points <span class="math">\(Q\)</span> such that <span class="math">\(mQ=P\)</span> where <span class="math">\(P\)</span> = self.</p>
<p>Only points on the elliptic curve containing self and defined
over the base field are included.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">m</span></code> &#8211; a positive integer</li>
<li><code class="docutils literal"><span class="pre">poly_only</span></code> &#8211; bool (default: False); if True return
polynomial whose roots give all possible <span class="math">\(x\)</span>-coordinates of
<span class="math">\(m\)</span>-th roots of self.</li>
</ul>
<p>OUTPUT:</p>
<p>(list) &#8211; a (possibly empty) list of solutions <span class="math">\(Q\)</span> to <span class="math">\(mQ=P\)</span>,
where <span class="math">\(P\)</span> = self.</p>
<p>EXAMPLES:</p>
<p>We find the five 5-torsion points on an elliptic curve:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 - x^2 - 10*x - 20 over Rational Field</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">P</span>
<span class="go">(0 : 1 : 0)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">division_points</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[(0 : 1 : 0), (5 : -6 : 1), (5 : 5 : 1), (16 : -61 : 1), (16 : 60 : 1)]</span>
</pre></div>
</div>
<p>Note above that 0 is included since [5]*0 = 0.</p>
<p>We create a curve of rank 1 with no torsion and do a consistency check:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">quadratic_twist</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">44</span><span class="p">,</span><span class="o">-</span><span class="mi">270</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">Q</span><span class="p">)</span><span class="o">.</span><span class="n">division_points</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">[(44 : -270 : 1)]</span>
</pre></div>
</div>
<p>We create a curve over a non-prime finite field with group of
order <span class="math">\(18\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">+</span><span class="n">a</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">order</span><span class="p">())</span>
<span class="go">2 * 3^2</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">9</span>
</pre></div>
</div>
<p>We find the <span class="math">\(1\)</span>-division points as a consistency check &#8211; there
is just one, of course:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">division_points</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[(3 : 3*a + 4 : 1)]</span>
</pre></div>
</div>
<p>The point <span class="math">\(P\)</span> has order coprime to 2 but divisible by 3, so:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">division_points</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[(2*a + 1 : 3*a + 4 : 1), (3*a + 1 : a : 1)]</span>
</pre></div>
</div>
<p>We check that each of the 2-division points works as claimed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">Q</span> <span class="k">for</span> <span class="n">Q</span> <span class="ow">in</span> <span class="n">P</span><span class="o">.</span><span class="n">division_points</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
<span class="go">[(3 : 3*a + 4 : 1), (3 : 3*a + 4 : 1)]</span>
</pre></div>
</div>
<p>Some other checks:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">division_points</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">division_points</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">[(0 : 3*a + 2 : 1), (1 : 0 : 1)]</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">division_points</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[(1 : 1 : 1)]</span>
</pre></div>
</div>
<p>An example over a number field (see <a class="reference external" href="https://trac.sagemath.org/3383">trac ticket #3383</a>):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;19a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">9</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">8</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">7</span><span class="o">+</span><span class="mi">16</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">21</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">division_points</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[(0 : 1 : 0), (5 : -10 : 1), (5 : 9 : 1)]</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">division_points</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[(0 : 1 : 0), (5 : 9 : 1), (5 : -10 : 1)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">division_points</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="go">[(0 : 1 : 0), (5 : -10 : 1), (5 : 9 : 1)]</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">division_points</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="go">[(0 : 1 : 0), (5 : 9 : 1), (5 : -10 : 1), (-150/121*t^8 + 414/121*t^7 + 1481/242*t^6 - 2382/121*t^5 - 103/242*t^4 + 629/22*t^3 - 367/242*t^2 - 1307/121*t + 625/121 : 35/484*t^8 - 133/242*t^7 + 445/242*t^6 - 799/242*t^5 + 373/484*t^4 + 113/22*t^3 - 2355/484*t^2 - 753/242*t + 1165/484 : 1), (-150/121*t^8 + 414/121*t^7 + 1481/242*t^6 - 2382/121*t^5 - 103/242*t^4 + 629/22*t^3 - 367/242*t^2 - 1307/121*t + 625/121 : -35/484*t^8 + 133/242*t^7 - 445/242*t^6 + 799/242*t^5 - 373/484*t^4 - 113/22*t^3 + 2355/484*t^2 + 753/242*t - 1649/484 : 1), (-1383/484*t^8 + 970/121*t^7 + 3159/242*t^6 - 5211/121*t^5 + 37/484*t^4 + 654/11*t^3 - 909/484*t^2 - 4831/242*t + 6791/484 : 927/121*t^8 - 5209/242*t^7 - 8187/242*t^6 + 27975/242*t^5 - 1147/242*t^4 - 1729/11*t^3 + 1566/121*t^2 + 12873/242*t - 10871/242 : 1), (-1383/484*t^8 + 970/121*t^7 + 3159/242*t^6 - 5211/121*t^5 + 37/484*t^4 + 654/11*t^3 - 909/484*t^2 - 4831/242*t + 6791/484 : -927/121*t^8 + 5209/242*t^7 + 8187/242*t^6 - 27975/242*t^5 + 1147/242*t^4 + 1729/11*t^3 - 1566/121*t^2 - 12873/242*t + 10629/242 : 1), (-4793/484*t^8 + 6791/242*t^7 + 10727/242*t^6 - 18301/121*t^5 + 2347/484*t^4 + 2293/11*t^3 - 7311/484*t^2 - 17239/242*t + 26767/484 : 30847/484*t^8 - 21789/121*t^7 - 34605/121*t^6 + 117164/121*t^5 - 10633/484*t^4 - 29437/22*t^3 + 39725/484*t^2 + 55428/121*t - 176909/484 : 1), (-4793/484*t^8 + 6791/242*t^7 + 10727/242*t^6 - 18301/121*t^5 + 2347/484*t^4 + 2293/11*t^3 - 7311/484*t^2 - 17239/242*t + 26767/484 : -30847/484*t^8 + 21789/121*t^7 + 34605/121*t^6 - 117164/121*t^5 + 10633/484*t^4 + 29437/22*t^3 - 39725/484*t^2 - 55428/121*t + 176425/484 : 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.has_finite_order">
<code class="descname">has_finite_order</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.has_finite_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal"><span class="pre">True</span></code> if this point has finite additive order as an
element of the group of points on this curve.</p>
<p>For fields other than number fields and finite fields, this is
NotImplemented unless self.is_zero().</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;=</span><span class="n">FractionField</span><span class="p">(</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">has_finite_order</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">E</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">has_finite_order</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">Computation of order of a point not implemented over general fields.</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.has_infinite_order">
<code class="descname">has_infinite_order</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.has_infinite_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this point has infinite additive order as an element
of the group of points on this curve.</p>
<p>For fields other than number fields and finite fields, this is
NotImplemented unless self.is_zero().</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;=</span><span class="n">FractionField</span><span class="p">(</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">has_infinite_order</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">E</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">has_infinite_order</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">Computation of order of a point not implemented over general fields.</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.is_divisible_by">
<code class="descname">is_divisible_by</code><span class="sig-paren">(</span><em>m</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.is_divisible_by" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if there exists a point <span class="math">\(Q\)</span> defined over the same
field as self such that <span class="math">\(mQ\)</span> == self.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">m</span></code> &#8211; a positive integer.</li>
</ul>
<p>OUTPUT:</p>
<p>(bool) &#8211; True if there is a solution, else False.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This function usually triggers the computation of the
<span class="math">\(m\)</span>-th division polynomial of the associated elliptic
curve, which will be expensive if <span class="math">\(m\)</span> is large, though it
will be cached for subsequent calls with the same <span class="math">\(m\)</span>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span> <span class="n">Q</span>
<span class="go">(-2739/1444 : -77033/54872 : 1)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_divisible_by</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_divisible_by</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A finite field example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">101</span><span class="p">),[</span><span class="mi">23</span><span class="p">,</span><span class="mi">34</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">2 * 53</span>
<span class="gp">sage: </span><span class="n">Set</span><span class="p">([</span><span class="n">T</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">E</span><span class="o">.</span><span class="n">points</span><span class="p">()])</span>
<span class="go">{1, 106, 2, 53}</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">([</span><span class="n">T</span> <span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">E</span><span class="o">.</span><span class="n">points</span><span class="p">()</span> <span class="k">if</span> <span class="n">T</span><span class="o">.</span><span class="n">is_divisible_by</span><span class="p">(</span><span class="mi">2</span><span class="p">)])</span>
<span class="go">53</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">([</span><span class="n">T</span> <span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">E</span><span class="o">.</span><span class="n">points</span><span class="p">()</span> <span class="k">if</span> <span class="n">T</span><span class="o">.</span><span class="n">is_divisible_by</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
<span class="go">106</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.is_finite_order">
<code class="descname">is_finite_order</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.is_finite_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal"><span class="pre">True</span></code> if this point has finite additive order as an
element of the group of points on this curve.</p>
<p>For fields other than number fields and finite fields, this is
NotImplemented unless self.is_zero().</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;=</span><span class="n">FractionField</span><span class="p">(</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">has_finite_order</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">E</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">has_finite_order</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">Computation of order of a point not implemented over general fields.</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.order">
<code class="descname">order</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the order of this point on the elliptic curve.</p>
<p>If the point is zero, returns 1, otherwise raise a
NotImplementedError.</p>
<p>For curves over number fields and finite fields, see below.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.additive_order" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.additive_order"><code class="xref py py-meth docutils literal"><span class="pre">additive_order()</span></code></a> is a synonym for <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.order" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.order"><code class="xref py py-meth docutils literal"><span class="pre">order()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;=</span><span class="n">FractionField</span><span class="p">(</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">E</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">Computation of order of a point not implemented over general fields.</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">additive_order</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>**args</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot this point on an elliptic curve.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">**args</span></code> &#8211; all arguments get passed directly onto the point
plotting function.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pointsize</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.scheme">
<code class="descname">scheme</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.scheme" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the scheme of this point, i.e., the curve it is on.
This is synonymous with <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.curve" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.curve"><code class="xref py py-meth docutils literal"><span class="pre">curve()</span></code></a> which is perhaps more
intuitive.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">QQ</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">scheme</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + x + 1 over Rational Field</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">scheme</span><span class="p">()</span> <span class="o">==</span> <span class="n">P</span><span class="o">.</span><span class="n">curve</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)(</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">scheme</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + x + 1 over Number Field in a with defining polynomial x^2 - 3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.set_order">
<code class="descname">set_order</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.set_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the value of self._order to value.</p>
<p>Use this when you know a priori the order of this point to avoid a
potentially expensive order calculation.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">value</span></code> - positive Integer</li>
</ul>
<p>OUTPUT:</p>
<p><code class="docutils literal"><span class="pre">None</span></code></p>
<p>EXAMPLES:</p>
<p>This example illustrates basic usage.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="c1"># This curve has order 6</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">set_order</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="mi">2</span><span class="o">*</span><span class="n">G</span>
<span class="go">(0 : 1 : 0)</span>
</pre></div>
</div>
<p>We now give a more interesting case, the NIST-P521 curve. Its
order is too big to calculate with SAGE, and takes a long time
using other packages, so it is very useful here.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="mi">521</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">prev_proof_state</span> <span class="o">=</span> <span class="n">proof</span><span class="o">.</span><span class="n">arithmetic</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">proof</span><span class="o">.</span><span class="n">arithmetic</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span> <span class="c1"># turn off primality checking</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">p</span> <span class="o">-</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="mi">1093849038073734274511112390766805569936207598951683748994586394495953116150735016013708737573759623248592132296706313309438452531591012912142327488478985984</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="mi">6864797660130609714981900799081393217269435300143305409394463459185543183397655394245057746333217197532963996371363321113864768612440380340372808892707005449</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">F</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="n">B</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">random_point</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">set_order</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="o">*</span> <span class="n">G</span>  <span class="c1"># This takes practically no time.</span>
<span class="go">(0 : 1 : 0)</span>
<span class="gp">sage: </span><span class="n">proof</span><span class="o">.</span><span class="n">arithmetic</span><span class="p">(</span><span class="n">prev_proof_state</span><span class="p">)</span> <span class="c1"># restore state</span>
</pre></div>
</div>
<p>It is an error to pass a <span class="math">\(value\)</span> equal to <span class="math">\(0\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="c1"># This curve has order 6</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">random_point</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">set_order</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Value 0 illegal for point order</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">set_order</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Value 1000 illegal: outside max Hasse bound</span>
</pre></div>
</div>
<p>It is also very likely an error to pass a value which is not the actual
order of this point. How unlikely is determined by the factorization of
the actual order, and the actual group structure:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="c1"># This curve has order 6</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>   <span class="c1"># G has order 2</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">set_order</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Value 11 illegal: 11 * (5 : 0 : 1) is not the identity</span>
</pre></div>
</div>
<p>However, set_order can be fooled, though it&#8217;s not likely in &#8220;real cases
of interest&#8221;. For instance, the order can be set to a multiple the
actual order:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="c1"># This curve has order 6</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>   <span class="c1"># G has order 2</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">set_order</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">8</span>
</pre></div>
</div>
<p>NOTES:</p>
<p>The implementation is based of the fact that orders of elliptic curve
points are cached in the (pseudo-private) _order slot.</p>
<p>AUTHORS:</p>
<blockquote>
<div><ul class="simple">
<li>Mariah Lenox (2011-02-16)</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.tate_pairing">
<code class="descname">tate_pairing</code><span class="sig-paren">(</span><em>Q</em>, <em>n</em>, <em>k</em>, <em>q=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.tate_pairing" title="Permalink to this definition">¶</a></dt>
<dd><p>Return Tate pairing of <span class="math">\(n\)</span>-torsion point <span class="math">\(P = self\)</span> and point <span class="math">\(Q\)</span>.</p>
<p>The value returned is <span class="math">\(f_{n,P}(Q)^e\)</span> where <span class="math">\(f_{n,P}\)</span> is a function with
divisor <span class="math">\(n[P]-n[O].\)</span>. This is also known as the &#8220;modified Tate
pairing&#8221;. It is a well-defined bilinear map.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">P=self</span></code> &#8211; Elliptic curve point having order n</li>
<li><code class="docutils literal"><span class="pre">Q</span></code> &#8211; Elliptic curve point on same curve as P (can be any order)</li>
<li><code class="docutils literal"><span class="pre">n</span></code> &#8211; positive integer: order of P</li>
<li><code class="docutils literal"><span class="pre">k</span></code> &#8211; positive integer: embedding degree</li>
<li><code class="docutils literal"><span class="pre">q</span></code> &#8211; positive integer: size of base field (the &#8220;big&#8221;
field is <span class="math">\(GF(q^k)\)</span>. <span class="math">\(q\)</span> needs to be set only if its value
cannot be deduced.)</li>
</ul>
<p>OUTPUT:</p>
<p>An <span class="math">\(n\)</span>&#8216;th root of unity in the base field self.curve().base_field()</p>
<p>EXAMPLES:</p>
<p>A simple example, pairing a point with itself, and pairing a point with
another rational point:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">103</span><span class="p">;</span> <span class="n">A</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="mi">18</span><span class="p">;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">33</span><span class="p">,</span> <span class="mi">91</span><span class="p">);</span> <span class="n">n</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">();</span> <span class="n">n</span>
<span class="go">19</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">n</span><span class="p">)(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">();</span> <span class="n">k</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">87</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">35</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>We now let Q be a point on the same curve as above, but defined over
the pairing extension field, and we also demonstrate the bilinearity of
the pairing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="o">^</span><span class="n">k</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Qx</span> <span class="o">=</span> <span class="mi">69</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">96</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">22</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">86</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">35</span>
<span class="gp">sage: </span><span class="n">Qy</span> <span class="o">=</span> <span class="mi">34</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">24</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">16</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">41</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">40</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="n">Qx</span><span class="p">,</span> <span class="n">Qy</span><span class="p">);</span>
<span class="gp">sage: </span><span class="c1"># multiply by cofactor so Q has order n:</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="mi">551269674</span><span class="p">;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">h</span><span class="o">*</span><span class="n">Q</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="n">P</span><span class="p">);</span> <span class="n">P</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="go">24*a^5 + 34*a^4 + 3*a^3 + 69*a^2 + 86*a + 45</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="n">randrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">ans1</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ans2</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ans3</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">^</span><span class="n">s</span>
<span class="gp">sage: </span><span class="n">ans1</span> <span class="o">==</span> <span class="n">ans2</span> <span class="o">==</span> <span class="n">ans3</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">ans1</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">ans1</span><span class="o">^</span><span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Here is an example of using the Tate pairing to compute the Weil
pairing (using the same data as above):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">((</span><span class="n">p</span><span class="o">^</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">n</span><span class="p">);</span> <span class="n">e</span>
<span class="go">62844857712</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">weil_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span><span class="o">^</span><span class="n">e</span>
<span class="go">94*a^5 + 99*a^4 + 29*a^3 + 45*a^2 + 57*a + 34</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span><span class="o">.</span><span class="n">_miller_</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span><span class="o">^</span><span class="n">e</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">==</span> <span class="n">Q</span><span class="o">.</span><span class="n">_miller_</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span><span class="o">^</span><span class="n">e</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">Q</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="go">94*a^5 + 99*a^4 + 29*a^3 + 45*a^2 + 57*a + 34</span>
</pre></div>
</div>
<p>An example where we have to pass the base field size (and we again have
agreement with the Weil pairing):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Fx</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;=</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Ex</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">Fx</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">=</span><span class="n">Hom</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">Fx</span><span class="p">)(</span><span class="n">F</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">Fx</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Px</span><span class="o">=</span><span class="n">Ex</span><span class="p">(</span><span class="n">phi</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">xy</span><span class="p">()[</span><span class="mi">0</span><span class="p">]),</span><span class="n">phi</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">xy</span><span class="p">()[</span><span class="mi">1</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">Qx</span> <span class="o">=</span> <span class="n">Ex</span><span class="p">(</span><span class="n">b</span><span class="o">^</span><span class="mi">19</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">18</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">16</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">12</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">10</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">9</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">8</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">^</span><span class="mi">18</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">13</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">10</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">8</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Px</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">Qx</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">41</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Unexpected field degree: set keyword argument q equal to the size of the base field (big field is GF(q^4)).</span>
<span class="gp">sage: </span><span class="n">num</span> <span class="o">=</span> <span class="n">Px</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">Qx</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">41</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">32</span><span class="p">);</span> <span class="n">num</span>
<span class="go">b^19 + b^14 + b^13 + b^12 + b^6 + b^4 + b^3</span>
<span class="gp">sage: </span><span class="n">den</span> <span class="o">=</span> <span class="n">Qx</span><span class="o">.</span><span class="n">tate_pairing</span><span class="p">(</span><span class="n">Px</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">41</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">32</span><span class="p">);</span> <span class="n">den</span>
<span class="go">b^19 + b^17 + b^16 + b^15 + b^14 + b^10 + b^6 + b^2 + 1</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">((</span><span class="mi">32</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">41</span><span class="p">);</span> <span class="n">e</span>
<span class="go">25575</span>
<span class="gp">sage: </span><span class="n">Px</span><span class="o">.</span><span class="n">weil_pairing</span><span class="p">(</span><span class="n">Qx</span><span class="p">,</span> <span class="mi">41</span><span class="p">)</span><span class="o">^</span><span class="n">e</span> <span class="o">==</span> <span class="n">num</span><span class="o">/</span><span class="n">den</span>
<span class="go">True</span>
</pre></div>
</div>
<p>NOTES:</p>
<p>This function uses Miller&#8217;s algorithm, followed by a naive
exponentiation. It does not do anything fancy. In the case
that there is an issue with <span class="math">\(Q\)</span> being on one of the lines
generated in the <span class="math">\(r*P\)</span> calculation, <span class="math">\(Q\)</span> is offset by a random
point <span class="math">\(R\)</span> and P.tate_pairing(Q+R,n,k)/P.tate_pairing(R,n,k)
is returned.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>Mariah Lenox (2011-03-07)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.weil_pairing">
<code class="descname">weil_pairing</code><span class="sig-paren">(</span><em>Q</em>, <em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.weil_pairing" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Weil pairing of self and <span class="math">\(Q\)</span> using Miller&#8217;s algorithm.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">Q</span></code> &#8211; a point on self.curve().</li>
<li><code class="docutils literal"><span class="pre">n</span></code> &#8211; an integer <span class="math">\(n\)</span> such that <span class="math">\(nP = nQ = (0:1:0)\)</span> where
<span class="math">\(P\)</span> = self.</li>
</ul>
<p>OUTPUT:</p>
<p>An <span class="math">\(n\)</span>&#8216;th root of unity in the base field self.curve().base_field()</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Fx</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;=</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Ex</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">Fx</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">=</span><span class="n">Hom</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">Fx</span><span class="p">)(</span><span class="n">F</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">Fx</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Px</span><span class="o">=</span><span class="n">Ex</span><span class="p">(</span><span class="n">phi</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">xy</span><span class="p">()[</span><span class="mi">0</span><span class="p">]),</span><span class="n">phi</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">xy</span><span class="p">()[</span><span class="mi">1</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">O</span> <span class="o">=</span> <span class="n">Ex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Qx</span> <span class="o">=</span> <span class="n">Ex</span><span class="p">(</span><span class="n">b</span><span class="o">^</span><span class="mi">19</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">18</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">16</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">12</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">10</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">9</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">8</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">^</span><span class="mi">18</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">13</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">10</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">8</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Px</span><span class="o">.</span><span class="n">weil_pairing</span><span class="p">(</span><span class="n">Qx</span><span class="p">,</span><span class="mi">41</span><span class="p">)</span> <span class="o">==</span> <span class="n">b</span><span class="o">^</span><span class="mi">19</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">15</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">9</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">8</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Px</span><span class="o">.</span><span class="n">weil_pairing</span><span class="p">(</span><span class="mi">17</span><span class="o">*</span><span class="n">Px</span><span class="p">,</span><span class="mi">41</span><span class="p">)</span> <span class="o">==</span> <span class="n">Fx</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Px</span><span class="o">.</span><span class="n">weil_pairing</span><span class="p">(</span><span class="n">O</span><span class="p">,</span><span class="mi">41</span><span class="p">)</span> <span class="o">==</span> <span class="n">Fx</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>An error is raised if either point is not n-torsion:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Px</span><span class="o">.</span><span class="n">weil_pairing</span><span class="p">(</span><span class="n">O</span><span class="p">,</span><span class="mi">40</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">points must both be n-torsion</span>
</pre></div>
</div>
<p>A larger example (see <a class="reference external" href="https://trac.sagemath.org/4964">trac ticket #4964</a>):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="p">,</span><span class="n">Q</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">19</span><span class="o">^</span><span class="mi">4</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">),[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">(),</span> <span class="n">Q</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">(360, 360)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">weil_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="mi">360</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">()</span>
<span class="go">360</span>
</pre></div>
</div>
<p>An example over a number field:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="p">,</span><span class="n">Q</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">torsion_subgroup</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>  <span class="c1"># long time (10s)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">,</span><span class="n">Q</span> <span class="o">=</span> <span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">element</span><span class="p">(),</span> <span class="n">Q</span><span class="o">.</span><span class="n">element</span><span class="p">())</span>  <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">(),</span><span class="n">Q</span><span class="o">.</span><span class="n">order</span><span class="p">())</span>  <span class="c1"># long time</span>
<span class="go">(5, 5)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">weil_pairing</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">zeta5^2</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">weil_pairing</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">zeta5^3</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>Implemented using Proposition 8 in <a class="reference internal" href="#mil04" id="id3">[Mil04]</a>.  The value 1 is
returned for linearly dependent input points.  This condition
is caught via a DivisionByZeroError, since the use of a
discrete logarithm test for linear dependence, is much too slow
for large <span class="math">\(n\)</span>.</p>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="mil04" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[Mil04]</a></td><td>Victor S. Miller, &#8220;The Weil pairing, and its
efficient calculation&#8221;, J. Cryptol., 17(4):235-261, 2004</td></tr>
</tbody>
</table>
<p>AUTHOR:</p>
<ul class="simple">
<li>David Hansen (2009-01-25)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.xy">
<code class="descname">xy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field.xy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <span class="math">\(x\)</span> and <span class="math">\(y\)</span> coordinates of this point, as a 2-tuple.
If this is the point at infinity a ZeroDivisionError is raised.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">xy</span><span class="p">()</span>
<span class="go">(-1, 1)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">Q</span>
<span class="go">(0 : 1 : 0)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">xy</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ZeroDivisionError</span>: <span class="n">rational division by zero</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field">
<em class="property">class </em><code class="descclassname">sage.schemes.elliptic_curves.ell_point.</code><code class="descname">EllipticCurvePoint_finite_field</code><span class="sig-paren">(</span><em>curve</em>, <em>v</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field"><code class="xref py py-class docutils literal"><span class="pre">sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field</span></code></a></p>
<p>Class for elliptic curve points over finite fields.</p>
<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.additive_order">
<code class="descname">additive_order</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.additive_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the order of this point on the elliptic curve.</p>
<p>ALGORITHM:</p>
<p>Use generic functions from <a class="reference external" href="../../../../groups/sage/groups/generic.html#module-sage.groups.generic" title="(in Sage Reference Manual: Groups v8.0)"><code class="xref py py-mod docutils literal"><span class="pre">sage.groups.generic</span></code></a>.  If the
group order is known, use <code class="docutils literal"><span class="pre">order_from_multiple()</span></code>, otherwise
use <code class="docutils literal"><span class="pre">order_from_bounds()</span></code> with the Hasse bounds for the base
field.  In the latter case, we might find that we have a
generator for the group, in which case it is cached.</p>
<p>We do not cause the group order to be calculated when not
known, since this function is used in determining the group
order via computation of several random points and their
orders.  The exceptions to this are (1) when the base field is
a prime field and efficient SEA-based methods are available
for the cardinality, and (2) when finding the group order is
possible quickly, currently only implemented for curves with
<span class="math">\(j=0\)</span> or <span class="math">\(j=1728\)</span> (see <a class="reference external" href="https://trac.sagemath.org/15567">trac ticket #15567</a>).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.additive_order" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.additive_order"><code class="xref py py-meth docutils literal"><span class="pre">additive_order()</span></code></a> is a synonym for <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.order" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.order"><code class="xref py py-meth docutils literal"><span class="pre">order()</span></code></a></p>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li>John Cremona, 2008-02-10, adapted 2008-04-05 to use generic functions.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">k</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + 2*x + 4 over Finite Field in a of size 5^5</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">a</span> <span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">3227</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">additive_order</span><span class="p">()</span>
<span class="go">7</span>
</pre></div>
</div>
<p>In the next example, the cardinality of E will be computed
(using SEA) and cached:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span><span class="o">=</span><span class="n">next_prime</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">150</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">),[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">E</span><span class="p">(</span><span class="mi">831623307675610677632782670796608848711856078</span><span class="p">,</span> <span class="mi">42295786042873366706573292533588638217232964</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">1427247692705959881058262545272474300628281448</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span><span class="o">==</span><span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>In the next example, the cardinality of E will be computed and
cached since <span class="math">\(j(E)=0\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">33554501</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">u</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">j_invariant</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">random_point</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">random_point</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="c1"># random</span>
<span class="go">16777251</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">_order</span>  <span class="c1"># as cached</span>
<span class="go">1125904604468004</span>
</pre></div>
</div>
<p>Similarly when <span class="math">\(j(E)=1728\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">33554473</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">u</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">j_invariant</span><span class="p">()</span>
<span class="go">1728</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">random_point</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="c1"># random</span>
<span class="go">46912611635760</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">_order</span>  <span class="c1"># as cached</span>
<span class="go">1125902679258240</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.discrete_log">
<code class="descname">discrete_log</code><span class="sig-paren">(</span><em>Q</em>, <em>ord=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.discrete_log" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns discrete log of <span class="math">\(Q\)</span> with respect to <span class="math">\(P\)</span> =self.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">Q</span></code> (point) &#8211; another point on the same curve as self.</li>
<li><code class="docutils literal"><span class="pre">ord</span></code> (integer or <code class="docutils literal"><span class="pre">None</span></code> (default)) &#8211; the order of self.</li>
</ul>
<p>OUTPUT:</p>
<p>(integer) &#8211; The discrete log of <span class="math">\(Q\)</span> with respect to <span class="math">\(P\)</span>, which is an
integer <span class="math">\(m\)</span> with <span class="math">\(0\le m&lt;o(P)\)</span> such that <span class="math">\(mP=Q\)</span>, if one
exists. A ValueError is raised if there is no solution.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The order of self is computed if not supplied.</p>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li>John Cremona. Adapted to use generic functions 2008-04-05.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">762</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">abelian_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">element</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="mi">400</span><span class="o">*</span><span class="n">P</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">discrete_log</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="go">400</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.has_finite_order">
<code class="descname">has_finite_order</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.has_finite_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal"><span class="pre">True</span></code> if this point has finite additive order as an element
of the group of points on this curve.</p>
<p>Since the base field is finite, the answer will always be <code class="docutils literal"><span class="pre">True</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">points</span><span class="p">()[</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">has_finite_order</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.order">
<code class="descname">order</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the order of this point on the elliptic curve.</p>
<p>ALGORITHM:</p>
<p>Use generic functions from <a class="reference external" href="../../../../groups/sage/groups/generic.html#module-sage.groups.generic" title="(in Sage Reference Manual: Groups v8.0)"><code class="xref py py-mod docutils literal"><span class="pre">sage.groups.generic</span></code></a>.  If the
group order is known, use <code class="docutils literal"><span class="pre">order_from_multiple()</span></code>, otherwise
use <code class="docutils literal"><span class="pre">order_from_bounds()</span></code> with the Hasse bounds for the base
field.  In the latter case, we might find that we have a
generator for the group, in which case it is cached.</p>
<p>We do not cause the group order to be calculated when not
known, since this function is used in determining the group
order via computation of several random points and their
orders.  The exceptions to this are (1) when the base field is
a prime field and efficient SEA-based methods are available
for the cardinality, and (2) when finding the group order is
possible quickly, currently only implemented for curves with
<span class="math">\(j=0\)</span> or <span class="math">\(j=1728\)</span> (see <a class="reference external" href="https://trac.sagemath.org/15567">trac ticket #15567</a>).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.additive_order" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.additive_order"><code class="xref py py-meth docutils literal"><span class="pre">additive_order()</span></code></a> is a synonym for <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.order" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_finite_field.order"><code class="xref py py-meth docutils literal"><span class="pre">order()</span></code></a></p>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li>John Cremona, 2008-02-10, adapted 2008-04-05 to use generic functions.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">k</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + 2*x + 4 over Finite Field in a of size 5^5</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">a</span> <span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">3227</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">additive_order</span><span class="p">()</span>
<span class="go">7</span>
</pre></div>
</div>
<p>In the next example, the cardinality of E will be computed
(using SEA) and cached:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span><span class="o">=</span><span class="n">next_prime</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">150</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">),[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">E</span><span class="p">(</span><span class="mi">831623307675610677632782670796608848711856078</span><span class="p">,</span> <span class="mi">42295786042873366706573292533588638217232964</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">1427247692705959881058262545272474300628281448</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span><span class="o">==</span><span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>In the next example, the cardinality of E will be computed and
cached since <span class="math">\(j(E)=0\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">33554501</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">u</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">j_invariant</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">random_point</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">random_point</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="c1"># random</span>
<span class="go">16777251</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">_order</span>  <span class="c1"># as cached</span>
<span class="go">1125904604468004</span>
</pre></div>
</div>
<p>Similarly when <span class="math">\(j(E)=1728\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">33554473</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">u</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">j_invariant</span><span class="p">()</span>
<span class="go">1728</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">random_point</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="c1"># random</span>
<span class="go">46912611635760</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">_order</span>  <span class="c1"># as cached</span>
<span class="go">1125902679258240</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field">
<em class="property">class </em><code class="descclassname">sage.schemes.elliptic_curves.ell_point.</code><code class="descname">EllipticCurvePoint_number_field</code><span class="sig-paren">(</span><em>curve</em>, <em>v</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field"><code class="xref py py-class docutils literal"><span class="pre">sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_field</span></code></a></p>
<p>A point on an elliptic curve over a number field.</p>
<p>Most of the functionality is derived from the parent class
<code class="docutils literal"><span class="pre">EllipticCurvePoint_field</span></code>.  In addition we have support for
orders, heights, reduction modulo primes, and elliptic logarithms.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">(0 : 0 : 1)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>               <span class="c1"># brackets are optional</span>
<span class="go">(0 : 0 : 1)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">([</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">0</span><span class="p">])</span>     <span class="c1"># entries are coerced</span>
<span class="go">(0 : 0 : 1)</span>

<span class="gp">sage: </span><span class="n">E</span><span class="p">(</span><span class="mf">0.000</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">(0 : 0 : 1)</span>

<span class="gp">sage: </span><span class="n">E</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Coordinates [1, 0, 0] do not define a point on</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 - x over Rational Field</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">QQ</span><span class="p">);</span> <span class="n">S</span>
<span class="go">Abelian group of points on Elliptic Curve defined by y^2 + y = x^3 - x over Rational Field</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.additive_order">
<code class="descname">additive_order</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.additive_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the order of this point on the elliptic curve.</p>
<p>If the point has infinite order, returns +Infinity.  For
curves defined over <span class="math">\(\QQ\)</span>, we call PARI; over other
number fields we implement the function here.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.additive_order" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.additive_order"><code class="xref py py-meth docutils literal"><span class="pre">additive_order()</span></code></a> is a synonym for <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.order" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.order"><code class="xref py py-meth docutils literal"><span class="pre">order()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span> <span class="n">P</span>
<span class="go">(0 : 0 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">additive_order</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.archimedean_local_height">
<code class="descname">archimedean_local_height</code><span class="sig-paren">(</span><em>v=None</em>, <em>prec=None</em>, <em>weighted=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.archimedean_local_height" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the local height of self at the archimedean place <span class="math">\(v\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">self</span></code> &#8211; a point on an elliptic curve over a number field
<span class="math">\(K\)</span>.</li>
<li><code class="docutils literal"><span class="pre">v</span></code> &#8211; a real or complex embedding of K, or None (default).
If <span class="math">\(v\)</span> is a real or complex embedding, return the local
height of self at <span class="math">\(v\)</span>. If <span class="math">\(v\)</span> is None, return the total
archimedean contribution to the global height.</li>
<li><code class="docutils literal"><span class="pre">prec</span></code> &#8211; integer, or None (default). The precision of the
computation. If None, the precision is deduced from v.</li>
<li><code class="docutils literal"><span class="pre">weighted</span></code> &#8211; boolean. If False (default), the height is
normalised to be invariant under extension of <span class="math">\(K\)</span>. If True,
return this normalised height multiplied by the local degree
if <span class="math">\(v\)</span> is a single place, or by the degree of <span class="math">\(K\)</span> if <span class="math">\(v\)</span> is
None.</li>
</ul>
<p>OUTPUT:</p>
<p>A real number. The normalisation is twice that in Silverman&#8217;s
paper <a class="reference internal" href="#sil1988" id="id4">[Sil1988]</a>. Note that this local height depends on the
model of the curve.</p>
<p>ALGORITHM:</p>
<p>See <a class="reference internal" href="#sil1988" id="id5">[Sil1988]</a>, Section 4.</p>
<p>EXAMPLES:</p>
<p>Examples 1, 2, and 3 from <a class="reference internal" href="#sil1988" id="id6">[Sil1988]</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 + (-1)*x^2 over Number Field in a with defining polynomial x^2 + 2</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">a</span><span class="p">);</span> <span class="n">P</span>
<span class="go">(a + 2 : 2*a + 1 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">archimedean_local_height</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">places</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">170</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
<span class="go">0.45754773287523276736211210741423654346576029814695</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 + 4*y = x^3 + 6*i*x over Number Field in i with defining polynomial x^2 + 1</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">archimedean_local_height</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">places</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
<span class="go">0.510184995162373</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="o">-</span><span class="mi">9</span><span class="o">/</span><span class="mi">4</span><span class="p">);</span> <span class="n">Q</span>
<span class="go">(-9/4 : -27/8*i : 1)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">archimedean_local_height</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">places</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
<span class="go">0.654445619529600</span>
</pre></div>
</div>
<p>An example over the rational numbers:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">36</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">archimedean_local_height</span><span class="p">()</span>
<span class="go">1.98723816350773</span>
</pre></div>
</div>
<p>Local heights of torsion points can be non-zero (unlike the
global height):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">K</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">archimedean_local_height</span><span class="p">()</span>
<span class="go">0.346573590279973</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.archimedian_local_height">
<code class="descname">archimedian_local_height</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.archimedian_local_height" title="Permalink to this definition">¶</a></dt>
<dd><p>Deprecated: Use <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.archimedean_local_height" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.archimedean_local_height"><code class="xref py py-func docutils literal"><span class="pre">archimedean_local_height()</span></code></a> instead.
See <a class="reference external" href="https://trac.sagemath.org/13951">trac ticket #13951</a> for details.</p>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.elliptic_logarithm">
<code class="descname">elliptic_logarithm</code><span class="sig-paren">(</span><em>embedding=None</em>, <em>precision=100</em>, <em>algorithm='pari'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.elliptic_logarithm" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the elliptic logarithm of this elliptic curve point.</p>
<p>An embedding of the base field into <span class="math">\(\RR\)</span> or <span class="math">\(\CC\)</span> (with
arbitrary precision) may be given; otherwise the first real
embedding is used (with the specified precision) if any, else
the first complex embedding.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">embedding</span></code>: an embedding of the base field into <span class="math">\(\RR\)</span> or <span class="math">\(\CC\)</span></li>
<li><code class="docutils literal"><span class="pre">precision</span></code>: a positive integer (default 100) setting the
number of bits of precision for the computation</li>
<li><code class="docutils literal"><span class="pre">algorithm</span></code>: either &#8216;pari&#8217; (default for real embeddings)
to use PARI&#8217;s <code class="docutils literal"><span class="pre">ellpointtoz{}</span></code>, or &#8216;sage&#8217; for a native
implementation.  Ignored for complex embeddings.</li>
</ul>
<p>ALGORITHM:</p>
<p>See [Co2] Cohen H., A Course in Computational Algebraic Number
Theory GTM 138, Springer 1996 for the case of real embeddings,
and Cremona, J.E. and Thongjunthug , T. 2010 for the complex
case.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>Michael Mardaus (2008-07),</li>
<li>Tobias Nagel (2008-07) &#8211; original version from [Co2].</li>
<li>John Cremona (2008-07) &#8211; revision following eclib code.</li>
<li>John Cremona (2010-03) &#8211; implementation for complex embeddings.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">is_on_identity_component</span> <span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">elliptic_logarithm</span> <span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">96</span><span class="p">)</span>
<span class="go">0.4793482501902193161295330101 + 0.985868850775824102211203849...*I</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">=</span><span class="n">E</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_on_identity_component</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">elliptic_logarithm</span> <span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">96</span><span class="p">)</span>
<span class="go">1.931128271542559442488585220</span>
</pre></div>
</div>
<p>An example with negative discriminant, and a torsion point:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">0</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">16</span><span class="p">,</span><span class="o">-</span><span class="mi">61</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>
<span class="go">0.25384186085591068434</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">real_period</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span> <span class="o">/</span> <span class="n">P</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>
<span class="go">5.0000000000000000000</span>
</pre></div>
</div>
<p>A larger example.  The default algorithm uses PARI and makes
sure the result has the requested precision:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">85357462</span><span class="p">,</span> <span class="mi">303528987048</span><span class="p">])</span> <span class="c1">#18074g1</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">4458713781401</span><span class="o">/</span><span class="mi">835903744</span><span class="p">,</span> <span class="o">-</span><span class="mi">64466909836503771</span><span class="o">/</span><span class="mi">24167649046528</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">()</span>  <span class="c1"># 100 bits</span>
<span class="go">0.27656204014107061464076203097</span>
</pre></div>
</div>
<p>The native algorithm &#8216;sage&#8217; used to have trouble with
precision in this example, but no longer:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;sage&#39;</span><span class="p">)</span>  <span class="c1"># 100 bits</span>
<span class="go">0.27656204014107061464076203097</span>
</pre></div>
</div>
<p>This shows that the bug reported at <a class="reference external" href="https://trac.sagemath.org/4901">trac ticket #4901</a> has been fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s2">&quot;4390c2&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">683762969925</span><span class="o">/</span><span class="mi">44944</span><span class="p">,</span><span class="o">-</span><span class="mi">565388972095220019</span><span class="o">/</span><span class="mi">9528128</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">()</span>
<span class="go">0.00025638725886520225353198932529</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
<span class="go">0.000256387258865202254</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">65</span><span class="p">)</span>
<span class="go">0.0002563872588652022535</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
<span class="go">0.00025638725886520225353198932528666427412</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">129</span><span class="p">)</span>
<span class="go">0.00025638725886520225353198932528666427412</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>
<span class="go">0.0002563872588652022535319893252866642741168388008346370015005142128009610936373</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">257</span><span class="p">)</span>
<span class="go">0.00025638725886520225353198932528666427411683880083463700150051421280096109363730</span>
</pre></div>
</div>
<p>Examples over number fields:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">embs</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">CC</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Ls</span> <span class="o">=</span> <span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">embs</span><span class="p">]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">L</span><span class="o">.</span><span class="n">real_flag</span> <span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">Ls</span><span class="p">]</span>
<span class="go">[0, 0, -1]</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># order 2</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">Ls</span><span class="p">]</span>
<span class="go">[-1.73964256006716 - 1.07861534489191*I, -0.363756518406398 - 1.50699412135253*I, 1.90726488608927]</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Ls</span> <span class="o">=</span> <span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">embs</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">pts</span> <span class="o">=</span> <span class="p">[</span><span class="n">E</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">a</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">6</span> <span class="p">),</span> <span class="n">E</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span> <span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span> <span class="p">),</span> <span class="n">E</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="p">,</span> <span class="o">-</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">9</span><span class="o">/</span><span class="mi">4</span> <span class="p">),</span> <span class="n">E</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">4</span> <span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">10</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">12</span> <span class="p">)]</span>
<span class="gp">sage: </span><span class="p">[[</span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="k">for</span> <span class="n">P</span> <span class="ow">in</span> <span class="n">pts</span><span class="p">]</span> <span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">Ls</span><span class="p">]</span>
<span class="go">[[0.250819591818930 - 0.411963479992219*I, -0.290994550611374 - 1.37239400324105*I, -0.693473752205595 - 2.45028458830342*I, -0.151659609775291 - 1.48985406505459*I], [1.33444787667954 - 1.50889756650544*I, 0.792633734249234 - 0.548467043256610*I, 0.390154532655013 + 0.529423541805758*I, 0.931968675085317 - 0.431006981443071*I], [1.14758249500109 + 0.853389664016075*I, 2.59823462472518 + 0.853389664016075*I, 1.75372176444709, 0.303069634723001]]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">21</span><span class="o">-</span><span class="n">i</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">CC</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">0.70448375537782208460499649302 - 0.79246725643650979858266018068*I</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.has_finite_order">
<code class="descname">has_finite_order</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.has_finite_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal"><span class="pre">True</span></code> iff this point has finite order on the elliptic curve.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span> <span class="n">P</span>
<span class="go">(0 : 0 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">has_finite_order</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">has_finite_order</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.has_good_reduction">
<code class="descname">has_good_reduction</code><span class="sig-paren">(</span><em>P=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.has_good_reduction" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True iff this point has good reduction modulo a prime.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">P</span></code> &#8211; a prime of the base_field of the point&#8217;s curve, or
<code class="docutils literal"><span class="pre">None</span></code> (default)</li>
</ul>
<p>OUTPUT:</p>
<p>(bool) If a prime <span class="math">\(P\)</span> of the base field is specified, returns
True iff the point has good reduction at <span class="math">\(P\)</span>; otherwise,
return true if the point has god reduction at all primes in
the support of the discriminant of this model.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;990e1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">P</span>
<span class="go">(15 : 51 : 1)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">has_good_reduction</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]]</span>
<span class="go">[False, False, False, True]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">P</span><span class="o">.</span><span class="n">has_good_reduction</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]]</span>
<span class="go">[True, False, True, True]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">tamagawa_exponent</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]]</span>
<span class="go">[2, 2, 1, 1]</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">has_good_reduction</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]]</span>
<span class="go">[True, True, True, True]</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">has_good_reduction</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">has_good_reduction</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">has_good_reduction</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">160</span><span class="p">,</span><span class="mi">308</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">26</span><span class="p">,</span><span class="o">-</span><span class="mi">120</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">support</span><span class="p">()</span>
<span class="go">[Fractional ideal (i + 1),</span>
<span class="go">Fractional ideal (-i - 2),</span>
<span class="go">Fractional ideal (2*i + 1),</span>
<span class="go">Fractional ideal (3)]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">tamagawa_exponent</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">support</span><span class="p">()]</span>
<span class="go">[1, 4, 4, 4]</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">has_good_reduction</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">has_good_reduction</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">has_good_reduction</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.has_infinite_order">
<code class="descname">has_infinite_order</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.has_infinite_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True iff this point has infinite order on the elliptic curve.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span> <span class="n">P</span>
<span class="go">(0 : 0 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">has_infinite_order</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">has_infinite_order</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.height">
<code class="descname">height</code><span class="sig-paren">(</span><em>precision=None</em>, <em>normalised=True</em>, <em>algorithm='pari'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.height" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Néron-Tate canonical height of the point.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">self</span></code> &#8211; a point on an elliptic curve over a number field
<span class="math">\(K\)</span>.</li>
<li><code class="docutils literal"><span class="pre">precision</span></code> &#8211; positive integer, or None (default). The
precision in bits of the result. If None, the default real
precision is used.</li>
<li><code class="docutils literal"><span class="pre">normalised</span></code> &#8211; boolean. If True (default), the height is
normalised to be invariant under extension of <span class="math">\(K\)</span>. If False,
return this normalised height multiplied by the degree of
<span class="math">\(K\)</span>.</li>
<li><code class="docutils literal"><span class="pre">algorithm</span></code> &#8211; string: either &#8216;pari&#8217; (default) or &#8216;sage&#8217;.
If &#8216;pari&#8217; and the base field is <span class="math">\(\QQ\)</span>, use the PARI library
function; otherwise use the Sage implementation.</li>
</ul>
<p>OUTPUT:</p>
<p>The rational number 0, or a non-negative real number.</p>
<p>There are two normalisations used in the literature, one of
which is double the other. We use the larger of the two, which
is the one appropriate for the BSD conjecture. This is
consistent with <a class="reference internal" href="#cre" id="id7">[Cre]</a> and double that of <a class="reference internal" href="#silbook" id="id8">[SilBook]</a>.</p>
<p>See <a class="reference external" href="https://en.wikipedia.org/wiki/Néron-Tate height">Wikipedia article Néron-Tate height</a></p>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="cre" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[Cre]</a></td><td>John Cremona, Algorithms for Modular Elliptic Curves.
Cambridge University Press, 1997.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="sil1988" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Sil1988]</td><td><em>(<a class="fn-backref" href="#id4">1</a>, <a class="fn-backref" href="#id5">2</a>, <a class="fn-backref" href="#id6">3</a>, <a class="fn-backref" href="#id9">4</a>, <a class="fn-backref" href="#id10">5</a>, <a class="fn-backref" href="#id11">6</a>)</em> Joseph H. Silverman, Computing heights on
elliptic curves. Mathematics of Computation, Vol. 51,
No. 183 (Jul., 1988), pp. 339-358.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="silbook" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id8">[SilBook]</a></td><td>Joseph H. Silverman, The Arithmetic of Elliptic
Curves. Second edition. Graduate Texts in Mathematics, 106.
Springer, 2009.</td></tr>
</tbody>
</table>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 - x^2 - 10*x - 20 over Rational Field</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">]);</span> <span class="n">P</span>
<span class="go">(5 : 5 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">P</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 - x over Rational Field</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">0.0511114082399688</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator</span><span class="p">()</span>
<span class="go">0.0511114082399688...</span>

<span class="gp">sage: </span><span class="k">def</span> <span class="nf">naive_height</span><span class="p">(</span><span class="n">P</span><span class="p">):</span>
<span class="go">....:     return log(RR(max(abs(P[0].numerator()), abs(P[0].denominator()))))</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">10</span><span class="p">]:</span>
<span class="go">....:     print(naive_height(2^n*P)/4^n)</span>
<span class="go">0.000000000000000</span>
<span class="go">0.0433216987849966</span>
<span class="go">0.0502949347635656</span>
<span class="go">0.0511006335618645</span>
<span class="go">0.0511007834799612</span>
<span class="go">0.0511013666152466</span>
<span class="go">0.0511034199907743</span>
<span class="go">0.0511106492906471</span>
<span class="go">0.0511114081541082</span>
<span class="go">0.0511114081541180</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;4602a1&#39;</span><span class="p">);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 + x*y  = x^3 + x^2 - 37746035*x - 89296920339 over Rational Field</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="mi">77985922458974949246858229195945103471590</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="mi">19575260230015313702261379022151675961965157108920263594545223</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="mi">2254020761884782243</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">([</span> <span class="n">x</span> <span class="o">/</span> <span class="n">d</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span>  <span class="n">y</span> <span class="o">/</span> <span class="n">d</span><span class="o">^</span><span class="mi">3</span> <span class="p">])</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">86.7406561381275</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">17</span><span class="p">,</span> <span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="o">-</span><span class="mi">120</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 + 17*x*y - 120*y = x^3 - 60*x^2 over Rational Field</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">([</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">])</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">0</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a1&#39;</span><span class="p">);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 + x^2 - 2*x over Rational Field</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">E</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">0.68666708330558658572355210295</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">Q</span><span class="p">)</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="n">Q</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">9.0000000000000000000000000000</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Real Field with 100 bits of precision</span>
</pre></div>
</div>
<p>Canonical heights over number fields are implemented as well:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="mi">4</span><span class="p">]);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + a*x + 4 over Number Field in a with defining polynomial x^3 - 2</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">0.810463096585925</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">0.81046309658592536863991810577</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="go">0.81046309658592536863991810576865158896130286417155832378086</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">/</span> <span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">4.00000000000000</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">/</span> <span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">10000.0000000000</span>
</pre></div>
</div>
<p>Setting normalised=False multiplies the height by the degree of <span class="math">\(K\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">0.0511114082399688</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">normalised</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">0.0511114082399688</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">PK</span> <span class="o">=</span> <span class="n">EK</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">PK</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">0.0511114082399688</span>
<span class="gp">sage: </span><span class="n">PK</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">normalised</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">0.204445632959875</span>
</pre></div>
</div>
<p>Some consistency checks:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;5077a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">1.36857250535393</span>

<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">PK</span> <span class="o">=</span> <span class="n">EK</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">PK</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">1.36857250535393</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="o">-</span><span class="mi">9</span><span class="o">/</span><span class="mi">4</span><span class="p">);</span> <span class="n">Q</span>
<span class="go">(-9/4 : -27/8*i : 1)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">2.69518560017909</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">15</span><span class="o">*</span><span class="n">Q</span><span class="p">)</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">/</span> <span class="n">Q</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">225.000000000000</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">0.0511114082399688</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ED</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">quadratic_twist</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isomorphism_to</span><span class="p">(</span><span class="n">ED</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">))(</span><span class="n">P</span><span class="p">);</span> <span class="n">Q</span>
<span class="go">(0 : -7/2*a - 1/2 : 1)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">0.0511114082399688</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">0.051111408239968840235886099757</span>
</pre></div>
</div>
<p>An example to show that the bug at <a class="reference external" href="https://trac.sagemath.org/5252">trac ticket #5252</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2063758701246626370773726978</span><span class="p">,</span> <span class="mi">32838647793306133075103747085833809114881</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">30987785091199</span><span class="p">,</span> <span class="mi">258909576181697016447</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">25.8603170675462</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">25.860317067546190743868840741</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
<span class="go">25.860317067546190743868840740735110323098872903844416215577171041783572513</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="go">25.8603170675461907438688407407351103230988729038444162155771710417835725129551130570889813281792157278507639909972112856019190236125362914195452321720</span>

<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span><span class="o">.</span><span class="n">non_archimedean_local_height</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="o">+</span><span class="n">P</span><span class="o">.</span><span class="n">archimedean_local_height</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>An example to show that the bug at <a class="reference external" href="https://trac.sagemath.org/8319">trac ticket #8319</a> is fixed (correct height when the curve is not minimal):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="mi">5580472329446114952805505804593498080000</span><span class="p">,</span><span class="o">-</span><span class="mi">157339733785368110382973689903536054787700497223306368000000</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">xP</span> <span class="o">=</span> <span class="mi">204885147732879546487576840131729064308289385547094673627174585676211859152978311600</span><span class="o">/</span><span class="mi">23625501907057948132262217188983681204856907657753178415430361</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="n">xP</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">157.432598516754</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">P</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="c1"># long time (4s)</span>
<span class="go">629.730394067016</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">height</span><span class="p">()</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="c1"># long time</span>
<span class="go">0.000000000000000</span>
</pre></div>
</div>
<p>An example to show that the bug at <a class="reference external" href="https://trac.sagemath.org/12509">trac ticket #12509</a> is fixed (precision issues):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">28665</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">46382</span><span class="p">,</span> <span class="mi">2797026</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">4525688</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">72</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">509</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span>  <span class="o">-</span><span class="mi">682</span><span class="o">/</span><span class="mi">25</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">434</span><span class="o">/</span><span class="mi">25</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">1.38877711688727</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">height</span><span class="p">()</span><span class="o">/</span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">4.00000000000000</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">4.0000000000000000000000000000</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span><span class="o">/</span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="go">4.00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span>
</pre></div>
</div>
<p>This shows that the bug reported at <a class="reference external" href="https://trac.sagemath.org/13951">trac ticket #13951</a> has been fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">17</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P1</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">1.06248137652528</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">F</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">1.06248137652528</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.is_on_identity_component">
<code class="descname">is_on_identity_component</code><span class="sig-paren">(</span><em>embedding=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.is_on_identity_component" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True iff this point is on the identity component of
its curve with respect to a given (real or complex) embedding.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">self</span></code> &#8211; a point on a curve over any ordered field (e.g. <span class="math">\(\QQ\)</span>)</li>
<li><code class="docutils literal"><span class="pre">embedding</span></code> &#8211; an embedding from the base_field of the
point&#8217;s curve into <span class="math">\(\RR\)</span> or <span class="math">\(\CC\)</span>; if <code class="docutils literal"><span class="pre">None</span></code> (the
default) it uses the first embedding of the base_field into
<span class="math">\(\RR\)</span> if any, else the first embedding into <span class="math">\(\CC\)</span>.</li>
</ul>
<p>OUTPUT:</p>
<p>(bool) &#8211; <code class="docutils literal"><span class="pre">True</span></code> iff the point is on the identity component of
the curve.  (If the point is zero then the result is True.)</p>
<p>EXAMPLES:</p>
<p>For <span class="math">\(K=\QQ\)</span> there is no need to specify an embedding:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;5077a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">is_on_identity_component</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)]</span>
<span class="go">[False, False, False, False, False, True, True, True]</span>
</pre></div>
</div>
<p>An example over a field with two real embeddings:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">L</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">E</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">P</span><span class="o">.</span><span class="n">is_on_identity_component</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">L</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">RR</span><span class="p">)]</span>
<span class="go">[False, True]</span>
</pre></div>
</div>
<p>We can check this as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">e</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">())</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">L</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">RR</span><span class="p">)]</span>
<span class="go">[True, False]</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">RR</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E1</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">RR</span><span class="p">,[</span><span class="n">e</span><span class="p">(</span><span class="n">ai</span><span class="p">)</span> <span class="k">for</span> <span class="n">ai</span> <span class="ow">in</span> <span class="n">E</span><span class="o">.</span><span class="n">ainvs</span><span class="p">()])</span>
<span class="gp">sage: </span><span class="n">e1</span><span class="p">,</span><span class="n">e2</span><span class="p">,</span><span class="n">e3</span> <span class="o">=</span> <span class="n">E1</span><span class="o">.</span><span class="n">two_division_polynomial</span><span class="p">()</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">RR</span><span class="p">,</span><span class="n">multiplicities</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e1</span> <span class="o">&lt;</span> <span class="n">e2</span> <span class="o">&lt;</span> <span class="n">e3</span> <span class="ow">and</span> <span class="n">e</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">e3</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.non_archimedean_local_height">
<code class="descname">non_archimedean_local_height</code><span class="sig-paren">(</span><em>v=None</em>, <em>prec=None</em>, <em>weighted=False</em>, <em>is_minimal=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.non_archimedean_local_height" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the local height of self at the non-archimedean place <span class="math">\(v\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">self</span></code> &#8211; a point on an elliptic curve over a number field
<span class="math">\(K\)</span>.</li>
<li><code class="docutils literal"><span class="pre">v</span></code> &#8211; a non-archimedean place of <span class="math">\(K\)</span>, or None (default).
If <span class="math">\(v\)</span> is a non-archimedean place, return the local height
of self at <span class="math">\(v\)</span>. If <span class="math">\(v\)</span> is None, return the total
non-archimedean contribution to the global height.</li>
<li><code class="docutils literal"><span class="pre">prec</span></code> &#8211; integer, or None (default). The precision of the
computation. If None, the height is returned symbolically.</li>
<li><code class="docutils literal"><span class="pre">weighted</span></code> &#8211; boolean. If False (default), the height is
normalised to be invariant under extension of <span class="math">\(K\)</span>. If True,
return this normalised height multiplied by the local degree
if <span class="math">\(v\)</span> is a single place, or by the degree of <span class="math">\(K\)</span> if <span class="math">\(v\)</span> is
None.</li>
</ul>
<p>OUTPUT:</p>
<p>A real number. The normalisation is twice that in Silverman&#8217;s
paper <a class="reference internal" href="#sil1988" id="id9">[Sil1988]</a>. Note that this local height depends on the
model of the curve.</p>
<p>ALGORITHM:</p>
<p>See <a class="reference internal" href="#sil1988" id="id10">[Sil1988]</a>, Section 5.</p>
<p>EXAMPLES:</p>
<p>Examples 2 and 3 from <a class="reference internal" href="#sil1988" id="id11">[Sil1988]</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 + 4*y = x^3 + 6*i*x over Number Field in i with defining polynomial x^2 + 1</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">non_archimedean_local_height</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="go">-1/2*log(2)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">non_archimedean_local_height</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">non_archimedean_local_height</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">))</span>
<span class="go">0</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="o">-</span><span class="mi">9</span><span class="o">/</span><span class="mi">4</span><span class="p">);</span> <span class="n">Q</span>
<span class="go">(-9/4 : -27/8*i : 1)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">non_archimedean_local_height</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">))</span>
<span class="go">2*log(2)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">non_archimedean_local_height</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">non_archimedean_local_height</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">))</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">non_archimedean_local_height</span><span class="p">()</span>
<span class="go">1/2*log(16)</span>
</pre></div>
</div>
<p>An example over the rational numbers:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">36</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">non_archimedean_local_height</span><span class="p">()</span>
<span class="go">-log(3)</span>
</pre></div>
</div>
<p>Local heights of torsion points can be non-zero (unlike the
global height):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">K</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">non_archimedean_local_height</span><span class="p">()</span>
<span class="go">-1/2*log(2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.nonarchimedian_local_height">
<code class="descname">nonarchimedian_local_height</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.nonarchimedian_local_height" title="Permalink to this definition">¶</a></dt>
<dd><p>Deprecated: Use <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.non_archimedean_local_height" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.non_archimedean_local_height"><code class="xref py py-func docutils literal"><span class="pre">non_archimedean_local_height()</span></code></a> instead.
See <a class="reference external" href="https://trac.sagemath.org/13951">trac ticket #13951</a> for details.</p>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.order">
<code class="descname">order</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the order of this point on the elliptic curve.</p>
<p>If the point has infinite order, returns +Infinity.  For
curves defined over <span class="math">\(\QQ\)</span>, we call PARI; over other
number fields we implement the function here.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.additive_order" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.additive_order"><code class="xref py py-meth docutils literal"><span class="pre">additive_order()</span></code></a> is a synonym for <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.order" title="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.order"><code class="xref py py-meth docutils literal"><span class="pre">order()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span> <span class="n">P</span>
<span class="go">(0 : 0 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">additive_order</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.padic_elliptic_logarithm">
<code class="descname">padic_elliptic_logarithm</code><span class="sig-paren">(</span><em>p</em>, <em>absprec=20</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.padic_elliptic_logarithm" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the <span class="math">\(p\)</span>-adic elliptic logarithm of this point.</p>
<p>INPUT:</p>
<p><code class="docutils literal"><span class="pre">p</span></code> - integer: a prime <code class="docutils literal"><span class="pre">absprec</span></code> - integer (default: 20):
the initial <span class="math">\(p\)</span>-adic absolute precision of the computation</p>
<p>OUTPUT:</p>
<p>The <span class="math">\(p\)</span>-adic elliptic logarithm of self, with precision <code class="docutils literal"><span class="pre">absprec</span></code>.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>Tobias Nagel</li>
<li>Michael Mardaus</li>
<li>John Cremona</li>
</ul>
<p>ALGORITHM:</p>
<p>For points in the formal group (i.e. not integral at <span class="math">\(p\)</span>) we
take the <code class="docutils literal"><span class="pre">log()</span></code> function from the formal groups module and
evaluate it at <span class="math">\(-x/y\)</span>.  Otherwise we first multiply the point
to get into the formal group, and divide the result
afterwards.</p>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">See comments at <a class="reference external" href="https://trac.sagemath.org/4805">trac ticket #4805</a>.  Currently the absolute
precision of the result may be less than the given value
of absprec, and error-handling is imperfect.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">padic_elliptic_logarithm</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">padic_elliptic_logarithm</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">2 + 2*3 + 3^3 + 2*3^7 + 3^8 + 3^9 + 3^11 + 3^15 + 2*3^17 + 3^18 + O(3^19)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">padic_elliptic_logarithm</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span>
<span class="go">660257522</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="o">/</span><span class="mi">9</span><span class="p">,</span><span class="mi">28</span><span class="o">/</span><span class="mi">27</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">padic_elliptic_logarithm</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">/</span><span class="n">P</span><span class="o">.</span><span class="n">padic_elliptic_logarithm</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>  <span class="c1"># long time (3s)</span>
<span class="go">[2 + O(2^19), 2 + O(3^20), 2 + O(5^19), 2 + O(7^19), 2 + O(11^19), 2 + O(13^19), 2 + O(17^19), 2 + O(19^19)]</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="mi">3</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">padic_elliptic_logarithm</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">/</span><span class="n">P</span><span class="o">.</span><span class="n">padic_elliptic_logarithm</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">12</span><span class="p">)]</span>  <span class="c1"># long time (2s)</span>
<span class="go">[1 + 2 + O(2^19), 3 + 3^20 + O(3^21), 3 + O(5^19), 3 + O(7^19), 3 + O(11^19)]</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="mi">5</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">padic_elliptic_logarithm</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">/</span><span class="n">P</span><span class="o">.</span><span class="n">padic_elliptic_logarithm</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">12</span><span class="p">)]</span>  <span class="c1"># long time (2s)</span>
<span class="go">[1 + 2^2 + O(2^19), 2 + 3 + O(3^20), 5 + O(5^19), 5 + O(7^19), 5 + O(11^19)]</span>
</pre></div>
</div>
<p>An example which arose during reviewing <a class="reference external" href="https://trac.sagemath.org/4741">trac ticket #4741</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;794a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">padic_elliptic_logarithm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># default precision=20</span>
<span class="go">2^4 + 2^5 + 2^6 + 2^8 + 2^9 + 2^13 + 2^14 + 2^15 + O(2^16)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">padic_elliptic_logarithm</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">absprec</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="go">2^4 + 2^5 + 2^6 + 2^8 + 2^9 + 2^13 + 2^14 + 2^15 + 2^22 + 2^23 + 2^24 + O(2^26)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">padic_elliptic_logarithm</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">absprec</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="go">2^4 + 2^5 + 2^6 + 2^8 + 2^9 + 2^13 + 2^14 + 2^15 + 2^22 + 2^23 + 2^24 + 2^28 + 2^29 + 2^31 + 2^34 + O(2^35)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.reduction">
<code class="descname">reduction</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_point.EllipticCurvePoint_number_field.reduction" title="Permalink to this definition">¶</a></dt>
<dd><p>This finds the reduction of a point <span class="math">\(P\)</span> on the elliptic curve
modulo the prime <span class="math">\(p\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">self</span></code> &#8211; A point on an elliptic curve.</li>
<li><code class="docutils literal"><span class="pre">p</span></code> &#8211; a prime number</li>
</ul>
<p>OUTPUT:</p>
<p>The point reduced to be a point on the elliptic curve modulo <span class="math">\(p\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">reduction</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">(0 : 0 : 1)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">98</span><span class="p">,</span><span class="mi">931</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">reduction</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">(3 : 1 : 1)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">reduction</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">curve</span><span class="p">()</span> <span class="o">==</span> <span class="n">E</span><span class="o">.</span><span class="n">reduction</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">98</span><span class="p">,</span><span class="mi">931</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">reduction</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">(3 : 1 : 1)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">reduction</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">(10 : 7 : 1)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,[</span><span class="n">a</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">reduction</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">(abar : 1 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">reduction</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
<span class="go">(abar : 1 : 1)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="jacobian.html"
                                  title="previous chapter">Construct elliptic curves as Jacobians</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="ell_generic.html"
                                  title="next chapter">Elliptic curves over a general ring</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../_sources/sage/schemes/elliptic_curves/ell_point.rst.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ell_generic.html" title="Elliptic curves over a general ring"
             >next</a> |</li>
        <li class="right" >
          <a href="jacobian.html" title="Construct elliptic curves as Jacobians"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Plane curves</a> &#187;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2017, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.3.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>