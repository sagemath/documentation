<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="Stream Cryptosystems" href="../stream.html" /><link rel="prev" title="PRESENT" href="../block_cipher/present.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>Blum-Goldwasser Probabilistic Encryption - Cryptography</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=a078f75a" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/jupyter-sphinx.css?v=572af1d6" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-furo.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-codemirror-monokai.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Cryptography</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 10.3 Reference Manual</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../../index.html">Home - Cryptography</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../cryptosystem.html">Cryptosystems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cipher.html">Ciphers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../classical.html">Classical Cryptosystems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../classical_cipher.html">Classical Ciphers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../block_cipher/sdes.html">Simplified DES</a></li>
<li class="toctree-l1"><a class="reference internal" href="../block_cipher/miniaes.html">Mini-AES</a></li>
<li class="toctree-l1"><a class="reference internal" href="../block_cipher/des.html">DES</a></li>
<li class="toctree-l1"><a class="reference internal" href="../block_cipher/present.html">PRESENT</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Blum-Goldwasser Probabilistic Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stream.html">Stream Cryptosystems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stream_cipher.html">Stream Ciphers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lfsr.html">Linear feedback shift register (LFSR) sequence commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../util.html">Utility Functions for Cryptography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../boolean_function.html">Boolean functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sbox.html">S-Boxes and Their Algebraic Representations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sboxes.html">S-Boxes used in cryptographic schemes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mq/mpolynomialsystemgenerator.html">Abstract base class for generators of polynomial systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mq/sr.html">Small Scale Variants of the AES (SR) Polynomial System Generator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mq/rijndael_gf.html">Rijndael-GF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lattice.html">Hard Lattice Generator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lwe.html">(Ring-)LWE oracle generators</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="blum-goldwasser-probabilistic-encryption">
<span id="sage-crypto-public-key-blum-goldwasser"></span><h1>Blum-Goldwasser Probabilistic Encryption<a class="headerlink" href="#blum-goldwasser-probabilistic-encryption" title="Link to this heading">#</a></h1>
<p id="module-sage.crypto.public_key.blum_goldwasser">The Blum-Goldwasser probabilistic public-key encryption scheme. This scheme
was originally described in <a class="reference internal" href="../../../../references/index.html#bg1985" id="id1"><span>[BG1985]</span></a>. See also section 8.7.2
of <a class="reference internal" href="../../../../references/index.html#mvov1996" id="id2"><span>[MvOV1996]</span></a> and the <a class="reference external" href="https://en.wikipedia.org/wiki/Blum-Goldwasser_cryptosystem">Wikipedia article Blum-Goldwasser_cryptosystem</a>
on this scheme.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Mike Hogan and David Joyner (2009-9-19): initial procedural version
released as public domain software.</p></li>
<li><p>Minh Van Nguyen (2009-12): integrate into Sage as a class and relicense
under the GPLv2+. Complete rewrite of the original version to follow
the description contained in <a class="reference internal" href="../../../../references/index.html#mvov1996" id="id3"><span>[MvOV1996]</span></a>.</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="sage.crypto.public_key.blum_goldwasser.BlumGoldwasser">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.crypto.public_key.blum_goldwasser.</span></span><span class="sig-name descname"><span class="pre">BlumGoldwasser</span></span><a class="headerlink" href="#sage.crypto.public_key.blum_goldwasser.BlumGoldwasser" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../cryptosystem.html#sage.crypto.cryptosystem.PublicKeyCryptosystem" title="sage.crypto.cryptosystem.PublicKeyCryptosystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">PublicKeyCryptosystem</span></code></a></p>
<p>The Blum-Goldwasser probabilistic public-key encryption scheme.</p>
<p>The Blum-Goldwasser encryption and decryption algorithms as described in
<a class="reference internal" href="#sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.encrypt" title="sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.encrypt"><code class="xref py py-func docutils literal notranslate"><span class="pre">encrypt()</span></code></a> and
<a class="reference internal" href="#sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.decrypt" title="sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.decrypt"><code class="xref py py-func docutils literal notranslate"><span class="pre">decrypt()</span></code></a>, respectively, make use of the
least significant bit of a binary string. A related concept is the <span class="math notranslate nohighlight">\(k\)</span>
least significant bits of a binary string. For example, given a positive
integer <span class="math notranslate nohighlight">\(n\)</span>, let <span class="math notranslate nohighlight">\(b = b_0 b_1 \cdots b_{m-1}\)</span> be the binary representation
of <span class="math notranslate nohighlight">\(n\)</span> so that <span class="math notranslate nohighlight">\(b\)</span> is a binary string of length <span class="math notranslate nohighlight">\(m\)</span>. Then the least
significant bit of <span class="math notranslate nohighlight">\(n\)</span> is <span class="math notranslate nohighlight">\(b_{m-1}\)</span>. If <span class="math notranslate nohighlight">\(0 &lt; k \leq m\)</span>, then the <span class="math notranslate nohighlight">\(k\)</span> least
significant bits of <span class="math notranslate nohighlight">\(n\)</span> are <span class="math notranslate nohighlight">\(b_{m-1-k} b_{m-k} \cdots b_{m-1}\)</span>. The least
significant bit of an integer is also referred to as its parity bit,
because this bit determines whether the integer is even or odd. In the
following example, we obtain the least significant bit of an integer:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">123</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">binary</span><span class="p">();</span> <span class="n">b</span>
<span class="go">&#39;1111011&#39;</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">%</span> <span class="mi">2</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">b</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">&#39;1&#39;</span>
</pre></div>
</div>
<p>Now find the 4 least significant bits of the integer <span class="math notranslate nohighlight">\(n = 123\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">b</span>
<span class="go">&#39;1111011&#39;</span>
<span class="gp">sage: </span><span class="n">b</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span>
<span class="go">&#39;1011&#39;</span>
</pre></div>
</div>
<p>The last two examples could be worked through as follows:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.util</span> <span class="kn">import</span> <span class="n">least_significant_bits</span>
<span class="gp">sage: </span><span class="n">least_significant_bits</span><span class="p">(</span><span class="mi">123</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">[1]</span>
<span class="gp">sage: </span><span class="n">least_significant_bits</span><span class="p">(</span><span class="mi">123</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">[1, 0, 1, 1]</span>
</pre></div>
</div>
<p>EXAMPLES:</p>
<p>The following encryption/decryption example is taken from Example 8.57,
pages 309–310 of <a class="reference internal" href="../../../../references/index.html#mvov1996" id="id4"><span>[MvOV1996]</span></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.symbolic</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.public_key.blum_goldwasser</span> <span class="kn">import</span> <span class="n">BlumGoldwasser</span>
<span class="gp">sage: </span><span class="n">bg</span> <span class="o">=</span> <span class="n">BlumGoldwasser</span><span class="p">();</span> <span class="n">bg</span>
<span class="go">The Blum-Goldwasser public-key encryption scheme.</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">499</span><span class="p">;</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">547</span>
<span class="gp">sage: </span><span class="n">pubkey</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">public_key</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">);</span> <span class="n">pubkey</span>
<span class="go">272953</span>
<span class="gp">sage: </span><span class="n">prikey</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">private_key</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">);</span> <span class="n">prikey</span>
<span class="go">(499, 547, -57, 52)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="s2">&quot;10011100000100001100&quot;</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">pubkey</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">159201</span><span class="p">);</span> <span class="n">C</span>
<span class="go">([[0, 0, 1, 0], [0, 0, 0, 0], [1, 1, 0, 0], [1, 1, 1, 0], [0, 1, 0, 0]], 139680)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">prikey</span><span class="p">);</span> <span class="n">M</span>
<span class="go">[[1, 0, 0, 1], [1, 1, 0, 0], [0, 0, 0, 1], [0, 0, 0, 0], [1, 1, 0, 0]]</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">flatten</span><span class="p">(</span><span class="n">M</span><span class="p">));</span> <span class="n">M</span>
<span class="go">&#39;10011100000100001100&#39;</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Generate a pair of random public/private keys. Use the public key to
encrypt a plaintext. Then decrypt the resulting ciphertext using the
private key. Finally, compare the decrypted message with the original
plaintext.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.libs.pari sage.symbolic</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.public_key.blum_goldwasser</span> <span class="kn">import</span> <span class="n">BlumGoldwasser</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.util</span> <span class="kn">import</span> <span class="n">bin_to_ascii</span>
<span class="gp">sage: </span><span class="n">bg</span> <span class="o">=</span> <span class="n">BlumGoldwasser</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">pubkey</span><span class="p">,</span> <span class="n">prikey</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">random_key</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="s2">&quot;A fixed plaintext.&quot;</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">pubkey</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">prikey</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">bin_to_ascii</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="n">M</span><span class="p">))</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If <span class="math notranslate nohighlight">\((p, q, a, b)\)</span> is a private key, then <span class="math notranslate nohighlight">\(n = pq\)</span> is the corresponding
public key. Furthermore, we have <span class="math notranslate nohighlight">\(\gcd(p, q) = ap + bq = 1\)</span>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">prikey</span>                                                       <span class="c1"># needs sage.symbolic</span>
<span class="gp">sage: </span><span class="n">pubkey</span> <span class="o">==</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span>                                                           <span class="c1"># needs sage.symbolic</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">gcd</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="o">==</span> <span class="n">a</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">q</span> <span class="o">==</span> <span class="mi">1</span>                                               <span class="c1"># needs sage.symbolic</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.decrypt">
<span class="sig-name descname"><span class="pre">decrypt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.decrypt" title="Link to this definition">#</a></dt>
<dd><p>Apply the Blum-Goldwasser scheme to decrypt the ciphertext <code class="docutils literal notranslate"><span class="pre">C</span></code>
using the private key <code class="docutils literal notranslate"><span class="pre">K</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">C</span></code> – a ciphertext resulting from encrypting a plaintext using
the Blum-Goldwasser encryption algorithm. The ciphertext <span class="math notranslate nohighlight">\(C\)</span> must
be of the form <span class="math notranslate nohighlight">\(C = (c_1, c_2, \dots, c_t, x_{t+1})\)</span>. Each <span class="math notranslate nohighlight">\(c_i\)</span>
is a sub-block of binary string and <span class="math notranslate nohighlight">\(x_{t+1}\)</span> is the result of the
<span class="math notranslate nohighlight">\(t+1\)</span>-th iteration of the Blum-Blum-Shub algorithm.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">K</span></code> – a private key <span class="math notranslate nohighlight">\((p, q, a, b)\)</span> where <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span> are
distinct Blum primes and <span class="math notranslate nohighlight">\(\gcd(p, q) = ap + bq = 1\)</span>.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>The plaintext resulting from decrypting the ciphertext <code class="docutils literal notranslate"><span class="pre">C</span></code> using
the Blum-Goldwasser decryption algorithm.</p></li>
</ul>
<p>ALGORITHM:</p>
<p>The Blum-Goldwasser decryption algorithm is described in Algorithm
8.56, page 309 of <a class="reference internal" href="../../../../references/index.html#mvov1996" id="id5"><span>[MvOV1996]</span></a>. The algorithm works as follows:</p>
<ol class="arabic simple">
<li><p>Let <span class="math notranslate nohighlight">\(C\)</span> be the ciphertext <span class="math notranslate nohighlight">\(C = (c_1, c_2, \dots, c_t, x_{t+1})\)</span>.
Then <span class="math notranslate nohighlight">\(t\)</span> is the number of ciphertext sub-blocks and <span class="math notranslate nohighlight">\(h\)</span> is the
length of each binary string sub-block <span class="math notranslate nohighlight">\(c_i\)</span>.</p></li>
<li><p>Let <span class="math notranslate nohighlight">\((p, q, a, b)\)</span> be the private key whose corresponding
public key is <span class="math notranslate nohighlight">\(n = pq\)</span>. Note that <span class="math notranslate nohighlight">\(\gcd(p, q) = ap + bq = 1\)</span>.</p></li>
<li><p>Compute <span class="math notranslate nohighlight">\(d_1 = ((p + 1) / 4)^{t+1} \bmod{(p - 1)}\)</span>.</p></li>
<li><p>Compute <span class="math notranslate nohighlight">\(d_2 = ((q + 1) / 4)^{t+1} \bmod{(q - 1)}\)</span>.</p></li>
<li><p>Let <span class="math notranslate nohighlight">\(u = x_{t+1}^{d_1} \bmod p\)</span>.</p></li>
<li><p>Let <span class="math notranslate nohighlight">\(v = x_{t+1}^{d_2} \bmod q\)</span>.</p></li>
<li><p>Compute <span class="math notranslate nohighlight">\(x_0 = vap + ubq \bmod n\)</span>.</p></li>
<li><p>For <span class="math notranslate nohighlight">\(i\)</span> from 1 to <span class="math notranslate nohighlight">\(t\)</span>, do:</p>
<ol class="arabic simple">
<li><p>Compute <span class="math notranslate nohighlight">\(x_i = x_{t-1}^2 \bmod n\)</span>.</p></li>
<li><p>Let <span class="math notranslate nohighlight">\(p_i\)</span> be the <span class="math notranslate nohighlight">\(h\)</span> least significant bits of <span class="math notranslate nohighlight">\(x_i\)</span>.</p></li>
<li><p>Compute <span class="math notranslate nohighlight">\(m_i = p_i \oplus c_i\)</span>.</p></li>
</ol>
</li>
<li><p>The plaintext is <span class="math notranslate nohighlight">\(m = m_1 m_2 \cdots m_t\)</span>.</p></li>
</ol>
<p>EXAMPLES:</p>
<p>The following decryption example is taken from Example 8.57, pages
309–310 of <a class="reference internal" href="../../../../references/index.html#mvov1996" id="id6"><span>[MvOV1996]</span></a>. Here we decrypt a binary string:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.public_key.blum_goldwasser</span> <span class="kn">import</span> <span class="n">BlumGoldwasser</span>
<span class="gp">sage: </span><span class="n">bg</span> <span class="o">=</span> <span class="n">BlumGoldwasser</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">499</span><span class="p">;</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">547</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="mi">139680</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">private_key</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">);</span> <span class="n">K</span>
<span class="go">(499, 547, -57, 52)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">K</span><span class="p">);</span> <span class="n">P</span>
<span class="go">[[1, 0, 0, 1], [1, 1, 0, 0], [0, 0, 0, 1], [0, 0, 0, 0], [1, 1, 0, 0]]</span>
</pre></div>
</div>
<p>Convert the plaintext sub-blocks into a binary string:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">bin</span> <span class="o">=</span> <span class="n">BinaryStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">bin</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="n">P</span><span class="p">))</span>
<span class="go">10011100000100001100</span>
</pre></div>
</div>
<p>Decrypt a longer ciphertext and convert the resulting plaintext
into an ASCII string:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.libs.pari</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.public_key.blum_goldwasser</span> <span class="kn">import</span> <span class="n">BlumGoldwasser</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.util</span> <span class="kn">import</span> <span class="n">bin_to_ascii</span>
<span class="gp">sage: </span><span class="n">bg</span> <span class="o">=</span> <span class="n">BlumGoldwasser</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">78307</span><span class="p">;</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">412487</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">private_key</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">....: </span>      <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">....: </span>      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">....: </span>      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">....: </span>      <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">....: </span>      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">....: </span>      <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">....: </span>      <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">....: </span>      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">....: </span>      <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">....: </span>      <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">....: </span>      <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">....: </span>      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="mi">3479653279</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">bin_to_ascii</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="n">P</span><span class="p">))</span>
<span class="go">&#39;Blum-Goldwasser encryption&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.encrypt">
<span class="sig-name descname"><span class="pre">encrypt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.encrypt" title="Link to this definition">#</a></dt>
<dd><p>Apply the Blum-Goldwasser scheme to encrypt the plaintext <code class="docutils literal notranslate"><span class="pre">P</span></code> using
the public key <code class="docutils literal notranslate"><span class="pre">K</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">P</span></code> – a non-empty string of plaintext. The string <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code> is
an empty string, whereas <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">&quot;</span></code> is a string consisting of one
white space character. The plaintext can be a binary string or
a string of ASCII characters. Where <code class="docutils literal notranslate"><span class="pre">P</span></code> is an ASCII string, then
<code class="docutils literal notranslate"><span class="pre">P</span></code> is first encoded as a binary string prior to encryption.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">K</span></code> – a public key, which is the product of two Blum primes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">seed</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) if <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span> are Blum primes and
<span class="math notranslate nohighlight">\(n = pq\)</span> is a public key, then <code class="docutils literal notranslate"><span class="pre">seed</span></code> is a quadratic residue in
the multiplicative group <span class="math notranslate nohighlight">\((\ZZ/n\ZZ)^{\ast}\)</span>. If <code class="docutils literal notranslate"><span class="pre">seed=None</span></code>,
then the function would generate its own random quadratic residue
in <span class="math notranslate nohighlight">\((\ZZ/n\ZZ)^{\ast}\)</span>. Where a value for <code class="docutils literal notranslate"><span class="pre">seed</span></code> is provided,
it is your responsibility to ensure that the seed is a
quadratic residue in the multiplicative group <span class="math notranslate nohighlight">\((\ZZ/n\ZZ)^{\ast}\)</span>.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>The ciphertext resulting from encrypting <code class="docutils literal notranslate"><span class="pre">P</span></code> using the public
key <code class="docutils literal notranslate"><span class="pre">K</span></code>. The ciphertext <span class="math notranslate nohighlight">\(C\)</span> is of the form
<span class="math notranslate nohighlight">\(C = (c_1, c_2, \dots, c_t, x_{t+1})\)</span>. Each <span class="math notranslate nohighlight">\(c_i\)</span> is a
sub-block of binary string and <span class="math notranslate nohighlight">\(x_{t+1}\)</span> is the result of the
<span class="math notranslate nohighlight">\(t+1\)</span>-th iteration of the Blum-Blum-Shub algorithm.</p></li>
</ul>
<p>ALGORITHM:</p>
<p>The Blum-Goldwasser encryption algorithm is described in Algorithm
8.56, page 309 of <a class="reference internal" href="../../../../references/index.html#mvov1996" id="id7"><span>[MvOV1996]</span></a>. The algorithm works as follows:</p>
<ol class="arabic simple">
<li><p>Let <span class="math notranslate nohighlight">\(n\)</span> be a public key, where <span class="math notranslate nohighlight">\(n = pq\)</span> is the product of two
distinct Blum primes <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span>.</p></li>
<li><p>Let <span class="math notranslate nohighlight">\(k = \lfloor \log_2(n) \rfloor\)</span> and
<span class="math notranslate nohighlight">\(h = \lfloor \log_2(k) \rfloor\)</span>.</p></li>
<li><p>Let <span class="math notranslate nohighlight">\(m = m_1 m_2 \cdots m_t\)</span> be the message (plaintext) where
each <span class="math notranslate nohighlight">\(m_i\)</span> is a binary string of length <span class="math notranslate nohighlight">\(h\)</span>.</p></li>
<li><p>Choose a random seed <span class="math notranslate nohighlight">\(x_0\)</span>, which is a quadratic residue in
the multiplicative group <span class="math notranslate nohighlight">\((\ZZ/n\ZZ)^{\ast}\)</span>. That is, choose
a random <span class="math notranslate nohighlight">\(r \in (\ZZ/n\ZZ)^{\ast}\)</span> and compute
<span class="math notranslate nohighlight">\(x_0 = r^2 \bmod n\)</span>.</p></li>
<li><p>For <span class="math notranslate nohighlight">\(i\)</span> from 1 to <span class="math notranslate nohighlight">\(t\)</span>, do:</p>
<ol class="arabic simple">
<li><p>Let <span class="math notranslate nohighlight">\(x_i = x_{i-1}^2 \bmod n\)</span>.</p></li>
<li><p>Let <span class="math notranslate nohighlight">\(p_i\)</span> be the <span class="math notranslate nohighlight">\(h\)</span> least significant bits of <span class="math notranslate nohighlight">\(x_i\)</span>.</p></li>
<li><p>Let <span class="math notranslate nohighlight">\(c_i = p_i \oplus m_i\)</span>.</p></li>
</ol>
</li>
<li><p>Compute <span class="math notranslate nohighlight">\(x_{t+1} = x_t^2 \bmod n\)</span>.</p></li>
<li><p>The ciphertext is <span class="math notranslate nohighlight">\(c = (c_1, c_2, \dots, c_t, x_{t+1})\)</span>.</p></li>
</ol>
<p>The value <span class="math notranslate nohighlight">\(h\)</span> in the algorithm is the sub-block length. If the
binary string representing the message cannot be divided into blocks
of length <span class="math notranslate nohighlight">\(h\)</span> each, then other sub-block lengths would be used
instead. The sub-block lengths to fall back on are in the
following order: 16, 8, 4, 2, 1.</p>
<p>EXAMPLES:</p>
<p>The following encryption example is taken from Example 8.57,
pages 309–310 of <a class="reference internal" href="../../../../references/index.html#mvov1996" id="id8"><span>[MvOV1996]</span></a>. Here, we encrypt a binary
string:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.public_key.blum_goldwasser</span> <span class="kn">import</span> <span class="n">BlumGoldwasser</span>
<span class="gp">sage: </span><span class="n">bg</span> <span class="o">=</span> <span class="n">BlumGoldwasser</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">499</span><span class="p">;</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">547</span><span class="p">;</span> <span class="n">n</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="s2">&quot;10011100000100001100&quot;</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">159201</span><span class="p">);</span> <span class="n">C</span>                                  <span class="c1"># needs sage.symbolic</span>
<span class="go">([[0, 0, 1, 0], [0, 0, 0, 0], [1, 1, 0, 0], [1, 1, 1, 0], [0, 1, 0, 0]], 139680)</span>
</pre></div>
</div>
<p>Convert the ciphertext sub-blocks into a binary string:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">bin</span> <span class="o">=</span> <span class="n">BinaryStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">bin</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>                                                    <span class="c1"># needs sage.symbolic</span>
<span class="go">00100000110011100100</span>
</pre></div>
</div>
<p>Now encrypt an ASCII string. The result is random; no seed is
provided to the encryption function so the function generates its
own random seed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.public_key.blum_goldwasser</span> <span class="kn">import</span> <span class="n">BlumGoldwasser</span>
<span class="gp">sage: </span><span class="n">bg</span> <span class="o">=</span> <span class="n">BlumGoldwasser</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="mi">32300619509</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="s2">&quot;Blum-Goldwasser encryption&quot;</span>
<span class="gp">sage: </span><span class="n">bg</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>  <span class="c1"># random                                            # needs sage.symbolic</span>
<span class="go">([[1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0], \</span>
<span class="go">[1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1], \</span>
<span class="go">[0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], \</span>
<span class="go">[0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1], \</span>
<span class="go">[1, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 0], \</span>
<span class="go">[0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1], \</span>
<span class="go">[1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0], \</span>
<span class="go">[1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1], \</span>
<span class="go">[0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0], \</span>
<span class="go">[1, 0, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 1], \</span>
<span class="go">[1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1], \</span>
<span class="go">[1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0], \</span>
<span class="go">[0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1]], 3479653279)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.private_key">
<span class="sig-name descname"><span class="pre">private_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.private_key" title="Link to this definition">#</a></dt>
<dd><p>Return the Blum-Goldwasser private key corresponding to the
distinct Blum primes <code class="docutils literal notranslate"><span class="pre">p</span></code> and <code class="docutils literal notranslate"><span class="pre">q</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a Blum prime.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">q</span></code> – a Blum prime.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>The Blum-Goldwasser private key <span class="math notranslate nohighlight">\((p, q, a, b)\)</span> where
<span class="math notranslate nohighlight">\(\gcd(p, q) = ap + bq = 1\)</span>.</p></li>
</ul>
<p>Both <code class="docutils literal notranslate"><span class="pre">p</span></code> and <code class="docutils literal notranslate"><span class="pre">q</span></code> must be distinct Blum primes. Let <span class="math notranslate nohighlight">\(p\)</span> be a
positive prime. Then <span class="math notranslate nohighlight">\(p\)</span> is a Blum prime if <span class="math notranslate nohighlight">\(p\)</span> is congruent to 3
modulo 4, i.e. <span class="math notranslate nohighlight">\(p \equiv 3 \pmod{4}\)</span>.</p>
<p>EXAMPLES:</p>
<p>Obtain two distinct Blum primes and compute the Blum-Goldwasser
private key corresponding to those two Blum primes:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.public_key.blum_goldwasser</span> <span class="kn">import</span> <span class="n">BlumGoldwasser</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.util</span> <span class="kn">import</span> <span class="n">is_blum_prime</span>
<span class="gp">sage: </span><span class="n">bg</span> <span class="o">=</span> <span class="n">BlumGoldwasser</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">primes_first_n</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span> <span class="n">P</span>                                             <span class="c1"># needs sage.libs.pari</span>
<span class="go">[2, 3, 5, 7, 11, 13, 17, 19, 23, 29]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">is_blum_prime</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">P</span><span class="p">]</span>                                         <span class="c1"># needs sage.libs.pari</span>
<span class="go">[False, True, False, True, True, False, False, True, True, False]</span>
<span class="gp">sage: </span><span class="n">bg</span><span class="o">.</span><span class="n">private_key</span><span class="p">(</span><span class="mi">19</span><span class="p">,</span> <span class="mi">23</span><span class="p">)</span>
<span class="go">(19, 23, -6, 5)</span>
</pre></div>
</div>
<p>Choose two distinct random Blum primes, compute the Blum-Goldwasser
private key corresponding to those two primes, and test that the
resulting private key <span class="math notranslate nohighlight">\((p, q, a, b)\)</span> satisfies
<span class="math notranslate nohighlight">\(\gcd(p, q) = ap + bq = 1\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.libs.pari</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.util</span> <span class="kn">import</span> <span class="n">random_blum_prime</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">random_blum_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="n">random_blum_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">while</span> <span class="n">q</span> <span class="o">==</span> <span class="n">p</span><span class="p">:</span>
<span class="gp">....: </span>    <span class="n">q</span> <span class="o">=</span> <span class="n">random_blum_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">private_key</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">gcd</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="o">==</span> <span class="n">a</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">q</span> <span class="o">==</span> <span class="mi">1</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.public_key">
<span class="sig-name descname"><span class="pre">public_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.public_key" title="Link to this definition">#</a></dt>
<dd><p>Return the Blum-Goldwasser public key corresponding to the
distinct Blum primes <code class="docutils literal notranslate"><span class="pre">p</span></code> and <code class="docutils literal notranslate"><span class="pre">q</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a Blum prime.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">q</span></code> – a Blum prime.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>The Blum-Goldwasser public key <span class="math notranslate nohighlight">\(n = pq\)</span>.</p></li>
</ul>
<p>Both <code class="docutils literal notranslate"><span class="pre">p</span></code> and <code class="docutils literal notranslate"><span class="pre">q</span></code> must be distinct Blum primes. Let <span class="math notranslate nohighlight">\(p\)</span> be a
positive prime. Then <span class="math notranslate nohighlight">\(p\)</span> is a Blum prime if <span class="math notranslate nohighlight">\(p\)</span> is congruent to 3
modulo 4, i.e. <span class="math notranslate nohighlight">\(p \equiv 3 \pmod{4}\)</span>.</p>
<p>EXAMPLES:</p>
<p>Obtain two distinct Blum primes and compute the Blum-Goldwasser
public key corresponding to those two Blum primes:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.public_key.blum_goldwasser</span> <span class="kn">import</span> <span class="n">BlumGoldwasser</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.util</span> <span class="kn">import</span> <span class="n">is_blum_prime</span>
<span class="gp">sage: </span><span class="n">bg</span> <span class="o">=</span> <span class="n">BlumGoldwasser</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">primes_first_n</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span> <span class="n">P</span>                                             <span class="c1"># needs sage.libs.pari</span>
<span class="go">[2, 3, 5, 7, 11, 13, 17, 19, 23, 29]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">is_blum_prime</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">P</span><span class="p">]</span>                                         <span class="c1"># needs sage.libs.pari</span>
<span class="go">[False, True, False, True, True, False, False, True, True, False]</span>
<span class="gp">sage: </span><span class="n">bg</span><span class="o">.</span><span class="n">public_key</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="go">21</span>
</pre></div>
</div>
<p>Choose two distinct random Blum primes, compute the Blum-Goldwasser
public key corresponding to those two primes, and test that the
public key factorizes into Blum primes:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.libs.pari</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.util</span> <span class="kn">import</span> <span class="n">random_blum_prime</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">random_blum_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="n">random_blum_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">while</span> <span class="n">q</span> <span class="o">==</span> <span class="n">p</span><span class="p">:</span>
<span class="gp">....: </span>    <span class="n">q</span> <span class="o">=</span> <span class="n">random_blum_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="p">)</span>
<span class="go">...</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">public_key</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_blum_prime</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]);</span> <span class="n">is_blum_prime</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="go">True</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">*</span> <span class="n">q</span> <span class="o">==</span> <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.random_key">
<span class="sig-name descname"><span class="pre">random_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lbound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ubound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.random_key" title="Link to this definition">#</a></dt>
<dd><p>Return a pair of random public and private keys.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">lbound</span></code> – positive integer; the lower bound on how small each
random Blum prime <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span> can be. So we have
<code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;</span> <span class="pre">lower_bound</span> <span class="pre">&lt;=</span> <span class="pre">p,</span> <span class="pre">q</span> <span class="pre">&lt;=</span> <span class="pre">upper_bound</span></code>. The lower bound must
be distinct from the upper bound.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ubound</span></code> – positive integer; the upper bound on how large each
random Blum prime <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span> can be. So we have
<code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;</span> <span class="pre">lower_bound</span> <span class="pre">&lt;=</span> <span class="pre">p,</span> <span class="pre">q</span> <span class="pre">&lt;=</span> <span class="pre">upper_bound</span></code>. The lower bound must
be distinct from the upper bound.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ntries</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">100</span></code>) the number of attempts to generate
a random public/private key pair. If <code class="docutils literal notranslate"><span class="pre">ntries</span></code> is a positive
integer, then perform that many attempts at generating a random
public/private key pair.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>A random public key and its corresponding private key. Each
randomly chosen <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span> are guaranteed to be Blum primes. The
public key is <span class="math notranslate nohighlight">\(n = pq\)</span>, and the private key is <span class="math notranslate nohighlight">\((p, q, a, b)\)</span> where
<span class="math notranslate nohighlight">\(\gcd(p, q) = ap + bq = 1\)</span>.</p></li>
</ul>
<p>ALGORITHM:</p>
<p>The key generation algorithm is described in Algorithm 8.55,
page 308 of <a class="reference internal" href="../../../../references/index.html#mvov1996" id="id9"><span>[MvOV1996]</span></a>. The algorithm works as follows:</p>
<ol class="arabic simple">
<li><p>Let <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span> be distinct large random primes, each congruent
to 3 modulo 4. That is, <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span> are Blum primes.</p></li>
<li><p>Let <span class="math notranslate nohighlight">\(n = pq\)</span> be the product of <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span>.</p></li>
<li><p>Use the extended Euclidean algorithm to compute integers <span class="math notranslate nohighlight">\(a\)</span> and
<span class="math notranslate nohighlight">\(b\)</span> such that <span class="math notranslate nohighlight">\(\gcd(p, q) = ap + bq = 1\)</span>.</p></li>
<li><p>The public key is <span class="math notranslate nohighlight">\(n\)</span> and the corresponding private key is
<span class="math notranslate nohighlight">\((p, q, a, b)\)</span>.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Beware that there might not be any primes between the lower and
upper bounds. So make sure that these two bounds are
“sufficiently” far apart from each other for there to be primes
congruent to 3 modulo 4. In particular, there should
be at least two distinct primes within these bounds, each prime
being congruent to 3 modulo 4.</p>
</div>
<p>EXAMPLES:</p>
<p>Choosing a random pair of public and private keys. We then test to see
if they satisfy the requirements of the Blum-Goldwasser scheme:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.libs.pari</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.public_key.blum_goldwasser</span> <span class="kn">import</span> <span class="n">BlumGoldwasser</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.util</span> <span class="kn">import</span> <span class="n">is_blum_prime</span>
<span class="gp">sage: </span><span class="n">bg</span> <span class="o">=</span> <span class="n">BlumGoldwasser</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">pubkey</span><span class="p">,</span> <span class="n">prikey</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">random_key</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">prikey</span>
<span class="gp">sage: </span><span class="n">is_blum_prime</span><span class="p">(</span><span class="n">p</span><span class="p">);</span> <span class="n">is_blum_prime</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">True</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">==</span> <span class="n">q</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">pubkey</span> <span class="o">==</span> <span class="n">p</span><span class="o">*</span><span class="n">q</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">gcd</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="o">==</span> <span class="n">a</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">q</span> <span class="o">==</span> <span class="mi">1</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../stream.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Stream Cryptosystems</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../block_cipher/present.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">PRESENT</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2024, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Blum-Goldwasser Probabilistic Encryption</a><ul>
<li><a class="reference internal" href="#sage.crypto.public_key.blum_goldwasser.BlumGoldwasser"><code class="docutils literal notranslate"><span class="pre">BlumGoldwasser</span></code></a><ul>
<li><a class="reference internal" href="#sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.decrypt"><code class="docutils literal notranslate"><span class="pre">decrypt()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.encrypt"><code class="docutils literal notranslate"><span class="pre">encrypt()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.private_key"><code class="docutils literal notranslate"><span class="pre">private_key()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.public_key"><code class="docutils literal notranslate"><span class="pre">public_key()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.random_key"><code class="docutils literal notranslate"><span class="pre">random_key()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/scripts/furo.js"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script src="../../../../_static/tabs.js"></script>
    <script src="../../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "lcm": "\\mathop{\\operatorname{lcm}}", "dist": "\\mathrm{dist}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <script src="../../../../_static/jupyter-sphinx-furo.js"></script>
    </body>
</html>