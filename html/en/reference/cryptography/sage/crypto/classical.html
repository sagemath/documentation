<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=600, initial-scale=1">
    <title>Classical Cryptosystems &mdash; Sage Reference Manual v7.4: Cryptography</title>
    
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '7.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v7.4: Cryptography" href="../../index.html" />
    <link rel="next" title="Classical Ciphers" href="classical_cipher.html" />
    <link rel="prev" title="Ciphers" href="cipher.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="classical_cipher.html" title="Classical Ciphers"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="cipher.html" title="Ciphers"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Cryptography</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="classical-cryptosystems">
<span id="sage-crypto-classical"></span><h1>Classical Cryptosystems<a class="headerlink" href="#classical-cryptosystems" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.crypto.classical"></span><p>A convenient user interface to various classical ciphers. These include:</p>
<ul class="simple">
<li>affine cipher; see <a class="reference internal" href="#sage.crypto.classical.AffineCryptosystem" title="sage.crypto.classical.AffineCryptosystem"><code class="xref py py-class docutils literal"><span class="pre">AffineCryptosystem</span></code></a></li>
<li>Hill or matrix cipher; see <a class="reference internal" href="#sage.crypto.classical.HillCryptosystem" title="sage.crypto.classical.HillCryptosystem"><code class="xref py py-class docutils literal"><span class="pre">HillCryptosystem</span></code></a></li>
<li>shift cipher; see <a class="reference internal" href="#sage.crypto.classical.ShiftCryptosystem" title="sage.crypto.classical.ShiftCryptosystem"><code class="xref py py-class docutils literal"><span class="pre">ShiftCryptosystem</span></code></a></li>
<li>substitution cipher; see <a class="reference internal" href="#sage.crypto.classical.SubstitutionCryptosystem" title="sage.crypto.classical.SubstitutionCryptosystem"><code class="xref py py-class docutils literal"><span class="pre">SubstitutionCryptosystem</span></code></a></li>
<li>transposition cipher; see <a class="reference internal" href="#sage.crypto.classical.TranspositionCryptosystem" title="sage.crypto.classical.TranspositionCryptosystem"><code class="xref py py-class docutils literal"><span class="pre">TranspositionCryptosystem</span></code></a></li>
<li>Vigenere cipher; see <a class="reference internal" href="#sage.crypto.classical.VigenereCryptosystem" title="sage.crypto.classical.VigenereCryptosystem"><code class="xref py py-class docutils literal"><span class="pre">VigenereCryptosystem</span></code></a></li>
</ul>
<p>These classical cryptosystems support alphabets such as:</p>
<ul class="simple">
<li>the capital letters of the English alphabet; see
<a class="reference external" href="../../../monoids/sage/monoids/string_monoid.html#sage.monoids.string_monoid.AlphabeticStrings" title="(in Sage Reference Manual: Monoids v7.4)"><code class="xref py py-func docutils literal"><span class="pre">AlphabeticStrings()</span></code></a></li>
<li>the hexadecimal number system; see
<a class="reference external" href="../../../monoids/sage/monoids/string_monoid.html#sage.monoids.string_monoid.HexadecimalStrings" title="(in Sage Reference Manual: Monoids v7.4)"><code class="xref py py-func docutils literal"><span class="pre">HexadecimalStrings()</span></code></a></li>
<li>the binary number system; see
<a class="reference external" href="../../../monoids/sage/monoids/string_monoid.html#sage.monoids.string_monoid.BinaryStrings" title="(in Sage Reference Manual: Monoids v7.4)"><code class="xref py py-func docutils literal"><span class="pre">BinaryStrings()</span></code></a></li>
<li>the octal number system; see
<a class="reference external" href="../../../monoids/sage/monoids/string_monoid.html#sage.monoids.string_monoid.OctalStrings" title="(in Sage Reference Manual: Monoids v7.4)"><code class="xref py py-func docutils literal"><span class="pre">OctalStrings()</span></code></a></li>
<li>the radix-64 number system; see
<a class="reference external" href="../../../monoids/sage/monoids/string_monoid.html#sage.monoids.string_monoid.Radix64Strings" title="(in Sage Reference Manual: Monoids v7.4)"><code class="xref py py-func docutils literal"><span class="pre">Radix64Strings()</span></code></a></li>
</ul>
<p>AUTHORS:</p>
<ul class="simple">
<li>David Kohel (2007): initial version with the Hill, substitution,
transposition, and Vigenere cryptosystems.</li>
<li>Minh Van Nguyen (2009-08): shift cipher, affine cipher</li>
</ul>
<dl class="class">
<dt id="sage.crypto.classical.AffineCryptosystem">
<em class="property">class </em><code class="descclassname">sage.crypto.classical.</code><code class="descname">AffineCryptosystem</code><span class="sig-paren">(</span><em>A</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.AffineCryptosystem" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="cryptosystem.html#sage.crypto.cryptosystem.SymmetricKeyCryptosystem" title="sage.crypto.cryptosystem.SymmetricKeyCryptosystem"><code class="xref py py-class docutils literal"><span class="pre">sage.crypto.cryptosystem.SymmetricKeyCryptosystem</span></code></a></p>
<p>Create an affine cryptosystem.</p>
<p>Let <span class="math">\(A = \{ a_0, a_1, a_2, \dots, a_{n-1} \}\)</span> be a non-empty alphabet
consisting of <span class="math">\(n\)</span> unique elements. Define a mapping
<span class="math">\(f : A \longrightarrow \ZZ / n\ZZ\)</span> from the alphabet <span class="math">\(A\)</span> to
the set <span class="math">\(\ZZ / n\ZZ\)</span> of integers modulo <span class="math">\(n\)</span>, given by
<span class="math">\(f(a_i) = i\)</span>. Thus we can identify each element of the alphabet <span class="math">\(A\)</span>
with a unique integer <span class="math">\(0 \leq i &lt; n\)</span>. A key of the affine cipher is an
ordered pair of integers <span class="math">\((a, b) \in \ZZ / n\ZZ \times \ZZ / n\ZZ\)</span> such
that <span class="math">\(\gcd(a, n) = 1\)</span>. Therefore the key space is
<span class="math">\(\ZZ / n\ZZ \times \ZZ / n\ZZ\)</span>. Since we assume that <span class="math">\(A\)</span> does not have
repeated elements, the mapping <span class="math">\(f : A \longrightarrow \ZZ/ n\ZZ\)</span> is
bijective. Encryption and decryption functions are both affine functions.
Let <span class="math">\((a,b)\)</span> be a secret key, i.e. an element of the key space, and let
<span class="math">\(p\)</span> be a plaintext character and consequently <span class="math">\(p \in \ZZ / n\ZZ\)</span>. Then
the ciphertext character <span class="math">\(c\)</span> corresponding to <span class="math">\(p\)</span> is given by</p>
<div class="math">
\[c \equiv ap + b \pmod{n}\]</div>
<p>Similarly, given a ciphertext character <span class="math">\(c \in \ZZ / n\ZZ\)</span> and a secret
key <span class="math">\((a,b)\)</span>, we can recover the corresponding plaintext character as
follows:</p>
<div class="math">
\[p \equiv a^{-1} (c - b) \pmod{n}\]</div>
<p>where <span class="math">\(a^{-1}\)</span> is the inverse of <span class="math">\(a\)</span> modulo <span class="math">\(n\)</span>. Use the bijection
<span class="math">\(f : A \longrightarrow \ZZ / n\ZZ\)</span> to convert <span class="math">\(c\)</span> and <span class="math">\(p\)</span> back to
elements of the alphabet <span class="math">\(A\)</span>. Currently, only the following alphabet is
supported for the affine cipher:</p>
<ul class="simple">
<li>capital letters of the English alphabet as implemented in
<a class="reference external" href="../../../monoids/sage/monoids/string_monoid.html#sage.monoids.string_monoid.AlphabeticStrings" title="(in Sage Reference Manual: Monoids v7.4)"><code class="xref py py-func docutils literal"><span class="pre">AlphabeticStrings()</span></code></a></li>
</ul>
<p>EXAMPLES:</p>
<p>Encryption and decryption over the capital letters of the English
alphabet:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AffineCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">());</span> <span class="n">A</span>
<span class="go">Affine cryptosystem on Free alphabetic string monoid on A-Z</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;The affine cryptosystem generalizes the shift cipher.&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span>
<span class="go">THEAFFINECRYPTOSYSTEMGENERALIZESTHESHIFTCIPHER</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">P</span><span class="p">);</span> <span class="n">C</span>
<span class="go">CYXNGGHAXFKVSCJTVTCXRPXAXKNIHEXTCYXTYHGCFHSYXK</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">deciphering</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
<span class="go">THEAFFINECRYPTOSYSTEMGENERALIZESTHESHIFTCIPHER</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">deciphering</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We can also use functional notation to work through the previous
example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AffineCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">());</span> <span class="n">A</span>
<span class="go">Affine cryptosystem on Free alphabetic string monoid on A-Z</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;The affine cryptosystem generalizes the shift cipher.&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span>
<span class="go">THEAFFINECRYPTOSYSTEMGENERALIZESTHESHIFTCIPHER</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span> <span class="n">E</span>
<span class="go">Affine cipher on Free alphabetic string monoid on A-Z</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">P</span><span class="p">);</span> <span class="n">C</span>
<span class="go">CYXNGGHAXFKVSCJTVTCXRPXAXKNIHEXTCYXTYHGCFHSYXK</span>
<span class="gp">sage: </span><span class="n">aInv</span><span class="p">,</span> <span class="n">bInv</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">inverse_key</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="n">aInv</span><span class="p">,</span> <span class="n">bInv</span><span class="p">);</span> <span class="n">D</span>
<span class="go">Affine cipher on Free alphabetic string monoid on A-Z</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="go">THEAFFINECRYPTOSYSTEMGENERALIZESTHESHIFTCIPHER</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span> <span class="o">==</span> <span class="n">D</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="n">P</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Encrypting the ciphertext with the inverse key also produces the
plaintext:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AffineCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Encrypt with inverse key.&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">;</span> <span class="n">C</span>
<span class="go">ENCRYPTWITHINVERSEKEY</span>
<span class="go">AVENMRJQSJHSVFANYAOAM</span>
<span class="gp">sage: </span><span class="n">aInv</span><span class="p">,</span> <span class="n">bInv</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">inverse_key</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">aInv</span><span class="p">,</span> <span class="n">bInv</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
<span class="go">ENCRYPTWITHINVERSEKEY</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">aInv</span><span class="p">,</span> <span class="n">bInv</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>For a secret key <span class="math">\((a,b) \in \ZZ/n\ZZ \times \ZZ/n\ZZ\)</span>, if <span class="math">\(a = 1\)</span> then
any affine cryptosystem with key <span class="math">\((1, b)\)</span> for any <span class="math">\(b \in \ZZ/n\ZZ\)</span> is
a shift cryptosystem. Here is how we can create a Caesar cipher using
an affine cipher:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">caesar</span> <span class="o">=</span> <span class="n">AffineCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">caesar</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;abcdef&quot;</span><span class="p">);</span> <span class="n">P</span>
<span class="go">ABCDEF</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">caesar</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">P</span><span class="p">);</span> <span class="n">C</span>
<span class="go">DEFGHI</span>
<span class="gp">sage: </span><span class="n">caesar</span><span class="o">.</span><span class="n">deciphering</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Any affine cipher with keys of the form
<span class="math">\((a,0) \in \ZZ/n\ZZ \times \ZZ/n\ZZ\)</span> is called a decimation cipher on
the Roman alphabet, or decimation cipher for short:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AffineCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;A decimation cipher is a specialized affine cipher.&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">;</span> <span class="n">C</span>
<span class="go">ADECIMATIONCIPHERISASPECIALIZEDAFFINECIPHER</span>
<span class="go">AZQIGWALGENIGVPQDGUAUVQIGAFGJQZAHHGNQIGVPQD</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">deciphering</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Generate a random key for encryption and decryption:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AffineCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;An affine cipher with a random key.&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">deciphering</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>The binary number system is currently not a supported alphabet of
this affine cryptosystem:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">AffineCryptosystem</span><span class="p">(</span><span class="n">BinaryStrings</span><span class="p">())</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">A (= Free binary string monoid) is not supported as a cipher domain of this affine cryptosystem.</span>
</pre></div>
</div>
<p>Nor are the octal, hexadecimal, and radix-64 number systems supported:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">AffineCryptosystem</span><span class="p">(</span><span class="n">OctalStrings</span><span class="p">())</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">A (= Free octal string monoid) is not supported as a cipher domain of this affine cryptosystem.</span>
<span class="gp">sage: </span><span class="n">AffineCryptosystem</span><span class="p">(</span><span class="n">HexadecimalStrings</span><span class="p">())</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">A (= Free hexadecimal string monoid) is not supported as a cipher domain of this affine cryptosystem.</span>
<span class="gp">sage: </span><span class="n">AffineCryptosystem</span><span class="p">(</span><span class="n">Radix64Strings</span><span class="p">())</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">A (= Free radix 64 string monoid) is not supported as a cipher domain of this affine cryptosystem.</span>
</pre></div>
</div>
<p>A secret key <span class="math">\((a,b)\)</span> must be an element of <span class="math">\(\ZZ/n\ZZ \times \ZZ/n\ZZ\)</span> with
<span class="math">\(\gcd(a,n) = 1\)</span>. This rules out the case <span class="math">\(a = 0\)</span> irrespective of the
value of <span class="math">\(b\)</span>. For the upper-case letters of the English alphabet, where
the alphabet size is <span class="math">\(n = 26\)</span>, <span class="math">\(a\)</span> cannot take on any even value:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AffineCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">A</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">(a, b) = (0, 1) is outside the range of acceptable values for a key of this affine cryptosystem.</span>
<span class="gp">sage: </span><span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">(a, b) = (2, 1) is outside the range of acceptable values for a key of this affine cryptosystem.</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="sti06" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[Sti06]</a></td><td>Douglas R. Stinson. <em>Cryptography: Theory and Practice</em>.
3rd edition, Chapman &amp; Hall/CRC, 2006.</td></tr>
</tbody>
</table>
<dl class="method">
<dt id="sage.crypto.classical.AffineCryptosystem.brute_force">
<code class="descname">brute_force</code><span class="sig-paren">(</span><em>C</em>, <em>ranking='none'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.AffineCryptosystem.brute_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempt a brute force cryptanalysis of the ciphertext <code class="docutils literal"><span class="pre">C</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">C</span></code> &#8211; A ciphertext over one of the supported alphabets of this
affine cryptosystem. See the class <a class="reference internal" href="#sage.crypto.classical.AffineCryptosystem" title="sage.crypto.classical.AffineCryptosystem"><code class="xref py py-class docutils literal"><span class="pre">AffineCryptosystem</span></code></a> for
documentation on the supported alphabets.</li>
<li><code class="docutils literal"><span class="pre">ranking</span></code> &#8211; (default <code class="docutils literal"><span class="pre">&quot;none&quot;</span></code>) the method to use for
ranking all possible keys. If <code class="docutils literal"><span class="pre">ranking=&quot;none&quot;</span></code>, then do not
use any ranking function. The following ranking functions are
supported:<ul>
<li><code class="docutils literal"><span class="pre">&quot;chi_square&quot;</span></code> &#8211; the chi-square ranking function
as implemented in the method <a class="reference internal" href="#sage.crypto.classical.AffineCryptosystem.rank_by_chi_square" title="sage.crypto.classical.AffineCryptosystem.rank_by_chi_square"><code class="xref py py-func docutils literal"><span class="pre">rank_by_chi_square()</span></code></a>.</li>
<li><code class="docutils literal"><span class="pre">&quot;squared_differences&quot;</span></code> &#8211; the squared differences ranking
function as implemented in the method
<a class="reference internal" href="#sage.crypto.classical.AffineCryptosystem.rank_by_squared_differences" title="sage.crypto.classical.AffineCryptosystem.rank_by_squared_differences"><code class="xref py py-func docutils literal"><span class="pre">rank_by_squared_differences()</span></code></a>.</li>
</ul>
</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>All the possible plaintext sequences corresponding to the
ciphertext <code class="docutils literal"><span class="pre">C</span></code>. This method effectively uses all the possible
keys in this affine cryptosystem to decrypt <code class="docutils literal"><span class="pre">C</span></code>. The method is
also referred to as exhaustive key search. The output is a
dictionary of key, candidate decipherment pairs.</li>
</ul>
<p>EXAMPLES:</p>
<p>Cryptanalyze using all possible keys with the option
<code class="docutils literal"><span class="pre">ranking=&quot;none&quot;</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AffineCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Linear&quot;</span><span class="p">);</span> <span class="n">P</span>
<span class="go">LINEAR</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">brute_force</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">items</span><span class="p">())[:</span><span class="mi">26</span><span class="p">]</span>  <span class="c1"># display 26 candidate decipherments</span>

<span class="go">[((1, 0), OFUTHG),</span>
<span class="go">((1, 1), NETSGF),</span>
<span class="go">((1, 2), MDSRFE),</span>
<span class="go">((1, 3), LCRQED),</span>
<span class="go">((1, 4), KBQPDC),</span>
<span class="go">((1, 5), JAPOCB),</span>
<span class="go">((1, 6), IZONBA),</span>
<span class="go">((1, 7), HYNMAZ),</span>
<span class="go">((1, 8), GXMLZY),</span>
<span class="go">((1, 9), FWLKYX),</span>
<span class="go">((1, 10), EVKJXW),</span>
<span class="go">((1, 11), DUJIWV),</span>
<span class="go">((1, 12), CTIHVU),</span>
<span class="go">((1, 13), BSHGUT),</span>
<span class="go">((1, 14), ARGFTS),</span>
<span class="go">((1, 15), ZQFESR),</span>
<span class="go">((1, 16), YPEDRQ),</span>
<span class="go">((1, 17), XODCQP),</span>
<span class="go">((1, 18), WNCBPO),</span>
<span class="go">((1, 19), VMBAON),</span>
<span class="go">((1, 20), ULAZNM),</span>
<span class="go">((1, 21), TKZYML),</span>
<span class="go">((1, 22), SJYXLK),</span>
<span class="go">((1, 23), RIXWKJ),</span>
<span class="go">((1, 24), QHWVJI),</span>
<span class="go">((1, 25), PGVUIH)]</span>
</pre></div>
</div>
<p>Use the chi-square ranking function, i.e. <code class="docutils literal"><span class="pre">ranking=&quot;chisquare&quot;</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AffineCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Linear functions for encrypting and decrypting.&quot;</span><span class="p">);</span> <span class="n">P</span>
<span class="go">LINEARFUNCTIONSFORENCRYPTINGANDDECRYPTING</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Rank</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">brute_force</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">ranking</span><span class="o">=</span><span class="s2">&quot;chisquare&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Rank</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>  <span class="c1"># display only the top 10 candidate keys</span>

<span class="go">[((3, 7), LINEARFUNCTIONSFORENCRYPTINGANDDECRYPTING),</span>
<span class="go">((23, 25), VYTCGPBMTENYSTOBSPCTEPIRNYTAGTDDCEPIRNYTA),</span>
<span class="go">((1, 12), CTIHVUKDIBATLIXKLUHIBUPOATINVIEEHBUPOATIN),</span>
<span class="go">((11, 15), HSRYELDAROVSWRQDWLYROLUBVSRIERTTYOLUBVSRI),</span>
<span class="go">((25, 1), NWHIUVFMHOPWEHSFEVIHOVABPWHCUHLLIOVABPWHC),</span>
<span class="go">((25, 7), TCNOABLSNUVCKNYLKBONUBGHVCNIANRROUBGHVCNI),</span>
<span class="go">((15, 4), SHIBVOWZILEHDIJWDOBILOFYEHIRVIGGBLOFYEHIR),</span>
<span class="go">((15, 23), PEFYSLTWFIBEAFGTALYFILCVBEFOSFDDYILCVBEFO),</span>
<span class="go">((7, 10), IDUFHSYXUTEDNULYNSFUTSVGEDURHUMMFTSVGEDUR),</span>
<span class="go">((19, 22), QVETRGABEFUVLENALGTEFGDSUVEHREMMTFGDSUVEH)]</span>
</pre></div>
</div>
<p>Use the squared differences ranking function, i.e.
<code class="docutils literal"><span class="pre">ranking=&quot;squared_differences&quot;</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Rank</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">brute_force</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">ranking</span><span class="o">=</span><span class="s2">&quot;squared_differences&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Rank</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>  <span class="c1"># display only the top 10 candidate keys</span>

<span class="go">[((3, 7), LINEARFUNCTIONSFORENCRYPTINGANDDECRYPTING),</span>
<span class="go">((23, 6), GJENRAMXEPYJDEZMDANEPATCYJELREOONPATCYJEL),</span>
<span class="go">((23, 25), VYTCGPBMTENYSTOBSPCTEPIRNYTAGTDDCEPIRNYTA),</span>
<span class="go">((19, 22), QVETRGABEFUVLENALGTEFGDSUVEHREMMTFGDSUVEH),</span>
<span class="go">((19, 9), DIRGETNORSHIYRANYTGRSTQFHIRUERZZGSTQFHIRU),</span>
<span class="go">((23, 18), KNIRVEQBITCNHIDQHERITEXGCNIPVISSRTEXGCNIP),</span>
<span class="go">((17, 16), GHORBEIDOJMHFOVIFEROJETWMHOZBOAARJETWMHOZ),</span>
<span class="go">((21, 14), AHEZRMOFEVQHTEBOTMZEVMNIQHEDREKKZVMNIQHED),</span>
<span class="go">((1, 12), CTIHVUKDIBATLIXKLUHIBUPOATINVIEEHBUPOATIN),</span>
<span class="go">((7, 18), SNEPRCIHEDONXEVIXCPEDCFQONEBREWWPDCFQONEB)]</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Currently, the binary number system is not supported as an
alphabet of this affine cryptosystem:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AffineCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">BinStr</span> <span class="o">=</span> <span class="n">BinaryStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">BinStr</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;abc&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">brute_force</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Ciphertext must be encoded using one of the supported cipher domains of this affine cryptosystem.</span>
</pre></div>
</div>
<p>Nor are the octal, hexadecimal, and radix-64 number systems
supported:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">OctStr</span> <span class="o">=</span> <span class="n">OctalStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">OctStr</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">brute_force</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Ciphertext must be encoded using one of the supported cipher domains of this affine cryptosystem.</span>
<span class="gp">sage: </span><span class="n">HexStr</span> <span class="o">=</span> <span class="n">HexadecimalStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HexStr</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;abc&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">brute_force</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Ciphertext must be encoded using one of the supported cipher domains of this affine cryptosystem.</span>
<span class="gp">sage: </span><span class="n">RadStr</span> <span class="o">=</span> <span class="n">Radix64Strings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">RadStr</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">brute_force</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Ciphertext must be encoded using one of the supported cipher domains of this affine cryptosystem.</span>
</pre></div>
</div>
<p>Only the chi-square and squared-differences ranking functions are
currently supported. The keyword <code class="docutils literal"><span class="pre">ranking</span></code> must take on either
of the values <code class="docutils literal"><span class="pre">&quot;none&quot;</span></code>, <code class="docutils literal"><span class="pre">&quot;chisquare&quot;</span></code> or
<code class="docutils literal"><span class="pre">&quot;squared_differences&quot;</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AffineCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Linear&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">brute_force</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">ranking</span><span class="o">=</span><span class="s2">&quot;chi&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Keyword &#39;ranking&#39; must be either &#39;none&#39;, &#39;chisquare&#39;, or &#39;squared_differences&#39;.</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">brute_force</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">ranking</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Keyword &#39;ranking&#39; must be either &#39;none&#39;, &#39;chisquare&#39;, or &#39;squared_differences&#39;.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.classical.AffineCryptosystem.deciphering">
<code class="descname">deciphering</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>C</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.AffineCryptosystem.deciphering" title="Permalink to this definition">¶</a></dt>
<dd><p>Decrypt the ciphertext <code class="docutils literal"><span class="pre">C</span></code> with the key <code class="docutils literal"><span class="pre">(a,</span> <span class="pre">b)</span></code> using affine
cipher decryption.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">a,</span> <span class="pre">b</span></code> &#8211; a secret key belonging to the key space of this affine
cipher. This key must be an element of
<span class="math">\(\ZZ/n\ZZ \times \ZZ/n\ZZ\)</span> such that <span class="math">\(\gcd(a,n) = 1\)</span> with <span class="math">\(n\)</span>
being the size of the ciphertext and plaintext spaces.</li>
<li><code class="docutils literal"><span class="pre">C</span></code> &#8211; a string of ciphertext; possibly an empty string.
Characters in this string must be encoded using one of the
supported alphabets. See the method <a class="reference internal" href="#sage.crypto.classical.AffineCryptosystem.encoding" title="sage.crypto.classical.AffineCryptosystem.encoding"><code class="xref py py-func docutils literal"><span class="pre">encoding()</span></code></a> for more
information.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The plaintext corresponding to the ciphertext <code class="docutils literal"><span class="pre">C</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<p>Decryption over the capital letters of the English alphabet:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AffineCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Affine functions are linear functions.&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">P</span><span class="p">);</span> <span class="n">C</span>
<span class="go">CBBQPWBYPMTQUPOCJWFQPWCJBYPMTQUPO</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">==</span> <span class="n">A</span><span class="o">.</span><span class="n">deciphering</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The previous example can also be worked through using functional
notation:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AffineCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Affine functions are linear functions.&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span> <span class="n">E</span>
<span class="go">Affine cipher on Free alphabetic string monoid on A-Z</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">P</span><span class="p">);</span> <span class="n">C</span>
<span class="go">CBBQPWBYPMTQUPOCJWFQPWCJBYPMTQUPO</span>
<span class="gp">sage: </span><span class="n">aInv</span><span class="p">,</span> <span class="n">bInv</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">inverse_key</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="n">aInv</span><span class="p">,</span> <span class="n">bInv</span><span class="p">);</span> <span class="n">D</span>
<span class="go">Affine cipher on Free alphabetic string monoid on A-Z</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If the ciphertext is an empty string, then the plaintext is also
an empty string regardless of the value of the secret key:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">deciphering</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span>

<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">deciphering</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>The key must be an ordered pair
<span class="math">\((a,b) \in \ZZ/n\ZZ \times \ZZ/n\ZZ\)</span> with <span class="math">\(n\)</span> being the size of the
plaintext and ciphertext spaces. Furthermore, <span class="math">\(a\)</span> must be
relatively prime to <span class="math">\(n\)</span>, i.e. <span class="math">\(\gcd(a,n) = 1\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">deciphering</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">(a, b) = (2, 6) is outside the range of acceptable values for a key of this affine cipher.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.classical.AffineCryptosystem.enciphering">
<code class="descname">enciphering</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>P</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.AffineCryptosystem.enciphering" title="Permalink to this definition">¶</a></dt>
<dd><p>Encrypt the plaintext <code class="docutils literal"><span class="pre">P</span></code> with the key <code class="docutils literal"><span class="pre">(a,</span> <span class="pre">b)</span></code> using affine cipher
encryption.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">a,</span> <span class="pre">b</span></code> &#8211; a secret key belonging to the key space of this affine
cipher. This key must be an element of
<span class="math">\(\ZZ/n\ZZ \times \ZZ/n\ZZ\)</span> such that <span class="math">\(\gcd(a,n) = 1\)</span> with <span class="math">\(n\)</span>
being the size of the ciphertext and plaintext spaces.</li>
<li><code class="docutils literal"><span class="pre">P</span></code> &#8211; a string of plaintext; possibly an empty string.
Characters in this string must be encoded using one of the
supported alphabets. See the method <a class="reference internal" href="#sage.crypto.classical.AffineCryptosystem.encoding" title="sage.crypto.classical.AffineCryptosystem.encoding"><code class="xref py py-func docutils literal"><span class="pre">encoding()</span></code></a> for more
information.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The ciphertext corresponding to the plaintext <code class="docutils literal"><span class="pre">P</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<p>Encryption over the capital letters of the English alphabet:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AffineCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Affine ciphers work with linear functions.&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="go">GVVETSMEZBSFIUWFKUELBNETSGFVOTMLEWTI</span>
</pre></div>
</div>
<p>Now work through the previous example using functional notation:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AffineCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Affine ciphers work with linear functions.&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span> <span class="n">E</span>
<span class="go">Affine cipher on Free alphabetic string monoid on A-Z</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">GVVETSMEZBSFIUWFKUELBNETSGFVOTMLEWTI</span>
</pre></div>
</div>
<p>If the plaintext is an empty string, then the ciphertext is also
an empty string regardless of the value of the secret key:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span>

<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>The key must be an ordered pair
<span class="math">\((a,b) \in \ZZ/n\ZZ \times \ZZ/n\ZZ\)</span> with <span class="math">\(n\)</span> being the size of the
plaintext and ciphertext spaces. Furthermore, <span class="math">\(a\)</span> must be
relatively prime to <span class="math">\(n\)</span>, i.e. <span class="math">\(\gcd(a,n) = 1\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">(a, b) = (2, 6) is outside the range of acceptable values for a key of this affine cryptosystem.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.classical.AffineCryptosystem.encoding">
<code class="descname">encoding</code><span class="sig-paren">(</span><em>S</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.AffineCryptosystem.encoding" title="Permalink to this definition">¶</a></dt>
<dd><p>The encoding of the string <code class="docutils literal"><span class="pre">S</span></code> over the string monoid of this
affine cipher. For example, if the string monoid of this cryptosystem
is
<a class="reference external" href="../../../monoids/sage/monoids/string_monoid.html#sage.monoids.string_monoid.AlphabeticStringMonoid" title="(in Sage Reference Manual: Monoids v7.4)"><code class="xref py py-class docutils literal"><span class="pre">AlphabeticStringMonoid</span></code></a>,
then the encoding of <code class="docutils literal"><span class="pre">S</span></code> would be its upper-case equivalent
stripped of all non-alphabetic characters. Only the following alphabet
is supported for the affine cipher:</p>
<ul class="simple">
<li>capital letters of the English alphabet as implemented in
<a class="reference external" href="../../../monoids/sage/monoids/string_monoid.html#sage.monoids.string_monoid.AlphabeticStrings" title="(in Sage Reference Manual: Monoids v7.4)"><code class="xref py py-func docutils literal"><span class="pre">AlphabeticStrings()</span></code></a></li>
</ul>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">S</span></code> &#8211; a string, possibly empty.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The encoding of <code class="docutils literal"><span class="pre">S</span></code> over the string monoid of this cryptosystem.
If <code class="docutils literal"><span class="pre">S</span></code> is an empty string, return an empty string.</li>
</ul>
<p>EXAMPLES:</p>
<p>Encoding over the upper-case letters of the English alphabet:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AffineCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Affine cipher over capital letters of the English alphabet.&quot;</span><span class="p">)</span>
<span class="go">AFFINECIPHEROVERCAPITALLETTERSOFTHEENGLISHALPHABET</span>
</pre></div>
</div>
<p>The argument <code class="docutils literal"><span class="pre">S</span></code> can be an empty string, in which case an empty
string is returned:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">AffineCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.classical.AffineCryptosystem.inverse_key">
<code class="descname">inverse_key</code><span class="sig-paren">(</span><em>a</em>, <em>b</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.AffineCryptosystem.inverse_key" title="Permalink to this definition">¶</a></dt>
<dd><p>The inverse key corresponding to the secret key <span class="math">\((a,b)\)</span>. If <span class="math">\(p\)</span> is
a plaintext character so that <span class="math">\(p \in \ZZ/n\ZZ\)</span> and <span class="math">\(n\)</span> is the
alphabet size, then the ciphertext <span class="math">\(c\)</span> corresponding to <span class="math">\(p\)</span> is</p>
<div class="math">
\[c \equiv ap + b \pmod{n}\]</div>
<p>As <span class="math">\((a,b)\)</span> is a key, then the multiplicative inverse <span class="math">\(a^{-1}\)</span>
exists and the original plaintext can be recovered as follows</p>
<div class="math">
\[p \equiv a^{-1} (c - b) \pmod{n}
  \equiv a^{-1}c + a^{-1}(-b) \pmod{n}\]</div>
<p>Therefore the ordered pair <span class="math">\((a^{-1}, -ba^{-1})\)</span> is the inverse key
corresponding to <span class="math">\((a,b)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">a,</span> <span class="pre">b</span></code> &#8211; a secret key for this affine cipher. The ordered pair
<span class="math">\((a,b)\)</span> must be an element of <span class="math">\(\ZZ/n\ZZ \times \ZZ/n\ZZ\)</span> such that
<span class="math">\(\gcd(a,n) = 1\)</span>.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The inverse key <span class="math">\((a^{-1}, -ba^{-1})\)</span> corresponding to <span class="math">\((a,b)\)</span>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AffineCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">inverse_key</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="go">(1, 24)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">inverse_key</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">(9, 8)</span>
</pre></div>
</div>
<p>Suppose that the plaintext and ciphertext spaces are the capital
letters of the English alphabet so that <span class="math">\(n = 26\)</span>. If <span class="math">\(\varphi(n)\)</span>
is the Euler phi function of <span class="math">\(n\)</span>, then there are <span class="math">\(\varphi(n)\)</span>
integers <span class="math">\(0 \leq a &lt; n\)</span> that are relatively prime to <span class="math">\(n\)</span>. For the
capital letters of the English alphabet, there are 12 such integers
relatively prime to <span class="math">\(n\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">euler_phi</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">alphabet_size</span><span class="p">())</span>
<span class="go">12</span>
</pre></div>
</div>
<p>And here is a list of those integers:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">alphabet_size</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">if</span> <span class="n">gcd</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">];</span> <span class="n">L</span>
<span class="go">[1, 3, 5, 7, 9, 11, 15, 17, 19, 21, 23, 25]</span>
</pre></div>
</div>
<p>Then a secret key <span class="math">\((a,b)\)</span> of this shift cryptosystem is
such that <span class="math">\(a\)</span> is an element of the list <code class="docutils literal"><span class="pre">L</span></code> in the last example.
Any inverse key <span class="math">\((A, B)\)</span> corresponding to <span class="math">\((a,b)\)</span> is such that
<span class="math">\(A\)</span> is also in the list <code class="docutils literal"><span class="pre">L</span></code> above:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="ow">in</span> <span class="n">L</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">aInv</span><span class="p">,</span> <span class="n">bInv</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">inverse_key</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">aInv</span><span class="p">,</span> <span class="n">bInv</span>
<span class="go">(9, 23)</span>
<span class="gp">sage: </span><span class="n">aInv</span> <span class="ow">in</span> <span class="n">L</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Any ordered pair of the form <span class="math">\((0, b)\)</span> for any integer <span class="math">\(b\)</span> cannot be
a secret key of this affine cipher. Hence <span class="math">\((0, b)\)</span> does not have
a corresponding inverse key:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AffineCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">inverse_key</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">(a, b) = (0, 1) is outside the range of acceptable values for a key of this affine cipher.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.classical.AffineCryptosystem.random_key">
<code class="descname">random_key</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.AffineCryptosystem.random_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a random key within the key space of this affine cipher.
The generated secret key is an ordered pair
<span class="math">\((a, b) \in \ZZ/n\ZZ \times \ZZ/n\ZZ\)</span> with <span class="math">\(n\)</span> being the size of
the cipher domain and <span class="math">\(\gcd(a, n) = 1\)</span>. Let <span class="math">\(\varphi(n)\)</span> denote
the Euler phi function of <span class="math">\(n\)</span>. Then the affine cipher has
<span class="math">\(n \cdot \varphi(n)\)</span> possible keys (see page 10 of <a class="reference internal" href="#sti06" id="id1">[Sti06]</a>).</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>A random key within the key space of this affine cryptosystem.
The output key is an ordered pair <span class="math">\((a,b)\)</span>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AffineCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>  <span class="c1"># random</span>
<span class="go">(17, 25)</span>
</pre></div>
</div>
<p>If <span class="math">\((a,b)\)</span> is a secret key and <span class="math">\(n\)</span> is the size of the plaintext and
ciphertext alphabets, then <span class="math">\(\gcd(a, n) = 1\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">alphabet_size</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.classical.AffineCryptosystem.rank_by_chi_square">
<code class="descname">rank_by_chi_square</code><span class="sig-paren">(</span><em>C</em>, <em>pdict</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.AffineCryptosystem.rank_by_chi_square" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the chi-square statistic to rank all possible keys. Currently,
this method only applies to the capital letters of the English
alphabet.</p>
<p>ALGORITHM:</p>
<p>Consider a non-empty alphabet <span class="math">\(A\)</span> consisting of <span class="math">\(n\)</span>
elements, and let <span class="math">\(C\)</span> be a ciphertext encoded using elements of
<span class="math">\(A\)</span>. The plaintext <span class="math">\(P\)</span> corresponding to <span class="math">\(C\)</span> is also encoded using
elements of <span class="math">\(A\)</span>. Let <span class="math">\(M\)</span> be a candidate decipherment of <span class="math">\(C\)</span>,
i.e. <span class="math">\(M\)</span> is the result of attempting to decrypt <span class="math">\(C\)</span> using a key
<span class="math">\((a,b)\)</span> which is not necessarily the same key used to encrypt <span class="math">\(P\)</span>.
Suppose <span class="math">\(F_A(e)\)</span> is the characteristic frequency probability of
<span class="math">\(e \in A\)</span> and let <span class="math">\(F_M(e)\)</span> be the message frequency probability with
respect to <span class="math">\(M\)</span>. The characteristic frequency probability
distribution of an alphabet is the expected frequency probability
distribution for that alphabet. The message frequency probability
distribution of <span class="math">\(M\)</span> provides a distribution of the ratio of character
occurrences over message length. One can interpret the
characteristic frequency probability <span class="math">\(F_A(e)\)</span> as the expected
probability, while the message frequency probability <span class="math">\(F_M(e)\)</span> is
the observed probability. If <span class="math">\(M\)</span> is of length <span class="math">\(L\)</span>, then the observed
frequency of <span class="math">\(e \in A\)</span> is</p>
<div class="math">
\[O_M(e)
=
F_M(e) \cdot L\]</div>
<p>and the expected frequency of <span class="math">\(e \in A\)</span> is</p>
<div class="math">
\[E_A(e)
=
F_A(e) \cdot L\]</div>
<p>The chi-square rank <span class="math">\(R_{\chi^2}(M)\)</span> of <span class="math">\(M\)</span> corresponding to a key
<span class="math">\((a,b) \in \ZZ/n\ZZ \times \ZZ/n\ZZ\)</span> is given by</p>
<div class="math">
\[R_{\chi^2}(M)
=
\sum_{e \in A} \frac {\big( O_M(e) - E_A(e) \big)^2}
                     {E_A(e)}\]</div>
<p>Cryptanalysis by exhaustive key search produces a candidate
decipherment <span class="math">\(M_{a,b}\)</span> for each possible key <span class="math">\((a,b)\)</span>. For a set
<span class="math">\(D = \big\{M_{a_1,b_1}, M_{a_2,b_2}, \dots, M_{a_k,b_k} \big\}\)</span>
of all candidate decipherments corresponding to a ciphertext <span class="math">\(C\)</span>,
the smaller is the rank <span class="math">\(R_{\chi^2}(M_{a_i,b_i})\)</span> the more likely
that <span class="math">\((a_i,b_i)\)</span> is the secret key. This key ranking method is
based on the Pearson chi-square test <a class="reference internal" href="#pearsontest09" id="id2">[PearsonTest09]</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">C</span></code> &#8211; The ciphertext, a non-empty string. The ciphertext
must be encoded using the upper-case letters of the English
alphabet.</li>
<li><code class="docutils literal"><span class="pre">pdict</span></code> &#8211; A dictionary of key, possible plaintext
pairs. This should be the output of <a class="reference internal" href="#sage.crypto.classical.AffineCryptosystem.brute_force" title="sage.crypto.classical.AffineCryptosystem.brute_force"><code class="xref py py-func docutils literal"><span class="pre">brute_force()</span></code></a> with
<code class="docutils literal"><span class="pre">ranking=&quot;none&quot;</span></code>.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>A list ranking the most likely keys first. Each element of the
list is a tuple of key, possible plaintext pairs.</li>
</ul>
<p>EXAMPLES:</p>
<p>Use the chi-square statistic to rank all possible keys and their
corresponding decipherment:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AffineCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Line.&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Plist</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">brute_force</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Rank</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">rank_by_chi_square</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">Plist</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Rank</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>  <span class="c1"># display only the top 10 candidate keys</span>

<span class="go">[((1, 1), NETS),</span>
<span class="go">((3, 7), LINE),</span>
<span class="go">((17, 20), STAD),</span>
<span class="go">((5, 2), SLOT),</span>
<span class="go">((5, 5), HADI),</span>
<span class="go">((9, 25), TSLI),</span>
<span class="go">((17, 15), DELO),</span>
<span class="go">((15, 6), ETUN),</span>
<span class="go">((21, 8), ELID),</span>
<span class="go">((7, 17), HCTE)]</span>
</pre></div>
</div>
<p>As more ciphertext is available, the reliability of the chi-square
ranking function increases:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AffineCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Longer message is more information for cryptanalysis.&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Plist</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">brute_force</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Rank</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">rank_by_chi_square</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">Plist</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Rank</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>  <span class="c1"># display only the top 10 candidate keys</span>

<span class="go">[((11, 24), LONGERMESSAGEISMOREINFORMATIONFORCRYPTANALYSIS),</span>
<span class="go">((17, 9), INURFSBFLLHRFDLBNSFDUYNSBHEDNUYNSTSVGEHUHIVLDL),</span>
<span class="go">((9, 18), RMFIUHYUOOSIUWOYMHUWFBMHYSVWMFBMHGHETVSFSREOWO),</span>
<span class="go">((15, 12), VSTACPUCOOGACYOUSPCYTBSPUGNYSTBSPEPIRNGTGVIOYO),</span>
<span class="go">((3, 22), PAFOYLKYGGSOYEGKALYEFTALKSBEAFTALILCVBSFSPCGEG),</span>
<span class="go">((25, 3), OHSRNADNPPFRNVPDHANVSCHADFEVHSCHAJABWEFSFOBPVP),</span>
<span class="go">((7, 25), GHYNVIPVRRLNVFRPHIVFYEHIPLAFHYEHIDITQALYLGTRFR),</span>
<span class="go">((5, 2), NEHCIVKISSUCIWSKEVIWHFEVKUPWEHFEVOVABPUHUNASWS),</span>
<span class="go">((15, 25), IFGNPCHPBBTNPLBHFCPLGOFCHTALFGOFCRCVEATGTIVBLB),</span>
<span class="go">((9, 6), BWPSERIEYYCSEGYIWREGPLWRICFGWPLWRQRODFCPCBOYGY)]</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>The ciphertext cannot be an empty string:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rank_by_chi_square</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">Plist</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">&#39;str&#39; object has no attribute &#39;parent&#39;</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rank_by_chi_square</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="n">Plist</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The ciphertext must be a non-empty string.</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rank_by_chi_square</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">),</span> <span class="n">Plist</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The ciphertext must be a non-empty string.</span>
</pre></div>
</div>
<p>The ciphertext must be encoded using the capital letters of the
English alphabet as implemented in
<a class="reference external" href="../../../monoids/sage/monoids/string_monoid.html#sage.monoids.string_monoid.AlphabeticStrings" title="(in Sage Reference Manual: Monoids v7.4)"><code class="xref py py-func docutils literal"><span class="pre">AlphabeticStrings()</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">HexadecimalStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rank_by_chi_square</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;shift&quot;</span><span class="p">),</span> <span class="n">Plist</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">The ciphertext must be capital letters of the English alphabet.</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">BinaryStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rank_by_chi_square</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;shift&quot;</span><span class="p">),</span> <span class="n">Plist</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">The ciphertext must be capital letters of the English alphabet.</span>
</pre></div>
</div>
<p>The dictionary <code class="docutils literal"><span class="pre">pdict</span></code> cannot be empty:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rank_by_chi_square</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="p">{})</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">KeyError</span>: <span class="n">(1, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.classical.AffineCryptosystem.rank_by_squared_differences">
<code class="descname">rank_by_squared_differences</code><span class="sig-paren">(</span><em>C</em>, <em>pdict</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.AffineCryptosystem.rank_by_squared_differences" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the squared-differences measure to rank all possible keys.
Currently, this method only applies to the capital letters of
the English alphabet.</p>
<p>ALGORITHM:</p>
<p>Consider a non-empty alphabet <span class="math">\(A\)</span> consisting of <span class="math">\(n\)</span>
elements, and let <span class="math">\(C\)</span> be a ciphertext encoded using elements of
<span class="math">\(A\)</span>. The plaintext <span class="math">\(P\)</span> corresponding to <span class="math">\(C\)</span> is also encoded using
elements of <span class="math">\(A\)</span>. Let <span class="math">\(M\)</span> be a candidate decipherment of <span class="math">\(C\)</span>,
i.e. <span class="math">\(M\)</span> is the result of attempting to decrypt <span class="math">\(C\)</span> using a key
<span class="math">\((a,b)\)</span> which is not necessarily the same key used to encrypt <span class="math">\(P\)</span>.
Suppose <span class="math">\(F_A(e)\)</span> is the characteristic frequency probability of
<span class="math">\(e \in A\)</span> and let <span class="math">\(F_M(e)\)</span> be the message frequency probability with
respect to <span class="math">\(M\)</span>. The characteristic frequency probability
distribution of an alphabet is the expected frequency probability
distribution for that alphabet. The message frequency probability
distribution of <span class="math">\(M\)</span> provides a distribution of the ratio of character
occurrences over message length. One can interpret the
characteristic frequency probability <span class="math">\(F_A(e)\)</span> as the expected
probability, while the message frequency probability <span class="math">\(F_M(e)\)</span> is
the observed probability. If <span class="math">\(M\)</span> is of length <span class="math">\(L\)</span>, then the observed
frequency of <span class="math">\(e \in A\)</span> is</p>
<div class="math">
\[O_M(e)
=
F_M(e) \cdot L\]</div>
<p>and the expected frequency of <span class="math">\(e \in A\)</span> is</p>
<div class="math">
\[E_A(e)
=
F_A(e) \cdot L\]</div>
<p>The squared-differences, or residual sum of squares, rank
<span class="math">\(R_{RSS}(M)\)</span> of <span class="math">\(M\)</span> corresponding to a key
<span class="math">\((a,b) \in \ZZ/n\ZZ \times \ZZ/n\ZZ\)</span> is given by</p>
<div class="math">
\[R_{RSS}(M)
=
\sum_{e \in A} \big( O_M(e) - E_A(e) \big)^2\]</div>
<p>Cryptanalysis by exhaustive key search produces a candidate
decipherment <span class="math">\(M_{a,b}\)</span> for each possible key <span class="math">\((a,b)\)</span>. For a set
<span class="math">\(D = \big\{M_{a_1,b_1}, M_{a_2,b_2}, \dots, M_{a_k,b_k} \big\}\)</span>
of all candidate decipherments corresponding to a ciphertext <span class="math">\(C\)</span>,
the smaller is the rank <span class="math">\(R_{RSS}(M_{a_i,b_i})\)</span> the more likely
that <span class="math">\((a_i,b_i)\)</span> is the secret key. This key ranking method is
based on the residual sum of squares measure <a class="reference internal" href="#rss09" id="id3">[RSS09]</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">C</span></code> &#8211; The ciphertext, a non-empty string. The ciphertext
must be encoded using the upper-case letters of the English
alphabet.</li>
<li><code class="docutils literal"><span class="pre">pdict</span></code> &#8211; A dictionary of key, possible plaintext
pairs. This should be the output of <a class="reference internal" href="#sage.crypto.classical.AffineCryptosystem.brute_force" title="sage.crypto.classical.AffineCryptosystem.brute_force"><code class="xref py py-func docutils literal"><span class="pre">brute_force()</span></code></a> with
<code class="docutils literal"><span class="pre">ranking=&quot;none&quot;</span></code>.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>A list ranking the most likely keys first. Each element of the
list is a tuple of key, possible plaintext pairs.</li>
</ul>
<p>EXAMPLES:</p>
<p>Use the method of squared differences to rank all possible keys
and their corresponding decipherment:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AffineCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Line.&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Plist</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">brute_force</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Rank</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">rank_by_squared_differences</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">Plist</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Rank</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>  <span class="c1"># display only the top 10 candidate keys</span>

<span class="go">[((1, 1), NETS),</span>
<span class="go">((15, 6), ETUN),</span>
<span class="go">((7, 17), HCTE),</span>
<span class="go">((3, 7), LINE),</span>
<span class="go">((17, 15), DELO),</span>
<span class="go">((9, 4), EDWT),</span>
<span class="go">((9, 9), POHE),</span>
<span class="go">((21, 8), ELID),</span>
<span class="go">((17, 20), STAD),</span>
<span class="go">((7, 18), SNEP)]</span>
</pre></div>
</div>
<p>As more ciphertext is available, the reliability of the
squared-differences ranking function increases:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AffineCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Longer message is more information for cryptanalysis.&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Plist</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">brute_force</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Rank</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">rank_by_squared_differences</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">Plist</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Rank</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>  <span class="c1"># display only the top 10 candidate keys</span>

<span class="go">[((11, 24), LONGERMESSAGEISMOREINFORMATIONFORCRYPTANALYSIS),</span>
<span class="go">((9, 14), DYRUGTKGAAEUGIAKYTGIRNYTKEHIYRNYTSTQFHEREDQAIA),</span>
<span class="go">((23, 24), DSNEUHIUMMAEUOMISHUONZSHIAROSNZSHKHQXRANADQMOM),</span>
<span class="go">((23, 1), ETOFVIJVNNBFVPNJTIVPOATIJBSPTOATILIRYSBOBERNPN),</span>
<span class="go">((21, 16), VEBGANYAQQOGAMQYENAMBDENYOTMEBDENUNIHTOBOVIQMQ),</span>
<span class="go">((7, 12), TULAIVCIEEYAISECUVISLRUVCYNSULRUVQVGDNYLYTGESE),</span>
<span class="go">((5, 20), ZQTOUHWUEEGOUIEWQHUITRQHWGBIQTRQHAHMNBGTGZMEIE),</span>
<span class="go">((21, 8), JSPUOBMOEECUOAEMSBOAPRSBMCHASPRSBIBWVHCPCJWEAE),</span>
<span class="go">((25, 7), SLWVREHRTTJVRZTHLERZWGLEHJIZLWGLENEFAIJWJSFTZT),</span>
<span class="go">((25, 15), ATEDZMPZBBRDZHBPTMZHEOTMPRQHTEOTMVMNIQRERANBHB)]</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>The ciphertext cannot be an empty string:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rank_by_squared_differences</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">Plist</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">&#39;str&#39; object has no attribute &#39;parent&#39;</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rank_by_squared_differences</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="n">Plist</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The ciphertext must be a non-empty string.</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rank_by_squared_differences</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">),</span> <span class="n">Plist</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The ciphertext must be a non-empty string.</span>
</pre></div>
</div>
<p>The ciphertext must be encoded using the capital letters of the
English alphabet as implemented in
<a class="reference external" href="../../../monoids/sage/monoids/string_monoid.html#sage.monoids.string_monoid.AlphabeticStrings" title="(in Sage Reference Manual: Monoids v7.4)"><code class="xref py py-func docutils literal"><span class="pre">AlphabeticStrings()</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">HexadecimalStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rank_by_squared_differences</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;line&quot;</span><span class="p">),</span> <span class="n">Plist</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">The ciphertext must be capital letters of the English alphabet.</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">BinaryStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rank_by_squared_differences</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;line&quot;</span><span class="p">),</span> <span class="n">Plist</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">The ciphertext must be capital letters of the English alphabet.</span>
</pre></div>
</div>
<p>The dictionary <code class="docutils literal"><span class="pre">pdict</span></code> cannot be empty:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rank_by_squared_differences</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="p">{})</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">KeyError</span>: <span class="n">(1, 0)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.crypto.classical.HillCryptosystem">
<em class="property">class </em><code class="descclassname">sage.crypto.classical.</code><code class="descname">HillCryptosystem</code><span class="sig-paren">(</span><em>S</em>, <em>m</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.HillCryptosystem" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="cryptosystem.html#sage.crypto.cryptosystem.SymmetricKeyCryptosystem" title="sage.crypto.cryptosystem.SymmetricKeyCryptosystem"><code class="xref py py-class docutils literal"><span class="pre">sage.crypto.cryptosystem.SymmetricKeyCryptosystem</span></code></a></p>
<p>Create a Hill cryptosystem defined by the <span class="math">\(m\)</span> x <span class="math">\(m\)</span> matrix space
over <span class="math">\(\ZZ / N \ZZ\)</span>, where <span class="math">\(N\)</span> is the alphabet size of
the string monoid <code class="docutils literal"><span class="pre">S</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">S</span></code> - a string monoid over some alphabet</li>
<li><code class="docutils literal"><span class="pre">m</span></code> - integer <span class="math">\(&gt; 0\)</span>; the block length of matrices that specify
block permutations</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>A Hill cryptosystem of block length <code class="docutils literal"><span class="pre">m</span></code> over the alphabet <code class="docutils literal"><span class="pre">S</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">AlphabeticStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HillCryptosystem</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span>
<span class="go">Hill cryptosystem on Free alphabetic string monoid on A-Z of block length 3</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">IntegerModRing</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">M</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">A</span>
<span class="go">[1 0 1]</span>
<span class="go">[0 1 1]</span>
<span class="go">[2 2 3]</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span>
<span class="go">Hill cipher on Free alphabetic string monoid on A-Z of block length 3</span>
<span class="gp">sage: </span><span class="n">e</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="s2">&quot;LAMAISONBLANCHE&quot;</span><span class="p">))</span>
<span class="go">JYVKSKQPELAYKPV</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">AlphabeticStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HillCryptosystem</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">==</span> <span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">E</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.crypto.classical.HillCryptosystem.block_length">
<code class="descname">block_length</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.HillCryptosystem.block_length" title="Permalink to this definition">¶</a></dt>
<dd><p>The row or column dimension of a matrix specifying a block
permutation. Encryption and decryption keys of a Hill cipher are
square matrices, i.e. the row and column dimensions of an encryption
or decryption key are the same. This row/column dimension is referred
to as the <em>block length</em>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>The block length of an encryption/decryption key.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AlphabeticStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">ngens</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">HillCryptosystem</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">block_length</span><span class="p">()</span> <span class="o">==</span> <span class="n">n</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.classical.HillCryptosystem.deciphering">
<code class="descname">deciphering</code><span class="sig-paren">(</span><em>A</em>, <em>C</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.HillCryptosystem.deciphering" title="Permalink to this definition">¶</a></dt>
<dd><p>Decrypt the ciphertext <code class="docutils literal"><span class="pre">C</span></code> using the key <code class="docutils literal"><span class="pre">A</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">A</span></code> - a key within the key space of this Hill cipher</li>
<li><code class="docutils literal"><span class="pre">C</span></code> - a string (possibly empty) over the string monoid of this
Hill cipher</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The plaintext corresponding to the ciphertext <code class="docutils literal"><span class="pre">C</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">HillCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">(),</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Good day, mate! How ya going?&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">deciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">H</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">M</span><span class="p">))</span> <span class="o">==</span> <span class="n">M</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.classical.HillCryptosystem.enciphering">
<code class="descname">enciphering</code><span class="sig-paren">(</span><em>A</em>, <em>M</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.HillCryptosystem.enciphering" title="Permalink to this definition">¶</a></dt>
<dd><p>Encrypt the plaintext <code class="docutils literal"><span class="pre">M</span></code> using the key <code class="docutils literal"><span class="pre">A</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">A</span></code> - a key within the key space of this Hill cipher</li>
<li><code class="docutils literal"><span class="pre">M</span></code> - a string (possibly empty) over the string monoid of this
Hill cipher.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The ciphertext corresponding to the plaintext <code class="docutils literal"><span class="pre">M</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">HillCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">(),</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Good day, mate! How ya going?&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">deciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">H</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">M</span><span class="p">))</span> <span class="o">==</span> <span class="n">M</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.classical.HillCryptosystem.encoding">
<code class="descname">encoding</code><span class="sig-paren">(</span><em>M</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.HillCryptosystem.encoding" title="Permalink to this definition">¶</a></dt>
<dd><p>The encoding of the string <code class="docutils literal"><span class="pre">M</span></code> over the string monoid of this
Hill cipher. For example, if the string monoid of this Hill cipher
is <code class="xref py py-class docutils literal"><span class="pre">AlphabeticStringMonoid</span></code>, then the encoding of <code class="docutils literal"><span class="pre">M</span></code> would
be its upper-case equivalent stripped of all non-alphabetic
characters.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">M</span></code> - a string, possibly empty</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The encoding of <code class="docutils literal"><span class="pre">M</span></code> over the string monoid of this Hill cipher.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="s2">&quot;The matrix cipher by Lester S. Hill.&quot;</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AlphabeticStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">HillCryptosystem</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">==</span> <span class="n">A</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.classical.HillCryptosystem.inverse_key">
<code class="descname">inverse_key</code><span class="sig-paren">(</span><em>A</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.HillCryptosystem.inverse_key" title="Permalink to this definition">¶</a></dt>
<dd><p>The inverse key corresponding to the key <code class="docutils literal"><span class="pre">A</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">A</span></code> - an invertible matrix of the key space of this Hill cipher</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The inverse matrix of <code class="docutils literal"><span class="pre">A</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">AlphabeticStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HillCryptosystem</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">inverse_key</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="s2">&quot;LAMAISONBLANCHE&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span><span class="p">(</span><span class="n">e</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
<span class="go">LAMAISONBLANCHE</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.classical.HillCryptosystem.random_key">
<code class="descname">random_key</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.HillCryptosystem.random_key" title="Permalink to this definition">¶</a></dt>
<dd><p>A random key within the key space of this Hill cipher. That is,
generate a random <span class="math">\(m\)</span> x <span class="math">\(m\)</span> matrix to be used as a block
permutation, where <span class="math">\(m\)</span> is the block length of this Hill cipher. If
<span class="math">\(n\)</span> is the size of the cryptosystem alphabet, then there are
<span class="math">\(n^{m^2}\)</span> possible keys. However the number of valid keys,
i.e. invertible <span class="math">\(m\)</span> x <span class="math">\(m\)</span> square matrices, is smaller than
<span class="math">\(n^{m^2}\)</span>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>A random key within the key space of this Hill cipher.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AlphabeticStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">HillCryptosystem</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Ki</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">inverse_key</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="s2">&quot;LAMAISONBLANCHE&quot;</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="n">Ki</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span><span class="p">(</span><span class="n">e</span><span class="p">(</span><span class="n">A</span><span class="p">(</span><span class="n">M</span><span class="p">)))</span> <span class="o">==</span> <span class="n">A</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.crypto.classical.ShiftCryptosystem">
<em class="property">class </em><code class="descclassname">sage.crypto.classical.</code><code class="descname">ShiftCryptosystem</code><span class="sig-paren">(</span><em>A</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.ShiftCryptosystem" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="cryptosystem.html#sage.crypto.cryptosystem.SymmetricKeyCryptosystem" title="sage.crypto.cryptosystem.SymmetricKeyCryptosystem"><code class="xref py py-class docutils literal"><span class="pre">sage.crypto.cryptosystem.SymmetricKeyCryptosystem</span></code></a></p>
<p>Create a shift cryptosystem.</p>
<p>Let <span class="math">\(A = \{ a_0, a_1, a_2, \dots, a_{n-1} \}\)</span> be a non-empty alphabet
consisting of <span class="math">\(n\)</span> unique elements. Define a mapping
<span class="math">\(f : A \longrightarrow \ZZ/ n\ZZ\)</span> from the alphabet <span class="math">\(A\)</span> to
the set <span class="math">\(\ZZ / n\ZZ\)</span> of integers modulo <span class="math">\(n\)</span>, given by
<span class="math">\(f(a_i) = i\)</span>. Thus we can identify each element of the alphabet <span class="math">\(A\)</span>
with a unique integer <span class="math">\(0 \leq i &lt; n\)</span>. A key of the shift cipher is an
integer <span class="math">\(0 \leq k &lt; n\)</span>. Therefore the key space is <span class="math">\(\ZZ / n\ZZ\)</span>. Since
we assume that <span class="math">\(A\)</span> does not have repeated elements, the mapping
<span class="math">\(f : A \longrightarrow \ZZ/ n\ZZ\)</span> is bijective.
Encryption works by moving along the alphabet by <span class="math">\(k\)</span> positions, with
wrap around. Decryption reverses the process by moving backwards by
<span class="math">\(k\)</span> positions, with wrap around. More generally, let <span class="math">\(k\)</span> be a secret key,
i.e. an element of the key space, and let <span class="math">\(p\)</span> be a plaintext
character and consequently <span class="math">\(p \in \ZZ / n\ZZ\)</span>. Then the ciphertext
character <span class="math">\(c\)</span> corresponding to <span class="math">\(p\)</span> is given by</p>
<div class="math">
\[c \equiv p + k \pmod{n}\]</div>
<p>Similarly, given a ciphertext character <span class="math">\(c \in \ZZ / n\ZZ\)</span> and a secret
key <span class="math">\(k\)</span>, we can recover the corresponding plaintext character as follows:</p>
<div class="math">
\[p \equiv c - k \pmod{n}\]</div>
<p>Use the bijection <span class="math">\(f : A \longrightarrow \ZZ/ n\ZZ\)</span> to convert <span class="math">\(c\)</span>
and <span class="math">\(p\)</span> back to elements of the alphabet <span class="math">\(A\)</span>. Currently, the following
alphabets are supported for the shift cipher:</p>
<ul class="simple">
<li>capital letters of the English alphabet as implemented in
<a class="reference external" href="../../../monoids/sage/monoids/string_monoid.html#sage.monoids.string_monoid.AlphabeticStrings" title="(in Sage Reference Manual: Monoids v7.4)"><code class="xref py py-func docutils literal"><span class="pre">AlphabeticStrings()</span></code></a></li>
<li>the alphabet consisting of the hexadecimal number system as
implemented in
<a class="reference external" href="../../../monoids/sage/monoids/string_monoid.html#sage.monoids.string_monoid.HexadecimalStrings" title="(in Sage Reference Manual: Monoids v7.4)"><code class="xref py py-func docutils literal"><span class="pre">HexadecimalStrings()</span></code></a></li>
<li>the alphabet consisting of the binary number system as implemented in
<a class="reference external" href="../../../monoids/sage/monoids/string_monoid.html#sage.monoids.string_monoid.BinaryStrings" title="(in Sage Reference Manual: Monoids v7.4)"><code class="xref py py-func docutils literal"><span class="pre">BinaryStrings()</span></code></a></li>
</ul>
<p>EXAMPLES:</p>
<p>Some examples illustrating encryption and decryption over various
alphabets. Here is an example over the upper-case letters of the English
alphabet:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">());</span> <span class="n">S</span>
<span class="go">Shift cryptosystem on Free alphabetic string monoid on A-Z</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;The shift cryptosystem generalizes the Caesar cipher.&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span>
<span class="go">THESHIFTCRYPTOSYSTEMGENERALIZESTHECAESARCIPHER</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">P</span><span class="p">);</span> <span class="n">C</span>
<span class="go">AOLZOPMAJYFWAVZFZALTNLULYHSPGLZAOLJHLZHYJPWOLY</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">deciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
<span class="go">THESHIFTCRYPTOSYSTEMGENERALIZESTHECAESARCIPHER</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">deciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The previous example can also be done as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;The shift cryptosystem generalizes the Caesar cipher.&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="n">K</span><span class="p">);</span> <span class="n">E</span>
<span class="go">Shift cipher on Free alphabetic string monoid on A-Z</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">P</span><span class="p">);</span> <span class="n">C</span>
<span class="go">AOLZOPMAJYFWAVZFZALTNLULYHSPGLZAOLJHLZHYJPWOLY</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">inverse_key</span><span class="p">(</span><span class="n">K</span><span class="p">));</span> <span class="n">D</span>
<span class="go">Shift cipher on Free alphabetic string monoid on A-Z</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span> <span class="o">==</span> <span class="n">D</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="n">P</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Over the hexadecimal number system:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">HexadecimalStrings</span><span class="p">());</span> <span class="n">S</span>
<span class="go">Shift cryptosystem on Free hexadecimal string monoid</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Encryption &amp; decryption shifts along the alphabet.&quot;</span><span class="p">);</span> <span class="n">P</span>
<span class="go">456e6372797074696f6e20262064656372797074696f6e2073686966747320616c6f6e672074686520616c7068616265742e</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">P</span><span class="p">);</span> <span class="n">C</span>
<span class="go">9ab3b8c7cec5c9beb4b3757b75b9bab8c7cec5c9beb4b375c8bdbebbc9c875b6b1b4b3bc75c9bdba75b6b1c5bdb6b7bac973</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">deciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
<span class="go">456e6372797074696f6e20262064656372797074696f6e2073686966747320616c6f6e672074686520616c7068616265742e</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">deciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>And over the binary number system:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">BinaryStrings</span><span class="p">());</span> <span class="n">S</span>
<span class="go">Shift cryptosystem on Free binary string monoid</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;The binary alphabet is very insecure.&quot;</span><span class="p">);</span> <span class="n">P</span>
<span class="go">01010100011010000110010100100000011000100110100101101110011000010111001001111001001000000110000101101100011100000110100001100001011000100110010101110100001000000110100101110011001000000111011001100101011100100111100100100000011010010110111001110011011001010110001101110101011100100110010100101110</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">P</span><span class="p">);</span> <span class="n">C</span>
<span class="go">10101011100101111001101011011111100111011001011010010001100111101000110110000110110111111001111010010011100011111001011110011110100111011001101010001011110111111001011010001100110111111000100110011010100011011000011011011111100101101001000110001100100110101001110010001010100011011001101011010001</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">deciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
<span class="go">01010100011010000110010100100000011000100110100101101110011000010111001001111001001000000110000101101100011100000110100001100001011000100110010101110100001000000110100101110011001000000111011001100101011100100111100100100000011010010110111001110011011001010110001101110101011100100110010100101110</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">deciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A shift cryptosystem with key <span class="math">\(k = 3\)</span> is commonly referred to as the
Caesar cipher. Create a Caesar cipher over the upper-case letters of the
English alphabet:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">caesar</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">caesar</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;abcdef&quot;</span><span class="p">);</span> <span class="n">P</span>
<span class="go">ABCDEF</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">caesar</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">P</span><span class="p">);</span> <span class="n">C</span>
<span class="go">DEFGHI</span>
<span class="gp">sage: </span><span class="n">caesar</span><span class="o">.</span><span class="n">deciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Generate a random key for encryption and decryption:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Shift cipher with a random key.&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">deciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Decrypting with the key <code class="docutils literal"><span class="pre">K</span></code> is equivalent to encrypting with its
corresponding inverse key:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">inverse_key</span><span class="p">(</span><span class="n">K</span><span class="p">),</span> <span class="n">C</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Currently, the octal number system is not supported as an alphabet for
this shift cryptosystem:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">OctalStrings</span><span class="p">())</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">A (= Free octal string monoid) is not supported as a cipher domain of this shift cryptosystem.</span>
</pre></div>
</div>
<p>Nor is the radix-64 number system supported:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">Radix64Strings</span><span class="p">())</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">A (= Free radix 64 string monoid) is not supported as a cipher domain of this shift cryptosystem.</span>
</pre></div>
</div>
<p>Testing of dumping and loading objects:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">SA</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">SA</span> <span class="o">==</span> <span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">SA</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">SH</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">HexadecimalStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">SH</span> <span class="o">==</span> <span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">SH</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">SB</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">BinaryStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">SB</span> <span class="o">==</span> <span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">SB</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The key <code class="docutils literal"><span class="pre">K</span></code> must satisfy the inequality <span class="math">\(0 \leq K &lt; n\)</span> with <span class="math">\(n\)</span>
being the size of the plaintext, ciphertext, and key spaces. For the
shift cryptosystem, all these spaces are the same alphabet. This
inequality must be satisfied for each of the supported alphabets.
The capital letters of the English alphabet:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">S</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">S</span><span class="o">.</span><span class="n">alphabet_size</span><span class="p">())</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">K (=28) is outside the range of acceptable values for a key of this shift cryptosystem.</span>
<span class="gp">sage: </span><span class="n">S</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">K (=-2) is outside the range of acceptable values for a key of this shift cryptosystem.</span>
</pre></div>
</div>
<p>The hexadecimal number system:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">HexadecimalStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">S</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">S</span><span class="o">.</span><span class="n">alphabet_size</span><span class="p">())</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">K (=17) is outside the range of acceptable values for a key of this shift cryptosystem.</span>
<span class="gp">sage: </span><span class="n">S</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">K (=-1) is outside the range of acceptable values for a key of this shift cryptosystem.</span>
</pre></div>
</div>
<p>The binary number system:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">BinaryStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">S</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">S</span><span class="o">.</span><span class="n">alphabet_size</span><span class="p">())</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">K (=3) is outside the range of acceptable values for a key of this shift cryptosystem.</span>
<span class="gp">sage: </span><span class="n">S</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">K (=-2) is outside the range of acceptable values for a key of this shift cryptosystem.</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.crypto.classical.ShiftCryptosystem.brute_force">
<code class="descname">brute_force</code><span class="sig-paren">(</span><em>C</em>, <em>ranking='none'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.ShiftCryptosystem.brute_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempt a brute force cryptanalysis of the ciphertext <code class="docutils literal"><span class="pre">C</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">C</span></code> &#8211; A ciphertext over one of the supported alphabets of this
shift cryptosystem. See the class <a class="reference internal" href="#sage.crypto.classical.ShiftCryptosystem" title="sage.crypto.classical.ShiftCryptosystem"><code class="xref py py-class docutils literal"><span class="pre">ShiftCryptosystem</span></code></a> for
documentation on the supported alphabets.</li>
<li><code class="docutils literal"><span class="pre">ranking</span></code> &#8211; (default <code class="docutils literal"><span class="pre">&quot;none&quot;</span></code>) the method to use for
ranking all possible keys. If <code class="docutils literal"><span class="pre">ranking=&quot;none&quot;</span></code>, then do not
use any ranking function. The following ranking functions are
supported:<ul>
<li><code class="docutils literal"><span class="pre">&quot;chisquare&quot;</span></code> &#8211; the chi-square ranking function as
implemented in the method <a class="reference internal" href="#sage.crypto.classical.ShiftCryptosystem.rank_by_chi_square" title="sage.crypto.classical.ShiftCryptosystem.rank_by_chi_square"><code class="xref py py-func docutils literal"><span class="pre">rank_by_chi_square()</span></code></a>.</li>
<li><code class="docutils literal"><span class="pre">&quot;squared_differences&quot;</span></code> &#8211; the squared differences ranking
function as implemented in the method
<a class="reference internal" href="#sage.crypto.classical.ShiftCryptosystem.rank_by_squared_differences" title="sage.crypto.classical.ShiftCryptosystem.rank_by_squared_differences"><code class="xref py py-func docutils literal"><span class="pre">rank_by_squared_differences()</span></code></a>.</li>
</ul>
</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>All the possible plaintext sequences corresponding to the
ciphertext <code class="docutils literal"><span class="pre">C</span></code>. This method effectively uses all the possible
keys in this shift cryptosystem to decrypt <code class="docutils literal"><span class="pre">C</span></code>. The method is
also referred to as exhaustive key search. The output is
a dictionary of key, plaintext pairs.</li>
</ul>
<p>EXAMPLES:</p>
<p>Cryptanalyze using all possible keys for various alphabets. Over
the upper-case letters of the English alphabet:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;The shift cryptosystem generalizes the Caesar cipher.&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Dict</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">brute_force</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Dict</span><span class="p">)):</span>
<span class="go">....:     if Dict[k] == P:</span>
<span class="go">....:         print(&quot;key = &quot; + str(k))</span>
<span class="go">key = 7</span>
</pre></div>
</div>
<p>Over the hexadecimal number system:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">HexadecimalStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Encryption &amp; decryption shifts along the alphabet.&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Dict</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">brute_force</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Dict</span><span class="p">)):</span>
<span class="go">....:     if Dict[k] == P:</span>
<span class="go">....:         print(&quot;key = &quot; + str(k))</span>
<span class="go">key = 5</span>
</pre></div>
</div>
<p>And over the binary number system:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">BinaryStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;The binary alphabet is very insecure.&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Dict</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">brute_force</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Dict</span><span class="p">)):</span>
<span class="go">....:     if Dict[k] == P:</span>
<span class="go">....:         print(&quot;key = &quot; + str(k))</span>
<span class="go">key = 1</span>
</pre></div>
</div>
<p>Don&#8217;t use any ranking functions, i.e. <code class="docutils literal"><span class="pre">ranking=&quot;none&quot;</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Shifting using modular arithmetic.&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pdict</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">brute_force</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">pdict</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>

<span class="go">[(0, APQNBQVOCAQVOUWLCTIZIZQBPUMBQK),</span>
<span class="go">(1, ZOPMAPUNBZPUNTVKBSHYHYPAOTLAPJ),</span>
<span class="go">(2, YNOLZOTMAYOTMSUJARGXGXOZNSKZOI),</span>
<span class="go">(3, XMNKYNSLZXNSLRTIZQFWFWNYMRJYNH),</span>
<span class="go">(4, WLMJXMRKYWMRKQSHYPEVEVMXLQIXMG),</span>
<span class="go">(5, VKLIWLQJXVLQJPRGXODUDULWKPHWLF),</span>
<span class="go">(6, UJKHVKPIWUKPIOQFWNCTCTKVJOGVKE),</span>
<span class="go">(7, TIJGUJOHVTJOHNPEVMBSBSJUINFUJD),</span>
<span class="go">(8, SHIFTINGUSINGMODULARARITHMETIC),</span>
<span class="go">(9, RGHESHMFTRHMFLNCTKZQZQHSGLDSHB),</span>
<span class="go">(10, QFGDRGLESQGLEKMBSJYPYPGRFKCRGA),</span>
<span class="go">(11, PEFCQFKDRPFKDJLARIXOXOFQEJBQFZ),</span>
<span class="go">(12, ODEBPEJCQOEJCIKZQHWNWNEPDIAPEY),</span>
<span class="go">(13, NCDAODIBPNDIBHJYPGVMVMDOCHZODX),</span>
<span class="go">(14, MBCZNCHAOMCHAGIXOFULULCNBGYNCW),</span>
<span class="go">(15, LABYMBGZNLBGZFHWNETKTKBMAFXMBV),</span>
<span class="go">(16, KZAXLAFYMKAFYEGVMDSJSJALZEWLAU),</span>
<span class="go">(17, JYZWKZEXLJZEXDFULCRIRIZKYDVKZT),</span>
<span class="go">(18, IXYVJYDWKIYDWCETKBQHQHYJXCUJYS),</span>
<span class="go">(19, HWXUIXCVJHXCVBDSJAPGPGXIWBTIXR),</span>
<span class="go">(20, GVWTHWBUIGWBUACRIZOFOFWHVASHWQ),</span>
<span class="go">(21, FUVSGVATHFVATZBQHYNENEVGUZRGVP),</span>
<span class="go">(22, ETURFUZSGEUZSYAPGXMDMDUFTYQFUO),</span>
<span class="go">(23, DSTQETYRFDTYRXZOFWLCLCTESXPETN),</span>
<span class="go">(24, CRSPDSXQECSXQWYNEVKBKBSDRWODSM),</span>
<span class="go">(25, BQROCRWPDBRWPVXMDUJAJARCQVNCRL)]</span>
</pre></div>
</div>
<p>Use the chi-square ranking function, i.e. <code class="docutils literal"><span class="pre">ranking=&quot;chisquare&quot;</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">brute_force</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">ranking</span><span class="o">=</span><span class="s2">&quot;chisquare&quot;</span><span class="p">)</span>

<span class="go">[(8, SHIFTINGUSINGMODULARARITHMETIC),</span>
<span class="go">(14, MBCZNCHAOMCHAGIXOFULULCNBGYNCW),</span>
<span class="go">(20, GVWTHWBUIGWBUACRIZOFOFWHVASHWQ),</span>
<span class="go">(13, NCDAODIBPNDIBHJYPGVMVMDOCHZODX),</span>
<span class="go">(1, ZOPMAPUNBZPUNTVKBSHYHYPAOTLAPJ),</span>
<span class="go">(23, DSTQETYRFDTYRXZOFWLCLCTESXPETN),</span>
<span class="go">(10, QFGDRGLESQGLEKMBSJYPYPGRFKCRGA),</span>
<span class="go">(6, UJKHVKPIWUKPIOQFWNCTCTKVJOGVKE),</span>
<span class="go">(22, ETURFUZSGEUZSYAPGXMDMDUFTYQFUO),</span>
<span class="go">(15, LABYMBGZNLBGZFHWNETKTKBMAFXMBV),</span>
<span class="go">(12, ODEBPEJCQOEJCIKZQHWNWNEPDIAPEY),</span>
<span class="go">(21, FUVSGVATHFVATZBQHYNENEVGUZRGVP),</span>
<span class="go">(16, KZAXLAFYMKAFYEGVMDSJSJALZEWLAU),</span>
<span class="go">(25, BQROCRWPDBRWPVXMDUJAJARCQVNCRL),</span>
<span class="go">(9, RGHESHMFTRHMFLNCTKZQZQHSGLDSHB),</span>
<span class="go">(24, CRSPDSXQECSXQWYNEVKBKBSDRWODSM),</span>
<span class="go">(3, XMNKYNSLZXNSLRTIZQFWFWNYMRJYNH),</span>
<span class="go">(5, VKLIWLQJXVLQJPRGXODUDULWKPHWLF),</span>
<span class="go">(7, TIJGUJOHVTJOHNPEVMBSBSJUINFUJD),</span>
<span class="go">(2, YNOLZOTMAYOTMSUJARGXGXOZNSKZOI),</span>
<span class="go">(18, IXYVJYDWKIYDWCETKBQHQHYJXCUJYS),</span>
<span class="go">(4, WLMJXMRKYWMRKQSHYPEVEVMXLQIXMG),</span>
<span class="go">(11, PEFCQFKDRPFKDJLARIXOXOFQEJBQFZ),</span>
<span class="go">(19, HWXUIXCVJHXCVBDSJAPGPGXIWBTIXR),</span>
<span class="go">(0, APQNBQVOCAQVOUWLCTIZIZQBPUMBQK),</span>
<span class="go">(17, JYZWKZEXLJZEXDFULCRIRIZKYDVKZT)]</span>
</pre></div>
</div>
<p>Use the squared differences ranking function, i.e.
<code class="docutils literal"><span class="pre">ranking=&quot;squared_differences&quot;</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">brute_force</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">ranking</span><span class="o">=</span><span class="s2">&quot;squared_differences&quot;</span><span class="p">)</span>

<span class="go">[(8, SHIFTINGUSINGMODULARARITHMETIC),</span>
<span class="go">(23, DSTQETYRFDTYRXZOFWLCLCTESXPETN),</span>
<span class="go">(12, ODEBPEJCQOEJCIKZQHWNWNEPDIAPEY),</span>
<span class="go">(2, YNOLZOTMAYOTMSUJARGXGXOZNSKZOI),</span>
<span class="go">(9, RGHESHMFTRHMFLNCTKZQZQHSGLDSHB),</span>
<span class="go">(7, TIJGUJOHVTJOHNPEVMBSBSJUINFUJD),</span>
<span class="go">(21, FUVSGVATHFVATZBQHYNENEVGUZRGVP),</span>
<span class="go">(22, ETURFUZSGEUZSYAPGXMDMDUFTYQFUO),</span>
<span class="go">(1, ZOPMAPUNBZPUNTVKBSHYHYPAOTLAPJ),</span>
<span class="go">(16, KZAXLAFYMKAFYEGVMDSJSJALZEWLAU),</span>
<span class="go">(20, GVWTHWBUIGWBUACRIZOFOFWHVASHWQ),</span>
<span class="go">(24, CRSPDSXQECSXQWYNEVKBKBSDRWODSM),</span>
<span class="go">(14, MBCZNCHAOMCHAGIXOFULULCNBGYNCW),</span>
<span class="go">(13, NCDAODIBPNDIBHJYPGVMVMDOCHZODX),</span>
<span class="go">(3, XMNKYNSLZXNSLRTIZQFWFWNYMRJYNH),</span>
<span class="go">(10, QFGDRGLESQGLEKMBSJYPYPGRFKCRGA),</span>
<span class="go">(15, LABYMBGZNLBGZFHWNETKTKBMAFXMBV),</span>
<span class="go">(6, UJKHVKPIWUKPIOQFWNCTCTKVJOGVKE),</span>
<span class="go">(11, PEFCQFKDRPFKDJLARIXOXOFQEJBQFZ),</span>
<span class="go">(25, BQROCRWPDBRWPVXMDUJAJARCQVNCRL),</span>
<span class="go">(17, JYZWKZEXLJZEXDFULCRIRIZKYDVKZT),</span>
<span class="go">(19, HWXUIXCVJHXCVBDSJAPGPGXIWBTIXR),</span>
<span class="go">(4, WLMJXMRKYWMRKQSHYPEVEVMXLQIXMG),</span>
<span class="go">(0, APQNBQVOCAQVOUWLCTIZIZQBPUMBQK),</span>
<span class="go">(18, IXYVJYDWKIYDWCETKBQHQHYJXCUJYS),</span>
<span class="go">(5, VKLIWLQJXVLQJPRGXODUDULWKPHWLF)]</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Currently, the octal number system is not supported as an alphabet for
this shift cryptosystem:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">SA</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">OctStr</span> <span class="o">=</span> <span class="n">OctalStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">OctStr</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">SA</span><span class="o">.</span><span class="n">brute_force</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">ciphertext must be encoded using one of the supported cipher domains of this shift cryptosystem.</span>
</pre></div>
</div>
<p>Nor is the radix-64 alphabet supported:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Rad64</span> <span class="o">=</span> <span class="n">Radix64Strings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">Rad64</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">SA</span><span class="o">.</span><span class="n">brute_force</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">ciphertext must be encoded using one of the supported cipher domains of this shift cryptosystem.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.classical.ShiftCryptosystem.deciphering">
<code class="descname">deciphering</code><span class="sig-paren">(</span><em>K</em>, <em>C</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.ShiftCryptosystem.deciphering" title="Permalink to this definition">¶</a></dt>
<dd><p>Decrypt the ciphertext <code class="docutils literal"><span class="pre">C</span></code> with the key <code class="docutils literal"><span class="pre">K</span></code> using shift cipher
decryption.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">K</span></code> &#8211; a secret key; a key belonging to the key space of this
shift cipher. This key is an integer <span class="math">\(k\)</span> satisfying the inequality
<span class="math">\(0 \leq k &lt; n\)</span>, where <span class="math">\(n\)</span> is the size of the cipher domain.</li>
<li><code class="docutils literal"><span class="pre">C</span></code> &#8211; a string of ciphertext; possibly an empty string.
Characters in this string must be encoded using one of the
supported alphabets. See the method <a class="reference internal" href="#sage.crypto.classical.ShiftCryptosystem.encoding" title="sage.crypto.classical.ShiftCryptosystem.encoding"><code class="xref py py-func docutils literal"><span class="pre">encoding()</span></code></a>
for more information.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The plaintext corresponding to the ciphertext <code class="docutils literal"><span class="pre">C</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<p>Let&#8217;s perform decryption over the supported alphabets. Here is
decryption over the capital letters of the English alphabet:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Stop shifting me.&quot;</span><span class="p">);</span> <span class="n">P</span>
<span class="go">STOPSHIFTINGME</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="mi">13</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">P</span><span class="p">);</span> <span class="n">C</span>
<span class="go">FGBCFUVSGVATZR</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">deciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Decryption over the hexadecimal number system:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">HexadecimalStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Shift me now.&quot;</span><span class="p">);</span> <span class="n">P</span>
<span class="go">5368696674206d65206e6f772e</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">P</span><span class="p">);</span> <span class="n">C</span>
<span class="go">cadfd0ddeb97d4dc97d5d6ee95</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">deciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Decryption over the binary number system:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">BinaryStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;OK, enough shifting.&quot;</span><span class="p">);</span> <span class="n">P</span>
<span class="go">0100111101001011001011000010000001100101011011100110111101110101011001110110100000100000011100110110100001101001011001100111010001101001011011100110011100101110</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">P</span><span class="p">);</span> <span class="n">C</span>
<span class="go">1011000010110100110100111101111110011010100100011001000010001010100110001001011111011111100011001001011110010110100110011000101110010110100100011001100011010001</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">deciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.classical.ShiftCryptosystem.enciphering">
<code class="descname">enciphering</code><span class="sig-paren">(</span><em>K</em>, <em>P</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.ShiftCryptosystem.enciphering" title="Permalink to this definition">¶</a></dt>
<dd><p>Encrypt the plaintext <code class="docutils literal"><span class="pre">P</span></code> with the key <code class="docutils literal"><span class="pre">K</span></code> using shift cipher
encryption.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">K</span></code> &#8211; a key belonging to the key space of this shift cipher.
This key is an integer <span class="math">\(k\)</span> satisfying the inequality
<span class="math">\(0 \leq k &lt; n\)</span>, where <span class="math">\(n\)</span> is the size of the cipher domain.</li>
<li><code class="docutils literal"><span class="pre">P</span></code> &#8211; a string of plaintext; possibly an empty string.
Characters in this string must be encoded using one of the
supported alphabets. See the method <a class="reference internal" href="#sage.crypto.classical.ShiftCryptosystem.encoding" title="sage.crypto.classical.ShiftCryptosystem.encoding"><code class="xref py py-func docutils literal"><span class="pre">encoding()</span></code></a> for more
information.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The ciphertext corresponding to the plaintext <code class="docutils literal"><span class="pre">P</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<p>Let&#8217;s perform encryption over the supported alphabets. Here is
encryption over the capital letters of the English alphabet:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Shift your gear.&quot;</span><span class="p">);</span> <span class="n">P</span>
<span class="go">SHIFTYOURGEAR</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="go">VKLIWBRXUJHDU</span>
</pre></div>
</div>
<p>Encryption over the hexadecimal number system:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">HexadecimalStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Capitalize with the shift key.&quot;</span><span class="p">);</span> <span class="n">P</span>
<span class="go">4361706974616c697a65207769746820746865207368696674206b65792e</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="go">98b6c5bec9b6b1becfba75ccbec9bd75c9bdba75c8bdbebbc975b0bace73</span>
</pre></div>
</div>
<p>Encryption over the binary number system:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">BinaryStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Don&#39;t shift.&quot;</span><span class="p">);</span> <span class="n">P</span>
<span class="go">010001000110111101101110001001110111010000100000011100110110100001101001011001100111010000101110</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="go">101110111001000010010001110110001000101111011111100011001001011110010110100110011000101111010001</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.classical.ShiftCryptosystem.encoding">
<code class="descname">encoding</code><span class="sig-paren">(</span><em>S</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.ShiftCryptosystem.encoding" title="Permalink to this definition">¶</a></dt>
<dd><p>The encoding of the string <code class="docutils literal"><span class="pre">S</span></code> over the string monoid of this
shift cipher. For example, if the string monoid of this cryptosystem
is
<a class="reference external" href="../../../monoids/sage/monoids/string_monoid.html#sage.monoids.string_monoid.AlphabeticStringMonoid" title="(in Sage Reference Manual: Monoids v7.4)"><code class="xref py py-class docutils literal"><span class="pre">AlphabeticStringMonoid</span></code></a>,
then the encoding of <code class="docutils literal"><span class="pre">S</span></code> would be its upper-case equivalent
stripped of all non-alphabetic characters. The following alphabets
are supported for the shift cipher:</p>
<ul class="simple">
<li>capital letters of the English alphabet as implemented in
<a class="reference external" href="../../../monoids/sage/monoids/string_monoid.html#sage.monoids.string_monoid.AlphabeticStrings" title="(in Sage Reference Manual: Monoids v7.4)"><code class="xref py py-func docutils literal"><span class="pre">AlphabeticStrings()</span></code></a></li>
<li>the alphabet consisting of the hexadecimal number system as
implemented in
<a class="reference external" href="../../../monoids/sage/monoids/string_monoid.html#sage.monoids.string_monoid.HexadecimalStrings" title="(in Sage Reference Manual: Monoids v7.4)"><code class="xref py py-func docutils literal"><span class="pre">HexadecimalStrings()</span></code></a></li>
<li>the alphabet consisting of the binary number system as implemented in
<a class="reference external" href="../../../monoids/sage/monoids/string_monoid.html#sage.monoids.string_monoid.BinaryStrings" title="(in Sage Reference Manual: Monoids v7.4)"><code class="xref py py-func docutils literal"><span class="pre">BinaryStrings()</span></code></a></li>
</ul>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">S</span></code> &#8211; a string, possibly empty.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The encoding of <code class="docutils literal"><span class="pre">S</span></code> over the string monoid of this cryptosystem.
If <code class="docutils literal"><span class="pre">S</span></code> is an empty string, return an empty string.</li>
</ul>
<p>EXAMPLES:</p>
<p>Encoding over the upper-case letters of the English alphabet:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Shift cipher on capital letters of the English alphabet.&quot;</span><span class="p">)</span>
<span class="go">SHIFTCIPHERONCAPITALLETTERSOFTHEENGLISHALPHABET</span>
</pre></div>
</div>
<p>Encoding over the binary system:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">BinaryStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Binary&quot;</span><span class="p">)</span>
<span class="go">010000100110100101101110011000010111001001111001</span>
</pre></div>
</div>
<p>Encoding over the hexadecimal system:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">HexadecimalStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Over hexadecimal system.&quot;</span><span class="p">)</span>
<span class="go">4f7665722068657861646563696d616c2073797374656d2e</span>
</pre></div>
</div>
<p>The argument <code class="docutils literal"><span class="pre">S</span></code> can be an empty string, in which case an empty
string is returned:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">HexadecimalStrings</span><span class="p">())</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">BinaryStrings</span><span class="p">())</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.classical.ShiftCryptosystem.inverse_key">
<code class="descname">inverse_key</code><span class="sig-paren">(</span><em>K</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.ShiftCryptosystem.inverse_key" title="Permalink to this definition">¶</a></dt>
<dd><p>The inverse key corresponding to the key <code class="docutils literal"><span class="pre">K</span></code>. For the shift cipher,
the inverse key corresponding to <code class="docutils literal"><span class="pre">K</span></code> is <span class="math">\(-K \bmod n\)</span>, where
<span class="math">\(n &gt; 0\)</span> is the size of the cipher domain, i.e. the
plaintext/ciphertext space. A key <span class="math">\(k\)</span> of the shift cipher is an
integer <span class="math">\(0 \leq k &lt; n\)</span>. The key <span class="math">\(k = 0\)</span> has no effect on either the
plaintext or the ciphertext.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">K</span></code> &#8211; a key for this shift cipher. This must be an integer <span class="math">\(k\)</span>
such that <span class="math">\(0 \leq k &lt; n\)</span>, where <span class="math">\(n\)</span> is the size of the cipher domain.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The inverse key corresponding to <code class="docutils literal"><span class="pre">K</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<p>Some random keys and their respective inverse keys:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">key</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">random_key</span><span class="p">();</span> <span class="n">key</span>  <span class="c1"># random</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">inverse_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>         <span class="c1"># random</span>
<span class="go">24</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">HexadecimalStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">key</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">random_key</span><span class="p">();</span> <span class="n">key</span>  <span class="c1"># random</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">inverse_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>         <span class="c1"># random</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">BinaryStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">key</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">random_key</span><span class="p">();</span> <span class="n">key</span>  <span class="c1"># random</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">inverse_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>         <span class="c1"># random</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">key</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">random_key</span><span class="p">();</span> <span class="n">key</span>  <span class="c1"># random</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">inverse_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>         <span class="c1"># random</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Regardless of the value of a key, the addition of the key and its
inverse must be equal to the alphabet size. This relationship holds
exactly when the value of the key is non-zero:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">while</span> <span class="n">K</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="gp">... </span>      <span class="n">K</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">...</span>
<span class="gp">sage: </span><span class="n">invK</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">inverse_key</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">+</span> <span class="n">invK</span> <span class="o">==</span> <span class="n">S</span><span class="o">.</span><span class="n">alphabet_size</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">invK</span> <span class="o">+</span> <span class="n">K</span> <span class="o">==</span> <span class="n">S</span><span class="o">.</span><span class="n">alphabet_size</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">while</span> <span class="n">K</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<span class="gp">... </span>      <span class="n">K</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">...</span>
<span class="gp">sage: </span><span class="n">invK</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">inverse_key</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">+</span> <span class="n">invK</span> <span class="o">!=</span> <span class="n">S</span><span class="o">.</span><span class="n">alphabet_size</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">;</span> <span class="n">invK</span>
<span class="go">0</span>
<span class="go">0</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>The key <code class="docutils literal"><span class="pre">K</span></code> must satisfy the inequality <span class="math">\(0 \leq K &lt; n\)</span> with <span class="math">\(n\)</span>
being the size of the plaintext, ciphertext, and key spaces. For the
shift cryptosystem, all these spaces are the same alphabet. This
inequality must be satisfied for each of the supported alphabets.
The capital letters of the English alphabet:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">inverse_key</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">alphabet_size</span><span class="p">())</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">K (=26) is outside the range of acceptable values for a key of this shift cryptosystem.</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">inverse_key</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">K (=-1) is outside the range of acceptable values for a key of this shift cryptosystem.</span>
</pre></div>
</div>
<p>The hexadecimal number system:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">HexadecimalStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">inverse_key</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">alphabet_size</span><span class="p">())</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">K (=16) is outside the range of acceptable values for a key of this shift cryptosystem.</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">inverse_key</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">K (=-1) is outside the range of acceptable values for a key of this shift cryptosystem.</span>
</pre></div>
</div>
<p>The binary number system:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">BinaryStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">inverse_key</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">alphabet_size</span><span class="p">())</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">K (=2) is outside the range of acceptable values for a key of this shift cryptosystem.</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">inverse_key</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">K (=-1) is outside the range of acceptable values for a key of this shift cryptosystem.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.classical.ShiftCryptosystem.random_key">
<code class="descname">random_key</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.ShiftCryptosystem.random_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a random key within the key space of this shift cipher.
The generated key is an integer <span class="math">\(0 \leq k &lt; n\)</span> with <span class="math">\(n\)</span> being the
size of the cipher domain. Thus there are <span class="math">\(n\)</span> possible keys in the
key space, which is the set <span class="math">\(\ZZ / n\ZZ\)</span>. The key <span class="math">\(k = 0\)</span> has no
effect on either the plaintext or the ciphertext.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>A random key within the key space of this shift cryptosystem.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>  <span class="c1"># random</span>
<span class="go">18</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">BinaryStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>  <span class="c1"># random</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">HexadecimalStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>  <span class="c1"># random</span>
<span class="go">5</span>
</pre></div>
</div>
<p>Regardless of the value of a key, the addition of the key and its
inverse must be equal to the alphabet size. This relationship holds
exactly when the value of the key is non-zero:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">while</span> <span class="n">K</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="gp">... </span>      <span class="n">K</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">...</span>
<span class="gp">sage: </span><span class="n">invK</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">inverse_key</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">+</span> <span class="n">invK</span> <span class="o">==</span> <span class="n">S</span><span class="o">.</span><span class="n">alphabet_size</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">invK</span> <span class="o">+</span> <span class="n">K</span> <span class="o">==</span> <span class="n">S</span><span class="o">.</span><span class="n">alphabet_size</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">while</span> <span class="n">K</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<span class="gp">... </span>      <span class="n">K</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">...</span>
<span class="gp">sage: </span><span class="n">invK</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">inverse_key</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">+</span> <span class="n">invK</span> <span class="o">!=</span> <span class="n">S</span><span class="o">.</span><span class="n">alphabet_size</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">;</span> <span class="n">invK</span>
<span class="go">0</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.classical.ShiftCryptosystem.rank_by_chi_square">
<code class="descname">rank_by_chi_square</code><span class="sig-paren">(</span><em>C</em>, <em>pdict</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.ShiftCryptosystem.rank_by_chi_square" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the chi-square statistic to rank all possible keys. Currently,
this method only applies to the capital letters of the English
alphabet.</p>
<p>ALGORITHM:</p>
<p>Consider a non-empty alphabet <span class="math">\(A\)</span> consisting of <span class="math">\(n\)</span>
elements, and let <span class="math">\(C\)</span> be a ciphertext encoded using elements of
<span class="math">\(A\)</span>. The plaintext <span class="math">\(P\)</span> corresponding to <span class="math">\(C\)</span> is also encoded using
elements of <span class="math">\(A\)</span>. Let <span class="math">\(M\)</span> be a candidate decipherment of <span class="math">\(C\)</span>,
i.e. <span class="math">\(M\)</span> is the result of attempting to decrypt <span class="math">\(C\)</span> using a key
<span class="math">\(k \in \ZZ/n\ZZ\)</span> which is not necessarily the same key used to
encrypt <span class="math">\(P\)</span>. Suppose <span class="math">\(F_A(e)\)</span> is the characteristic frequency
probability of <span class="math">\(e \in A\)</span> and let <span class="math">\(F_M(e)\)</span> be the message frequency
probability with respect to <span class="math">\(M\)</span>. The characteristic frequency
probability distribution of an alphabet is the expected frequency
probability distribution for that alphabet. The message frequency
probability distribution of <span class="math">\(M\)</span> provides a distribution of the ratio
of character occurrences over message length. One can interpret the
characteristic frequency probability <span class="math">\(F_A(e)\)</span> as the expected
probability, while the message frequency probability <span class="math">\(F_M(e)\)</span> is
the observed probability. If <span class="math">\(M\)</span> is of length <span class="math">\(L\)</span>, then the observed
frequency of <span class="math">\(e \in A\)</span> is</p>
<div class="math">
\[O_M(e)
=
F_M(e) \cdot L\]</div>
<p>and the expected frequency of <span class="math">\(e \in A\)</span> is</p>
<div class="math">
\[E_A(e)
=
F_A(e) \cdot L\]</div>
<p>The chi-square rank <span class="math">\(R_{\chi^2}(M)\)</span> of <span class="math">\(M\)</span> corresponding to a key
<span class="math">\(k \in \ZZ/n\ZZ\)</span> is given by</p>
<div class="math">
\[R_{\chi^2}(M)
=
\sum_{e \in A} \frac {\big( O_M(e) - E_A(e) \big)^2}
                     {E_A(e)}\]</div>
<p>Cryptanalysis by exhaustive key search produces a candidate
decipherment <span class="math">\(M_{k}\)</span> for each possible key <span class="math">\(k \in \ZZ/n\ZZ\)</span>. For
a set
<span class="math">\(D = \big\{M_{k_1}, M_{k_2}, \dots, M_{k_r} \big\}\)</span>
of all candidate decipherments corresponding to a ciphertext <span class="math">\(C\)</span>,
the smaller is the rank <span class="math">\(R_{\chi^2}(M_{k_i})\)</span> the more likely
that <span class="math">\(k_i\)</span> is the secret key. This key ranking method is based on
the Pearson chi-square test <a class="reference internal" href="#pearsontest09" id="id4">[PearsonTest09]</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">C</span></code> &#8211; The ciphertext, a non-empty string. The ciphertext
must be encoded using the upper-case letters of the English
alphabet.</li>
<li><code class="docutils literal"><span class="pre">pdict</span></code> &#8211; A dictionary of key, possible plaintext pairs.
This should be the output of <a class="reference internal" href="#sage.crypto.classical.ShiftCryptosystem.brute_force" title="sage.crypto.classical.ShiftCryptosystem.brute_force"><code class="xref py py-func docutils literal"><span class="pre">brute_force()</span></code></a> with
<code class="docutils literal"><span class="pre">ranking=&quot;none&quot;</span></code>.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>A list ranking the most likely keys first. Each element of the
list is a tuple of key, possible plaintext pairs.</li>
</ul>
<p>EXAMPLES:</p>
<p>Use the chi-square statistic to rank all possible keys and their
corresponding decipherment:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Shi.&quot;</span><span class="p">);</span> <span class="n">P</span>
<span class="go">SHI</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Pdict</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">brute_force</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">rank_by_chi_square</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">Pdict</span><span class="p">)</span>

<span class="go">[(9, ODE),</span>
<span class="go">(5, SHI),</span>
<span class="go">(20, DST),</span>
<span class="go">(19, ETU),</span>
<span class="go">(21, CRS),</span>
<span class="go">(10, NCD),</span>
<span class="go">(25, YNO),</span>
<span class="go">(6, RGH),</span>
<span class="go">(12, LAB),</span>
<span class="go">(8, PEF),</span>
<span class="go">(1, WLM),</span>
<span class="go">(11, MBC),</span>
<span class="go">(18, FUV),</span>
<span class="go">(17, GVW),</span>
<span class="go">(2, VKL),</span>
<span class="go">(4, TIJ),</span>
<span class="go">(3, UJK),</span>
<span class="go">(0, XMN),</span>
<span class="go">(16, HWX),</span>
<span class="go">(15, IXY),</span>
<span class="go">(23, APQ),</span>
<span class="go">(24, ZOP),</span>
<span class="go">(22, BQR),</span>
<span class="go">(7, QFG),</span>
<span class="go">(13, KZA),</span>
<span class="go">(14, JYZ)]</span>
</pre></div>
</div>
<p>As more ciphertext is available, the reliability of the chi-square
ranking function increases:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Shift cipher.&quot;</span><span class="p">);</span> <span class="n">P</span>
<span class="go">SHIFTCIPHER</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Pdict</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">brute_force</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">rank_by_chi_square</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">Pdict</span><span class="p">)</span>

<span class="go">[(5, SHIFTCIPHER),</span>
<span class="go">(9, ODEBPYELDAN),</span>
<span class="go">(18, FUVSGPVCURE),</span>
<span class="go">(2, VKLIWFLSKHU),</span>
<span class="go">(20, DSTQENTASPC),</span>
<span class="go">(19, ETURFOUBTQD),</span>
<span class="go">(21, CRSPDMSZROB),</span>
<span class="go">(6, RGHESBHOGDQ),</span>
<span class="go">(7, QFGDRAGNFCP),</span>
<span class="go">(12, LABYMVBIAXK),</span>
<span class="go">(17, GVWTHQWDVSF),</span>
<span class="go">(24, ZOPMAJPWOLY),</span>
<span class="go">(1, WLMJXGMTLIV),</span>
<span class="go">(0, XMNKYHNUMJW),</span>
<span class="go">(11, MBCZNWCJBYL),</span>
<span class="go">(8, PEFCQZFMEBO),</span>
<span class="go">(25, YNOLZIOVNKX),</span>
<span class="go">(10, NCDAOXDKCZM),</span>
<span class="go">(3, UJKHVEKRJGT),</span>
<span class="go">(4, TIJGUDJQIFS),</span>
<span class="go">(22, BQROCLRYQNA),</span>
<span class="go">(16, HWXUIRXEWTG),</span>
<span class="go">(15, IXYVJSYFXUH),</span>
<span class="go">(14, JYZWKTZGYVI),</span>
<span class="go">(13, KZAXLUAHZWJ),</span>
<span class="go">(23, APQNBKQXPMZ)]</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>The ciphertext cannot be an empty string:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">rank_by_chi_square</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">Pdict</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">&#39;str&#39; object has no attribute &#39;parent&#39;</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">rank_by_chi_square</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="n">Pdict</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The ciphertext must be a non-empty string.</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">rank_by_chi_square</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">),</span> <span class="n">Pdict</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The ciphertext must be a non-empty string.</span>
</pre></div>
</div>
<p>The ciphertext must be encoded using the capital letters of the
English alphabet as implemented in
<a class="reference external" href="../../../monoids/sage/monoids/string_monoid.html#sage.monoids.string_monoid.AlphabeticStrings" title="(in Sage Reference Manual: Monoids v7.4)"><code class="xref py py-func docutils literal"><span class="pre">AlphabeticStrings()</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">HexadecimalStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">rank_by_chi_square</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;shift&quot;</span><span class="p">),</span> <span class="n">Pdict</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">The ciphertext must be capital letters of the English alphabet.</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">BinaryStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">rank_by_chi_square</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;shift&quot;</span><span class="p">),</span> <span class="n">Pdict</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">The ciphertext must be capital letters of the English alphabet.</span>
</pre></div>
</div>
<p>The dictionary <code class="docutils literal"><span class="pre">pdict</span></code> cannot be empty:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">rank_by_chi_square</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="p">{})</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">KeyError</span>: <span class="n">0</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="pearsontest09" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[PearsonTest09]</td><td><em>(<a class="fn-backref" href="#id2">1</a>, <a class="fn-backref" href="#id4">2</a>)</em> <a class="reference external" href="http://en.wikipedia.org/wiki/Goodness_of_fit">Pearson chi-square test</a>. Wikipedia,
accessed 13th October 2009.</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.classical.ShiftCryptosystem.rank_by_squared_differences">
<code class="descname">rank_by_squared_differences</code><span class="sig-paren">(</span><em>C</em>, <em>pdict</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.ShiftCryptosystem.rank_by_squared_differences" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the squared-differences measure to rank all possible keys.
Currently, this method only applies to the capital letters of
the English alphabet.</p>
<p>ALGORITHM:</p>
<p>Consider a non-empty alphabet <span class="math">\(A\)</span> consisting of <span class="math">\(n\)</span>
elements, and let <span class="math">\(C\)</span> be a ciphertext encoded using elements of
<span class="math">\(A\)</span>. The plaintext <span class="math">\(P\)</span> corresponding to <span class="math">\(C\)</span> is also encoded using
elements of <span class="math">\(A\)</span>. Let <span class="math">\(M\)</span> be a candidate decipherment of <span class="math">\(C\)</span>,
i.e. <span class="math">\(M\)</span> is the result of attempting to decrypt <span class="math">\(C\)</span> using a key
<span class="math">\(k \in \ZZ/n\ZZ\)</span> which is not necessarily the same key used to
encrypt <span class="math">\(P\)</span>. Suppose <span class="math">\(F_A(e)\)</span> is the characteristic frequency
probability of <span class="math">\(e \in A\)</span> and let <span class="math">\(F_M(e)\)</span> be the message
frequency probability with respect to <span class="math">\(M\)</span>. The characteristic
frequency probability distribution of an alphabet is the expected
frequency probability distribution for that alphabet. The message
frequency probability distribution of <span class="math">\(M\)</span> provides a distribution
of the ratio of character occurrences over message length. One can
interpret the characteristic frequency probability <span class="math">\(F_A(e)\)</span> as the
expected probability, while the message frequency probability
<span class="math">\(F_M(e)\)</span> is the observed probability. If <span class="math">\(M\)</span> is of length <span class="math">\(L\)</span>, then
the observed frequency of <span class="math">\(e \in A\)</span> is</p>
<div class="math">
\[O_M(e)
=
F_M(e) \cdot L\]</div>
<p>and the expected frequency of <span class="math">\(e \in A\)</span> is</p>
<div class="math">
\[E_A(e)
=
F_A(e) \cdot L\]</div>
<p>The squared-differences, or residual sum of squares, rank
<span class="math">\(R_{RSS}(M)\)</span> of <span class="math">\(M\)</span> corresponding to a key
<span class="math">\(k \in \ZZ/n\ZZ\)</span> is given by</p>
<div class="math">
\[R_{RSS}(M)
=
\sum_{e \in A} \big( O_M(e) - E_A(e) \big)^2\]</div>
<p>Cryptanalysis by exhaustive key search produces a candidate
decipherment <span class="math">\(M_{k}\)</span> for each possible key <span class="math">\(k \in \ZZ/n\ZZ\)</span>. For
a set
<span class="math">\(D = \big\{M_{k_1}, M_{k_2}, \dots, M_{k_r} \big\}\)</span>
of all candidate decipherments corresponding to a ciphertext <span class="math">\(C\)</span>,
the smaller is the rank <span class="math">\(R_{RSS}(M_{k_i})\)</span> the more likely
that <span class="math">\(k_i\)</span> is the secret key. This key ranking method is based
on the residual sum of squares measure <a class="reference internal" href="#rss09" id="id5">[RSS09]</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">C</span></code> &#8211; The ciphertext, a non-empty string. The ciphertext
must be encoded using the upper-case letters of the English
alphabet.</li>
<li><code class="docutils literal"><span class="pre">pdict</span></code> &#8211; A dictionary of key, possible plaintext pairs.
This should be the output of <a class="reference internal" href="#sage.crypto.classical.ShiftCryptosystem.brute_force" title="sage.crypto.classical.ShiftCryptosystem.brute_force"><code class="xref py py-func docutils literal"><span class="pre">brute_force()</span></code></a> with
<code class="docutils literal"><span class="pre">ranking=&quot;none&quot;</span></code>.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>A list ranking the most likely keys first. Each element of the
list is a tuple of key, possible plaintext pairs.</li>
</ul>
<p>EXAMPLES:</p>
<p>Use the method of squared differences to rank all possible keys
and their corresponding decipherment:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">ShiftCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Shi.&quot;</span><span class="p">);</span> <span class="n">P</span>
<span class="go">SHI</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Pdict</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">brute_force</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">rank_by_squared_differences</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">Pdict</span><span class="p">)</span>

<span class="go">[(19, ETU),</span>
<span class="go">(9, ODE),</span>
<span class="go">(20, DST),</span>
<span class="go">(5, SHI),</span>
<span class="go">(8, PEF),</span>
<span class="go">(4, TIJ),</span>
<span class="go">(25, YNO),</span>
<span class="go">(21, CRS),</span>
<span class="go">(6, RGH),</span>
<span class="go">(10, NCD),</span>
<span class="go">(12, LAB),</span>
<span class="go">(23, APQ),</span>
<span class="go">(24, ZOP),</span>
<span class="go">(0, XMN),</span>
<span class="go">(13, KZA),</span>
<span class="go">(15, IXY),</span>
<span class="go">(1, WLM),</span>
<span class="go">(16, HWX),</span>
<span class="go">(22, BQR),</span>
<span class="go">(11, MBC),</span>
<span class="go">(18, FUV),</span>
<span class="go">(2, VKL),</span>
<span class="go">(17, GVW),</span>
<span class="go">(7, QFG),</span>
<span class="go">(3, UJK),</span>
<span class="go">(14, JYZ)]</span>
</pre></div>
</div>
<p>As more ciphertext is available, the reliability of the squared
differences ranking function increases:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Shift cipher.&quot;</span><span class="p">);</span> <span class="n">P</span>
<span class="go">SHIFTCIPHER</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Pdict</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">brute_force</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">rank_by_squared_differences</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">Pdict</span><span class="p">)</span>

<span class="go">[(20, DSTQENTASPC),</span>
<span class="go">(5, SHIFTCIPHER),</span>
<span class="go">(9, ODEBPYELDAN),</span>
<span class="go">(19, ETURFOUBTQD),</span>
<span class="go">(6, RGHESBHOGDQ),</span>
<span class="go">(16, HWXUIRXEWTG),</span>
<span class="go">(8, PEFCQZFMEBO),</span>
<span class="go">(21, CRSPDMSZROB),</span>
<span class="go">(22, BQROCLRYQNA),</span>
<span class="go">(25, YNOLZIOVNKX),</span>
<span class="go">(3, UJKHVEKRJGT),</span>
<span class="go">(18, FUVSGPVCURE),</span>
<span class="go">(4, TIJGUDJQIFS),</span>
<span class="go">(10, NCDAOXDKCZM),</span>
<span class="go">(7, QFGDRAGNFCP),</span>
<span class="go">(24, ZOPMAJPWOLY),</span>
<span class="go">(2, VKLIWFLSKHU),</span>
<span class="go">(12, LABYMVBIAXK),</span>
<span class="go">(17, GVWTHQWDVSF),</span>
<span class="go">(1, WLMJXGMTLIV),</span>
<span class="go">(13, KZAXLUAHZWJ),</span>
<span class="go">(0, XMNKYHNUMJW),</span>
<span class="go">(15, IXYVJSYFXUH),</span>
<span class="go">(14, JYZWKTZGYVI),</span>
<span class="go">(11, MBCZNWCJBYL),</span>
<span class="go">(23, APQNBKQXPMZ)]</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>The ciphertext cannot be an empty string:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">rank_by_squared_differences</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">Pdict</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">&#39;str&#39; object has no attribute &#39;parent&#39;</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">rank_by_squared_differences</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="n">Pdict</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The ciphertext must be a non-empty string.</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">rank_by_squared_differences</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">),</span> <span class="n">Pdict</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The ciphertext must be a non-empty string.</span>
</pre></div>
</div>
<p>The ciphertext must be encoded using the capital letters of the
English alphabet as implemented in
<a class="reference external" href="../../../monoids/sage/monoids/string_monoid.html#sage.monoids.string_monoid.AlphabeticStrings" title="(in Sage Reference Manual: Monoids v7.4)"><code class="xref py py-func docutils literal"><span class="pre">AlphabeticStrings()</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">HexadecimalStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">rank_by_squared_differences</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;shift&quot;</span><span class="p">),</span> <span class="n">Pdict</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">The ciphertext must be capital letters of the English alphabet.</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">BinaryStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">rank_by_squared_differences</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;shift&quot;</span><span class="p">),</span> <span class="n">Pdict</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">The ciphertext must be capital letters of the English alphabet.</span>
</pre></div>
</div>
<p>The dictionary <code class="docutils literal"><span class="pre">pdict</span></code> cannot be empty:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">rank_by_squared_differences</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="p">{})</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">KeyError</span>: <span class="n">0</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="rss09" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[RSS09]</td><td><em>(<a class="fn-backref" href="#id3">1</a>, <a class="fn-backref" href="#id5">2</a>)</em> <a class="reference external" href="http://en.wikipedia.org/wiki/Residual_sum_of_squares">Residual sum of squares</a>.
Wikipedia, accessed 13th October 2009.</td></tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.crypto.classical.SubstitutionCryptosystem">
<em class="property">class </em><code class="descclassname">sage.crypto.classical.</code><code class="descname">SubstitutionCryptosystem</code><span class="sig-paren">(</span><em>S</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.SubstitutionCryptosystem" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="cryptosystem.html#sage.crypto.cryptosystem.SymmetricKeyCryptosystem" title="sage.crypto.cryptosystem.SymmetricKeyCryptosystem"><code class="xref py py-class docutils literal"><span class="pre">sage.crypto.cryptosystem.SymmetricKeyCryptosystem</span></code></a></p>
<p>Create a substitution cryptosystem.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">S</span></code> - a string monoid over some alphabet</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>A substitution cryptosystem over the alphabet <code class="docutils literal"><span class="pre">S</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">AlphabeticStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">SubstitutionCryptosystem</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span>
<span class="go">Substitution cryptosystem on Free alphabetic string monoid on A-Z</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">M</span><span class="p">([</span> <span class="mi">25</span><span class="o">-</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span> <span class="p">])</span>
<span class="gp">sage: </span><span class="n">K</span>
<span class="go">ZYXWVUTSRQPONMLKJIHGFEDCBA</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">M</span><span class="p">(</span><span class="s2">&quot;THECATINTHEHAT&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="go">GSVXZGRMGSVSZG</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">AlphabeticStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">SubstitutionCryptosystem</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">==</span> <span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">E</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.crypto.classical.SubstitutionCryptosystem.deciphering">
<code class="descname">deciphering</code><span class="sig-paren">(</span><em>K</em>, <em>C</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.SubstitutionCryptosystem.deciphering" title="Permalink to this definition">¶</a></dt>
<dd><p>Decrypt the ciphertext <code class="docutils literal"><span class="pre">C</span></code> using the key <code class="docutils literal"><span class="pre">K</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">K</span></code> - a key belonging to the key space of this substitution cipher</li>
<li><code class="docutils literal"><span class="pre">C</span></code> - a string (possibly empty) over the string monoid of this
cryptosystem.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The plaintext corresponding to the ciphertext <code class="docutils literal"><span class="pre">C</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">SubstitutionCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Don&#39;t substitute me!&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">deciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">M</span><span class="p">))</span> <span class="o">==</span> <span class="n">M</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.classical.SubstitutionCryptosystem.enciphering">
<code class="descname">enciphering</code><span class="sig-paren">(</span><em>K</em>, <em>M</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.SubstitutionCryptosystem.enciphering" title="Permalink to this definition">¶</a></dt>
<dd><p>Encrypt the plaintext <code class="docutils literal"><span class="pre">M</span></code> using the key <code class="docutils literal"><span class="pre">K</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">K</span></code> - a key belonging to the key space of this substitution cipher</li>
<li><code class="docutils literal"><span class="pre">M</span></code> - a string (possibly empty) over the string monoid of this
cryptosystem.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The ciphertext corresponding to the plaintext <code class="docutils literal"><span class="pre">M</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">SubstitutionCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Don&#39;t substitute me.&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">deciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">M</span><span class="p">))</span> <span class="o">==</span> <span class="n">M</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.classical.SubstitutionCryptosystem.encoding">
<code class="descname">encoding</code><span class="sig-paren">(</span><em>M</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.SubstitutionCryptosystem.encoding" title="Permalink to this definition">¶</a></dt>
<dd><p>The encoding of the string <code class="docutils literal"><span class="pre">M</span></code> over the string monoid of this
substitution cipher. For example, if the string monoid of this
cryptosystem is <code class="xref py py-class docutils literal"><span class="pre">AlphabeticStringMonoid</span></code>, then the encoding
of <code class="docutils literal"><span class="pre">M</span></code> would be its upper-case equivalent stripped of all
non-alphabetic characters.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">M</span></code> - a string, possibly empty</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The encoding of <code class="docutils literal"><span class="pre">M</span></code> over the string monoid of this cryptosystem.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="s2">&quot;Peter Pan(ning) for gold.&quot;</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AlphabeticStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">SubstitutionCryptosystem</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">==</span> <span class="n">A</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.classical.SubstitutionCryptosystem.inverse_key">
<code class="descname">inverse_key</code><span class="sig-paren">(</span><em>K</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.SubstitutionCryptosystem.inverse_key" title="Permalink to this definition">¶</a></dt>
<dd><p>The inverse key corresponding to the key <code class="docutils literal"><span class="pre">K</span></code>. The specified key is a
permutation of the cryptosystem alphabet.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">K</span></code> - a key belonging to the key space of this cryptosystem</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The inverse key of <code class="docutils literal"><span class="pre">K</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">AlphabeticStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">SubstitutionCryptosystem</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">inverse_key</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="s2">&quot;THECATINTHEHAT&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span><span class="p">(</span><span class="n">e</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
<span class="go">THECATINTHEHAT</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.classical.SubstitutionCryptosystem.random_key">
<code class="descname">random_key</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.SubstitutionCryptosystem.random_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a random key within the key space of this substitution
cipher. The generated key is a permutation of the cryptosystem
alphabet. Let <span class="math">\(n\)</span> be the length of the alphabet. Then there are
<span class="math">\(n!\)</span> possible keys in the key space.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>A random key within the key space of this cryptosystem.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AlphabeticStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">SubstitutionCryptosystem</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Ki</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">inverse_key</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="s2">&quot;THECATINTHEHAT&quot;</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="n">Ki</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span><span class="p">(</span><span class="n">e</span><span class="p">(</span><span class="n">A</span><span class="p">(</span><span class="n">M</span><span class="p">)))</span> <span class="o">==</span> <span class="n">A</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.crypto.classical.TranspositionCryptosystem">
<em class="property">class </em><code class="descclassname">sage.crypto.classical.</code><code class="descname">TranspositionCryptosystem</code><span class="sig-paren">(</span><em>S</em>, <em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.TranspositionCryptosystem" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="cryptosystem.html#sage.crypto.cryptosystem.SymmetricKeyCryptosystem" title="sage.crypto.cryptosystem.SymmetricKeyCryptosystem"><code class="xref py py-class docutils literal"><span class="pre">sage.crypto.cryptosystem.SymmetricKeyCryptosystem</span></code></a></p>
<p>Create a transposition cryptosystem of block length <code class="docutils literal"><span class="pre">n</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">S</span></code> - a string monoid over some alphabet</li>
<li><code class="docutils literal"><span class="pre">n</span></code> - integer <span class="math">\(&gt; 0\)</span>; a block length of a block permutation</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>A transposition cryptosystem of block length <code class="docutils literal"><span class="pre">n</span></code> over the
alphabet <code class="docutils literal"><span class="pre">S</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">AlphabeticStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">TranspositionCryptosystem</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span>
<span class="go">Transposition cryptosystem on Free alphabetic string monoid on A-Z of block length 14</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">14</span><span class="o">-</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span> <span class="p">]</span>
<span class="gp">sage: </span><span class="n">K</span>
<span class="go">[14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1]</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="s2">&quot;THECATINTHEHAT&quot;</span><span class="p">))</span>
<span class="go">TAHEHTNITACEHT</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">AlphabeticStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">TranspositionCryptosystem</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">==</span> <span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">E</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.crypto.classical.TranspositionCryptosystem.deciphering">
<code class="descname">deciphering</code><span class="sig-paren">(</span><em>K</em>, <em>C</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.TranspositionCryptosystem.deciphering" title="Permalink to this definition">¶</a></dt>
<dd><p>Decrypt the ciphertext <code class="docutils literal"><span class="pre">C</span></code> using the key <code class="docutils literal"><span class="pre">K</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">K</span></code> - a key belonging to the key space of this transposition
cipher</li>
<li><code class="docutils literal"><span class="pre">C</span></code> - a string (possibly empty) over the string monoid of this
cryptosystem.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The plaintext corresponding to the ciphertext <code class="docutils literal"><span class="pre">C</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">TranspositionCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">(),</span> <span class="mi">14</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;The cat in the hat.&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">deciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">M</span><span class="p">))</span> <span class="o">==</span> <span class="n">M</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.classical.TranspositionCryptosystem.enciphering">
<code class="descname">enciphering</code><span class="sig-paren">(</span><em>K</em>, <em>M</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.TranspositionCryptosystem.enciphering" title="Permalink to this definition">¶</a></dt>
<dd><p>Encrypt the plaintext <code class="docutils literal"><span class="pre">M</span></code> using the key <code class="docutils literal"><span class="pre">K</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">K</span></code> - a key belonging to the key space of this transposition
cipher</li>
<li><code class="docutils literal"><span class="pre">M</span></code> - a string (possibly empty) over the string monoid of this
cryptosystem</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The ciphertext corresponding to the plaintext <code class="docutils literal"><span class="pre">M</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">TranspositionCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">(),</span> <span class="mi">14</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;The cat in the hat.&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">deciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">M</span><span class="p">))</span> <span class="o">==</span> <span class="n">M</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.classical.TranspositionCryptosystem.encoding">
<code class="descname">encoding</code><span class="sig-paren">(</span><em>M</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.TranspositionCryptosystem.encoding" title="Permalink to this definition">¶</a></dt>
<dd><p>The encoding of the string <code class="docutils literal"><span class="pre">M</span></code> over the string monoid of this
transposition cipher. For example, if the string monoid of this
cryptosystem is <code class="xref py py-class docutils literal"><span class="pre">AlphabeticStringMonoid</span></code>, then the encoding
of <code class="docutils literal"><span class="pre">M</span></code> would be its upper-case equivalent stripped of all
non-alphabetic characters.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">M</span></code> - a string, possibly empty</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The encoding of <code class="docutils literal"><span class="pre">M</span></code> over the string monoid of this cryptosystem.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="s2">&quot;Transposition cipher is not about matrix transpose.&quot;</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AlphabeticStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">TranspositionCryptosystem</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">==</span> <span class="n">A</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.classical.TranspositionCryptosystem.inverse_key">
<code class="descname">inverse_key</code><span class="sig-paren">(</span><em>K</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.TranspositionCryptosystem.inverse_key" title="Permalink to this definition">¶</a></dt>
<dd><p>The inverse key corresponding to the key <code class="docutils literal"><span class="pre">K</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">K</span></code> - a key belonging to the key space of this transposition
cipher</li>
<li><code class="docutils literal"><span class="pre">check</span></code> - bool (default: <code class="docutils literal"><span class="pre">True</span></code>); check that <code class="docutils literal"><span class="pre">K</span></code> belongs to
the key space of this cryptosystem.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The inverse key corresponding to <code class="docutils literal"><span class="pre">K</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">AlphabeticStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">TranspositionCryptosystem</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Ki</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">inverse_key</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">Ki</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="s2">&quot;THECATINTHEHAT&quot;</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">e</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">d</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="n">C</span><span class="p">))</span> <span class="o">==</span> <span class="n">S</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.classical.TranspositionCryptosystem.random_key">
<code class="descname">random_key</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.TranspositionCryptosystem.random_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a random key within the key space of this transposition
cryptosystem. Let <span class="math">\(n &gt; 0\)</span> be the block length of this cryptosystem.
Then there are <span class="math">\(n!\)</span> possible keys.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>A random key within the key space of this cryptosystem.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">AlphabeticStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">TranspositionCryptosystem</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Ki</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">inverse_key</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">Ki</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="s2">&quot;THECATINTHEHAT&quot;</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">e</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">d</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="n">C</span><span class="p">))</span> <span class="o">==</span> <span class="n">S</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.crypto.classical.VigenereCryptosystem">
<em class="property">class </em><code class="descclassname">sage.crypto.classical.</code><code class="descname">VigenereCryptosystem</code><span class="sig-paren">(</span><em>S</em>, <em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.VigenereCryptosystem" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="cryptosystem.html#sage.crypto.cryptosystem.SymmetricKeyCryptosystem" title="sage.crypto.cryptosystem.SymmetricKeyCryptosystem"><code class="xref py py-class docutils literal"><span class="pre">sage.crypto.cryptosystem.SymmetricKeyCryptosystem</span></code></a></p>
<p>Create a Vigenere cryptosystem of block length <code class="docutils literal"><span class="pre">n</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">S</span></code>&#8211; a string monoid over some alphabet</li>
<li><code class="docutils literal"><span class="pre">n</span></code> - integer <span class="math">\(&gt; 0\)</span>; block length of an encryption/decryption key</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>A Vigenere cryptosystem of block length <code class="docutils literal"><span class="pre">n</span></code> over the alphabet
<code class="docutils literal"><span class="pre">S</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">AlphabeticStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">VigenereCryptosystem</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span>
<span class="go">Vigenere cryptosystem on Free alphabetic string monoid on A-Z of period 14</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="s1">&#39;ABCDEFGHIJKLMN&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span>
<span class="go">ABCDEFGHIJKLMN</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span>
<span class="go">Cipher on Free alphabetic string monoid on A-Z</span>
<span class="gp">sage: </span><span class="n">e</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="s2">&quot;THECATINTHEHAT&quot;</span><span class="p">))</span>
<span class="go">TIGFEYOUBQOSMG</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">AlphabeticStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">VigenereCryptosystem</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">==</span> <span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">E</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.crypto.classical.VigenereCryptosystem.deciphering">
<code class="descname">deciphering</code><span class="sig-paren">(</span><em>K</em>, <em>C</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.VigenereCryptosystem.deciphering" title="Permalink to this definition">¶</a></dt>
<dd><p>Decrypt the ciphertext <code class="docutils literal"><span class="pre">C</span></code> using the key <code class="docutils literal"><span class="pre">K</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">K</span></code> - a key belonging to the key space of this Vigenere cipher</li>
<li><code class="docutils literal"><span class="pre">C</span></code> - a string (possibly empty) over the string monoid of this
cryptosystem</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The plaintext corresponding to the ciphertext <code class="docutils literal"><span class="pre">C</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">VigenereCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">(),</span> <span class="mi">24</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Jack and Jill went up the hill.&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">deciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">V</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">M</span><span class="p">))</span> <span class="o">==</span> <span class="n">M</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.classical.VigenereCryptosystem.enciphering">
<code class="descname">enciphering</code><span class="sig-paren">(</span><em>K</em>, <em>M</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.VigenereCryptosystem.enciphering" title="Permalink to this definition">¶</a></dt>
<dd><p>Encrypt the plaintext <code class="docutils literal"><span class="pre">M</span></code> using the key <code class="docutils literal"><span class="pre">K</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">K</span></code> - a key belonging to the key space of this Vigenere cipher</li>
<li><code class="docutils literal"><span class="pre">M</span></code> - a string (possibly empty) over the string monoid of this
cryptosystem</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The ciphertext corresponding to the plaintext <code class="docutils literal"><span class="pre">M</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">VigenereCryptosystem</span><span class="p">(</span><span class="n">AlphabeticStrings</span><span class="p">(),</span> <span class="mi">24</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Jack and Jill went up the hill.&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">deciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">V</span><span class="o">.</span><span class="n">enciphering</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">M</span><span class="p">))</span> <span class="o">==</span> <span class="n">M</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.classical.VigenereCryptosystem.encoding">
<code class="descname">encoding</code><span class="sig-paren">(</span><em>M</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.VigenereCryptosystem.encoding" title="Permalink to this definition">¶</a></dt>
<dd><p>The encoding of the string <code class="docutils literal"><span class="pre">M</span></code> over the string monoid of this
Vigenere cipher. For example, if the string monoid of this
cryptosystem is <code class="xref py py-class docutils literal"><span class="pre">AlphabeticStringMonoid</span></code>, then the encoding
of <code class="docutils literal"><span class="pre">M</span></code> would be its upper-case equivalent stripped of all
non-alphabetic characters.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">M</span></code> - a string, possibly empty</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The encoding of <code class="docutils literal"><span class="pre">M</span></code> over the string monoid of this cryptosystem.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AlphabeticStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">VigenereCryptosystem</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="s2">&quot;Jack and Jill went up the hill.&quot;</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">==</span> <span class="n">A</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.classical.VigenereCryptosystem.inverse_key">
<code class="descname">inverse_key</code><span class="sig-paren">(</span><em>K</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.VigenereCryptosystem.inverse_key" title="Permalink to this definition">¶</a></dt>
<dd><p>The inverse key corresponding to the key <code class="docutils literal"><span class="pre">K</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">K</span></code> - a key within the key space of this Vigenere cryptosystem</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The inverse key corresponding to <code class="docutils literal"><span class="pre">K</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">AlphabeticStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">VigenereCryptosystem</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">inverse_key</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="s2">&quot;THECATINTHEHAT&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span><span class="p">(</span><span class="n">e</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
<span class="go">THECATINTHEHAT</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.classical.VigenereCryptosystem.random_key">
<code class="descname">random_key</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.classical.VigenereCryptosystem.random_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a random key within the key space of this Vigenere
cryptosystem. Let <span class="math">\(n &gt; 0\)</span> be the length of the cryptosystem alphabet
and let <span class="math">\(m &gt; 0\)</span> be the block length of this cryptosystem. Then there
are <span class="math">\(n^m\)</span> possible keys.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>A random key within the key space of this cryptosystem.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AlphabeticStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">VigenereCryptosystem</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="s2">&quot;THECATINTHEHAT&quot;</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Ki</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">inverse_key</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">V</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">V</span><span class="p">(</span><span class="n">Ki</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span><span class="p">(</span><span class="n">e</span><span class="p">(</span><span class="n">A</span><span class="p">(</span><span class="n">M</span><span class="p">)))</span> <span class="o">==</span> <span class="n">A</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="cipher.html"
                                  title="previous chapter">Ciphers</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="classical_cipher.html"
                                  title="next chapter">Classical Ciphers</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../_sources/sage/crypto/classical.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="classical_cipher.html" title="Classical Ciphers"
             >next</a> |</li>
        <li class="right" >
          <a href="cipher.html" title="Ciphers"
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Cryptography</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &copy; Copyright 2005--2016, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.4.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>