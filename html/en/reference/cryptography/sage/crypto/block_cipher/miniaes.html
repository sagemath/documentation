<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="DES" href="des.html" /><link rel="prev" title="Simplified DES" href="sdes.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>Mini-AES - Cryptography</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-furo.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Cryptography</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 10.1 Reference Manual</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../../index.html">Home - Cryptography</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../cryptosystem.html">Cryptosystems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cipher.html">Ciphers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../classical.html">Classical Cryptosystems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../classical_cipher.html">Classical Ciphers</a></li>
<li class="toctree-l1"><a class="reference internal" href="sdes.html">Simplified DES</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Mini-AES</a></li>
<li class="toctree-l1"><a class="reference internal" href="des.html">DES</a></li>
<li class="toctree-l1"><a class="reference internal" href="present.html">PRESENT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../public_key/blum_goldwasser.html">Blum-Goldwasser Probabilistic Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stream.html">Stream Cryptosystems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stream_cipher.html">Stream Ciphers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lfsr.html">Linear feedback shift register (LFSR) sequence commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../util.html">Utility Functions for Cryptography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../boolean_function.html">Boolean functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sbox.html">S-Boxes and Their Algebraic Representations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sboxes.html">S-Boxes used in cryptographic schemes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mq/mpolynomialsystemgenerator.html">Abstract base class for generators of polynomial systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mq/sr.html">Small Scale Variants of the AES (SR) Polynomial System Generator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mq/rijndael_gf.html">Rijndael-GF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lattice.html">Hard Lattice Generator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lwe.html">(Ring-)LWE oracle generators</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="mini-aes">
<span id="sage-crypto-block-cipher-miniaes"></span><h1>Mini-AES<a class="headerlink" href="#mini-aes" title="Permalink to this heading">#</a></h1>
<span class="target" id="module-sage.crypto.block_cipher.miniaes"></span><p>A simplified variant of the Advanced Encryption Standard (AES). Note that
Mini-AES is for educational purposes only. It is a small-scale version of
the AES designed to help beginners understand the basic structure of AES.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Minh Van Nguyen (2009-05): initial version</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="sage.crypto.block_cipher.miniaes.MiniAES">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.crypto.block_cipher.miniaes.</span></span><span class="sig-name descname"><span class="pre">MiniAES</span></span><a class="headerlink" href="#sage.crypto.block_cipher.miniaes.MiniAES" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Parents and Elements v10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SageObject</span></code></a></p>
<p>This class implements the Mini Advanced Encryption Standard (Mini-AES)
described in <a class="reference internal" href="../../../../references/index.html#pha2002" id="id1"><span>[Pha2002]</span></a>. Note that Phan’s Mini-AES is for educational purposes
only and is not secure for practical purposes. Mini-AES is a version of
the AES with all parameters significantly reduced, but at the same time
preserving the structure of AES. The goal of Mini-AES is to allow a
beginner to understand the structure of AES, thus laying a foundation
for a thorough study of AES. Its goal is as a teaching tool and is
different from the <a class="reference internal" href="../mq/sr.html#module-sage.crypto.mq.sr" title="sage.crypto.mq.sr"><code class="xref py py-mod docutils literal notranslate"><span class="pre">SR</span></code></a> small scale variants
of the AES. SR defines a family of parameterizable variants of the AES
suitable as a framework for comparing different cryptanalytic techniques
that can be brought to bear on the AES.</p>
<p>EXAMPLES:</p>
<p>Encrypt a plaintext:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.block_cipher.miniaes</span> <span class="kn">import</span> <span class="n">MiniAES</span>
<span class="gp">sage: </span><span class="n">maes</span> <span class="o">=</span> <span class="n">MiniAES</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">FiniteField</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MS</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">MS</span><span class="p">([</span><span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^2 + 1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^2 + x&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x^2&quot;</span><span class="p">)]);</span> <span class="n">P</span>

<span class="go">[  x^3 + x   x^2 + 1]</span>
<span class="go">[  x^2 + x x^3 + x^2]</span>
<span class="gp">sage: </span><span class="n">key</span> <span class="o">=</span> <span class="n">MS</span><span class="p">([</span><span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x^2&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x^2 + x&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^2 + x + 1&quot;</span><span class="p">)]);</span> <span class="n">key</span>

<span class="go">[    x^3 + x^2       x^3 + x]</span>
<span class="go">[x^3 + x^2 + x   x^2 + x + 1]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">maes</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">key</span><span class="p">);</span> <span class="n">C</span>
<span class="go">[    x^3 + x^2 + 1 x^3 + x^2 + x + 1]</span>
<span class="go">[                x     x^3 + x^2 + x]</span>
</pre></div>
</div>
<p>Decrypt the result:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">plaintxt</span> <span class="o">=</span> <span class="n">maes</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">plaintxt</span><span class="p">;</span> <span class="n">P</span>

<span class="go">[  x^3 + x   x^2 + 1]</span>
<span class="go">[  x^2 + x x^3 + x^2]</span>

<span class="go">[  x^3 + x   x^2 + 1]</span>
<span class="go">[  x^2 + x x^3 + x^2]</span>
<span class="gp">sage: </span><span class="n">plaintxt</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We can also work directly with binary strings:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.block_cipher.miniaes</span> <span class="kn">import</span> <span class="n">MiniAES</span>
<span class="gp">sage: </span><span class="n">maes</span> <span class="o">=</span> <span class="n">MiniAES</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">bin</span> <span class="o">=</span> <span class="n">BinaryStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">key</span> <span class="o">=</span> <span class="nb">bin</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;KE&quot;</span><span class="p">);</span> <span class="n">key</span>
<span class="go">0100101101000101</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="nb">bin</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Encrypt this secret message!&quot;</span><span class="p">);</span> <span class="n">P</span>
<span class="go">01000101011011100110001101110010011110010111000001110100001000000111010001101000011010010111001100100000011100110110010101100011011100100110010101110100001000000110110101100101011100110111001101100001011001110110010100100001</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">maes</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;encrypt&quot;</span><span class="p">);</span> <span class="n">C</span>
<span class="go">11100000101000010110001101101001110110010010111011010001100111100000101000101111100110010010100001110101011100111001000010101000001111000101010011010001100111100111001100000001101100110110101001001000011100000101010110110101</span>
<span class="gp">sage: </span><span class="n">plaintxt</span> <span class="o">=</span> <span class="n">maes</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;decrypt&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">plaintxt</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Now we work with integers <span class="math notranslate nohighlight">\(n\)</span> such that <span class="math notranslate nohighlight">\(0 \leq n \leq 15\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.block_cipher.miniaes</span> <span class="kn">import</span> <span class="n">MiniAES</span>
<span class="gp">sage: </span><span class="n">maes</span> <span class="o">=</span> <span class="n">MiniAES</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)];</span> <span class="n">P</span>
<span class="go">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]</span>
<span class="gp">sage: </span><span class="n">key</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span> <span class="n">key</span>
<span class="go">[2, 3, 11, 0]</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">maes</span><span class="o">.</span><span class="n">integer_to_binary</span><span class="p">(</span><span class="n">P</span><span class="p">);</span> <span class="n">P</span>
<span class="go">0000000100100011010001010110011110001001101010111100110111101111</span>
<span class="gp">sage: </span><span class="n">key</span> <span class="o">=</span> <span class="n">maes</span><span class="o">.</span><span class="n">integer_to_binary</span><span class="p">(</span><span class="n">key</span><span class="p">);</span> <span class="n">key</span>
<span class="go">0010001110110000</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">maes</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;encrypt&quot;</span><span class="p">);</span> <span class="n">C</span>
<span class="go">0011101000101110010011000101010100011101010000111000100100011010</span>
<span class="gp">sage: </span><span class="n">plaintxt</span> <span class="o">=</span> <span class="n">maes</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;decrypt&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">plaintxt</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Generate some random plaintext and a random secret key. Encrypt the
plaintext using that secret key and decrypt the result. Then compare the
decrypted plaintext with the original plaintext:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.block_cipher.miniaes</span> <span class="kn">import</span> <span class="n">MiniAES</span>
<span class="gp">sage: </span><span class="n">maes</span> <span class="o">=</span> <span class="n">MiniAES</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MS</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">FiniteField</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">MS</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">key</span> <span class="o">=</span> <span class="n">maes</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">maes</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">plaintxt</span> <span class="o">=</span> <span class="n">maes</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">plaintxt</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.block_cipher.miniaes.MiniAES.GF_to_binary">
<span class="sig-name descname"><span class="pre">GF_to_binary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.block_cipher.miniaes.MiniAES.GF_to_binary" title="Permalink to this definition">#</a></dt>
<dd><p>Return the binary representation of <code class="docutils literal notranslate"><span class="pre">G</span></code>.
If <code class="docutils literal notranslate"><span class="pre">G</span></code> is an element of the finite field <span class="math notranslate nohighlight">\(\GF{2^4}\)</span>, then
obtain the binary representation of <code class="docutils literal notranslate"><span class="pre">G</span></code>. If <code class="docutils literal notranslate"><span class="pre">G</span></code> is a list of
elements belonging to <span class="math notranslate nohighlight">\(\GF{2^4}\)</span>, obtain the 4-bit
representation of each element of the list, then concatenate the
resulting 4-bit strings into a binary string. If <code class="docutils literal notranslate"><span class="pre">G</span></code> is a matrix
with entries over <span class="math notranslate nohighlight">\(\GF{2^4}\)</span>, convert each matrix entry to its
4-bit representation, then concatenate the 4-bit strings. The
concatenation is performed starting from the top-left corner of the
matrix, working across left to right, top to bottom. Each element of
<span class="math notranslate nohighlight">\(\GF{2^4}\)</span> can be associated with a unique 4-bit string
according to the following table:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{tabular}{ll|ll} \hline
  4-bit string &amp; $\GF{2^4}$ &amp; 4-bit string &amp; $\GF{2^4}$ \\\hline
  0000 &amp; $0$           &amp; 1000 &amp; $x^3$              \\
  0001 &amp; $1$           &amp; 1001 &amp; $x^3 + 1$          \\
  0010 &amp; $x$           &amp; 1010 &amp; $x^3 + x$          \\
  0011 &amp; $x + 1$       &amp; 1011 &amp; $x^3 + x + 1$      \\
  0100 &amp; $x^2$         &amp; 1100 &amp; $x^3 + x^2$        \\
  0101 &amp; $x^2 + 1$     &amp; 1101 &amp; $x^3 + x^2 + 1$    \\
  0110 &amp; $x^2 + x$     &amp; 1110 &amp; $x^3 + x^2 + x$    \\
  0111 &amp; $x^2 + x + 1$ &amp; 1111 &amp; $x^3 + x^2 + x+ 1$ \\\hline
\end{tabular}\end{split}\]</div>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">G</span></code> – an element of <span class="math notranslate nohighlight">\(\GF{2^4}\)</span>, a list of elements of
<span class="math notranslate nohighlight">\(\GF{2^4}\)</span>, or a matrix over <span class="math notranslate nohighlight">\(\GF{2^4}\)</span></p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>A binary string representation of <code class="docutils literal notranslate"><span class="pre">G</span></code>.</p></li>
</ul>
<p>EXAMPLES:</p>
<p>Obtain the binary representation of all elements of <span class="math notranslate nohighlight">\(\GF{2^4}\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.block_cipher.miniaes</span> <span class="kn">import</span> <span class="n">MiniAES</span>
<span class="gp">sage: </span><span class="n">maes</span> <span class="o">=</span> <span class="n">MiniAES</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">FiniteField</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Set</span><span class="p">(</span><span class="n">K</span><span class="p">);</span> <span class="nb">len</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>  <span class="c1"># GF(2^4) has this many elements</span>
<span class="go">16</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">maes</span><span class="o">.</span><span class="n">GF_to_binary</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">S</span><span class="p">))]</span>

<span class="go">[0000,</span>
<span class="go">0001,</span>
<span class="go">0010,</span>
<span class="go">0011,</span>
<span class="go">0100,</span>
<span class="go">0101,</span>
<span class="go">0110,</span>
<span class="go">0111,</span>
<span class="go">1000,</span>
<span class="go">1001,</span>
<span class="go">1010,</span>
<span class="go">1011,</span>
<span class="go">1100,</span>
<span class="go">1101,</span>
<span class="go">1110,</span>
<span class="go">1111]</span>
</pre></div>
</div>
<p>The binary representation of a list of elements belonging to
<span class="math notranslate nohighlight">\(\GF{2^4}\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.block_cipher.miniaes</span> <span class="kn">import</span> <span class="n">MiniAES</span>
<span class="gp">sage: </span><span class="n">maes</span> <span class="o">=</span> <span class="n">MiniAES</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">FiniteField</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="p">[</span><span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^2 + x + 1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x^2&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x + 1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x^2 + x + 1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^2 + x&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^2 + x + 1&quot;</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">GF_to_binary</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="go">01111100001010111111011000010111</span>
</pre></div>
</div>
<p>The binary representation of a matrix over <span class="math notranslate nohighlight">\(\GF{2^4}\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.block_cipher.miniaes</span> <span class="kn">import</span> <span class="n">MiniAES</span>
<span class="gp">sage: </span><span class="n">maes</span> <span class="o">=</span> <span class="n">MiniAES</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">FiniteField</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MS</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">MS</span><span class="p">([</span><span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x^2&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x + 1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^2 + x + 1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x^2 + x&quot;</span><span class="p">)]);</span> <span class="n">G</span>

<span class="go">[    x^3 + x^2         x + 1]</span>
<span class="go">[  x^2 + x + 1 x^3 + x^2 + x]</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">GF_to_binary</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="go">1100001101111110</span>
<span class="gp">sage: </span><span class="n">MS</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">MS</span><span class="p">([</span><span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^2 + x + 1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x^2&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x + 1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x^2 + x + 1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^2 + x&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^2 + x + 1&quot;</span><span class="p">)]);</span> <span class="n">G</span>

<span class="go">[      x^2 + x + 1         x^3 + x^2                 x       x^3 + x + 1]</span>
<span class="go">[x^3 + x^2 + x + 1           x^2 + x                 1       x^2 + x + 1]</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">GF_to_binary</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="go">01111100001010111111011000010111</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.block_cipher.miniaes.MiniAES.GF_to_integer">
<span class="sig-name descname"><span class="pre">GF_to_integer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.block_cipher.miniaes.MiniAES.GF_to_integer" title="Permalink to this definition">#</a></dt>
<dd><p>Return the integer representation of the finite field element <code class="docutils literal notranslate"><span class="pre">G</span></code>.
If <code class="docutils literal notranslate"><span class="pre">G</span></code> is an element of the finite field <span class="math notranslate nohighlight">\(\GF{2^4}\)</span>, then
obtain the integer representation of <code class="docutils literal notranslate"><span class="pre">G</span></code>. If <code class="docutils literal notranslate"><span class="pre">G</span></code> is a list of
elements belonging to <span class="math notranslate nohighlight">\(\GF{2^4}\)</span>, obtain the integer
representation of each element of the list, and return the result
as a list of integers. If <code class="docutils literal notranslate"><span class="pre">G</span></code> is a matrix with entries over
<span class="math notranslate nohighlight">\(\GF{2^4}\)</span>, convert each matrix entry to its integer representation,
and return the result as a list of integers. The resulting list is
obtained by starting from the top-left corner of the matrix, working
across left to right, top to bottom. Each element of <span class="math notranslate nohighlight">\(\GF{2^4}\)</span> can
be associated with a unique integer according to the following table:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{tabular}{ll|ll} \hline
  integer &amp; $\GF{2^4}$ &amp; integer &amp; $\GF{2^4}$ \\\hline
  0 &amp; $0$           &amp; 8  &amp; $x^3$              \\
  1 &amp; $1$           &amp; 9  &amp; $x^3 + 1$          \\
  2 &amp; $x$           &amp; 10 &amp; $x^3 + x$          \\
  3 &amp; $x + 1$       &amp; 11 &amp; $x^3 + x + 1$      \\
  4 &amp; $x^2$         &amp; 12 &amp; $x^3 + x^2$        \\
  5 &amp; $x^2 + 1$     &amp; 13 &amp; $x^3 + x^2 + 1$    \\
  6 &amp; $x^2 + x$     &amp; 14 &amp; $x^3 + x^2 + x$    \\
  7 &amp; $x^2 + x + 1$ &amp; 15 &amp; $x^3 + x^2 + x+ 1$ \\\hline
\end{tabular}\end{split}\]</div>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">G</span></code> – an element of <span class="math notranslate nohighlight">\(\GF{2^4}\)</span>, a list of elements belonging to
<span class="math notranslate nohighlight">\(\GF{2^4}\)</span>, or a matrix over <span class="math notranslate nohighlight">\(\GF{2^4}\)</span></p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>The integer representation of <code class="docutils literal notranslate"><span class="pre">G</span></code>.</p></li>
</ul>
<p>EXAMPLES:</p>
<p>Obtain the integer representation of all elements of <span class="math notranslate nohighlight">\(\GF{2^4}\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.block_cipher.miniaes</span> <span class="kn">import</span> <span class="n">MiniAES</span>
<span class="gp">sage: </span><span class="n">maes</span> <span class="o">=</span> <span class="n">MiniAES</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">FiniteField</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Set</span><span class="p">(</span><span class="n">K</span><span class="p">);</span> <span class="nb">len</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>  <span class="c1"># GF(2^4) has this many elements</span>
<span class="go">16</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">maes</span><span class="o">.</span><span class="n">GF_to_integer</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">S</span><span class="p">))]</span>
<span class="go">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]</span>
</pre></div>
</div>
<p>The integer representation of a list of elements belonging to
<span class="math notranslate nohighlight">\(\GF{2^4}\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.block_cipher.miniaes</span> <span class="kn">import</span> <span class="n">MiniAES</span>
<span class="gp">sage: </span><span class="n">maes</span> <span class="o">=</span> <span class="n">MiniAES</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">FiniteField</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="p">[</span><span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^2 + x + 1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x^2&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x + 1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x^2 + x + 1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^2 + x&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^2 + x + 1&quot;</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">GF_to_integer</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="go">[7, 12, 2, 11, 15, 6, 1, 7]</span>
</pre></div>
</div>
<p>The integer representation of a matrix over <span class="math notranslate nohighlight">\(\GF{2^4}\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.block_cipher.miniaes</span> <span class="kn">import</span> <span class="n">MiniAES</span>
<span class="gp">sage: </span><span class="n">maes</span> <span class="o">=</span> <span class="n">MiniAES</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">FiniteField</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MS</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">MS</span><span class="p">([</span><span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x^2&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x + 1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^2 + x + 1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x^2 + x&quot;</span><span class="p">)]);</span> <span class="n">G</span>

<span class="go">[    x^3 + x^2         x + 1]</span>
<span class="go">[  x^2 + x + 1 x^3 + x^2 + x]</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">GF_to_integer</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="go">[12, 3, 7, 14]</span>
<span class="gp">sage: </span><span class="n">MS</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">MS</span><span class="p">([</span><span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^2 + x + 1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x^2&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x + 1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x^2 + x + 1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^2 + x&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^2 + x + 1&quot;</span><span class="p">)]);</span> <span class="n">G</span>

<span class="go">[      x^2 + x + 1         x^3 + x^2                 x       x^3 + x + 1]</span>
<span class="go">[x^3 + x^2 + x + 1           x^2 + x                 1       x^2 + x + 1]</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">GF_to_integer</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="go">[7, 12, 2, 11, 15, 6, 1, 7]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.block_cipher.miniaes.MiniAES.add_key">
<span class="sig-name descname"><span class="pre">add_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">block</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rkey</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.block_cipher.miniaes.MiniAES.add_key" title="Permalink to this definition">#</a></dt>
<dd><p>Return the matrix addition of <code class="docutils literal notranslate"><span class="pre">block</span></code> and <code class="docutils literal notranslate"><span class="pre">rkey</span></code>. Both <code class="docutils literal notranslate"><span class="pre">block</span></code>
and <code class="docutils literal notranslate"><span class="pre">rkey</span></code> are <span class="math notranslate nohighlight">\(2 \times 2\)</span> matrices over the finite field
<span class="math notranslate nohighlight">\(\GF{2^4}\)</span>. This method just return the matrix addition of
these two matrices.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">block</span></code> – a <span class="math notranslate nohighlight">\(2 \times 2\)</span> matrix with entries over
<span class="math notranslate nohighlight">\(\GF{2^4}\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rkey</span></code> – a round key; a <span class="math notranslate nohighlight">\(2 \times 2\)</span> matrix with entries over
<span class="math notranslate nohighlight">\(\GF{2^4}\)</span></p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>The matrix addition of <code class="docutils literal notranslate"><span class="pre">block</span></code> and <code class="docutils literal notranslate"><span class="pre">rkey</span></code>.</p></li>
</ul>
<p>EXAMPLES:</p>
<p>We can work with elements of <span class="math notranslate nohighlight">\(\GF{2^4}\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.block_cipher.miniaes</span> <span class="kn">import</span> <span class="n">MiniAES</span>
<span class="gp">sage: </span><span class="n">maes</span> <span class="o">=</span> <span class="n">MiniAES</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">FiniteField</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MS</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">MS</span><span class="p">([</span> <span class="p">[</span><span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x^2 + x + 1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x&quot;</span><span class="p">)],</span> <span class="p">[</span><span class="n">K</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x^2&quot;</span><span class="p">)]</span> <span class="p">]);</span> <span class="n">D</span>

<span class="go">[x^3 + x^2 + x + 1           x^3 + x]</span>
<span class="go">[                0         x^3 + x^2]</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">MS</span><span class="p">([</span> <span class="p">[</span><span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^2 + 1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x^2 + x + 1&quot;</span><span class="p">)],</span> <span class="p">[</span><span class="n">K</span><span class="p">(</span><span class="s2">&quot;x + 1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">)]</span> <span class="p">]);</span> <span class="n">k</span>

<span class="go">[          x^2 + 1 x^3 + x^2 + x + 1]</span>
<span class="go">[            x + 1                 0]</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">add_key</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>

<span class="go">[  x^3 + x   x^2 + 1]</span>
<span class="go">[    x + 1 x^3 + x^2]</span>
</pre></div>
</div>
<p>Or work with binary strings:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">bin</span> <span class="o">=</span> <span class="n">BinaryStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="nb">bin</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;We&quot;</span><span class="p">);</span> <span class="n">B</span>
<span class="go">0101011101100101</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">MS</span><span class="p">(</span><span class="n">maes</span><span class="o">.</span><span class="n">binary_to_GF</span><span class="p">(</span><span class="n">B</span><span class="p">));</span> <span class="n">B</span>

<span class="go">[    x^2 + 1 x^2 + x + 1]</span>
<span class="go">[    x^2 + x     x^2 + 1]</span>
<span class="gp">sage: </span><span class="n">key</span> <span class="o">=</span> <span class="nb">bin</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;KY&quot;</span><span class="p">);</span> <span class="n">key</span>
<span class="go">0100101101011001</span>
<span class="gp">sage: </span><span class="n">key</span> <span class="o">=</span> <span class="n">MS</span><span class="p">(</span><span class="n">maes</span><span class="o">.</span><span class="n">binary_to_GF</span><span class="p">(</span><span class="n">key</span><span class="p">));</span> <span class="n">key</span>

<span class="go">[        x^2 x^3 + x + 1]</span>
<span class="go">[    x^2 + 1     x^3 + 1]</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">add_key</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

<span class="go">[        1 x^3 + x^2]</span>
<span class="go">[    x + 1 x^3 + x^2]</span>
</pre></div>
</div>
<p>We can also work with integers <span class="math notranslate nohighlight">\(n\)</span> such that <span class="math notranslate nohighlight">\(0 \leq n \leq 15\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">];</span> <span class="n">N</span>
<span class="go">[2, 3, 5, 7]</span>
<span class="gp">sage: </span><span class="n">key</span> <span class="o">=</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">15</span><span class="p">];</span> <span class="n">key</span>
<span class="go">[9, 11, 13, 15]</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">MS</span><span class="p">(</span><span class="n">maes</span><span class="o">.</span><span class="n">integer_to_GF</span><span class="p">(</span><span class="n">N</span><span class="p">));</span> <span class="n">N</span>

<span class="go">[          x       x + 1]</span>
<span class="go">[    x^2 + 1 x^2 + x + 1]</span>
<span class="gp">sage: </span><span class="n">key</span> <span class="o">=</span> <span class="n">MS</span><span class="p">(</span><span class="n">maes</span><span class="o">.</span><span class="n">integer_to_GF</span><span class="p">(</span><span class="n">key</span><span class="p">));</span> <span class="n">key</span>

<span class="go">[          x^3 + 1       x^3 + x + 1]</span>
<span class="go">[    x^3 + x^2 + 1 x^3 + x^2 + x + 1]</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">add_key</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

<span class="go">[x^3 + x + 1         x^3]</span>
<span class="go">[        x^3         x^3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.block_cipher.miniaes.MiniAES.binary_to_GF">
<span class="sig-name descname"><span class="pre">binary_to_GF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.block_cipher.miniaes.MiniAES.binary_to_GF" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list of elements of <span class="math notranslate nohighlight">\(\GF{2^4}\)</span> that represents the
binary string <code class="docutils literal notranslate"><span class="pre">B</span></code>. The number of bits in <code class="docutils literal notranslate"><span class="pre">B</span></code> must be greater
than zero and a multiple of 4. Each nibble (or 4-bit string) is
uniquely associated with an element of <span class="math notranslate nohighlight">\(\GF{2^4}\)</span> as
specified by the following table:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{tabular}{ll|ll} \hline
  4-bit string &amp; $\GF{2^4}$ &amp; 4-bit string &amp; $\GF{2^4}$ \\\hline
  0000 &amp; $0$           &amp; 1000 &amp; $x^3$              \\
  0001 &amp; $1$           &amp; 1001 &amp; $x^3 + 1$          \\
  0010 &amp; $x$           &amp; 1010 &amp; $x^3 + x$          \\
  0011 &amp; $x + 1$       &amp; 1011 &amp; $x^3 + x + 1$      \\
  0100 &amp; $x^2$         &amp; 1100 &amp; $x^3 + x^2$        \\
  0101 &amp; $x^2 + 1$     &amp; 1101 &amp; $x^3 + x^2 + 1$    \\
  0110 &amp; $x^2 + x$     &amp; 1110 &amp; $x^3 + x^2 + x$    \\
  0111 &amp; $x^2 + x + 1$ &amp; 1111 &amp; $x^3 + x^2 + x+ 1$ \\\hline
\end{tabular}\end{split}\]</div>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">B</span></code> – a binary string, where the number of bits is positive and
a multiple of 4</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>A list of elements of the finite field <span class="math notranslate nohighlight">\(\GF{2^4}\)</span> that
represent the binary string <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p></li>
</ul>
<p>EXAMPLES:</p>
<p>Obtain all the elements of the finite field <span class="math notranslate nohighlight">\(\GF{2^4}\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.block_cipher.miniaes</span> <span class="kn">import</span> <span class="n">MiniAES</span>
<span class="gp">sage: </span><span class="n">maes</span> <span class="o">=</span> <span class="n">MiniAES</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">bin</span> <span class="o">=</span> <span class="n">BinaryStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="nb">bin</span><span class="p">(</span><span class="s2">&quot;0000000100100011010001010110011110001001101010111100110111101111&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">binary_to_GF</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>

<span class="go">[0,</span>
<span class="go">1,</span>
<span class="go">x,</span>
<span class="go">x + 1,</span>
<span class="go">x^2,</span>
<span class="go">x^2 + 1,</span>
<span class="go">x^2 + x,</span>
<span class="go">x^2 + x + 1,</span>
<span class="go">x^3,</span>
<span class="go">x^3 + 1,</span>
<span class="go">x^3 + x,</span>
<span class="go">x^3 + x + 1,</span>
<span class="go">x^3 + x^2,</span>
<span class="go">x^3 + x^2 + 1,</span>
<span class="go">x^3 + x^2 + x,</span>
<span class="go">x^3 + x^2 + x + 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.block_cipher.miniaes.MiniAES.binary_to_integer">
<span class="sig-name descname"><span class="pre">binary_to_integer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.block_cipher.miniaes.MiniAES.binary_to_integer" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list of integers representing the binary string <code class="docutils literal notranslate"><span class="pre">B</span></code>. The
number of bits in <code class="docutils literal notranslate"><span class="pre">B</span></code> must be greater than zero and a multiple of
4. Each nibble (or 4-bit string) is uniquely associated with an
integer as specified by the following table:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{tabular}{ll|ll} \hline
  4-bit string &amp; integer &amp; 4-bit string &amp; integer \\\hline
  0000 &amp; 0 &amp; 1000 &amp; 8  \\
  0001 &amp; 1 &amp; 1001 &amp; 9  \\
  0010 &amp; 2 &amp; 1010 &amp; 10 \\
  0011 &amp; 3 &amp; 1011 &amp; 11 \\
  0100 &amp; 4 &amp; 1100 &amp; 12 \\
  0101 &amp; 5 &amp; 1101 &amp; 13 \\
  0110 &amp; 6 &amp; 1110 &amp; 14 \\
  0111 &amp; 7 &amp; 1111 &amp; 15 \\\hline
\end{tabular}\end{split}\]</div>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">B</span></code> – a binary string, where the number of bits is positive and
a multiple of 4</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>A list of integers that represent the binary string <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p></li>
</ul>
<p>EXAMPLES:</p>
<p>Obtain the integer representation of every 4-bit string:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.block_cipher.miniaes</span> <span class="kn">import</span> <span class="n">MiniAES</span>
<span class="gp">sage: </span><span class="n">maes</span> <span class="o">=</span> <span class="n">MiniAES</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">bin</span> <span class="o">=</span> <span class="n">BinaryStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="nb">bin</span><span class="p">(</span><span class="s2">&quot;0000000100100011010001010110011110001001101010111100110111101111&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">binary_to_integer</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.block_cipher.miniaes.MiniAES.block_length">
<span class="sig-name descname"><span class="pre">block_length</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.block_cipher.miniaes.MiniAES.block_length" title="Permalink to this definition">#</a></dt>
<dd><p>Return the block length of Phan’s Mini-AES block cipher. A key in
Phan’s Mini-AES is a block of 16 bits. Each nibble of a key can be
considered as an element of the finite field <span class="math notranslate nohighlight">\(\GF{2^4}\)</span>.
Therefore the key consists of four elements from <span class="math notranslate nohighlight">\(\GF{2^4}\)</span>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>The block (or key) length in number of bits.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.block_cipher.miniaes</span> <span class="kn">import</span> <span class="n">MiniAES</span>
<span class="gp">sage: </span><span class="n">maes</span> <span class="o">=</span> <span class="n">MiniAES</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">block_length</span><span class="p">()</span>
<span class="go">16</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.block_cipher.miniaes.MiniAES.decrypt">
<span class="sig-name descname"><span class="pre">decrypt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.block_cipher.miniaes.MiniAES.decrypt" title="Permalink to this definition">#</a></dt>
<dd><p>Use Phan’s Mini-AES to decrypt the ciphertext <code class="docutils literal notranslate"><span class="pre">C</span></code> with the secret
key <code class="docutils literal notranslate"><span class="pre">key</span></code>. Both <code class="docutils literal notranslate"><span class="pre">C</span></code> and <code class="docutils literal notranslate"><span class="pre">key</span></code> must be <span class="math notranslate nohighlight">\(2 \times 2\)</span> matrices over
the finite field <span class="math notranslate nohighlight">\(\GF{2^4}\)</span>. Let <span class="math notranslate nohighlight">\(\gamma\)</span> denote the
operation of nibble-sub, <span class="math notranslate nohighlight">\(\pi\)</span> denote shift-row, <span class="math notranslate nohighlight">\(\theta\)</span> denote
mix-column, and <span class="math notranslate nohighlight">\(\sigma_{K_i}\)</span> denote add-key with the round key
<span class="math notranslate nohighlight">\(K_i\)</span>. Then decryption <span class="math notranslate nohighlight">\(D\)</span> using Phan’s Mini-AES is the function
composition</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[D = \sigma_{K_0} \circ \gamma^{-1} \circ \pi \circ \theta \circ \sigma_{K_1} \circ \gamma^{-1} \circ \pi \circ \sigma_{K_2}\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(\gamma^{-1}\)</span> is the nibble-sub operation that uses the S-box
for decryption, and the order of execution is from right to left.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">C</span></code> – a ciphertext block; must be a <span class="math notranslate nohighlight">\(2 \times 2\)</span> matrix over
the finite field <span class="math notranslate nohighlight">\(\GF{2^4}\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key</span></code> – a secret key for this Mini-AES block cipher; must be a
<span class="math notranslate nohighlight">\(2 \times 2\)</span> matrix over the finite field <span class="math notranslate nohighlight">\(\GF{2^4}\)</span></p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>The plaintext corresponding to <code class="docutils literal notranslate"><span class="pre">C</span></code>.</p></li>
</ul>
<p>EXAMPLES:</p>
<p>We encrypt a plaintext, decrypt the ciphertext, then compare the
decrypted plaintext with the original plaintext. Here we work with
elements of <span class="math notranslate nohighlight">\(\GF{2^4}\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.block_cipher.miniaes</span> <span class="kn">import</span> <span class="n">MiniAES</span>
<span class="gp">sage: </span><span class="n">maes</span> <span class="o">=</span> <span class="n">MiniAES</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">FiniteField</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MS</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">MS</span><span class="p">([</span> <span class="p">[</span><span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + 1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^2 + x&quot;</span><span class="p">)],</span> <span class="p">[</span><span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x^2&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x + 1&quot;</span><span class="p">)]</span> <span class="p">]);</span> <span class="n">P</span>

<span class="go">[  x^3 + 1   x^2 + x]</span>
<span class="go">[x^3 + x^2     x + 1]</span>
<span class="gp">sage: </span><span class="n">key</span> <span class="o">=</span> <span class="n">MS</span><span class="p">([</span> <span class="p">[</span><span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x^2&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x^2 + x + 1&quot;</span><span class="p">)],</span> <span class="p">[</span><span class="n">K</span><span class="p">(</span><span class="s2">&quot;x + 1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">)]</span> <span class="p">]);</span> <span class="n">key</span>

<span class="go">[        x^3 + x^2 x^3 + x^2 + x + 1]</span>
<span class="go">[            x + 1                 0]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">maes</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">key</span><span class="p">);</span> <span class="n">C</span>
<span class="go">[            x + 1           x^2 + 1]</span>
<span class="go">[x^3 + x^2 + x + 1               x^2]</span>
<span class="gp">sage: </span><span class="n">plaintxt</span> <span class="o">=</span> <span class="n">maes</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">plaintxt</span><span class="p">;</span> <span class="n">P</span>

<span class="go">[  x^3 + 1   x^2 + x]</span>
<span class="go">[x^3 + x^2     x + 1]</span>

<span class="go">[  x^3 + 1   x^2 + x]</span>
<span class="go">[x^3 + x^2     x + 1]</span>
<span class="gp">sage: </span><span class="n">plaintxt</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>But we can also work with binary strings:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">bin</span> <span class="o">=</span> <span class="n">BinaryStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="nb">bin</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;de&quot;</span><span class="p">);</span> <span class="n">P</span>
<span class="go">0110010001100101</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">MS</span><span class="p">(</span><span class="n">maes</span><span class="o">.</span><span class="n">binary_to_GF</span><span class="p">(</span><span class="n">P</span><span class="p">));</span> <span class="n">P</span>

<span class="go">[x^2 + x     x^2]</span>
<span class="go">[x^2 + x x^2 + 1]</span>
<span class="gp">sage: </span><span class="n">key</span> <span class="o">=</span> <span class="nb">bin</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;ke&quot;</span><span class="p">);</span> <span class="n">key</span>
<span class="go">0110101101100101</span>
<span class="gp">sage: </span><span class="n">key</span> <span class="o">=</span> <span class="n">MS</span><span class="p">(</span><span class="n">maes</span><span class="o">.</span><span class="n">binary_to_GF</span><span class="p">(</span><span class="n">key</span><span class="p">));</span> <span class="n">key</span>

<span class="go">[    x^2 + x x^3 + x + 1]</span>
<span class="go">[    x^2 + x     x^2 + 1]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">maes</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">plaintxt</span> <span class="o">=</span> <span class="n">maes</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">plaintxt</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Here we work with integers <span class="math notranslate nohighlight">\(n\)</span> such that <span class="math notranslate nohighlight">\(0 \leq n \leq 15\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">];</span> <span class="n">P</span>
<span class="go">[3, 5, 7, 14]</span>
<span class="gp">sage: </span><span class="n">key</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">];</span> <span class="n">key</span>
<span class="go">[2, 6, 7, 8]</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">MS</span><span class="p">(</span><span class="n">maes</span><span class="o">.</span><span class="n">integer_to_GF</span><span class="p">(</span><span class="n">P</span><span class="p">));</span> <span class="n">P</span>

<span class="go">[        x + 1       x^2 + 1]</span>
<span class="go">[  x^2 + x + 1 x^3 + x^2 + x]</span>
<span class="gp">sage: </span><span class="n">key</span> <span class="o">=</span> <span class="n">MS</span><span class="p">(</span><span class="n">maes</span><span class="o">.</span><span class="n">integer_to_GF</span><span class="p">(</span><span class="n">key</span><span class="p">));</span> <span class="n">key</span>

<span class="go">[          x     x^2 + x]</span>
<span class="go">[x^2 + x + 1         x^3]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">maes</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">plaintxt</span> <span class="o">=</span> <span class="n">maes</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">plaintxt</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.block_cipher.miniaes.MiniAES.encrypt">
<span class="sig-name descname"><span class="pre">encrypt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.block_cipher.miniaes.MiniAES.encrypt" title="Permalink to this definition">#</a></dt>
<dd><p>Use Phan’s Mini-AES to encrypt the plaintext <code class="docutils literal notranslate"><span class="pre">P</span></code> with the secret
key <code class="docutils literal notranslate"><span class="pre">key</span></code>. Both <code class="docutils literal notranslate"><span class="pre">P</span></code> and <code class="docutils literal notranslate"><span class="pre">key</span></code> must be <span class="math notranslate nohighlight">\(2 \times 2\)</span> matrices
over the finite field <span class="math notranslate nohighlight">\(\GF{2^4}\)</span>. Let <span class="math notranslate nohighlight">\(\gamma\)</span> denote the
operation of nibble-sub, <span class="math notranslate nohighlight">\(\pi\)</span> denote shift-row, <span class="math notranslate nohighlight">\(\theta\)</span> denote
mix-column, and <span class="math notranslate nohighlight">\(\sigma_{K_i}\)</span> denote add-key with the round key
<span class="math notranslate nohighlight">\(K_i\)</span>. Then encryption <span class="math notranslate nohighlight">\(E\)</span> using Phan’s Mini-AES is the function
composition</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[E = \sigma_{K_2} \circ \pi \circ \gamma \circ \sigma_{K_1} \circ \theta \circ \pi \circ \gamma \circ \sigma_{K_0}\]</div>
</div>
<p>where the order of execution is from right to left. Note that
<span class="math notranslate nohighlight">\(\gamma\)</span> is the nibble-sub operation that uses the S-box for
encryption.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">P</span></code> – a plaintext block; must be a <span class="math notranslate nohighlight">\(2 \times 2\)</span> matrix over
the finite field <span class="math notranslate nohighlight">\(\GF{2^4}\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key</span></code> – a secret key for this Mini-AES block cipher; must be a
<span class="math notranslate nohighlight">\(2 \times 2\)</span> matrix over the finite field <span class="math notranslate nohighlight">\(\GF{2^4}\)</span></p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>The ciphertext corresponding to <code class="docutils literal notranslate"><span class="pre">P</span></code>.</p></li>
</ul>
<p>EXAMPLES:</p>
<p>Here we work with elements of <span class="math notranslate nohighlight">\(\GF{2^4}\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.block_cipher.miniaes</span> <span class="kn">import</span> <span class="n">MiniAES</span>
<span class="gp">sage: </span><span class="n">maes</span> <span class="o">=</span> <span class="n">MiniAES</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">FiniteField</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MS</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">MS</span><span class="p">([</span> <span class="p">[</span><span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + 1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^2 + x&quot;</span><span class="p">)],</span> <span class="p">[</span><span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x^2&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x + 1&quot;</span><span class="p">)]</span> <span class="p">]);</span> <span class="n">P</span>

<span class="go">[  x^3 + 1   x^2 + x]</span>
<span class="go">[x^3 + x^2     x + 1]</span>
<span class="gp">sage: </span><span class="n">key</span> <span class="o">=</span> <span class="n">MS</span><span class="p">([</span> <span class="p">[</span><span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x^2&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x^2 + x + 1&quot;</span><span class="p">)],</span> <span class="p">[</span><span class="n">K</span><span class="p">(</span><span class="s2">&quot;x + 1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">)]</span> <span class="p">]);</span> <span class="n">key</span>

<span class="go">[        x^3 + x^2 x^3 + x^2 + x + 1]</span>
<span class="go">[            x + 1                 0]</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="go">[            x + 1           x^2 + 1]</span>
<span class="go">[x^3 + x^2 + x + 1               x^2]</span>
</pre></div>
</div>
<p>But we can also work with binary strings:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">bin</span> <span class="o">=</span> <span class="n">BinaryStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="nb">bin</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;de&quot;</span><span class="p">);</span> <span class="n">P</span>
<span class="go">0110010001100101</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">MS</span><span class="p">(</span><span class="n">maes</span><span class="o">.</span><span class="n">binary_to_GF</span><span class="p">(</span><span class="n">P</span><span class="p">));</span> <span class="n">P</span>

<span class="go">[x^2 + x     x^2]</span>
<span class="go">[x^2 + x x^2 + 1]</span>
<span class="gp">sage: </span><span class="n">key</span> <span class="o">=</span> <span class="nb">bin</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;ke&quot;</span><span class="p">);</span> <span class="n">key</span>
<span class="go">0110101101100101</span>
<span class="gp">sage: </span><span class="n">key</span> <span class="o">=</span> <span class="n">MS</span><span class="p">(</span><span class="n">maes</span><span class="o">.</span><span class="n">binary_to_GF</span><span class="p">(</span><span class="n">key</span><span class="p">));</span> <span class="n">key</span>

<span class="go">[    x^2 + x x^3 + x + 1]</span>
<span class="go">[    x^2 + x     x^2 + 1]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">maes</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">plaintxt</span> <span class="o">=</span> <span class="n">maes</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">plaintxt</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Now we work with integers <span class="math notranslate nohighlight">\(n\)</span> such that <span class="math notranslate nohighlight">\(0 \leq n \leq 15\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">];</span> <span class="n">P</span>
<span class="go">[1, 5, 8, 12]</span>
<span class="gp">sage: </span><span class="n">key</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span> <span class="n">key</span>
<span class="go">[5, 9, 15, 0]</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">MS</span><span class="p">(</span><span class="n">maes</span><span class="o">.</span><span class="n">integer_to_GF</span><span class="p">(</span><span class="n">P</span><span class="p">));</span> <span class="n">P</span>

<span class="go">[        1   x^2 + 1]</span>
<span class="go">[      x^3 x^3 + x^2]</span>
<span class="gp">sage: </span><span class="n">key</span> <span class="o">=</span> <span class="n">MS</span><span class="p">(</span><span class="n">maes</span><span class="o">.</span><span class="n">integer_to_GF</span><span class="p">(</span><span class="n">key</span><span class="p">));</span> <span class="n">key</span>

<span class="go">[          x^2 + 1           x^3 + 1]</span>
<span class="go">[x^3 + x^2 + x + 1                 0]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">maes</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">plaintxt</span> <span class="o">=</span> <span class="n">maes</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">plaintxt</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.block_cipher.miniaes.MiniAES.integer_to_GF">
<span class="sig-name descname"><span class="pre">integer_to_GF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.block_cipher.miniaes.MiniAES.integer_to_GF" title="Permalink to this definition">#</a></dt>
<dd><p>Return the finite field representation of <code class="docutils literal notranslate"><span class="pre">N</span></code>. If <span class="math notranslate nohighlight">\(N\)</span> is an
integer such that <span class="math notranslate nohighlight">\(0 \leq N \leq 15\)</span>, return the element of
<span class="math notranslate nohighlight">\(\GF{2^4}\)</span> that represents <code class="docutils literal notranslate"><span class="pre">N</span></code>. If <code class="docutils literal notranslate"><span class="pre">N</span></code> is a list of integers
each of which is <span class="math notranslate nohighlight">\(\geq 0\)</span> and <span class="math notranslate nohighlight">\(\leq 15\)</span>, then obtain the element
of <span class="math notranslate nohighlight">\(\GF{2^4}\)</span> that represents each such integer, and return a list
of such finite field representations. Each integer between 0 and 15,
inclusive, can be associated with a unique element of <span class="math notranslate nohighlight">\(\GF{2^4}\)</span>
according to the following table:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{tabular}{ll|ll} \hline
  integer &amp; $\GF{2^4}$ &amp; integer &amp; $\GF{2^4}$ \\\hline
  0 &amp; $0$           &amp; 8  &amp; $x^3$              \\
  1 &amp; $1$           &amp; 9  &amp; $x^3 + 1$          \\
  2 &amp; $x$           &amp; 10 &amp; $x^3 + x$          \\
  3 &amp; $x + 1$       &amp; 11 &amp; $x^3 + x + 1$      \\
  4 &amp; $x^2$         &amp; 12 &amp; $x^3 + x^2$        \\
  5 &amp; $x^2 + 1$     &amp; 13 &amp; $x^3 + x^2 + 1$    \\
  6 &amp; $x^2 + x$     &amp; 14 &amp; $x^3 + x^2 + x$    \\
  7 &amp; $x^2 + x + 1$ &amp; 15 &amp; $x^3 + x^2 + x+ 1$ \\\hline
\end{tabular}\end{split}\]</div>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">N</span></code> – a non-negative integer less than or equal to 15, or a list
of such integers</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>Elements of the finite field <span class="math notranslate nohighlight">\(\GF{2^4}\)</span>.</p></li>
</ul>
<p>EXAMPLES:</p>
<p>Obtain the element of <span class="math notranslate nohighlight">\(\GF{2^4}\)</span> representing an integer <span class="math notranslate nohighlight">\(n\)</span>, where
<span class="math notranslate nohighlight">\(0 \leq n \leq 15\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.block_cipher.miniaes</span> <span class="kn">import</span> <span class="n">MiniAES</span>
<span class="gp">sage: </span><span class="n">maes</span> <span class="o">=</span> <span class="n">MiniAES</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">integer_to_GF</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">integer_to_GF</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">integer_to_GF</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">x^2 + x + 1</span>
</pre></div>
</div>
<p>Obtain the finite field elements corresponding to all non-negative
integers less than or equal to 15:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.block_cipher.miniaes</span> <span class="kn">import</span> <span class="n">MiniAES</span>
<span class="gp">sage: </span><span class="n">maes</span> <span class="o">=</span> <span class="n">MiniAES</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)];</span> <span class="n">lst</span>
<span class="go">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">integer_to_GF</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span>

<span class="go">[0,</span>
<span class="go">1,</span>
<span class="go">x,</span>
<span class="go">x + 1,</span>
<span class="go">x^2,</span>
<span class="go">x^2 + 1,</span>
<span class="go">x^2 + x,</span>
<span class="go">x^2 + x + 1,</span>
<span class="go">x^3,</span>
<span class="go">x^3 + 1,</span>
<span class="go">x^3 + x,</span>
<span class="go">x^3 + x + 1,</span>
<span class="go">x^3 + x^2,</span>
<span class="go">x^3 + x^2 + 1,</span>
<span class="go">x^3 + x^2 + x,</span>
<span class="go">x^3 + x^2 + x + 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.block_cipher.miniaes.MiniAES.integer_to_binary">
<span class="sig-name descname"><span class="pre">integer_to_binary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.block_cipher.miniaes.MiniAES.integer_to_binary" title="Permalink to this definition">#</a></dt>
<dd><p>Return the binary representation of <code class="docutils literal notranslate"><span class="pre">N</span></code>. If <span class="math notranslate nohighlight">\(N\)</span> is an integer such
that <span class="math notranslate nohighlight">\(0 \leq N \leq 15\)</span>, return the binary representation of <code class="docutils literal notranslate"><span class="pre">N</span></code>.
If <code class="docutils literal notranslate"><span class="pre">N</span></code> is a list of integers each of which is <span class="math notranslate nohighlight">\(\geq 0\)</span> and
<span class="math notranslate nohighlight">\(\leq 15\)</span>, then obtain the binary representation of each integer,
and concatenate the individual binary representations into a single
binary string. Each integer between 0 and 15, inclusive, can be
associated with a unique 4-bit string according to the following
table:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{tabular}{ll|ll} \hline
  4-bit string &amp; integer &amp; 4-bit string &amp; integer \\\hline
  0000 &amp; 0 &amp; 1000 &amp; 8  \\
  0001 &amp; 1 &amp; 1001 &amp; 9  \\
  0010 &amp; 2 &amp; 1010 &amp; 10 \\
  0011 &amp; 3 &amp; 1011 &amp; 11 \\
  0100 &amp; 4 &amp; 1100 &amp; 12 \\
  0101 &amp; 5 &amp; 1101 &amp; 13 \\
  0110 &amp; 6 &amp; 1110 &amp; 14 \\
  0111 &amp; 7 &amp; 1111 &amp; 15 \\\hline
\end{tabular}\end{split}\]</div>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">N</span></code> – a non-negative integer less than or equal to 15, or a list
of such integers</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>A binary string representing <code class="docutils literal notranslate"><span class="pre">N</span></code>.</p></li>
</ul>
<p>EXAMPLES:</p>
<p>The binary representations of all integers between 0 and
15, inclusive:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.block_cipher.miniaes</span> <span class="kn">import</span> <span class="n">MiniAES</span>
<span class="gp">sage: </span><span class="n">maes</span> <span class="o">=</span> <span class="n">MiniAES</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)];</span> <span class="n">lst</span>
<span class="go">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">integer_to_binary</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span>
<span class="go">0000000100100011010001010110011110001001101010111100110111101111</span>
</pre></div>
</div>
<p>The binary representation of an integer between 0 and 15,
inclusive:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.block_cipher.miniaes</span> <span class="kn">import</span> <span class="n">MiniAES</span>
<span class="gp">sage: </span><span class="n">maes</span> <span class="o">=</span> <span class="n">MiniAES</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">integer_to_binary</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">0011</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">integer_to_binary</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">0101</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">integer_to_binary</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">0111</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.block_cipher.miniaes.MiniAES.mix_column">
<span class="sig-name descname"><span class="pre">mix_column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">block</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.block_cipher.miniaes.MiniAES.mix_column" title="Permalink to this definition">#</a></dt>
<dd><p>Return the matrix multiplication of <code class="docutils literal notranslate"><span class="pre">block</span></code> with a constant matrix.
The constant matrix is</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
  x + 1 &amp; x \\
  x     &amp; x + 1
\end{bmatrix}\end{split}\]</div>
</div>
<p>If the input block is</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
  c_0 &amp; c_2 \\
  c_1 &amp; c_3
\end{bmatrix}\end{split}\]</div>
</div>
<p>then the output block is</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
  d_0 &amp; d_2 \\
  d_1 &amp; d_3
\end{bmatrix}
=
\begin{bmatrix}
  x + 1 &amp; x \\
  x     &amp; x + 1
\end{bmatrix}
\begin{bmatrix}
  c_0 &amp; c_2 \\
  c_1 &amp; c_3
\end{bmatrix}\end{split}\]</div>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">block</span></code> – a <span class="math notranslate nohighlight">\(2 \times 2\)</span> matrix with entries over
<span class="math notranslate nohighlight">\(\GF{2^4}\)</span></p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>A <span class="math notranslate nohighlight">\(2 \times 2\)</span> matrix resulting from multiplying the above constant
matrix with the input matrix <code class="docutils literal notranslate"><span class="pre">block</span></code>.</p></li>
</ul>
<p>EXAMPLES:</p>
<p>Here we work with elements of <span class="math notranslate nohighlight">\(\GF{2^4}\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.block_cipher.miniaes</span> <span class="kn">import</span> <span class="n">MiniAES</span>
<span class="gp">sage: </span><span class="n">maes</span> <span class="o">=</span> <span class="n">MiniAES</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">FiniteField</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MS</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">mat</span> <span class="o">=</span> <span class="n">MS</span><span class="p">([</span> <span class="p">[</span><span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^2 + x + 1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x^2 + 1&quot;</span><span class="p">)],</span> <span class="p">[</span><span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)]</span> <span class="p">])</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">mix_column</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>

<span class="go">[          x^3 + x                 0]</span>
<span class="go">[          x^2 + 1 x^3 + x^2 + x + 1]</span>
</pre></div>
</div>
<p>Multiplying by the identity matrix should leave the constant matrix
unchanged:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">eye</span> <span class="o">=</span> <span class="n">MS</span><span class="p">([</span> <span class="p">[</span><span class="n">K</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">)],</span> <span class="p">[</span><span class="n">K</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">)]</span> <span class="p">])</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">mix_column</span><span class="p">(</span><span class="n">eye</span><span class="p">)</span>

<span class="go">[x + 1     x]</span>
<span class="go">[    x x + 1]</span>
</pre></div>
</div>
<p>We can also work with binary strings:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">bin</span> <span class="o">=</span> <span class="n">BinaryStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="nb">bin</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;rT&quot;</span><span class="p">);</span> <span class="n">B</span>
<span class="go">0111001001010100</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">MS</span><span class="p">(</span><span class="n">maes</span><span class="o">.</span><span class="n">binary_to_GF</span><span class="p">(</span><span class="n">B</span><span class="p">));</span> <span class="n">B</span>

<span class="go">[x^2 + x + 1           x]</span>
<span class="go">[    x^2 + 1         x^2]</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">mix_column</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>

<span class="go">[        x + 1 x^3 + x^2 + x]</span>
<span class="go">[            1           x^3]</span>
</pre></div>
</div>
<p>We can also work with integers <span class="math notranslate nohighlight">\(n\)</span> such that <span class="math notranslate nohighlight">\(0 \leq n \leq 15\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">];</span> <span class="n">P</span>
<span class="go">[10, 5, 2, 7]</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">MS</span><span class="p">(</span><span class="n">maes</span><span class="o">.</span><span class="n">integer_to_GF</span><span class="p">(</span><span class="n">P</span><span class="p">));</span> <span class="n">P</span>

<span class="go">[    x^3 + x     x^2 + 1]</span>
<span class="go">[          x x^2 + x + 1]</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">mix_column</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>

<span class="go">[x^3 + 1       1]</span>
<span class="go">[      1   x + 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.block_cipher.miniaes.MiniAES.nibble_sub">
<span class="sig-name descname"><span class="pre">nibble_sub</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">block</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'encrypt'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.block_cipher.miniaes.MiniAES.nibble_sub" title="Permalink to this definition">#</a></dt>
<dd><p>Substitute a nibble (or a block of 4 bits) using the following S-box:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{tabular}{ll|ll} \hline
  Input &amp; Output &amp; Input &amp; Output \\\hline
  0000  &amp; 1110   &amp; 1000  &amp; 0011   \\
  0001  &amp; 0100   &amp; 1001  &amp; 1010   \\
  0010  &amp; 1101   &amp; 1010  &amp; 0110   \\
  0011  &amp; 0001   &amp; 1011  &amp; 1100   \\
  0100  &amp; 0010   &amp; 1100  &amp; 0101   \\
  0101  &amp; 1111   &amp; 1101  &amp; 1001   \\
  0110  &amp; 1011   &amp; 1110  &amp; 0000   \\
  0111  &amp; 1000   &amp; 1111  &amp; 0111   \\\hline
\end{tabular}\end{split}\]</div>
</div>
<p>The values in the above S-box are taken from the first row of the first
S-box of the Data Encryption Standard (DES). Each nibble can be
thought of as an element of the finite field <span class="math notranslate nohighlight">\(\GF{2^4}\)</span> of 16
elements. Thus in terms of <span class="math notranslate nohighlight">\(\GF{2^4}\)</span>, the S-box can also be
specified as:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{tabular}{ll} \hline
  Input                &amp; Output               \\\hline
  $0$                  &amp;  $x^3 + x^2 + x$     \\
  $1$                  &amp;  $x^2$               \\
  $x$                  &amp;  $x^3 + x^2 + 1$     \\
  $x + 1$              &amp;  $1$                 \\
  $x^2$                &amp;  $x$                 \\
  $x^2 + 1$            &amp;  $x^3 + x^2 + x + 1$ \\
  $x^2 + x$            &amp;  $x^3 + x + 1$       \\
  $x^2 + x + 1$        &amp;  $x^3$               \\
  $x^3$                &amp;  $x + 1$             \\
  $x^3 + 1$            &amp;  $x^3 + x$           \\
  $x^3 + x$            &amp;  $x^2 + x$           \\
  $x^3 + x + 1$        &amp;  $x^3 + x^2$         \\
  $x^3 + x^2$          &amp;  $x^2 + 1$           \\
  $x^3 + x^2 + 1$      &amp;  $x^3 + 1$           \\
  $x^3 + x^2 + x$      &amp;  $0$                 \\
  $x^3 + x^2 + x + 1$  &amp;  $x^2 + x + 1$       \\\hline
\end{tabular}\end{split}\]</div>
</div>
<p>Note that the above S-box is used for encryption. The S-box for
decryption is obtained from the above S-box by reversing the role of
the Input and Output columns. Thus the previous Input column for
encryption now becomes the Output column for decryption, and the
previous Output column for encryption is now the Input column for
decryption. The S-box used for decryption can be specified as:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{tabular}{ll} \hline
  Input               &amp; Output              \\\hline
  $0$                 &amp; $x^3 + x^2 + x$     \\
  $1$                 &amp; $x + 1$             \\
  $x$                 &amp; $x^2$               \\
  $x + 1$             &amp; $x^3$               \\
  $x^2$               &amp; $1$                 \\
  $x^2 + 1$           &amp; $x^3 + x^2$         \\
  $x^2 + x$           &amp; $x^3 + x$           \\
  $x^2 + x + 1$       &amp; $x^3 + x^2 + x + 1$ \\
  $x^3$               &amp; $x^2 + x + 1$       \\
  $x^3 + 1$           &amp; $x^3 + x^2 + 1$     \\
  $x^3 + x$           &amp; $x^3 + 1$           \\
  $x^3 + x + 1$       &amp; $x^2 + x$           \\
  $x^3 + x^2$         &amp; $x^3 + x + 1$       \\
  $x^3 + x^2 + 1$     &amp; $x$                 \\
  $x^3 + x^2 + x$     &amp; $0$                 \\
  $x^3 + x^2 + x + 1$ &amp; $x^2 + 1$           \\\hline
\end{tabular}\end{split}\]</div>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">block</span></code> – a <span class="math notranslate nohighlight">\(2 \times 2\)</span> matrix with entries over
<span class="math notranslate nohighlight">\(\GF{2^4}\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">&quot;encrypt&quot;</span></code>) a string; a flag to signify
whether this nibble-sub operation is used for encryption or
decryption. The encryption flag is <code class="docutils literal notranslate"><span class="pre">&quot;encrypt&quot;</span></code> and the decryption
flag is <code class="docutils literal notranslate"><span class="pre">&quot;decrypt&quot;</span></code>.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>A <span class="math notranslate nohighlight">\(2 \times 2\)</span> matrix resulting from applying an S-box on
entries of the <span class="math notranslate nohighlight">\(2 \times 2\)</span> matrix <code class="docutils literal notranslate"><span class="pre">block</span></code>.</p></li>
</ul>
<p>EXAMPLES:</p>
<p>Here we work with elements of the finite field <span class="math notranslate nohighlight">\(\GF{2^4}\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.block_cipher.miniaes</span> <span class="kn">import</span> <span class="n">MiniAES</span>
<span class="gp">sage: </span><span class="n">maes</span> <span class="o">=</span> <span class="n">MiniAES</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">FiniteField</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MS</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">mat</span> <span class="o">=</span> <span class="n">MS</span><span class="p">([[</span><span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x^2 + x + 1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">)],</span> <span class="p">[</span><span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^2 + x + 1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x&quot;</span><span class="p">)]])</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">nibble_sub</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;encrypt&quot;</span><span class="p">)</span>

<span class="go">[  x^2 + x + 1 x^3 + x^2 + x]</span>
<span class="go">[          x^3       x^2 + x]</span>
</pre></div>
</div>
<p>But we can also work with binary strings:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">bin</span> <span class="o">=</span> <span class="n">BinaryStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="nb">bin</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;bi&quot;</span><span class="p">);</span> <span class="n">B</span>
<span class="go">0110001001101001</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">MS</span><span class="p">(</span><span class="n">maes</span><span class="o">.</span><span class="n">binary_to_GF</span><span class="p">(</span><span class="n">B</span><span class="p">));</span> <span class="n">B</span>

<span class="go">[x^2 + x       x]</span>
<span class="go">[x^2 + x x^3 + 1]</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">nibble_sub</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;encrypt&quot;</span><span class="p">)</span>

<span class="go">[  x^3 + x + 1 x^3 + x^2 + 1]</span>
<span class="go">[  x^3 + x + 1       x^3 + x]</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">nibble_sub</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;decrypt&quot;</span><span class="p">)</span>

<span class="go">[      x^3 + x           x^2]</span>
<span class="go">[      x^3 + x x^3 + x^2 + 1]</span>
</pre></div>
</div>
<p>Here we work with integers <span class="math notranslate nohighlight">\(n\)</span> such that <span class="math notranslate nohighlight">\(0 \leq n \leq 15\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">14</span><span class="p">];</span> <span class="n">P</span>
<span class="go">[2, 6, 8, 14]</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">MS</span><span class="p">(</span><span class="n">maes</span><span class="o">.</span><span class="n">integer_to_GF</span><span class="p">(</span><span class="n">P</span><span class="p">));</span> <span class="n">P</span>

<span class="go">[            x       x^2 + x]</span>
<span class="go">[          x^3 x^3 + x^2 + x]</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">nibble_sub</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;encrypt&quot;</span><span class="p">)</span>

<span class="go">[x^3 + x^2 + 1   x^3 + x + 1]</span>
<span class="go">[        x + 1             0]</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">nibble_sub</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;decrypt&quot;</span><span class="p">)</span>

<span class="go">[        x^2     x^3 + x]</span>
<span class="go">[x^2 + x + 1           0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.block_cipher.miniaes.MiniAES.random_key">
<span class="sig-name descname"><span class="pre">random_key</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.block_cipher.miniaes.MiniAES.random_key" title="Permalink to this definition">#</a></dt>
<dd><p>A random key within the key space of this Mini-AES block cipher. Like
the AES, Phan’s Mini-AES is a symmetric-key block cipher. A Mini-AES
key is a block of 16 bits, or a <span class="math notranslate nohighlight">\(2 \times 2\)</span> matrix with entries over
the finite field <span class="math notranslate nohighlight">\(\GF{2^4}\)</span>. Thus the number of possible keys is
<span class="math notranslate nohighlight">\(2^{16} = 16^4\)</span>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>A <span class="math notranslate nohighlight">\(2 \times 2\)</span> matrix over the finite field <span class="math notranslate nohighlight">\(\GF{2^4}\)</span>, used
as a secret key for this Mini-AES block cipher.</p></li>
</ul>
<p>EXAMPLES:</p>
<p>Each nibble of a key is an element of the finite field
<span class="math notranslate nohighlight">\(\GF{2^4}\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">FiniteField</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.block_cipher.miniaes</span> <span class="kn">import</span> <span class="n">MiniAES</span>
<span class="gp">sage: </span><span class="n">maes</span> <span class="o">=</span> <span class="n">MiniAES</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">key</span> <span class="o">=</span> <span class="n">maes</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">key</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="ow">in</span> <span class="n">K</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">nrows</span><span class="p">())</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">ncols</span><span class="p">())]</span>
<span class="go">[True, True, True, True]</span>
</pre></div>
</div>
<p>Generate a random key, then perform encryption and decryption using
that key:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.block_cipher.miniaes</span> <span class="kn">import</span> <span class="n">MiniAES</span>
<span class="gp">sage: </span><span class="n">maes</span> <span class="o">=</span> <span class="n">MiniAES</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">FiniteField</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MS</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">key</span> <span class="o">=</span> <span class="n">maes</span><span class="o">.</span><span class="n">random_key</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">MS</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">maes</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">plaintxt</span> <span class="o">=</span> <span class="n">maes</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">plaintxt</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.block_cipher.miniaes.MiniAES.round_key">
<span class="sig-name descname"><span class="pre">round_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.block_cipher.miniaes.MiniAES.round_key" title="Permalink to this definition">#</a></dt>
<dd><p>Return the round key for round <code class="docutils literal notranslate"><span class="pre">n</span></code>. Phan’s Mini-AES is defined to
have two rounds. The round key <span class="math notranslate nohighlight">\(K_0\)</span> is generated and used prior to
the first round, with round keys <span class="math notranslate nohighlight">\(K_1\)</span> and <span class="math notranslate nohighlight">\(K_2\)</span> being used in rounds
1 and 2 respectively. In total, there are three round keys, each
generated from the secret key <code class="docutils literal notranslate"><span class="pre">key</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">key</span></code> – the secret key</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – non-negative integer; the round number</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>The <span class="math notranslate nohighlight">\(n\)</span>-th round key.</p></li>
</ul>
<p>EXAMPLES:</p>
<p>Obtaining the round keys from the secret key:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.block_cipher.miniaes</span> <span class="kn">import</span> <span class="n">MiniAES</span>
<span class="gp">sage: </span><span class="n">maes</span> <span class="o">=</span> <span class="n">MiniAES</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">FiniteField</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MS</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">key</span> <span class="o">=</span> <span class="n">MS</span><span class="p">([</span> <span class="p">[</span><span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x^2&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x^2 + x + 1&quot;</span><span class="p">)],</span> <span class="p">[</span><span class="n">K</span><span class="p">(</span><span class="s2">&quot;x + 1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">)]</span> <span class="p">])</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">round_key</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="go">[        x^3 + x^2 x^3 + x^2 + x + 1]</span>
<span class="go">[            x + 1                 0]</span>
<span class="gp">sage: </span><span class="n">key</span>

<span class="go">[        x^3 + x^2 x^3 + x^2 + x + 1]</span>
<span class="go">[            x + 1                 0]</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">round_key</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">[x^3 + x x^2 + x]</span>
<span class="go">[x^3 + 1 x^2 + x]</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">round_key</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="go">[  x^2 + 1   x^3 + x]</span>
<span class="go">[x^3 + x^2 x^3 + x^2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.block_cipher.miniaes.MiniAES.sbox">
<span class="sig-name descname"><span class="pre">sbox</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.block_cipher.miniaes.MiniAES.sbox" title="Permalink to this definition">#</a></dt>
<dd><p>Return the S-box of Mini-AES.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.block_cipher.miniaes</span> <span class="kn">import</span> <span class="n">MiniAES</span>
<span class="gp">sage: </span><span class="n">maes</span> <span class="o">=</span> <span class="n">MiniAES</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">sbox</span><span class="p">()</span>
<span class="go">(14, 4, 13, 1, 2, 15, 11, 8, 3, 10, 6, 12, 5, 9, 0, 7)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.block_cipher.miniaes.MiniAES.shift_row">
<span class="sig-name descname"><span class="pre">shift_row</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">block</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.block_cipher.miniaes.MiniAES.shift_row" title="Permalink to this definition">#</a></dt>
<dd><p>Rotate each row of <code class="docutils literal notranslate"><span class="pre">block</span></code> to the left by different nibble
amounts. The first or zero-th row is left unchanged, while the
second or row one is rotated left by one nibble. This has the effect
of only interchanging the nibbles in the second row. Let
<span class="math notranslate nohighlight">\(b_0, b_1, b_2, b_3\)</span> be four nibbles arranged as the following
<span class="math notranslate nohighlight">\(2 \times 2\)</span> matrix</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
  b_0 &amp; b_2 \\
  b_1 &amp; b_3
\end{bmatrix}\end{split}\]</div>
</div>
<p>Then the operation of shift-row is the mapping</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
  b_0 &amp; b_2 \\
  b_1 &amp; b_3
\end{bmatrix}
\longmapsto
\begin{bmatrix}
  b_0 &amp; b_2 \\
  b_3 &amp; b_1
\end{bmatrix}\end{split}\]</div>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">block</span></code> – a <span class="math notranslate nohighlight">\(2 \times 2\)</span> matrix with entries over
<span class="math notranslate nohighlight">\(\GF{2^4}\)</span></p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>A <span class="math notranslate nohighlight">\(2 \times 2\)</span> matrix resulting from applying shift-row on <code class="docutils literal notranslate"><span class="pre">block</span></code>.</p></li>
</ul>
<p>EXAMPLES:</p>
<p>Here we work with elements of the finite field <span class="math notranslate nohighlight">\(\GF{2^4}\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.block_cipher.miniaes</span> <span class="kn">import</span> <span class="n">MiniAES</span>
<span class="gp">sage: </span><span class="n">maes</span> <span class="o">=</span> <span class="n">MiniAES</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">FiniteField</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MS</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">mat</span> <span class="o">=</span> <span class="n">MS</span><span class="p">([[</span><span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x^2 + x + 1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">)],</span> <span class="p">[</span><span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^2 + x + 1&quot;</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="s2">&quot;x^3 + x&quot;</span><span class="p">)]])</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">shift_row</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>

<span class="go">[x^3 + x^2 + x + 1                 0]</span>
<span class="go">[          x^3 + x       x^2 + x + 1]</span>
<span class="gp">sage: </span><span class="n">mat</span>

<span class="go">[x^3 + x^2 + x + 1                 0]</span>
<span class="go">[      x^2 + x + 1           x^3 + x]</span>
</pre></div>
</div>
<p>But we can also work with binary strings:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">bin</span> <span class="o">=</span> <span class="n">BinaryStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="nb">bin</span><span class="o">.</span><span class="n">encoding</span><span class="p">(</span><span class="s2">&quot;Qt&quot;</span><span class="p">);</span> <span class="n">B</span>
<span class="go">0101000101110100</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">MS</span><span class="p">(</span><span class="n">maes</span><span class="o">.</span><span class="n">binary_to_GF</span><span class="p">(</span><span class="n">B</span><span class="p">));</span> <span class="n">B</span>

<span class="go">[    x^2 + 1           1]</span>
<span class="go">[x^2 + x + 1         x^2]</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">shift_row</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>

<span class="go">[    x^2 + 1           1]</span>
<span class="go">[        x^2 x^2 + x + 1]</span>
</pre></div>
</div>
<p>Here we work with integers <span class="math notranslate nohighlight">\(n\)</span> such that <span class="math notranslate nohighlight">\(0 \leq n \leq 15\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">];</span> <span class="n">P</span>
<span class="go">[3, 6, 9, 12]</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">MS</span><span class="p">(</span><span class="n">maes</span><span class="o">.</span><span class="n">integer_to_GF</span><span class="p">(</span><span class="n">P</span><span class="p">));</span> <span class="n">P</span>

<span class="go">[    x + 1   x^2 + x]</span>
<span class="go">[  x^3 + 1 x^3 + x^2]</span>
<span class="gp">sage: </span><span class="n">maes</span><span class="o">.</span><span class="n">shift_row</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>

<span class="go">[    x + 1   x^2 + x]</span>
<span class="go">[x^3 + x^2   x^3 + 1]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="des.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">DES</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="sdes.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Simplified DES</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2023, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Mini-AES</a><ul>
<li><a class="reference internal" href="#sage.crypto.block_cipher.miniaes.MiniAES"><code class="docutils literal notranslate"><span class="pre">MiniAES</span></code></a><ul>
<li><a class="reference internal" href="#sage.crypto.block_cipher.miniaes.MiniAES.GF_to_binary"><code class="docutils literal notranslate"><span class="pre">GF_to_binary()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.block_cipher.miniaes.MiniAES.GF_to_integer"><code class="docutils literal notranslate"><span class="pre">GF_to_integer()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.block_cipher.miniaes.MiniAES.add_key"><code class="docutils literal notranslate"><span class="pre">add_key()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.block_cipher.miniaes.MiniAES.binary_to_GF"><code class="docutils literal notranslate"><span class="pre">binary_to_GF()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.block_cipher.miniaes.MiniAES.binary_to_integer"><code class="docutils literal notranslate"><span class="pre">binary_to_integer()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.block_cipher.miniaes.MiniAES.block_length"><code class="docutils literal notranslate"><span class="pre">block_length()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.block_cipher.miniaes.MiniAES.decrypt"><code class="docutils literal notranslate"><span class="pre">decrypt()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.block_cipher.miniaes.MiniAES.encrypt"><code class="docutils literal notranslate"><span class="pre">encrypt()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.block_cipher.miniaes.MiniAES.integer_to_GF"><code class="docutils literal notranslate"><span class="pre">integer_to_GF()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.block_cipher.miniaes.MiniAES.integer_to_binary"><code class="docutils literal notranslate"><span class="pre">integer_to_binary()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.block_cipher.miniaes.MiniAES.mix_column"><code class="docutils literal notranslate"><span class="pre">mix_column()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.block_cipher.miniaes.MiniAES.nibble_sub"><code class="docutils literal notranslate"><span class="pre">nibble_sub()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.block_cipher.miniaes.MiniAES.random_key"><code class="docutils literal notranslate"><span class="pre">random_key()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.block_cipher.miniaes.MiniAES.round_key"><code class="docutils literal notranslate"><span class="pre">round_key()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.block_cipher.miniaes.MiniAES.sbox"><code class="docutils literal notranslate"><span class="pre">sbox()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.block_cipher.miniaes.MiniAES.shift_row"><code class="docutils literal notranslate"><span class="pre">shift_row()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/scripts/furo.js"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script src="../../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "lcm": "\\mathop{\\operatorname{lcm}}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="../../../../_static/mathjax/tex-chtml.js"></script>
    </body>
</html>