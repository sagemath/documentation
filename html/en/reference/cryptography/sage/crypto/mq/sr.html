<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="Rijndael-GF" href="rijndael_gf.html" /><link rel="prev" title="Abstract base class for generators of polynomial systems" href="mpolynomialsystemgenerator.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>Small Scale Variants of the AES (SR) Polynomial System Generator - Cryptography</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-furo.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Cryptography</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 10.0 Reference Manual</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../../index.html">Home - Cryptography</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../cryptosystem.html">Cryptosystems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cipher.html">Ciphers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../classical.html">Classical Cryptosystems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../classical_cipher.html">Classical Ciphers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../block_cipher/sdes.html">Simplified DES</a></li>
<li class="toctree-l1"><a class="reference internal" href="../block_cipher/miniaes.html">Mini-AES</a></li>
<li class="toctree-l1"><a class="reference internal" href="../block_cipher/des.html">DES</a></li>
<li class="toctree-l1"><a class="reference internal" href="../block_cipher/present.html">PRESENT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../public_key/blum_goldwasser.html">Blum-Goldwasser Probabilistic Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stream.html">Stream Cryptosystems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stream_cipher.html">Stream Ciphers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lfsr.html">Linear feedback shift register (LFSR) sequence commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../util.html">Utility Functions for Cryptography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../boolean_function.html">Boolean functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sbox.html">S-Boxes and Their Algebraic Representations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sboxes.html">S-Boxes used in cryptographic schemes</a></li>
<li class="toctree-l1"><a class="reference internal" href="mpolynomialsystemgenerator.html">Abstract base class for generators of polynomial systems</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Small Scale Variants of the AES (SR) Polynomial System Generator</a></li>
<li class="toctree-l1"><a class="reference internal" href="rijndael_gf.html">Rijndael-GF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lattice.html">Hard Lattice Generator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lwe.html">(Ring-)LWE oracle generators</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="small-scale-variants-of-the-aes-sr-polynomial-system-generator">
<span id="sage-crypto-mq-sr"></span><h1>Small Scale Variants of the AES (SR) Polynomial System Generator<a class="headerlink" href="#small-scale-variants-of-the-aes-sr-polynomial-system-generator" title="Permalink to this heading">#</a></h1>
<span class="target" id="module-sage.crypto.mq.sr"></span><p>Sage supports polynomial system generation for small scale (and full
scale) AES variants over <span class="math notranslate nohighlight">\(\GF{2}\)</span> and <span class="math notranslate nohighlight">\(\GF{2^e}\)</span>. Also, Sage supports
both the specification of SR as given in the papers <a class="reference internal" href="../../../../references/index.html#cmr2005" id="id1"><span>[CMR2005]</span></a> and
<a class="reference internal" href="../../../../references/index.html#cmr2006" id="id2"><span>[CMR2006]</span></a> and a variant of SR* which is equivalent to AES.</p>
<p>SR is a family of parameterizable variants of the AES suitable as a
framework for comparing different cryptanalytic techniques that can be
brought to bear on the AES. It is different from
<a class="reference internal" href="../block_cipher/miniaes.html#sage.crypto.block_cipher.miniaes.MiniAES" title="sage.crypto.block_cipher.miniaes.MiniAES"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mini-AES</span></code></a>, whose
purpose is as a teaching tool to help beginners understand the basic
structure and working of the full AES.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Martin Albrecht (2008,2009-01): usability improvements</p></li>
<li><p>Martin Albrecht (2007-09): initial version</p></li>
<li><p>Niles Johnson (2010-08): (<a class="reference external" href="https://github.com/sagemath/sage/issues/3893">github issue #3893</a>) <code class="docutils literal notranslate"><span class="pre">random_element()</span></code> should pass on <code class="docutils literal notranslate"><span class="pre">*args</span></code> and <code class="docutils literal notranslate"><span class="pre">**kwds</span></code>.</p></li>
</ul>
<p>EXAMPLES:</p>
<p>We construct SR(1,1,1,4) and study its properties.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">n</span></code> is the number of rounds, <code class="docutils literal notranslate"><span class="pre">r</span></code> the number of rows in the
state array, <code class="docutils literal notranslate"><span class="pre">c</span></code> the number of columns in the state array, and <code class="docutils literal notranslate"><span class="pre">e</span></code> the
degree of the underlying field.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="n">sr</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">sr</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="n">sr</span><span class="o">.</span><span class="n">e</span>
<span class="go">(1, 1, 1, 4)</span>
</pre></div>
</div>
<p>By default variables are ordered reverse to as they appear, e.g.:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">print</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">repr_long</span><span class="p">())</span>
<span class="go">Polynomial Ring</span>
<span class="go">  Base Ring : Finite Field in a of size 2^4</span>
<span class="go">       Size : 20 Variables</span>
<span class="go">   Block  0 : Ordering : deglex</span>
<span class="go">              Names    : k100, k101, k102, k103, x100, x101, x102, x103, w100, w101, w102, w103, s000, s001, s002, s003, k000, k001, k002, k003</span>
</pre></div>
</div>
<p>However, this can be prevented by passing in <code class="docutils literal notranslate"><span class="pre">reverse_variables=False</span></code> to the constructor.</p>
<p>For SR(1, 1, 1, 4) the <code class="docutils literal notranslate"><span class="pre">ShiftRows</span></code> matrix isn’t that interesting.:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">ShiftRows</span>
<span class="go">[1 0 0 0]</span>
<span class="go">[0 1 0 0]</span>
<span class="go">[0 0 1 0]</span>
<span class="go">[0 0 0 1]</span>
</pre></div>
</div>
<p>Also, the <code class="docutils literal notranslate"><span class="pre">MixColumns</span></code> matrix is the identity matrix.:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">MixColumns</span>
<span class="go">[1 0 0 0]</span>
<span class="go">[0 1 0 0]</span>
<span class="go">[0 0 1 0]</span>
<span class="go">[0 0 0 1]</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Lin</span></code>, however, is not the identity matrix.:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">Lin</span>
<span class="go">[          a^2 + 1                 1         a^3 + a^2           a^2 + 1]</span>
<span class="go">[                a                 a                 1 a^3 + a^2 + a + 1]</span>
<span class="go">[          a^3 + a               a^2               a^2                 1]</span>
<span class="go">[                1               a^3             a + 1             a + 1]</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">M</span></code> and <code class="docutils literal notranslate"><span class="pre">Mstar</span></code> are identical for SR(1, 1, 1, 4):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">M</span>
<span class="go">[          a^2 + 1                 1         a^3 + a^2           a^2 + 1]</span>
<span class="go">[                a                 a                 1 a^3 + a^2 + a + 1]</span>
<span class="go">[          a^3 + a               a^2               a^2                 1]</span>
<span class="go">[                1               a^3             a + 1             a + 1]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">Mstar</span>
<span class="go">[          a^2 + 1                 1         a^3 + a^2           a^2 + 1]</span>
<span class="go">[                a                 a                 1 a^3 + a^2 + a + 1]</span>
<span class="go">[          a^3 + a               a^2               a^2                 1]</span>
<span class="go">[                1               a^3             a + 1             a + 1]</span>
</pre></div>
</div>
<p>However, for larger instances of SR Mstar is not equal to M:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">Mstar</span> <span class="o">==</span> <span class="o">~</span><span class="n">sr</span><span class="o">.</span><span class="n">MixColumns</span> <span class="o">*</span> <span class="n">sr</span><span class="o">.</span><span class="n">M</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We can compute a Groebner basis for the ideals spanned by SR
instances to recover all solutions to the system.:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="n">gf2</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">polybori</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="p">,</span><span class="n">s</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">polynomial_system</span><span class="p">(</span><span class="n">P</span><span class="o">=</span><span class="n">P</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()</span>
<span class="go">[k100, k101 + 1, k102, k103 + k003,</span>
<span class="go"> x100 + 1, x101 + k003 + 1, x102 + k003 + 1,</span>
<span class="go"> x103 + k003, w100, w101, w102 + 1, w103 + k003 + 1,</span>
<span class="go"> s000 + 1, s001 + k003, s002 + k003, s003 + k003 + 1,</span>
<span class="go"> k000, k001, k002 + 1]</span>
</pre></div>
</div>
<p>Note that the order of <code class="docutils literal notranslate"><span class="pre">k000</span></code>, <code class="docutils literal notranslate"><span class="pre">k001</span></code>, <code class="docutils literal notranslate"><span class="pre">k002</span></code> and <code class="docutils literal notranslate"><span class="pre">k003</span></code> is
little endian. Thus the result <code class="docutils literal notranslate"><span class="pre">k002</span> <span class="pre">+</span> <span class="pre">1,</span> <span class="pre">k001,</span> <span class="pre">k000</span></code> indicates that
the key is either <span class="math notranslate nohighlight">\(a\)</span> or <span class="math notranslate nohighlight">\(a+1\)</span>. We can verify that both keys encrypt P
to the same ciphertext:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span><span class="p">(</span><span class="n">P</span><span class="p">,[</span><span class="n">a</span><span class="p">])</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="p">(</span><span class="n">P</span><span class="p">,[</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="go">[0]</span>
</pre></div>
</div>
<p>All solutions can easily be recovered using the variety function for ideals.:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">ideal</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">V</span> <span class="ow">in</span> <span class="n">I</span><span class="o">.</span><span class="n">variety</span><span class="p">():</span>
<span class="gp">....: </span>   <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">V</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<span class="gp">....: </span>      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
<span class="gp">....: </span>   <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">k003 0</span>
<span class="go">k002 1</span>
<span class="go">k001 0</span>
<span class="go">k000 0</span>
<span class="go">s003 1</span>
<span class="go">s002 0</span>
<span class="go">s001 0</span>
<span class="go">s000 1</span>
<span class="go">w103 1</span>
<span class="go">w102 1</span>
<span class="go">w101 0</span>
<span class="go">w100 0</span>
<span class="go">x103 0</span>
<span class="go">x102 1</span>
<span class="go">x101 1</span>
<span class="go">x100 1</span>
<span class="go">k103 0</span>
<span class="go">k102 0</span>
<span class="go">k101 1</span>
<span class="go">k100 0</span>

<span class="go">k003 1</span>
<span class="go">k002 1</span>
<span class="go">k001 0</span>
<span class="go">k000 0</span>
<span class="go">s003 0</span>
<span class="go">s002 1</span>
<span class="go">s001 1</span>
<span class="go">s000 1</span>
<span class="go">w103 0</span>
<span class="go">w102 1</span>
<span class="go">w101 0</span>
<span class="go">w100 0</span>
<span class="go">x103 1</span>
<span class="go">x102 0</span>
<span class="go">x101 0</span>
<span class="go">x100 1</span>
<span class="go">k103 1</span>
<span class="go">k102 0</span>
<span class="go">k101 1</span>
<span class="go">k100 0</span>
</pre></div>
</div>
<p>We can also verify the correctness of the variety by evaluating all
ideal generators on all points.:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">V</span> <span class="ow">in</span> <span class="n">I</span><span class="o">.</span><span class="n">variety</span><span class="p">():</span>
<span class="gp">....: </span>    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">I</span><span class="o">.</span><span class="n">gens</span><span class="p">():</span>
<span class="gp">....: </span>        <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">V</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<span class="gp">....: </span>           <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;epic fail&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that the S-Box object for SR can be constructed with a call to <code class="docutils literal notranslate"><span class="pre">sr.sbox()</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="n">gf2</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">polybori</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">sbox</span><span class="p">()</span>
</pre></div>
</div>
<p>For example, we can now study the difference distribution table of <code class="docutils literal notranslate"><span class="pre">S</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">difference_distribution_table</span><span class="p">()</span>
<span class="go">[16  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]</span>
<span class="go">[ 0  2  2  2  2  0  0  0  2  0  0  0  2  4  0  0]</span>
<span class="go">[ 0  2  0  4  2  2  2  0  0  2  0  0  0  0  0  2]</span>
<span class="go">[ 0  2  4  0  0  2  0  0  2  2  0  2  0  0  2  0]</span>
<span class="go">[ 0  0  2  0  4  2  0  0  0  0  2  0  2  0  2  2]</span>
<span class="go">[ 0  0  0  2  0  0  0  2  4  2  0  0  2  0  2  2]</span>
<span class="go">[ 0  4  0  0  0  2  0  2  0  2  2  0  2  2  0  0]</span>
<span class="go">[ 0  2  0  0  0  0  2  0  0  0  0  2  4  2  2  2]</span>
<span class="go">[ 0  2  2  0  0  0  2  2  2  0  2  0  0  0  0  4]</span>
<span class="go">[ 0  0  2  2  0  0  0  0  0  2  2  4  0  2  0  2]</span>
<span class="go">[ 0  0  2  0  2  0  2  2  0  4  0  2  2  0  0  0]</span>
<span class="go">[ 0  0  0  0  2  0  2  0  2  2  4  0  0  2  2  0]</span>
<span class="go">[ 0  0  0  2  0  4  2  0  2  0  2  2  2  0  0  0]</span>
<span class="go">[ 0  0  0  0  2  2  0  4  2  0  0  2  0  2  0  2]</span>
<span class="go">[ 0  0  2  2  0  2  4  2  0  0  0  0  0  2  2  0]</span>
<span class="go">[ 0  2  0  2  2  0  0  2  0  0  2  2  0  0  4  0]</span>
</pre></div>
</div>
<p>or use <code class="docutils literal notranslate"><span class="pre">S</span></code> to find alternative polynomial representations for the S-Box.:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">polynomials</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[x0*x1 + x1*x2 + x0*x3 + x0*y2 + x1 + y0 + y1 + 1,</span>
<span class="go"> x0*x1 + x0*x2 + x0*y0 + x0*y1 + x0*y2 + x1 + x2 + y0 + y1 + y2,</span>
<span class="go"> x0*x1 + x0*x2 + x0*x3 + x1*x3 + x0*y0 + x1*y0 + x0*y1 + x0*y3,</span>
<span class="go"> x0*x1 + x0*x2 + x0*x3 + x1*x3 + x0*y0 + x1*y1 + x0*y3 + x1 + y0 + y1 + 1,</span>
<span class="go"> x0*x1 + x0*x2 + x0*y2 + x1*y2 + x0*y3 + x0 + x1,</span>
<span class="go"> x0*x3 + x1*x3 + x0*y1 + x0*y2 + x1*y3 + x0 + x1 + x2 + x3 + y0 + y1 + y3 + 1,</span>
<span class="go"> x0*x1 + x1*x3 + x2*x3 + x0*y0 + x0*y2 + x0*y3 + x2 + y0 + y3,</span>
<span class="go"> x0*x1 + x0*x2 + x0*x3 + x1*x3 + x2*y0 + x0*y2 + x0 + x2 + x3 + y3,</span>
<span class="go"> x0*x3 + x1*x3 + x0*y0 + x2*y1 + x0*y2 + x3 + y3,</span>
<span class="go"> x0*x1 + x0*x2 + x0*y0 + x0*y1 + x2*y2 + x0*y3 + x1 + y0 + y1 + 1,</span>
<span class="go"> x0*x3 + x1*x3 + x0*y0 + x0*y1 + x0*y3 + x2*y3 + y0 + y3,</span>
<span class="go"> x0*x1 + x0*x2 + x3*y0 + x0*y1 + x0*y3 + y0,</span>
<span class="go"> x0*y0 + x0*y1 + x3*y1 + x0 + x2 + y0 + y3,</span>
<span class="go"> x0*y0 + x3*y2 + y0,</span>
<span class="go"> x0*x1 + x0*x2 + x0*x3 + x1*x3 + x0*y0 + x0*y2 + x3*y3 + y0,</span>
<span class="go"> x0*x2 + x0*x3 + x0*y1 + y0*y1 + x0*y3 + x2 + x3 + y3,</span>
<span class="go"> x0*x2 + x0*y0 + y0*y2 + x0*y3 + x0 + y0,</span>
<span class="go"> x0*x1 + x0*x2 + x1*x3 + x0*y2 + y0*y3 + y0,</span>
<span class="go"> x0*x1 + x0*y0 + y1*y2 + x0*y3 + x1 + x2 + y0 + 1,</span>
<span class="go"> x0*x2 + x1*x3 + x0*y1 + x0*y2 + x0*y3 + y1*y3 + x0 + y0 + y3,</span>
<span class="go"> x0*x1 + x0*x2 + x0*x3 + x0*y1 + x0*y2 + x0*y3 + y2*y3 + x0 + x1 + x2 + x3 + y1 + y3 + 1,</span>
<span class="go"> x0*x1*x2 + x0*x3 + x0*y0 + x0*y1 + x0*y2 + x0,</span>
<span class="go"> x0*x1*x3 + x0*x2 + x0*x3 + x0*y1 + x0*y3 + x0,</span>
<span class="go"> x0*x1*y0 + x0*x1 + x0*y0 + x0,</span>
<span class="go"> x0*x1*y1,</span>
<span class="go"> x0*x1*y2 + x0*x2 + x0*y2 + x0*y3 + x0,</span>
<span class="go"> x0*x1*y3 + x0*x1 + x0*x3 + x0*y0 + x0*y1 + x0*y2 + x0,</span>
<span class="go"> x0*x2*x3 + x0*x1 + x0*x3 + x0*y1 + x0*y2 + x0*y3 + x0,</span>
<span class="go"> x0*x2*y0 + x0*x1 + x0*x2 + x0*x3 + x0*y1 + x0*y2,</span>
<span class="go"> x0*x2*y1 + x0*x2 + x0*x3 + x0*y0 + x0*y1 + x0*y2 + x0,</span>
<span class="go"> x0*x2*y2 + x0*x2 + x0*y3 + x0,</span>
<span class="go"> x0*x2*y3 + x0*x2 + x0*y3 + x0,</span>
<span class="go"> x0*x3*y0 + x0*x1 + x0*x2 + x0*y0 + x0*y1 + x0*y3,</span>
<span class="go"> x0*x3*y1 + x0*x2 + x0*y1 + x0*y3 + x0,</span>
<span class="go"> x0*x3*y2,</span>
<span class="go"> x0*x3*y3 + x0*x1 + x0*y1 + x0*y2 + x0*y3 + x0,</span>
<span class="go"> x0*y0*y1 + x0*y1,</span>
<span class="go"> x0*y0*y2 + x0*x2 + x0*y3 + x0,</span>
<span class="go"> x0*y0*y3 + x0*x1 + x0*x3 + x0*y0 + x0*y1 + x0*y2 + x0*y3 + x0,</span>
<span class="go"> x0*y1*y2 + x0*x2 + x0*y3 + x0,</span>
<span class="go"> x0*y1*y3 + x0*x3 + x0*y0 + x0*y2 + x0*y3,</span>
<span class="go"> x0*y2*y3 + x0*y2,</span>
<span class="go"> x1*x2*x3 + x0*x1 + x1*x3 + x0*y0 + x0*y1 + x2 + x3 + y3,</span>
<span class="go"> x1*x2*y0 + x0*x1 + x1*x3 + x0*y0 + x0*y1 + x2 + x3 + y3,</span>
<span class="go"> x1*x2*y1 + x0*x1 + x1*x3 + x0*y0 + x1 + x2 + x3 + y0 + y1 + y3 + 1,</span>
<span class="go"> x1*x2*y2 + x0*x1 + x0*y0 + x0*y1 + x0 + x1 + y0 + y1 + 1,</span>
<span class="go"> x1*x2*y3 + x0*x1 + x1*x3 + x0*y0 + x1 + x2 + x3 + y0 + y1 + y3 + 1,</span>
<span class="go"> x1*x3*y0 + x0*x1 + x0*x2 + x0*x3 + x1*x3 + x0*y0 + x0*y1 + x0*y3,</span>
<span class="go"> x1*x3*y1 + x0*x2 + x0*x3 + x0*y3 + x2 + x3 + y3,</span>
<span class="go"> x1*x3*y2 + x0*x2 + x0*x3 + x1*x3 + x0*y1 + x0*y3 + x0,</span>
<span class="go"> x1*x3*y3 + x0*x1 + x0*x2 + x0*x3 + x0*y0 + x0*y1 + x0*y3,</span>
<span class="go"> x1*y0*y1 + x0*x2 + x0*x3 + x0*y3 + x2 + x3 + y3,</span>
<span class="go"> x1*y0*y2 + x0*x2 + x0*x3 + x1*x3 + x0*y1 + x0*y3 + x0,</span>
<span class="go"> x1*y0*y3,</span>
<span class="go"> x1*y1*y2 + x0*x1 + x0*x2 + x0*x3 + x1*x3 + x0*y0 + x0*y3 + x1 + y0 + y1 + 1,</span>
<span class="go"> x1*y1*y3 + x0*x1 + x1*x3 + x0*y0 + x1 + x2 + x3 + y0 + y1 + y3 + 1,</span>
<span class="go"> x1*y2*y3 + x0*x1 + x0*x2 + x1*x3 + x0*y0 + x0*y2 + x0*y3 + x0 + x1 + x2 + x3 + y0 + y1 + y3 + 1,</span>
<span class="go"> x2*x3*y0 + x0*x1 + x0*x3 + x1*x3 + x0*y2 + x0*y3 + x2 + x3 + y3,</span>
<span class="go"> x2*x3*y1 + x0*y1 + x0*y2 + x0*y3 + x3 + y0,</span>
<span class="go"> x2*x3*y2 + x1*x3 + x0*y1 + x0 + x2 + x3 + y3,</span>
<span class="go"> x2*x3*y3,</span>
<span class="go"> x2*y0*y1 + x0*x2 + x0*x3 + x0*y0 + x0*y1 + x0*y2 + x0,</span>
<span class="go"> x2*y0*y2 + x0*x2 + x1*x3 + x0*y1 + x0*y3 + x2 + x3 + y3,</span>
<span class="go"> x2*y0*y3 + x0*x2 + x0*y3 + x0,</span>
<span class="go"> x2*y1*y2 + x0*x1 + x0*x2 + x1*x3 + x0*y0 + x0*y3 + x0 + x1 + x2 + x3 + y0 + y1 + y3 + 1,</span>
<span class="go"> x2*y1*y3 + x0*x3 + x1*x3 + x0*y0 + x0*y1 + x0*y3 + y0 + y3,</span>
<span class="go"> x2*y2*y3 + x0*x1 + x0*x2 + x1*x3 + x0*y0 + x0*y3 + x0 + x1 + x2 + x3 + y0 + y1 + y3 + 1,</span>
<span class="go"> x3*y0*y1 + x0*x3 + x0*y1 + x0 + x2 + x3 + y3,</span>
<span class="go"> x3*y0*y2 + x0*y0 + y0,</span>
<span class="go"> x3*y0*y3 + x1*x3 + x0*y1 + x0*y2 + x0*y3 + y0,</span>
<span class="go"> x3*y1*y2 + x0*x2 + x0*x3 + x0*y3 + x2 + x3 + y3,</span>
<span class="go"> x3*y1*y3 + x0*x2 + x0*x3 + x0*y0 + x0*y2 + x0,</span>
<span class="go"> x3*y2*y3 + x0*x2 + x0*x3 + x1*x3 + x0*y0 + x0*y1 + x0*y3 + x0 + y0,</span>
<span class="go"> y0*y1*y2 + x0*x3 + x0 + x2 + x3 + y3,</span>
<span class="go"> y0*y1*y3 + x0*x3 + x0*y0 + x0*y2 + x0*y3,</span>
<span class="go"> y0*y2*y3 + x0*x3 + x1*x3 + x0*y0 + x0*y1 + y0,</span>
<span class="go"> y1*y2*y3 + x0*x1 + x0*x2 + x1*x3 + x0*y0 + x0*y3 + x0 + x1 + x2 + x3 + y0 + y1 + y3 + 1]</span>

<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">interpolation_polynomial</span><span class="p">()</span>
<span class="go">(a^2 + 1)*x^14 + a^2*x^13 + x^12 + a^2*x^11 + a*x^10 + (a^3 + a)*x^9 +</span>
<span class="go">(a^3 + 1)*x^7 + (a^3 + a^2 + a)*x^6 + a^2*x^5 + (a + 1)*x^4 + a^2*x^3 +</span>
<span class="go">(a^3 + a^2 + a)*x^2 + (a^3 + 1)*x + a^2 + a</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="#sage.crypto.mq.sr.SR_gf2_2" title="sage.crypto.mq.sr.SR_gf2_2"><code class="xref py py-class docutils literal notranslate"><span class="pre">SR_gf2_2</span></code></a> gives an example how use alternative polynomial
representations of the S-Box for construction of polynomial systems.</p>
<p>REFERENCES:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../../../references/index.html#cmr2005" id="id3"><span>[CMR2005]</span></a></p></li>
<li><p><a class="reference internal" href="../../../../references/index.html#cmr2006" id="id4"><span>[CMR2006]</span></a></p></li>
<li><p><a class="reference internal" href="../../../../references/index.html#mr2002" id="id5"><span>[MR2002]</span></a></p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.AllowZeroInversionsContext">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.crypto.mq.sr.</span></span><span class="sig-name descname"><span class="pre">AllowZeroInversionsContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.AllowZeroInversionsContext" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Temporarily allow zero inversion.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR">
<span class="sig-prename descclassname"><span class="pre">sage.crypto.mq.sr.</span></span><span class="sig-name descname"><span class="pre">SR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">star</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR" title="Permalink to this definition">#</a></dt>
<dd><p>Return a small scale variant of the AES polynomial system
constructor subject to the following conditions:</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> - the number of rounds (default: 1)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">r</span></code> - the number of rows in the state array (default: 1)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">c</span></code> - the number of columns in the state array (default: 1)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">e</span></code> - the exponent of the finite extension field (default: 4)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">star</span></code> - determines if SR* or SR should be constructed (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aes_mode</span></code> - as the SR key schedule specification differs
slightly from the AES key schedule, this parameter controls
which schedule to use (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gf2</span></code> - generate polynomial systems over <span class="math notranslate nohighlight">\(\GF{2}\)</span> rather than
over <span class="math notranslate nohighlight">\(\GF{2^e}\)</span> (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">polybori</span></code> - use the <code class="docutils literal notranslate"><span class="pre">BooleanPolynomialRing</span></code> as polynomial
representation (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>, <span class="math notranslate nohighlight">\(\GF{2}\)</span> only)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">order</span></code> - a string to specify the term ordering of the
variables (default: <code class="docutils literal notranslate"><span class="pre">deglex</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">postfix</span></code> - a string which is appended after the variable name
(default: ‘’)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">allow_zero_inversions</span></code> - a boolean to control whether zero
inversions raise an exception (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">correct_only</span></code> - only include correct inversion polynomials
(default: <code class="docutils literal notranslate"><span class="pre">False</span></code>, <span class="math notranslate nohighlight">\(\GF{2}\)</span> only)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">biaffine_only</span></code> - only include bilinear and biaffine inversion
polynomials (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>, <span class="math notranslate nohighlight">\(\GF{2}\)</span> only)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ShiftRows</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">shift_rows_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MixColumns</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">mix_columns_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Lin</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">lin_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">MixColumns</span> <span class="o">*</span> <span class="n">ShiftRows</span> <span class="o">*</span> <span class="n">Lin</span>
<span class="gp">sage: </span><span class="nb">print</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">hex_str_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
<span class="go"> 5 1 C 5</span>
<span class="go"> 2 2 1 F</span>
<span class="go"> A 4 4 1</span>
<span class="go"> 1 8 3 3</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ShiftRows</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">shift_rows_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MixColumns</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">mix_columns_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Lin</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">lin_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">MixColumns</span> <span class="o">*</span> <span class="n">ShiftRows</span> <span class="o">*</span> <span class="n">Lin</span>
<span class="gp">sage: </span><span class="nb">print</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">hex_str_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
<span class="go"> F 3 7 F A 2 B A</span>
<span class="go"> A A 5 6 8 8 4 9</span>
<span class="go"> 7 8 8 2 D C C 3</span>
<span class="go"> 4 6 C C 5 E F F</span>
<span class="go"> A 2 B A F 3 7 F</span>
<span class="go"> 8 8 4 9 A A 5 6</span>
<span class="go"> D C C 3 7 8 8 2</span>
<span class="go"> 5 E F F 4 6 C C</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ShiftRows</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">shift_rows_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MixColumns</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">mix_columns_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Lin</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">lin_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">MixColumns</span> <span class="o">*</span> <span class="n">ShiftRows</span> <span class="o">*</span> <span class="n">Lin</span>
<span class="gp">sage: </span><span class="nb">print</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">hex_str_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
<span class="go"> F 3 7 F 0 0 0 0 0 0 0 0 A 2 B A</span>
<span class="go"> A A 5 6 0 0 0 0 0 0 0 0 8 8 4 9</span>
<span class="go"> 7 8 8 2 0 0 0 0 0 0 0 0 D C C 3</span>
<span class="go"> 4 6 C C 0 0 0 0 0 0 0 0 5 E F F</span>
<span class="go"> A 2 B A 0 0 0 0 0 0 0 0 F 3 7 F</span>
<span class="go"> 8 8 4 9 0 0 0 0 0 0 0 0 A A 5 6</span>
<span class="go"> D C C 3 0 0 0 0 0 0 0 0 7 8 8 2</span>
<span class="go"> 5 E F F 0 0 0 0 0 0 0 0 4 6 C C</span>
<span class="go"> 0 0 0 0 A 2 B A F 3 7 F 0 0 0 0</span>
<span class="go"> 0 0 0 0 8 8 4 9 A A 5 6 0 0 0 0</span>
<span class="go"> 0 0 0 0 D C C 3 7 8 8 2 0 0 0 0</span>
<span class="go"> 0 0 0 0 5 E F F 4 6 C C 0 0 0 0</span>
<span class="go"> 0 0 0 0 F 3 7 F A 2 B A 0 0 0 0</span>
<span class="go"> 0 0 0 0 A A 5 6 8 8 4 9 0 0 0 0</span>
<span class="go"> 0 0 0 0 7 8 8 2 D C C 3 0 0 0 0</span>
<span class="go"> 0 0 0 0 4 6 C C 5 E F F 0 0 0 0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_generic">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.crypto.mq.sr.</span></span><span class="sig-name descname"><span class="pre">SR_generic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">star</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_generic" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="mpolynomialsystemgenerator.html#sage.crypto.mq.mpolynomialsystemgenerator.MPolynomialSystemGenerator" title="sage.crypto.mq.mpolynomialsystemgenerator.MPolynomialSystemGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPolynomialSystemGenerator</span></code></a></p>
<p>Small Scale Variants of the AES.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ShiftRows</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">shift_rows_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MixColumns</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">mix_columns_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Lin</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">lin_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">MixColumns</span> <span class="o">*</span> <span class="n">ShiftRows</span> <span class="o">*</span> <span class="n">Lin</span>
<span class="gp">sage: </span><span class="nb">print</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">hex_str_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
<span class="go"> 5 1 C 5</span>
<span class="go"> 2 2 1 F</span>
<span class="go"> A 4 4 1</span>
<span class="go"> 1 8 3 3</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_generic.add_round_key">
<span class="sig-name descname"><span class="pre">add_round_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_generic.add_round_key" title="Permalink to this definition">#</a></dt>
<dd><p>Perform the <code class="docutils literal notranslate"><span class="pre">AddRoundKey</span></code> operation on
<code class="docutils literal notranslate"><span class="pre">d</span></code> using <code class="docutils literal notranslate"><span class="pre">key</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">d</span></code> - state array or something coercible to a
state array</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key</span></code> - state array or something coercible to a
state array</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">random_state_array</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">random_state_array</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">add_round_key</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span> <span class="o">==</span> <span class="n">K</span> <span class="o">+</span> <span class="n">D</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_generic.base_ring">
<span class="sig-name descname"><span class="pre">base_ring</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_generic.base_ring" title="Permalink to this definition">#</a></dt>
<dd><p>Return the base field of self as determined by
<code class="docutils literal notranslate"><span class="pre">self.e</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span><span class="o">.</span><span class="n">polynomial</span><span class="p">()</span>
<span class="go">a^4 + a + 1</span>
</pre></div>
</div>
<p>The Rijndael polynomial:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span><span class="o">.</span><span class="n">polynomial</span><span class="p">()</span>
<span class="go">a^8 + a^4 + a^3 + a + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_generic.block_order">
<span class="sig-name descname"><span class="pre">block_order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_generic.block_order" title="Permalink to this definition">#</a></dt>
<dd><p>Return a block order for self where each round is a block.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">block_order</span><span class="p">()</span>
<span class="go">Block term order with blocks:</span>
<span class="go">(Degree lexicographic term order of length 16,</span>
<span class="go"> Degree lexicographic term order of length 16,</span>
<span class="go"> Degree lexicographic term order of length 4)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">ring</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;block&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">repr_long</span><span class="p">())</span>
<span class="go">Polynomial Ring</span>
<span class="go">  Base Ring : Finite Field in a of size 2^4</span>
<span class="go">       Size : 36 Variables</span>
<span class="go">   Block  0 : Ordering : deglex</span>
<span class="go">              Names    : k200, k201, k202, k203, x200, x201, x202, x203, w200, w201, w202, w203, s100, s101, s102, s103</span>
<span class="go">   Block  1 : Ordering : deglex</span>
<span class="go">              Names    : k100, k101, k102, k103, x100, x101, x102, x103, w100, w101, w102, w103, s000, s001, s002, s003</span>
<span class="go">   Block  2 : Ordering : deglex</span>
<span class="go">              Names    : k000, k001, k002, k003</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_generic.hex_str">
<span class="sig-name descname"><span class="pre">hex_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'matrix'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_generic.hex_str" title="Permalink to this definition">#</a></dt>
<dd><p>Return a hex string for the provided AES state array/matrix.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">M</span></code> - state array</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">typ</span></code> - controls what to return, either ‘matrix’
or ‘vector’ (default: <code class="docutils literal notranslate"><span class="pre">'matrix'</span></code>)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="o">.</span><span class="n">gen</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">k</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">hex_str</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">&#39; 1 2 \n 0 4 \n&#39;</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">hex_str</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">typ</span><span class="o">=</span><span class="s1">&#39;vector&#39;</span><span class="p">)</span>
<span class="go">&#39;1024&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_generic.hex_str_matrix">
<span class="sig-name descname"><span class="pre">hex_str_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_generic.hex_str_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Return a two-dimensional AES-like representation of the matrix M.</p>
<p>That is, show the finite field elements as hex strings.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">M</span></code> - an AES state array</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="o">.</span><span class="n">gen</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">k</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">hex_str_matrix</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">&#39; 1 2 \n 0 4 \n&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_generic.hex_str_vector">
<span class="sig-name descname"><span class="pre">hex_str_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_generic.hex_str_vector" title="Permalink to this definition">#</a></dt>
<dd><p>Return a one-dimensional AES-like representation of the matrix M.</p>
<p>That is, show the finite field elements as hex strings.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">M</span></code> - an AES state array</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="o">.</span><span class="n">gen</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">k</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">hex_str_vector</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">&#39;1024&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_generic.is_state_array">
<span class="sig-name descname"><span class="pre">is_state_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_generic.is_state_array" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">d</span></code> is a state array, i.e. has the correct
dimensions and base field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">is_state_array</span><span class="p">(</span> <span class="n">matrix</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">is_state_array</span><span class="p">(</span> <span class="n">matrix</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_generic.key_schedule">
<span class="sig-name descname"><span class="pre">key_schedule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_generic.key_schedule" title="Permalink to this definition">#</a></dt>
<dd><p>Return <span class="math notranslate nohighlight">\(k_i\)</span> for a given <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(k_j\)</span>
with <span class="math notranslate nohighlight">\(j = i-1\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">star</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">allow_zero_inversions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ki</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">state_array</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="n">ki</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">key_schedule</span><span class="p">(</span><span class="n">ki</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">print</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">hex_str_matrix</span><span class="p">(</span><span class="n">ki</span><span class="p">))</span>
<span class="go">B4 3E 23 6F</span>
<span class="go">EF 92 E9 8F</span>
<span class="go">5B E2 51 18</span>
<span class="go">CB 11 CF 8E</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_generic.key_schedule_polynomials">
<span class="sig-name descname"><span class="pre">key_schedule_polynomials</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_generic.key_schedule_polynomials" title="Permalink to this definition">#</a></dt>
<dd><p>Return polynomials for the <span class="math notranslate nohighlight">\(i\)</span>-th round of the key
schedule.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">i</span></code> - round (<span class="math notranslate nohighlight">\(0 \leq i \leq n\)</span>)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">gf2</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">polybori</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>The 0-th subkey is the user provided key, so only conjugacy
relations or field polynomials are added.:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">key_schedule_polynomials</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(k000^2 + k000, k001^2 + k001, k002^2 + k002, k003^2 + k003)</span>
</pre></div>
</div>
<p>The 1-th subkey is derived from the user provided key according to
the key schedule which is non-linear.:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">key_schedule_polynomials</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(k100 + s000 + s002 + s003,</span>
<span class="go"> k101 + s000 + s001 + s003 + 1,</span>
<span class="go"> k102 + s000 + s001 + s002 + 1,</span>
<span class="go"> k103 + s001 + s002 + s003 + 1,</span>
<span class="go"> k100^2 + k100, k101^2 + k101, k102^2 + k102, k103^2 + k103,</span>
<span class="go"> s000^2 + s000, s001^2 + s001, s002^2 + s002, s003^2 + s003,</span>
<span class="go"> s000*k000 + s000*k003 + s001*k002 + s002*k001 + s003*k000,</span>
<span class="go"> s000*k000 + s000*k001 + s001*k000 + s001*k003 + s002*k002 + s003*k001,</span>
<span class="go"> s000*k001 + s000*k002 + s001*k000 + s001*k001 + s002*k000 + s002*k003 + s003*k002,</span>
<span class="go"> s000*k000 + s000*k001 + s000*k003 + s001*k001 + s002*k000 + s002*k002 + s003*k000 + k000,</span>
<span class="go"> s000*k002 + s001*k000 + s001*k001 + s001*k003 + s002*k001 + s003*k000 + s003*k002 + k001,</span>
<span class="go"> s000*k000 + s000*k001 + s000*k002 + s001*k002 + s002*k000 + s002*k001 + s002*k003 + s003*k001 + k002,</span>
<span class="go"> s000*k001 + s001*k000 + s001*k002 + s002*k000 + s003*k001 + s003*k003 + k003,</span>
<span class="go"> s000*k000 + s000*k002 + s000*k003 + s001*k000 + s001*k001 + s002*k002 + s003*k000 + s000,</span>
<span class="go"> s000*k001 + s000*k003 + s001*k001 + s001*k002 + s002*k000 + s002*k003 + s003*k001 + s001,</span>
<span class="go"> s000*k000 + s000*k002 + s001*k000 + s001*k002 + s001*k003 + s002*k000 + s002*k001 + s003*k002 + s002,</span>
<span class="go"> s000*k001 + s000*k002 + s001*k000 + s001*k003 + s002*k001 + s003*k003 + s003,</span>
<span class="go"> s000*k002 + s001*k001 + s002*k000 + s003*k003 + 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_generic.mix_columns">
<span class="sig-name descname"><span class="pre">mix_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_generic.mix_columns" title="Permalink to this definition">#</a></dt>
<dd><p>Perform the <code class="docutils literal notranslate"><span class="pre">MixColumns</span></code> operation on
<code class="docutils literal notranslate"><span class="pre">d</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">d</span></code> - state array or something coercible to a
state array</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">state_array</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="n">E</span>
<span class="go">[1 0 0 0]</span>
<span class="go">[0 1 0 0]</span>
<span class="go">[0 0 1 0]</span>
<span class="go">[0 0 0 1]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">mix_columns</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">[    a a + 1     1     1]</span>
<span class="go">[    1     a a + 1     1]</span>
<span class="go">[    1     1     a a + 1]</span>
<span class="go">[a + 1     1     1     a]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_generic.new_generator">
<span class="sig-name descname"><span class="pre">new_generator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_generic.new_generator" title="Permalink to this definition">#</a></dt>
<dd><p>Return a new <code class="docutils literal notranslate"><span class="pre">SR</span></code> instance equal to this instance
except for the parameters passed explicitly to this function.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">**kwds</span></code> - see the <code class="docutils literal notranslate"><span class="pre">SR</span></code> constructor for accepted
parameters</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span> <span class="n">sr</span>
<span class="go">SR(2,1,1,4)</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">ring</span><span class="p">()</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Finite Field in a of size 2^4</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr2</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">new_generator</span><span class="p">(</span><span class="n">gf2</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span> <span class="n">sr2</span>
<span class="go">SR(2,1,1,4)</span>
<span class="gp">sage: </span><span class="n">sr2</span><span class="o">.</span><span class="n">ring</span><span class="p">()</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Finite Field of size 2</span>
<span class="gp">sage: </span><span class="n">sr3</span> <span class="o">=</span> <span class="n">sr2</span><span class="o">.</span><span class="n">new_generator</span><span class="p">(</span><span class="n">correct_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">sr2</span><span class="o">.</span><span class="n">inversion_polynomials_single_sbox</span><span class="p">())</span>
<span class="go">20</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">sr3</span><span class="o">.</span><span class="n">inversion_polynomials_single_sbox</span><span class="p">())</span>
<span class="go">19</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_generic.polynomial_system">
<span class="sig-name descname"><span class="pre">polynomial_system</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_generic.polynomial_system" title="Permalink to this definition">#</a></dt>
<dd><p>Return a polynomial system for this small scale AES variant for a
given plaintext-key pair.</p>
<p>If neither <code class="docutils literal notranslate"><span class="pre">P</span></code>, <code class="docutils literal notranslate"><span class="pre">K</span></code> nor <code class="docutils literal notranslate"><span class="pre">C</span></code> are provided, a random pair
(<code class="docutils literal notranslate"><span class="pre">P</span></code>, <code class="docutils literal notranslate"><span class="pre">K</span></code>) will be generated. If <code class="docutils literal notranslate"><span class="pre">P</span></code> and <code class="docutils literal notranslate"><span class="pre">C</span></code> are
provided no <code class="docutils literal notranslate"><span class="pre">K</span></code> needs to be provided.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">P</span></code> - vector, list, or tuple (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">K</span></code> - vector, list, or tuple (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">C</span></code> - vector, list, or tuple (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">gf2</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">polybori</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">vector</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">F</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">polynomial_system</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
</pre></div>
</div>
<p>This returns a polynomial system:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span>
<span class="go">Polynomial Sequence with 36 Polynomials in 20 Variables</span>
</pre></div>
</div>
<p>and a solution:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="c1"># random -- maybe we need a better doctest here?</span>
<span class="go">{k000: 1, k001: 0, k003: 1, k002: 0}</span>
</pre></div>
</div>
<p>This solution is not the only solution that we can learn from the
Groebner basis of the system.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span>
<span class="go">[k000 + 1, k001, k003 + 1]</span>
</pre></div>
</div>
<p>In particular we have two solutions:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">ideal</span><span class="p">()</span><span class="o">.</span><span class="n">variety</span><span class="p">())</span>
<span class="go">2</span>
</pre></div>
</div>
<p>In the following example we provide <code class="docutils literal notranslate"><span class="pre">C</span></code> explicitly:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">sr</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="p">,</span><span class="n">s</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">polynomial_system</span><span class="p">(</span><span class="n">P</span><span class="o">=</span><span class="n">P</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span>
<span class="go">Polynomial Sequence with 36 Polynomials in 20 Variables</span>
</pre></div>
</div>
<p>Alternatively, we can use symbols for the <code class="docutils literal notranslate"><span class="pre">P</span></code> and
<code class="docutils literal notranslate"><span class="pre">C</span></code>. First, we have to create a polynomial ring:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">gf2</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">polybori</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">R</span>
<span class="gp">sage: </span><span class="n">vn</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">varstrs</span><span class="p">(</span><span class="s2">&quot;P&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">R</span><span class="o">.</span><span class="n">variable_names</span><span class="p">()</span> <span class="o">+</span> <span class="n">sr</span><span class="o">.</span><span class="n">varstrs</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">BooleanPolynomialRing</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vn</span><span class="p">),</span><span class="n">vn</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="n">R</span>
</pre></div>
</div>
<p>Now, we can construct the purely symbolic equation system:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">vars</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span> <span class="n">C</span>
<span class="go">(C000, C001, C002, C003)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">vars</span><span class="p">(</span><span class="s2">&quot;P&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="p">,</span><span class="n">s</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">polynomial_system</span><span class="p">(</span><span class="n">P</span><span class="o">=</span><span class="n">P</span><span class="p">,</span><span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span>
<span class="go">Polynomial Sequence with 36 Polynomials in 28 Variables</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">part</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(P000 + w100 + k000, P001 + w101 + k001, P002 + w102 + k002, P003 + w103 + k003)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">part</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(k100 + x100 + x102 + x103 + C000, k101 + x100 + x101 + x103 + C001 + 1, ...)</span>
</pre></div>
</div>
<p>We show that the (returned) key is a solution to the returned system:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span> <span class="n">star</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gf2</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">polybori</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>  <span class="c1"># workaround (see :trac:`31891`)</span>
<span class="gp">....: </span>    <span class="k">try</span><span class="p">:</span>
<span class="gp">....: </span>        <span class="n">F</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">polynomial_system</span><span class="p">()</span>
<span class="gp">....: </span>        <span class="k">break</span>
<span class="gp">....: </span>    <span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span>
<span class="gp">....: </span>        <span class="k">pass</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()</span> <span class="c1"># long time</span>
<span class="go">Polynomial Sequence with 1248 Polynomials in 1248 Variables</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_generic.random_element">
<span class="sig-name descname"><span class="pre">random_element</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elem_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vector'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_generic.random_element" title="Permalink to this definition">#</a></dt>
<dd><p>Return a random element for self.  Other arguments and keywords are
passed to random_* methods.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">elem_type</span></code> - either ‘vector’ or ‘state array’
(default: <code class="docutils literal notranslate"><span class="pre">'vector'</span></code>)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Full MatrixSpace of 4 by 1 dense matrices over Finite Field in a of size 2^4</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="s1">&#39;state_array&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Full MatrixSpace of 1 by 1 dense matrices over Finite Field in a of size 2^4</span>
</pre></div>
</div>
<p>Passes extra positional or keyword arguments through:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">density</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[0]</span>
<span class="go">[0]</span>
<span class="go">[0]</span>
<span class="go">[0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_generic.random_state_array">
<span class="sig-name descname"><span class="pre">random_state_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_generic.random_state_array" title="Permalink to this definition">#</a></dt>
<dd><p>Return a random element in <code class="docutils literal notranslate"><span class="pre">MatrixSpace(self.base_ring(),</span>
<span class="pre">self.r,</span> <span class="pre">self.c)</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">random_state_array</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Full MatrixSpace of 2 by 2 dense matrices over Finite Field in a of size 2^4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_generic.random_vector">
<span class="sig-name descname"><span class="pre">random_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_generic.random_vector" title="Permalink to this definition">#</a></dt>
<dd><p>Return a random vector as it might appear in the algebraic
expression of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">random_vector</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Full MatrixSpace of 16 by 1 dense matrices over Finite Field in a of size 2^4</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><span class="math notranslate nohighlight">\(\phi\)</span> was already applied to the result.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_generic.ring">
<span class="sig-name descname"><span class="pre">ring</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse_variables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_generic.ring" title="Permalink to this definition">#</a></dt>
<dd><p>Construct a ring as a base ring for the polynomial system.</p>
<p>By default, variables are ordered in the reverse of their natural
ordering, i.e. the reverse of as they appear.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">order</span></code> - a monomial ordering (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reverse_variables</span></code> - reverse rounds of variables (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>)</p></li>
</ul>
<p>The variable assignment is as follows:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(k_{i,j,l}\)</span> - subkey round <span class="math notranslate nohighlight">\(i\)</span> word <span class="math notranslate nohighlight">\(j\)</span> conjugate/bit <span class="math notranslate nohighlight">\(l\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(s_{i,j,l}\)</span> - subkey inverse round <span class="math notranslate nohighlight">\(i\)</span> word <span class="math notranslate nohighlight">\(j\)</span> conjugate/bit <span class="math notranslate nohighlight">\(l\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(w_{i,j,l}\)</span> - inversion input round <span class="math notranslate nohighlight">\(i\)</span> word <span class="math notranslate nohighlight">\(j\)</span> conjugate/bit <span class="math notranslate nohighlight">\(l\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(x_{i,j,l}\)</span> - inversion output round <span class="math notranslate nohighlight">\(i\)</span> word <span class="math notranslate nohighlight">\(j\)</span> conjugate/bit <span class="math notranslate nohighlight">\(l\)</span></p></li>
</ul>
<p>Note that the variables are ordered in column major ordering
in the state array and that the bits are ordered in little
endian ordering.</p>
<p>For example, if <span class="math notranslate nohighlight">\(x_{0,1,0}\)</span> is a variable over <span class="math notranslate nohighlight">\(\GF{2}\)</span> for
<span class="math notranslate nohighlight">\(r=2\)</span> and <span class="math notranslate nohighlight">\(c=2\)</span> then refers to the <em>most</em> significant bit of
the entry in the position (1,0) in the state array matrix.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">ring</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;block&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">repr_long</span><span class="p">())</span>
<span class="go">Polynomial Ring</span>
<span class="go">  Base Ring : Finite Field in a of size 2^4</span>
<span class="go">       Size : 36 Variables</span>
<span class="go">   Block  0 : Ordering : deglex</span>
<span class="go">              Names    : k200, k201, k202, k203, x200, x201, x202, x203, w200, w201, w202, w203, s100, s101, s102, s103</span>
<span class="go">   Block  1 : Ordering : deglex</span>
<span class="go">              Names    : k100, k101, k102, k103, x100, x101, x102, x103, w100, w101, w102, w103, s000, s001, s002, s003</span>
<span class="go">   Block  2 : Ordering : deglex</span>
<span class="go">              Names    : k000, k001, k002, k003</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_generic.round_polynomials">
<span class="sig-name descname"><span class="pre">round_polynomials</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plaintext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ciphertext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_generic.round_polynomials" title="Permalink to this definition">#</a></dt>
<dd><p>Return list of polynomials for a given round <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">==</span> <span class="pre">0</span></code> a plaintext must be provided, if <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">==</span> <span class="pre">n</span></code> a
ciphertext must be provided.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">i</span></code> - round number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plaintext</span></code> - optional plaintext (mandatory in
first round)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ciphertext</span></code> - optional ciphertext (mandatory in
last round)</p></li>
</ul>
<p>OUTPUT: tuple</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">r</span><span class="o">*</span><span class="n">sr</span><span class="o">.</span><span class="n">c</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">round_polynomials</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">plaintext</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
<span class="go">(w100 + k000..., w101 + k001..., w102 + k002..., w103 + k003...)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_generic.sbox">
<span class="sig-name descname"><span class="pre">sbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inversion_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_generic.sbox" title="Permalink to this definition">#</a></dt>
<dd><p>Return an S-Box object for this SR instance.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">inversion_only</span></code> - do not include the <span class="math notranslate nohighlight">\(\GF{2}\)</span> affine map when
computing the S-Box (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="n">allow_zero_inversions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">sbox</span><span class="p">();</span> <span class="n">S</span>
<span class="go">(6, 11, 5, 4, 2, 14, 7, 10, 9, 13, 15, 12, 3, 1, 0, 8)</span>

<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">sub_byte</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">a^2 + a</span>
<span class="gp">sage: </span><span class="n">sage_eval</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">sub_byte</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">S</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">6</span>

<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">sub_byte</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">a^3 + a + 1</span>
<span class="gp">sage: </span><span class="n">sage_eval</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">sub_byte</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="go">11</span>
<span class="gp">sage: </span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">11</span>

<span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span> <span class="n">allow_zero_inversions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">sbox</span><span class="p">();</span> <span class="n">S</span>
<span class="go">(99, 124, 119, 123, 242, 107, 111, 197, 48, 1, 103, 43,</span>
<span class="go">254, 215, 171, 118, 202, 130, 201, 125, 250, 89, 71, 240,</span>
<span class="go">173, 212, 162, 175, 156, 164, 114, 192, 183, 253, 147, 38,</span>
<span class="go">54, 63, 247, 204, 52, 165, 229, 241, 113, 216, 49, 21, 4,</span>
<span class="go">199, 35, 195, 24, 150, 5, 154, 7, 18, 128, 226, 235, 39,</span>
<span class="go">178, 117, 9, 131, 44, 26, 27, 110, 90, 160, 82, 59, 214,</span>
<span class="go">179, 41, 227, 47, 132, 83, 209, 0, 237, 32, 252, 177, 91,</span>
<span class="go">106, 203, 190, 57, 74, 76, 88, 207, 208, 239, 170, 251,</span>
<span class="go">67, 77, 51, 133, 69, 249, 2, 127, 80, 60, 159, 168, 81,</span>
<span class="go">163, 64, 143, 146, 157, 56, 245, 188, 182, 218, 33, 16,</span>
<span class="go">255, 243, 210, 205, 12, 19, 236, 95, 151, 68, 23, 196,</span>
<span class="go">167, 126, 61, 100, 93, 25, 115, 96, 129, 79, 220, 34, 42,</span>
<span class="go">144, 136, 70, 238, 184, 20, 222, 94, 11, 219, 224, 50, 58,</span>
<span class="go">10, 73, 6, 36, 92, 194, 211, 172, 98, 145, 149, 228, 121,</span>
<span class="go">231, 200, 55, 109, 141, 213, 78, 169, 108, 86, 244, 234,</span>
<span class="go">101, 122, 174, 8, 186, 120, 37, 46, 28, 166, 180, 198,</span>
<span class="go">232, 221, 116, 31, 75, 189, 139, 138, 112, 62, 181, 102,</span>
<span class="go">72, 3, 246, 14, 97, 53, 87, 185, 134, 193, 29, 158, 225,</span>
<span class="go">248, 152, 17, 105, 217, 142, 148, 155, 30, 135, 233, 206,</span>
<span class="go">85, 40, 223, 140, 161, 137, 13, 191, 230, 66, 104, 65,</span>
<span class="go">153, 45, 15, 176, 84, 187, 22)</span>

<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">sub_byte</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">a^6 + a^5 + a + 1</span>

<span class="gp">sage: </span><span class="n">sage_eval</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">sub_byte</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="go">99</span>
<span class="gp">sage: </span><span class="n">S</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">99</span>

<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">sub_byte</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">a^6 + a^5 + a^4 + a^3 + a^2</span>

<span class="gp">sage: </span><span class="n">sage_eval</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">sub_byte</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="go">124</span>

<span class="gp">sage: </span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">124</span>

<span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="n">allow_zero_inversions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">sbox</span><span class="p">(</span><span class="n">inversion_only</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span> <span class="n">S</span>
<span class="go">(0, 1, 9, 14, 13, 11, 7, 6, 15, 2, 12, 5, 10, 4, 3, 8)</span>

<span class="gp">sage: </span><span class="n">S</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>

<span class="gp">sage: </span><span class="n">S</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">k</span><span class="o">.</span><span class="n">gen</span><span class="p">())</span>
<span class="go">a^3 + a + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_generic.sbox_constant">
<span class="sig-name descname"><span class="pre">sbox_constant</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_generic.sbox_constant" title="Permalink to this definition">#</a></dt>
<dd><p>Return the S-Box constant which is added after <span class="math notranslate nohighlight">\(L(x^{-1})\)</span> was
performed. That is <code class="docutils literal notranslate"><span class="pre">0x63</span></code> if <code class="docutils literal notranslate"><span class="pre">e</span> <span class="pre">==</span> <span class="pre">8</span></code> or <code class="docutils literal notranslate"><span class="pre">0x6</span></code> if <code class="docutils literal notranslate"><span class="pre">e</span> <span class="pre">==</span>
<span class="pre">4</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">sbox_constant</span><span class="p">()</span>
<span class="go">a^6 + a^5 + a + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_generic.shift_rows">
<span class="sig-name descname"><span class="pre">shift_rows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_generic.shift_rows" title="Permalink to this definition">#</a></dt>
<dd><p>Perform the <code class="docutils literal notranslate"><span class="pre">ShiftRows</span></code> operation on <code class="docutils literal notranslate"><span class="pre">d</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">d</span></code> - state array or something coercible to a state array</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">state_array</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="n">E</span>
<span class="go">[1 0 0 0]</span>
<span class="go">[0 1 0 0]</span>
<span class="go">[0 0 1 0]</span>
<span class="go">[0 0 0 1]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">shift_rows</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">[1 0 0 0]</span>
<span class="go">[1 0 0 0]</span>
<span class="go">[1 0 0 0]</span>
<span class="go">[1 0 0 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_generic.state_array">
<span class="sig-name descname"><span class="pre">state_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_generic.state_array" title="Permalink to this definition">#</a></dt>
<dd><p>Convert the parameter to a state array.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">d</span></code> - a matrix, a list, or a tuple (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">e1</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">from_integer</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">2</span><span class="p">)];</span> <span class="n">e1</span>
<span class="go">[0, 1, a, a + 1]</span>
<span class="gp">sage: </span><span class="n">e2</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">phi</span><span class="p">(</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">e1</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">state_array</span><span class="p">(</span><span class="n">e1</span><span class="p">)</span> <span class="c1"># note the column major ordering</span>
<span class="go">[    0     a]</span>
<span class="go">[    1 a + 1]</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">state_array</span><span class="p">(</span><span class="n">e2</span><span class="p">)</span>
<span class="go">[    0     a]</span>
<span class="go">[    1 a + 1]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">state_array</span><span class="p">()</span>
<span class="go">[0 0]</span>
<span class="go">[0 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_generic.sub_byte">
<span class="sig-name descname"><span class="pre">sub_byte</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_generic.sub_byte" title="Permalink to this definition">#</a></dt>
<dd><p>Perform <code class="docutils literal notranslate"><span class="pre">SubByte</span></code> on a single byte/halfbyte <code class="docutils literal notranslate"><span class="pre">b</span></code>.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">ZeroDivision</span></code> exception is raised if an attempt is made
to perform an inversion on the zero element. This can be
disabled by passing <code class="docutils literal notranslate"><span class="pre">allow_zero_inversion=True</span></code> to the
constructor. A zero inversion can result in an inconsistent
equation system.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code> - an element in <code class="docutils literal notranslate"><span class="pre">self.base_ring()</span></code></p></li>
</ul>
<p>EXAMPLES:</p>
<p>The S-Box table for <span class="math notranslate nohighlight">\(\GF{2^4}\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">allow_zero_inversions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">sr</span><span class="o">.</span><span class="n">base_ring</span><span class="p">():</span>
<span class="gp">....: </span>   <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% 20s</span><span class="s1"> </span><span class="si">% 20s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">sr</span><span class="o">.</span><span class="n">sub_byte</span><span class="p">(</span><span class="n">e</span><span class="p">)))</span>
<span class="go">                0              a^2 + a</span>
<span class="go">                a              a^2 + 1</span>
<span class="go">              a^2                    a</span>
<span class="go">              a^3              a^3 + 1</span>
<span class="go">            a + 1                  a^2</span>
<span class="go">          a^2 + a          a^2 + a + 1</span>
<span class="go">        a^3 + a^2                a + 1</span>
<span class="go">      a^3 + a + 1            a^3 + a^2</span>
<span class="go">          a^2 + 1        a^3 + a^2 + a</span>
<span class="go">          a^3 + a    a^3 + a^2 + a + 1</span>
<span class="go">      a^2 + a + 1              a^3 + a</span>
<span class="go">    a^3 + a^2 + a                    0</span>
<span class="go">a^3 + a^2 + a + 1                  a^3</span>
<span class="go">    a^3 + a^2 + 1                    1</span>
<span class="go">          a^3 + 1        a^3 + a^2 + 1</span>
<span class="go">                1          a^3 + a + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_generic.sub_bytes">
<span class="sig-name descname"><span class="pre">sub_bytes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_generic.sub_bytes" title="Permalink to this definition">#</a></dt>
<dd><p>Perform the non-linear transform on <code class="docutils literal notranslate"><span class="pre">d</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">d</span></code> - state array or something coercible to a state array</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">gf2</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="p">,</span> <span class="p">[</span><span class="n">k</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">k</span><span class="o">.</span><span class="n">gen</span><span class="p">()])</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">sub_bytes</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">[  a^6 + a^5 + a^4 + a^3 + a^2 a^6 + a^5 + a^4 + a^2 + a + 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_generic.varformatstr">
<span class="sig-name descname"><span class="pre">varformatstr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_generic.varformatstr" title="Permalink to this definition">#</a></dt>
<dd><p>Return a format string which is understood by print et al.</p>
<p>If a numerical value is omitted, the default value of <code class="docutils literal notranslate"><span class="pre">self</span></code>
is used.  The numerical values (<code class="docutils literal notranslate"><span class="pre">n</span></code>, <code class="docutils literal notranslate"><span class="pre">rc</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code>) are used
to determine the width of the respective fields in the format
string.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> - name of the variable</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> - number of rounds (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rc</span></code> - number of rows * number of cols (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">e</span></code> - exponent of base field (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">varformatstr</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="go">&#39;x%01d%01d%01d&#39;</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">varformatstr</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="go">&#39;x%03d%03d%03d&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_generic.variable_dict">
<span class="sig-name descname"><span class="pre">variable_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_generic.variable_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Return a dictionary to access variables in <code class="docutils literal notranslate"><span class="pre">self.R</span></code> by their
names.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">variable_dict</span><span class="p">()</span>
<span class="go">{&#39;k000&#39;: k000,</span>
<span class="go"> &#39;k001&#39;: k001,</span>
<span class="go"> &#39;k002&#39;: k002,</span>
<span class="go"> &#39;k003&#39;: k003,</span>
<span class="go"> &#39;k100&#39;: k100,</span>
<span class="go"> &#39;k101&#39;: k101,</span>
<span class="go"> &#39;k102&#39;: k102,</span>
<span class="go"> &#39;k103&#39;: k103,</span>
<span class="go"> &#39;s000&#39;: s000,</span>
<span class="go"> &#39;s001&#39;: s001,</span>
<span class="go"> &#39;s002&#39;: s002,</span>
<span class="go"> &#39;s003&#39;: s003,</span>
<span class="go"> &#39;w100&#39;: w100,</span>
<span class="go"> &#39;w101&#39;: w101,</span>
<span class="go"> &#39;w102&#39;: w102,</span>
<span class="go"> &#39;w103&#39;: w103,</span>
<span class="go"> &#39;x100&#39;: x100,</span>
<span class="go"> &#39;x101&#39;: x101,</span>
<span class="go"> &#39;x102&#39;: x102,</span>
<span class="go"> &#39;x103&#39;: x103}</span>

<span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">gf2</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">variable_dict</span><span class="p">()</span>
<span class="go">{&#39;k000&#39;: k000,</span>
<span class="go"> &#39;k001&#39;: k001,</span>
<span class="go"> &#39;k002&#39;: k002,</span>
<span class="go"> &#39;k003&#39;: k003,</span>
<span class="go"> &#39;k100&#39;: k100,</span>
<span class="go"> &#39;k101&#39;: k101,</span>
<span class="go"> &#39;k102&#39;: k102,</span>
<span class="go"> &#39;k103&#39;: k103,</span>
<span class="go"> &#39;s000&#39;: s000,</span>
<span class="go"> &#39;s001&#39;: s001,</span>
<span class="go"> &#39;s002&#39;: s002,</span>
<span class="go"> &#39;s003&#39;: s003,</span>
<span class="go"> &#39;w100&#39;: w100,</span>
<span class="go"> &#39;w101&#39;: w101,</span>
<span class="go"> &#39;w102&#39;: w102,</span>
<span class="go"> &#39;w103&#39;: w103,</span>
<span class="go"> &#39;x100&#39;: x100,</span>
<span class="go"> &#39;x101&#39;: x101,</span>
<span class="go"> &#39;x102&#39;: x102,</span>
<span class="go"> &#39;x103&#39;: x103}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_generic.vars">
<span class="sig-name descname"><span class="pre">vars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_generic.vars" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list of variables in <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> - variable name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nr</span></code> - number of round to create variable strings for</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rc</span></code> - number of rounds * number of columns in the state array (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">e</span></code> - exponent of base field (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">vars</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">(x200, x201, x202, x203, x210, x211, x212, x213)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_generic.varstr">
<span class="sig-name descname"><span class="pre">varstr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_generic.varstr" title="Permalink to this definition">#</a></dt>
<dd><p>Return a string representing a variable for the small scale
AES subject to the given constraints.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> - variable name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nr</span></code> - number of round to create variable strings for</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rc</span></code> - row*column index in state array</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">e</span></code> - exponent of base field</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">varstr</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">&#39;x211&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_generic.varstrs">
<span class="sig-name descname"><span class="pre">varstrs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_generic.varstrs" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list of strings representing variables in <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> - variable name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nr</span></code> - number of round to create variable strings for</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rc</span></code> - number of rows * number of columns in the state array (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">e</span></code> - exponent of base field (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">varstrs</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">(&#39;x200&#39;, &#39;x201&#39;, &#39;x202&#39;, &#39;x203&#39;, &#39;x210&#39;, &#39;x211&#39;, &#39;x212&#39;, &#39;x213&#39;)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_gf2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.crypto.mq.sr.</span></span><span class="sig-name descname"><span class="pre">SR_gf2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">star</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_gf2" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.crypto.mq.sr.SR_generic" title="sage.crypto.mq.sr.SR_generic"><code class="xref py py-class docutils literal notranslate"><span class="pre">SR_generic</span></code></a></p>
<p>Small Scale Variants of the AES polynomial system constructor over
<span class="math notranslate nohighlight">\(\GF{2}\)</span>. See help for SR.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="n">gf2</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sr</span>
<span class="go">SR(1,1,1,4)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_gf2.antiphi">
<span class="sig-name descname"><span class="pre">antiphi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_gf2.antiphi" title="Permalink to this definition">#</a></dt>
<dd><p>The operation <span class="math notranslate nohighlight">\(\phi^{-1}\)</span> from <a class="reference internal" href="../../../../references/index.html#mr2002" id="id6"><span>[MR2002]</span></a> or the inverse of <code class="docutils literal notranslate"><span class="pre">self.phi</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">l</span></code> - a vector in the sense of <code class="docutils literal notranslate"><span class="pre">self.is_vector</span></code></p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="n">gf2</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">random_state_array</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">antiphi</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">phi</span><span class="p">(</span><span class="n">A</span><span class="p">))</span> <span class="o">==</span> <span class="n">A</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_gf2.field_polynomials">
<span class="sig-name descname"><span class="pre">field_polynomials</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_gf2.field_polynomials" title="Permalink to this definition">#</a></dt>
<dd><p>Return list of field polynomials for a given round <code class="docutils literal notranslate"><span class="pre">i</span></code> and
name <code class="docutils literal notranslate"><span class="pre">name</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> - variable name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i</span></code> - round number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">l</span></code> - length of variable list (default: <code class="docutils literal notranslate"><span class="pre">None</span></code> = r*c)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">gf2</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">polybori</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">field_polynomials</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">[x200^2 + x200, x201^2 + x201,</span>
<span class="go"> x202^2 + x202, x203^2 + x203,</span>
<span class="go"> x204^2 + x204, x205^2 + x205,</span>
<span class="go"> x206^2 + x206, x207^2 + x207]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">gf2</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">polybori</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">field_polynomials</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_gf2.inversion_polynomials">
<span class="sig-name descname"><span class="pre">inversion_polynomials</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_gf2.inversion_polynomials" title="Permalink to this definition">#</a></dt>
<dd><p>Return polynomials to represent the inversion in the AES S-Box.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">xi</span></code> - output variables</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wi</span></code> - input variables</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">length</span></code> - length of both lists</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">gf2</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">xi</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">vars</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">wi</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">vars</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">inversion_polynomials</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">wi</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">xi</span><span class="p">))[:</span><span class="mi">3</span><span class="p">]</span>
<span class="go">[x100*w100 + x100*w102 + x100*w103 + x100*w107 + x101*w101 + x101*w102 + x101*w106 + x102*w100 + x102*w101 + x102*w105 + x103*w100 + x103*w104 + x104*w103 + x105*w102 + x106*w101 + x107*w100,</span>
<span class="go"> x100*w101 + x100*w103 + x100*w104 + x101*w100 + x101*w102 + x101*w103 + x101*w107 + x102*w101 + x102*w102 + x102*w106 + x103*w100 + x103*w101 + x103*w105 + x104*w100 + x104*w104 + x105*w103 + x106*w102 + x107*w101,</span>
<span class="go"> x100*w102 + x100*w104 + x100*w105 + x101*w101 + x101*w103 + x101*w104 + x102*w100 + x102*w102 + x102*w103 + x102*w107 + x103*w101 + x103*w102 + x103*w106 + x104*w100 + x104*w101 + x104*w105 + x105*w100 + x105*w104 + x106*w103 + x107*w102]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_gf2.inversion_polynomials_single_sbox">
<span class="sig-name descname"><span class="pre">inversion_polynomials_single_sbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biaffine_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correct_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_gf2.inversion_polynomials_single_sbox" title="Permalink to this definition">#</a></dt>
<dd><p>Return inversion polynomials of a single S-Box.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">xi</span></code> - output variables</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wi</span></code> - input variables</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">length</span></code> - length of both lists</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">gf2</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">inversion_polynomials_single_sbox</span><span class="p">())</span>
<span class="go">24</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">inversion_polynomials_single_sbox</span><span class="p">(</span><span class="n">correct_only</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">23</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">inversion_polynomials_single_sbox</span><span class="p">(</span><span class="n">biaffine_only</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="go">40</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">inversion_polynomials_single_sbox</span><span class="p">(</span><span class="n">biaffine_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">correct_only</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">39</span>


<span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">gf2</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">l0</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">inversion_polynomials_single_sbox</span><span class="p">();</span> <span class="nb">len</span><span class="p">(</span><span class="n">l0</span><span class="p">)</span>
<span class="go">24</span>
<span class="gp">sage: </span><span class="n">l1</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">inversion_polynomials_single_sbox</span><span class="p">(</span><span class="n">correct_only</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span> <span class="nb">len</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span>
<span class="go">23</span>
<span class="gp">sage: </span><span class="n">l2</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">inversion_polynomials_single_sbox</span><span class="p">(</span><span class="n">biaffine_only</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span> <span class="nb">len</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span>
<span class="go">40</span>
<span class="gp">sage: </span><span class="n">l3</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">inversion_polynomials_single_sbox</span><span class="p">(</span><span class="n">biaffine_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">correct_only</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span> <span class="nb">len</span><span class="p">(</span><span class="n">l3</span><span class="p">)</span>
<span class="go">39</span>

<span class="gp">sage: </span><span class="nb">set</span><span class="p">(</span><span class="n">l0</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">_inversion_polynomials_single_sbox</span><span class="p">())</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">set</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">_inversion_polynomials_single_sbox</span><span class="p">(</span><span class="n">correct_only</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">set</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">_inversion_polynomials_single_sbox</span><span class="p">(</span><span class="n">biaffine_only</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">set</span><span class="p">(</span><span class="n">l3</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">_inversion_polynomials_single_sbox</span><span class="p">(</span><span class="n">biaffine_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">correct_only</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">gf2</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">l0</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">inversion_polynomials_single_sbox</span><span class="p">();</span> <span class="nb">len</span><span class="p">(</span><span class="n">l0</span><span class="p">)</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">l1</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">inversion_polynomials_single_sbox</span><span class="p">(</span><span class="n">correct_only</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span> <span class="nb">len</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span>
<span class="go">11</span>
<span class="gp">sage: </span><span class="n">l2</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">inversion_polynomials_single_sbox</span><span class="p">(</span><span class="n">biaffine_only</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span> <span class="nb">len</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span>
<span class="go">20</span>
<span class="gp">sage: </span><span class="n">l3</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">inversion_polynomials_single_sbox</span><span class="p">(</span><span class="n">biaffine_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">correct_only</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span> <span class="nb">len</span><span class="p">(</span><span class="n">l3</span><span class="p">)</span>
<span class="go">19</span>

<span class="gp">sage: </span><span class="nb">set</span><span class="p">(</span><span class="n">l0</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">_inversion_polynomials_single_sbox</span><span class="p">())</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">set</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">_inversion_polynomials_single_sbox</span><span class="p">(</span><span class="n">correct_only</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">set</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">_inversion_polynomials_single_sbox</span><span class="p">(</span><span class="n">biaffine_only</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">set</span><span class="p">(</span><span class="n">l3</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">_inversion_polynomials_single_sbox</span><span class="p">(</span><span class="n">biaffine_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">correct_only</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_gf2.is_vector">
<span class="sig-name descname"><span class="pre">is_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_gf2.is_vector" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if the given matrix satisfies the conditions
for a vector as it appears in the algebraic expression of
<code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">d</span></code> - matrix</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="n">gf2</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sr</span>
<span class="go">SR(1,1,1,4)</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">gen</span><span class="p">()])</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">vector</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">is_vector</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">is_vector</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_gf2.lin_matrix">
<span class="sig-name descname"><span class="pre">lin_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_gf2.lin_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Return the <code class="docutils literal notranslate"><span class="pre">Lin</span></code> matrix.</p>
<p>If no <code class="docutils literal notranslate"><span class="pre">length</span></code> is provided, the standard state space size is
used. The key schedule calls this method with an explicit
length argument because only <code class="docutils literal notranslate"><span class="pre">self.r</span></code> S-Box applications are
performed in the key schedule.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">length</span></code> - length of state space (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">gf2</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">lin_matrix</span><span class="p">()</span>
<span class="go">[1 0 1 1]</span>
<span class="go">[1 1 0 1]</span>
<span class="go">[1 1 1 0]</span>
<span class="go">[0 1 1 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_gf2.mix_columns_matrix">
<span class="sig-name descname"><span class="pre">mix_columns_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_gf2.mix_columns_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Return the <code class="docutils literal notranslate"><span class="pre">MixColumns</span></code> matrix.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">gf2</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">random_state_array</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">r1</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">mix_columns</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">r2</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">state_array</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">mix_columns_matrix</span><span class="p">()</span> <span class="o">*</span> <span class="n">sr</span><span class="o">.</span><span class="n">vector</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">r1</span> <span class="o">==</span> <span class="n">r2</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_gf2.phi">
<span class="sig-name descname"><span class="pre">phi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_gf2.phi" title="Permalink to this definition">#</a></dt>
<dd><p>The operation <span class="math notranslate nohighlight">\(\phi\)</span> from <a class="reference internal" href="../../../../references/index.html#mr2002" id="id7"><span>[MR2002]</span></a></p>
<p>Given a list/matrix of elements in <span class="math notranslate nohighlight">\(\GF{2^e}\)</span>, return a
matching list/matrix of elements in <span class="math notranslate nohighlight">\(\GF{2}\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">l</span></code> - element to perform <span class="math notranslate nohighlight">\(\phi\)</span> on.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">diffusion_matrix</span></code> - if <code class="docutils literal notranslate"><span class="pre">True</span></code>, the given matrix <code class="docutils literal notranslate"><span class="pre">l</span></code> is
transformed to a matrix which performs the same operation
over <span class="math notranslate nohighlight">\(\GF{2}\)</span> as <code class="docutils literal notranslate"><span class="pre">l</span></code> over <span class="math notranslate nohighlight">\(\GF{2^n}\)</span> (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>).</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">gf2</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">gen</span><span class="p">(),</span> <span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">phi</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">[0 0]</span>
<span class="go">[0 0]</span>
<span class="go">[1 0]</span>
<span class="go">[0 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_gf2.shift_rows_matrix">
<span class="sig-name descname"><span class="pre">shift_rows_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_gf2.shift_rows_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Return the <code class="docutils literal notranslate"><span class="pre">ShiftRows</span></code> matrix.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">gf2</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">random_state_array</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">r1</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">shift_rows</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">r2</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">state_array</span><span class="p">(</span> <span class="n">sr</span><span class="o">.</span><span class="n">shift_rows_matrix</span><span class="p">()</span> <span class="o">*</span> <span class="n">sr</span><span class="o">.</span><span class="n">vector</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">r1</span> <span class="o">==</span> <span class="n">r2</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_gf2.vector">
<span class="sig-name descname"><span class="pre">vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_gf2.vector" title="Permalink to this definition">#</a></dt>
<dd><p>Constructs a vector suitable for the algebraic representation of
SR.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">d</span></code> - values for vector (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="n">gf2</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sr</span>
<span class="go">SR(1,1,1,4)</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">gen</span><span class="p">()])</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">vector</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">[0]</span>
<span class="go">[0]</span>
<span class="go">[1]</span>
<span class="go">[0]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_gf2_2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.crypto.mq.sr.</span></span><span class="sig-name descname"><span class="pre">SR_gf2_2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">star</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_gf2_2" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.crypto.mq.sr.SR_gf2" title="sage.crypto.mq.sr.SR_gf2"><code class="xref py py-class docutils literal notranslate"><span class="pre">SR_gf2</span></code></a></p>
<p>This is an example how to customize the SR constructor.</p>
<p>In this example, we replace the S-Box inversion polynomials by the
polynomials generated by the S-Box class.</p>
<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_gf2_2.inversion_polynomials_single_sbox">
<span class="sig-name descname"><span class="pre">inversion_polynomials_single_sbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biaffine_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correct_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groebner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_gf2_2.inversion_polynomials_single_sbox" title="Permalink to this definition">#</a></dt>
<dd><p>Return inversion polynomials of a single S-Box.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> - output variables (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">w</span></code> - input variables  (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">biaffine_only</span></code> - ignored (always <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">correct_only</span></code> - ignored (always <code class="docutils literal notranslate"><span class="pre">True</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">groebner</span></code> - precompute the Groebner basis for this S-Box (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>).</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.mq.sr</span> <span class="kn">import</span> <span class="n">SR_gf2_2</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">SR_gf2_2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">),[</span><span class="s1">&#39;x</span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">i</span> for i in range(e)] + [&#39;w%d&#39;%i for i in range(e)],order=&#39;lex&#39;)
<span class="gp">sage: </span><span class="n">X</span><span class="p">,</span><span class="n">W</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">gens</span><span class="p">()[:</span><span class="n">e</span><span class="p">],</span><span class="n">P</span><span class="o">.</span><span class="n">gens</span><span class="p">()[</span><span class="n">e</span><span class="p">:]</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">inversion_polynomials_single_sbox</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">groebner</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[x0 + w0*w1*w2 + w0*w1 + w0*w2 + w0*w3 + w0 + w1 + w2,</span>
<span class="go"> x1 + w0*w1*w3 + w0*w3 + w0 + w1*w3 + w1 + w2*w3,</span>
<span class="go"> x2 + w0*w2*w3 + w0*w2 + w0 + w1*w2 + w1*w3 + w2*w3,</span>
<span class="go"> x3 + w0*w1*w2 + w0 + w1*w2*w3 + w1*w2 + w1*w3 + w1 + w2 + w3]</span>

<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.mq.sr</span> <span class="kn">import</span> <span class="n">SR_gf2_2</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">SR_gf2_2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">inversion_polynomials_single_sbox</span><span class="p">()</span>
<span class="go">[w3*w1 + w3*w0 + w3*x2 + w3*x1 + w3 + w2*w1 + w1 + x3 + x2 + x1,</span>
<span class="go"> w3*w2 + w3*w1 + w3*x3 + w2 + w1 + x3,</span>
<span class="go"> w3*w2 + w3*w1 + w3*x2 + w3 + w2*x3 + x2 + x1,</span>
<span class="go"> w3*w2 + w3*w1 + w3*x3 + w3*x2 + w3*x1 + w3 + w2*x2 + w0 + x3 + x2 + x1 + x0,</span>
<span class="go"> w3*w2 + w3*w1 + w3*x1 + w3*x0 + w2*x1 + w0 + x3 + x0,</span>
<span class="go"> w3*w2 + w3*w1 + w3*w0 + w3*x2 + w3*x1 + w2*w0 + w2*x0 + w0 + x3 + x2 + x1 + x0,</span>
<span class="go"> w3*w2 + w3*x1 + w3 + w2*w0 + w1*w0 + w1 + x3 + x2,</span>
<span class="go"> w3*w2 + w3*w1 + w3*x1 + w1*x3 + x3 + x2 + x1,</span>
<span class="go"> w3*x3 + w3*x2 + w3*x0 + w3 + w1*x2 + w1 + w0 + x2 + x0,</span>
<span class="go"> w3*w2 + w3*w1 + w3*x2 + w3*x1 + w1*x1 + w1 + w0 + x2 + x0,</span>
<span class="go"> w3*w2 + w3*w1 + w3*w0 + w3*x3 + w3*x1 + w2*w0 + w1*x0 + x3 + x2,</span>
<span class="go"> w3*w2 + w3*w1 + w3*x2 + w3*x1 + w3*x0 + w3 + w1 + w0*x3 + x3 + x2,</span>
<span class="go"> w3*w2 + w3*w1 + w3*w0 + w3*x3 + w3 + w2*w0 + w1 + w0*x2 + x3 + x2,</span>
<span class="go"> w3*w0 + w3*x2 + w2*w0 + w0*x1 + w0 + x3 + x1 + x0,</span>
<span class="go"> w3*w0 + w3*x3 + w3*x0 + w2*w0 + w1 + w0*x0 + w0 + x3 + x2,</span>
<span class="go"> w3*w2 + w3 + w1 + x3*x2 + x3 + x1,</span>
<span class="go"> w3*w2 + w3*x3 + w1 + x3*x1 + x3 + x2,</span>
<span class="go"> w3*w2 + w3*w0 + w3*x3 + w3*x2 + w3*x1 + w0 + x3*x0 + x1 + x0,</span>
<span class="go"> w3*w2 + w3*w1 + w3*w0 + w3*x3 + w1 + w0 + x2*x1 + x2 + x0,</span>
<span class="go"> w3*w2 + w2*w0 + w1 + x3 + x2*x0,</span>
<span class="go"> w3*x3 + w3*x1 + w2*w0 + w1 + x3 + x2 + x1*x0 + x1]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_gf2n">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.crypto.mq.sr.</span></span><span class="sig-name descname"><span class="pre">SR_gf2n</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">star</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_gf2n" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.crypto.mq.sr.SR_generic" title="sage.crypto.mq.sr.SR_generic"><code class="xref py py-class docutils literal notranslate"><span class="pre">SR_generic</span></code></a></p>
<p>Small Scale Variants of the AES polynomial system constructor over
<span class="math notranslate nohighlight">\(\GF{2^n}\)</span>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_gf2n.antiphi">
<span class="sig-name descname"><span class="pre">antiphi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_gf2n.antiphi" title="Permalink to this definition">#</a></dt>
<dd><p>The operation <span class="math notranslate nohighlight">\(\phi^{-1}\)</span> from <a class="reference internal" href="../../../../references/index.html#mr2002" id="id8"><span>[MR2002]</span></a> or the inverse of <code class="docutils literal notranslate"><span class="pre">self.phi</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">l</span></code> – a vector in the sense of <a class="reference internal" href="#sage.crypto.mq.sr.SR_gf2n.is_vector" title="sage.crypto.mq.sr.SR_gf2n.is_vector"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_vector()</span></code></a></p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">random_state_array</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">antiphi</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">phi</span><span class="p">(</span><span class="n">A</span><span class="p">))</span> <span class="o">==</span> <span class="n">A</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_gf2n.field_polynomials">
<span class="sig-name descname"><span class="pre">field_polynomials</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_gf2n.field_polynomials" title="Permalink to this definition">#</a></dt>
<dd><p>Return list of conjugacy polynomials for a given round <code class="docutils literal notranslate"><span class="pre">i</span></code>
and name <code class="docutils literal notranslate"><span class="pre">name</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> - variable name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i</span></code> - round number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">l</span></code> - r*c (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">field_polynomials</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">[x200^2 + x201,</span>
<span class="go">x201^2 + x202,</span>
<span class="go">x202^2 + x203,</span>
<span class="go">x203^2 + x204,</span>
<span class="go">x204^2 + x205,</span>
<span class="go">x205^2 + x206,</span>
<span class="go">x206^2 + x207,</span>
<span class="go">x207^2 + x200]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_gf2n.inversion_polynomials">
<span class="sig-name descname"><span class="pre">inversion_polynomials</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_gf2n.inversion_polynomials" title="Permalink to this definition">#</a></dt>
<dd><p>Return polynomials to represent the inversion in the AES S-Box.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">xi</span></code> - output variables</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wi</span></code> - input variables</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">length</span></code> - length of both lists</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">ring</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">xi</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sr</span><span class="o">.</span><span class="n">vars</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">wi</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sr</span><span class="o">.</span><span class="n">vars</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">inversion_polynomials</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">wi</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="go">[x100*w100 + 1,</span>
<span class="go">x101*w101 + 1,</span>
<span class="go">x102*w102 + 1,</span>
<span class="go">x103*w103 + 1,</span>
<span class="go">x104*w104 + 1,</span>
<span class="go">x105*w105 + 1,</span>
<span class="go">x106*w106 + 1,</span>
<span class="go">x107*w107 + 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_gf2n.is_vector">
<span class="sig-name descname"><span class="pre">is_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_gf2n.is_vector" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">d</span></code> can be used as a vector for <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">sr</span>
<span class="go">SR(1,1,1,4)</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">gen</span><span class="p">()])</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">vector</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">is_vector</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">is_vector</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_gf2n.lin_matrix">
<span class="sig-name descname"><span class="pre">lin_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_gf2n.lin_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Return the <code class="docutils literal notranslate"><span class="pre">Lin</span></code> matrix.</p>
<p>If no <code class="docutils literal notranslate"><span class="pre">length</span></code> is provided, the standard state space size is
used. The key schedule calls this method with an explicit
length argument because only <code class="docutils literal notranslate"><span class="pre">self.r</span></code> S-Box applications are
performed in the key schedule.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">length</span></code> - length of state space (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">lin_matrix</span><span class="p">()</span>
<span class="go">[          a^2 + 1                 1         a^3 + a^2           a^2 + 1]</span>
<span class="go">[                a                 a                 1 a^3 + a^2 + a + 1]</span>
<span class="go">[          a^3 + a               a^2               a^2                 1]</span>
<span class="go">[                1               a^3             a + 1             a + 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_gf2n.mix_columns_matrix">
<span class="sig-name descname"><span class="pre">mix_columns_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_gf2n.mix_columns_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Return the <code class="docutils literal notranslate"><span class="pre">MixColumns</span></code> matrix.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">random_state_array</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">r1</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">mix_columns</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">r2</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">state_array</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">mix_columns_matrix</span><span class="p">()</span> <span class="o">*</span> <span class="n">sr</span><span class="o">.</span><span class="n">vector</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">r1</span> <span class="o">==</span> <span class="n">r2</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_gf2n.phi">
<span class="sig-name descname"><span class="pre">phi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_gf2n.phi" title="Permalink to this definition">#</a></dt>
<dd><p>The operation <span class="math notranslate nohighlight">\(\phi\)</span> from <a class="reference internal" href="../../../../references/index.html#mr2002" id="id9"><span>[MR2002]</span></a></p>
<p>Projects state arrays to their algebraic representation.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">l</span></code> - element to perform <span class="math notranslate nohighlight">\(\phi\)</span> on.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">gen</span><span class="p">(),</span> <span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">phi</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">[      a       0]</span>
<span class="go">[    a^2       0]</span>
<span class="go">[  a + 1       0]</span>
<span class="go">[a^2 + 1       0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_gf2n.shift_rows_matrix">
<span class="sig-name descname"><span class="pre">shift_rows_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_gf2n.shift_rows_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Return the <code class="docutils literal notranslate"><span class="pre">ShiftRows</span></code> matrix.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">random_state_array</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">r1</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">shift_rows</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">r2</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">state_array</span><span class="p">(</span> <span class="n">sr</span><span class="o">.</span><span class="n">shift_rows_matrix</span><span class="p">()</span> <span class="o">*</span> <span class="n">sr</span><span class="o">.</span><span class="n">vector</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">r1</span> <span class="o">==</span> <span class="n">r2</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.SR_gf2n.vector">
<span class="sig-name descname"><span class="pre">vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.SR_gf2n.vector" title="Permalink to this definition">#</a></dt>
<dd><p>Constructs a vector suitable for the algebraic representation of
SR, i.e. BES.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">d</span></code> - values for vector, must be understood by <code class="docutils literal notranslate"><span class="pre">self.phi</span></code> (default:<code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sr</span> <span class="o">=</span> <span class="n">mq</span><span class="o">.</span><span class="n">SR</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">sr</span>
<span class="go">SR(1,1,1,4)</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">gen</span><span class="p">()])</span>
<span class="gp">sage: </span><span class="n">sr</span><span class="o">.</span><span class="n">vector</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">[      a]</span>
<span class="go">[    a^2]</span>
<span class="go">[  a + 1]</span>
<span class="go">[a^2 + 1]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.crypto.mq.sr.test_consistency">
<span class="sig-prename descclassname"><span class="pre">sage.crypto.mq.sr.</span></span><span class="sig-name descname"><span class="pre">test_consistency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.mq.sr.test_consistency" title="Permalink to this definition">#</a></dt>
<dd><p>Test all combinations of <code class="docutils literal notranslate"><span class="pre">r</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code> and <code class="docutils literal notranslate"><span class="pre">n</span></code> in <code class="docutils literal notranslate"><span class="pre">(1,</span>
<span class="pre">2)</span></code> for consistency of random encryptions and their polynomial
systems. <span class="math notranslate nohighlight">\(\GF{2}\)</span> and <span class="math notranslate nohighlight">\(\GF{2^e}\)</span> systems are tested. This test takes
a while.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">max_n</span></code> – maximal number of rounds to consider (default: 2)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kwargs</span></code> – are passed to the SR constructor</p></li>
</ul>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="rijndael_gf.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Rijndael-GF</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="mpolynomialsystemgenerator.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Abstract base class for generators of polynomial systems</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2023, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Small Scale Variants of the AES (SR) Polynomial System Generator</a><ul>
<li><a class="reference internal" href="#sage.crypto.mq.sr.AllowZeroInversionsContext"><code class="docutils literal notranslate"><span class="pre">AllowZeroInversionsContext</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR"><code class="docutils literal notranslate"><span class="pre">SR()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_generic"><code class="docutils literal notranslate"><span class="pre">SR_generic</span></code></a><ul>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_generic.add_round_key"><code class="docutils literal notranslate"><span class="pre">add_round_key()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_generic.base_ring"><code class="docutils literal notranslate"><span class="pre">base_ring()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_generic.block_order"><code class="docutils literal notranslate"><span class="pre">block_order()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_generic.hex_str"><code class="docutils literal notranslate"><span class="pre">hex_str()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_generic.hex_str_matrix"><code class="docutils literal notranslate"><span class="pre">hex_str_matrix()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_generic.hex_str_vector"><code class="docutils literal notranslate"><span class="pre">hex_str_vector()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_generic.is_state_array"><code class="docutils literal notranslate"><span class="pre">is_state_array()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_generic.key_schedule"><code class="docutils literal notranslate"><span class="pre">key_schedule()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_generic.key_schedule_polynomials"><code class="docutils literal notranslate"><span class="pre">key_schedule_polynomials()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_generic.mix_columns"><code class="docutils literal notranslate"><span class="pre">mix_columns()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_generic.new_generator"><code class="docutils literal notranslate"><span class="pre">new_generator()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_generic.polynomial_system"><code class="docutils literal notranslate"><span class="pre">polynomial_system()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_generic.random_element"><code class="docutils literal notranslate"><span class="pre">random_element()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_generic.random_state_array"><code class="docutils literal notranslate"><span class="pre">random_state_array()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_generic.random_vector"><code class="docutils literal notranslate"><span class="pre">random_vector()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_generic.ring"><code class="docutils literal notranslate"><span class="pre">ring()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_generic.round_polynomials"><code class="docutils literal notranslate"><span class="pre">round_polynomials()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_generic.sbox"><code class="docutils literal notranslate"><span class="pre">sbox()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_generic.sbox_constant"><code class="docutils literal notranslate"><span class="pre">sbox_constant()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_generic.shift_rows"><code class="docutils literal notranslate"><span class="pre">shift_rows()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_generic.state_array"><code class="docutils literal notranslate"><span class="pre">state_array()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_generic.sub_byte"><code class="docutils literal notranslate"><span class="pre">sub_byte()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_generic.sub_bytes"><code class="docutils literal notranslate"><span class="pre">sub_bytes()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_generic.varformatstr"><code class="docutils literal notranslate"><span class="pre">varformatstr()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_generic.variable_dict"><code class="docutils literal notranslate"><span class="pre">variable_dict()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_generic.vars"><code class="docutils literal notranslate"><span class="pre">vars()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_generic.varstr"><code class="docutils literal notranslate"><span class="pre">varstr()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_generic.varstrs"><code class="docutils literal notranslate"><span class="pre">varstrs()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_gf2"><code class="docutils literal notranslate"><span class="pre">SR_gf2</span></code></a><ul>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_gf2.antiphi"><code class="docutils literal notranslate"><span class="pre">antiphi()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_gf2.field_polynomials"><code class="docutils literal notranslate"><span class="pre">field_polynomials()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_gf2.inversion_polynomials"><code class="docutils literal notranslate"><span class="pre">inversion_polynomials()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_gf2.inversion_polynomials_single_sbox"><code class="docutils literal notranslate"><span class="pre">inversion_polynomials_single_sbox()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_gf2.is_vector"><code class="docutils literal notranslate"><span class="pre">is_vector()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_gf2.lin_matrix"><code class="docutils literal notranslate"><span class="pre">lin_matrix()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_gf2.mix_columns_matrix"><code class="docutils literal notranslate"><span class="pre">mix_columns_matrix()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_gf2.phi"><code class="docutils literal notranslate"><span class="pre">phi()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_gf2.shift_rows_matrix"><code class="docutils literal notranslate"><span class="pre">shift_rows_matrix()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_gf2.vector"><code class="docutils literal notranslate"><span class="pre">vector()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_gf2_2"><code class="docutils literal notranslate"><span class="pre">SR_gf2_2</span></code></a><ul>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_gf2_2.inversion_polynomials_single_sbox"><code class="docutils literal notranslate"><span class="pre">inversion_polynomials_single_sbox()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_gf2n"><code class="docutils literal notranslate"><span class="pre">SR_gf2n</span></code></a><ul>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_gf2n.antiphi"><code class="docutils literal notranslate"><span class="pre">antiphi()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_gf2n.field_polynomials"><code class="docutils literal notranslate"><span class="pre">field_polynomials()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_gf2n.inversion_polynomials"><code class="docutils literal notranslate"><span class="pre">inversion_polynomials()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_gf2n.is_vector"><code class="docutils literal notranslate"><span class="pre">is_vector()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_gf2n.lin_matrix"><code class="docutils literal notranslate"><span class="pre">lin_matrix()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_gf2n.mix_columns_matrix"><code class="docutils literal notranslate"><span class="pre">mix_columns_matrix()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_gf2n.phi"><code class="docutils literal notranslate"><span class="pre">phi()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_gf2n.shift_rows_matrix"><code class="docutils literal notranslate"><span class="pre">shift_rows_matrix()</span></code></a></li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.SR_gf2n.vector"><code class="docutils literal notranslate"><span class="pre">vector()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.crypto.mq.sr.test_consistency"><code class="docutils literal notranslate"><span class="pre">test_consistency()</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/scripts/furo.js"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script src="../../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="../../../../_static/mathjax/tex-chtml.js"></script>
    </body>
</html>