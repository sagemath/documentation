<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=600, initial-scale=1">
    <title>Balanced Incomplete Block Designs (BIBD) &mdash; Sage Reference Manual v7.3: Combinatorics</title>
    
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '7.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v7.3: Combinatorics" href="../../../index.html" />
    <link rel="up" title="Comprehensive Module list" href="../../../module_list.html" />
    <link rel="next" title="Resolvable Balanced Incomplete Block Design (RBIBD)" href="resolvable_bibd.html" />
    <link rel="prev" title="Combinatorial design features that are imported by default in the interpreter namespace" href="all.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="resolvable_bibd.html" title="Resolvable Balanced Incomplete Block Design (RBIBD)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="all.html" title="Combinatorial design features that are imported by default in the interpreter namespace"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Combinatorics</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../../../module_list.html" accesskey="U">Comprehensive Module list</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="balanced-incomplete-block-designs-bibd">
<span id="sage-combinat-designs-bibd"></span><h1>Balanced Incomplete Block Designs (BIBD)<a class="headerlink" href="#balanced-incomplete-block-designs-bibd" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.combinat.designs.bibd"></span><p>This module gathers everything related to Balanced Incomplete Block Designs. One can build a
BIBD (or check that it can be built) with <a class="reference internal" href="#sage.combinat.designs.bibd.balanced_incomplete_block_design" title="sage.combinat.designs.bibd.balanced_incomplete_block_design"><code class="xref py py-func docutils literal"><span class="pre">balanced_incomplete_block_design()</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">BIBD</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">balanced_incomplete_block_design</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>In particular, Sage can build a <span class="math">\((v,k,1)\)</span>-BIBD when one exists for all <span class="math">\(k\leq
5\)</span>. The following functions are available:</p>
<table border="1" class="contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.combinat.designs.bibd.balanced_incomplete_block_design" title="sage.combinat.designs.bibd.balanced_incomplete_block_design"><code class="xref py py-func docutils literal"><span class="pre">balanced_incomplete_block_design()</span></code></a></td>
<td>Return a BIBD of parameters <span class="math">\(v,k\)</span>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.combinat.designs.bibd.BIBD_from_TD" title="sage.combinat.designs.bibd.BIBD_from_TD"><code class="xref py py-func docutils literal"><span class="pre">BIBD_from_TD()</span></code></a></td>
<td>Return a BIBD through TD-based constructions.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.combinat.designs.bibd.BIBD_from_difference_family" title="sage.combinat.designs.bibd.BIBD_from_difference_family"><code class="xref py py-func docutils literal"><span class="pre">BIBD_from_difference_family()</span></code></a></td>
<td>Return the BIBD associated to the difference family <code class="docutils literal"><span class="pre">D</span></code> on the group <code class="docutils literal"><span class="pre">G</span></code>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.combinat.designs.bibd.BIBD_from_PBD" title="sage.combinat.designs.bibd.BIBD_from_PBD"><code class="xref py py-func docutils literal"><span class="pre">BIBD_from_PBD()</span></code></a></td>
<td>Return a <span class="math">\((v,k,1)\)</span>-BIBD from a <span class="math">\((r,K)\)</span>-PBD where <span class="math">\(r=(v-1)/(k-1)\)</span>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.combinat.designs.bibd.PBD_from_TD" title="sage.combinat.designs.bibd.PBD_from_TD"><code class="xref py py-func docutils literal"><span class="pre">PBD_from_TD()</span></code></a></td>
<td>Return a <span class="math">\((kt,\{k,t\})\)</span>-PBD if <span class="math">\(u=0\)</span> and a <span class="math">\((kt+u,\{k,k+1,t,u\})\)</span>-PBD otherwise.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.combinat.designs.bibd.steiner_triple_system" title="sage.combinat.designs.bibd.steiner_triple_system"><code class="xref py py-func docutils literal"><span class="pre">steiner_triple_system()</span></code></a></td>
<td>Return a Steiner Triple System.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.combinat.designs.bibd.v_5_1_BIBD" title="sage.combinat.designs.bibd.v_5_1_BIBD"><code class="xref py py-func docutils literal"><span class="pre">v_5_1_BIBD()</span></code></a></td>
<td>Return a <span class="math">\((v,5,1)\)</span>-BIBD.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.combinat.designs.bibd.v_4_1_BIBD" title="sage.combinat.designs.bibd.v_4_1_BIBD"><code class="xref py py-func docutils literal"><span class="pre">v_4_1_BIBD()</span></code></a></td>
<td>Return a <span class="math">\((v,4,1)\)</span>-BIBD.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.combinat.designs.bibd.PBD_4_5_8_9_12" title="sage.combinat.designs.bibd.PBD_4_5_8_9_12"><code class="xref py py-func docutils literal"><span class="pre">PBD_4_5_8_9_12()</span></code></a></td>
<td>Return a <span class="math">\((v,\{4,5,8,9,12\})\)</span>-PBD on <span class="math">\(v\)</span> elements.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.combinat.designs.bibd.BIBD_5q_5_for_q_prime_power" title="sage.combinat.designs.bibd.BIBD_5q_5_for_q_prime_power"><code class="xref py py-func docutils literal"><span class="pre">BIBD_5q_5_for_q_prime_power()</span></code></a></td>
<td>Return a <span class="math">\((5q,5,1)\)</span>-BIBD with <span class="math">\(q\equiv 1\pmod 4\)</span> a prime power.</td>
</tr>
</tbody>
</table>
<p><strong>Construction of BIBD when</strong> <span class="math">\(k=4\)</span></p>
<p>Decompositions of <span class="math">\(K_v\)</span> into <span class="math">\(K_4\)</span> (i.e. <span class="math">\((v,4,1)\)</span>-BIBD) are built following
Douglas Stinson&#8217;s construction as presented in <a class="reference internal" href="latin_squares.html#stinson2004" id="id1">[Stinson2004]</a> page 167. It is
based upon the construction of <span class="math">\((v\{4,5,8,9,12\})\)</span>-PBD (see the doc of
<a class="reference internal" href="#sage.combinat.designs.bibd.PBD_4_5_8_9_12" title="sage.combinat.designs.bibd.PBD_4_5_8_9_12"><code class="xref py py-func docutils literal"><span class="pre">PBD_4_5_8_9_12()</span></code></a>), knowing that a <span class="math">\((v\{4,5,8,9,12\})\)</span>-PBD on <span class="math">\(v\)</span> points
can always be transformed into a <span class="math">\(((k-1)v+1,4,1)\)</span>-BIBD, which covers all
possible cases of <span class="math">\((v,4,1)\)</span>-BIBD.</p>
<p><strong>Construction of BIBD when</strong> <span class="math">\(k=5\)</span></p>
<p>Decompositions of <span class="math">\(K_v\)</span> into <span class="math">\(K_4\)</span> (i.e. <span class="math">\((v,4,1)\)</span>-BIBD) are built following
Clayton Smith&#8217;s construction <a class="reference internal" href="#claytonsmith" id="id2">[ClaytonSmith]</a>.</p>
<table class="docutils citation" frame="void" id="claytonsmith" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[ClaytonSmith]</td><td><em>(<a class="fn-backref" href="#id2">1</a>, <a class="fn-backref" href="#id3">2</a>, <a class="fn-backref" href="#id7">3</a>, <a class="fn-backref" href="#id10">4</a>)</em> On the existence of <span class="math">\((v,5,1)\)</span>-BIBD.
<a class="reference external" href="http://www.argilo.net/files/bibd.pdf">http://www.argilo.net/files/bibd.pdf</a>
Clayton Smith</td></tr>
</tbody>
</table>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="sage.combinat.designs.bibd.BIBD_5q_5_for_q_prime_power">
<code class="descclassname">sage.combinat.designs.bibd.</code><code class="descname">BIBD_5q_5_for_q_prime_power</code><span class="sig-paren">(</span><em>q</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.bibd.BIBD_5q_5_for_q_prime_power" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <span class="math">\((5q,5,1)\)</span>-BIBD with <span class="math">\(q\equiv 1\pmod 4\)</span> a prime power.</p>
<p>See Theorem 24 <a class="reference internal" href="#claytonsmith" id="id3">[ClaytonSmith]</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">q</span></code> (integer) &#8211; a prime power such that <span class="math">\(q\equiv 1\pmod 4\)</span>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.bibd</span> <span class="kn">import</span> <span class="n">BIBD_5q_5_for_q_prime_power</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">145</span><span class="p">,</span> <span class="mi">185</span><span class="p">,</span> <span class="mi">205</span><span class="p">,</span> <span class="mi">305</span><span class="p">,</span> <span class="mi">405</span><span class="p">,</span> <span class="mi">605</span><span class="p">]:</span> <span class="c1"># long time</span>
<span class="go">....:     _ = BIBD_5q_5_for_q_prime_power(q/5)                      # long time</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.bibd.BIBD_from_PBD">
<code class="descclassname">sage.combinat.designs.bibd.</code><code class="descname">BIBD_from_PBD</code><span class="sig-paren">(</span><em>PBD</em>, <em>v</em>, <em>k</em>, <em>check=True</em>, <em>base_cases={}</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.bibd.BIBD_from_PBD" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <span class="math">\((v,k,1)\)</span>-BIBD from a <span class="math">\((r,K)\)</span>-PBD where <span class="math">\(r=(v-1)/(k-1)\)</span>.</p>
<p>This is Theorem 7.20 from <a class="reference internal" href="latin_squares.html#stinson2004" id="id4">[Stinson2004]</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">v,k</span></code> &#8211; integers.</li>
<li><code class="docutils literal"><span class="pre">PBD</span></code> &#8211; A PBD on <span class="math">\(r=(v-1)/(k-1)\)</span> points, such that for any block of
<code class="docutils literal"><span class="pre">PBD</span></code> of size <span class="math">\(s\)</span> there must exist a <span class="math">\(((k-1)s+1,k,1)\)</span>-BIBD.</li>
<li><code class="docutils literal"><span class="pre">check</span></code> (boolean) &#8211; whether to check that output is correct before
returning it. As this is expected to be useless (but we are cautious
guys), you may want to disable it whenever you want speed. Set to <code class="docutils literal"><span class="pre">True</span></code>
by default.</li>
<li><code class="docutils literal"><span class="pre">base_cases</span></code> &#8211; caching system, for internal use.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.bibd</span> <span class="kn">import</span> <span class="n">PBD_4_5_8_9_12</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.bibd</span> <span class="kn">import</span> <span class="n">BIBD_from_PBD</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.bibd</span> <span class="kn">import</span> <span class="n">is_pairwise_balanced_design</span>
<span class="gp">sage: </span><span class="n">PBD</span> <span class="o">=</span> <span class="n">PBD_4_5_8_9_12</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">bibd</span> <span class="o">=</span> <span class="n">is_pairwise_balanced_design</span><span class="p">(</span><span class="n">BIBD_from_PBD</span><span class="p">(</span><span class="n">PBD</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="mi">52</span><span class="p">,[</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.bibd.BIBD_from_TD">
<code class="descclassname">sage.combinat.designs.bibd.</code><code class="descname">BIBD_from_TD</code><span class="sig-paren">(</span><em>v</em>, <em>k</em>, <em>existence=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.bibd.BIBD_from_TD" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a BIBD through TD-based constructions.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">v,k</span></code> (integers) &#8211; computes a <span class="math">\((v,k,1)\)</span>-BIBD.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">existence</span></code> (boolean) &#8211; instead of building the design, return:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">True</span></code> &#8211; meaning that Sage knows how to build the design</li>
<li><code class="docutils literal"><span class="pre">Unknown</span></code> &#8211; meaning that Sage does not know how to build the
design, but that the design may exist (see <a class="reference external" href="../../../../misc/sage/misc/unknown.html#module-sage.misc.unknown" title="(in Sage Reference Manual: Utilities v7.3)"><code class="xref py py-mod docutils literal"><span class="pre">sage.misc.unknown</span></code></a>).</li>
<li><code class="docutils literal"><span class="pre">False</span></code> &#8211; meaning that the design does not exist.</li>
</ul>
</div></blockquote>
</li>
</ul>
<p>This method implements three constructions:</p>
<ul>
<li><p class="first">If there exists a <span class="math">\(TD(k,v)\)</span> and a <span class="math">\((v,k,1)\)</span>-BIBD then there exists a
<span class="math">\((kv,k,1)\)</span>-BIBD.</p>
<p>The BIBD is obtained from all blocks of the <span class="math">\(TD\)</span>, and from the blocks of
the <span class="math">\((v,k,1)\)</span>-BIBDs defined over the <span class="math">\(k\)</span> groups of the <span class="math">\(TD\)</span>.</p>
</li>
<li><p class="first">If there exists a <span class="math">\(TD(k,v)\)</span> and a <span class="math">\((v+1,k,1)\)</span>-BIBD then there exists a
<span class="math">\((kv+1,k,1)\)</span>-BIBD.</p>
<p>The BIBD is obtained from all blocks of the <span class="math">\(TD\)</span>, and from the blocks of
the <span class="math">\((v+1,k,1)\)</span>-BIBDs defined over the sets <span class="math">\(V_1\cup \infty,\dots,V_k\cup
\infty\)</span> where the <span class="math">\(V_1,\dots,V_k\)</span> are the groups of the TD.</p>
</li>
<li><p class="first">If there exists a <span class="math">\(TD(k,v)\)</span> and a <span class="math">\((v+k,k,1)\)</span>-BIBD then there exists a
<span class="math">\((kv+k,k,1)\)</span>-BIBD.</p>
<p>The BIBD is obtained from all blocks of the <span class="math">\(TD\)</span>, and from the blocks of
the <span class="math">\((v+k,k,1)\)</span>-BIBDs defined over the sets <span class="math">\(V_1\cup
\{\infty_1,\dots,\infty_k\},\dots,V_k\cup \{\infty_1,\dots,\infty_k\}\)</span>
where the <span class="math">\(V_1,\dots,V_k\)</span> are the groups of the TD. By making sure that
all copies of the <span class="math">\((v+k,k,1)\)</span>-BIBD contain the block
<span class="math">\(\{\infty_1,\dots,\infty_k\}\)</span>, the result is also a BIBD.</p>
</li>
</ul>
<p>These constructions can be found in
<a class="reference external" href="http://www.argilo.net/files/bibd.pdf">http://www.argilo.net/files/bibd.pdf</a>.</p>
<p>EXAMPLES:</p>
<p>First construction:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.bibd</span> <span class="kn">import</span> <span class="n">BIBD_from_TD</span>
<span class="gp">sage: </span><span class="n">BIBD_from_TD</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">_</span> <span class="o">=</span> <span class="n">BlockDesign</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="n">BIBD_from_TD</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
<p>Second construction:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.bibd</span> <span class="kn">import</span> <span class="n">BIBD_from_TD</span>
<span class="gp">sage: </span><span class="n">BIBD_from_TD</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">_</span> <span class="o">=</span> <span class="n">BlockDesign</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span><span class="n">BIBD_from_TD</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
<p>Third construction:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.bibd</span> <span class="kn">import</span> <span class="n">BIBD_from_TD</span>
<span class="gp">sage: </span><span class="n">BIBD_from_TD</span><span class="p">(</span><span class="mi">85</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">_</span> <span class="o">=</span> <span class="n">BlockDesign</span><span class="p">(</span><span class="mi">85</span><span class="p">,</span><span class="n">BIBD_from_TD</span><span class="p">(</span><span class="mi">85</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
<p>No idea:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.bibd</span> <span class="kn">import</span> <span class="n">BIBD_from_TD</span>
<span class="gp">sage: </span><span class="n">BIBD_from_TD</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Unknown</span>
<span class="gp">sage: </span><span class="n">BIBD_from_TD</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">I do not know how to build a (20,5,1)-BIBD!</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.bibd.BIBD_from_arc_in_desarguesian_projective_plane">
<code class="descclassname">sage.combinat.designs.bibd.</code><code class="descname">BIBD_from_arc_in_desarguesian_projective_plane</code><span class="sig-paren">(</span><em>n</em>, <em>k</em>, <em>existence=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.bibd.BIBD_from_arc_in_desarguesian_projective_plane" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <span class="math">\((n,k,1)\)</span>-BIBD from a maximal arc in a projective plane.</p>
<p>This function implements a construction from Denniston <a class="reference internal" href="#denniston69" id="id5">[Denniston69]</a>, who
describes a maximal <a class="reference internal" href="#sage.combinat.designs.bibd.BalancedIncompleteBlockDesign.arc" title="sage.combinat.designs.bibd.BalancedIncompleteBlockDesign.arc"><code class="xref py py-meth docutils literal"><span class="pre">arc</span></code></a> in a
<a class="reference internal" href="block_design.html#sage.combinat.designs.block_design.DesarguesianProjectivePlaneDesign" title="sage.combinat.designs.block_design.DesarguesianProjectivePlaneDesign"><code class="xref py py-func docutils literal"><span class="pre">Desarguesian</span> <span class="pre">Projective</span> <span class="pre">Plane</span></code></a> of
order <span class="math">\(2^k\)</span>. From two powers of two <span class="math">\(n,q\)</span> with <span class="math">\(n&lt;q\)</span>, it produces a
<span class="math">\(((n-1)(q+1)+1,n,1)\)</span>-BIBD.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">n,k</span></code> (integers) &#8211; must be powers of two (among other restrictions).</li>
<li><code class="docutils literal"><span class="pre">existence</span></code> (boolean) &#8211; whether to return the BIBD obtained through
this construction (default), or to merely indicate with a boolean return
value whether this method <em>can</em> build the requested BIBD.</li>
</ul>
<p>EXAMPLES:</p>
<p>A <span class="math">\((232,8,1)\)</span>-BIBD:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.bibd</span> <span class="kn">import</span> <span class="n">BIBD_from_arc_in_desarguesian_projective_plane</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.bibd</span> <span class="kn">import</span> <span class="n">BalancedIncompleteBlockDesign</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">BIBD_from_arc_in_desarguesian_projective_plane</span><span class="p">(</span><span class="mi">232</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">BalancedIncompleteBlockDesign</span><span class="p">(</span><span class="mi">232</span><span class="p">,</span><span class="n">D</span><span class="p">)</span>
<span class="go">(232,8,1)-Balanced Incomplete Block Design</span>
</pre></div>
</div>
<p>A <span class="math">\((120,8,1)\)</span>-BIBD:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">BIBD_from_arc_in_desarguesian_projective_plane</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">BalancedIncompleteBlockDesign</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span><span class="n">D</span><span class="p">)</span>
<span class="go">(120,8,1)-Balanced Incomplete Block Design</span>
</pre></div>
</div>
<p>Other parameters:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">BIBD_from_arc_in_desarguesian_projective_plane</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">....:     for n,k in</span>
<span class="go">....:       [(120, 8), (232, 8), (456, 8), (904, 8), (496, 16),</span>
<span class="go">....:        (976, 16), (1936, 16), (2016, 32), (4000, 32), (8128, 64)])</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Of course, not all can be built this way:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">BIBD_from_arc_in_desarguesian_projective_plane</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">BIBD_from_arc_in_desarguesian_projective_plane</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">This function cannot produce a (7,3,1)-BIBD</span>
</pre></div>
</div>
<p>REFERENCE:</p>
<table class="docutils citation" frame="void" id="denniston69" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[Denniston69]</a></td><td>R. H. F. Denniston,
Some maximal arcs in finite projective planes.
Journal of Combinatorial Theory 6, no. 3 (1969): 317-319.
<a class="reference external" href="http://dx.doi.org/10.1016/S0021-9800(69)80095-5">http://dx.doi.org/10.1016/S0021-9800(69)80095-5</a></td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.bibd.BIBD_from_difference_family">
<code class="descclassname">sage.combinat.designs.bibd.</code><code class="descname">BIBD_from_difference_family</code><span class="sig-paren">(</span><em>G</em>, <em>D</em>, <em>lambd=None</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.bibd.BIBD_from_difference_family" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the BIBD associated to the difference family <code class="docutils literal"><span class="pre">D</span></code> on the group <code class="docutils literal"><span class="pre">G</span></code>.</p>
<p>Let <span class="math">\(G\)</span> be a group. A <span class="math">\((G,k,\lambda)\)</span>-<em>difference family</em> is a family <span class="math">\(B =
\{B_1,B_2,\ldots,B_b\}\)</span> of <span class="math">\(k\)</span>-subsets of <span class="math">\(G\)</span> such that for each element of
<span class="math">\(G \backslash \{0\}\)</span> there exists exactly <span class="math">\(\lambda\)</span> pairs of elements
<span class="math">\((x,y)\)</span>, <span class="math">\(x\)</span> and <span class="math">\(y\)</span> belonging to the same block, such that <span class="math">\(x - y = g\)</span> (or
x y^{-1} = g` in multiplicative notation).</p>
<p>If <span class="math">\(\{B_1, B_2, \ldots, B_b\}\)</span> is a <span class="math">\((G,k,\lambda)\)</span>-difference family then
its set of translates <span class="math">\(\{B_i \cdot g; i \in \{1,\ldots,b\}, g \in G\}\)</span> is a
<span class="math">\((v,k,\lambda)\)</span>-BIBD where <span class="math">\(v\)</span> is the cardinality of <span class="math">\(G\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">G</span></code> - a finite additive Abelian group</li>
<li><code class="docutils literal"><span class="pre">D</span></code> - a difference family on <code class="docutils literal"><span class="pre">G</span></code> (short blocks are allowed).</li>
<li><code class="docutils literal"><span class="pre">lambd</span></code> - the <span class="math">\(\lambda\)</span> parameter (optional, only used if <code class="docutils literal"><span class="pre">check</span></code> is
<code class="docutils literal"><span class="pre">True</span></code>)</li>
<li><code class="docutils literal"><span class="pre">check</span></code> - whether or not we check the output (default: <code class="docutils literal"><span class="pre">True</span></code>)</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Zmod</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">16</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">G</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">y</span><span class="p">)</span>
<span class="go">[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]</span>

<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.bibd</span> <span class="kn">import</span> <span class="n">BIBD_from_difference_family</span>
<span class="gp">sage: </span><span class="n">BIBD_from_difference_family</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
<span class="go">[[0, 1, 4, 14, 16],</span>
<span class="go"> [1, 2, 5, 15, 17],</span>
<span class="go"> [2, 3, 6, 16, 18],</span>
<span class="go"> [3, 4, 7, 17, 19],</span>
<span class="go"> [4, 5, 8, 18, 20],</span>
<span class="go"> [5, 6, 9, 19, 0],</span>
<span class="go"> [6, 7, 10, 20, 1],</span>
<span class="go"> [7, 8, 11, 0, 2],</span>
<span class="go"> [8, 9, 12, 1, 3],</span>
<span class="go"> [9, 10, 13, 2, 4],</span>
<span class="go"> [10, 11, 14, 3, 5],</span>
<span class="go"> [11, 12, 15, 4, 6],</span>
<span class="go"> [12, 13, 16, 5, 7],</span>
<span class="go"> [13, 14, 17, 6, 8],</span>
<span class="go"> [14, 15, 18, 7, 9],</span>
<span class="go"> [15, 16, 19, 8, 10],</span>
<span class="go"> [16, 17, 20, 9, 11],</span>
<span class="go"> [17, 18, 0, 10, 12],</span>
<span class="go"> [18, 19, 1, 11, 13],</span>
<span class="go"> [19, 20, 2, 12, 14],</span>
<span class="go"> [20, 0, 3, 13, 15]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.combinat.designs.bibd.BalancedIncompleteBlockDesign">
<em class="property">class </em><code class="descclassname">sage.combinat.designs.bibd.</code><code class="descname">BalancedIncompleteBlockDesign</code><span class="sig-paren">(</span><em>points</em>, <em>blocks</em>, <em>k=None</em>, <em>lambd=1</em>, <em>check=True</em>, <em>copy=True</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.bibd.BalancedIncompleteBlockDesign" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.combinat.designs.bibd.PairwiseBalancedDesign" title="sage.combinat.designs.bibd.PairwiseBalancedDesign"><code class="xref py py-class docutils literal"><span class="pre">sage.combinat.designs.bibd.PairwiseBalancedDesign</span></code></a></p>
<p>&#8221;
Balanced Incomplete Block Design (BIBD)</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">points</span></code> &#8211; the underlying set. If <code class="docutils literal"><span class="pre">points</span></code> is an integer <span class="math">\(v\)</span>, then
the set is considered to be <span class="math">\(\{0, ..., v-1\}\)</span>.</li>
<li><code class="docutils literal"><span class="pre">blocks</span></code> &#8211; collection of blocks</li>
<li><code class="docutils literal"><span class="pre">k</span></code> (integer) &#8211; size of the blocks. Set to <code class="docutils literal"><span class="pre">None</span></code> (automatic guess)
by default.</li>
<li><code class="docutils literal"><span class="pre">lambd</span></code> (integer) &#8211; value of <span class="math">\(\lambda\)</span>, set to <span class="math">\(1\)</span> by default.</li>
<li><code class="docutils literal"><span class="pre">check</span></code> (boolean) &#8211; whether to check that the design is a <span class="math">\(PBD\)</span> with
the right parameters.</li>
<li><code class="docutils literal"><span class="pre">copy</span></code> &#8211; (use with caution) if set to <code class="docutils literal"><span class="pre">False</span></code> then <code class="docutils literal"><span class="pre">blocks</span></code> must be
a list of lists of integers. The list will not be copied but will be
modified in place (each block is sorted, and the whole list is
sorted). Your <code class="docutils literal"><span class="pre">blocks</span></code> object will become the instance&#8217;s internal data.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">b</span><span class="o">=</span><span class="n">designs</span><span class="o">.</span><span class="n">balanced_incomplete_block_design</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> <span class="n">b</span>
<span class="go">(9,3,1)-Balanced Incomplete Block Design</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.combinat.designs.bibd.BalancedIncompleteBlockDesign.arc">
<code class="descname">arc</code><span class="sig-paren">(</span><em>s=2</em>, <em>solver=None</em>, <em>verbose=0</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.bibd.BalancedIncompleteBlockDesign.arc" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <code class="docutils literal"><span class="pre">s</span></code>-arc with maximum cardinality.</p>
<p>A <span class="math">\(s\)</span>-arc is a subset of points in a BIBD that intersects each block on
at most <span class="math">\(s\)</span> points. It is one possible generalization of independent set
for graphs.</p>
<p>A simple counting shows that the cardinality of a <span class="math">\(s\)</span>-arc is at most
<span class="math">\((s-1) * r + 1\)</span> where <span class="math">\(r\)</span> is the number of blocks incident to any point.
A <span class="math">\(s\)</span>-arc in a BIBD with cardinality <span class="math">\((s-1) * r + 1\)</span> is called maximal
and is characterized by the following property: it is not empty and each
block either contains <span class="math">\(0\)</span> or <span class="math">\(s\)</span> points of this arc. Equivalently, the
trace of the BIBD on these points is again a BIBD (with block size <span class="math">\(s\)</span>).</p>
<p>For more informations, see <a class="reference external" href="https://en.wikipedia.org/wiki/Arc_(projective_geometry)">Wikipedia article Arc_(projective_geometry)</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">s</span></code> - (default to <code class="docutils literal"><span class="pre">2</span></code>) the maximum number of points from the arc
in each block</li>
<li><code class="docutils literal"><span class="pre">solver</span></code> &#8211; (default: <code class="docutils literal"><span class="pre">None</span></code>) Specify a Linear Program (LP)
solver to be used. If set to <code class="docutils literal"><span class="pre">None</span></code>, the default one is used. For
more information on LP solvers and which default solver is used, see
the method
<a class="reference external" href="../../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram.solve" title="(in Sage Reference Manual: Numerical Optimization v7.3)"><code class="xref py py-meth docutils literal"><span class="pre">solve</span></code></a>
of the class
<a class="reference external" href="../../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram" title="(in Sage Reference Manual: Numerical Optimization v7.3)"><code class="xref py py-class docutils literal"><span class="pre">MixedIntegerLinearProgram</span></code></a>.</li>
<li><code class="docutils literal"><span class="pre">verbose</span></code> &#8211; integer (default: <code class="docutils literal"><span class="pre">0</span></code>). Sets the level of
verbosity. Set to 0 by default, which means quiet.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">balanced_incomplete_block_design</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a2</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">arc</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">a2</span> <span class="c1"># random</span>
<span class="go">[5, 9, 10, 12, 15, 20]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">a2</span><span class="p">)</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">a4</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">arc</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a4</span> <span class="c1"># random</span>
<span class="go">[0, 1, 2, 5, 6, 8, 9, 10, 11, 12, 13, 14, 15, 16, 18, 20]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">a4</span><span class="p">)</span>
<span class="go">16</span>
</pre></div>
</div>
<p>The <span class="math">\(2\)</span>-arc and <span class="math">\(4\)</span>-arc above are maximal. One can check that they
intersect the blocks in either 0 or <span class="math">\(s\)</span> points. Or equivalently that the
traces are again BIBD:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="mi">21</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="p">(</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="mi">1</span> <span class="o">+</span> <span class="n">r</span><span class="o">*</span><span class="mi">1</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="mi">1</span> <span class="o">+</span> <span class="n">r</span><span class="o">*</span><span class="mi">3</span>
<span class="go">16</span>

<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">a2</span><span class="p">)</span><span class="o">.</span><span class="n">is_t_design</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">return_parameters</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(True, (2, 6, 2, 1))</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">a4</span><span class="p">)</span><span class="o">.</span><span class="n">is_t_design</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">return_parameters</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(True, (2, 16, 4, 1))</span>
</pre></div>
</div>
<p>Some other examples which are not maximal:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">balanced_incomplete_block_design</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a2</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">arc</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="mi">25</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="p">(</span><span class="mi">4</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">a2</span><span class="p">),</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">r</span>
<span class="go">(8, 9)</span>
<span class="gp">sage: </span><span class="n">sa2</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">a2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">set</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sa2</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">b</span><span class="p">))</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">B</span><span class="o">.</span><span class="n">blocks</span><span class="p">())</span>
<span class="go">{0, 1, 2}</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">a2</span><span class="p">)</span><span class="o">.</span><span class="n">is_t_design</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>

<span class="gp">sage: </span><span class="n">a3</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">arc</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">a3</span><span class="p">),</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">r</span>
<span class="go">(15, 17)</span>
<span class="gp">sage: </span><span class="n">sa3</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">a3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">set</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sa3</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">b</span><span class="p">))</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">B</span><span class="o">.</span><span class="n">blocks</span><span class="p">())</span> <span class="o">==</span> <span class="nb">set</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">a3</span><span class="p">)</span><span class="o">.</span><span class="n">is_t_design</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Test consistency with relabeling:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">balanced_incomplete_block_design</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="s2">&quot;abcdefg&quot;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="nb">set</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">arc</span><span class="p">())</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">ground_set</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.bibd.PBD_4_5_8_9_12">
<code class="descclassname">sage.combinat.designs.bibd.</code><code class="descname">PBD_4_5_8_9_12</code><span class="sig-paren">(</span><em>v</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.bibd.PBD_4_5_8_9_12" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <span class="math">\((v,\{4,5,8,9,12\})\)</span>-PBD on <span class="math">\(v\)</span> elements.</p>
<p>A <span class="math">\((v,\{4,5,8,9,12\})\)</span>-PBD exists if and only if <span class="math">\(v\equiv 0,1 \pmod 4\)</span>. The
construction implemented here appears page 168 in <a class="reference internal" href="latin_squares.html#stinson2004" id="id6">[Stinson2004]</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">v</span></code> &#8211; an integer congruent to <span class="math">\(0\)</span> or <span class="math">\(1\)</span> modulo <span class="math">\(4\)</span>.</li>
<li><code class="docutils literal"><span class="pre">check</span></code> (boolean) &#8211; whether to check that output is correct before
returning it. As this is expected to be useless (but we are cautious
guys), you may want to disable it whenever you want speed. Set to <code class="docutils literal"><span class="pre">True</span></code>
by default.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">balanced_incomplete_block_design</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">blocks</span><span class="p">()</span> <span class="c1"># indirect doctest</span>
<span class="go">[[0, 1, 2, 12], [0, 3, 6, 9], [0, 4, 8, 10],</span>
<span class="go"> [0, 5, 7, 11], [0, 13, 26, 39], [0, 14, 25, 28],</span>
<span class="go"> [0, 15, 27, 38], [0, 16, 22, 32], [0, 17, 23, 34],</span>
<span class="gp">...</span>
</pre></div>
</div>
<p>Check that <a class="reference external" href="https://trac.sagemath.org/16476">trac ticket #16476</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.bibd</span> <span class="kn">import</span> <span class="n">PBD_4_5_8_9_12</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">25</span><span class="p">):</span>
<span class="go">....:     _ = PBD_4_5_8_9_12(v)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.bibd.PBD_from_TD">
<code class="descclassname">sage.combinat.designs.bibd.</code><code class="descname">PBD_from_TD</code><span class="sig-paren">(</span><em>k</em>, <em>t</em>, <em>u</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.bibd.PBD_from_TD" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <span class="math">\((kt,\{k,t\})\)</span>-PBD if <span class="math">\(u=0\)</span> and a <span class="math">\((kt+u,\{k,k+1,t,u\})\)</span>-PBD otherwise.</p>
<p>This is theorem 23 from <a class="reference internal" href="#claytonsmith" id="id7">[ClaytonSmith]</a>. The PBD is obtained from the blocks
a truncated <span class="math">\(TD(k+1,t)\)</span>, to which are added the blocks corresponding to the
groups of the TD. When <span class="math">\(u=0\)</span>, a <span class="math">\(TD(k,t)\)</span> is used instead.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">k,t,u</span></code> &#8211; integers such that <span class="math">\(0\leq u \leq t\)</span>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.bibd</span> <span class="kn">import</span> <span class="n">PBD_from_TD</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.bibd</span> <span class="kn">import</span> <span class="n">is_pairwise_balanced_design</span>
<span class="gp">sage: </span><span class="n">PBD</span> <span class="o">=</span> <span class="n">PBD_from_TD</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span> <span class="n">PBD</span>
<span class="go">[[0, 2, 4], [0, 3], [1, 2], [1, 3, 4], [0, 1], [2, 3]]</span>
<span class="gp">sage: </span><span class="n">is_pairwise_balanced_design</span><span class="p">(</span><span class="n">PBD</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.combinat.designs.bibd.PairwiseBalancedDesign">
<em class="property">class </em><code class="descclassname">sage.combinat.designs.bibd.</code><code class="descname">PairwiseBalancedDesign</code><span class="sig-paren">(</span><em>points</em>, <em>blocks</em>, <em>K=None</em>, <em>lambd=1</em>, <em>check=True</em>, <em>copy=True</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.bibd.PairwiseBalancedDesign" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="group_divisible_designs.html#sage.combinat.designs.group_divisible_designs.GroupDivisibleDesign" title="sage.combinat.designs.group_divisible_designs.GroupDivisibleDesign"><code class="xref py py-class docutils literal"><span class="pre">sage.combinat.designs.group_divisible_designs.GroupDivisibleDesign</span></code></a></p>
<p>Pairwise Balanced Design (PBD)</p>
<p>A Pairwise Balanced Design, or <span class="math">\((v,K,\lambda)\)</span>-PBD, is a collection
<span class="math">\(\mathcal B\)</span> of blocks defined on a set <span class="math">\(X\)</span> of size <span class="math">\(v\)</span>, such that any block
pair of points <span class="math">\(p_1,p_2\in X\)</span> occurs in exactly <span class="math">\(\lambda\)</span> blocks of
<span class="math">\(\mathcal B\)</span>. Besides, for every block <span class="math">\(B\in \mathcal B\)</span> we must have
<span class="math">\(|B|\in K\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">points</span></code> &#8211; the underlying set. If <code class="docutils literal"><span class="pre">points</span></code> is an integer <span class="math">\(v\)</span>, then
the set is considered to be <span class="math">\(\{0, ..., v-1\}\)</span>.</li>
<li><code class="docutils literal"><span class="pre">blocks</span></code> &#8211; collection of blocks</li>
<li><code class="docutils literal"><span class="pre">K</span></code> &#8211; list of integers of which the sizes of the blocks must be
elements. Set to <code class="docutils literal"><span class="pre">None</span></code> (automatic guess) by default.</li>
<li><code class="docutils literal"><span class="pre">lambd</span></code> (integer) &#8211; value of <span class="math">\(\lambda\)</span>, set to <span class="math">\(1\)</span> by default.</li>
<li><code class="docutils literal"><span class="pre">check</span></code> (boolean) &#8211; whether to check that the design is a <span class="math">\(PBD\)</span> with
the right parameters.</li>
<li><code class="docutils literal"><span class="pre">copy</span></code> &#8211; (use with caution) if set to <code class="docutils literal"><span class="pre">False</span></code> then <code class="docutils literal"><span class="pre">blocks</span></code> must be
a list of lists of integers. The list will not be copied but will be
modified in place (each block is sorted, and the whole list is
sorted). Your <code class="docutils literal"><span class="pre">blocks</span></code> object will become the instance&#8217;s internal data.</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.bibd.balanced_incomplete_block_design">
<code class="descclassname">sage.combinat.designs.bibd.</code><code class="descname">balanced_incomplete_block_design</code><span class="sig-paren">(</span><em>v</em>, <em>k</em>, <em>existence=False</em>, <em>use_LJCR=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.bibd.balanced_incomplete_block_design" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a BIBD of parameters <span class="math">\(v,k\)</span>.</p>
<p>A Balanced Incomplete Block Design of parameters <span class="math">\(v,k\)</span> is a collection
<span class="math">\(\mathcal C\)</span> of <span class="math">\(k\)</span>-subsets of <span class="math">\(V=\{0,\dots,v-1\}\)</span> such that for any two
distinct elements <span class="math">\(x,y\in V\)</span> there is a unique element <span class="math">\(S\in \mathcal C\)</span>
such that <span class="math">\(x,y\in S\)</span>.</p>
<p>More general definitions sometimes involve a <span class="math">\(\lambda\)</span> parameter, and we
assume here that <span class="math">\(\lambda=1\)</span>.</p>
<p>For more information on BIBD, see the
<a class="reference external" href="https://en.wikipedia.org/wiki/Block_design#Definition_of_a_BIBD_.28or_2-design.29">corresponding Wikipedia entry</a>.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">v,k</span></code> (integers)</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">existence</span></code> (boolean) &#8211; instead of building the design, return:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">True</span></code> &#8211; meaning that Sage knows how to build the design</li>
<li><code class="docutils literal"><span class="pre">Unknown</span></code> &#8211; meaning that Sage does not know how to build the
design, but that the design may exist (see <a class="reference external" href="../../../../misc/sage/misc/unknown.html#module-sage.misc.unknown" title="(in Sage Reference Manual: Utilities v7.3)"><code class="xref py py-mod docutils literal"><span class="pre">sage.misc.unknown</span></code></a>).</li>
<li><code class="docutils literal"><span class="pre">False</span></code> &#8211; meaning that the design does not exist.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">use_LJCR</span></code> (boolean) &#8211; whether to query the La Jolla Covering
Repository for the design when Sage does not know how to build it (see
<a class="reference internal" href="covering_design.html#sage.combinat.designs.covering_design.best_known_covering_design_www" title="sage.combinat.designs.covering_design.best_known_covering_design_www"><code class="xref py py-func docutils literal"><span class="pre">best_known_covering_design_www()</span></code></a>). This
requires internet.</p>
</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.combinat.designs.bibd.steiner_triple_system" title="sage.combinat.designs.bibd.steiner_triple_system"><code class="xref py py-func docutils literal"><span class="pre">steiner_triple_system()</span></code></a></li>
<li><a class="reference internal" href="#sage.combinat.designs.bibd.v_4_1_BIBD" title="sage.combinat.designs.bibd.v_4_1_BIBD"><code class="xref py py-func docutils literal"><span class="pre">v_4_1_BIBD()</span></code></a></li>
<li><a class="reference internal" href="#sage.combinat.designs.bibd.v_5_1_BIBD" title="sage.combinat.designs.bibd.v_5_1_BIBD"><code class="xref py py-func docutils literal"><span class="pre">v_5_1_BIBD()</span></code></a></li>
</ul>
</div>
<p>TODO:</p>
<blockquote>
<div><ul class="simple">
<li>Implement other constructions from the Handbook of Combinatorial
Designs.</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">balanced_incomplete_block_design</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">blocks</span><span class="p">()</span>
<span class="go">[[0, 1, 3], [0, 2, 4], [0, 5, 6], [1, 2, 6], [1, 4, 5], [2, 3, 5], [3, 4, 6]]</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">balanced_incomplete_block_design</span><span class="p">(</span><span class="mi">66</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">use_LJCR</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c1"># optional - internet</span>
<span class="gp">sage: </span><span class="n">B</span>                                                              <span class="c1"># optional - internet</span>
<span class="go">Incidence structure with 66 points and 143 blocks</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">blocks</span><span class="p">()</span>                                                     <span class="c1"># optional - internet</span>
<span class="go">[[0, 1, 2, 3, 4, 65], [0, 5, 24, 25, 39, 57], [0, 6, 27, 38, 44, 55], ...</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">balanced_incomplete_block_design</span><span class="p">(</span><span class="mi">66</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">use_LJCR</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  <span class="c1"># optional - internet</span>
<span class="go">Incidence structure with 66 points and 143 blocks</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">balanced_incomplete_block_design</span><span class="p">(</span><span class="mi">216</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">I don&#39;t know how to build a (216,6,1)-BIBD!</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">balanced_incomplete_block_design</span><span class="p">(</span><span class="mi">85</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">_</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">balanced_incomplete_block_design</span><span class="p">(</span><span class="mi">85</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>A BIBD from a Finite Projective Plane:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">_</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">balanced_incomplete_block_design</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>Some trivial BIBD:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">balanced_incomplete_block_design</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="go">(10,10,1)-Balanced Incomplete Block Design</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">balanced_incomplete_block_design</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="go">(1,0,1)-Balanced Incomplete Block Design</span>
</pre></div>
</div>
<p>Existence of BIBD with <span class="math">\(k=3,4,5\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="k">if</span> <span class="n">designs</span><span class="o">.</span><span class="n">balanced_incomplete_block_design</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)]</span>
<span class="go">[1, 3, 7, 9, 13, 15, 19, 21, 25, 27, 31, 33, 37, 39, 43, 45, 49]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="k">if</span> <span class="n">designs</span><span class="o">.</span><span class="n">balanced_incomplete_block_design</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)]</span>
<span class="go">[1, 4, 13, 16, 25, 28, 37, 40, 49, 52, 61, 64, 73, 76, 85, 88, 97]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">150</span><span class="p">)</span> <span class="k">if</span> <span class="n">designs</span><span class="o">.</span><span class="n">balanced_incomplete_block_design</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)]</span>
<span class="go">[1, 5, 21, 25, 41, 45, 61, 65, 81, 85, 101, 105, 121, 125, 141, 145]</span>
</pre></div>
</div>
<p>For <span class="math">\(k &gt; 5\)</span> there are currently very few constructions:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span> <span class="k">if</span> <span class="n">designs</span><span class="o">.</span><span class="n">balanced_incomplete_block_design</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">]</span>
<span class="go">[1, 6, 31, 66, 76, 91, 96, 106, 111, 121, 126, 136, 141, 151, 156, 171, 181, 186, 196, 201, 211, 241, 271]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span> <span class="k">if</span> <span class="n">designs</span><span class="o">.</span><span class="n">balanced_incomplete_block_design</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="ow">is</span> <span class="n">Unknown</span><span class="p">]</span>
<span class="go">[51, 61, 81, 166, 216, 226, 231, 246, 256, 261, 276, 286, 291]</span>
</pre></div>
</div>
<p>Here are some constructions with <span class="math">\(k \geq 7\)</span> and <span class="math">\(v\)</span> a prime power:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">balanced_incomplete_block_design</span><span class="p">(</span><span class="mi">169</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="go">(169,7,1)-Balanced Incomplete Block Design</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">balanced_incomplete_block_design</span><span class="p">(</span><span class="mi">617</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="go">(617,8,1)-Balanced Incomplete Block Design</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">balanced_incomplete_block_design</span><span class="p">(</span><span class="mi">433</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span>
<span class="go">(433,9,1)-Balanced Incomplete Block Design</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">balanced_incomplete_block_design</span><span class="p">(</span><span class="mi">1171</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="go">(1171,10,1)-Balanced Incomplete Block Design</span>
</pre></div>
</div>
<p>And we know some inexistence results:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">balanced_incomplete_block_design</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.bibd.steiner_triple_system">
<code class="descclassname">sage.combinat.designs.bibd.</code><code class="descname">steiner_triple_system</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.bibd.steiner_triple_system" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Steiner Triple System</p>
<p>A Steiner Triple System (STS) of a set <span class="math">\(\{0,...,n-1\}\)</span>
is a family <span class="math">\(S\)</span> of 3-sets such that for any <span class="math">\(i \not = j\)</span>
there exists exactly one set of <span class="math">\(S\)</span> in which they are
both contained.</p>
<p>It can alternatively be thought of as a factorization of
the complete graph <span class="math">\(K_n\)</span> with triangles.</p>
<p>A Steiner Triple System of a <span class="math">\(n\)</span>-set exists if and only if
<span class="math">\(n \equiv 1 \pmod 6\)</span> or <span class="math">\(n \equiv 3 \pmod 6\)</span>, in which case
one can be found through Bose&#8217;s and Skolem&#8217;s constructions,
respectively <a class="reference internal" href="#andhonk97" id="id8">[AndHonk97]</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">n</span></code> return a Steiner Triple System of <span class="math">\(\{0,...,n-1\}\)</span></li>
</ul>
<p>EXAMPLE:</p>
<p>A Steiner Triple System on <span class="math">\(9\)</span> elements</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sts</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">steiner_triple_system</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sts</span>
<span class="go">(9,3,1)-Balanced Incomplete Block Design</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">sts</span><span class="p">)</span>
<span class="go">[[0, 1, 5], [0, 2, 4], [0, 3, 6], [0, 7, 8], [1, 2, 3],</span>
<span class="go"> [1, 4, 7], [1, 6, 8], [2, 5, 8], [2, 6, 7], [3, 4, 8],</span>
<span class="go"> [3, 5, 7], [4, 5, 6]]</span>
</pre></div>
</div>
<p>As any pair of vertices is covered once, its parameters are</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sts</span><span class="o">.</span><span class="n">is_t_design</span><span class="p">(</span><span class="n">return_parameters</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(True, (2, 9, 3, 1))</span>
</pre></div>
</div>
<p>An exception is raised for invalid values of <code class="docutils literal"><span class="pre">n</span></code></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">steiner_triple_system</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">EmptySetError</span>: <span class="n">Steiner triple systems only exist for n = 1 mod 6 or n = 3 mod 6</span>
</pre></div>
</div>
<p>REFERENCE:</p>
<table class="docutils citation" frame="void" id="andhonk97" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id8">[AndHonk97]</a></td><td>A short course in Combinatorial Designs,
Ian Anderson, Iiro Honkala,
Internet Editions, Spring 1997,
<a class="reference external" href="http://www.utu.fi/~honkala/designs.ps">http://www.utu.fi/~honkala/designs.ps</a></td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.bibd.v_4_1_BIBD">
<code class="descclassname">sage.combinat.designs.bibd.</code><code class="descname">v_4_1_BIBD</code><span class="sig-paren">(</span><em>v</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.bibd.v_4_1_BIBD" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <span class="math">\((v,4,1)\)</span>-BIBD.</p>
<p>A <span class="math">\((v,4,1)\)</span>-BIBD is an edge-decomposition of the complete graph <span class="math">\(K_v\)</span> into
copies of <span class="math">\(K_4\)</span>. For more information, see
<a class="reference internal" href="#sage.combinat.designs.bibd.balanced_incomplete_block_design" title="sage.combinat.designs.bibd.balanced_incomplete_block_design"><code class="xref py py-func docutils literal"><span class="pre">balanced_incomplete_block_design()</span></code></a>. It exists if and only if <span class="math">\(v\equiv 1,4
\pmod {12}\)</span>.</p>
<p>See page 167 of <a class="reference internal" href="latin_squares.html#stinson2004" id="id9">[Stinson2004]</a> for the construction details.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.combinat.designs.bibd.balanced_incomplete_block_design" title="sage.combinat.designs.bibd.balanced_incomplete_block_design"><code class="xref py py-func docutils literal"><span class="pre">balanced_incomplete_block_design()</span></code></a></li>
</ul>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">v</span></code> (integer) &#8211; number of points.</li>
<li><code class="docutils literal"><span class="pre">check</span></code> (boolean) &#8211; whether to check that output is correct before
returning it. As this is expected to be useless (but we are cautious
guys), you may want to disable it whenever you want speed. Set to <code class="docutils literal"><span class="pre">True</span></code>
by default.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.bibd</span> <span class="kn">import</span> <span class="n">v_4_1_BIBD</span>  <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">100</span><span class="p">):</span>                            <span class="c1"># long time</span>
<span class="go">....:    if n%12 in [1,4]:                               # long time</span>
<span class="go">....:       _ = v_4_1_BIBD(n, check = True)              # long time</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Check that the <span class="math">\((25,4)\)</span> and <span class="math">\((37,4)\)</span>-difference family are available:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">assert</span> <span class="n">designs</span><span class="o">.</span><span class="n">difference_family</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">_</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">difference_family</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">assert</span> <span class="n">designs</span><span class="o">.</span><span class="n">difference_family</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">_</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">difference_family</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>Check some larger <span class="math">\((v,4,1)\)</span>-BIBD (see <a class="reference external" href="https://trac.sagemath.org/17557">trac ticket #17557</a>):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">400</span><span class="p">):</span>                                      <span class="c1"># long time</span>
<span class="go">....:     if v%12 in [1,4]:                                     # long time</span>
<span class="go">....:         _ = designs.balanced_incomplete_block_design(v,4) # long time</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.bibd.v_5_1_BIBD">
<code class="descclassname">sage.combinat.designs.bibd.</code><code class="descname">v_5_1_BIBD</code><span class="sig-paren">(</span><em>v</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.bibd.v_5_1_BIBD" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <span class="math">\((v,5,1)\)</span>-BIBD.</p>
<p>This method follows the constuction from <a class="reference internal" href="#claytonsmith" id="id10">[ClaytonSmith]</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">v</span></code> (integer)</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.combinat.designs.bibd.balanced_incomplete_block_design" title="sage.combinat.designs.bibd.balanced_incomplete_block_design"><code class="xref py py-func docutils literal"><span class="pre">balanced_incomplete_block_design()</span></code></a></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.bibd</span> <span class="kn">import</span> <span class="n">v_5_1_BIBD</span>
<span class="gp">sage: </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="k">while</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">200</span><span class="p">:</span>
<span class="go">....:    i += 20</span>
<span class="go">....:    _ = v_5_1_BIBD(i+1)</span>
<span class="go">....:    _ = v_5_1_BIBD(i+5)</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Check that the needed difference families are there:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">21</span><span class="p">,</span><span class="mi">41</span><span class="p">,</span><span class="mi">61</span><span class="p">,</span><span class="mi">81</span><span class="p">,</span><span class="mi">141</span><span class="p">,</span><span class="mi">161</span><span class="p">,</span><span class="mi">281</span><span class="p">]:</span>
<span class="go">....:     assert designs.difference_family(v,5,existence=True)</span>
<span class="go">....:     _ = designs.difference_family(v,5)</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <h3><a href="../../../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">Balanced Incomplete Block Designs (BIBD)</a><ul>
<li><a class="reference internal" href="#functions">Functions</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="all.html"
                                  title="previous chapter">Combinatorial design features that are imported by default in the interpreter namespace</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="resolvable_bibd.html"
                                  title="next chapter">Resolvable Balanced Incomplete Block Design (RBIBD)</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../_sources/sage/combinat/designs/bibd.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="resolvable_bibd.html" title="Resolvable Balanced Incomplete Block Design (RBIBD)"
             >next</a> |</li>
        <li class="right" >
          <a href="all.html" title="Combinatorial design features that are imported by default in the interpreter namespace"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Combinatorics</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../../../module_list.html" >Comprehensive Module list</a> &raquo;</li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &copy; Copyright 2005--2016, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.4.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>