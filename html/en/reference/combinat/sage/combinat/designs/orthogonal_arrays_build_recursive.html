<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=600, initial-scale=1">
    <title>Orthogonal arrays (build recursive constructions) &mdash; Sage Reference Manual v7.3: Combinatorics</title>
    
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '7.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v7.3: Combinatorics" href="../../../index.html" />
    <link rel="up" title="Comprehensive Module list" href="../../../module_list.html" />
    <link rel="next" title="Orthogonal arrays (find recursive constructions)" href="orthogonal_arrays_find_recursive.html" />
    <link rel="prev" title="Orthogonal arrays (OA)" href="orthogonal_arrays.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="orthogonal_arrays_find_recursive.html" title="Orthogonal arrays (find recursive constructions)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="orthogonal_arrays.html" title="Orthogonal arrays (OA)"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Combinatorics</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../../../module_list.html" accesskey="U">Comprehensive Module list</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="orthogonal-arrays-build-recursive-constructions">
<span id="sage-combinat-designs-orthogonal-arrays-build-recursive"></span><h1>Orthogonal arrays (build recursive constructions)<a class="headerlink" href="#orthogonal-arrays-build-recursive-constructions" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.combinat.designs.orthogonal_arrays_build_recursive"></span><p>This module implements several constructions of
<a class="reference internal" href="orthogonal_arrays.html#module-sage.combinat.designs.orthogonal_arrays" title="sage.combinat.designs.orthogonal_arrays"><code class="xref py py-mod docutils literal"><span class="pre">Orthogonal</span> <span class="pre">Arrays</span></code></a>.
As their input can be complex, they all have a counterpart in the
<a class="reference internal" href="orthogonal_arrays_find_recursive.html#module-sage.combinat.designs.orthogonal_arrays_find_recursive" title="sage.combinat.designs.orthogonal_arrays_find_recursive"><code class="xref py py-mod docutils literal"><span class="pre">orthogonal_arrays_find_recursive</span></code></a> module
that automatically computes it.</p>
<p>All these constructions are automatically queried when the
<a class="reference internal" href="orthogonal_arrays.html#sage.combinat.designs.orthogonal_arrays.orthogonal_array" title="sage.combinat.designs.orthogonal_arrays.orthogonal_array"><code class="xref py py-func docutils literal"><span class="pre">orthogonal_array()</span></code></a> function is
called.</p>
<table border="1" class="contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays_build_recursive.construction_3_3" title="sage.combinat.designs.orthogonal_arrays_build_recursive.construction_3_3"><code class="xref py py-func docutils literal"><span class="pre">construction_3_3()</span></code></a></td>
<td>Return an <span class="math">\(OA(k,nm+i)\)</span>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays_build_recursive.construction_3_4" title="sage.combinat.designs.orthogonal_arrays_build_recursive.construction_3_4"><code class="xref py py-func docutils literal"><span class="pre">construction_3_4()</span></code></a></td>
<td>Return a <span class="math">\(OA(k,nm+rs)\)</span>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays_build_recursive.construction_3_5" title="sage.combinat.designs.orthogonal_arrays_build_recursive.construction_3_5"><code class="xref py py-func docutils literal"><span class="pre">construction_3_5()</span></code></a></td>
<td>Return an <span class="math">\(OA(k,nm+r+s+t)\)</span>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays_build_recursive.construction_3_6" title="sage.combinat.designs.orthogonal_arrays_build_recursive.construction_3_6"><code class="xref py py-func docutils literal"><span class="pre">construction_3_6()</span></code></a></td>
<td>Return a <span class="math">\(OA(k,nm+i)\)</span>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays_build_recursive.construction_q_x" title="sage.combinat.designs.orthogonal_arrays_build_recursive.construction_q_x"><code class="xref py py-func docutils literal"><span class="pre">construction_q_x()</span></code></a></td>
<td>Return an <span class="math">\(OA(k,(q-1)*(q-x)+x+2)\)</span> using the <span class="math">\(q-x\)</span> construction.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays_build_recursive.OA_and_oval" title="sage.combinat.designs.orthogonal_arrays_build_recursive.OA_and_oval"><code class="xref py py-func docutils literal"><span class="pre">OA_and_oval()</span></code></a></td>
<td>Return a <span class="math">\(OA(q+1,q)\)</span> whose blocks contains <span class="math">\(\leq 2\)</span> zeroes in the last <span class="math">\(q\)</span> columns.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays_build_recursive.thwart_lemma_3_5" title="sage.combinat.designs.orthogonal_arrays_build_recursive.thwart_lemma_3_5"><code class="xref py py-func docutils literal"><span class="pre">thwart_lemma_3_5()</span></code></a></td>
<td>Returns an <span class="math">\(OA(k,nm+a+b+c+d)\)</span>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays_build_recursive.thwart_lemma_4_1" title="sage.combinat.designs.orthogonal_arrays_build_recursive.thwart_lemma_4_1"><code class="xref py py-func docutils literal"><span class="pre">thwart_lemma_4_1()</span></code></a></td>
<td>Returns an <span class="math">\(OA(k,nm+4(n-2))\)</span>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays_build_recursive.three_factor_product" title="sage.combinat.designs.orthogonal_arrays_build_recursive.three_factor_product"><code class="xref py py-func docutils literal"><span class="pre">three_factor_product()</span></code></a></td>
<td>Returns an <span class="math">\(OA(k+1,n_1n_2n_3)\)</span>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays_build_recursive.brouwer_separable_design" title="sage.combinat.designs.orthogonal_arrays_build_recursive.brouwer_separable_design"><code class="xref py py-func docutils literal"><span class="pre">brouwer_separable_design()</span></code></a></td>
<td>Returns a <span class="math">\(OA(k,t(q^2+q+1)+x)\)</span> using Brouwer&#8217;s result on separable designs.</td>
</tr>
</tbody>
</table>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="sage.combinat.designs.orthogonal_arrays_build_recursive.OA_and_oval">
<code class="descclassname">sage.combinat.designs.orthogonal_arrays_build_recursive.</code><code class="descname">OA_and_oval</code><span class="sig-paren">(</span><em>q</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays_build_recursive.OA_and_oval" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <span class="math">\(OA(q+1,q)\)</span> whose blocks contains <span class="math">\(\leq 2\)</span> zeroes in the last <span class="math">\(q\)</span>
columns.</p>
<p>This <span class="math">\(OA\)</span> is build from a projective plane of order <span class="math">\(q\)</span>, in which there
exists an oval <span class="math">\(O\)</span> of size <span class="math">\(q+1\)</span> (i.e. a set of <span class="math">\(q+1\)</span> points no three of which
are [colinear/contained in a common set of the projective plane]).</p>
<p>Removing an element <span class="math">\(x\in O\)</span> and all sets that contain it, we obtain a
<span class="math">\(TD(q+1,q)\)</span> in which <span class="math">\(O\)</span> intersects all columns except one. As <span class="math">\(O\)</span> is an
oval, no block of the <span class="math">\(TD\)</span> intersects it more than twice.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">q</span></code> &#8211; a prime power</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This function is called by <a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays_build_recursive.construction_3_6" title="sage.combinat.designs.orthogonal_arrays_build_recursive.construction_3_6"><code class="xref py py-func docutils literal"><span class="pre">construction_3_6()</span></code></a>, an implementation
of Construction 3.6 from <a class="reference internal" href="orthogonal_arrays_find_recursive.html#ac07" id="id1">[AC07]</a>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.orthogonal_arrays_build_recursive</span> <span class="kn">import</span> <span class="n">OA_and_oval</span>
<span class="gp">sage: </span><span class="n">_</span> <span class="o">=</span> <span class="n">OA_and_oval</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.orthogonal_arrays_build_recursive.brouwer_separable_design">
<code class="descclassname">sage.combinat.designs.orthogonal_arrays_build_recursive.</code><code class="descname">brouwer_separable_design</code><span class="sig-paren">(</span><em>k</em>, <em>t</em>, <em>q</em>, <em>x</em>, <em>check=False</em>, <em>verbose=False</em>, <em>explain_construction=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays_build_recursive.brouwer_separable_design" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <span class="math">\(OA(k,t(q^2+q+1)+x)\)</span> using Brouwer&#8217;s result on separable designs.</p>
<p>This method is an implementation of Brouwer&#8217;s construction presented in
<a class="reference internal" href="#brouwer80" id="id2">[Brouwer80]</a>. It consists in a systematic application of the usual
transformation from PBD to OA, applied to a specific PBD.</p>
<p><strong>Baer subplanes</strong></p>
<p>When <span class="math">\(q\)</span> is a prime power, the projective plane <span class="math">\(PG(2,q^2)\)</span> can be
partitionned into subplanes <span class="math">\(PG(2,q)\)</span> (called Baer subplanes), giving
<span class="math">\(PG(2,q^2)=B_1\cup \dots\cup B_{q^2-q+1}\)</span>. As a result, every line of the
<span class="math">\(PG(2,q^2)\)</span> intersects one of the subplane on <span class="math">\(q+1\)</span> points and all others on
<span class="math">\(1\)</span> point.</p>
<p>The <span class="math">\(OA\)</span> are built by considering <span class="math">\(B_1\cup\dots\cup B_t\)</span>, for a total of
<span class="math">\(t(q^2+q+1)\)</span> points (to which <span class="math">\(x\)</span> new points are then added). The blocks of
this subdesign belong to two categories:</p>
<ul class="simple">
<li>The blocks of size <span class="math">\(t\)</span>: they come from the lines which intersect a
<span class="math">\(B_i\)</span> on <span class="math">\(q+1\)</span> points for some <span class="math">\(i&gt;t\)</span>. The blocks of size <span class="math">\(t\)</span> can be partitionned
into <span class="math">\(q^2-q+t-1\)</span> parallel classes according to their associated subplane <span class="math">\(B_i\)</span>
with <span class="math">\(i&gt;t\)</span>.</li>
<li>The blocks of size <span class="math">\(q+t\)</span>: those blocks form a symmetric design, as every
point is incident with <span class="math">\(q+t\)</span> of them.</li>
</ul>
<p><strong>Constructions</strong></p>
<p>In the following, we write <span class="math">\(N=t(q^2+q+1)+x\)</span>. The code is also heavily
commented, and will clear any doubt.</p>
<ul>
<li><p class="first">i) <span class="math">\(x=0\)</span>: in that case we build a resolvable <span class="math">\(OA(k-1,N)\)</span> that will then be
completed into an <span class="math">\(OA(k,N)\)</span>.</p>
<blockquote>
<div><ul>
<li><p class="first"><em>Sets of size</em> <span class="math">\(t\)</span>)</p>
<p>We take the product of each parallel class with the parallel classes
of a resolvable <span class="math">\(OA(k-1,t)-t.OA(k-1,t)\)</span>, yielding new parallel
classes.</p>
</li>
<li><p class="first"><em>Sets of size</em> <span class="math">\(q+t\)</span>)</p>
<p>A <span class="math">\(N \times (q+t)\)</span> array is built whose rows are the sets of size
<span class="math">\(q+t\)</span> such that every value appears once per column. For each block of
a <span class="math">\(OA(k-1,q+t)-(q+t).OA(k-1,t)\)</span>, the product with the rows of the
matrix yields a parallel class.</p>
</li>
</ul>
</div></blockquote>
</li>
<li><ol class="first lowerroman simple" start="2">
<li><span class="math">\(x=q+t\)</span></li>
</ol>
<blockquote>
<div><ul>
<li><p class="first"><em>Sets of size</em> <span class="math">\(t\)</span>)</p>
<p>Each set of size <span class="math">\(t\)</span> gives a <span class="math">\(OA(k,t)-t.OA(k,1)\)</span>, except if there is
only one parallel class in which case a <span class="math">\(OA(k,t)\)</span> is sufficient.</p>
</li>
<li><p class="first"><em>Sets of size</em> <span class="math">\(q+t\)</span>)</p>
<p>A <span class="math">\((N-x) \times (q+t)\)</span> array <span class="math">\(M\)</span> is built whose <span class="math">\(N-x\)</span> rows are the
sets of size <span class="math">\(q+t\)</span> such that every value appears once per column. For
each of the new <span class="math">\(x=q+t\)</span> points <span class="math">\(p_1,\dots,p_{q+t}\)</span> we build a matrix
<span class="math">\(M_i\)</span> obtained from <span class="math">\(M\)</span> by adding a column equal to <span class="math">\((p_i,p_i,p_i\dots
)\)</span>. We add to the OA the product of all rows of the <span class="math">\(M_i\)</span> with the
block of the <span class="math">\(x=q+t\)</span> parallel classes of a resolvable
<span class="math">\(OA(k,t+q+1)-(t+q+1).OA(k,1)\)</span>.</p>
</li>
<li><p class="first"><em>Set of size</em> <span class="math">\(x\)</span>) An <span class="math">\(OA(k,x)\)</span></p>
</li>
</ul>
</div></blockquote>
</li>
<li><ol class="first lowerroman simple" start="3">
<li><span class="math">\(x = q^2-q+1-t\)</span></li>
</ol>
<blockquote>
<div><ul>
<li><p class="first"><em>Sets of size</em> <span class="math">\(t\)</span>)</p>
<p>All blocks of the <span class="math">\(i\)</span>-th parallel class are extended with the <span class="math">\(i\)</span>-th
new point. The blocks are then replaced by a <span class="math">\(OA(k,t+1)-(t+1).OA(k,1)\)</span>
or, if there is only one parallel class (i.e. <span class="math">\(x=1\)</span>) by a
<span class="math">\(OA(k,t+1)-OA(k,1)\)</span>.</p>
</li>
<li><p class="first"><em>Set of size</em> <span class="math">\(q+t\)</span>)</p>
<p>They are replaced by <span class="math">\(OA(k,q+t)-(q+t).OA(k,1)\)</span>.</p>
</li>
<li><p class="first"><em>Set of size</em> <span class="math">\(x\)</span>) An <span class="math">\(OA(k,x)\)</span></p>
</li>
</ul>
</div></blockquote>
</li>
<li><ol class="first lowerroman simple" start="4">
<li><span class="math">\(x = q^2+1\)</span></li>
</ol>
<blockquote>
<div><ul>
<li><p class="first"><em>Sets of size</em> <span class="math">\(t\)</span>)</p>
<p>All blocks of the <span class="math">\(i\)</span>-th parallel class are extended with the <span class="math">\(i\)</span>-th
new point (the other <span class="math">\(x-q-t\)</span> new points are not touched at this
step). The blocks are then replaced by a <span class="math">\(OA(k,t+1)-(t+1).OA(k,1)\)</span> or,
if there is only one parallel class (i.e. <span class="math">\(x=1\)</span>) by a
<span class="math">\(OA(k,t+1)-OA(k,1)\)</span>.</p>
</li>
<li><p class="first"><em>Sets of size</em> <span class="math">\(q+t\)</span>) Same as for ii)</p>
</li>
<li><p class="first"><em>Set of size</em> <span class="math">\(x\)</span>) An <span class="math">\(OA(k,x)\)</span></p>
</li>
</ul>
</div></blockquote>
</li>
<li><ol class="first loweralpha simple" start="22">
<li><span class="math">\(0&lt;x&lt;q^2-q+1-t\)</span></li>
</ol>
<blockquote>
<div><ul>
<li><p class="first"><em>Sets of size</em> <span class="math">\(t\)</span>)</p>
<p>The blocks of the first <span class="math">\(x\)</span> parallel class are extended with the <span class="math">\(x\)</span>
new points, and replaced with <span class="math">\(OA(k.t+1)-(t+1).OA(k,1)\)</span> or, if <span class="math">\(x=1\)</span>,
by <span class="math">\(OA(k.t+1)-.OA(k,1)\)</span></p>
<p>The blocks of the other parallel classes are replaced by
<span class="math">\(OA(k,t)-t.OA(k,t)\)</span> or, if there is only one class left, by
<span class="math">\(OA(k,t)-OA(k,t)\)</span></p>
</li>
<li><p class="first"><em>Sets of size</em> <span class="math">\(q+t\)</span>)</p>
<p>They are replaced with <span class="math">\(OA(k,q+t)-(q+t).OA(k,1)\)</span>.</p>
</li>
<li><p class="first"><em>Set of size</em> <span class="math">\(x\)</span>) An <span class="math">\(OA(k,x)\)</span></p>
</li>
</ul>
</div></blockquote>
</li>
<li><ol class="first lowerroman simple" start="6">
<li><span class="math">\(t+q&lt;x&lt;q^2+1\)</span></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><em>Sets of size</em> <span class="math">\(t\)</span>) Same as in v) with an <span class="math">\(x\)</span> equal to <span class="math">\(x-q+t\)</span>.</li>
<li><em>Sets of size</em> <span class="math">\(t\)</span>) Same as in vii)</li>
<li><em>Set of size</em> <span class="math">\(x\)</span>) An <span class="math">\(OA(k,x)\)</span></li>
</ul>
</div></blockquote>
</li>
</ul>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">k,t,q,x</span></code> (integers)</li>
<li><code class="docutils literal"><span class="pre">check</span></code> &#8211; (boolean) Whether to check that output is correct before
returning it. Set to <code class="docutils literal"><span class="pre">False</span></code> by default.</li>
<li><code class="docutils literal"><span class="pre">verbose</span></code> (boolean) &#8211; whether to print some information on the
construction and parameters being used.</li>
<li><code class="docutils literal"><span class="pre">explain_construction</span></code> (boolean) &#8211; return a string describing
the construction.</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="orthogonal_arrays_find_recursive.html#sage.combinat.designs.orthogonal_arrays_find_recursive.find_brouwer_separable_design" title="sage.combinat.designs.orthogonal_arrays_find_recursive.find_brouwer_separable_design"><code class="xref py py-func docutils literal"><span class="pre">find_brouwer_separable_design()</span></code></a></li>
</ul>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="brouwer80" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[Brouwer80]</a></td><td>A Series of Separable Designs with Application to Pairwise Orthogonal Latin Squares,
Andries E. Brouwer,
Vol. 1, n. 1, pp. 39-41,
European Journal of Combinatorics, 1980
<a class="reference external" href="http://www.sciencedirect.com/science/article/pii/S0195669880800199">http://www.sciencedirect.com/science/article/pii/S0195669880800199</a></td></tr>
</tbody>
</table>
<p>EXAMPLES:</p>
<p>Test all possible cases:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.orthogonal_arrays_build_recursive</span> <span class="kn">import</span> <span class="n">brouwer_separable_design</span>
<span class="gp">sage: </span><span class="n">k</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">;</span> <span class="n">_</span><span class="o">=</span><span class="n">brouwer_separable_design</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Case i) with k=4,q=3,t=4,x=0</span>
<span class="gp">sage: </span><span class="n">k</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">;</span> <span class="n">_</span><span class="o">=</span><span class="n">brouwer_separable_design</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">t</span><span class="o">+</span><span class="n">q</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">check</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Case ii) with k=3,q=3,t=3,x=6,e3=1</span>
<span class="gp">sage: </span><span class="n">k</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">;</span> <span class="n">_</span><span class="o">=</span><span class="n">brouwer_separable_design</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">t</span><span class="o">+</span><span class="n">q</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">check</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Case ii) with k=3,q=3,t=6,x=9,e3=0</span>
<span class="gp">sage: </span><span class="n">k</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">;</span> <span class="n">_</span><span class="o">=</span><span class="n">brouwer_separable_design</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">q</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">t</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">check</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Case iii) with k=3,q=3,t=6,x=1,e2=0</span>
<span class="gp">sage: </span><span class="n">k</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">;</span> <span class="n">_</span><span class="o">=</span><span class="n">brouwer_separable_design</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">q</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">t</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">check</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Case iii) with k=3,q=4,t=6,x=7,e2=1</span>
<span class="gp">sage: </span><span class="n">k</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">;</span> <span class="n">_</span><span class="o">=</span><span class="n">brouwer_separable_design</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">q</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">check</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Case iv) with k=3,q=4,t=6,x=17,e4=1</span>
<span class="gp">sage: </span><span class="n">k</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">;</span> <span class="n">_</span><span class="o">=</span><span class="n">brouwer_separable_design</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">q</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">check</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Case iv) with k=3,q=2,t=2,x=5,e4=0</span>
<span class="gp">sage: </span><span class="n">k</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">;</span> <span class="n">_</span><span class="o">=</span><span class="n">brouwer_separable_design</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">check</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Case v) with k=3,q=4,t=7,x=3,e1=1,e2=1</span>
<span class="gp">sage: </span><span class="n">k</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">;</span> <span class="n">_</span><span class="o">=</span><span class="n">brouwer_separable_design</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">check</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Case v) with k=3,q=4,t=7,x=1,e1=1,e2=0</span>
<span class="gp">sage: </span><span class="n">k</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">;</span> <span class="n">_</span><span class="o">=</span><span class="n">brouwer_separable_design</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">q</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">q</span><span class="o">-</span><span class="n">t</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">check</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Case v) with k=3,q=4,t=7,x=5,e1=0,e2=1</span>
<span class="gp">sage: </span><span class="n">k</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">;</span> <span class="n">_</span><span class="o">=</span><span class="n">brouwer_separable_design</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">t</span><span class="o">+</span><span class="n">q</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">check</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Case vi) with k=5,q=4,t=7,x=14,e3=1,e4=1</span>
<span class="gp">sage: </span><span class="n">k</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">;</span> <span class="n">_</span><span class="o">=</span><span class="n">brouwer_separable_design</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">t</span><span class="o">+</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">check</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Case vi) with k=5,q=4,t=8,x=13,e3=1,e4=0</span>
<span class="gp">sage: </span><span class="n">k</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">;</span> <span class="n">_</span><span class="o">=</span><span class="n">brouwer_separable_design</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">q</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">check</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Case vi) with k=5,q=4,t=8,x=16,e3=0,e4=1</span>

<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">explain_construction</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">189</span><span class="p">))</span>
<span class="go">Brouwer&#39;s separable design construction with t=9,q=4,x=0 from:</span>
<span class="go">   Andries E. Brouwer,</span>
<span class="go">   A series of separable designs with application to pairwise orthogonal Latin squares</span>
<span class="go">   Vol. 1, n. 1, pp. 39-41,</span>
<span class="go">   European Journal of Combinatorics, 1980</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.orthogonal_arrays_build_recursive.construction_3_3">
<code class="descclassname">sage.combinat.designs.orthogonal_arrays_build_recursive.</code><code class="descname">construction_3_3</code><span class="sig-paren">(</span><em>k</em>, <em>n</em>, <em>m</em>, <em>i</em>, <em>explain_construction=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays_build_recursive.construction_3_3" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an <span class="math">\(OA(k,nm+i)\)</span>.</p>
<p>This is Wilson&#8217;s construction with <span class="math">\(i\)</span> truncated columns of size 1 and such
that a block <span class="math">\(B_0\)</span> of the incomplete OA intersects all truncated columns. As
a consequence, all other blocks intersect only <span class="math">\(0\)</span> or <span class="math">\(1\)</span> of the last <span class="math">\(i\)</span>
columns. This allow to consider the block <span class="math">\(B_0\)</span> only up to its first <span class="math">\(k\)</span>
coordinates and then use a <span class="math">\(OA(k,i)\)</span> instead of a <span class="math">\(OA(k,m+i) - i.OA(k,1)\)</span>.</p>
<p>This is construction 3.3 from <a class="reference internal" href="orthogonal_arrays_find_recursive.html#ac07" id="id3">[AC07]</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">k,n,m,i</span></code> (integers) such that the following designs are available :
<span class="math">\(OA(k,n)\)</span>, <span class="math">\(OA(k,m)\)</span>, <span class="math">\(OA(k,m+1)\)</span>, <span class="math">\(OA(k,r)\)</span>.</li>
<li><code class="docutils literal"><span class="pre">explain_construction</span></code> (boolean) &#8211; return a string describing
the construction.</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="orthogonal_arrays_find_recursive.html#sage.combinat.designs.orthogonal_arrays_find_recursive.find_construction_3_3" title="sage.combinat.designs.orthogonal_arrays_find_recursive.find_construction_3_3"><code class="xref py py-func docutils literal"><span class="pre">find_construction_3_3()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.orthogonal_arrays_find_recursive</span> <span class="kn">import</span> <span class="n">find_construction_3_3</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.orthogonal_arrays_build_recursive</span> <span class="kn">import</span> <span class="n">construction_3_3</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.orthogonal_arrays</span> <span class="kn">import</span> <span class="n">is_orthogonal_array</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">=</span><span class="mi">11</span><span class="p">;</span><span class="n">n</span><span class="o">=</span><span class="mi">177</span>
<span class="gp">sage: </span><span class="n">is_orthogonal_array</span><span class="p">(</span><span class="n">construction_3_3</span><span class="p">(</span><span class="o">*</span><span class="n">find_construction_3_3</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">)[</span><span class="mi">1</span><span class="p">]),</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">explain_construction</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">91</span><span class="p">))</span>
<span class="go">Construction 3.3 with n=11,m=8,i=3 from:</span>
<span class="go">   Julian R. Abel, Nicholas Cavenagh</span>
<span class="go">   Concerning eight mutually orthogonal latin squares,</span>
<span class="go">   Vol. 15, n.3, pp. 255-261,</span>
<span class="go">   Journal of Combinatorial Designs, 2007</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.orthogonal_arrays_build_recursive.construction_3_4">
<code class="descclassname">sage.combinat.designs.orthogonal_arrays_build_recursive.</code><code class="descname">construction_3_4</code><span class="sig-paren">(</span><em>k</em>, <em>n</em>, <em>m</em>, <em>r</em>, <em>s</em>, <em>explain_construction=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays_build_recursive.construction_3_4" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <span class="math">\(OA(k,nm+rs)\)</span>.</p>
<p>This is Wilson&#8217;s construction applied to a truncated <span class="math">\(OA(k+r+1,n)\)</span> with <span class="math">\(r\)</span>
columns of size <span class="math">\(1\)</span> and one column of size <span class="math">\(s\)</span>.</p>
<p>The unique elements of the <span class="math">\(r\)</span> truncated columns are picked so that a block
<span class="math">\(B_0\)</span> contains them all.</p>
<ul class="simple">
<li>If there exists an <span class="math">\(OA(k,m+r+1)\)</span> the column of size <span class="math">\(s\)</span> is truncated in
order to intersect <span class="math">\(B_0\)</span>.</li>
<li>Otherwise, if there exists an <span class="math">\(OA(k,m+r)\)</span>, the last column must not
intersect <span class="math">\(B_0\)</span></li>
</ul>
<p>This is construction 3.4 from <a class="reference internal" href="orthogonal_arrays_find_recursive.html#ac07" id="id4">[AC07]</a>.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">k,n,m,r,s</span></code> (integers) &#8211; we assume that <span class="math">\(s&lt;n\)</span> and <span class="math">\(1\leq r,s\)</span></p>
<p>The following designs must be available: <span class="math">\(OA(k,n)\)</span>, <span class="math">\(OA(k,m)\)</span>,
<span class="math">\(OA(k,m+1)\)</span>, <span class="math">\(OA(k,m+2)\)</span>, <span class="math">\(OA(k,s)\)</span>. Additionnally, it requires either a
<span class="math">\(OA(k,m+r)\)</span> or a <span class="math">\(OA(k,m+r+1)\)</span>.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">explain_construction</span></code> (boolean) &#8211; return a string describing
the construction.</p>
</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="orthogonal_arrays_find_recursive.html#sage.combinat.designs.orthogonal_arrays_find_recursive.find_construction_3_4" title="sage.combinat.designs.orthogonal_arrays_find_recursive.find_construction_3_4"><code class="xref py py-func docutils literal"><span class="pre">find_construction_3_4()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.orthogonal_arrays_find_recursive</span> <span class="kn">import</span> <span class="n">find_construction_3_4</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.orthogonal_arrays_build_recursive</span> <span class="kn">import</span> <span class="n">construction_3_4</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.orthogonal_arrays</span> <span class="kn">import</span> <span class="n">is_orthogonal_array</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">=</span><span class="mi">8</span><span class="p">;</span><span class="n">n</span><span class="o">=</span><span class="mi">196</span>
<span class="gp">sage: </span><span class="n">is_orthogonal_array</span><span class="p">(</span><span class="n">construction_3_4</span><span class="p">(</span><span class="o">*</span><span class="n">find_construction_3_4</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">)[</span><span class="mi">1</span><span class="p">]),</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">explain_construction</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">164</span><span class="p">))</span>
<span class="go">Construction 3.4 with n=23,m=7,r=2,s=1 from:</span>
<span class="go">   Julian R. Abel, Nicholas Cavenagh</span>
<span class="go">   Concerning eight mutually orthogonal latin squares,</span>
<span class="go">   Vol. 15, n.3, pp. 255-261,</span>
<span class="go">   Journal of Combinatorial Designs, 2007</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.orthogonal_arrays_build_recursive.construction_3_5">
<code class="descclassname">sage.combinat.designs.orthogonal_arrays_build_recursive.</code><code class="descname">construction_3_5</code><span class="sig-paren">(</span><em>k</em>, <em>n</em>, <em>m</em>, <em>r</em>, <em>s</em>, <em>t</em>, <em>explain_construction=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays_build_recursive.construction_3_5" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an <span class="math">\(OA(k,nm+r+s+t)\)</span>.</p>
<p>This is exactly Wilson&#8217;s construction with three truncated groups
except we make sure that all blocks have size <span class="math">\(&gt;k\)</span>, so we don&#8217;t
need a <span class="math">\(OA(k,m+0)\)</span> but only <span class="math">\(OA(k,m+1)\)</span>, <span class="math">\(OA(k,m+2)\)</span> ,`OA(k,m+3)`.</p>
<p>This is construction 3.5 from <a class="reference internal" href="orthogonal_arrays_find_recursive.html#ac07" id="id5">[AC07]</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">k,n,m</span></code> (integers)</li>
<li><code class="docutils literal"><span class="pre">r,s,t</span></code> (integers) &#8211; sizes of the three truncated groups,
such that <span class="math">\(r\leq s\)</span> and <span class="math">\((q-r-1)(q-s) \geq (q-s-1)*(q-r)\)</span>.</li>
<li><code class="docutils literal"><span class="pre">explain_construction</span></code> (boolean) &#8211; return a string describing
the construction.</li>
</ul>
<p>The following designs must be available : <span class="math">\(OA(k,n)\)</span>, <span class="math">\(OA(k,r)\)</span>, <span class="math">\(OA(k,s)\)</span>,
<span class="math">\(OA(k,t)\)</span>, <span class="math">\(OA(k,m+1)\)</span>, <span class="math">\(OA(k,m+2)\)</span>, <span class="math">\(OA(k,m+3)\)</span>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="orthogonal_arrays_find_recursive.html#sage.combinat.designs.orthogonal_arrays_find_recursive.find_construction_3_5" title="sage.combinat.designs.orthogonal_arrays_find_recursive.find_construction_3_5"><code class="xref py py-func docutils literal"><span class="pre">find_construction_3_5()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.orthogonal_arrays_find_recursive</span> <span class="kn">import</span> <span class="n">find_construction_3_5</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.orthogonal_arrays_build_recursive</span> <span class="kn">import</span> <span class="n">construction_3_5</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.orthogonal_arrays</span> <span class="kn">import</span> <span class="n">is_orthogonal_array</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">=</span><span class="mi">8</span><span class="p">;</span><span class="n">n</span><span class="o">=</span><span class="mi">111</span>
<span class="gp">sage: </span><span class="n">is_orthogonal_array</span><span class="p">(</span><span class="n">construction_3_5</span><span class="p">(</span><span class="o">*</span><span class="n">find_construction_3_5</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">)[</span><span class="mi">1</span><span class="p">]),</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">explain_construction</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">90</span><span class="p">))</span>
<span class="go">Construction 3.5 with n=11,m=6,r=8,s=8,t=8 from:</span>
<span class="go">   Julian R. Abel, Nicholas Cavenagh</span>
<span class="go">   Concerning eight mutually orthogonal latin squares,</span>
<span class="go">   Vol. 15, n.3, pp. 255-261,</span>
<span class="go">   Journal of Combinatorial Designs, 2007</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.orthogonal_arrays_build_recursive.construction_3_6">
<code class="descclassname">sage.combinat.designs.orthogonal_arrays_build_recursive.</code><code class="descname">construction_3_6</code><span class="sig-paren">(</span><em>k</em>, <em>n</em>, <em>m</em>, <em>i</em>, <em>explain_construction=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays_build_recursive.construction_3_6" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <span class="math">\(OA(k,nm+i)\)</span></p>
<p>This is Wilson&#8217;s construction with <span class="math">\(r\)</span> columns of order <span class="math">\(1\)</span>, in which each
block intersects at most two truncated columns. Such a design exists when
<span class="math">\(n\)</span> is a prime power and is returned by <a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays_build_recursive.OA_and_oval" title="sage.combinat.designs.orthogonal_arrays_build_recursive.OA_and_oval"><code class="xref py py-func docutils literal"><span class="pre">OA_and_oval()</span></code></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">k,n,m,i</span></code> (integers) &#8211; <span class="math">\(n\)</span> must be a prime power. The following designs
must be available: <span class="math">\(OA(k+r,q)\)</span>, <span class="math">\(OA(k,m)\)</span>, <span class="math">\(OA(k,m+1)\)</span>, <span class="math">\(OA(k,m+2)\)</span>.</li>
<li><code class="docutils literal"><span class="pre">explain_construction</span></code> (boolean) &#8211; return a string describing
the construction.</li>
</ul>
<p>This is construction 3.6 from <a class="reference internal" href="orthogonal_arrays_find_recursive.html#ac07" id="id6">[AC07]</a>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="orthogonal_arrays_find_recursive.html#sage.combinat.designs.orthogonal_arrays_find_recursive.find_construction_3_6" title="sage.combinat.designs.orthogonal_arrays_find_recursive.find_construction_3_6"><code class="xref py py-func docutils literal"><span class="pre">find_construction_3_6()</span></code></a></li>
<li><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays_build_recursive.OA_and_oval" title="sage.combinat.designs.orthogonal_arrays_build_recursive.OA_and_oval"><code class="xref py py-func docutils literal"><span class="pre">OA_and_oval()</span></code></a></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.orthogonal_arrays_find_recursive</span> <span class="kn">import</span> <span class="n">find_construction_3_6</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.orthogonal_arrays_build_recursive</span> <span class="kn">import</span> <span class="n">construction_3_6</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.orthogonal_arrays</span> <span class="kn">import</span> <span class="n">is_orthogonal_array</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">=</span><span class="mi">8</span><span class="p">;</span><span class="n">n</span><span class="o">=</span><span class="mi">95</span>
<span class="gp">sage: </span><span class="n">is_orthogonal_array</span><span class="p">(</span><span class="n">construction_3_6</span><span class="p">(</span><span class="o">*</span><span class="n">find_construction_3_6</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">)[</span><span class="mi">1</span><span class="p">]),</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">explain_construction</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">756</span><span class="p">))</span>
<span class="go">Construction 3.6 with n=16,m=47,i=4 from:</span>
<span class="go">   Julian R. Abel, Nicholas Cavenagh</span>
<span class="go">   Concerning eight mutually orthogonal latin squares,</span>
<span class="go">   Vol. 15, n.3, pp. 255-261,</span>
<span class="go">   Journal of Combinatorial Designs, 2007</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.orthogonal_arrays_build_recursive.construction_q_x">
<code class="descclassname">sage.combinat.designs.orthogonal_arrays_build_recursive.</code><code class="descname">construction_q_x</code><span class="sig-paren">(</span><em>k</em>, <em>q</em>, <em>x</em>, <em>check=True</em>, <em>explain_construction=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays_build_recursive.construction_q_x" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an <span class="math">\(OA(k,(q-1)*(q-x)+x+2)\)</span> using the <span class="math">\(q-x\)</span> construction.</p>
<p>Let <span class="math">\(v=(q-1)*(q-x)+x+2\)</span>. If there exists a projective plane of order <span class="math">\(q\)</span>
(e.g. when <span class="math">\(q\)</span> is a prime power) and <span class="math">\(0&lt;x&lt;q\)</span> then there exists a
<span class="math">\((v-1,\{q-x-1,q-x+1\})\)</span>-GDD of type <span class="math">\((q-1)^{q-x}(x+1)^1\)</span> (see <a class="reference internal" href="#greig99" id="id7">[Greig99]</a> or
Theorem 2.50, section IV.2.3 of <a class="reference internal" href="database.html#designhandbook" id="id8">[DesignHandbook]</a>). By adding to the ground
set one point contained in all groups of the GDD, one obtains a
<span class="math">\((v,\{q-x-1,q-x+1,q,x+2\})\)</span>-PBD with exactly one set of size <span class="math">\(x+2\)</span>.</p>
<p>Thus, assuming that we have the following:</p>
<ul class="simple">
<li><span class="math">\(OA(k,q-x-1)-(q-x-1).OA(k,1)\)</span></li>
<li><span class="math">\(OA(k,q-x+1)-(q-x+1).OA(k,1)\)</span></li>
<li><span class="math">\(OA(k,q)-q.OA(k,1)\)</span></li>
<li><span class="math">\(OA(k,x+2)\)</span></li>
</ul>
<p>Then we can build from the PBD an <span class="math">\(OA(k,v)\)</span>.</p>
<p>Construction of the PBD (shared by Julian R. Abel):</p>
<blockquote>
<div><p>Start with a resolvable <span class="math">\((q^2,q,1)\)</span>-BIBD and put the points into a <span class="math">\(q\times q\)</span>
array so that rows form a parallel class and columns form another.</p>
<p>Now delete:</p>
<ul class="simple">
<li>All <span class="math">\(x(q-1)\)</span> points from the first <span class="math">\(x\)</span> columns and not in the first
row</li>
<li>All <span class="math">\(q-x\)</span> points in the last <span class="math">\(q-x\)</span> columns AND the first row.</li>
</ul>
<p>Then add a point <span class="math">\(p_1\)</span> to the blocks that are rows. Add a second point
<span class="math">\(p_2\)</span> to the <span class="math">\(q-x\)</span> blocks that are columns of size <span class="math">\(q-1\)</span>, plus the first
row of size <span class="math">\(x+1\)</span>.</p>
</div></blockquote>
<p>INPUT:</p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">k,q,x</span></code> &#8211; integers such that <span class="math">\(0&lt;x&lt;q\)</span> and such that Sage can build:</p>
<blockquote>
<div><ul class="simple">
<li>A projective plane of order <span class="math">\(q\)</span></li>
<li><span class="math">\(OA(k,q-x-1)-(q-x-1).OA(k,1)\)</span></li>
<li><span class="math">\(OA(k,q-x+1)-(q-x+1).OA(k,1)\)</span></li>
<li><span class="math">\(OA(k,q)-q.OA(k,1)\)</span></li>
<li><span class="math">\(OA(k,x+2)\)</span></li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">check</span></code> &#8211; (boolean) Whether to check that output is correct before
returning it. As this is expected to be useless (but we are cautious
guys), you may want to disable it whenever you want speed. Set to
<code class="docutils literal"><span class="pre">True</span></code> by default.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">explain_construction</span></code> (boolean) &#8211; return a string describing
the construction.</p>
</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="orthogonal_arrays_find_recursive.html#sage.combinat.designs.orthogonal_arrays_find_recursive.find_q_x" title="sage.combinat.designs.orthogonal_arrays_find_recursive.find_q_x"><code class="xref py py-func docutils literal"><span class="pre">find_q_x()</span></code></a></li>
<li><a class="reference internal" href="block_design.html#sage.combinat.designs.block_design.projective_plane" title="sage.combinat.designs.block_design.projective_plane"><code class="xref py py-func docutils literal"><span class="pre">projective_plane()</span></code></a></li>
<li><a class="reference internal" href="orthogonal_arrays.html#sage.combinat.designs.orthogonal_arrays.orthogonal_array" title="sage.combinat.designs.orthogonal_arrays.orthogonal_array"><code class="xref py py-func docutils literal"><span class="pre">orthogonal_array()</span></code></a></li>
<li><a class="reference internal" href="orthogonal_arrays.html#sage.combinat.designs.orthogonal_arrays.OA_from_PBD" title="sage.combinat.designs.orthogonal_arrays.OA_from_PBD"><code class="xref py py-func docutils literal"><span class="pre">OA_from_PBD()</span></code></a></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.orthogonal_arrays_build_recursive</span> <span class="kn">import</span> <span class="n">construction_q_x</span>
<span class="gp">sage: </span><span class="n">_</span> <span class="o">=</span> <span class="n">construction_q_x</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>

<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">explain_construction</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">158</span><span class="p">))</span>
<span class="go">(q-x)-construction with q=16,x=6 from:</span>
<span class="go">   Malcolm Greig,</span>
<span class="go">   Designs from projective planes and PBD bases,</span>
<span class="go">   vol. 7, num. 5, pp. 341--374,</span>
<span class="go">   Journal of Combinatorial Designs, 1999</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="greig99" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[Greig99]</a></td><td>Designs from projective planes and PBD bases
Malcolm Greig
Journal of Combinatorial Designs
vol. 7, num. 5, pp. 341&#8211;374
1999</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.orthogonal_arrays_build_recursive.three_factor_product">
<code class="descclassname">sage.combinat.designs.orthogonal_arrays_build_recursive.</code><code class="descname">three_factor_product</code><span class="sig-paren">(</span><em>k</em>, <em>n1</em>, <em>n2</em>, <em>n3</em>, <em>check=False</em>, <em>explain_construction=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays_build_recursive.three_factor_product" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an <span class="math">\(OA(k+1,n_1n_2n_3)\)</span></p>
<p>The three factor product construction from <a class="reference internal" href="#dukesling14" id="id9">[DukesLing14]</a> does the following:</p>
<blockquote>
<div>If <span class="math">\(n_1\leq n_2\leq n_3\)</span> are such that there exists an
<span class="math">\(OA(k,n_1)\)</span>, <span class="math">\(OA(k+1,n_2)\)</span> and <span class="math">\(OA(k+1,n_3)\)</span>, then there exists a
<span class="math">\(OA(k+1,n_1n_2n_3)\)</span>.</div></blockquote>
<p>It works with a modified product of orthogonal arrays (<a class="reference internal" href="#rees93" id="id10">[Rees93]</a>, <a class="reference internal" href="#rees00" id="id11">[Rees00]</a>)
which keeps track of parallel classes in the <span class="math">\(OA\)</span> (the definition is given
for transversal designs).</p>
<blockquote>
<div>A subset of blocks in an <span class="math">\(TD(k,n)\)</span> is called a <span class="math">\(c\)</span>-parallel class if
every point is covered exactly <span class="math">\(c\)</span> times. A 1-parallel class is a
parallel class.</div></blockquote>
<p>The modified product:</p>
<blockquote>
<div><p>If there exists an <span class="math">\(OA(k,n_1)\)</span>, and if there exists an <span class="math">\(OA(k,n_2)\)</span> whose
blocks are partitionned into <span class="math">\(s\)</span> <span class="math">\(n_1\)</span>-parallel classes and <span class="math">\(n_2-sn_1\)</span>
parallel classes, then there exists an <span class="math">\(OA(k,n_1n_2)\)</span> whose blocks can
be partitionned into <span class="math">\(sn_1^2\)</span> parallel classes and
<span class="math">\((n_1n_2-sn_1^2)/n_1=n_2-sn_1\)</span> <span class="math">\(n_1\)</span>-parallel classes.</p>
<p>Proof:</p>
<ul>
<li><p class="first">The product of the blocks of a parallel class with an <span class="math">\(OA(k,n_1)\)</span>
yields an <span class="math">\(n_1\)</span>-parallel class of an <span class="math">\(OA(k,n_1n_2)\)</span>.</p>
</li>
<li><p class="first">The product of the blocks of a <span class="math">\(n_1\)</span>-parallel class of <span class="math">\(OA(k,n_2)\)</span>
with an <span class="math">\(OA(k,n_1)\)</span> can be done in such a way that it yields <span class="math">\(n_1n_2\)</span>
parallel classes of <span class="math">\(OA(k,n_1n_2)\)</span>. Those classes cover exactly the
pairs that woud have been covered with the usual product.</p>
<p>This can be achieved by simple cyclic permutations. Let us build the
product of the <span class="math">\(n_1\)</span>-parallel class <span class="math">\(\mathcal P\subseteq OA(k,n_2)\)</span>
with <span class="math">\(OA(k,n_1)\)</span>: when computing the product of <span class="math">\(P\in\mathcal P\)</span> with
<span class="math">\(B^1\in OA(k,n_1)\)</span> the <span class="math">\(i\)</span>-th coordinate should not be <span class="math">\((B^1_i,P_i)\)</span>
but <span class="math">\((B^1_i+r,P_i)\)</span> (the sum is mod <span class="math">\(n_1\)</span>) where <span class="math">\(r\)</span> is the number of
blocks of <span class="math">\(\mathcal P\)</span> we have already processed whose <span class="math">\(i\)</span>-th
coordinate is equal to <span class="math">\(P_i\)</span> (note that <span class="math">\(r&lt; n_1\)</span> as <span class="math">\(\mathcal P\)</span> is
<span class="math">\(n_1\)</span>-parallel).</p>
</li>
</ul>
</div></blockquote>
<p>With these tools, one can obtain the designs promised by the three factors
construction applied to <span class="math">\(k,n_1,n_2,n_3\)</span> (thanks to Julian R. Abel&#8217;s help):</p>
<blockquote>
<div><ol class="arabic simple">
<li>Let <span class="math">\(s\)</span> be the largest integer <span class="math">\(\leq n_3/n_1\)</span>. Apply the product
construction to <span class="math">\(OA(k,n_1)\)</span> and a resolvable <span class="math">\(OA(k,n_3)\)</span> whose blocks
are partitionned into <span class="math">\(s\)</span> <span class="math">\(n_1\)</span>-parallel classes and <span class="math">\(n_3-sn_1\)</span>
parallel classes. It results in a <span class="math">\(OA(k,n_1n_3)\)</span> partitionned into
<span class="math">\(sn_1^2\)</span> parallel classes plus <span class="math">\((n_1n_3-sn_1^2)/n_1=n_3-sn_1\)</span>
<span class="math">\(n_1\)</span>-parallel classes.</li>
<li>Add <span class="math">\(n_3-n_1\)</span> parallel classes to every <span class="math">\(n_1\)</span>-parallel class to turn
them into <span class="math">\(n_3\)</span>-parallel classes. Apply the product construction to
this partitionned <span class="math">\(OA(k,n_1n_3)\)</span> with a resolvable <span class="math">\(OA(k,n_2)\)</span>.</li>
<li>As <span class="math">\(OA(k,n_2)\)</span> is resolvable, the <span class="math">\(n_2\)</span>-parallel classes of
<span class="math">\(OA(k,n_1n_2n_3)\)</span> are actually the union of <span class="math">\(n_2\)</span> parallel classes,
thus the <span class="math">\(OA(k,n_1n_2n_3)\)</span> is resolvable and can be turned into an
<span class="math">\(OA(k+1,n_1n_2n_3)\)</span></li>
</ol>
</div></blockquote>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">k,n1,n2,n3</span></code> (integers)</li>
<li><code class="docutils literal"><span class="pre">check</span></code> &#8211; (boolean) Whether to check that everything is going smoothly
while the design is being built. It is disabled by default, as the
constructor of orthogonal arrays checks the final design anyway.</li>
<li><code class="docutils literal"><span class="pre">explain_construction</span></code> (boolean) &#8211; return a string describing
the construction.</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="orthogonal_arrays_find_recursive.html#sage.combinat.designs.orthogonal_arrays_find_recursive.find_three_factor_product" title="sage.combinat.designs.orthogonal_arrays_find_recursive.find_three_factor_product"><code class="xref py py-func docutils literal"><span class="pre">find_three_factor_product()</span></code></a></li>
</ul>
</div>
<p>EXAMPLE:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.designs_pyx</span> <span class="kn">import</span> <span class="n">is_orthogonal_array</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.orthogonal_arrays_build_recursive</span> <span class="kn">import</span> <span class="n">three_factor_product</span>

<span class="gp">sage: </span><span class="n">OA</span> <span class="o">=</span> <span class="n">three_factor_product</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_orthogonal_array</span><span class="p">(</span><span class="n">OA</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">64</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">OA</span> <span class="o">=</span> <span class="n">three_factor_product</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_orthogonal_array</span><span class="p">(</span><span class="n">OA</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">60</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">OA</span> <span class="o">=</span> <span class="n">three_factor_product</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_orthogonal_array</span><span class="p">(</span><span class="n">OA</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">140</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">OA</span> <span class="o">=</span> <span class="n">three_factor_product</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span> <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">is_orthogonal_array</span><span class="p">(</span><span class="n">OA</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="o">*</span><span class="mi">9</span><span class="o">*</span><span class="mi">9</span><span class="p">)</span>   <span class="c1"># long time</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">explain_construction</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">648</span><span class="p">))</span>
<span class="go">Three-factor product with n=8.9.9 from:</span>
<span class="go">   Peter J. Dukes, Alan C.H. Ling,</span>
<span class="go">   A three-factor product construction for mutually orthogonal latin squares,</span>
<span class="go">   http://arxiv.org/abs/1401.1466</span>
</pre></div>
</div>
<p>REFERENCE:</p>
<table class="docutils citation" frame="void" id="dukesling14" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id9">[DukesLing14]</a></td><td>A three-factor product construction for mutually orthogonal latin squares,
Peter J. Dukes, Alan C.H. Ling,
<a class="reference external" href="http://arxiv.org/abs/1401.1466">http://arxiv.org/abs/1401.1466</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="rees00" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id11">[Rees00]</a></td><td>Truncated Transversal Designs: A New Lower Bound on the Number of Idempotent MOLS of Side,
Rolf S. Rees,
Journal of Combinatorial Theory, Series A 90.2 (2000): 257-266.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="rees93" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id10">[Rees93]</a></td><td>Two new direct product-type constructions for resolvable group-divisible designs,
Rolf S. Rees,
Journal of Combinatorial Designs 1.1 (1993): 15-26.</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.orthogonal_arrays_build_recursive.thwart_lemma_3_5">
<code class="descclassname">sage.combinat.designs.orthogonal_arrays_build_recursive.</code><code class="descname">thwart_lemma_3_5</code><span class="sig-paren">(</span><em>k</em>, <em>n</em>, <em>m</em>, <em>a</em>, <em>b</em>, <em>c</em>, <em>d=0</em>, <em>complement=False</em>, <em>explain_construction=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays_build_recursive.thwart_lemma_3_5" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an <span class="math">\(OA(k,nm+a+b+c+d)\)</span></p>
<p><em>(When `d=0`)</em></p>
<p>According to <a class="reference internal" href="#thwarts" id="id12">[Thwarts]</a> when <span class="math">\(n\)</span> is a prime power and <span class="math">\(a+b+c\leq n+1\)</span>, one
can build an <span class="math">\(OA(k+3,n)\)</span> with three truncated columns of sizes <span class="math">\(a,b,c\)</span> in
such a way that all blocks have size <span class="math">\(\leq k+2\)</span>.</p>
<p>(in order to build a <span class="math">\(OA(k,nm+a+b+c)\)</span> the following designs must also exist:
<span class="math">\(OA(k,a)\)</span>, <span class="math">\(OA(k,b)\)</span>, <span class="math">\(OA(k,c)\)</span>, <span class="math">\(OA(k,m+0)\)</span>, <span class="math">\(OA(k,m+1)\)</span>, <span class="math">\(OA(k,m+2)\)</span>)</p>
<p>Considering the complement of each truncated column, it is also possible to
build an <span class="math">\(OA(k+3,n)\)</span> with three truncated columns of sizes <span class="math">\(a,b,c\)</span> in such a
way that all blocks have size <span class="math">\(&gt;k\)</span> whenever <span class="math">\((n-a)+(n-b)+(n-c)\leq n+1\)</span>.</p>
<p>(in order to build a <span class="math">\(OA(k,nm+a+b+c)\)</span> the following designs must also exist:
<span class="math">\(OA(k,a)\)</span>, <span class="math">\(OA(k,b)\)</span>, <span class="math">\(OA(k,c)\)</span>, <span class="math">\(OA(k,m+1)\)</span>, <span class="math">\(OA(k,m+2)\)</span>, <span class="math">\(OA(k,m+3)\)</span>)</p>
<p>Here is the proof of Lemma 3.5 from <a class="reference internal" href="#thwarts" id="id13">[Thwarts]</a> enriched with explanations
from Julian R. Abel:</p>
<blockquote>
<div><p>For any prime power <span class="math">\(n\)</span> one can build <span class="math">\(k-1\)</span> MOLS by associating to every
nonzero <span class="math">\(x\in \mathbb F_n\)</span> the latin square:</p>
<div class="math">
\[M_x(i,j) = i+x*j \text{ where }i,j\in \mathbb F_n\]</div>
<p>In particular <span class="math">\(M_1(i,j)=i+j\)</span>, whose <span class="math">\(n\)</span> columns and lines are indexed by
the elements of <span class="math">\(\mathbb F_n\)</span>. If we order the elements of <span class="math">\(\mathbb F_n\)</span>
as <span class="math">\(0,1,...,n-1,x+0,...,x+n-1,x^2+0,...\)</span> and reorder the columns
and lines of <span class="math">\(M_1\)</span> accordingly, the top-left <span class="math">\(a\times b\)</span> squares
contains at most <span class="math">\(a+b-1\)</span> distinct symbols.</p>
</div></blockquote>
<p><em>(When</em> <span class="math">\(d\neq 0\)</span> <em>)</em></p>
<p>If there exists an <span class="math">\(OA(k+3,n)\)</span> with three truncated columns of sizes <span class="math">\(a,b,c\)</span>
in such a way that all blocks have size <span class="math">\(\leq k+2\)</span>, by truncating
arbitrarily another column to size <span class="math">\(d\)</span> one obtains an <span class="math">\(OA\)</span> with 4 truncated
columns whose blocks miss at least one value. Thus, following the proof
again one can build an <span class="math">\(OA(k+4)\)</span> with four truncated columns of sizes
<span class="math">\(a,b,c,d\)</span> with blocks of size <span class="math">\(\leq k+3\)</span>.</p>
<p>(in order to build a <span class="math">\(OA(k,nm+a+b+c+d)\)</span> the following designs must also
exist: <span class="math">\(OA(k,a)\)</span>, <span class="math">\(OA(k,b)\)</span>, <span class="math">\(OA(k,c)\)</span>, <span class="math">\(OA(k,d)\)</span>, <span class="math">\(OA(k,m+0)\)</span>, <span class="math">\(OA(k,m+1)\)</span>,
<span class="math">\(OA(k,m+2)\)</span>, <span class="math">\(OA(k,m+3)\)</span>)</p>
<p>As before, this also shows that one can build an <span class="math">\(OA(k+4,n)\)</span> with four
truncated columns of sizes <span class="math">\(a,b,c,d\)</span> in such a way that all blocks have size
<span class="math">\(&gt;k\)</span> whenever <span class="math">\((n-a)+(n-b)+(n-c)\leq n+1\)</span></p>
<p>(in order to build a <span class="math">\(OA(k,nm+a+b+c+d)\)</span> the following designs must also
exist: <span class="math">\(OA(k,n-a)\)</span>, <span class="math">\(OA(k,n-b)\)</span>, <span class="math">\(OA(k,n-c)\)</span>, <span class="math">\(OA(k,d)\)</span>, <span class="math">\(OA(k,m+1)\)</span>,
<span class="math">\(OA(k,m+2)\)</span>, <span class="math">\(OA(k,m+3)\)</span>, <span class="math">\(OA(k,m+4)\)</span>)</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">k,n,m,a,b,c,d</span></code> &#8211; integers which must satisfy the constraints above. In
particular, <span class="math">\(a+b+c\leq n+1\)</span> must hold. By default, <span class="math">\(d=0\)</span>.</li>
<li><code class="docutils literal"><span class="pre">complement</span></code> (boolean) &#8211; whether to complement the sets, i.e. follow
the <span class="math">\(n-a,n-b,n-c\)</span> variant described above.</li>
<li><code class="docutils literal"><span class="pre">explain_construction</span></code> (boolean) &#8211; return a string describing
the construction.</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="orthogonal_arrays_find_recursive.html#sage.combinat.designs.orthogonal_arrays_find_recursive.find_thwart_lemma_3_5" title="sage.combinat.designs.orthogonal_arrays_find_recursive.find_thwart_lemma_3_5"><code class="xref py py-func docutils literal"><span class="pre">find_thwart_lemma_3_5()</span></code></a></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.orthogonal_arrays_build_recursive</span> <span class="kn">import</span> <span class="n">thwart_lemma_3_5</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.designs_pyx</span> <span class="kn">import</span> <span class="n">is_orthogonal_array</span>
<span class="gp">sage: </span><span class="n">OA</span> <span class="o">=</span> <span class="n">thwart_lemma_3_5</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_orthogonal_array</span><span class="p">(</span><span class="n">OA</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">23</span><span class="o">*</span><span class="mi">7</span><span class="o">+</span><span class="mi">5</span><span class="o">+</span><span class="mi">7</span><span class="o">+</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">explain_construction</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">408</span><span class="p">))</span>
<span class="go">Lemma 4.1 with n=13,m=28 from:</span>
<span class="go">   Charles J.Colbourn, Jeffrey H. Dinitz, Mieczyslaw Wojtas,</span>
<span class="go">   Thwarts in transversal designs,</span>
<span class="go">   Designs, Codes and Cryptography 5, no. 3 (1995): 189-197.</span>
</pre></div>
</div>
<p>With sets of parameters from <a class="reference internal" href="#thwarts" id="id14">[Thwarts]</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">l</span> <span class="o">=</span> <span class="p">[</span>
<span class="go">....:    [11, 27, 78, 16, 17, 25, 0],</span>
<span class="go">....:    [12, 19, 208, 11, 13, 16, 0],</span>
<span class="go">....:    [12, 19, 208, 13, 13, 16, 0],</span>
<span class="go">....:    [10, 13, 78, 9, 9, 13, 1],</span>
<span class="go">....:    [10, 13, 79, 9, 9, 13, 1]]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>                                       <span class="c1"># not tested -- too long</span>
<span class="go">....:     OA = thwart_lemma_3_5(k,n,m,a,b,c,d,complement=True)      # not tested -- too long</span>
<span class="go">....:     assert is_orthogonal_array(OA,k,n*m+a+b+c+d,verbose=True) # not tested -- too long</span>

<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">explain_construction</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">1046</span><span class="p">))</span>
<span class="go">Lemma 3.5 with n=13,m=79,a=9,b=1,c=0,d=9 from:</span>
<span class="go">   Charles J.Colbourn, Jeffrey H. Dinitz, Mieczyslaw Wojtas,</span>
<span class="go">   Thwarts in transversal designs,</span>
<span class="go">   Designs, Codes and Cryptography 5, no. 3 (1995): 189-197.</span>
</pre></div>
</div>
<p>REFERENCE:</p>
<table class="docutils citation" frame="void" id="thwarts" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Thwarts]</td><td><em>(<a class="fn-backref" href="#id12">1</a>, <a class="fn-backref" href="#id13">2</a>, <a class="fn-backref" href="#id14">3</a>, <a class="fn-backref" href="#id15">4</a>)</em> Thwarts in transversal designs
Charles J.Colbourn, Jeffrey H. Dinitz, Mieczyslaw Wojtas.
Designs, Codes and Cryptography 5, no. 3 (1995): 189-197.</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.orthogonal_arrays_build_recursive.thwart_lemma_4_1">
<code class="descclassname">sage.combinat.designs.orthogonal_arrays_build_recursive.</code><code class="descname">thwart_lemma_4_1</code><span class="sig-paren">(</span><em>k</em>, <em>n</em>, <em>m</em>, <em>explain_construction=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays_build_recursive.thwart_lemma_4_1" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an <span class="math">\(OA(k,nm+4(n-2))\)</span>.</p>
<p>Implements Lemma 4.1 from <a class="reference internal" href="#thwarts" id="id15">[Thwarts]</a>.</p>
<blockquote>
<div><p>If <span class="math">\(n\equiv 0,1\pmod{3}\)</span> is a prime power, then there exists a truncated
<span class="math">\(OA(n+1,n)\)</span> whose last four columns have size <span class="math">\(n-2\)</span> and intersect every
block on <span class="math">\(1,3\)</span> or <span class="math">\(4\)</span> values. Consequently, if there exists an
<span class="math">\(OA(k,m+1)\)</span>, <span class="math">\(OA(k,m+3)\)</span>, <span class="math">\(OA(k,m+4)\)</span> and a <span class="math">\(OA(k,n-2)\)</span> then there
exists an <span class="math">\(OA(k,nm+4(n-2)\)</span></p>
<p>Proof: form the transversal design by removing one point of the
<span class="math">\(AG(2,3)\)</span> (Affine Geometry) contained in the Desarguesian Projective
Plane <span class="math">\(PG(2,n)\)</span>.</p>
</div></blockquote>
<p>The affine geometry on 9 points contained in the projective geometry
<span class="math">\(PG(2,n)\)</span> is given explicitly in <a class="reference internal" href="#os64" id="id16">[OS64]</a> (Thanks to Julian R. Abel for
finding the reference!).</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">k,n,m</span></code> (integers)</li>
<li><code class="docutils literal"><span class="pre">explain_construction</span></code> (boolean) &#8211; return a string describing
the construction.</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="orthogonal_arrays_find_recursive.html#sage.combinat.designs.orthogonal_arrays_find_recursive.find_thwart_lemma_4_1" title="sage.combinat.designs.orthogonal_arrays_find_recursive.find_thwart_lemma_4_1"><code class="xref py py-func docutils literal"><span class="pre">find_thwart_lemma_4_1()</span></code></a></li>
</ul>
</div>
<p>EXAMPLE:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">explain_construction</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">408</span><span class="p">))</span>
<span class="go">Lemma 4.1 with n=13,m=28 from:</span>
<span class="go">   Charles J.Colbourn, Jeffrey H. Dinitz, Mieczyslaw Wojtas,</span>
<span class="go">   Thwarts in transversal designs,</span>
<span class="go">   Designs, Codes and Cryptography 5, no. 3 (1995): 189-197.</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="os64" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id16">[OS64]</a></td><td>Finite projective planes with affine subplanes,
T. G. Ostrom and F. A. Sherk.
Canad. Math. Bull vol7 num.4 (1964)</td></tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <h3><a href="../../../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">Orthogonal arrays (build recursive constructions)</a><ul>
<li><a class="reference internal" href="#functions">Functions</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="orthogonal_arrays.html"
                                  title="previous chapter">Orthogonal arrays (OA)</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="orthogonal_arrays_find_recursive.html"
                                  title="next chapter">Orthogonal arrays (find recursive constructions)</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../_sources/sage/combinat/designs/orthogonal_arrays_build_recursive.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="orthogonal_arrays_find_recursive.html" title="Orthogonal arrays (find recursive constructions)"
             >next</a> |</li>
        <li class="right" >
          <a href="orthogonal_arrays.html" title="Orthogonal arrays (OA)"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Combinatorics</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../../../module_list.html" >Comprehensive Module list</a> &raquo;</li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &copy; Copyright 2005--2016, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.4.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>