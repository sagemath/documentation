
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Orthogonal arrays (OA) &#8212; Sage Reference Manual v8.3: Combinatorics</title>
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Orthogonal arrays (build recursive constructions)" href="orthogonal_arrays_build_recursive.html" />
    <link rel="prev" title="Mutually Orthogonal Latin Squares (MOLS)" href="latin_squares.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="orthogonal_arrays_build_recursive.html" title="Orthogonal arrays (build recursive constructions)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="latin_squares.html" title="Mutually Orthogonal Latin Squares (MOLS)"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Combinatorics</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../../module_list.html" accesskey="U">Comprehensive Module list</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="orthogonal-arrays-oa">
<span id="sage-combinat-designs-orthogonal-arrays"></span><h1>Orthogonal arrays (OA)<a class="headerlink" href="#orthogonal-arrays-oa" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.combinat.designs.orthogonal_arrays"></span><p>This module gathers some construction related to orthogonal arrays (or
transversal designs). One can build an <span class="math notranslate nohighlight">\(OA(k,n)\)</span> (or check that it can be built)
from the Sage console with <code class="docutils literal notranslate"><span class="pre">designs.orthogonal_arrays.build</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">OA</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
<p>See also the modules <a class="reference internal" href="orthogonal_arrays_build_recursive.html#module-sage.combinat.designs.orthogonal_arrays_build_recursive" title="sage.combinat.designs.orthogonal_arrays_build_recursive"><code class="xref py py-mod docutils literal notranslate"><span class="pre">orthogonal_arrays_build_recursive</span></code></a> or
<a class="reference internal" href="orthogonal_arrays_find_recursive.html#module-sage.combinat.designs.orthogonal_arrays_find_recursive" title="sage.combinat.designs.orthogonal_arrays_find_recursive"><code class="xref py py-mod docutils literal notranslate"><span class="pre">orthogonal_arrays_find_recursive</span></code></a> for recursive
constructions.</p>
<p>This module defines the following functions:</p>
<table border="1" class="colwidths-given contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays.orthogonal_array" title="sage.combinat.designs.orthogonal_arrays.orthogonal_array"><code class="xref py py-meth docutils literal notranslate"><span class="pre">orthogonal_array()</span></code></a></td>
<td>Return an orthogonal array of parameters <span class="math notranslate nohighlight">\(k,n,t\)</span>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays.transversal_design" title="sage.combinat.designs.orthogonal_arrays.transversal_design"><code class="xref py py-meth docutils literal notranslate"><span class="pre">transversal_design()</span></code></a></td>
<td>Return a transversal design of parameters <span class="math notranslate nohighlight">\(k,n\)</span>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays.incomplete_orthogonal_array" title="sage.combinat.designs.orthogonal_arrays.incomplete_orthogonal_array"><code class="xref py py-meth docutils literal notranslate"><span class="pre">incomplete_orthogonal_array()</span></code></a></td>
<td>Return an <span class="math notranslate nohighlight">\(OA(k,n)-\sum_{1\leq i\leq x} OA(k,s_i)\)</span>.</td>
</tr>
</tbody>
</table>
<table border="1" class="colwidths-given contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays.is_transversal_design" title="sage.combinat.designs.orthogonal_arrays.is_transversal_design"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_transversal_design()</span></code></a></td>
<td>Check that a given set of blocks <code class="docutils literal notranslate"><span class="pre">B</span></code> is a transversal design.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="designs_pyx.html#sage.combinat.designs.designs_pyx.is_orthogonal_array" title="sage.combinat.designs.designs_pyx.is_orthogonal_array"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_orthogonal_array()</span></code></a></td>
<td>Check that the integer matrix <span class="math notranslate nohighlight">\(OA\)</span> is an <span class="math notranslate nohighlight">\(OA(k,n,t)\)</span>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays.wilson_construction" title="sage.combinat.designs.orthogonal_arrays.wilson_construction"><code class="xref py py-meth docutils literal notranslate"><span class="pre">wilson_construction()</span></code></a></td>
<td>Return a <span class="math notranslate nohighlight">\(OA(k,rm+u)\)</span> from a truncated <span class="math notranslate nohighlight">\(OA(k+s,r)\)</span> by Wilson’s construction.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays.TD_product" title="sage.combinat.designs.orthogonal_arrays.TD_product"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TD_product()</span></code></a></td>
<td>Return the product of two transversal designs.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays.OA_find_disjoint_blocks" title="sage.combinat.designs.orthogonal_arrays.OA_find_disjoint_blocks"><code class="xref py py-meth docutils literal notranslate"><span class="pre">OA_find_disjoint_blocks()</span></code></a></td>
<td>Return <span class="math notranslate nohighlight">\(x\)</span> disjoint blocks contained in a given <span class="math notranslate nohighlight">\(OA(k,n)\)</span>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays.OA_relabel" title="sage.combinat.designs.orthogonal_arrays.OA_relabel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">OA_relabel()</span></code></a></td>
<td>Return a relabelled version of the OA.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays.OA_from_quasi_difference_matrix" title="sage.combinat.designs.orthogonal_arrays.OA_from_quasi_difference_matrix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">OA_from_quasi_difference_matrix()</span></code></a></td>
<td>Return an Orthogonal Array from a Quasi-Difference matrix</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays.OA_from_Vmt" title="sage.combinat.designs.orthogonal_arrays.OA_from_Vmt"><code class="xref py py-meth docutils literal notranslate"><span class="pre">OA_from_Vmt()</span></code></a></td>
<td>Return an Orthogonal Array from a <span class="math notranslate nohighlight">\(V(m,t)\)</span></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays.OA_from_PBD" title="sage.combinat.designs.orthogonal_arrays.OA_from_PBD"><code class="xref py py-meth docutils literal notranslate"><span class="pre">OA_from_PBD()</span></code></a></td>
<td>Return an <span class="math notranslate nohighlight">\(OA(k,n)\)</span> from a PBD</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays.OA_n_times_2_pow_c_from_matrix" title="sage.combinat.designs.orthogonal_arrays.OA_n_times_2_pow_c_from_matrix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">OA_n_times_2_pow_c_from_matrix()</span></code></a></td>
<td>Return an <span class="math notranslate nohighlight">\(OA(k, \vert G\vert \cdot 2^c)\)</span> from a constrained <span class="math notranslate nohighlight">\((G,k-1,2)\)</span>-difference matrix.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays.OA_from_wider_OA" title="sage.combinat.designs.orthogonal_arrays.OA_from_wider_OA"><code class="xref py py-meth docutils literal notranslate"><span class="pre">OA_from_wider_OA()</span></code></a></td>
<td>Return the first <span class="math notranslate nohighlight">\(k\)</span> columns of <span class="math notranslate nohighlight">\(OA\)</span>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays.QDM_from_Vmt" title="sage.combinat.designs.orthogonal_arrays.QDM_from_Vmt"><code class="xref py py-meth docutils literal notranslate"><span class="pre">QDM_from_Vmt()</span></code></a></td>
<td>Return a QDM a <span class="math notranslate nohighlight">\(V(m,t)\)</span></td>
</tr>
</tbody>
</table>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="cd96" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[CD96]</td><td>Making the MOLS table
Charles Colbourn and Jeffrey Dinitz
Computational and constructive design theory
vol 368,pages 67-134
1996</td></tr>
</tbody>
</table>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="sage.combinat.designs.orthogonal_arrays.OAMainFunctions">
<em class="property">class </em><code class="descclassname">sage.combinat.designs.orthogonal_arrays.</code><code class="descname">OAMainFunctions</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays.OAMainFunctions" title="Permalink to this definition">¶</a></dt>
<dd><p>Functions related to orthogonal arrays.</p>
<p>An orthogonal array of parameters <span class="math notranslate nohighlight">\(k,n,t\)</span> is a matrix with <span class="math notranslate nohighlight">\(k\)</span> columns
filled with integers from <span class="math notranslate nohighlight">\([n]\)</span> in such a way that for any <span class="math notranslate nohighlight">\(t\)</span> columns, each
of the <span class="math notranslate nohighlight">\(n^t\)</span> possible rows occurs exactly once. In particular, the matrix
has <span class="math notranslate nohighlight">\(n^t\)</span> rows.</p>
<p>For more information on orthogonal arrays, see
<a class="reference external" href="https://en.wikipedia.org/wiki/Orthogonal_array">Wikipedia article Orthogonal_array</a>.</p>
<p>From here you have access to:</p>
<ul class="simple">
<li><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays.OAMainFunctions.build" title="sage.combinat.designs.orthogonal_arrays.OAMainFunctions.build"><code class="xref py py-meth docutils literal notranslate"><span class="pre">build(k,n,t=2)</span></code></a>: return an orthogonal array with the given
parameters.</li>
<li><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays.OAMainFunctions.is_available" title="sage.combinat.designs.orthogonal_arrays.OAMainFunctions.is_available"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_available(k,n,t=2)</span></code></a>: answer whether there is a
construction available in Sage for a given set of parameters.</li>
<li><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays.OAMainFunctions.exists" title="sage.combinat.designs.orthogonal_arrays.OAMainFunctions.exists"><code class="xref py py-meth docutils literal notranslate"><span class="pre">exists(k,n,t=2)</span></code></a>: answer whether an orthogonal array with
these parameters exist.</li>
<li><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays.largest_available_k" title="sage.combinat.designs.orthogonal_arrays.largest_available_k"><code class="xref py py-meth docutils literal notranslate"><span class="pre">largest_available_k(n,t=2)</span></code></a>: return the
largest integer <span class="math notranslate nohighlight">\(k\)</span> such that Sage knows how to build an <span class="math notranslate nohighlight">\(OA(k,n)\)</span>.</li>
<li><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays.OAMainFunctions.explain_construction" title="sage.combinat.designs.orthogonal_arrays.OAMainFunctions.explain_construction"><code class="xref py py-meth docutils literal notranslate"><span class="pre">explain_construction(k,n,t=2)</span></code></a>: return a
string that explains the construction that Sage uses to build an
<span class="math notranslate nohighlight">\(OA(k,n)\)</span>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[[0, 0, 0], [0, 1, 1], [1, 0, 1], [1, 1, 0]]</span>

<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[[0, 0, 0, 0, 0], [0, 1, 2, 3, 4], [0, 2, 4, 1, 3],</span>
<span class="go"> [0, 3, 1, 4, 2], [0, 4, 3, 2, 1], [1, 0, 4, 3, 2],</span>
<span class="go"> [1, 1, 1, 1, 1], [1, 2, 3, 4, 0], [1, 3, 0, 2, 4],</span>
<span class="go"> [1, 4, 2, 0, 3], [2, 0, 3, 1, 4], [2, 1, 0, 4, 3],</span>
<span class="go"> [2, 2, 2, 2, 2], [2, 3, 4, 0, 1], [2, 4, 1, 3, 0],</span>
<span class="go"> [3, 0, 2, 4, 1], [3, 1, 4, 2, 0], [3, 2, 1, 0, 4],</span>
<span class="go"> [3, 3, 3, 3, 3], [3, 4, 0, 1, 2], [4, 0, 1, 2, 3],</span>
<span class="go"> [4, 1, 3, 0, 2], [4, 2, 0, 3, 1], [4, 3, 2, 1, 0],</span>
<span class="go"> [4, 4, 4, 4, 4]]</span>
</pre></div>
</div>
<p>What is the largest value of <span class="math notranslate nohighlight">\(k\)</span> for which Sage knows how to compute a
<span class="math notranslate nohighlight">\(OA(k,14,2)\)</span>?:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">largest_available_k</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<span class="go">6</span>
</pre></div>
</div>
<p>If you ask for an orthogonal array that does not exist, then you will
either obtain an <code class="docutils literal notranslate"><span class="pre">EmptySetError</span></code> (if it knows that such an orthogonal array
does not exist) or a <code class="docutils literal notranslate"><span class="pre">NotImplementedError</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">EmptySetError</span>: <span class="n">There exists no OA(4,2) as k(=4)&gt;n+t-1=3</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">I don&#39;t know how to build an OA(12,20)!</span>
</pre></div>
</div>
<dl class="staticmethod">
<dt id="sage.combinat.designs.orthogonal_arrays.OAMainFunctions.build">
<em class="property">static </em><code class="descname">build</code><span class="sig-paren">(</span><em>k</em>, <em>n</em>, <em>t=2</em>, <em>resolvable=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays.OAMainFunctions.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an <span class="math notranslate nohighlight">\(OA(k,n)\)</span> of strength <span class="math notranslate nohighlight">\(t\)</span></p>
<p>An orthogonal array of parameters <span class="math notranslate nohighlight">\(k,n,t\)</span> is a matrix with <span class="math notranslate nohighlight">\(k\)</span>
columns filled with integers from <span class="math notranslate nohighlight">\([n]\)</span> in such a way that for any
<span class="math notranslate nohighlight">\(t\)</span> columns, each of the <span class="math notranslate nohighlight">\(n^t\)</span> possible rows occurs exactly
once. In particular, the matrix has <span class="math notranslate nohighlight">\(n^t\)</span> rows.</p>
<p>More general definitions sometimes involve a <span class="math notranslate nohighlight">\(\lambda\)</span> parameter, and we
assume here that <span class="math notranslate nohighlight">\(\lambda=1\)</span>.</p>
<p>For more information on orthogonal arrays, see
<a class="reference external" href="https://en.wikipedia.org/wiki/Orthogonal_array">Wikipedia article Orthogonal_array</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">k,n,t</span></code> (integers) – parameters of the orthogonal array.</li>
<li><code class="docutils literal notranslate"><span class="pre">resolvable</span></code> (boolean) – set to <code class="docutils literal notranslate"><span class="pre">True</span></code> if you want the design to be
resolvable. The <span class="math notranslate nohighlight">\(n\)</span> classes of the resolvable design are obtained as the
first <span class="math notranslate nohighlight">\(n\)</span> blocks, then the next <span class="math notranslate nohighlight">\(n\)</span> blocks, etc … Set to <code class="docutils literal notranslate"><span class="pre">False</span></code> by
default.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">resolvable</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c1"># indirect doctest</span>
<span class="go">[[0, 0, 0],</span>
<span class="go"> [1, 2, 1],</span>
<span class="go"> [2, 1, 2],</span>
<span class="go"> [0, 2, 2],</span>
<span class="go"> [1, 1, 0],</span>
<span class="go"> [2, 0, 1],</span>
<span class="go"> [0, 1, 1],</span>
<span class="go"> [1, 0, 2],</span>
<span class="go"> [2, 2, 0]]</span>
<span class="gp">sage: </span><span class="n">OA_7_50</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>      <span class="c1"># indirect doctest</span>
</pre></div>
</div>
</dd></dl>

<dl class="staticmethod">
<dt id="sage.combinat.designs.orthogonal_arrays.OAMainFunctions.exists">
<em class="property">static </em><code class="descname">exists</code><span class="sig-paren">(</span><em>k</em>, <em>n</em>, <em>t=2</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays.OAMainFunctions.exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the existence status of an <span class="math notranslate nohighlight">\(OA(k,n)\)</span></p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">k,n,t</span></code> (integers) – parameters of the orthogonal array.</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The function does not only return booleans, but <code class="docutils literal notranslate"><span class="pre">True</span></code>,
<code class="docutils literal notranslate"><span class="pre">False</span></code>, or <code class="docutils literal notranslate"><span class="pre">Unknown</span></code>.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays.OAMainFunctions.is_available" title="sage.combinat.designs.orthogonal_arrays.OAMainFunctions.is_available"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_available()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="c1"># indirect doctest</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="c1"># indirect doctest</span>
<span class="go">Unknown</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="c1"># indirect doctest</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="staticmethod">
<dt id="sage.combinat.designs.orthogonal_arrays.OAMainFunctions.explain_construction">
<em class="property">static </em><code class="descname">explain_construction</code><span class="sig-paren">(</span><em>k</em>, <em>n</em>, <em>t=2</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays.OAMainFunctions.explain_construction" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a string describing how to builds an <span class="math notranslate nohighlight">\(OA(k,n)\)</span></p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">k,n,t</span></code> (integers) – parameters of the orthogonal array.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">explain_construction</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">565</span><span class="p">)</span>
<span class="go">&quot;Wilson&#39;s construction n=23.24+13 with master design OA(9+1,23)&quot;</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">explain_construction</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">154</span><span class="p">)</span>
<span class="go">&#39;the database contains a (137,10;1,0;17)-quasi difference matrix&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="staticmethod">
<dt id="sage.combinat.designs.orthogonal_arrays.OAMainFunctions.is_available">
<em class="property">static </em><code class="descname">is_available</code><span class="sig-paren">(</span><em>k</em>, <em>n</em>, <em>t=2</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays.OAMainFunctions.is_available" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether Sage can build an <span class="math notranslate nohighlight">\(OA(k,n)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">k,n,t</span></code> (integers) – parameters of the orthogonal array.</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays.OAMainFunctions.exists" title="sage.combinat.designs.orthogonal_arrays.OAMainFunctions.exists"><code class="xref py py-meth docutils literal notranslate"><span class="pre">exists()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">is_available</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="c1"># indirect doctest</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">is_available</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="c1"># indirect doctest</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="staticmethod">
<dt id="sage.combinat.designs.orthogonal_arrays.OAMainFunctions.largest_available_k">
<em class="property">static </em><code class="descname">largest_available_k</code><span class="sig-paren">(</span><em>n</em>, <em>t=2</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays.OAMainFunctions.largest_available_k" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the largest <span class="math notranslate nohighlight">\(k\)</span> such that Sage can build an <span class="math notranslate nohighlight">\(OA(k,n)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">n</span></code> (integer)</li>
<li><code class="docutils literal notranslate"><span class="pre">t</span></code> – (integer; default: 2) – strength of the array</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">largest_available_k</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">largest_available_k</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">largest_available_k</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">largest_available_k</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span>
<span class="go">28</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">largest_available_k</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">largest_available_k</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">n(=-1) was expected to be &gt;=0</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.orthogonal_arrays.OA_find_disjoint_blocks">
<code class="descclassname">sage.combinat.designs.orthogonal_arrays.</code><code class="descname">OA_find_disjoint_blocks</code><span class="sig-paren">(</span><em>OA</em>, <em>k</em>, <em>n</em>, <em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays.OA_find_disjoint_blocks" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <span class="math notranslate nohighlight">\(x\)</span> disjoint blocks contained in a given <span class="math notranslate nohighlight">\(OA(k,n)\)</span>.</p>
<p><span class="math notranslate nohighlight">\(x\)</span> blocks of an <span class="math notranslate nohighlight">\(OA\)</span> are said to be disjoint if they all have
different values for a every given index, i.e. if they correspond to
disjoint blocks in the <span class="math notranslate nohighlight">\(TD\)</span> associated with the <span class="math notranslate nohighlight">\(OA\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">OA</span></code> – an orthogonal array</li>
<li><code class="docutils literal notranslate"><span class="pre">k,n,x</span></code> (integers)</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays.incomplete_orthogonal_array" title="sage.combinat.designs.orthogonal_arrays.incomplete_orthogonal_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">incomplete_orthogonal_array()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.orthogonal_arrays</span> <span class="kn">import</span> <span class="n">OA_find_disjoint_blocks</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span><span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">;</span><span class="n">x</span><span class="o">=</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">Bs</span> <span class="o">=</span> <span class="n">OA_find_disjoint_blocks</span><span class="p">(</span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">),</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">Bs</span><span class="p">)</span> <span class="o">==</span> <span class="n">x</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
<span class="go">....:     assert len(set([B[i] for B in Bs])) == x</span>
<span class="gp">sage: </span><span class="n">OA_find_disjoint_blocks</span><span class="p">(</span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">),</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">There does not exist 5 disjoint blocks in this OA(3,4)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.orthogonal_arrays.OA_from_PBD">
<code class="descclassname">sage.combinat.designs.orthogonal_arrays.</code><code class="descname">OA_from_PBD</code><span class="sig-paren">(</span><em>k</em>, <em>n</em>, <em>PBD</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays.OA_from_PBD" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an <span class="math notranslate nohighlight">\(OA(k,n)\)</span> from a PBD</p>
<p><strong>Construction</strong></p>
<p>Let <span class="math notranslate nohighlight">\(\mathcal B\)</span> be a <span class="math notranslate nohighlight">\((n,K,1)\)</span>-PBD. If there exists for every <span class="math notranslate nohighlight">\(i\in K\)</span> a
<span class="math notranslate nohighlight">\(TD(k,i)-i\times TD(k,1)\)</span> (i.e. if there exist <span class="math notranslate nohighlight">\(k\)</span> idempotent MOLS), then
one can obtain a <span class="math notranslate nohighlight">\(OA(k,n)\)</span> by concatenating:</p>
<ul class="simple">
<li>A <span class="math notranslate nohighlight">\(TD(k,i)-i\times TD(k,1)\)</span> defined over the elements of <span class="math notranslate nohighlight">\(B\)</span> for every <span class="math notranslate nohighlight">\(B
\in \mathcal B\)</span>.</li>
<li>The rows <span class="math notranslate nohighlight">\((i,...,i)\)</span> of length <span class="math notranslate nohighlight">\(k\)</span> for every <span class="math notranslate nohighlight">\(i\in [n]\)</span>.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This function raises an exception when Sage is unable to build the
necessary designs.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">k,n</span></code> (integers)</li>
<li><code class="docutils literal notranslate"><span class="pre">PBD</span></code> – a PBD on <span class="math notranslate nohighlight">\(0,...,n-1\)</span>.</li>
</ul>
<p>EXAMPLES:</p>
<p>We start from the example VI.1.2 from the <a class="reference internal" href="database.html#designhandbook" id="id1">[DesignHandbook]</a> to build an
<span class="math notranslate nohighlight">\(OA(3,10)\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.orthogonal_arrays</span> <span class="kn">import</span> <span class="n">OA_from_PBD</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.designs_pyx</span> <span class="kn">import</span> <span class="n">is_orthogonal_array</span>
<span class="gp">sage: </span><span class="n">pbd</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span>
<span class="go">....: [1,6,9],[2,4,9],[2,5,7],[2,6,8],[3,4,8],[3,5,9],[3,6,7]]</span>
<span class="gp">sage: </span><span class="n">oa</span> <span class="o">=</span> <span class="n">OA_from_PBD</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">pbd</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_orthogonal_array</span><span class="p">(</span><span class="n">oa</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>But we cannot build an <span class="math notranslate nohighlight">\(OA(4,10)\)</span> for this PBD (although there
exists an <span class="math notranslate nohighlight">\(OA(4,10)\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">OA_from_PBD</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">pbd</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">EmptySetError</span>: <span class="n">There is no OA(n+1,n) - 3.OA(n+1,1) as all blocks intersect in a projective plane.</span>
</pre></div>
</div>
<p>Or an <span class="math notranslate nohighlight">\(OA(3,6)\)</span> (as the PBD has 10 points):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">_</span> <span class="o">=</span> <span class="n">OA_from_PBD</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="n">pbd</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">PBD is not a valid Pairwise Balanced Design on [0,...,5]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.orthogonal_arrays.OA_from_Vmt">
<code class="descclassname">sage.combinat.designs.orthogonal_arrays.</code><code class="descname">OA_from_Vmt</code><span class="sig-paren">(</span><em>m</em>, <em>t</em>, <em>V</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays.OA_from_Vmt" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an Orthogonal Array from a <span class="math notranslate nohighlight">\(V(m,t)\)</span></p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">m,t</span></code> (integers)</li>
<li><code class="docutils literal notranslate"><span class="pre">V</span></code> – the vector <span class="math notranslate nohighlight">\(V(m,t)\)</span>.</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays.QDM_from_Vmt" title="sage.combinat.designs.orthogonal_arrays.QDM_from_Vmt"><code class="xref py py-func docutils literal notranslate"><span class="pre">QDM_from_Vmt()</span></code></a></li>
<li><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays.OA_from_quasi_difference_matrix" title="sage.combinat.designs.orthogonal_arrays.OA_from_quasi_difference_matrix"><code class="xref py py-func docutils literal notranslate"><span class="pre">OA_from_quasi_difference_matrix()</span></code></a></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">_</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">46</span><span class="p">)</span> <span class="c1"># indirect doctest</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.orthogonal_arrays.OA_from_quasi_difference_matrix">
<code class="descclassname">sage.combinat.designs.orthogonal_arrays.</code><code class="descname">OA_from_quasi_difference_matrix</code><span class="sig-paren">(</span><em>M</em>, <em>G</em>, <em>add_col=True</em>, <em>fill_hole=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays.OA_from_quasi_difference_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an Orthogonal Array from a Quasi-Difference matrix</p>
<p><strong>Difference Matrices</strong></p>
<p>Let <span class="math notranslate nohighlight">\(G\)</span> be a group of order <span class="math notranslate nohighlight">\(g\)</span>. A <em>difference matrix</em> <span class="math notranslate nohighlight">\(M\)</span> is a <span class="math notranslate nohighlight">\(g\times k\)</span>
matrix with entries from <span class="math notranslate nohighlight">\(G\)</span> such that for any <span class="math notranslate nohighlight">\(1\leq i &lt; j &lt; k\)</span> the set
<span class="math notranslate nohighlight">\(\{d_{li}-d_{lj}:1\leq l \leq g\}\)</span> is equal to <span class="math notranslate nohighlight">\(G\)</span>.</p>
<p>By concatenating the <span class="math notranslate nohighlight">\(g\)</span> matrices <span class="math notranslate nohighlight">\(M+x\)</span> (where <span class="math notranslate nohighlight">\(x\in G\)</span>), one obtains a
matrix of size <span class="math notranslate nohighlight">\(g^2\times x\)</span> which is also an <span class="math notranslate nohighlight">\(OA(k,g)\)</span>.</p>
<p><strong>Quasi-difference Matrices</strong></p>
<p>A quasi-difference matrix is a difference matrix with missing entries. The
construction above can be applied again in this case, where the missing
entries in each column of <span class="math notranslate nohighlight">\(M\)</span> are replaced by unique values on which <span class="math notranslate nohighlight">\(G\)</span> has
a trivial action.</p>
<p>This produces an incomplete orthogonal array with a “hole” (i.e. missing
rows) of size ‘u’ (i.e. the number of missing values per column of <span class="math notranslate nohighlight">\(M\)</span>). If
there exists an <span class="math notranslate nohighlight">\(OA(k,u)\)</span>, then adding the rows of this <span class="math notranslate nohighlight">\(OA(k,u)\)</span> to the
incomplete orthogonal array should lead to an OA…</p>
<p><strong>Formal definition</strong> (from the Handbook of Combinatorial Designs <a class="reference internal" href="database.html#designhandbook" id="id2">[DesignHandbook]</a>)</p>
<p>Let <span class="math notranslate nohighlight">\(G\)</span> be an abelian group of order <span class="math notranslate nohighlight">\(n\)</span>. A
<span class="math notranslate nohighlight">\((n,k;\lambda,\mu;u)\)</span>-quasi-difference matrix (QDM) is a matrix <span class="math notranslate nohighlight">\(Q=(q_{ij})\)</span>
with <span class="math notranslate nohighlight">\(\lambda(n-1+2u)+\mu\)</span> rows and <span class="math notranslate nohighlight">\(k\)</span> columns, with each entry either
empty or containing an element of <span class="math notranslate nohighlight">\(G\)</span>. Each column contains exactly <span class="math notranslate nohighlight">\(\lambda
u\)</span> entries, and each row contains at most one empty entry. Furthermore, for
each <span class="math notranslate nohighlight">\(1 \leq i &lt; j \leq k\)</span> the multiset</p>
<div class="math notranslate nohighlight">
\[\{ q_{li} - q_{lj}: 1 \leq l \leq \lambda (n-1+2u)+\mu, \text{ with }q_{li}\text{ and }q_{lj}\text{ not  empty}\}\]</div>
<p>contains every nonzero element of <span class="math notranslate nohighlight">\(G\)</span> exactly <span class="math notranslate nohighlight">\(\lambda\)</span> times, and contains
0 exactly <span class="math notranslate nohighlight">\(\mu\)</span> times.</p>
<p><strong>Construction</strong></p>
<p>If a <span class="math notranslate nohighlight">\((n,k;\lambda,\mu;u)\)</span>-QDM exists and <span class="math notranslate nohighlight">\(\mu \leq \lambda\)</span>, then an
<span class="math notranslate nohighlight">\(ITD_\lambda (k,n+u;u)\)</span> exists. Start with a <span class="math notranslate nohighlight">\((n,k;\lambda,\mu;u)\)</span>-QDM <span class="math notranslate nohighlight">\(A\)</span>
over the group <span class="math notranslate nohighlight">\(G\)</span>. Append <span class="math notranslate nohighlight">\(\lambda-\mu\)</span> rows of zeroes. Then select <span class="math notranslate nohighlight">\(u\)</span>
elements <span class="math notranslate nohighlight">\(\infty_1,\dots,\infty_u\)</span> not in <span class="math notranslate nohighlight">\(G\)</span>, and replace the empty
entries, each by one of these infinite symbols, so that <span class="math notranslate nohighlight">\(\infty_i\)</span> appears
exactly once in each column. Develop the resulting matrix over the group <span class="math notranslate nohighlight">\(G\)</span>
(leaving infinite symbols fixed), to obtain a <span class="math notranslate nohighlight">\(\lambda (n^2+2nu)\times k\)</span>
matrix <span class="math notranslate nohighlight">\(T\)</span>. Then <span class="math notranslate nohighlight">\(T\)</span> is an orthogonal array with <span class="math notranslate nohighlight">\(k\)</span> columns and index
<span class="math notranslate nohighlight">\(\lambda\)</span>, having <span class="math notranslate nohighlight">\(n+u\)</span> symbols and one hole of size <span class="math notranslate nohighlight">\(u\)</span>.</p>
<p>Adding to <span class="math notranslate nohighlight">\(T\)</span> an <span class="math notranslate nohighlight">\(OA(k,u)\)</span> with elements <span class="math notranslate nohighlight">\(\infty_1,\dots,\infty_u\)</span> yields
the <span class="math notranslate nohighlight">\(ITD_\lambda(k,n+u;u)\)</span>.</p>
<p>For more information, see the Handbook of Combinatorial Designs
<a class="reference internal" href="database.html#designhandbook" id="id3">[DesignHandbook]</a> or
<a class="reference external" href="http://web.cs.du.edu/~petr/milehigh/2013/Colbourn.pdf">http://web.cs.du.edu/~petr/milehigh/2013/Colbourn.pdf</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">M</span></code> – the difference matrix whose entries belong to <code class="docutils literal notranslate"><span class="pre">G</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">G</span></code> – a group</li>
<li><code class="docutils literal notranslate"><span class="pre">add_col</span></code> (boolean) – whether to add a column to the final OA equal to
<span class="math notranslate nohighlight">\((x_1,\dots,x_g,x_1,\dots,x_g,\dots)\)</span> where <span class="math notranslate nohighlight">\(G=\{x_1,\dots,x_g\}\)</span>.</li>
<li><code class="docutils literal notranslate"><span class="pre">fill_hole</span></code> (boolean) – whether to return the incomplete orthogonal
array, or complete it with the <span class="math notranslate nohighlight">\(OA(k,u)\)</span> (default). When <code class="docutils literal notranslate"><span class="pre">fill_hole</span> <span class="pre">is</span>
<span class="pre">None</span></code>, no block of the incomplete OA contains more than one value <span class="math notranslate nohighlight">\(\geq
|G|\)</span>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">_</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># indirect doctest</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.orthogonal_arrays.OA_from_wider_OA">
<code class="descclassname">sage.combinat.designs.orthogonal_arrays.</code><code class="descname">OA_from_wider_OA</code><span class="sig-paren">(</span><em>OA</em>, <em>k</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays.OA_from_wider_OA" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the first <span class="math notranslate nohighlight">\(k\)</span> columns of <span class="math notranslate nohighlight">\(OA\)</span>.</p>
<p>If <span class="math notranslate nohighlight">\(OA\)</span> has <span class="math notranslate nohighlight">\(k\)</span> columns, this function returns <span class="math notranslate nohighlight">\(OA\)</span> immediately.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">OA</span></code> – an orthogonal array.</li>
<li><code class="docutils literal notranslate"><span class="pre">k</span></code> (integer)</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.orthogonal_arrays</span> <span class="kn">import</span> <span class="n">OA_from_wider_OA</span>
<span class="gp">sage: </span><span class="n">OA_from_wider_OA</span><span class="p">(</span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mi">1</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>
<span class="go">[(19,), (19,), (19,), (19,), (19,)]</span>
<span class="gp">sage: </span><span class="n">_</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">46</span><span class="p">)</span> <span class="c1"># indirect doctest</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.orthogonal_arrays.OA_n_times_2_pow_c_from_matrix">
<code class="descclassname">sage.combinat.designs.orthogonal_arrays.</code><code class="descname">OA_n_times_2_pow_c_from_matrix</code><span class="sig-paren">(</span><em>k</em>, <em>c</em>, <em>G</em>, <em>A</em>, <em>Y</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays.OA_n_times_2_pow_c_from_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an <span class="math notranslate nohighlight">\(OA(k, |G| \cdot 2^c)\)</span> from a constrained <span class="math notranslate nohighlight">\((G,k-1,2)\)</span>-difference
matrix.</p>
<p>This construction appears in <a class="reference internal" href="#abelcheng1994" id="id4">[AbelCheng1994]</a> and <a class="reference internal" href="#abelthesis" id="id5">[AbelThesis]</a>.</p>
<p>Let <span class="math notranslate nohighlight">\(G\)</span> be an additive Abelian group. We denote by <span class="math notranslate nohighlight">\(H\)</span> a <span class="math notranslate nohighlight">\(GF(2)\)</span>-hyperplane
in <span class="math notranslate nohighlight">\(GF(2^c)\)</span>.</p>
<p>Let <span class="math notranslate nohighlight">\(A\)</span> be a <span class="math notranslate nohighlight">\((k-1) \times 2|G|\)</span> array with entries in <span class="math notranslate nohighlight">\(G \times GF(2^c)\)</span>
and <span class="math notranslate nohighlight">\(Y\)</span> be a vector with <span class="math notranslate nohighlight">\(k-1\)</span> entries in <span class="math notranslate nohighlight">\(GF(2^c)\)</span>. Let <span class="math notranslate nohighlight">\(B\)</span> and <span class="math notranslate nohighlight">\(C\)</span> be
respectively the part of the array that belong to <span class="math notranslate nohighlight">\(G\)</span> and <span class="math notranslate nohighlight">\(GF(2^c)\)</span>.</p>
<p>The input <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> must satisfy the following conditions. For any <span class="math notranslate nohighlight">\(i \neq
j\)</span> and <span class="math notranslate nohighlight">\(g \in G\)</span>:</p>
<ul class="simple">
<li>there are exactly two values of <span class="math notranslate nohighlight">\(s\)</span> such that <span class="math notranslate nohighlight">\(B_{i,s} - B_{j,s} = g\)</span>
(i.e. <span class="math notranslate nohighlight">\(B\)</span> is a <span class="math notranslate nohighlight">\((G,k-1,2)\)</span>-difference matrix),</li>
<li>let <span class="math notranslate nohighlight">\(s_1\)</span> and <span class="math notranslate nohighlight">\(s_2\)</span> denote the two values of <span class="math notranslate nohighlight">\(s\)</span> given above, then exactly
one of <span class="math notranslate nohighlight">\(C_{i,s_1} - C_{j,s_1}\)</span> and <span class="math notranslate nohighlight">\(C_{i,s_2} - C_{j,s_2}\)</span> belongs to the
<span class="math notranslate nohighlight">\(GF(2)\)</span>-hyperplane <span class="math notranslate nohighlight">\((Y_i - Y_j) \cdot H\)</span> (we implicitely assumed that <span class="math notranslate nohighlight">\(Y_i
\not= Y_j\)</span>).</li>
</ul>
<p>Under these conditions, it is easy to check that the array whose <span class="math notranslate nohighlight">\(k-1\)</span> rows
of length <span class="math notranslate nohighlight">\(|G|\cdot 2^c\)</span> indexed by <span class="math notranslate nohighlight">\(1 \leq i \leq k-1\)</span> given by <span class="math notranslate nohighlight">\(A_{i,s} +
(0, Y_i \cdot v)\)</span> where <span class="math notranslate nohighlight">\(1\leq s \leq 2|G|,v\in H\)</span> is a <span class="math notranslate nohighlight">\((G \times
GF(2^c),k-1,1)\)</span>-difference matrix.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">k,c</span></code> (integers) – integers</li>
<li><code class="docutils literal notranslate"><span class="pre">G</span></code> – an additive Abelian group</li>
<li><code class="docutils literal notranslate"><span class="pre">A</span></code> – a matrix with entries in <span class="math notranslate nohighlight">\(G \times GF(2^c)\)</span></li>
<li><code class="docutils literal notranslate"><span class="pre">Y</span></code> – a vector with entries in <span class="math notranslate nohighlight">\(GF(2^c)\)</span></li>
<li><code class="docutils literal notranslate"><span class="pre">check</span></code> – (boolean) Whether to check that output is correct before
returning it. As this is expected to be useless (but we are cautious
guys), you may want to disable it whenever you want speed. Set to
<code class="docutils literal notranslate"><span class="pre">True</span></code> by default.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">By convention, a multiplicative generator <span class="math notranslate nohighlight">\(w\)</span> of <span class="math notranslate nohighlight">\(GF(2^c)^*\)</span> is fixed
(inside the function). The hyperplane <span class="math notranslate nohighlight">\(H\)</span> is the one spanned by <span class="math notranslate nohighlight">\(w^0,
w^1, \ldots, w^{c-1}\)</span>. The <span class="math notranslate nohighlight">\(GF(2^c)\)</span> part of the input matrix <span class="math notranslate nohighlight">\(A\)</span> and
vector <span class="math notranslate nohighlight">\(Y\)</span> are given in the following form: the integer <span class="math notranslate nohighlight">\(i\)</span> corresponds
to the element <span class="math notranslate nohighlight">\(w^i\)</span> and <code class="docutils literal notranslate"><span class="pre">None</span></code> corresponds to <span class="math notranslate nohighlight">\(0\)</span>.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p>Several examples use this construction:</p>
<ul class="last simple">
<li><a class="reference internal" href="database.html#sage.combinat.designs.database.OA_9_40" title="sage.combinat.designs.database.OA_9_40"><code class="xref py py-func docutils literal notranslate"><span class="pre">OA_9_40()</span></code></a></li>
<li><a class="reference internal" href="database.html#sage.combinat.designs.database.OA_11_80" title="sage.combinat.designs.database.OA_11_80"><code class="xref py py-func docutils literal notranslate"><span class="pre">OA_11_80()</span></code></a></li>
<li><a class="reference internal" href="database.html#sage.combinat.designs.database.OA_15_112" title="sage.combinat.designs.database.OA_15_112"><code class="xref py py-func docutils literal notranslate"><span class="pre">OA_15_112()</span></code></a></li>
<li><a class="reference internal" href="database.html#sage.combinat.designs.database.OA_11_160" title="sage.combinat.designs.database.OA_11_160"><code class="xref py py-func docutils literal notranslate"><span class="pre">OA_11_160()</span></code></a></li>
<li><a class="reference internal" href="database.html#sage.combinat.designs.database.OA_16_176" title="sage.combinat.designs.database.OA_16_176"><code class="xref py py-func docutils literal notranslate"><span class="pre">OA_16_176()</span></code></a></li>
<li><a class="reference internal" href="database.html#sage.combinat.designs.database.OA_16_208" title="sage.combinat.designs.database.OA_16_208"><code class="xref py py-func docutils literal notranslate"><span class="pre">OA_16_208()</span></code></a></li>
<li><a class="reference internal" href="database.html#sage.combinat.designs.database.OA_15_224" title="sage.combinat.designs.database.OA_15_224"><code class="xref py py-func docutils literal notranslate"><span class="pre">OA_15_224()</span></code></a></li>
<li><a class="reference internal" href="database.html#sage.combinat.designs.database.OA_20_352" title="sage.combinat.designs.database.OA_20_352"><code class="xref py py-func docutils literal notranslate"><span class="pre">OA_20_352()</span></code></a></li>
<li><a class="reference internal" href="database.html#sage.combinat.designs.database.OA_20_416" title="sage.combinat.designs.database.OA_20_416"><code class="xref py py-func docutils literal notranslate"><span class="pre">OA_20_416()</span></code></a></li>
<li><a class="reference internal" href="database.html#sage.combinat.designs.database.OA_20_544" title="sage.combinat.designs.database.OA_20_544"><code class="xref py py-func docutils literal notranslate"><span class="pre">OA_20_544()</span></code></a></li>
<li><a class="reference internal" href="database.html#sage.combinat.designs.database.OA_11_640" title="sage.combinat.designs.database.OA_11_640"><code class="xref py py-func docutils literal notranslate"><span class="pre">OA_11_640()</span></code></a></li>
<li><a class="reference internal" href="database.html#sage.combinat.designs.database.OA_15_896" title="sage.combinat.designs.database.OA_15_896"><code class="xref py py-func docutils literal notranslate"><span class="pre">OA_15_896()</span></code></a></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.orthogonal_arrays</span> <span class="kn">import</span> <span class="n">OA_n_times_2_pow_c_from_matrix</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.designs_pyx</span> <span class="kn">import</span> <span class="n">is_orthogonal_array</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="p">[</span>
<span class="go">....: [(0,None),(0,None),(0,None),(0,None),(0,None),(0,None),(0,None),(0,None),(0,None),(0,None)],</span>
<span class="go">....: [(0,None),(1,None),   (2,2),   (3,2),   (4,2),(2,None),(3,None),(4,None),   (0,2),   (1,2)],</span>
<span class="go">....: [(0,None),   (2,5),   (4,5),   (1,2),   (3,6),   (3,4),   (0,0),   (2,1),   (4,1),   (1,6)],</span>
<span class="go">....: [(0,None),   (3,4),   (1,4),   (4,0),   (2,5),(3,None),   (1,0),   (4,1),   (2,2),   (0,3)],</span>
<span class="go">....: ]</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">OA</span> <span class="o">=</span> <span class="n">OA_n_times_2_pow_c_from_matrix</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">A</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_orthogonal_array</span><span class="p">(</span><span class="n">OA</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">None</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">OA_n_times_2_pow_c_from_matrix</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">A</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">the first part of the matrix A must be a</span>
<span class="go">(G,k-1,2)-difference matrix</span>

<span class="gp">sage: </span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">OA_n_times_2_pow_c_from_matrix</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">A</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">B_2,0 - B_0,0 = B_2,6 - B_0,6 but the associated part of the</span>
<span class="go">matrix C does not satisfies the required condition</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="abelthesis" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[AbelThesis]</a></td><td>On the Existence of Balanced Incomplete Block Designs and Transversal Designs,
Julian R. Abel,
PhD Thesis,
University of New South Wales,
1995</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="abelcheng1994" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[AbelCheng1994]</a></td><td>R.J.R. Abel and Y.W. Cheng,
Some new MOLS of order 2np for p a prime power,
The Australasian Journal of Combinatorics, vol 10 (1994)</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.orthogonal_arrays.OA_relabel">
<code class="descclassname">sage.combinat.designs.orthogonal_arrays.</code><code class="descname">OA_relabel</code><span class="sig-paren">(</span><em>OA</em>, <em>k</em>, <em>n</em>, <em>blocks=()</em>, <em>matrix=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays.OA_relabel" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a relabelled version of the OA.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">OA</span></code> – an OA, or rather a list of blocks of length <span class="math notranslate nohighlight">\(k\)</span>, each
of which contains integers from <span class="math notranslate nohighlight">\(0\)</span> to <span class="math notranslate nohighlight">\(n-1\)</span>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">k,n</span></code> (integers)</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">blocks</span></code> (list of blocks) – relabels the integers of the OA
from <span class="math notranslate nohighlight">\([0..n-1]\)</span> into <span class="math notranslate nohighlight">\([0..n-1]\)</span> in such a way that the <span class="math notranslate nohighlight">\(i\)</span>
blocks from <code class="docutils literal notranslate"><span class="pre">block</span></code> are respectively relabeled as
<code class="docutils literal notranslate"><span class="pre">[n-i,...,n-i]</span></code>, …, <code class="docutils literal notranslate"><span class="pre">[n-1,...,n-1]</span></code>. Thus, the blocks from
this list are expected to have disjoint values for each
coordinate.</p>
<p>If set to the empty list (default) no such relabelling is
performed.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">matrix</span></code> – a matrix of dimensions <span class="math notranslate nohighlight">\(k,n\)</span> such that if the i th
coordinate of a block is <span class="math notranslate nohighlight">\(x\)</span>, this <span class="math notranslate nohighlight">\(x\)</span> will be relabelled with
<code class="docutils literal notranslate"><span class="pre">matrix[i][x]</span></code>. This is not necessarily an integer between <span class="math notranslate nohighlight">\(0\)</span>
and <span class="math notranslate nohighlight">\(n-1\)</span>, and it is not necessarily an integer either. This is
performed <em>after</em> the previous relabelling.</p>
<p>If set to <code class="docutils literal notranslate"><span class="pre">None</span></code> (default) no such relabelling is performed.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A <code class="docutils literal notranslate"><span class="pre">None</span></code> coordinate in one block remains a <code class="docutils literal notranslate"><span class="pre">None</span></code>
coordinate in the final block.</p>
</div>
</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.orthogonal_arrays</span> <span class="kn">import</span> <span class="n">OA_relabel</span>
<span class="gp">sage: </span><span class="n">OA</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">OA_relabel</span><span class="p">(</span><span class="n">OA</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">matrix</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="s2">&quot;B&quot;</span><span class="p">],[</span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="s2">&quot;D&quot;</span><span class="p">],[</span><span class="s2">&quot;E&quot;</span><span class="p">,</span><span class="s2">&quot;F&quot;</span><span class="p">]])</span>
<span class="go">[[&#39;A&#39;, &#39;C&#39;, &#39;E&#39;], [&#39;A&#39;, &#39;D&#39;, &#39;F&#39;], [&#39;B&#39;, &#39;C&#39;, &#39;F&#39;], [&#39;B&#39;, &#39;D&#39;, &#39;E&#39;]]</span>

<span class="gp">sage: </span><span class="n">TD</span> <span class="o">=</span> <span class="n">OA_relabel</span><span class="p">(</span><span class="n">OA</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">matrix</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]]);</span> <span class="n">TD</span>
<span class="go">[[0, 2, 4], [0, 3, 5], [1, 2, 5], [1, 3, 4]]</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.orthogonal_arrays</span> <span class="kn">import</span> <span class="n">is_transversal_design</span>
<span class="gp">sage: </span><span class="n">is_transversal_design</span><span class="p">(</span><span class="n">TD</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Making sure that <code class="docutils literal notranslate"><span class="pre">[2,2,2,2]</span></code> is a block of <span class="math notranslate nohighlight">\(OA(4,3)\)</span>. We do this
by relabelling block <code class="docutils literal notranslate"><span class="pre">[0,0,0,0]</span></code> which belongs to the design:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[[0, 0, 0, 0], [0, 1, 2, 1], [0, 2, 1, 2], [1, 0, 2, 2], [1, 1, 1, 0], [1, 2, 0, 1], [2, 0, 1, 1], [2, 1, 0, 2], [2, 2, 2, 0]]</span>
<span class="gp">sage: </span><span class="n">OA_relabel</span><span class="p">(</span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">blocks</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="go">[[2, 2, 2, 2], [2, 0, 1, 0], [2, 1, 0, 1], [0, 2, 1, 1], [0, 0, 0, 2], [0, 1, 2, 0], [1, 2, 0, 0], [1, 0, 2, 1], [1, 1, 1, 2]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.orthogonal_arrays.QDM_from_Vmt">
<code class="descclassname">sage.combinat.designs.orthogonal_arrays.</code><code class="descname">QDM_from_Vmt</code><span class="sig-paren">(</span><em>m</em>, <em>t</em>, <em>V</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays.QDM_from_Vmt" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a QDM from a <span class="math notranslate nohighlight">\(V(m,t)\)</span></p>
<p><strong>Definition</strong></p>
<p>Let <span class="math notranslate nohighlight">\(q\)</span> be a prime power and let <span class="math notranslate nohighlight">\(q=mt+1\)</span> for <span class="math notranslate nohighlight">\(m,t\)</span> integers. Let <span class="math notranslate nohighlight">\(\omega\)</span>
be a primitive element of <span class="math notranslate nohighlight">\(\mathbb{F}_q\)</span>. A <span class="math notranslate nohighlight">\(V(m,t)\)</span> vector is a vector
<span class="math notranslate nohighlight">\((a_1,\dots,a_{m+1}\)</span> for which, for each <span class="math notranslate nohighlight">\(1\leq k &lt; m\)</span>, the differences</p>
<div class="math notranslate nohighlight">
\[\{a_{i+k}-a_i:1\leq i \leq m+1,i+k\neq m+2\}\]</div>
<p>represent the <span class="math notranslate nohighlight">\(m\)</span> cyclotomic classes of <span class="math notranslate nohighlight">\(\mathbb{F}_{mt+1}\)</span> (compute subscripts
modulo <span class="math notranslate nohighlight">\(m+2\)</span>). In other words, for fixed <span class="math notranslate nohighlight">\(k\)</span>, is
<span class="math notranslate nohighlight">\(a_{i+k}-a_i=\omega^{mx+\alpha}\)</span> and <span class="math notranslate nohighlight">\(a_{j+k}-a_j=\omega^{my+\beta}\)</span> then
<span class="math notranslate nohighlight">\(\alpha\not\equiv\beta \mod{m}\)</span></p>
<p><em>Construction of a quasi-difference matrix from a `V(m,t)` vector</em></p>
<p>Starting with a <span class="math notranslate nohighlight">\(V(m,t)\)</span> vector <span class="math notranslate nohighlight">\((a_1,\dots,a_{m+1})\)</span>, form a single row of
length <span class="math notranslate nohighlight">\(m+2\)</span> whose first entry is empty, and whose remaining entries are
<span class="math notranslate nohighlight">\((a_1,\dots,a_{m+1})\)</span>. Form <span class="math notranslate nohighlight">\(t\)</span> rows by multiplying this row by the <span class="math notranslate nohighlight">\(t\)</span> th
roots, i.e. the powers of <span class="math notranslate nohighlight">\(\omega^m\)</span>. From each of these <span class="math notranslate nohighlight">\(t\)</span> rows, form
<span class="math notranslate nohighlight">\(m+2\)</span> rows by taking the <span class="math notranslate nohighlight">\(m+2\)</span> cyclic shifts of the row. The result is a
<span class="math notranslate nohighlight">\((a,m+2;1,0;t)-QDM\)</span>.</p>
<p>For more information, refer to the Handbook of Combinatorial Designs
<a class="reference internal" href="database.html#designhandbook" id="id6">[DesignHandbook]</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">m,t</span></code> (integers)</li>
<li><code class="docutils literal notranslate"><span class="pre">V</span></code> – the vector <span class="math notranslate nohighlight">\(V(m,t)\)</span>.</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays.OA_from_quasi_difference_matrix" title="sage.combinat.designs.orthogonal_arrays.OA_from_quasi_difference_matrix"><code class="xref py py-func docutils literal notranslate"><span class="pre">OA_from_quasi_difference_matrix()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">_</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">46</span><span class="p">)</span> <span class="c1"># indirect doctest</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.orthogonal_arrays.TD_product">
<code class="descclassname">sage.combinat.designs.orthogonal_arrays.</code><code class="descname">TD_product</code><span class="sig-paren">(</span><em>k</em>, <em>TD1</em>, <em>n1</em>, <em>TD2</em>, <em>n2</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays.TD_product" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the product of two transversal designs.</p>
<p>From a transversal design <span class="math notranslate nohighlight">\(TD_1\)</span> of parameters <span class="math notranslate nohighlight">\(k,n_1\)</span> and a transversal
design <span class="math notranslate nohighlight">\(TD_2\)</span> of parameters <span class="math notranslate nohighlight">\(k,n_2\)</span>, this function returns a transversal
design of parameters <span class="math notranslate nohighlight">\(k,n\)</span> where <span class="math notranslate nohighlight">\(n=n_1\times n_2\)</span>.</p>
<p>Formally, if the groups of <span class="math notranslate nohighlight">\(TD_1\)</span> are <span class="math notranslate nohighlight">\(V^1_1,\dots,V^1_k\)</span> and the groups of
<span class="math notranslate nohighlight">\(TD_2\)</span> are <span class="math notranslate nohighlight">\(V^2_1,\dots,V^2_k\)</span>, the groups of the product design are
<span class="math notranslate nohighlight">\(V^1_1\times V^2_1,\dots,V^1_k\times V^2_k\)</span> and its blocks are the
<span class="math notranslate nohighlight">\(\{(x^1_1,x^2_1),\dots,(x^1_k,x^2_k)\}\)</span> where <span class="math notranslate nohighlight">\(\{x^1_1,\dots,x^1_k\}\)</span> is a
block of <span class="math notranslate nohighlight">\(TD_1\)</span> and <span class="math notranslate nohighlight">\(\{x^2_1,\dots,x^2_k\}\)</span> is a block of <span class="math notranslate nohighlight">\(TD_2\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">TD1,</span> <span class="pre">TD2</span></code> – transversal designs.</li>
<li><code class="docutils literal notranslate"><span class="pre">k,n1,n2</span></code> (integers) – see above.</li>
<li><code class="docutils literal notranslate"><span class="pre">check</span></code> (boolean) – Whether to check that output is correct before
returning it. As this is expected to be useless (but we are cautious
guys), you may want to disable it whenever you want speed. Set to <code class="docutils literal notranslate"><span class="pre">True</span></code>
by default.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This function uses transversal designs with
<span class="math notranslate nohighlight">\(V_1=\{0,\dots,n-1\},\dots,V_k=\{(k-1)n,\dots,kn-1\}\)</span> both as input and
output.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.orthogonal_arrays</span> <span class="kn">import</span> <span class="n">TD_product</span>
<span class="gp">sage: </span><span class="n">TD1</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">transversal_design</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">TD2</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">transversal_design</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">TD6_84</span> <span class="o">=</span> <span class="n">TD_product</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="n">TD1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="n">TD2</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.combinat.designs.orthogonal_arrays.TransversalDesign">
<em class="property">class </em><code class="descclassname">sage.combinat.designs.orthogonal_arrays.</code><code class="descname">TransversalDesign</code><span class="sig-paren">(</span><em>blocks</em>, <em>k=None</em>, <em>n=None</em>, <em>check=True</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays.TransversalDesign" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="group_divisible_designs.html#sage.combinat.designs.group_divisible_designs.GroupDivisibleDesign" title="sage.combinat.designs.group_divisible_designs.GroupDivisibleDesign"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.combinat.designs.group_divisible_designs.GroupDivisibleDesign</span></code></a></p>
<p>Class for Transversal Designs</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">blocks</span></code> – collection of blocks</li>
<li><code class="docutils literal notranslate"><span class="pre">k,n</span></code> (integers) – parameters of the transversal design. They can be
set to <code class="docutils literal notranslate"><span class="pre">None</span></code> (default) in which case their value is determined by the
blocks.</li>
<li><code class="docutils literal notranslate"><span class="pre">check</span></code> (boolean) – whether to check that the design is indeed a
transversal design with the right parameters. Set to <code class="docutils literal notranslate"><span class="pre">True</span></code> by default.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">transversal_design</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Transversal Design TD(6,5)</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">transversal_design</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span>
<span class="go">Transversal Design TD(6,30)</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">transversal_design</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span><span class="mi">36</span><span class="p">)</span>
<span class="go">Transversal Design TD(10,36)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.orthogonal_arrays.incomplete_orthogonal_array">
<code class="descclassname">sage.combinat.designs.orthogonal_arrays.</code><code class="descname">incomplete_orthogonal_array</code><span class="sig-paren">(</span><em>k</em>, <em>n</em>, <em>holes</em>, <em>resolvable=False</em>, <em>existence=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays.incomplete_orthogonal_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an <span class="math notranslate nohighlight">\(OA(k,n)-\sum_{1\leq i\leq x} OA(k,s_i)\)</span>.</p>
<p>An <span class="math notranslate nohighlight">\(OA(k,n)-\sum_{1\leq i\leq x} OA(k,s_i)\)</span> is an orthogonal array from
which have been removed disjoint <span class="math notranslate nohighlight">\(OA(k,s_1),...,OA(k,s_x)\)</span>. If there exist
<span class="math notranslate nohighlight">\(OA(k,s_1),...,OA(k,s_x)\)</span> they can be used to fill the holes and give rise
to an <span class="math notranslate nohighlight">\(OA(k,n)\)</span>.</p>
<p>A very useful particular case (see e.g. the Wilson construction in
<a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays.wilson_construction" title="sage.combinat.designs.orthogonal_arrays.wilson_construction"><code class="xref py py-func docutils literal notranslate"><span class="pre">wilson_construction()</span></code></a>) is when all <span class="math notranslate nohighlight">\(s_i=1\)</span>. In that case the
incomplete design is a <span class="math notranslate nohighlight">\(OA(k,n)-x.OA(k,1)\)</span>. Such design is equivalent to
transversal design <span class="math notranslate nohighlight">\(TD(k,n)\)</span> from which has been removed <span class="math notranslate nohighlight">\(x\)</span> disjoint
blocks.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">k,n</span></code> (integers)</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">holes</span></code> (list of integers) – respective sizes of the holes to be found.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">resolvable</span></code> (boolean) – set to <code class="docutils literal notranslate"><span class="pre">True</span></code> if you want the design to be
resolvable. The classes of the resolvable design are obtained as the first
<span class="math notranslate nohighlight">\(n\)</span> blocks, then the next <span class="math notranslate nohighlight">\(n\)</span> blocks, etc … Set to <code class="docutils literal notranslate"><span class="pre">False</span></code> by default.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">existence</span></code> (boolean) – instead of building the design, return:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">True</span></code> – meaning that Sage knows how to build the design</li>
<li><code class="docutils literal notranslate"><span class="pre">Unknown</span></code> – meaning that Sage does not know how to build the
design, but that the design may exist (see <a class="reference external" href="../../../../misc/sage/misc/unknown.html#module-sage.misc.unknown" title="(in Sage Reference Manual: Utilities v8.3)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.misc.unknown</span></code></a>).</li>
<li><code class="docutils literal notranslate"><span class="pre">False</span></code> – meaning that the design does not exist.</li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>By convention, the ground set is always <span class="math notranslate nohighlight">\(V = \{0, ..., n-1\}\)</span>.</p>
<p>If all holes have size 1, in the incomplete orthogonal array returned by
this function the holes are <span class="math notranslate nohighlight">\(\{n-1, ..., n-s_1\}^k\)</span>,
<span class="math notranslate nohighlight">\(\{n-s_1-1,...,n-s_1-s_2\}^k\)</span>, etc.</p>
<p class="last">More generally, if <code class="docutils literal notranslate"><span class="pre">holes</span></code> is equal to <span class="math notranslate nohighlight">\(u1,...,uk\)</span>, the <span class="math notranslate nohighlight">\(i\)</span>-th hole is
the set of points <span class="math notranslate nohighlight">\(\{n-\sum_{j\geq i}u_j,...,n-\sum_{j\geq i+1}u_j\}^k\)</span>.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays.OA_find_disjoint_blocks" title="sage.combinat.designs.orthogonal_arrays.OA_find_disjoint_blocks"><code class="xref py py-func docutils literal notranslate"><span class="pre">OA_find_disjoint_blocks()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">IOA</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">incomplete_orthogonal_array</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">IOA</span>
<span class="go">[[0, 1, 2], [0, 2, 1], [1, 0, 2], [1, 2, 0], [2, 0, 1], [2, 1, 0]]</span>
<span class="gp">sage: </span><span class="n">missing_blocks</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.orthogonal_arrays</span> <span class="kn">import</span> <span class="n">is_orthogonal_array</span>
<span class="gp">sage: </span><span class="n">is_orthogonal_array</span><span class="p">(</span><span class="n">IOA</span> <span class="o">+</span> <span class="n">missing_blocks</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="bvr82" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id9">[BvR82]</a></td><td>More mutually orthogonal Latin squares,
Andries Brouwer and John van Rees
Discrete Mathematics
vol.39, num.3, pages 263-281
1982
<a class="reference external" href="http://oai.cwi.nl/oai/asset/304/0304A.pdf">http://oai.cwi.nl/oai/asset/304/0304A.pdf</a></td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.orthogonal_arrays.is_transversal_design">
<code class="descclassname">sage.combinat.designs.orthogonal_arrays.</code><code class="descname">is_transversal_design</code><span class="sig-paren">(</span><em>B</em>, <em>k</em>, <em>n</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays.is_transversal_design" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that a given set of blocks <code class="docutils literal notranslate"><span class="pre">B</span></code> is a transversal design.</p>
<p>See <a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays.transversal_design" title="sage.combinat.designs.orthogonal_arrays.transversal_design"><code class="xref py py-func docutils literal notranslate"><span class="pre">transversal_design()</span></code></a>
for a definition.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">B</span></code> – the list of blocks</li>
<li><code class="docutils literal notranslate"><span class="pre">k,</span> <span class="pre">n</span></code> – integers</li>
<li><code class="docutils literal notranslate"><span class="pre">verbose</span></code> (boolean) – whether to display information about what is
going wrong.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The transversal design must have <span class="math notranslate nohighlight">\(\{0, \ldots, kn-1\}\)</span> as a ground set,
partitioned as <span class="math notranslate nohighlight">\(k\)</span> sets of size <span class="math notranslate nohighlight">\(n\)</span>: <span class="math notranslate nohighlight">\(\{0, \ldots, k-1\} \sqcup
\{k, \ldots, 2k-1\} \sqcup \cdots \sqcup \{k(n-1), \ldots, kn-1\}\)</span>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">TD</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">transversal_design</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c1"># indirect doctest</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.orthogonal_arrays</span> <span class="kn">import</span> <span class="n">is_transversal_design</span>
<span class="gp">sage: </span><span class="n">is_transversal_design</span><span class="p">(</span><span class="n">TD</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_transversal_design</span><span class="p">(</span><span class="n">TD</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.orthogonal_arrays.largest_available_k">
<code class="descclassname">sage.combinat.designs.orthogonal_arrays.</code><code class="descname">largest_available_k</code><span class="sig-paren">(</span><em>n</em>, <em>t=2</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays.largest_available_k" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the largest <span class="math notranslate nohighlight">\(k\)</span> such that Sage can build an <span class="math notranslate nohighlight">\(OA(k,n)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">n</span></code> (integer)</li>
<li><code class="docutils literal notranslate"><span class="pre">t</span></code> – (integer; default: 2) – strength of the array</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">largest_available_k</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">largest_available_k</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">largest_available_k</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">largest_available_k</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span>
<span class="go">28</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">largest_available_k</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">largest_available_k</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">n(=-1) was expected to be &gt;=0</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.orthogonal_arrays.orthogonal_array">
<code class="descclassname">sage.combinat.designs.orthogonal_arrays.</code><code class="descname">orthogonal_array</code><span class="sig-paren">(</span><em>k</em>, <em>n</em>, <em>t=2</em>, <em>resolvable=False</em>, <em>check=True</em>, <em>existence=False</em>, <em>explain_construction=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays.orthogonal_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an orthogonal array of parameters <span class="math notranslate nohighlight">\(k,n,t\)</span>.</p>
<p>An orthogonal array of parameters <span class="math notranslate nohighlight">\(k,n,t\)</span> is a matrix with <span class="math notranslate nohighlight">\(k\)</span> columns
filled with integers from <span class="math notranslate nohighlight">\([n]\)</span> in such a way that for any <span class="math notranslate nohighlight">\(t\)</span> columns, each
of the <span class="math notranslate nohighlight">\(n^t\)</span> possible rows occurs exactly once. In
particular, the matrix has <span class="math notranslate nohighlight">\(n^t\)</span> rows.</p>
<p>More general definitions sometimes involve a <span class="math notranslate nohighlight">\(\lambda\)</span> parameter, and we
assume here that <span class="math notranslate nohighlight">\(\lambda=1\)</span>.</p>
<p>An orthogonal array is said to be <em>resolvable</em> if it corresponds to a
resolvable transversal design (see
<a class="reference internal" href="incidence_structures.html#sage.combinat.designs.incidence_structures.IncidenceStructure.is_resolvable" title="sage.combinat.designs.incidence_structures.IncidenceStructure.is_resolvable"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.combinat.designs.incidence_structures.IncidenceStructure.is_resolvable()</span></code></a>).</p>
<p>For more information on orthogonal arrays, see
<a class="reference external" href="https://en.wikipedia.org/wiki/Orthogonal_array">Wikipedia article Orthogonal_array</a>.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">k</span></code> – (integer) number of columns. If <code class="docutils literal notranslate"><span class="pre">k=None</span></code> it is set to the
largest value available.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">n</span></code> – (integer) number of symbols</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">t</span></code> – (integer; default: 2) – strength of the array</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">resolvable</span></code> (boolean) – set to <code class="docutils literal notranslate"><span class="pre">True</span></code> if you want the design to be
resolvable. The <span class="math notranslate nohighlight">\(n\)</span> classes of the resolvable design are obtained as the
first <span class="math notranslate nohighlight">\(n\)</span> blocks, then the next <span class="math notranslate nohighlight">\(n\)</span> blocks, etc … Set to <code class="docutils literal notranslate"><span class="pre">False</span></code> by
default.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">check</span></code> – (boolean) Whether to check that output is correct before
returning it. As this is expected to be useless (but we are cautious
guys), you may want to disable it whenever you want speed. Set to
<code class="docutils literal notranslate"><span class="pre">True</span></code> by default.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">existence</span></code> (boolean) – instead of building the design, return:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">True</span></code> – meaning that Sage knows how to build the design</li>
<li><code class="docutils literal notranslate"><span class="pre">Unknown</span></code> – meaning that Sage does not know how to build the
design, but that the design may exist (see <a class="reference external" href="../../../../misc/sage/misc/unknown.html#module-sage.misc.unknown" title="(in Sage Reference Manual: Utilities v8.3)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.misc.unknown</span></code></a>).</li>
<li><code class="docutils literal notranslate"><span class="pre">False</span></code> – meaning that the design does not exist.</li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When <code class="docutils literal notranslate"><span class="pre">k=None</span></code> and <code class="docutils literal notranslate"><span class="pre">existence=True</span></code> the function returns an
integer, i.e. the largest <span class="math notranslate nohighlight">\(k\)</span> such that we can build a <span class="math notranslate nohighlight">\(OA(k,n)\)</span>.</p>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">explain_construction</span></code> (boolean) – return a string describing
the construction.</p>
</li>
</ul>
<p>OUTPUT:</p>
<p>The kind of output depends on the input:</p>
<ul class="simple">
<li>if <code class="docutils literal notranslate"><span class="pre">existence=False</span></code> (the default) then the output is a list of lists
that represent an orthogonal array with parameters <code class="docutils literal notranslate"><span class="pre">k</span></code> and <code class="docutils literal notranslate"><span class="pre">n</span></code></li>
<li>if <code class="docutils literal notranslate"><span class="pre">existence=True</span></code> and <code class="docutils literal notranslate"><span class="pre">k</span></code> is an integer, then the function returns a
troolean: either <code class="docutils literal notranslate"><span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">Unknown</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code></li>
<li>if <code class="docutils literal notranslate"><span class="pre">existence=True</span></code> and <code class="docutils literal notranslate"><span class="pre">k=None</span></code> then the output is the largest value
of <code class="docutils literal notranslate"><span class="pre">k</span></code> for which Sage knows how to compute a <span class="math notranslate nohighlight">\(TD(k,n)\)</span>.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method implements theorems from <a class="reference internal" href="latin_squares.html#stinson2004" id="id7">[Stinson2004]</a>. See the code’s
documentation for details.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">When <span class="math notranslate nohighlight">\(t=2\)</span> an orthogonal array is also a transversal design (see
<a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays.transversal_design" title="sage.combinat.designs.orthogonal_arrays.transversal_design"><code class="xref py py-func docutils literal notranslate"><span class="pre">transversal_design()</span></code></a>) and a family of mutually orthogonal latin
squares (see
<a class="reference internal" href="latin_squares.html#sage.combinat.designs.latin_squares.mutually_orthogonal_latin_squares" title="sage.combinat.designs.latin_squares.mutually_orthogonal_latin_squares"><code class="xref py py-func docutils literal notranslate"><span class="pre">mutually_orthogonal_latin_squares()</span></code></a>).</p>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.orthogonal_arrays.transversal_design">
<code class="descclassname">sage.combinat.designs.orthogonal_arrays.</code><code class="descname">transversal_design</code><span class="sig-paren">(</span><em>k</em>, <em>n</em>, <em>resolvable=False</em>, <em>check=True</em>, <em>existence=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays.transversal_design" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a transversal design of parameters <span class="math notranslate nohighlight">\(k,n\)</span>.</p>
<p>A transversal design of parameters <span class="math notranslate nohighlight">\(k, n\)</span> is a collection <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> of
subsets of <span class="math notranslate nohighlight">\(V = V_1 \cup \cdots \cup V_k\)</span> (where the <em>groups</em> <span class="math notranslate nohighlight">\(V_i\)</span> are
disjoint and have cardinality <span class="math notranslate nohighlight">\(n\)</span>) such that:</p>
<ul class="simple">
<li>Any <span class="math notranslate nohighlight">\(S \in \mathcal{S}\)</span> has cardinality <span class="math notranslate nohighlight">\(k\)</span> and intersects each group on
exactly one element.</li>
<li>Any two elements from distincts groups are contained in exactly one
element of <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>.</li>
</ul>
<p>More general definitions sometimes involve a <span class="math notranslate nohighlight">\(\lambda\)</span> parameter, and we
assume here that <span class="math notranslate nohighlight">\(\lambda=1\)</span>.</p>
<p>For more information on transversal designs, see
<a class="reference external" href="http://mathworld.wolfram.com/TransversalDesign.html">http://mathworld.wolfram.com/TransversalDesign.html</a>.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><span class="math notranslate nohighlight">\(n,k\)</span> – integers. If <code class="docutils literal notranslate"><span class="pre">k</span> <span class="pre">is</span> <span class="pre">None</span></code> it is set to the largest value
available.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">resolvable</span></code> (boolean) – set to <code class="docutils literal notranslate"><span class="pre">True</span></code> if you want the design to be
resolvable (see
<a class="reference internal" href="incidence_structures.html#sage.combinat.designs.incidence_structures.IncidenceStructure.is_resolvable" title="sage.combinat.designs.incidence_structures.IncidenceStructure.is_resolvable"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.combinat.designs.incidence_structures.IncidenceStructure.is_resolvable()</span></code></a>). The
<span class="math notranslate nohighlight">\(n\)</span> classes of the resolvable design are obtained as the first <span class="math notranslate nohighlight">\(n\)</span> blocks,
then the next <span class="math notranslate nohighlight">\(n\)</span> blocks, etc … Set to <code class="docutils literal notranslate"><span class="pre">False</span></code> by default.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">check</span></code> – (boolean) Whether to check that output is correct before
returning it. As this is expected to be useless (but we are cautious
guys), you may want to disable it whenever you want speed. Set to
<code class="docutils literal notranslate"><span class="pre">True</span></code> by default.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">existence</span></code> (boolean) – instead of building the design, return:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">True</span></code> – meaning that Sage knows how to build the design</li>
<li><code class="docutils literal notranslate"><span class="pre">Unknown</span></code> – meaning that Sage does not know how to build the
design, but that the design may exist (see <a class="reference external" href="../../../../misc/sage/misc/unknown.html#module-sage.misc.unknown" title="(in Sage Reference Manual: Utilities v8.3)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.misc.unknown</span></code></a>).</li>
<li><code class="docutils literal notranslate"><span class="pre">False</span></code> – meaning that the design does not exist.</li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When <code class="docutils literal notranslate"><span class="pre">k=None</span></code> and <code class="docutils literal notranslate"><span class="pre">existence=True</span></code> the function returns an
integer, i.e. the largest <span class="math notranslate nohighlight">\(k\)</span> such that we can build a <span class="math notranslate nohighlight">\(TD(k,n)\)</span>.</p>
</div>
</li>
</ul>
<p>OUTPUT:</p>
<p>The kind of output depends on the input:</p>
<ul class="simple">
<li>if <code class="docutils literal notranslate"><span class="pre">existence=False</span></code> (the default) then the output is a list of lists
that represent a <span class="math notranslate nohighlight">\(TD(k,n)\)</span> with
<span class="math notranslate nohighlight">\(V_1=\{0,\dots,n-1\},\dots,V_k=\{(k-1)n,\dots,kn-1\}\)</span></li>
<li>if <code class="docutils literal notranslate"><span class="pre">existence=True</span></code> and <code class="docutils literal notranslate"><span class="pre">k</span></code> is an integer, then the function returns a
troolean: either <code class="docutils literal notranslate"><span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">Unknown</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code></li>
<li>if <code class="docutils literal notranslate"><span class="pre">existence=True</span></code> and <code class="docutils literal notranslate"><span class="pre">k=None</span></code> then the output is the largest value
of <code class="docutils literal notranslate"><span class="pre">k</span></code> for which Sage knows how to compute a <span class="math notranslate nohighlight">\(TD(k,n)\)</span>.</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.combinat.designs.orthogonal_arrays.orthogonal_array" title="sage.combinat.designs.orthogonal_arrays.orthogonal_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">orthogonal_array()</span></code></a> – a transversal design <span class="math notranslate nohighlight">\(TD(k,n)\)</span> is equivalent to an
orthogonal array <span class="math notranslate nohighlight">\(OA(k,n,2)\)</span>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">TD</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">transversal_design</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span> <span class="n">TD</span>
<span class="go">Transversal Design TD(5,5)</span>
<span class="gp">sage: </span><span class="n">TD</span><span class="o">.</span><span class="n">blocks</span><span class="p">()</span>
<span class="go">[[0, 5, 10, 15, 20], [0, 6, 12, 18, 24], [0, 7, 14, 16, 23],</span>
<span class="go"> [0, 8, 11, 19, 22], [0, 9, 13, 17, 21], [1, 5, 14, 18, 22],</span>
<span class="go"> [1, 6, 11, 16, 21], [1, 7, 13, 19, 20], [1, 8, 10, 17, 24],</span>
<span class="go"> [1, 9, 12, 15, 23], [2, 5, 13, 16, 24], [2, 6, 10, 19, 23],</span>
<span class="go"> [2, 7, 12, 17, 22], [2, 8, 14, 15, 21], [2, 9, 11, 18, 20],</span>
<span class="go"> [3, 5, 12, 19, 21], [3, 6, 14, 17, 20], [3, 7, 11, 15, 24],</span>
<span class="go"> [3, 8, 13, 18, 23], [3, 9, 10, 16, 22], [4, 5, 11, 17, 23],</span>
<span class="go"> [4, 6, 13, 15, 22], [4, 7, 10, 18, 21], [4, 8, 12, 16, 20],</span>
<span class="go"> [4, 9, 14, 19, 24]]</span>
</pre></div>
</div>
<p>Some examples of the maximal number of transversal Sage is able to build:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">TD_4_10</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">transversal_design</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">transversal_design</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Unknown</span>
</pre></div>
</div>
<p>For prime powers, there is an explicit construction which gives a
<span class="math notranslate nohighlight">\(TD(n+1,n)\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">transversal_design</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">transversal_design</span><span class="p">(</span><span class="mi">674</span><span class="p">,</span> <span class="mi">673</span><span class="p">,</span> <span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>For other values of <code class="docutils literal notranslate"><span class="pre">n</span></code> it depends:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">transversal_design</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">transversal_design</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Unknown</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">transversal_design</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">transversal_design</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">transversal_design</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">transversal_design</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Unknown</span>

<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">transversal_design</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Unknown</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">transversal_design</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">transversal_design</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">transversal_design</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Unknown</span>

<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">transversal_design</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">existence</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">transversal_design</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">existence</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">Unknown</span>
</pre></div>
</div>
<p>If you ask for a transversal design that Sage is not able to build then an
<code class="docutils literal notranslate"><span class="pre">EmptySetError</span></code> or a <code class="docutils literal notranslate"><span class="pre">NotImplementedError</span></code> is raised:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">transversal_design</span><span class="p">(</span><span class="mi">47</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">I don&#39;t know how to build a TD(47,100)!</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">transversal_design</span><span class="p">(</span><span class="mi">55</span><span class="p">,</span> <span class="mi">54</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">EmptySetError</span>: <span class="n">There exists no TD(55,54)!</span>
</pre></div>
</div>
<p>Those two errors correspond respectively to the cases where Sage answer
<code class="docutils literal notranslate"><span class="pre">Unknown</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code> when the parameter <code class="docutils literal notranslate"><span class="pre">existence</span></code> is set to
<code class="docutils literal notranslate"><span class="pre">True</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">transversal_design</span><span class="p">(</span><span class="mi">47</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Unknown</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">transversal_design</span><span class="p">(</span><span class="mi">55</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>If for a given <span class="math notranslate nohighlight">\(n\)</span> you want to know the largest <span class="math notranslate nohighlight">\(k\)</span> for which Sage is able
to build a <span class="math notranslate nohighlight">\(TD(k,n)\)</span> just call the function with <span class="math notranslate nohighlight">\(k\)</span> set to <code class="docutils literal notranslate"><span class="pre">None</span></code> and
<code class="docutils literal notranslate"><span class="pre">existence</span></code> set to <code class="docutils literal notranslate"><span class="pre">True</span></code> as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">transversal_design</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">transversal_design</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">transversal_design</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">designs</span><span class="o">.</span><span class="n">transversal_design</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">9</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.orthogonal_arrays.wilson_construction">
<code class="descclassname">sage.combinat.designs.orthogonal_arrays.</code><code class="descname">wilson_construction</code><span class="sig-paren">(</span><em>OA</em>, <em>k</em>, <em>r</em>, <em>m</em>, <em>u</em>, <em>check=True</em>, <em>explain_construction=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.orthogonal_arrays.wilson_construction" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <span class="math notranslate nohighlight">\(OA(k,rm+\sum_i u_i)\)</span> from a truncated <span class="math notranslate nohighlight">\(OA(k+s,r)\)</span> by Wilson’s
construction.</p>
<p><strong>Simple form:</strong></p>
<p>Let <span class="math notranslate nohighlight">\(OA\)</span> be a truncated <span class="math notranslate nohighlight">\(OA(k+s,r)\)</span> with <span class="math notranslate nohighlight">\(s\)</span> truncated columns of sizes
<span class="math notranslate nohighlight">\(u_1,...,u_s\)</span>, whose blocks have sizes in <span class="math notranslate nohighlight">\(\{k+b_1,...,k+b_t\}\)</span>. If there
exist:</p>
<ul class="simple">
<li>An <span class="math notranslate nohighlight">\(OA(k,m+b_i) - b_i.OA(k,1)\)</span> for every <span class="math notranslate nohighlight">\(1\leq i\leq t\)</span></li>
<li>An <span class="math notranslate nohighlight">\(OA(k,u_i)\)</span> for every <span class="math notranslate nohighlight">\(1\leq i\leq s\)</span></li>
</ul>
<p>Then there exists an <span class="math notranslate nohighlight">\(OA(k,rm+\sum u_i)\)</span>. The construction is a
generalization of Lemma 3.16 in <a class="reference internal" href="#hananibibd" id="id8">[HananiBIBD]</a>.</p>
<p><strong>Brouwer-Van Rees form:</strong></p>
<p>Let <span class="math notranslate nohighlight">\(OA\)</span> be a truncated <span class="math notranslate nohighlight">\(OA(k+s,r)\)</span> with <span class="math notranslate nohighlight">\(s\)</span> truncated columns of sizes
<span class="math notranslate nohighlight">\(u_1,...,u_s\)</span>. Let the set <span class="math notranslate nohighlight">\(H_i\)</span> of the <span class="math notranslate nohighlight">\(u_i\)</span> points of column <span class="math notranslate nohighlight">\(k+i\)</span> be
partitionned into <span class="math notranslate nohighlight">\(\sum_j H_{ij}\)</span>. Let <span class="math notranslate nohighlight">\(m_{ij}\)</span> be integers
such that:</p>
<ul class="simple">
<li>For <span class="math notranslate nohighlight">\(0\leq i &lt;l\)</span> there exists an <span class="math notranslate nohighlight">\(OA(k,\sum_j m_{ij}|H_{ij}|)\)</span></li>
<li>For any block <span class="math notranslate nohighlight">\(B\in OA\)</span> intersecting the sets <span class="math notranslate nohighlight">\(H_{ij(i)}\)</span> there exists an
<span class="math notranslate nohighlight">\(OA(k,m+\sum_i m_{ij})-\sum_i OA(k,m_{ij(j)})\)</span>.</li>
</ul>
<p>Then there exists an <span class="math notranslate nohighlight">\(OA(k,rm+\sum_{i,j}m_{ij})\)</span>. This construction appears
in <a class="reference internal" href="#bvr82" id="id9">[BvR82]</a>.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">OA</span></code> – an incomplete orthogonal array with <span class="math notranslate nohighlight">\(k+s\)</span> columns. The elements
of a column of size <span class="math notranslate nohighlight">\(c\)</span> must belong to <span class="math notranslate nohighlight">\(\{0,...,c\}\)</span>. The missing entries
of a block are represented by <code class="docutils literal notranslate"><span class="pre">None</span></code> values. If <code class="docutils literal notranslate"><span class="pre">OA=None</span></code>, it is
defined as a truncated orthogonal arrays with <span class="math notranslate nohighlight">\(k+s\)</span> columns.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">k,r,m</span></code> (integers)</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">u</span></code> (list) – two cases depending on the form to use:</p>
<blockquote>
<div><ul class="simple">
<li>Simple form: a list of length <span class="math notranslate nohighlight">\(s\)</span> such that column <code class="docutils literal notranslate"><span class="pre">k+i</span></code> has size
<code class="docutils literal notranslate"><span class="pre">u[i]</span></code>. The untruncated points of column <code class="docutils literal notranslate"><span class="pre">k+i</span></code> are assumed to be
<code class="docutils literal notranslate"><span class="pre">[0,...,u[i]-1]</span></code>.</li>
<li>Brouwer-Van Rees form: a list of length <span class="math notranslate nohighlight">\(s\)</span> such that <code class="docutils literal notranslate"><span class="pre">u[i]</span></code> is the
list of pairs <span class="math notranslate nohighlight">\((m_{i0},|H_{i0}|),...,(m_{ip_i},|H_{ip_i}|)\)</span>. The
untruncated points of column <code class="docutils literal notranslate"><span class="pre">k+i</span></code> are assumed to be <span class="math notranslate nohighlight">\([0,...,u_i-1]\)</span>
where <span class="math notranslate nohighlight">\(u_i=\sum_j |H_{ip_i}|\)</span>. Besides, the first <span class="math notranslate nohighlight">\(|H_{i0}|\)</span> points
represent <span class="math notranslate nohighlight">\(H_{i0}\)</span>, the next <span class="math notranslate nohighlight">\(|H_{i1}|\)</span> points represent <span class="math notranslate nohighlight">\(H_{i1}\)</span>,
etc…</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">explain_construction</span></code> (boolean) – return a string describing
the construction.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">check</span></code> (boolean) – whether to check that output is correct before
returning it. As this is expected to be useless (but we are cautious
guys), you may want to disable it whenever you want speed. Set to <code class="docutils literal notranslate"><span class="pre">True</span></code>
by default.</p>
</li>
</ul>
<p>REFERENCE:</p>
<table class="docutils citation" frame="void" id="hananibibd" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id8">[HananiBIBD]</a></td><td>Balanced incomplete block designs and related designs,
Haim Hanani,
Discrete Mathematics 11.3 (1975) pages 255-369.</td></tr>
</tbody>
</table>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.orthogonal_arrays</span> <span class="kn">import</span> <span class="n">wilson_construction</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.orthogonal_arrays</span> <span class="kn">import</span> <span class="n">OA_relabel</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.orthogonal_arrays_find_recursive</span> <span class="kn">import</span> <span class="n">find_wilson_decomposition_with_one_truncated_group</span>
<span class="gp">sage: </span><span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">):</span>
<span class="go">....:    for n in range(1,30):</span>
<span class="go">....:        if find_wilson_decomposition_with_one_truncated_group(k,n):</span>
<span class="go">....:            total += 1</span>
<span class="go">....:            f, args = find_wilson_decomposition_with_one_truncated_group(k,n)</span>
<span class="go">....:            _ = f(*args)</span>
<span class="gp">sage: </span><span class="n">total</span>
<span class="go">41</span>

<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">explain_construction</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">58</span><span class="p">))</span>
<span class="go">Wilson&#39;s construction n=8.7+1+1 with master design OA(7+2,8)</span>
<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">explain_construction</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">115</span><span class="p">))</span>
<span class="go">Wilson&#39;s construction n=13.8+11 with master design OA(9+1,13)</span>
<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">wilson_construction</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">21</span><span class="p">,[[(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)]],</span><span class="n">explain_construction</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="go">Brouwer-van Rees construction n=11.21+(5.5) with master design OA(5+1,11)</span>
<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">wilson_construction</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span><span class="mi">71</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">21</span><span class="p">,[[(</span><span class="mi">4</span><span class="p">,</span><span class="mi">9</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)],[(</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]],</span><span class="n">explain_construction</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="go">Brouwer-van Rees construction n=17.21+(9.4+1.1)+(9.9+1.1) with master design OA(71+2,17)</span>
</pre></div>
</div>
<p>An example using the Brouwer-van Rees generalization:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.orthogonal_arrays</span> <span class="kn">import</span> <span class="n">is_orthogonal_array</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.orthogonal_arrays</span> <span class="kn">import</span> <span class="n">wilson_construction</span>
<span class="gp">sage: </span><span class="n">OA</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">orthogonal_arrays</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">OA</span> <span class="o">=</span> <span class="p">[[</span><span class="n">x</span> <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span> <span class="ow">or</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">)</span> <span class="k">else</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">R</span><span class="p">)]</span> <span class="k">for</span> <span class="n">R</span> <span class="ow">in</span> <span class="n">OA</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">OAb</span> <span class="o">=</span> <span class="n">wilson_construction</span><span class="p">(</span><span class="n">OA</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">21</span><span class="p">,[[(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)]])</span>
<span class="gp">sage: </span><span class="n">is_orthogonal_array</span><span class="p">(</span><span class="n">OAb</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">256</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Orthogonal arrays (OA)</a><ul>
<li><a class="reference internal" href="#functions">Functions</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="latin_squares.html"
                        title="previous chapter">Mutually Orthogonal Latin Squares (MOLS)</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="orthogonal_arrays_build_recursive.html"
                        title="next chapter">Orthogonal arrays (build recursive constructions)</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/sage/combinat/designs/orthogonal_arrays.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="orthogonal_arrays_build_recursive.html" title="Orthogonal arrays (build recursive constructions)"
             >next</a> |</li>
        <li class="right" >
          <a href="latin_squares.html" title="Mutually Orthogonal Latin Squares (MOLS)"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Combinatorics</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../../module_list.html" >Comprehensive Module list</a> &#187;</li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2018, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>