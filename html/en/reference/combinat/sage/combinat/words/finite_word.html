
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Finite word &#8212; Sage 9.4 Reference Manual: Combinatorics</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sage.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script async="async" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Infinite word" href="infinite_word.html" />
    <link rel="prev" title="Alphabet" href="alphabet.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="infinite_word.html" title="Infinite word"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="alphabet.html" title="Alphabet"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Sage 9.4 Reference Manual: Combinatorics</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../../module_list.html" accesskey="U">Comprehensive Module list</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Finite word</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="finite-word">
<span id="sage-combinat-words-finite-word"></span><h1>Finite word<a class="headerlink" href="#finite-word" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.combinat.words.finite_word"></span><p>AUTHORS:</p>
<ul class="simple">
<li><p>Arnaud Bergeron</p></li>
<li><p>Amy Glen</p></li>
<li><p>Sébastien Labbé</p></li>
<li><p>Franco Saliola</p></li>
<li><p>Julien Leroy (March 2010): reduced_rauzy_graph</p></li>
</ul>
<p>EXAMPLES:</p>
<section id="creation-of-a-finite-word">
<h2>Creation of a finite word<a class="headerlink" href="#creation-of-a-finite-word" title="Permalink to this headline">¶</a></h2>
<p>Finite words from Python strings, lists and tuples:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s2">&quot;abbabaab&quot;</span><span class="p">)</span>
<span class="go">word: abbabaab</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="go">word: 01101001</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="p">)</span>
<span class="go">word: a057b98</span>
</pre></div>
</div>
<p>Finite words from functions:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">n</span> <span class="p">:</span> <span class="n">n</span><span class="o">%</span><span class="k">3</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="go">word: 0120120120120</span>
</pre></div>
</div>
<p>Finite words from iterators:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">count</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="n">count</span><span class="p">(),</span> <span class="n">length</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">word: 0123456789</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span> <span class="nb">iter</span><span class="p">(</span><span class="s1">&#39;abbccdef&#39;</span><span class="p">)</span> <span class="p">)</span>
<span class="go">word: abbccdef</span>
</pre></div>
</div>
<p>Finite words from words via concatenation:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s2">&quot;abcccabba&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">*</span> <span class="n">v</span>
<span class="go">word: abcccabba04883</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">*</span> <span class="n">u</span>
<span class="go">word: 04883abcccabba</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">+</span> <span class="n">v</span>
<span class="go">word: abcccabba04883</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">^</span><span class="mi">3</span> <span class="o">*</span> <span class="n">v</span><span class="o">^</span><span class="p">(</span><span class="mi">8</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
<span class="go">word: abcccabbaabcccabbaabcccabba04883048</span>
</pre></div>
</div>
<p>Finite words from infinite words:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">vv</span> <span class="o">=</span> <span class="n">v</span><span class="o">^</span><span class="n">Infinity</span>
<span class="gp">sage: </span><span class="n">vv</span><span class="p">[</span><span class="mi">10000</span><span class="p">:</span><span class="mi">10015</span><span class="p">]</span>
<span class="go">word: 048830488304883</span>
</pre></div>
</div>
<p>Finite words in a specific combinatorial class:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s2">&quot;ab&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">W</span>
<span class="go">Finite and infinite words over {&#39;a&#39;, &#39;b&#39;}</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s2">&quot;abbabaab&quot;</span><span class="p">)</span>
<span class="go">word: abbabaab</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">([</span><span class="s2">&quot;a&quot;</span><span class="p">,</span><span class="s2">&quot;b&quot;</span><span class="p">,</span><span class="s2">&quot;b&quot;</span><span class="p">,</span><span class="s2">&quot;a&quot;</span><span class="p">,</span><span class="s2">&quot;b&quot;</span><span class="p">,</span><span class="s2">&quot;a&quot;</span><span class="p">,</span><span class="s2">&quot;a&quot;</span><span class="p">,</span><span class="s2">&quot;b&quot;</span><span class="p">])</span>
<span class="go">word: abbabaab</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span> <span class="nb">iter</span><span class="p">(</span><span class="s1">&#39;ababab&#39;</span><span class="p">)</span> <span class="p">)</span>
<span class="go">word: ababab</span>
</pre></div>
</div>
<p>Finite word as the image under a morphism:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span><span class="mi">4</span><span class="p">:[</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">m</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">word: 4450</span>
<span class="gp">sage: </span><span class="n">m</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">word: 400040000554450</span>
<span class="gp">sage: </span><span class="n">m</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">word: 4000445044504450400044504450445044500550...</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following two finite words have the same string representation:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;010120&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span>
<span class="go">word: 010120</span>
<span class="gp">sage: </span><span class="n">z</span>
<span class="go">word: 010120</span>
</pre></div>
</div>
<p>but are not equal:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">==</span> <span class="n">z</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Indeed, w and z are defined on different alphabets:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">&#39;0&#39;</span>
<span class="gp">sage: </span><span class="n">z</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">0</span>
</pre></div>
</div>
</div>
</section>
<section id="functions-and-algorithms">
<h2>Functions and algorithms<a class="headerlink" href="#functions-and-algorithms" title="Permalink to this headline">¶</a></h2>
<p>There are more than 100 functions defined on a finite word. Here are some
of them:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abaabbba&#39;</span><span class="p">);</span> <span class="n">w</span>
<span class="go">word: abaabbba</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_lyndon</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">number_of_factors</span><span class="p">()</span>
<span class="go">28</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">critical_exponent</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">lyndon_factorization</span><span class="p">())</span>
<span class="go">(ab, aabbb, a)</span>
<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">crochemore_factorization</span><span class="p">())</span>
<span class="go">(a, b, a, ab, bb, a)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">st</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">suffix_tree</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">st</span>
<span class="go">Implicit Suffix Tree of the word: abaabbba</span>
<span class="gp">sage: </span><span class="n">st</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">word_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">(</span><span class="s1">&#39;ab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">longest_common_prefix</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abaabababbbbbb&#39;</span><span class="p">))</span>
<span class="go">word: abaababa</span>
</pre></div>
</div>
<p>As matrix and many other sage objects, words have a parent:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;xyxxyxyyy&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Finite words over Set of Python objects of class &#39;object&#39;</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;xyxxyxyyy&#39;</span><span class="p">,</span> <span class="n">alphabet</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Finite words over {&#39;x&#39;, &#39;y&#39;}</span>
</pre></div>
</div>
</section>
<section id="factors-and-rauzy-graphs">
<h2>Factors and Rauzy Graphs<a class="headerlink" href="#factors-and-rauzy-graphs" title="Permalink to this headline">¶</a></h2>
<p>Enumeration of factors, the successive values returned by <code class="docutils literal notranslate"><span class="pre">next(it)</span></code>
can appear in a different order depending on hardware. Therefore we
mark the three first results of the test <code class="docutils literal notranslate"><span class="pre">random</span></code>. The important test
is that the iteration stops properly on the fourth call:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span><span class="o">^</span><span class="mi">7</span>
<span class="gp">sage: </span><span class="n">it</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span> <span class="c1"># random</span>
<span class="go">word: 6456</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span> <span class="c1"># random</span>
<span class="go">word: 5645</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span> <span class="c1"># random</span>
<span class="go">word: 4564</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">StopIteration</span>
</pre></div>
</div>
<p>The set of factors:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">factor_set</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">[word: 456, word: 564, word: 645]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">factor_set</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="go">[word: 4564, word: 5645, word: 6456]</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">factor_set</span><span class="p">()</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">61</span>
</pre></div>
</div>
<p>Rauzy graphs:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">30</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">rauzy_graph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">Looped digraph on 5 vertices</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">reduced_rauzy_graph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">Looped multi-digraph on 2 vertices</span>
</pre></div>
</div>
<p>Left-special and bispecial factors:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">number_of_left_special_factors</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">bispecial_factors</span><span class="p">()</span>
<span class="go">[word: , word: 0, word: 010, word: 010010, word: 01001010010]</span>
</pre></div>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.CallableFromListOfWords">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sage.combinat.words.finite_word.</span></span><span class="sig-name descname"><span class="pre">CallableFromListOfWords</span></span><a class="headerlink" href="#sage.combinat.words.finite_word.CallableFromListOfWords" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<p>A class to create a callable from a list of words. The concatenation of
a list of words is obtained by creating a word from this callable.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.Factorization">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sage.combinat.words.finite_word.</span></span><span class="sig-name descname"><span class="pre">Factorization</span></span><a class="headerlink" href="#sage.combinat.words.finite_word.Factorization" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></p>
<p>A list subclass having a nicer representation for factorization of words.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sage.combinat.words.finite_word.</span></span><span class="sig-name descname"><span class="pre">FiniteWord_class</span></span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="abstract_word.html#sage.combinat.words.abstract_word.Word_class" title="sage.combinat.words.abstract_word.Word_class"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.combinat.words.abstract_word.Word_class</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.BWT">
<span class="sig-name descname"><span class="pre">BWT</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.BWT" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Burrows-Wheeler Transform (BWT) of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>The <em>Burrows-Wheeler transform</em> of a finite word <span class="math notranslate nohighlight">\(w\)</span> is obtained
from <span class="math notranslate nohighlight">\(w\)</span> by first listing the conjugates of <span class="math notranslate nohighlight">\(w\)</span> in lexicographic order
and then concatenating the final letters of the conjugates in this
order. See <a class="reference internal" href="../../../../references/index.html#bw1994" id="id1"><span>[BW1994]</span></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abaccaaba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">BWT</span><span class="p">()</span>
<span class="go">word: cbaabaaca</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abaab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">BWT</span><span class="p">()</span>
<span class="go">word: bbaaa</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;bbabbaca&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">BWT</span><span class="p">()</span>
<span class="go">word: cbbbbaaa</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;aabaab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">BWT</span><span class="p">()</span>
<span class="go">word: bbaaaa</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">BWT</span><span class="p">()</span>
<span class="go">word:</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">BWT</span><span class="p">()</span>
<span class="go">word: a</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.LZ_decomposition">
<span class="sig-name descname"><span class="pre">LZ_decomposition</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.LZ_decomposition" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Crochemore factorization of <code class="docutils literal notranslate"><span class="pre">self</span></code> as an ordered list of
factors.</p>
<p>The <em>Crochemore factorization</em> or the <em>Lempel-Ziv decomposition</em> of a
finite word <span class="math notranslate nohighlight">\(w\)</span> is the unique factorization: <span class="math notranslate nohighlight">\((x_1, x_2, \ldots, x_n)\)</span>
of <span class="math notranslate nohighlight">\(w\)</span> with each <span class="math notranslate nohighlight">\(x_i\)</span> satisfying either: C1. <span class="math notranslate nohighlight">\(x_i\)</span> is a letter that
does not appear in <span class="math notranslate nohighlight">\(u = x_1\ldots x_{i-1}\)</span>; C2. <span class="math notranslate nohighlight">\(x_i\)</span> is the longest
prefix of <span class="math notranslate nohighlight">\(v = x_i\ldots x_n\)</span> that also has an occurrence beginning
within <span class="math notranslate nohighlight">\(u = x_1\ldots x_{i-1}\)</span>. See <a class="reference internal" href="../../../../references/index.html#cro1983" id="id2"><span>[Cro1983]</span></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abababb&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">crochemore_factorization</span><span class="p">()</span>
<span class="go">(a, b, abab, b)</span>
<span class="gp">sage: </span><span class="n">mul</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">crochemore_factorization</span><span class="p">())</span> <span class="o">==</span> <span class="n">x</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abaababacabba&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">crochemore_factorization</span><span class="p">()</span>
<span class="go">(a, b, a, aba, ba, c, ab, ba)</span>
<span class="gp">sage: </span><span class="n">mul</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">crochemore_factorization</span><span class="p">())</span> <span class="o">==</span> <span class="n">y</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">crochemore_factorization</span><span class="p">()</span>
<span class="go">(0, 1, 0101, 1)</span>
<span class="gp">sage: </span><span class="n">mul</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">crochemore_factorization</span><span class="p">())</span> <span class="o">==</span> <span class="n">x</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.abelian_complexity">
<span class="sig-name descname"><span class="pre">abelian_complexity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.abelian_complexity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of abelian vectors of factors of length <code class="docutils literal notranslate"><span class="pre">n</span></code> of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">abelian_complexity</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">abelian_complexity</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[1, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.abelian_vector">
<span class="sig-name descname"><span class="pre">abelian_vector</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.abelian_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the abelian vector of <code class="docutils literal notranslate"><span class="pre">self</span></code> counting the occurrences of each letter.</p>
<p>The vector is defined w.r.t. the order of the alphabet of the
parent. See also <a class="reference internal" href="#sage.combinat.words.finite_word.evaluation_dict" title="sage.combinat.words.finite_word.evaluation_dict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">evaluation_dict()</span></code></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – word having a parent on a finite alphabet</p></li>
</ul>
<p>OUTPUT:</p>
<p>a list</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s1">&#39;ab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s1">&#39;aaabbbbb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">abelian_vector</span><span class="p">()</span>
<span class="go">[3, 5]</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">abelian_vector</span><span class="p">()</span>
<span class="go">[1, 0]</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">()</span><span class="o">.</span><span class="n">abelian_vector</span><span class="p">()</span>
<span class="go">[0, 0]</span>
</pre></div>
</div>
<p>The result depends on the alphabet of the parent:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s1">&#39;aabaa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">abelian_vector</span><span class="p">()</span>
<span class="go">[4, 1, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.abelian_vectors">
<span class="sig-name descname"><span class="pre">abelian_vectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.abelian_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the abelian vectors of factors of length <code class="docutils literal notranslate"><span class="pre">n</span></code> of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>The vectors are defined w.r.t. the order of the alphabet of the
parent.</p>
<p>OUTPUT:</p>
<p>a set of tuples</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">abelian_vectors</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">{(1, 0, 2), (1, 1, 1), (1, 2, 0), (2, 0, 1)}</span>
<span class="gp">sage: </span><span class="n">w</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">abelian_vectors</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">{(1, 2, 0)}</span>
<span class="gp">sage: </span><span class="n">w</span><span class="p">[</span><span class="mi">5</span><span class="p">:]</span><span class="o">.</span><span class="n">abelian_vectors</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">{(1, 0, 2), (2, 0, 1)}</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">abelian_vectors</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">[(0, 0)]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">abelian_vectors</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">[(0, 1), (1, 0)]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">abelian_vectors</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="go">[(4, 3), (5, 2)]</span>
</pre></div>
</div>
<p>The word must be defined with a parent on a finite alphabet:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">count</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="n">count</span><span class="p">(),</span> <span class="n">alphabet</span><span class="o">=</span><span class="n">NN</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">abelian_vectors</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: The alphabet of the parent is infinite; define the</span>
<span class="go">word with a parent on a finite alphabet</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.apply_permutation_to_letters">
<span class="sig-name descname"><span class="pre">apply_permutation_to_letters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">permutation</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.apply_permutation_to_letters" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the word obtained by applying the permutation
<code class="docutils literal notranslate"><span class="pre">permutation</span></code> of the alphabet of <code class="docutils literal notranslate"><span class="pre">self</span></code> to each letter of
<code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s1">&#39;abcd&#39;</span><span class="p">)(</span><span class="s1">&#39;abcd&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">apply_permutation_to_letters</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">word: badc</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s1">&#39;dabc&#39;</span><span class="p">)(</span><span class="s1">&#39;abcd&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">apply_permutation_to_letters</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">word: dcba</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">apply_permutation_to_letters</span><span class="p">(</span><span class="n">Permutation</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
<span class="go">word: badc</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">apply_permutation_to_letters</span><span class="p">(</span><span class="n">PermutationGroupElement</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
<span class="go">word: badc</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.apply_permutation_to_positions">
<span class="sig-name descname"><span class="pre">apply_permutation_to_positions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">permutation</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.apply_permutation_to_positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the word obtained by permuting the positions of the letters
in <code class="docutils literal notranslate"><span class="pre">self</span></code> according to the permutation <code class="docutils literal notranslate"><span class="pre">permutation</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s1">&#39;abcd&#39;</span><span class="p">)(</span><span class="s1">&#39;abcd&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">apply_permutation_to_positions</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">word: badc</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s1">&#39;dabc&#39;</span><span class="p">)(</span><span class="s1">&#39;abcd&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">apply_permutation_to_positions</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">word: badc</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">apply_permutation_to_positions</span><span class="p">(</span><span class="n">Permutation</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span>
<span class="go">word: badc</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">apply_permutation_to_positions</span><span class="p">(</span><span class="n">PermutationGroupElement</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span>
<span class="go">word: badc</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">apply_permutation_to_positions</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">word: 3421</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.balance">
<span class="sig-name descname"><span class="pre">balance</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.balance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the balance of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>The balance of a word is the smallest number <span class="math notranslate nohighlight">\(q\)</span> such that <code class="docutils literal notranslate"><span class="pre">self</span></code> is
<span class="math notranslate nohighlight">\(q\)</span>-balanced <a class="reference internal" href="../../../../references/index.html#fv2002" id="id3"><span>[FV2002]</span></a>.</p>
<p>A finite or infinite word <span class="math notranslate nohighlight">\(w\)</span> is said to be <span class="math notranslate nohighlight">\(q\)</span>-<em>balanced</em> if for
any two factors <span class="math notranslate nohighlight">\(u\)</span>, <span class="math notranslate nohighlight">\(v\)</span> of <span class="math notranslate nohighlight">\(w\)</span> of the same length, the difference
between the number of <span class="math notranslate nohighlight">\(x\)</span>’s in each of <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(v\)</span> is at most <span class="math notranslate nohighlight">\(q\)</span>
for all letters <span class="math notranslate nohighlight">\(x\)</span> in the alphabet of <span class="math notranslate nohighlight">\(w\)</span>. A <span class="math notranslate nohighlight">\(1\)</span>-balanced word is
simply said to be balanced. See Chapter 2 of <a class="reference internal" href="../../../../references/index.html#lot2002" id="id4"><span>[Lot2002]</span></a>.</p>
<p>OUTPUT:</p>
<p>integer</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;1111111&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">balance</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;001010101011&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">balance</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;0101010101&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">balance</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;11112222&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_balanced</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_balanced</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_balanced</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_balanced</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">balance</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.bispecial_factors">
<span class="sig-name descname"><span class="pre">bispecial_factors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.bispecial_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the bispecial factors (of length <code class="docutils literal notranslate"><span class="pre">n</span></code>).</p>
<p>A factor <span class="math notranslate nohighlight">\(u\)</span> of a word <span class="math notranslate nohighlight">\(w\)</span> is <em>bispecial</em> if it is right special
and left special.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – integer (optional, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>). If <code class="docutils literal notranslate"><span class="pre">None</span></code>, it returns
all bispecial factors.</p></li>
</ul>
<p>OUTPUT:</p>
<p>a list of words</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">30</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">bispecial_factors</span><span class="p">()</span>
<span class="go">[word: , word: 0, word: 010, word: 010010, word: 01001010010]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">30</span><span class="p">]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;{} {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">bispecial_factors</span><span class="p">(</span><span class="n">i</span><span class="p">))))</span>
<span class="go">0 [word: ]</span>
<span class="go">1 [word: 0, word: 1]</span>
<span class="go">2 [word: 01, word: 10]</span>
<span class="go">3 [word: 010, word: 101]</span>
<span class="go">4 [word: 0110, word: 1001]</span>
<span class="go">5 []</span>
<span class="go">6 [word: 011001, word: 100110]</span>
<span class="go">7 []</span>
<span class="go">8 [word: 10010110]</span>
<span class="go">9 []</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.bispecial_factors_iterator">
<span class="sig-name descname"><span class="pre">bispecial_factors_iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.bispecial_factors_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an iterator over the bispecial factors (of length <code class="docutils literal notranslate"><span class="pre">n</span></code>).</p>
<p>A factor <span class="math notranslate nohighlight">\(u\)</span> of a word <span class="math notranslate nohighlight">\(w\)</span> is <em>bispecial</em> if it is right special
and left special.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – integer (optional, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>). If <code class="docutils literal notranslate"><span class="pre">None</span></code>, it returns
an iterator over all bispecial factors.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">30</span><span class="p">]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">bispecial_factors_iterator</span><span class="p">(</span><span class="n">i</span><span class="p">)):</span>
<span class="gp">....: </span>        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;{} {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">u</span><span class="p">))</span>
<span class="go">0</span>
<span class="go">1 0</span>
<span class="go">1 1</span>
<span class="go">2 01</span>
<span class="go">2 10</span>
<span class="go">3 010</span>
<span class="go">3 101</span>
<span class="go">4 0110</span>
<span class="go">4 1001</span>
<span class="go">6 011001</span>
<span class="go">6 100110</span>
<span class="go">8 10010110</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">u</span> <span class="p">:</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">u</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">bispecial_factors_iterator</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">):</span> <span class="n">u</span>
<span class="go">word:</span>
<span class="go">word: 0</span>
<span class="go">word: 1</span>
<span class="go">word: 01</span>
<span class="go">word: 10</span>
<span class="go">word: 010</span>
<span class="go">word: 101</span>
<span class="go">word: 0110</span>
<span class="go">word: 1001</span>
<span class="go">word: 011001</span>
<span class="go">word: 100110</span>
<span class="go">word: 10010110</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.border">
<span class="sig-name descname"><span class="pre">border</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.border" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the longest word that is both a proper prefix and a proper
suffix of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;121212&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">border</span><span class="p">()</span>
<span class="go">word: 1212</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;12321&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">border</span><span class="p">()</span>
<span class="go">word: 1</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">border</span><span class="p">()</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.charge">
<span class="sig-name descname"><span class="pre">charge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.charge" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the charge of <code class="docutils literal notranslate"><span class="pre">self</span></code>.  This is defined as follows.</p>
<p>If <span class="math notranslate nohighlight">\(w\)</span> is a permutation of length <span class="math notranslate nohighlight">\(n\)</span>, (in other words, the evaluation
of <span class="math notranslate nohighlight">\(w\)</span> is <span class="math notranslate nohighlight">\((1, 1, \dots, 1)\)</span>), the statistic charge(<span class="math notranslate nohighlight">\(w\)</span>) is given by
<span class="math notranslate nohighlight">\(\sum_{i=1}^n c_i(w)\)</span> where <span class="math notranslate nohighlight">\(c_1(w) = 0\)</span> and <span class="math notranslate nohighlight">\(c_i(w)\)</span> is defined
recursively by setting <span class="math notranslate nohighlight">\(p_i\)</span> equal to <span class="math notranslate nohighlight">\(1\)</span> if <span class="math notranslate nohighlight">\(i\)</span> appears to the right
of <span class="math notranslate nohighlight">\(i-1\)</span> in <span class="math notranslate nohighlight">\(w\)</span> and <span class="math notranslate nohighlight">\(0\)</span> otherwise.  Then we set <span class="math notranslate nohighlight">\(c_i(w) = c_{i-1}(w) +
p_i\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">charge</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">charge</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If <span class="math notranslate nohighlight">\(w\)</span> is not a permutation, but the evaluation of <span class="math notranslate nohighlight">\(w\)</span> is a partition,
the charge of <span class="math notranslate nohighlight">\(w\)</span> is defined to be the sum of its charge subwords
(each of which will be a permutation).  The first charge subword is
found by starting at the end of <span class="math notranslate nohighlight">\(w\)</span> and moving left until the first
<span class="math notranslate nohighlight">\(1\)</span> is found.  This is marked, and we continue to move to the left
until the first <span class="math notranslate nohighlight">\(2\)</span> is found, wrapping around from the beginning of
the word back to the end, if necessary.  We mark this <span class="math notranslate nohighlight">\(2\)</span>, and
continue on until we have marked the largest letter in <span class="math notranslate nohighlight">\(w\)</span>.  The
marked letters, with relative order preserved, form the first charge
subword of <span class="math notranslate nohighlight">\(w\)</span>.  This subword is removed, and the next charge subword
is found in the same manner from the remaining letters.  In the
following example, <span class="math notranslate nohighlight">\(w1, w2, w3\)</span> are the charge subwords of <span class="math notranslate nohighlight">\(w\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w1</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w2</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w3</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">charge</span><span class="p">()</span> <span class="o">==</span> <span class="n">w1</span><span class="o">.</span><span class="n">charge</span><span class="p">()</span> <span class="o">+</span> <span class="n">w2</span><span class="o">.</span><span class="n">charge</span><span class="p">()</span> <span class="o">+</span> <span class="n">w3</span><span class="o">.</span><span class="n">charge</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Finally, if <span class="math notranslate nohighlight">\(w\)</span> does not have partition content, we apply the
Lascoux-Schützenberger standardization operators <span class="math notranslate nohighlight">\(s_i\)</span> in such a
manner as to obtain a word with partition content. (The word we obtain
is independent of the choice of operators.)  The charge is then
defined to be the charge of this word:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">charge</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">charge</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Note that this differs from the definition of charge given in
Macdonald’s book.  The difference amounts to a choice of
reading a word from left-to-right or right-to-left.  The choice in
Sage was made to agree with the definition of a reading word of a
tableau in Sage, and seems to be the more common convention in the
literature.</p>
<p>See <a class="reference internal" href="../../../../references/index.html#mac1995" id="id5"><span>[Mac1995]</span></a>, <a class="reference internal" href="../../../../references/index.html#llm2003" id="id6"><span>[LLM2003]</span></a>, and <a class="reference internal" href="../../../../references/index.html#llt" id="id7"><span>[LLT]</span></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.cocharge">
<span class="sig-name descname"><span class="pre">cocharge</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.cocharge" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the cocharge of <code class="docutils literal notranslate"><span class="pre">self</span></code>.  For a word <span class="math notranslate nohighlight">\(w\)</span>, this can be defined as
<span class="math notranslate nohighlight">\(n_{ev} - ch(w)\)</span>, where <span class="math notranslate nohighlight">\(ch(w)\)</span> is the charge of <span class="math notranslate nohighlight">\(w\)</span> and <span class="math notranslate nohighlight">\(ev\)</span> is the
evaluation of <span class="math notranslate nohighlight">\(w\)</span>, and <span class="math notranslate nohighlight">\(n_{ev}\)</span> is <span class="math notranslate nohighlight">\(\sum_{i&lt;j} min(ev_i, ev_j)\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">cocharge</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">cocharge</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">cocharge</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">cocharge</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.coerce">
<span class="sig-name descname"><span class="pre">coerce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.coerce" title="Permalink to this definition">¶</a></dt>
<dd><p>Try to return a pair of words with a common parent; raise an
exception if this is not possible.</p>
<p>This function begins by checking if both words have the same
parent. If this is the case, then no work is done and both words
are returned as-is.</p>
<p>Otherwise it will attempt to convert <code class="docutils literal notranslate"><span class="pre">other</span></code> to the domain of <code class="docutils literal notranslate"><span class="pre">self</span></code>.
If that fails, it will attempt to convert <code class="docutils literal notranslate"><span class="pre">self</span></code> to the domain of
<code class="docutils literal notranslate"><span class="pre">other</span></code>. If both attempts fail, it raises a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code> to signal
failure.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W1</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">);</span> <span class="n">W2</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s1">&#39;ab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w1</span> <span class="o">=</span> <span class="n">W1</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">);</span> <span class="n">w2</span> <span class="o">=</span> <span class="n">W2</span><span class="p">(</span><span class="s1">&#39;abba&#39;</span><span class="p">);</span> <span class="n">w3</span> <span class="o">=</span> <span class="n">W1</span><span class="p">(</span><span class="s1">&#39;baab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w1</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">w2</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">w1</span><span class="o">.</span><span class="n">coerce</span><span class="p">(</span><span class="n">w2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">b</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w1</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">w2</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.colored_vector">
<span class="sig-name descname"><span class="pre">colored_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hsv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thickness</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.colored_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a vector (Graphics object) illustrating <code class="docutils literal notranslate"><span class="pre">self</span></code>. Each letter
is represented by a coloured rectangle.</p>
<p>If the parent of <code class="docutils literal notranslate"><span class="pre">self</span></code> is a class of words over a finite alphabet,
then each letter in the alphabet is assigned a unique colour, and
this colour will be the same every time this method is called. This
is especially useful when plotting and comparing words defined on
the same alphabet.</p>
<p>If the alphabet is infinite, then the letters appearing in the word
are used as the alphabet.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">0</span></code>) bottom left x-coordinate of the vector</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">0</span></code>) bottom left y-coordinate of the vector</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">width</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">'default'</span></code>) width of the vector. By default,
the width is the length of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">height</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">1</span></code>) height of the vector</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">thickness</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">1</span></code>) thickness of the contour</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cmap</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">'hsv'</span></code>) color map; for available color map names
type: <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">matplotlib.cm;</span> <span class="pre">list(matplotlib.cm.datad)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">label</span></code> – string (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) a label to add on the colored vector</p></li>
</ul>
<p>OUTPUT:</p>
<p>Graphics</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span><span class="o">.</span><span class="n">colored_vector</span><span class="p">()</span>
<span class="go">Graphics object consisting of 21 graphics primitives</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">colored_vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Graphics object consisting of 101 graphics primitives</span>
<span class="gp">sage: </span><span class="n">Words</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">))(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">colored_vector</span><span class="p">()</span>
<span class="go">Graphics object consisting of 11 graphics primitives</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abbabaab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">colored_vector</span><span class="p">()</span>
<span class="go">Graphics object consisting of 9 graphics primitives</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">colored_vector</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;autumn&#39;</span><span class="p">)</span>
<span class="go">Graphics object consisting of 9 graphics primitives</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span><span class="o">.</span><span class="n">colored_vector</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Rainbow&#39;</span><span class="p">)</span>
<span class="go">Graphics object consisting of 23 graphics primitives</span>
</pre></div>
</div>
<p>When two words are defined under the same parent, same letters are
mapped to same colors:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">colored_vector</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="n">w</span><span class="o">.</span><span class="n">colored_vector</span><span class="p">()</span>
<span class="go">Graphics object consisting of 32 graphics primitives</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.commutes_with">
<span class="sig-name descname"><span class="pre">commutes_with</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.commutes_with" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> commutes with <code class="docutils literal notranslate"><span class="pre">other</span></code>, and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">commutes_with</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;12&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">commutes_with</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;11&#39;</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">commutes_with</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;21&#39;</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.complete_return_words">
<span class="sig-name descname"><span class="pre">complete_return_words</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fact</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.complete_return_words" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the set of complete return words of <code class="docutils literal notranslate"><span class="pre">fact</span></code> in <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>This is the set of all factors starting by the given factor and ending
just after the next occurrence of this factor.
See for instance <a class="reference internal" href="../../../../references/index.html#jv2000" id="id8"><span>[JV2000]</span></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fact</span></code> – a non-empty finite word</p></li>
</ul>
<p>OUTPUT:</p>
<p>a Python set of finite words</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;21331233213231&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">complete_return_words</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">[word: 2132, word: 213312, word: 2332]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">complete_return_words</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;213&#39;</span><span class="p">))</span>
<span class="go">set()</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;121212&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">complete_return_words</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;1212&#39;</span><span class="p">))</span>
<span class="go">{word: 121212}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.concatenate">
<span class="sig-name descname"><span class="pre">concatenate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.concatenate" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the concatenation of <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">other</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> – a word over the same alphabet as <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
</ul>
<p>EXAMPLES:</p>
<p>Concatenation may be made using <code class="docutils literal notranslate"><span class="pre">+</span></code> or <code class="docutils literal notranslate"><span class="pre">*</span></code> operations:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abadafd&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">*</span> <span class="n">y</span>
<span class="go">word: abadafd53587</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">+</span> <span class="n">y</span>
<span class="go">word: abadafd53587</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">word: abadafd53587</span>
</pre></div>
</div>
<p>Both words must be defined over the same alphabet:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;12223&#39;</span><span class="p">,</span> <span class="n">alphabet</span> <span class="o">=</span> <span class="s1">&#39;123&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">+</span> <span class="n">y</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: 5 not in alphabet!</span>
</pre></div>
</div>
<p>Eventually, it should work:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;12223&#39;</span><span class="p">,</span> <span class="n">alphabet</span> <span class="o">=</span> <span class="s1">&#39;123&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">+</span> <span class="n">y</span>                   <span class="c1">#todo: not implemented</span>
<span class="go">word: 1222353587</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.conjugate">
<span class="sig-name descname"><span class="pre">conjugate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.conjugate" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the conjugate at <code class="docutils literal notranslate"><span class="pre">pos</span></code> of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">pos</span></code> can be any integer, the distance used is the modulo by the length
of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;12112&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">word: 21121</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">word:</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;12112&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="go">word: 12121</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;12112&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">word: 21211</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.conjugate_position">
<span class="sig-name descname"><span class="pre">conjugate_position</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.conjugate_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the position where <code class="docutils literal notranslate"><span class="pre">self</span></code> is conjugate with <code class="docutils literal notranslate"><span class="pre">other</span></code>.
Return <code class="docutils literal notranslate"><span class="pre">None</span></code> if there is no such position.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;12113&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">conjugate_position</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;31211&#39;</span><span class="p">))</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;12131&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">conjugate_position</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;12113&#39;</span><span class="p">))</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">conjugate_position</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;123&#39;</span><span class="p">))</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.conjugates">
<span class="sig-name descname"><span class="pre">conjugates</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.conjugates" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of unique conjugates of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">conjugates</span><span class="p">()</span>
<span class="go">[word: 012345,</span>
<span class="go"> word: 123450,</span>
<span class="go"> word: 234501,</span>
<span class="go"> word: 345012,</span>
<span class="go"> word: 450123,</span>
<span class="go"> word: 501234]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;cbbca&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">conjugates</span><span class="p">()</span>
<span class="go">[word: cbbca, word: bbcac, word: bcacb, word: cacbb, word: acbbc]</span>
</pre></div>
</div>
<p>The result contains each conjugate only once:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abcabc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">conjugates</span><span class="p">()</span>
<span class="go">[word: abcabc, word: bcabca, word: cabcab]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.conjugates_iterator">
<span class="sig-name descname"><span class="pre">conjugates_iterator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.conjugates_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an iterator over the conjugates of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">it</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">.</span><span class="n">conjugates_iterator</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">it</span><span class="p">:</span> <span class="n">w</span>
<span class="go">word: 0123</span>
<span class="go">word: 1230</span>
<span class="go">word: 2301</span>
<span class="go">word: 3012</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.content">
<span class="sig-name descname"><span class="pre">content</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.content" title="Permalink to this definition">¶</a></dt>
<dd><p>Return content of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – (optional) an integer specifying the maximal
letter in the alphabet</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a list where the <span class="math notranslate nohighlight">\(i\)</span>-th entry indicates the multiplicity
of the <span class="math notranslate nohighlight">\(i\)</span>-th letter in the alphabet in <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">content</span><span class="p">()</span>
<span class="go">[1, 4, 1, 1]</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">content</span><span class="p">()</span>
<span class="go">[1, 1]</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">content</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[1, 0, 1]</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span><span class="n">alphabet</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">content</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[0, 1, 0]</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">content</span><span class="p">()</span>
<span class="go">[0, 1, 0, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">letter</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.count" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of occurrences of <code class="docutils literal notranslate"><span class="pre">letter</span></code> in <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">letter</span></code> - a letter</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>integer</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abbabaab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">number_of_letter_occurrences</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">number_of_letter_occurrences</span><span class="p">(</span><span class="s1">&#39;ab&#39;</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>This methods is equivalent to <code class="docutils literal notranslate"><span class="pre">list(w).count(letter)</span></code> and
<code class="docutils literal notranslate"><span class="pre">tuple(w).count(letter)</span></code>, thus <code class="docutils literal notranslate"><span class="pre">count</span></code> is an alias for the method
<code class="docutils literal notranslate"><span class="pre">number_of_letter_occurrences</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
<p>But notice that if <code class="docutils literal notranslate"><span class="pre">s</span></code> and <code class="docutils literal notranslate"><span class="pre">w</span></code> are strings,
<code class="docutils literal notranslate"><span class="pre">Word(s).count(w)</span></code> counts the number occurrences of <code class="docutils literal notranslate"><span class="pre">w</span></code> as a
letter in <code class="docutils literal notranslate"><span class="pre">Word(s)</span></code> which is not the same as <code class="docutils literal notranslate"><span class="pre">s.count(w)</span></code> which
counts the number of occurrences of the string <code class="docutils literal notranslate"><span class="pre">w</span></code> inside <code class="docutils literal notranslate"><span class="pre">s</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;abbabaab&#39;</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;ab&#39;</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;ab&#39;</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.combinat.words.finite_word.FiniteWord_class.number_of_factor_occurrences" title="sage.combinat.words.finite_word.FiniteWord_class.number_of_factor_occurrences"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.combinat.words.finite_word.FiniteWord_class.number_of_factor_occurrences()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.critical_exponent">
<span class="sig-name descname"><span class="pre">critical_exponent</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.critical_exponent" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the critical exponent of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>The <em>critical exponent</em> of a word is the supremum of the order of
all its (finite) factors. See <a class="reference internal" href="../../../../references/index.html#dej1972" id="id9"><span>[Dej1972]</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The implementation here uses the suffix tree to enumerate all the
factors. It should be improved (especially when the critical
exponent is larger than 2).</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;aaba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">critical_exponent</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;aabaa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">critical_exponent</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;aabaaba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">critical_exponent</span><span class="p">()</span>
<span class="go">7/3</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;ab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">critical_exponent</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;aba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">critical_exponent</span><span class="p">()</span>
<span class="go">3/2</span>
<span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">critical_exponent</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p>For the Fibonacci word, the critical exponent is known to be
<span class="math notranslate nohighlight">\((5+\sqrt(5))/2\)</span>. With a prefix of length 500, we obtain a lower bound:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">500</span><span class="p">]</span><span class="o">.</span><span class="n">critical_exponent</span><span class="p">()</span>
<span class="go">320/89</span>
</pre></div>
</div>
<p>It is an error to compute the critical exponent of the empty word:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">critical_exponent</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: no critical exponent for empty word</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.crochemore_factorization">
<span class="sig-name descname"><span class="pre">crochemore_factorization</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.crochemore_factorization" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Crochemore factorization of <code class="docutils literal notranslate"><span class="pre">self</span></code> as an ordered list of
factors.</p>
<p>The <em>Crochemore factorization</em> or the <em>Lempel-Ziv decomposition</em> of a
finite word <span class="math notranslate nohighlight">\(w\)</span> is the unique factorization: <span class="math notranslate nohighlight">\((x_1, x_2, \ldots, x_n)\)</span>
of <span class="math notranslate nohighlight">\(w\)</span> with each <span class="math notranslate nohighlight">\(x_i\)</span> satisfying either: C1. <span class="math notranslate nohighlight">\(x_i\)</span> is a letter that
does not appear in <span class="math notranslate nohighlight">\(u = x_1\ldots x_{i-1}\)</span>; C2. <span class="math notranslate nohighlight">\(x_i\)</span> is the longest
prefix of <span class="math notranslate nohighlight">\(v = x_i\ldots x_n\)</span> that also has an occurrence beginning
within <span class="math notranslate nohighlight">\(u = x_1\ldots x_{i-1}\)</span>. See <a class="reference internal" href="../../../../references/index.html#cro1983" id="id10"><span>[Cro1983]</span></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abababb&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">crochemore_factorization</span><span class="p">()</span>
<span class="go">(a, b, abab, b)</span>
<span class="gp">sage: </span><span class="n">mul</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">crochemore_factorization</span><span class="p">())</span> <span class="o">==</span> <span class="n">x</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abaababacabba&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">crochemore_factorization</span><span class="p">()</span>
<span class="go">(a, b, a, aba, ba, c, ab, ba)</span>
<span class="gp">sage: </span><span class="n">mul</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">crochemore_factorization</span><span class="p">())</span> <span class="o">==</span> <span class="n">y</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">crochemore_factorization</span><span class="p">()</span>
<span class="go">(0, 1, 0101, 1)</span>
<span class="gp">sage: </span><span class="n">mul</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">crochemore_factorization</span><span class="p">())</span> <span class="o">==</span> <span class="n">x</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.defect">
<span class="sig-name descname"><span class="pre">defect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.defect" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the defect of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>The <em>defect</em> of a finite word <span class="math notranslate nohighlight">\(w\)</span> is given by the difference between
the maximum number of possible palindromic factors in a word of length
<span class="math notranslate nohighlight">\(|w|\)</span> and the actual number of palindromic factors contained in <span class="math notranslate nohighlight">\(w\)</span>.
It is well known that the maximum number of palindromic factors in <span class="math notranslate nohighlight">\(w\)</span>
is <span class="math notranslate nohighlight">\(|w|+1\)</span> (see <a class="reference internal" href="../../../../references/index.html#djp2001" id="id11"><span>[DJP2001]</span></a>).</p>
<p>An optional involution on letters <code class="docutils literal notranslate"><span class="pre">f</span></code> can be given. In that case, the
<em>f-palindromic defect</em> (or <em>pseudopalindromic defect</em>, or
<em>theta-palindromic defect</em>) of <span class="math notranslate nohighlight">\(w\)</span> is returned. It is a
generalization of defect to f-palindromes. More precisely, the defect is
<span class="math notranslate nohighlight">\(D(w)=|w|+1-g_f(w)-|PAL_f(w)|\)</span>, where <span class="math notranslate nohighlight">\(PAL_f(w)\)</span> denotes the set of
f-palindromic factors of <span class="math notranslate nohighlight">\(w\)</span> (including the empty word) and <span class="math notranslate nohighlight">\(g_f(w)\)</span> is
the number of pairs <span class="math notranslate nohighlight">\(\{a, f(a)\}\)</span> such that <span class="math notranslate nohighlight">\(a\)</span> is a letter, <span class="math notranslate nohighlight">\(a\)</span> is not
equal to <span class="math notranslate nohighlight">\(f(a)\)</span>, and <span class="math notranslate nohighlight">\(a\)</span> or <span class="math notranslate nohighlight">\(f(a)\)</span> occurs in <span class="math notranslate nohighlight">\(w\)</span>. In the case of usual
palindromes (i.e., for <code class="docutils literal notranslate"><span class="pre">f</span></code> not given or equal to the identity),
<span class="math notranslate nohighlight">\(g_f(w) = 0\)</span> for all <span class="math notranslate nohighlight">\(w\)</span>. See <a class="reference internal" href="../../../../references/index.html#bhnr2004" id="id12"><span>[BHNR2004]</span></a> for usual palindromes and <a class="reference internal" href="../../../../references/index.html#star2011" id="id13"><span>[Star2011]</span></a>
for f-palindromes.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> – involution (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) on the alphabet of <code class="docutils literal notranslate"><span class="pre">self</span></code>. It must
be callable on letters as well as words (e.g. <code class="docutils literal notranslate"><span class="pre">WordMorphism</span></code>). The
default value corresponds to usual palindromes, i.e., <code class="docutils literal notranslate"><span class="pre">f</span></code> equal to
the identity.</p></li>
</ul>
<p>OUTPUT:</p>
<p>an integer – If <code class="docutils literal notranslate"><span class="pre">f</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the palindromic defect of <code class="docutils literal notranslate"><span class="pre">self</span></code>;
otherwise, the <code class="docutils literal notranslate"><span class="pre">f</span></code>-palindromic defect of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;ara&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">defect</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abcacba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">defect</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<p>It is known that Sturmian words (see <a class="reference internal" href="../../../../references/index.html#djp2001" id="id14"><span>[DJP2001]</span></a>) have zero defect:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">defect</span><span class="p">()</span>
<span class="go">0</span>

<span class="gp">sage: </span><span class="n">sa</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ab,b-&gt;b&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sb</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;a,b-&gt;ba&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="p">(</span><span class="n">sa</span><span class="o">*</span><span class="n">sb</span><span class="o">*</span><span class="n">sb</span><span class="o">*</span><span class="n">sa</span><span class="o">*</span><span class="n">sa</span><span class="o">*</span><span class="n">sa</span><span class="o">*</span><span class="n">sb</span><span class="p">)</span><span class="o">.</span><span class="n">fixed_point</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="p">[:</span><span class="mi">30</span><span class="p">]</span><span class="o">.</span><span class="n">defect</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">w</span><span class="p">[</span><span class="mi">110</span><span class="p">:</span><span class="mi">140</span><span class="p">]</span><span class="o">.</span><span class="n">defect</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<p>It is even conjectured that the defect of an aperiodic word which is
a fixed point of a primitive morphism is either <span class="math notranslate nohighlight">\(0\)</span> or infinite
(see <a class="reference internal" href="../../../../references/index.html#bbgl2008" id="id15"><span>[BBGL2008]</span></a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span><span class="p">[:</span><span class="mi">50</span><span class="p">]</span><span class="o">.</span><span class="n">defect</span><span class="p">()</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">w</span><span class="p">[:</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">defect</span><span class="p">()</span>
<span class="go">16</span>
<span class="gp">sage: </span><span class="n">w</span><span class="p">[:</span><span class="mi">300</span><span class="p">]</span><span class="o">.</span><span class="n">defect</span><span class="p">()</span>
<span class="go">52</span>
</pre></div>
</div>
<p>For generalized defect with an involution different from the identity,
there is always a letter which is not a palindrome! This is the reason
for the modification of the definition:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">defect</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;ab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">defect</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;aa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">defect</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abbabaabbaababba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">defect</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;b,b-&gt;a,c-&gt;c&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;cabc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">defect</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abcaab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">defect</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Other examples:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;000000000000&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">defect</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;011010011001&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">defect</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;0101001010001&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">defect</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">defect</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abbabaabbaababba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">defect</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.deg_inv_lex_less">
<span class="sig-name descname"><span class="pre">deg_inv_lex_less</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.deg_inv_lex_less" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if the word <code class="docutils literal notranslate"><span class="pre">self</span></code> is degree inverse lexicographically
less than <code class="docutils literal notranslate"><span class="pre">other</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">deg_inv_lex_less</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">deg_inv_lex_less</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.deg_lex_less">
<span class="sig-name descname"><span class="pre">deg_lex_less</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.deg_lex_less" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is degree lexicographically less than <code class="docutils literal notranslate"><span class="pre">other</span></code>,
and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise. The weight of each letter in the ordered
alphabet is given by <code class="docutils literal notranslate"><span class="pre">weights</span></code>, which defaults to <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">...]</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">deg_lex_less</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">deg_lex_less</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">deg_lex_less</span><span class="p">(</span><span class="n">W</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s2">&quot;abba&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">deg_lex_less</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s2">&quot;abbb&quot;</span><span class="p">),</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s2">&quot;abba&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">deg_lex_less</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s2">&quot;baba&quot;</span><span class="p">),</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s2">&quot;abba&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">deg_lex_less</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s2">&quot;aaba&quot;</span><span class="p">),</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s2">&quot;abba&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">deg_lex_less</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s2">&quot;aaba&quot;</span><span class="p">),</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.deg_rev_lex_less">
<span class="sig-name descname"><span class="pre">deg_rev_lex_less</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.deg_rev_lex_less" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is degree reverse
lexicographically less than <code class="docutils literal notranslate"><span class="pre">other</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">deg_rev_lex_less</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">deg_rev_lex_less</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">deg_rev_lex_less</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.degree">
<span class="sig-name descname"><span class="pre">degree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.degree" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the weighted degree of <code class="docutils literal notranslate"><span class="pre">self</span></code>, where the weighted degree of
each letter in the ordered alphabet is given by <code class="docutils literal notranslate"><span class="pre">weights</span></code>, which
defaults to <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">...]</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">weights</span></code> – a list or a tuple, or a dictionary keyed by the
letters occurring in <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">Words</span><span class="p">(</span><span class="s2">&quot;ab&quot;</span><span class="p">)(</span><span class="s2">&quot;abba&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">Words</span><span class="p">(</span><span class="s2">&quot;ab&quot;</span><span class="p">)(</span><span class="s2">&quot;abba&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">degree</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">Words</span><span class="p">(</span><span class="s2">&quot;ab&quot;</span><span class="p">)(</span><span class="s2">&quot;abba&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">degree</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="go">-4</span>
<span class="gp">sage: </span><span class="n">Words</span><span class="p">(</span><span class="s2">&quot;ab&quot;</span><span class="p">)(</span><span class="s2">&quot;aabba&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">degree</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">Words</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s2">&quot;aabba&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">degree</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">degree</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">0</span><span class="p">})</span>
<span class="go">34</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.delta">
<span class="sig-name descname"><span class="pre">delta</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.delta" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the image of <code class="docutils literal notranslate"><span class="pre">self</span></code> under the delta morphism.</p>
<p>The delta morphism, also known as the run-length encoding,
is the word composed of the length of consecutive runs of
the same letter in a given word.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s1">&#39;0123456789&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s1">&#39;22112122&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta</span><span class="p">()</span>
<span class="go">word: 22112</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s1">&#39;555008&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta</span><span class="p">()</span>
<span class="go">word: 321</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">()</span><span class="o">.</span><span class="n">delta</span><span class="p">()</span>
<span class="go">word:</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;aabbabaa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta</span><span class="p">()</span>
<span class="go">word: 22112</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.delta_derivate">
<span class="sig-name descname"><span class="pre">delta_derivate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.delta_derivate" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative under delta for <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s1">&#39;12&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s1">&#39;12211&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate</span><span class="p">()</span>
<span class="go">word: 22</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate</span><span class="p">(</span><span class="n">Words</span><span class="p">([</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">word: 1</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s1">&#39;2112&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate</span><span class="p">()</span>
<span class="go">word: 2</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s1">&#39;2211&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate</span><span class="p">()</span>
<span class="go">word: 22</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s1">&#39;112&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate</span><span class="p">()</span>
<span class="go">word: 2</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s1">&#39;11222&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate</span><span class="p">(</span><span class="n">Words</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="go">word: 3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.delta_derivate_left">
<span class="sig-name descname"><span class="pre">delta_derivate_left</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.delta_derivate_left" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative under delta for <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s1">&#39;12&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s1">&#39;12211&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate_left</span><span class="p">()</span>
<span class="go">word: 22</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate_left</span><span class="p">(</span><span class="n">Words</span><span class="p">([</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">word: 1</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s1">&#39;2112&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate_left</span><span class="p">()</span>
<span class="go">word: 21</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s1">&#39;2211&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate_left</span><span class="p">()</span>
<span class="go">word: 22</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s1">&#39;112&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate_left</span><span class="p">()</span>
<span class="go">word: 21</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s1">&#39;11222&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate_left</span><span class="p">(</span><span class="n">Words</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="go">word: 3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.delta_derivate_right">
<span class="sig-name descname"><span class="pre">delta_derivate_right</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.delta_derivate_right" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the right derivative under delta for <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s1">&#39;12&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s1">&#39;12211&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate_right</span><span class="p">()</span>
<span class="go">word: 122</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate_right</span><span class="p">(</span><span class="n">Words</span><span class="p">([</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">word: 1</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s1">&#39;2112&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate_right</span><span class="p">()</span>
<span class="go">word: 12</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s1">&#39;2211&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate_right</span><span class="p">()</span>
<span class="go">word: 22</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s1">&#39;112&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate_right</span><span class="p">()</span>
<span class="go">word: 2</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s1">&#39;11222&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">delta_derivate_right</span><span class="p">(</span><span class="n">Words</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="go">word: 23</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.delta_inv">
<span class="sig-name descname"><span class="pre">delta_inv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.delta_inv" title="Permalink to this definition">¶</a></dt>
<dd><p>Lift <code class="docutils literal notranslate"><span class="pre">self</span></code> via the delta operator to obtain a word containing the
letters in alphabet (default is <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1]</span></code>). The letters used in the
construction start with <code class="docutils literal notranslate"><span class="pre">s</span></code> (default is <code class="docutils literal notranslate"><span class="pre">alphabet[0]</span></code>) and cycle
through alphabet.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alphabet</span></code> – an iterable</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">s</span></code> – an object in the iterable</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">delta_inv</span><span class="p">()</span>
<span class="go">word: 112212</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">delta_inv</span><span class="p">(</span><span class="n">Words</span><span class="p">(</span><span class="s1">&#39;123&#39;</span><span class="p">))</span>
<span class="go">word: 1231</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">delta_inv</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">word: 22112122</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.evaluation">
<span class="sig-name descname"><span class="pre">evaluation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.evaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the abelian vector of <code class="docutils literal notranslate"><span class="pre">self</span></code> counting the occurrences of each letter.</p>
<p>The vector is defined w.r.t. the order of the alphabet of the
parent. See also <a class="reference internal" href="#sage.combinat.words.finite_word.evaluation_dict" title="sage.combinat.words.finite_word.evaluation_dict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">evaluation_dict()</span></code></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – word having a parent on a finite alphabet</p></li>
</ul>
<p>OUTPUT:</p>
<p>a list</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s1">&#39;ab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s1">&#39;aaabbbbb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">abelian_vector</span><span class="p">()</span>
<span class="go">[3, 5]</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">abelian_vector</span><span class="p">()</span>
<span class="go">[1, 0]</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">()</span><span class="o">.</span><span class="n">abelian_vector</span><span class="p">()</span>
<span class="go">[0, 0]</span>
</pre></div>
</div>
<p>The result depends on the alphabet of the parent:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="s1">&#39;aabaa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">abelian_vector</span><span class="p">()</span>
<span class="go">[4, 1, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.evaluation_dict">
<span class="sig-name descname"><span class="pre">evaluation_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.evaluation_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary keyed by the letters occurring in <code class="docutils literal notranslate"><span class="pre">self</span></code> with
values the number of occurrences of the letter.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">evaluation_dict</span><span class="p">()</span>
<span class="go">{1: 1, 2: 3, 3: 1, 4: 2}</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;badbcdb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">evaluation_dict</span><span class="p">()</span>
<span class="go">{&#39;a&#39;: 1, &#39;b&#39;: 3, &#39;c&#39;: 1, &#39;d&#39;: 2}</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">evaluation_dict</span><span class="p">()</span>
<span class="go">{}</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;1213121&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">evaluation_dict</span><span class="p">()</span> <span class="c1"># keys appear in random order</span>
<span class="go">{&#39;1&#39;: 4, &#39;2&#39;: 2, &#39;3&#39;: 1}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.evaluation_partition">
<span class="sig-name descname"><span class="pre">evaluation_partition</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.evaluation_partition" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the evaluation of the word w as a partition.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s2">&quot;acdabda&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">evaluation_partition</span><span class="p">()</span>
<span class="go">[3, 2, 1, 1]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">evaluation_partition</span><span class="p">()</span>
<span class="go">[3, 2, 1, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.evaluation_sparse">
<span class="sig-name descname"><span class="pre">evaluation_sparse</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.evaluation_sparse" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list representing the evaluation of <code class="docutils literal notranslate"><span class="pre">self</span></code>. The entries of
the list are two-element lists <code class="docutils literal notranslate"><span class="pre">[a,</span> <span class="pre">n]</span></code>, where <code class="docutils literal notranslate"><span class="pre">a</span></code> is a letter
occurring in <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">n</span></code> is the number of occurrences of <code class="docutils literal notranslate"><span class="pre">a</span></code> in <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">evaluation_sparse</span><span class="p">())</span>
<span class="go">[(1, 2), (2, 2), (4, 3), (5, 1)]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s2">&quot;abcaccab&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">evaluation_sparse</span><span class="p">())</span>
<span class="go">[(&#39;a&#39;, 3), (&#39;b&#39;, 2), (&#39;c&#39;, 3)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.exponent">
<span class="sig-name descname"><span class="pre">exponent</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.exponent" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the exponent of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<p>integer – the exponent</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;1231&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">exponent</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;121212&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">exponent</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">exponent</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.factor_complexity">
<span class="sig-name descname"><span class="pre">factor_complexity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.factor_complexity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of distinct factors of length <code class="docutils literal notranslate"><span class="pre">n</span></code> of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – the length of the factors.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">factor_complexity</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">1000</span><span class="p">]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">factor_complexity</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[1, 2, 4, 6, 10, 12, 16, 20, 22, 24, 28, 32, 36, 40, 42, 44, 46, 48, 52, 56]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.factor_iterator">
<span class="sig-name descname"><span class="pre">factor_iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.factor_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate distinct factors of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – an integer, or <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>If <code class="docutils literal notranslate"><span class="pre">n</span></code> is an integer, returns an iterator over all distinct
factors of length <code class="docutils literal notranslate"><span class="pre">n</span></code>. If <code class="docutils literal notranslate"><span class="pre">n</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, returns an iterator
generating all distinct factors.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;1213121&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">w</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
<span class="go">[word: ]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">w</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">w</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
<span class="go">[word: 1, word: 2, word: 3]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">w</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<span class="go">[word: 1213, word: 1312, word: 2131, word: 3121]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">w</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">()</span> <span class="p">)</span>
<span class="go">[word: , word: 1, word: 12, word: 121, word: 1213, word: 12131, word: 121312, word: 1213121, word: 13, word: 131, word: 1312, word: 13121, word: 2, word: 21, word: 213, word: 2131, word: 21312, word: 213121, word: 3, word: 31, word: 312, word: 3121]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">u</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
<span class="go">[word: ]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">u</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">u</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
<span class="go">[word: 1, word: 2, word: 3]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">u</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">)</span>
<span class="go">[word: 12123]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">u</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">()</span> <span class="p">)</span>
<span class="go">[word: , word: 1, word: 12, word: 121, word: 1212, word: 12123, word: 123, word: 2, word: 21, word: 212, word: 2123, word: 23, word: 3]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">xxx</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s2">&quot;xxx&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">xxx</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
<span class="go">[word: ]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">xxx</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">xxx</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
<span class="go">[word: xx]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">xxx</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">()</span> <span class="p">)</span>
<span class="go">[word: , word: x, word: xx, word: xxx]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">Word</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">e</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
<span class="go">[word: ]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">e</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span> <span class="n">e</span><span class="o">.</span><span class="n">factor_iterator</span><span class="p">()</span> <span class="p">)</span>
<span class="go">[word: ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.factor_occurrences_in">
<span class="sig-name descname"><span class="pre">factor_occurrences_in</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.factor_occurrences_in" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an iterator over all occurrences (including overlapping ones)
of <code class="docutils literal notranslate"><span class="pre">self</span></code> in <code class="docutils literal notranslate"><span class="pre">other</span></code> in their order of appearance.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This method is deprecated since 2020 and will be removed in a
later version of SageMath.
Use <code class="xref py py-meth docutils literal notranslate"><span class="pre">factor_occurrences_iterator()</span></code> instead.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;121&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;121213211213&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">factor_occurrences_in</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
<span class="go">doctest:warning</span>
<span class="go">...</span>
<span class="go">DeprecationWarning: f.factor_occurrences_in(w) is deprecated.</span>
<span class="go">Use w.factor_occurrences_iterator(f) instead.</span>
<span class="go">See https://trac.sagemath.org/30187 for details.</span>
<span class="go">[0, 2, 8]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.factor_set">
<span class="sig-name descname"><span class="pre">factor_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'suffix</span> <span class="pre">tree'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.factor_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the set of factors (of length <code class="docutils literal notranslate"><span class="pre">n</span></code>) of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – an integer or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – string (default: <code class="docutils literal notranslate"><span class="pre">'suffix</span> <span class="pre">tree'</span></code>), takes the
following values:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'suffix</span> <span class="pre">tree'</span></code> – construct and use the suffix tree of the word</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'naive'</span></code> – algorithm uses a sliding window</p></li>
</ul>
</li>
</ul>
<p>OUTPUT:</p>
<p>If <code class="docutils literal notranslate"><span class="pre">n</span></code> is an integer, returns the set of all distinct
factors of length <code class="docutils literal notranslate"><span class="pre">n</span></code>. If <code class="docutils literal notranslate"><span class="pre">n</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, returns the set
of all distinct factors.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;121&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">factor_set</span><span class="p">())</span>
<span class="go">[word: , word: 1, word: 12, word: 121, word: 2, word: 21]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">factor_set</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;naive&#39;</span><span class="p">))</span>
<span class="go">[word: , word: 1, word: 12, word: 121, word: 2, word: 21]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;1213121&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">length</span><span class="p">()):</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">factor_set</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="go">[word: ]</span>
<span class="go">[word: 1, word: 2, word: 3]</span>
<span class="go">[word: 12, word: 13, word: 21, word: 31]</span>
<span class="go">[word: 121, word: 131, word: 213, word: 312]</span>
<span class="go">[word: 1213, word: 1312, word: 2131, word: 3121]</span>
<span class="go">[word: 12131, word: 13121, word: 21312]</span>
<span class="go">[word: 121312, word: 213121]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">factor_set</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">[word: , word: 1, word: 12, word: 121, word: 1212, word: 12123, word: 123, word: 2, word: 21, word: 212, word: 2123, word: 23, word: 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.find">
<span class="sig-name descname"><span class="pre">find</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.find" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the index of the first occurrence of <code class="docutils literal notranslate"><span class="pre">sub</span></code> in <code class="docutils literal notranslate"><span class="pre">self</span></code>,
such that <code class="docutils literal notranslate"><span class="pre">sub</span></code> is contained within <code class="docutils literal notranslate"><span class="pre">self[start:end]</span></code>.
Return <code class="docutils literal notranslate"><span class="pre">-1</span></code> on failure.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sub</span></code> – string, list, tuple or word to search for.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">start</span></code> – non-negative integer (default: <code class="docutils literal notranslate"><span class="pre">0</span></code>) specifying
the position from which to start the search.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">end</span></code> – non-negative integer (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) specifying
the position at which the search must stop. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then
the search is performed up to the end of the string.</p></li>
</ul>
<p>OUTPUT:</p>
<p>a non-negative integer or <code class="docutils literal notranslate"><span class="pre">-1</span></code></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">1</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">sub</span></code> argument can also be a tuple or a list:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">find</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">find</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Examples using <code class="docutils literal notranslate"><span class="pre">start</span></code> and <code class="docutils literal notranslate"><span class="pre">end</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;aa&quot;</span><span class="p">)</span>
<span class="go">-1</span>
</pre></div>
</div>
<p>Instances of <code class="docutils literal notranslate"><span class="pre">Word_str</span></code> handle string inputs as well:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abac&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;ba&#39;</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.first_pos_in">
<span class="sig-name descname"><span class="pre">first_pos_in</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.first_pos_in" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the position of the first occurrence of <code class="docutils literal notranslate"><span class="pre">self</span></code> in <code class="docutils literal notranslate"><span class="pre">other</span></code>,
or <code class="docutils literal notranslate"><span class="pre">None</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is not a factor of <code class="docutils literal notranslate"><span class="pre">other</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This method is deprecated since 2020 and will be removed in a
later version of SageMath.
Use <code class="xref py py-meth docutils literal notranslate"><span class="pre">first_occurrence()</span></code> instead.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first_pos_in</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;131231&#39;</span><span class="p">))</span>
<span class="go">doctest:warning</span>
<span class="go">...</span>
<span class="go">DeprecationWarning: f.first_pos_in(w) is deprecated.</span>
<span class="go">Use w.first_occurrence(f) instead.</span>
<span class="go">See https://trac.sagemath.org/30187 for details.</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;32&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first_pos_in</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;131231&#39;</span><span class="p">))</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.foata_bijection">
<span class="sig-name descname"><span class="pre">foata_bijection</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.foata_bijection" title="Permalink to this definition">¶</a></dt>
<dd><p>Return word <code class="docutils literal notranslate"><span class="pre">self</span></code> under the Foata bijection.</p>
<p>The Foata bijection <span class="math notranslate nohighlight">\(\phi\)</span> is a bijection on the set of words
of given content (by a slight generalization of Section 2 in <a class="reference internal" href="../../../../references/index.html#fs1978" id="id16"><span>[FS1978]</span></a>).
It can be defined by induction on the size of the word: Given a word
<span class="math notranslate nohighlight">\(w_1 w_2 \cdots w_n\)</span>, start with <span class="math notranslate nohighlight">\(\phi(w_1) = w_1\)</span>. At the <span class="math notranslate nohighlight">\(i\)</span>-th step, if
<span class="math notranslate nohighlight">\(\phi(w_1 w_2 \cdots w_i) = v_1 v_2 \cdots v_i\)</span>, we define
<span class="math notranslate nohighlight">\(\phi(w_1 w_2 \cdots w_i w_{i+1})\)</span> by placing <span class="math notranslate nohighlight">\(w_{i+1}\)</span> on the end of
the word <span class="math notranslate nohighlight">\(v_1 v_2 \cdots v_i\)</span> and breaking the word up into blocks
as follows. If <span class="math notranslate nohighlight">\(w_{i+1} \ge v_i\)</span>, place a vertical line to the right
of each <span class="math notranslate nohighlight">\(v_k\)</span> for which <span class="math notranslate nohighlight">\(w_{i+1} \ge v_k\)</span>. Otherwise, if
<span class="math notranslate nohighlight">\(w_{i+1} &lt; v_i\)</span>, place a vertical line to the right of each <span class="math notranslate nohighlight">\(v_k\)</span>
for which <span class="math notranslate nohighlight">\(w_{i+1} &lt; v_k\)</span>. In either case, place a vertical line at
the start of the word as well. Now, within each block between
vertical lines, cyclically shift the entries one place to the
right.</p>
<p>For instance, to compute <span class="math notranslate nohighlight">\(\phi([4,1,5,4,2,2,3])\)</span>, the sequence of
words is</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(4\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(|4|1 \to 41\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(|4|1|5 \to 415\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(|415|4 \to 5414\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(|5|4|14|2 \to 54412\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(|5441|2|2 \to 154422\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(|1|5442|2|3 \to 1254423\)</span>.</p></li>
</ul>
<p>So <span class="math notranslate nohighlight">\(\phi([4,1,5,4,2,2,3]) = [1,2,5,4,4,2,3]\)</span>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../permutation.html#sage.combinat.permutation.Permutation.foata_bijection" title="sage.combinat.permutation.Permutation.foata_bijection"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Foata</span> <span class="pre">bijection</span> <span class="pre">on</span> <span class="pre">Permutations</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">foata_bijection</span><span class="p">()</span>
<span class="go">word: 112221</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">foata_bijection</span><span class="p">()</span>
<span class="go">word: 2122212211</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">foata_bijection</span><span class="p">()</span>
<span class="go">word: 1254423</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.good_suffix_table">
<span class="sig-name descname"><span class="pre">good_suffix_table</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.good_suffix_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a table of the maximum skip you can do in order not to miss
a possible occurrence of <code class="docutils literal notranslate"><span class="pre">self</span></code> in a word.</p>
<p>This is a part of the Boyer-Moore algorithm to find factors.
See <a class="reference internal" href="../../../../references/index.html#bm1977" id="id17"><span>[BM1977]</span></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;121321&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">good_suffix_table</span><span class="p">()</span>
<span class="go">[5, 5, 5, 5, 3, 3, 1]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;12412&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">good_suffix_table</span><span class="p">()</span>
<span class="go">[3, 3, 3, 3, 3, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.has_period">
<span class="sig-name descname"><span class="pre">has_period</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.has_period" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> has the period <code class="docutils literal notranslate"><span class="pre">p</span></code>,
<code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By convention, integers greater than the length
of <code class="docutils literal notranslate"><span class="pre">self</span></code> are periods of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – an integer to check if it is a period
of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;ababa&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">has_period</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">has_period</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">has_period</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">has_period</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">has_period</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">has_period</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.has_prefix">
<span class="sig-name descname"><span class="pre">has_prefix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.has_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether <code class="docutils literal notranslate"><span class="pre">self</span></code> has <code class="docutils literal notranslate"><span class="pre">other</span></code> as a prefix.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> – a word, or data describing a word</p></li>
</ul>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s2">&quot;abbabaabababa&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s2">&quot;abbab&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">has_prefix</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">has_prefix</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">has_prefix</span><span class="p">(</span><span class="s2">&quot;abbab&quot;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">has_prefix</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">has_prefix</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">has_prefix</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.has_suffix">
<span class="sig-name descname"><span class="pre">has_suffix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.has_suffix" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether <code class="docutils literal notranslate"><span class="pre">self</span></code> has <code class="docutils literal notranslate"><span class="pre">other</span></code> as a suffix.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some word datatype classes, like <code class="xref py py-class docutils literal notranslate"><span class="pre">WordDatatype_str</span></code>,
override this method.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> – a word, or data describing a word</p></li>
</ul>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s2">&quot;abbabaabababa&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s2">&quot;ababa&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">has_suffix</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">has_suffix</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">has_suffix</span><span class="p">(</span><span class="s2">&quot;ababa&quot;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">has_suffix</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">has_suffix</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">has_suffix</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.implicit_suffix_tree">
<span class="sig-name descname"><span class="pre">implicit_suffix_tree</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.implicit_suffix_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the implicit suffix tree of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>The <em>suffix tree</em> of a word <span class="math notranslate nohighlight">\(w\)</span> is a compactification of the
suffix trie for <span class="math notranslate nohighlight">\(w\)</span>. The compactification removes all nodes that have
exactly one incoming edge and exactly one outgoing edge. It consists of
two components: a tree and a word. Thus, instead of labelling the edges
by factors of <span class="math notranslate nohighlight">\(w\)</span>, we can label them by indices of the occurrence of
the factors in <span class="math notranslate nohighlight">\(w\)</span>.</p>
<p>Type <code class="docutils literal notranslate"><span class="pre">sage.combinat.words.suffix_trees.ImplicitSuffixTree?</span></code> for more information.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s2">&quot;cacao&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">implicit_suffix_tree</span><span class="p">()</span>
<span class="go">Implicit Suffix Tree of the word: cacao</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">implicit_suffix_tree</span><span class="p">()</span>
<span class="go">Implicit Suffix Tree of the word: 01011</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.inv_lex_less">
<span class="sig-name descname"><span class="pre">inv_lex_less</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.inv_lex_less" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is inverse lexicographically less than <code class="docutils literal notranslate"><span class="pre">other</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">inv_lex_less</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">inv_lex_less</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.inversions">
<span class="sig-name descname"><span class="pre">inversions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.inversions" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of the inversions of <code class="docutils literal notranslate"><span class="pre">self</span></code>. An inversion is a pair
<span class="math notranslate nohighlight">\((i,j)\)</span> of non-negative integers <span class="math notranslate nohighlight">\(i &lt; j\)</span> such that <code class="docutils literal notranslate"><span class="pre">self[i]</span> <span class="pre">&gt;</span> <span class="pre">self[j]</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">inversions</span><span class="p">()</span>
<span class="go">[[1, 5], [2, 3], [2, 4], [2, 5], [3, 5], [4, 5]]</span>
<span class="gp">sage: </span><span class="n">Words</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">inversions</span><span class="p">()</span>
<span class="go">[[0, 1], [0, 2], [0, 3], [0, 4], [1, 2]]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abbaba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">inversions</span><span class="p">()</span>
<span class="go">[[1, 3], [1, 5], [2, 3], [2, 5], [4, 5]]</span>
<span class="gp">sage: </span><span class="n">Words</span><span class="p">(</span><span class="s1">&#39;ba&#39;</span><span class="p">)(</span><span class="s1">&#39;abbaba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">inversions</span><span class="p">()</span>
<span class="go">[[0, 1], [0, 2], [0, 4], [3, 4]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.is_balanced">
<span class="sig-name descname"><span class="pre">is_balanced</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_balanced" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is <code class="docutils literal notranslate"><span class="pre">q</span></code>-balanced, and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>A finite or infinite word <span class="math notranslate nohighlight">\(w\)</span> is said to be <span class="math notranslate nohighlight">\(q\)</span>-<em>balanced</em> if for
any two factors <span class="math notranslate nohighlight">\(u\)</span>, <span class="math notranslate nohighlight">\(v\)</span> of <span class="math notranslate nohighlight">\(w\)</span> of the same length, the difference
between the number of <span class="math notranslate nohighlight">\(x\)</span>’s in each of <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(v\)</span> is at most <span class="math notranslate nohighlight">\(q\)</span>
for all letters <span class="math notranslate nohighlight">\(x\)</span> in the alphabet of <span class="math notranslate nohighlight">\(w\)</span>. A <span class="math notranslate nohighlight">\(1\)</span>-balanced word is
simply said to be balanced. See for instance <a class="reference internal" href="../../../../references/index.html#cfz2000" id="id18"><span>[CFZ2000]</span></a> and Chapter
2 of <a class="reference internal" href="../../../../references/index.html#lot2002" id="id19"><span>[Lot2002]</span></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">q</span></code> – integer (default: <code class="docutils literal notranslate"><span class="pre">1</span></code>), the balance level</p></li>
</ul>
<p>OUTPUT:</p>
<p>boolean – the result</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;1213121&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_balanced</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;1122&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_balanced</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;121333121&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_balanced</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;121333121&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_balanced</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;121333121&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_balanced</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;121122121&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_balanced</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;121122121&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_balanced</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.is_cadence">
<span class="sig-name descname"><span class="pre">is_cadence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_cadence" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">seq</span></code> is a cadence of <code class="docutils literal notranslate"><span class="pre">self</span></code>, and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>A <em>cadence</em> is an increasing sequence of indexes that all map to
the same letter.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;121132123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_cadence</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;121132123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_cadence</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;121132123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_cadence</span><span class="p">([])</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.is_christoffel">
<span class="sig-name descname"><span class="pre">is_christoffel</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_christoffel" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is a Christoffel word, and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>The <em>Christoffel word</em> of slope <span class="math notranslate nohighlight">\(p/q\)</span> is obtained from the Cayley
graph of <span class="math notranslate nohighlight">\(\ZZ/(p+q)\ZZ\)</span> with generator <span class="math notranslate nohighlight">\(q\)</span> as follows. If <span class="math notranslate nohighlight">\(u
\rightarrow v\)</span> is an edge in the Cayley graph, then, <span class="math notranslate nohighlight">\(v = u + p
\mod{p+q}\)</span>. Let <span class="math notranslate nohighlight">\(a\)</span>,`b` be the alphabet of <span class="math notranslate nohighlight">\(w\)</span>. Label the edge
<span class="math notranslate nohighlight">\(u \rightarrow v\)</span> by <span class="math notranslate nohighlight">\(a\)</span> if <span class="math notranslate nohighlight">\(u &lt; v\)</span> and <span class="math notranslate nohighlight">\(b\)</span> otherwise. The Christoffel
word is the word obtained by reading the edge labels along the cycle
beginning from <span class="math notranslate nohighlight">\(0\)</span>.</p>
<p>Equivalently, <span class="math notranslate nohighlight">\(w\)</span> is a Christoffel word iff <span class="math notranslate nohighlight">\(w\)</span> is a symmetric
non-empty word and <span class="math notranslate nohighlight">\(w[1:n-1]\)</span> is a palindrome.</p>
<p>See for instance <a class="reference internal" href="../../../../references/index.html#ber2007" id="id20"><span>[Ber2007]</span></a> and <a class="reference internal" href="../../../../references/index.html#blrs2009" id="id21"><span>[BLRS2009]</span></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – word</p></li>
</ul>
<p>OUTPUT:</p>
<p>boolean – <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is a Christoffel word,
<code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;00100101&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_christoffel</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;aab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_christoffel</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_christoffel</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;123123123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_christoffel</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;00100&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_christoffel</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_christoffel</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.is_conjugate_with">
<span class="sig-name descname"><span class="pre">is_conjugate_with</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_conjugate_with" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True`</span>&#160; <span class="pre">if</span> <span class="pre">``self</span></code> is a conjugate of <code class="docutils literal notranslate"><span class="pre">other</span></code>, and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> – a finite word</p></li>
</ul>
<p>OUTPUT:</p>
<p>bool</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mf">0.</span><span class="o">.</span><span class="mi">20</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mf">7.</span><span class="o">.</span><span class="mi">20</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span>
<span class="go">word: 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20</span>
<span class="gp">sage: </span><span class="n">z</span>
<span class="go">word: 7,8,9,10,11,12,13,14,15,16,17,18,19,20,0,1,2,3,4,5,6</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_conjugate_with</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">is_conjugate_with</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="mi">21</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">is_conjugate_with</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">is_conjugate_with</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Both words must be finite:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="nb">iter</span><span class="p">([</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">),</span><span class="n">length</span><span class="o">=</span><span class="s1">&#39;unknown&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">is_conjugate_with</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="c1">#TODO: Not implemented for word of unknown length</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">wf</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="nb">iter</span><span class="p">([</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">),</span><span class="n">length</span><span class="o">=</span><span class="s1">&#39;finite&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">is_conjugate_with</span><span class="p">(</span><span class="n">wf</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">wf</span><span class="o">.</span><span class="n">is_conjugate_with</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.is_cube">
<span class="sig-name descname"><span class="pre">is_cube</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is a cube, and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;012012012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_cube</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;01010101&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_cube</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_cube</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;012012&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_cube</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.is_cube_free">
<span class="sig-name descname"><span class="pre">is_cube_free</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_cube_free" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> does not contain cubes, and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;12312&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_cube_free</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;32221&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_cube_free</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_cube_free</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.is_empty">
<span class="sig-name descname"><span class="pre">is_empty</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_empty" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if the length of <code class="docutils literal notranslate"><span class="pre">self</span></code> is zero,
and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">([])</span><span class="o">.</span><span class="n">is_empty</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_empty</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.is_factor">
<span class="sig-name descname"><span class="pre">is_factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is a factor of <code class="docutils literal notranslate"><span class="pre">other</span></code>, and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>A finite word <span class="math notranslate nohighlight">\(u\in A^*\)</span> is a <em>factor</em> of a finite word <span class="math notranslate nohighlight">\(v\in A^*\)</span>
if there exists <span class="math notranslate nohighlight">\(p,s\in A^*\)</span> such that <span class="math notranslate nohighlight">\(v=pus\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;2113&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;123121332131233121132123&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">is_factor</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;321&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;1231241231312312312&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">is_factor</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>The empty word is factor of another word:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_factor</span><span class="p">(</span><span class="n">Word</span><span class="p">())</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_factor</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_factor</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_factor</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="k">lambda</span> <span class="n">n</span><span class="p">:</span><span class="n">n</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.is_finite">
<span class="sig-name descname"><span class="pre">is_finite</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_finite" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">([])</span><span class="o">.</span><span class="n">is_finite</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_finite</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.is_full">
<span class="sig-name descname"><span class="pre">is_full</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_full" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> has defect <span class="math notranslate nohighlight">\(0\)</span>, and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>A word is <em>full</em> (or <em>rich</em>) if its defect is zero (see <a class="reference internal" href="../../../../references/index.html#bhnr2004" id="id22"><span>[BHNR2004]</span></a>).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">f</span></code> is given, then the <code class="docutils literal notranslate"><span class="pre">f</span></code>-palindromic defect is used (see <a class="reference internal" href="../../../../references/index.html#pest2011" id="id23"><span>[PeSt2011]</span></a>).</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> – involution (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) on the alphabet of <code class="docutils literal notranslate"><span class="pre">self</span></code>. It must
be callable on letters as well as words (e.g. <code class="docutils literal notranslate"><span class="pre">WordMorphism</span></code>).</p></li>
</ul>
<p>OUTPUT:</p>
<p>boolean – If <code class="docutils literal notranslate"><span class="pre">f</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, whether <code class="docutils literal notranslate"><span class="pre">self</span></code> is full;
otherwise, whether <code class="docutils literal notranslate"><span class="pre">self</span></code> is full of <code class="docutils literal notranslate"><span class="pre">f</span></code>-palindromes.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">is_full</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">is_full</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;000000000000000&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_full</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;011010011001&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_full</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;2194&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_full</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_full</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_full</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;ab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_full</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_full</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_full</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_full</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>A simple example of an infinite word full of f-palindromes:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span><span class="s1">&#39;abc&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="s1">&#39;ab&#39;</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;b,b-&gt;a,c-&gt;c&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="p">(</span><span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">50</span><span class="p">])</span><span class="o">.</span><span class="n">is_full</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">p</span><span class="p">(</span><span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">150</span><span class="p">])</span><span class="o">.</span><span class="n">is_full</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.is_lyndon">
<span class="sig-name descname"><span class="pre">is_lyndon</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_lyndon" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is a Lyndon word, and <code class="docutils literal notranslate"><span class="pre">False</span></code>
otherwise.</p>
<p>A <em>Lyndon word</em> is a non-empty word that is lexicographically
smaller than each of its proper suffixes (for the given order
on its alphabet). That is, <span class="math notranslate nohighlight">\(w\)</span> is a Lyndon word if <span class="math notranslate nohighlight">\(w\)</span> is non-empty
and for each factorization <span class="math notranslate nohighlight">\(w = uv\)</span> (with <span class="math notranslate nohighlight">\(u\)</span>, <span class="math notranslate nohighlight">\(v\)</span> both non-empty),
we have <span class="math notranslate nohighlight">\(w &lt; v\)</span>.</p>
<p>Equivalently, <span class="math notranslate nohighlight">\(w\)</span> is a Lyndon word iff <span class="math notranslate nohighlight">\(w\)</span> is a non-empty word that is
lexicographically smaller than each of its proper conjugates for the
given order on its alphabet.</p>
<p>See for instance <a class="reference internal" href="../../../../references/index.html#lot1983" id="id24"><span>[Lot1983]</span></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;123132133&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_lyndon</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_lyndon</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;122112&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_lyndon</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.is_overlap">
<span class="sig-name descname"><span class="pre">is_overlap</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_overlap" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is an overlap, and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;12121&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_overlap</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_overlap</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;1231&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_overlap</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;123123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_overlap</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;1231231&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_overlap</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_overlap</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.is_palindrome">
<span class="sig-name descname"><span class="pre">is_palindrome</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_palindrome" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is a palindrome (or a <code class="docutils literal notranslate"><span class="pre">f</span></code>-palindrome), and
<code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>Let <span class="math notranslate nohighlight">\(f : \Sigma \rightarrow \Sigma\)</span> be an involution that extends
to a morphism on <span class="math notranslate nohighlight">\(\Sigma^*\)</span>. We say that <span class="math notranslate nohighlight">\(w\in\Sigma^*\)</span> is a
<em>`f`-palindrome</em> if <span class="math notranslate nohighlight">\(w=f(\tilde{w})\)</span> <a class="reference internal" href="../../../../references/index.html#lab2008" id="id25"><span>[Lab2008]</span></a>. Also called
<em>`f`-pseudo-palindrome</em> <a class="reference internal" href="../../../../references/index.html#azz2005" id="id26"><span>[AZZ2005]</span></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> – involution (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) on the alphabet of <code class="docutils literal notranslate"><span class="pre">self</span></code>.
It must be callable on letters as well as words (e.g.
<a class="reference internal" href="morphism.html#sage.combinat.words.morphism.WordMorphism" title="sage.combinat.words.morphism.WordMorphism"><code class="xref py py-class docutils literal notranslate"><span class="pre">WordMorphism</span></code></a>). The
default value corresponds to usual palindromes, i.e., <code class="docutils literal notranslate"><span class="pre">f</span></code>
equal to the identity.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;esope reste ici et se repose&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;esoperesteicietserepose&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;I saw I was I&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abbcbba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abcbdba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Some <span class="math notranslate nohighlight">\(f\)</span>-palindromes:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;aababb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;b,b-&gt;a,c-&gt;c&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abacbacbab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="s1">&#39;a&#39;</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;aababb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">8</span><span class="p">];</span> <span class="n">w</span>
<span class="go">word: 01101001</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The word must be in the domain of the involution:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;aababb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">KeyError: &#39;b&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.is_prefix">
<span class="sig-name descname"><span class="pre">is_prefix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is a prefix of <code class="docutils literal notranslate"><span class="pre">other</span></code>, and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;0123456789&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;012345&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">is_prefix</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_prefix</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_prefix</span><span class="p">(</span><span class="n">Word</span><span class="p">())</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_prefix</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_prefix</span><span class="p">(</span><span class="n">Word</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.is_primitive">
<span class="sig-name descname"><span class="pre">is_primitive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_primitive" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is primitive, and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>A finite word <span class="math notranslate nohighlight">\(w\)</span> is <em>primitive</em> if it is not a positive integer
power of a shorter word.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;1231&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;111&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.is_proper_prefix">
<span class="sig-name descname"><span class="pre">is_proper_prefix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_proper_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is a proper prefix of <code class="docutils literal notranslate"><span class="pre">other</span></code>, and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_proper_prefix</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;123&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_proper_prefix</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;12&#39;</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_proper_prefix</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;123&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_proper_prefix</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;12&#39;</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_proper_prefix</span><span class="p">(</span><span class="n">Word</span><span class="p">())</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.is_proper_suffix">
<span class="sig-name descname"><span class="pre">is_proper_suffix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_proper_suffix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is a proper suffix of <code class="docutils literal notranslate"><span class="pre">other</span></code>, and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;23&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_proper_suffix</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;123&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_proper_suffix</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;12&#39;</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_proper_suffix</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;123&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_proper_suffix</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;12&#39;</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.is_quasiperiodic">
<span class="sig-name descname"><span class="pre">is_quasiperiodic</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_quasiperiodic" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is quasiperiodic, and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>A finite or infinite word <span class="math notranslate nohighlight">\(w\)</span> is <em>quasiperiodic</em> if it can be
constructed by concatenations and superpositions of one of its proper
factors <span class="math notranslate nohighlight">\(u\)</span>, which is called a <em>quasiperiod</em> of <span class="math notranslate nohighlight">\(w\)</span>.
See for instance <a class="reference internal" href="../../../../references/index.html#ae1993" id="id27"><span>[AE1993]</span></a>, <a class="reference internal" href="../../../../references/index.html#mar2004" id="id28"><span>[Mar2004]</span></a>, and <a class="reference internal" href="../../../../references/index.html#glr2008" id="id29"><span>[GLR2008]</span></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abaababaabaababaaba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_quasiperiodic</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abacaba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_quasiperiodic</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_quasiperiodic</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_quasiperiodic</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abaaba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_quasiperiodic</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.is_rich">
<span class="sig-name descname"><span class="pre">is_rich</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_rich" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> has defect <span class="math notranslate nohighlight">\(0\)</span>, and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>A word is <em>full</em> (or <em>rich</em>) if its defect is zero (see <a class="reference internal" href="../../../../references/index.html#bhnr2004" id="id30"><span>[BHNR2004]</span></a>).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">f</span></code> is given, then the <code class="docutils literal notranslate"><span class="pre">f</span></code>-palindromic defect is used (see <a class="reference internal" href="../../../../references/index.html#pest2011" id="id31"><span>[PeSt2011]</span></a>).</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> – involution (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) on the alphabet of <code class="docutils literal notranslate"><span class="pre">self</span></code>. It must
be callable on letters as well as words (e.g. <code class="docutils literal notranslate"><span class="pre">WordMorphism</span></code>).</p></li>
</ul>
<p>OUTPUT:</p>
<p>boolean – If <code class="docutils literal notranslate"><span class="pre">f</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, whether <code class="docutils literal notranslate"><span class="pre">self</span></code> is full;
otherwise, whether <code class="docutils literal notranslate"><span class="pre">self</span></code> is full of <code class="docutils literal notranslate"><span class="pre">f</span></code>-palindromes.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">is_full</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">is_full</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;000000000000000&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_full</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;011010011001&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_full</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;2194&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_full</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_full</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_full</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;ab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_full</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_full</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_full</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_full</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>A simple example of an infinite word full of f-palindromes:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span><span class="s1">&#39;abc&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="s1">&#39;ab&#39;</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;b,b-&gt;a,c-&gt;c&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="p">(</span><span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">50</span><span class="p">])</span><span class="o">.</span><span class="n">is_full</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">p</span><span class="p">(</span><span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">150</span><span class="p">])</span><span class="o">.</span><span class="n">is_full</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.is_smooth_prefix">
<span class="sig-name descname"><span class="pre">is_smooth_prefix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_smooth_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is the prefix of a smooth word, and <code class="docutils literal notranslate"><span class="pre">False</span></code>
otherwise.</p>
<p>Let <span class="math notranslate nohighlight">\(A_k = \{1, \ldots ,k\}\)</span>, <span class="math notranslate nohighlight">\(k \geq 2\)</span>. An infinite word <span class="math notranslate nohighlight">\(w\)</span> in
<span class="math notranslate nohighlight">\(A_k^\omega\)</span> is said to be <em>smooth</em> if and only if for all positive
integers <span class="math notranslate nohighlight">\(m\)</span>, <span class="math notranslate nohighlight">\(\Delta^m(w)\)</span> is in <span class="math notranslate nohighlight">\(A_k^\omega\)</span>, where <span class="math notranslate nohighlight">\(\Delta(w)\)</span> is
the word obtained from <span class="math notranslate nohighlight">\(w\)</span> by composing the length of consecutive
runs of the same letter in <span class="math notranslate nohighlight">\(w\)</span>. See for instance <a class="reference internal" href="../../../../references/index.html#bl2003" id="id32"><span>[BL2003]</span></a> and <a class="reference internal" href="../../../../references/index.html#bdlv2006" id="id33"><span>[BDLV2006]</span></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – must be a word over the integers to get something other
than <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
</ul>
<p>OUTPUT:</p>
<p>boolean – whether <code class="docutils literal notranslate"><span class="pre">self</span></code> is a smooth prefix or not</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">is_smooth_prefix</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">is_smooth_prefix</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.is_square">
<span class="sig-name descname"><span class="pre">is_square</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_square" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is a square, and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;1212&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;1213&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;12123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.is_square_free">
<span class="sig-name descname"><span class="pre">is_square_free</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_square_free" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> does not contain squares, and <code class="docutils literal notranslate"><span class="pre">False</span></code>
otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;12312&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_square_free</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;31212&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_square_free</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_square_free</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.is_sturmian_factor">
<span class="sig-name descname"><span class="pre">is_sturmian_factor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_sturmian_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Tell whether <code class="docutils literal notranslate"><span class="pre">self</span></code> is a factor of a Sturmian word.</p>
<p>The finite word <code class="docutils literal notranslate"><span class="pre">self</span></code> must be defined on a two-letter alphabet.</p>
<p>Equivalently, tells whether <code class="docutils literal notranslate"><span class="pre">self</span></code> is balanced. The
advantage over the <code class="docutils literal notranslate"><span class="pre">is_balanced</span></code> method is that this one runs in
linear time whereas <code class="docutils literal notranslate"><span class="pre">is_balanced</span></code> runs in quadratic time.</p>
<p>OUTPUT:</p>
<p>boolean – the result</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;0111011011011101101&#39;</span><span class="p">,</span><span class="n">alphabet</span><span class="o">=</span><span class="s1">&#39;01&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_sturmian_factor</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">LowerMechanicalWord</span><span class="p">(</span><span class="n">random</span><span class="p">(),</span><span class="n">alphabet</span><span class="o">=</span><span class="s1">&#39;01&#39;</span><span class="p">)[:</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">is_sturmian_factor</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">CharacteristicSturmianWord</span><span class="p">(</span><span class="n">random</span><span class="p">())[:</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">is_sturmian_factor</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;aabb&#39;</span><span class="p">,</span><span class="n">alphabet</span><span class="o">=</span><span class="s1">&#39;ab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_sturmian_factor</span><span class="p">()</span>
<span class="go">False</span>

<span class="gp">sage: </span><span class="n">s1</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ab,b-&gt;b&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s2</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ba,b-&gt;b&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s3</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;a,b-&gt;ba&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s4</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;a,b-&gt;ab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s1">&#39;ab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="s1">&#39;ab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span> <span class="n">w</span> <span class="o">=</span> <span class="n">choice</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">,</span><span class="n">s3</span><span class="p">,</span><span class="n">s4</span><span class="p">])(</span><span class="n">w</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_sturmian_factor</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Famous words:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">is_sturmian_factor</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">1000</span><span class="p">]</span><span class="o">.</span><span class="n">is_sturmian_factor</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">KolakoskiWord</span><span class="p">()[:</span><span class="mi">1000</span><span class="p">]</span><span class="o">.</span><span class="n">is_sturmian_factor</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="../../../../references/index.html#arn2002" id="id34"><span>[Arn2002]</span></a>, <a class="reference internal" href="../../../../references/index.html#ser1985" id="id35"><span>[Ser1985]</span></a>, and <a class="reference internal" href="../../../../references/index.html#su2009" id="id36"><span>[SU2009]</span></a>.</p>
<p>AUTHOR:</p>
<ul class="simple">
<li><p>Thierry Monteil</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.is_subword_of">
<span class="sig-name descname"><span class="pre">is_subword_of</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_subword_of" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is a subword of <code class="docutils literal notranslate"><span class="pre">other</span></code>, and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>A finite word <span class="math notranslate nohighlight">\(u\)</span> is a <em>subword</em> of a finite word <span class="math notranslate nohighlight">\(v\)</span> if <span class="math notranslate nohighlight">\(u\)</span> is a
subsequence of <span class="math notranslate nohighlight">\(v\)</span>. See Chapter 6 on Subwords in <a class="reference internal" href="../../../../references/index.html#lot1997" id="id37"><span>[Lot1997]</span></a>.</p>
<p>Some references define subword as a consecutive subsequence. Use
<a class="reference internal" href="#sage.combinat.words.finite_word.FiniteWord_class.is_factor" title="sage.combinat.words.finite_word.FiniteWord_class.is_factor"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_factor()</span></code></a> if this is what you need.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">other</span></code> – a finite word</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;bb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_subword_of</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;ababa&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;bbb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_subword_of</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;ababa&#39;</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_subword_of</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;123&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_subword_of</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;3211333213233321&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;321&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_subword_of</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;11122212112122133111222332&#39;</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.combinat.words.finite_word.FiniteWord_class.longest_common_subword" title="sage.combinat.words.finite_word.FiniteWord_class.longest_common_subword"><code class="xref py py-meth docutils literal notranslate"><span class="pre">longest_common_subword()</span></code></a>
<a class="reference internal" href="#sage.combinat.words.finite_word.FiniteWord_class.number_of_subword_occurrences" title="sage.combinat.words.finite_word.FiniteWord_class.number_of_subword_occurrences"><code class="xref py py-meth docutils literal notranslate"><span class="pre">number_of_subword_occurrences()</span></code></a>
<a class="reference internal" href="#sage.combinat.words.finite_word.FiniteWord_class.is_factor" title="sage.combinat.words.finite_word.FiniteWord_class.is_factor"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_factor()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.is_suffix">
<span class="sig-name descname"><span class="pre">is_suffix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_suffix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is a suffix of <code class="docutils literal notranslate"><span class="pre">other</span></code>, and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;0123456789&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;56789&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">is_suffix</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_suffix</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;579&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_suffix</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_suffix</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_suffix</span><span class="p">(</span><span class="n">Word</span><span class="p">())</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">is_suffix</span><span class="p">(</span><span class="n">Word</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.is_symmetric">
<span class="sig-name descname"><span class="pre">is_symmetric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_symmetric" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is symmetric (or <code class="docutils literal notranslate"><span class="pre">f</span></code>-symmetric), and
<code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>A word is <em>symmetric</em> (resp. <span class="math notranslate nohighlight">\(f\)</span>-<em>symmetric</em>) if it is the
product of two palindromes (resp. <span class="math notranslate nohighlight">\(f\)</span>-palindromes).
See <a class="reference internal" href="../../../../references/index.html#bhnr2004" id="id38"><span>[BHNR2004]</span></a> and <a class="reference internal" href="../../../../references/index.html#deluca2006" id="id39"><span>[DeLuca2006]</span></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> – involution (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) on the alphabet of <code class="docutils literal notranslate"><span class="pre">self</span></code>. It must
be callable on letters as well as words (e.g. <code class="docutils literal notranslate"><span class="pre">WordMorphism</span></code>).</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abbabab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_symmetric</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;ababa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_symmetric</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;aababaabba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_symmetric</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;aabbbaababba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_symmetric</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;aabbbaababba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_symmetric</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.is_tangent">
<span class="sig-name descname"><span class="pre">is_tangent</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_tangent" title="Permalink to this definition">¶</a></dt>
<dd><p>Tell whether <code class="docutils literal notranslate"><span class="pre">self</span></code> is a tangent word.</p>
<p>The finite word <code class="docutils literal notranslate"><span class="pre">self</span></code> must be defined on a two-letter alphabet.</p>
<p>A binary word is said to be <em>tangent</em> if it can appear in
infinitely many cutting sequences of a smooth curve, where each
cutting sequence is observed on a progressively smaller grid.</p>
<p>This class of words strictly contains the class of <span class="math notranslate nohighlight">\(1\)</span>-balanced
words, and is strictly contained in the class of <span class="math notranslate nohighlight">\(2\)</span>-balanced words.</p>
<p>This method runs in linear time.</p>
<p>OUTPUT:</p>
<p>boolean – the result</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;01110110110111011101&#39;</span><span class="p">,</span><span class="n">alphabet</span><span class="o">=</span><span class="s1">&#39;01&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_tangent</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Some tangent words may not be balanced:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;aabb&#39;</span><span class="p">,</span><span class="n">alphabet</span><span class="o">=</span><span class="s1">&#39;ab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_balanced</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;aabb&#39;</span><span class="p">,</span><span class="n">alphabet</span><span class="o">=</span><span class="s1">&#39;ab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_tangent</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Some <span class="math notranslate nohighlight">\(2\)</span>-balanced words may not be tangent:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;aaabb&#39;</span><span class="p">,</span><span class="n">alphabet</span><span class="o">=</span><span class="s1">&#39;ab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_tangent</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;aaabb&#39;</span><span class="p">,</span><span class="n">alphabet</span><span class="o">=</span><span class="s1">&#39;ab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_balanced</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Famous words:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">is_tangent</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">1000</span><span class="p">]</span><span class="o">.</span><span class="n">is_tangent</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">KolakoskiWord</span><span class="p">()[:</span><span class="mi">1000</span><span class="p">]</span><span class="o">.</span><span class="n">is_tangent</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="../../../../references/index.html#mon2010" id="id40"><span>[Mon2010]</span></a>.</p>
<p>AUTHOR:</p>
<ul class="simple">
<li><p>Thierry Monteil</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.is_yamanouchi">
<span class="sig-name descname"><span class="pre">is_yamanouchi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.is_yamanouchi" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether <code class="docutils literal notranslate"><span class="pre">self</span></code> is Yamanouchi.</p>
<p>A word <span class="math notranslate nohighlight">\(w\)</span> is Yamanouchi if, when read from right to left, it
always has weakly more <span class="math notranslate nohighlight">\(i\)</span>’s than <span class="math notranslate nohighlight">\(i+1\)</span>’s for all <span class="math notranslate nohighlight">\(i\)</span> that
appear in <span class="math notranslate nohighlight">\(w\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – (optional) an integer specifying the maximal
letter in the alphabet</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_yamanouchi</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_yamanouchi</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_yamanouchi</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_yamanouchi</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">alphabet</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_yamanouchi</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_yamanouchi</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.iterated_left_palindromic_closure">
<span class="sig-name descname"><span class="pre">iterated_left_palindromic_closure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.iterated_left_palindromic_closure" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the iterated left (<code class="docutils literal notranslate"><span class="pre">f</span></code>-)palindromic closure of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> – involution (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) on the alphabet of <code class="docutils literal notranslate"><span class="pre">self</span></code>.
It must be callable on letters as well as words (e.g. <code class="docutils literal notranslate"><span class="pre">WordMorphism</span></code>).</p></li>
</ul>
<p>OUTPUT:</p>
<p>word – the left iterated <code class="docutils literal notranslate"><span class="pre">f</span></code>-palindromic closure of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">iterated_left_palindromic_closure</span><span class="p">()</span>
<span class="go">word: 3231323</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;ab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">iterated_left_palindromic_closure</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<span class="go">word: abbaab</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;aab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">iterated_left_palindromic_closure</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<span class="go">word: abbaabbaab</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.lacunas">
<span class="sig-name descname"><span class="pre">lacunas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.lacunas" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of all the lacunas of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>A <em>lacuna</em> is a position in a word where the longest (<span class="math notranslate nohighlight">\(f\)</span>-)palindromic
suffix is not unioccurrent (see <a class="reference internal" href="../../../../references/index.html#bmbl2008" id="id41"><span>[BMBL2008]</span></a>).</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> – involution (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) on the alphabet of <code class="docutils literal notranslate"><span class="pre">self</span></code>. It must
be callable on letters as well as words (e.g. <code class="docutils literal notranslate"><span class="pre">WordMorphism</span></code>). The
default value corresponds to usual palindromes, i.e., <code class="docutils literal notranslate"><span class="pre">f</span></code> equal to
the identity.</p></li>
</ul>
<p>OUTPUT:</p>
<p>a list – list of all the lacunas of self</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">lacunas</span><span class="p">()</span>
<span class="go">[7, 9]</span>
<span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">lacunas</span><span class="p">()</span>
<span class="go">[8, 9, 24, 25, 32, 33, 34, 35, 36, 37, 38, 39, 96, 97, 98, 99]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">50</span><span class="p">]</span><span class="o">.</span><span class="n">lacunas</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">[0, 2, 4, 12, 16, 17, 18, 19, 48, 49]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.last_position_dict">
<span class="sig-name descname"><span class="pre">last_position_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.last_position_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary that contains the last position of each letter
in <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;1231232&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">last_position_dict</span><span class="p">()</span>
<span class="go">{&#39;1&#39;: 3, &#39;2&#39;: 6, &#39;3&#39;: 5}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.left_special_factors">
<span class="sig-name descname"><span class="pre">left_special_factors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.left_special_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the left special factors (of length <code class="docutils literal notranslate"><span class="pre">n</span></code>).</p>
<p>A factor <span class="math notranslate nohighlight">\(u\)</span> of a word <span class="math notranslate nohighlight">\(w\)</span> is <em>left special</em> if there are
two distinct letters <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> such that <span class="math notranslate nohighlight">\(au\)</span> and <span class="math notranslate nohighlight">\(bu\)</span>
are factors of <span class="math notranslate nohighlight">\(w\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – integer (optional, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>). If <code class="docutils literal notranslate"><span class="pre">None</span></code>, it
returns all left special factors.</p></li>
</ul>
<p>OUTPUT:</p>
<p>a list of words</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="mf">0.54</span><span class="p">,</span> <span class="mf">0.294</span><span class="p">,</span> <span class="mf">0.1415</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">CodingOfRotationWord</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">)[:</span><span class="mi">40</span><span class="p">]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;{} {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">left_special_factors</span><span class="p">(</span><span class="n">i</span><span class="p">))))</span>
<span class="go">0 [word: ]</span>
<span class="go">1 [word: 0]</span>
<span class="go">2 [word: 00, word: 01]</span>
<span class="go">3 [word: 000, word: 010]</span>
<span class="go">4 [word: 0000, word: 0101]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.left_special_factors_iterator">
<span class="sig-name descname"><span class="pre">left_special_factors_iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.left_special_factors_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an iterator over the left special factors (of length <code class="docutils literal notranslate"><span class="pre">n</span></code>).</p>
<p>A factor <span class="math notranslate nohighlight">\(u\)</span> of a word <span class="math notranslate nohighlight">\(w\)</span> is <em>left special</em> if there are
two distinct letters <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> such that <span class="math notranslate nohighlight">\(au\)</span> and <span class="math notranslate nohighlight">\(bu\)</span>
are factors of <span class="math notranslate nohighlight">\(w\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – integer (optional, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>). If <code class="docutils literal notranslate"><span class="pre">None</span></code>, it returns
an iterator over all left special factors.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="mf">0.54</span><span class="p">,</span> <span class="mf">0.294</span><span class="p">,</span> <span class="mf">0.1415</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">CodingOfRotationWord</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">)[:</span><span class="mi">40</span><span class="p">]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">left_special_factors_iterator</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">[word: 000, word: 010]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">left_special_factors_iterator</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="go">[word: 0000, word: 0101]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">left_special_factors_iterator</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">[word: 00000, word: 01010]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.length">
<span class="sig-name descname"><span class="pre">length</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.length" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the length of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.length_border">
<span class="sig-name descname"><span class="pre">length_border</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.length_border" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the length of the border of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>The <em>border</em> of a word is the longest word that is both a proper
prefix and a proper suffix of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;121&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">length_border</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">length_border</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;1212&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">length_border</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;111&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">length_border</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">length_border</span><span class="p">()</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.length_maximal_palindrome">
<span class="sig-name descname"><span class="pre">length_maximal_palindrome</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.length_maximal_palindrome" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the length of the longest palindrome centered at position <code class="docutils literal notranslate"><span class="pre">j</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">j</span></code> – rational, position of the symmetry axis of the palindrome.
Must return an integer when doubled. It is an integer when the
center of the palindrome is a letter.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> – integer (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>), minimal length of palindrome, if known.
The parity of <code class="docutils literal notranslate"><span class="pre">m</span></code> can’t be the same as the parity of <code class="docutils literal notranslate"><span class="pre">2j</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> – involution (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>), on the alphabet. It must be
callable on letters as well as words (e.g. <code class="docutils literal notranslate"><span class="pre">WordMorphism</span></code>).</p></li>
</ul>
<p>OUTPUT:</p>
<p>length of the longest <code class="docutils literal notranslate"><span class="pre">f</span></code>-palindrome centered at position <code class="docutils literal notranslate"><span class="pre">j</span></code></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;01001010&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">length_maximal_palindrome</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;01101001&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">length_maximal_palindrome</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;01010&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">length_maximal_palindrome</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="s1">&#39;0-&gt;1,1-&gt;0&#39;</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;01010&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">length_maximal_palindrome</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="s1">&#39;0-&gt;1,1-&gt;0&#39;</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;0222220&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">length_maximal_palindrome</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="s1">&#39;0-&gt;1,1-&gt;0,2-&gt;2&#39;</span><span class="p">)</span>
<span class="go">5</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abcdcbaxyzzyx&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">length_maximal_palindrome</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">length_maximal_palindrome</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">length_maximal_palindrome</span><span class="p">(</span><span class="mf">3.5</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">length_maximal_palindrome</span><span class="p">(</span><span class="mf">9.5</span><span class="p">)</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">length_maximal_palindrome</span><span class="p">(</span><span class="mf">9.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">6</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.lengths_maximal_palindromes">
<span class="sig-name descname"><span class="pre">lengths_maximal_palindromes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.lengths_maximal_palindromes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the length of maximal palindromes centered at each position.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> – involution (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) on the alphabet of <code class="docutils literal notranslate"><span class="pre">self</span></code>. It must
be callable on letters as well as words (e.g. <code class="docutils literal notranslate"><span class="pre">WordMorphism</span></code>).</p></li>
</ul>
<p>OUTPUT:</p>
<p>a list – The length of the maximal palindrome (or <code class="docutils literal notranslate"><span class="pre">f</span></code>-palindrome)
with a given symmetry axis (letter or space between two letters).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;01101001&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lengths_maximal_palindromes</span><span class="p">()</span>
<span class="go">[0, 1, 0, 1, 4, 1, 0, 3, 0, 3, 0, 1, 4, 1, 0, 1, 0]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;00000&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lengths_maximal_palindromes</span><span class="p">()</span>
<span class="go">[0, 1, 2, 3, 4, 5, 4, 3, 2, 1, 0]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lengths_maximal_palindromes</span><span class="p">()</span>
<span class="go">[0, 1, 0]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lengths_maximal_palindromes</span><span class="p">()</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">lengths_maximal_palindromes</span><span class="p">()</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abbabaab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lengths_maximal_palindromes</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">[0, 0, 2, 0, 0, 0, 2, 0, 8, 0, 2, 0, 0, 0, 2, 0, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.lengths_unioccurrent_lps">
<span class="sig-name descname"><span class="pre">lengths_unioccurrent_lps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.lengths_unioccurrent_lps" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of the lengths of the unioccurrent longest
(<code class="docutils literal notranslate"><span class="pre">f</span></code>)-palindromic suffixes (lps) for each non-empty prefix of <code class="docutils literal notranslate"><span class="pre">self.</span></code> No
unioccurrent lps are indicated by <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>It corresponds to the function <span class="math notranslate nohighlight">\(H_w\)</span> defined in <a class="reference internal" href="../../../../references/index.html#bmbl2008" id="id42"><span>[BMBL2008]</span></a> and <a class="reference internal" href="../../../../references/index.html#bmbflr2008" id="id43"><span>[BMBFLR2008]</span></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> – involution (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) on the alphabet of <code class="docutils literal notranslate"><span class="pre">self</span></code>. It must
be callable on letters as well as words (e.g. <code class="docutils literal notranslate"><span class="pre">WordMorphism</span></code>). The
default value corresponds to usual palindromes, i.e., <code class="docutils literal notranslate"><span class="pre">f</span></code> equal to
the identity.</p></li>
</ul>
<p>OUTPUT:</p>
<p>a list – list of the length of the unioccurrent longest palindromic
suffix (lps) for each non-empty prefix of <code class="docutils literal notranslate"><span class="pre">self</span></code>.
No unioccurrent lps are indicated by <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">lengths_unioccurrent_lps</span><span class="p">()</span>
<span class="go">[1, 1, 2, 1, 1, 1, 1, None, 1, None]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">20</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">lengths_unioccurrent_lps</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span><span class="o">.</span><span class="n">lps_lengths</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">t</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">lengths_unioccurrent_lps</span><span class="p">()</span>
<span class="go">[1, 1, 2, 4, 3, 3, 2, 4, None, None, 6, 8, 10, 12, 14, 16, 6, 8, 10, 12]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">t</span><span class="p">[:</span><span class="mi">15</span><span class="p">]</span><span class="o">.</span><span class="n">lengths_unioccurrent_lps</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">[None, 2, None, 2, None, 4, 6, 8, 4, 6, 4, 6, None, 4, 6]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.letters">
<span class="sig-name descname"><span class="pre">letters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.letters" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of letters that appear in this word, listed in the
order of first appearance.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">letters</span><span class="p">()</span>
<span class="go">[0, 1]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s2">&quot;cacao&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">letters</span><span class="p">()</span>
<span class="go">[&#39;c&#39;, &#39;a&#39;, &#39;o&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.longest_backward_extension">
<span class="sig-name descname"><span class="pre">longest_backward_extension</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.longest_backward_extension" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the length of the longest factor of <code class="docutils literal notranslate"><span class="pre">self</span></code> that
ends at <code class="docutils literal notranslate"><span class="pre">x</span></code> and that matches a factor that ends at <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code> – positions in <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;0011001&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">longest_backward_extension</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">longest_backward_extension</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">longest_backward_extension</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>The method also accepts negative positions indicating the distance from
the end of the word (in order to be consist with how negative indices
work with lists). For instance, for a word of length <span class="math notranslate nohighlight">\(7\)</span>, using
positions <span class="math notranslate nohighlight">\(6\)</span> and <span class="math notranslate nohighlight">\(-5\)</span> is the same as using positions <span class="math notranslate nohighlight">\(6\)</span> and <span class="math notranslate nohighlight">\(2\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">longest_backward_extension</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">longest_backward_extension</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.longest_common_subword">
<span class="sig-name descname"><span class="pre">longest_common_subword</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.longest_common_subword" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a longest subword of <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">other</span></code>.</p>
<p>A subword of a word is a subset of the word’s letters, read in the
order in which they appear in the word.</p>
<p>For more information, see
<a class="reference external" href="https://en.wikipedia.org/wiki/Longest_common_subsequence_problem">Wikipedia article Longest_common_subsequence_problem</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> – a word</p></li>
</ul>
<p>ALGORITHM:</p>
<p>For any indices <span class="math notranslate nohighlight">\(i,j\)</span>, we compute the longest common subword <code class="docutils literal notranslate"><span class="pre">lcs[i,j]</span></code> of
<code class="docutils literal notranslate"><span class="pre">self[:i]</span></code> and <code class="docutils literal notranslate"><span class="pre">other[:j]</span></code>. This can be easily obtained as the longest
of</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">lcs[i-1,j]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lcs[i,j-1]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lcs[i-1,j-1]+self[i]</span></code> if <code class="docutils literal notranslate"><span class="pre">self[i]==other[j]</span></code></p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v1</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s2">&quot;abc&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v2</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s2">&quot;ace&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v1</span><span class="o">.</span><span class="n">longest_common_subword</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span>
<span class="go">word: ac</span>

<span class="gp">sage: </span><span class="n">w1</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s2">&quot;1010101010101010101010101010101010101010&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w2</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s2">&quot;0011001100110011001100110011001100110011&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w1</span><span class="o">.</span><span class="n">longest_common_subword</span><span class="p">(</span><span class="n">w2</span><span class="p">)</span>
<span class="go">word: 00110011001100110011010101010</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.combinat.words.finite_word.FiniteWord_class.is_subword_of" title="sage.combinat.words.finite_word.FiniteWord_class.is_subword_of"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_subword_of()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.longest_common_suffix">
<span class="sig-name descname"><span class="pre">longest_common_suffix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.longest_common_suffix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the longest common suffix of <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">other</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;112345678&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;1115678&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">longest_common_suffix</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">word: 5678</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">longest_common_suffix</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">word: 1115678</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">longest_common_suffix</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">word: 5678</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">longest_common_suffix</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">word: 112345678</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;549332345&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">longest_common_suffix</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">word:</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.longest_forward_extension">
<span class="sig-name descname"><span class="pre">longest_forward_extension</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.longest_forward_extension" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the length of the longest factor of <code class="docutils literal notranslate"><span class="pre">self</span></code> that
starts at <code class="docutils literal notranslate"><span class="pre">x</span></code> and that matches a factor that starts at <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code> – positions in <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;0011001&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">longest_forward_extension</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">longest_forward_extension</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>The method also accepts negative positions indicating the distance from
the end of the word (in order to be consist with how negative indices
work with lists). For instance, for a word of length <span class="math notranslate nohighlight">\(7\)</span>, using
positions <span class="math notranslate nohighlight">\(-3\)</span> and <span class="math notranslate nohighlight">\(2\)</span> is the same as using positions <span class="math notranslate nohighlight">\(4\)</span> and <span class="math notranslate nohighlight">\(2\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">longest_forward_extension</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">longest_forward_extension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.lps">
<span class="sig-name descname"><span class="pre">lps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.lps" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the longest palindromic (or <code class="docutils literal notranslate"><span class="pre">f</span></code>-palindromic) suffix of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> – involution (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) on the alphabet of <code class="docutils literal notranslate"><span class="pre">self</span></code>.
It must be callable on letters as well as words (e.g. <code class="docutils literal notranslate"><span class="pre">WordMorphism</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">l</span></code> – integer (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) the length of the longest
palindrome suffix of <code class="docutils literal notranslate"><span class="pre">``self[:-1]``</span></code>, if known.</p></li>
</ul>
<p>OUTPUT:</p>
<p>word – If <code class="docutils literal notranslate"><span class="pre">f</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the longest palindromic suffix of <code class="docutils literal notranslate"><span class="pre">self</span></code>;
otherwise, the longest <code class="docutils literal notranslate"><span class="pre">f</span></code>-palindromic suffix of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;0111&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lps</span><span class="p">()</span>
<span class="go">word: 111</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;011101&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lps</span><span class="p">()</span>
<span class="go">word: 101</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;6667&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lps</span><span class="p">()</span>
<span class="go">word: 7</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abbabaab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lps</span><span class="p">()</span>
<span class="go">word: baab</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">lps</span><span class="p">()</span>
<span class="go">word:</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abbabaab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lps</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<span class="go">word: abbabaab</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;33412321&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">lps</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">word: 12321</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">Word</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Y</span><span class="p">(</span><span class="s1">&#39;01101001&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">lps</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">word: 1001</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">lps</span><span class="p">()</span>
<span class="go">word: 1001</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">lps</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="go">word: 1001</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="p">()</span><span class="o">.</span><span class="n">lps</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">IndexError: list index out of range</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abbabaab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pal</span> <span class="o">=</span> <span class="n">v</span><span class="p">[:</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">length</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">....: </span>  <span class="n">pal</span> <span class="o">=</span> <span class="n">v</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">lps</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="n">pal</span><span class="o">.</span><span class="n">length</span><span class="p">())</span>
<span class="gp">....: </span>  <span class="n">pal</span>
<span class="go">word: a</span>
<span class="go">word: b</span>
<span class="go">word: bb</span>
<span class="go">word: abba</span>
<span class="go">word: bab</span>
<span class="go">word: aba</span>
<span class="go">word: aa</span>
<span class="go">word: baab</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abbabaab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pal</span> <span class="o">=</span> <span class="n">v</span><span class="p">[:</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">length</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">....: </span>  <span class="n">pal</span> <span class="o">=</span> <span class="n">v</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">lps</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="n">pal</span><span class="o">.</span><span class="n">length</span><span class="p">())</span>
<span class="gp">....: </span>  <span class="n">pal</span>
<span class="go">word:</span>
<span class="go">word: ab</span>
<span class="go">word:</span>
<span class="go">word: ba</span>
<span class="go">word: ab</span>
<span class="go">word: baba</span>
<span class="go">word: bbabaa</span>
<span class="go">word: abbabaab</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.lps_lengths">
<span class="sig-name descname"><span class="pre">lps_lengths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.lps_lengths" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the length of the longest palindromic suffix of each prefix.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> – involution (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) on the alphabet of <code class="docutils literal notranslate"><span class="pre">self</span></code>. It must
be callable on letters as well as words (e.g. <code class="docutils literal notranslate"><span class="pre">WordMorphism</span></code>).</p></li>
</ul>
<p>OUTPUT:</p>
<p>a list – The length of the longest palindromic (or <code class="docutils literal notranslate"><span class="pre">f</span></code>-palindromic)
suffix of each prefix of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;01101001&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lps_lengths</span><span class="p">()</span>
<span class="go">[0, 1, 1, 2, 4, 3, 3, 2, 4]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;00000&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lps_lengths</span><span class="p">()</span>
<span class="go">[0, 1, 2, 3, 4, 5]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lps_lengths</span><span class="p">()</span>
<span class="go">[0, 1]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lps_lengths</span><span class="p">()</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">lps_lengths</span><span class="p">()</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abbabaab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lps_lengths</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">[0, 0, 2, 0, 2, 2, 4, 6, 8]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.lyndon_factorization">
<span class="sig-name descname"><span class="pre">lyndon_factorization</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.lyndon_factorization" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Lyndon factorization of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>The <em>Lyndon factorization</em> of a finite word <span class="math notranslate nohighlight">\(w\)</span> is the unique
factorization of <span class="math notranslate nohighlight">\(w\)</span> as a non-increasing product of Lyndon words,
i.e., <span class="math notranslate nohighlight">\(w = l_1\cdots l_n\)</span> where each <span class="math notranslate nohighlight">\(l_i\)</span> is a Lyndon word and
<span class="math notranslate nohighlight">\(l_1\geq \cdots \geq l_n\)</span>. See for instance <a class="reference internal" href="../../../../references/index.html#duv1983" id="id44"><span>[Duv1983]</span></a>.</p>
<p>OUTPUT:</p>
<p>the list <span class="math notranslate nohighlight">\([l_1, \ldots, l_n]\)</span> of factors obtained</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;010010010001000&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lyndon_factorization</span><span class="p">()</span>
<span class="go">(01, 001, 001, 0001, 0, 0, 0)</span>
<span class="gp">sage: </span><span class="n">Words</span><span class="p">(</span><span class="s1">&#39;10&#39;</span><span class="p">)(</span><span class="s1">&#39;010010010001000&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lyndon_factorization</span><span class="p">()</span>
<span class="go">(0, 10010010001000)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abbababbaababba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lyndon_factorization</span><span class="p">()</span>
<span class="go">(abb, ababb, aababb, a)</span>
<span class="gp">sage: </span><span class="n">Words</span><span class="p">(</span><span class="s1">&#39;ba&#39;</span><span class="p">)(</span><span class="s1">&#39;abbababbaababba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lyndon_factorization</span><span class="p">()</span>
<span class="go">(a, bbababbaaba, bba)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">lyndon_factorization</span><span class="p">()</span>
<span class="go">(1213, 12, 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.major_index">
<span class="sig-name descname"><span class="pre">major_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">final_descent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.major_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the major index of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>The major index of a word <span class="math notranslate nohighlight">\(w\)</span> is the sum of the descents of <span class="math notranslate nohighlight">\(w\)</span>.</p>
<p>With the <code class="docutils literal notranslate"><span class="pre">final_descent</span></code> option, the last position of a
non-empty word is also considered as a descent.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../permutation.html#sage.combinat.permutation.Permutation.major_index" title="sage.combinat.permutation.Permutation.major_index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">major</span> <span class="pre">index</span> <span class="pre">on</span> <span class="pre">Permutations</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">major_index</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">major_index</span><span class="p">(</span><span class="n">final_descent</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">10</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.minimal_conjugate">
<span class="sig-name descname"><span class="pre">minimal_conjugate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.minimal_conjugate" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the lexicographically minimal conjugate of this word (see
<a class="reference external" href="https://en.wikipedia.org/wiki/Lexicographically_minimal_string_rotation">Wikipedia article Lexicographically_minimal_string_rotation</a>).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;213&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">minimal_conjugate</span><span class="p">()</span>
<span class="go">word: 132</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;11&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">minimal_conjugate</span><span class="p">()</span>
<span class="go">word: 11</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;12112&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">minimal_conjugate</span><span class="p">()</span>
<span class="go">word: 11212</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;211&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">minimal_conjugate</span><span class="p">()</span>
<span class="go">word: 112</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;211211211&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">minimal_conjugate</span><span class="p">()</span>
<span class="go">word: 112112112</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.minimal_period">
<span class="sig-name descname"><span class="pre">minimal_period</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.minimal_period" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the period of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>Let <span class="math notranslate nohighlight">\(A\)</span> be an alphabet. An integer <span class="math notranslate nohighlight">\(p\geq 1\)</span> is a <em>period</em> of a
word <span class="math notranslate nohighlight">\(w=a_1a_2\cdots a_n\)</span> where <span class="math notranslate nohighlight">\(a_i\in A\)</span> if <span class="math notranslate nohighlight">\(a_i=a_{i+p}\)</span> for
<span class="math notranslate nohighlight">\(i=1,\ldots,n-p\)</span>. The smallest period of <span class="math notranslate nohighlight">\(w\)</span> is called <em>the</em>
period of <span class="math notranslate nohighlight">\(w\)</span>. See Chapter 1 of <a class="reference internal" href="../../../../references/index.html#lot2002" id="id45"><span>[Lot2002]</span></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;aba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">minimal_period</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">minimal_period</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;ababa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">minimal_period</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;ababaa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">minimal_period</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;ababac&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">minimal_period</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;aaaaaa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">minimal_period</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">minimal_period</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">minimal_period</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.nb_factor_occurrences_in">
<span class="sig-name descname"><span class="pre">nb_factor_occurrences_in</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.nb_factor_occurrences_in" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of times <code class="docutils literal notranslate"><span class="pre">self</span></code> appears as a factor
in <code class="docutils literal notranslate"><span class="pre">other</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This method is deprecated since 2020 and will be removed in a
later version of SageMath.
Use <a class="reference internal" href="#sage.combinat.words.finite_word.FiniteWord_class.number_of_factor_occurrences" title="sage.combinat.words.finite_word.FiniteWord_class.number_of_factor_occurrences"><code class="xref py py-meth docutils literal notranslate"><span class="pre">number_of_factor_occurrences()</span></code></a> instead.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">nb_factor_occurrences_in</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;112332312313112332121123&#39;</span><span class="p">))</span>
<span class="go">doctest:warning</span>
<span class="go">...</span>
<span class="go">DeprecationWarning: f.nb_factor_occurrences_in(w) is deprecated.</span>
<span class="go">Use w.number_of_factor_occurrences(f) instead.</span>
<span class="go">See https://trac.sagemath.org/30187 for details.</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;321&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">nb_factor_occurrences_in</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;11233231231311233221123&#39;</span><span class="p">))</span>
<span class="go">0</span>
</pre></div>
</div>
<p>An error is raised for the empty word:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">nb_factor_occurrences_in</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;123&#39;</span><span class="p">))</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError: The factor must be non empty</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.nb_subword_occurrences_in">
<span class="sig-name descname"><span class="pre">nb_subword_occurrences_in</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.nb_subword_occurrences_in" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of times <code class="docutils literal notranslate"><span class="pre">self</span></code> appears in <code class="docutils literal notranslate"><span class="pre">other</span></code> as a subword.</p>
<p>This corresponds to the notion of <span class="math notranslate nohighlight">\(binomial coefficient\)</span> of two
finite words whose properties are presented in the chapter of
Lothaire’s book written by Sakarovitch and Simon <a class="reference internal" href="../../../../references/index.html#lot1997" id="id46"><span>[Lot1997]</span></a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This method is deprecated since 2020 and will be removed in a
later version of SageMath.
Use <a class="reference internal" href="#sage.combinat.words.finite_word.FiniteWord_class.number_of_subword_occurrences" title="sage.combinat.words.finite_word.FiniteWord_class.number_of_subword_occurrences"><code class="xref py py-meth docutils literal notranslate"><span class="pre">number_of_subword_occurrences()</span></code></a> instead.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> – finite word</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">tm</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()</span>

<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">nb_subword_occurrences_in</span><span class="p">(</span><span class="n">tm</span><span class="p">[:</span><span class="mi">1000</span><span class="p">])</span>
<span class="go">doctest:warning</span>
<span class="go">...</span>
<span class="go">DeprecationWarning: f.nb_subword_occurrences_in(w) is deprecated.</span>
<span class="go">Use w.number_of_subword_occurrences(f) instead.</span>
<span class="go">See https://trac.sagemath.org/30187 for details.</span>
<span class="go">2604124996</span>

<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">nb_subword_occurrences_in</span><span class="p">(</span><span class="n">tm</span><span class="p">[:</span><span class="mi">100</span><span class="p">])</span>
<span class="go">20370432</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This code, based on <a class="reference internal" href="../../../../references/index.html#mssy2001" id="id47"><span>[MSSY2001]</span></a>, actually compute the number of
occurrences of all prefixes of <code class="docutils literal notranslate"><span class="pre">self</span></code> as subwords in all
prefixes of <code class="docutils literal notranslate"><span class="pre">other</span></code>.  In particular, its complexity is
bounded by <code class="docutils literal notranslate"><span class="pre">len(self)</span> <span class="pre">*</span> <span class="pre">len(other)</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.number_of_factor_occurrences">
<span class="sig-name descname"><span class="pre">number_of_factor_occurrences</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.number_of_factor_occurrences" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of times <code class="docutils literal notranslate"><span class="pre">other</span></code> appears as a factor
in <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">other</span></code> – a non empty word</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;112332312313112332121123&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">number_of_factor_occurrences</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;123&#39;</span><span class="p">))</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;11233231231311233221123&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">number_of_factor_occurrences</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;321&#39;</span><span class="p">))</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">number_of_factor_occurrences</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;123&#39;</span><span class="p">))</span>
<span class="go">0</span>
</pre></div>
</div>
<p>An error is raised for the empty word:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">number_of_factor_occurrences</span><span class="p">(</span><span class="n">Word</span><span class="p">())</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError: The factor must be non empty</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.number_of_factors">
<span class="sig-name descname"><span class="pre">number_of_factors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'suffix</span> <span class="pre">tree'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.number_of_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>Count the number of distinct factors of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – an integer, or <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – string (default: <code class="docutils literal notranslate"><span class="pre">'suffix</span> <span class="pre">tree'</span></code>), takes the
following values:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'suffix</span> <span class="pre">tree'</span></code> – construct and use the suffix tree of the word</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'naive'</span></code> – algorithm uses a sliding window</p></li>
</ul>
</li>
</ul>
<p>OUTPUT:</p>
<p>If <code class="docutils literal notranslate"><span class="pre">n</span></code> is an integer, returns the number of distinct factors
of length <code class="docutils literal notranslate"><span class="pre">n</span></code>. If <code class="docutils literal notranslate"><span class="pre">n</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, returns the total number of
distinct factors.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">number_of_factors</span><span class="p">()</span>
<span class="go">13</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">number_of_factors</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>
<span class="go">[1, 3, 3, 3, 2, 1]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">number_of_factors</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="go">[1, 2, 4, 6, 10, 12, 16, 20, 22, 24]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;1213121&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">number_of_factors</span><span class="p">()</span>
<span class="go">22</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;1213121&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">number_of_factors</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">number_of_factors</span><span class="p">()</span>
<span class="go">101</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">number_of_factors</span><span class="p">(</span><span class="mi">77</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">number_of_factors</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">number_of_factors</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">blueberry</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s2">&quot;blueberry&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">blueberry</span><span class="o">.</span><span class="n">number_of_factors</span><span class="p">()</span>
<span class="go">43</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">blueberry</span><span class="o">.</span><span class="n">number_of_factors</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="go">[1, 6, 8, 7, 6, 5, 4, 3, 2, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.number_of_inversions">
<span class="sig-name descname"><span class="pre">number_of_inversions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.number_of_inversions" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of inversions in <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>An inversion of a word <span class="math notranslate nohighlight">\(w = w_1 \ldots w_n\)</span> is a pair of indices <span class="math notranslate nohighlight">\((i, j)\)</span>
with <span class="math notranslate nohighlight">\(i &lt; j\)</span> and <span class="math notranslate nohighlight">\(w_i &gt; w_j\)</span>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../permutation.html#sage.combinat.permutation.Permutation.number_of_inversions" title="sage.combinat.permutation.Permutation.number_of_inversions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">number</span> <span class="pre">of</span> <span class="pre">inversions</span> <span class="pre">on</span> <span class="pre">Permutations</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">number_of_inversions</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.number_of_left_special_factors">
<span class="sig-name descname"><span class="pre">number_of_left_special_factors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.number_of_left_special_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of left special factors of length <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p>
<p>A factor <span class="math notranslate nohighlight">\(u\)</span> of a word <span class="math notranslate nohighlight">\(w\)</span> is <em>left special</em> if there are
two distinct letters <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> such that <span class="math notranslate nohighlight">\(au\)</span> and <span class="math notranslate nohighlight">\(bu\)</span>
are factors of <span class="math notranslate nohighlight">\(w\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – integer</p></li>
</ul>
<p>OUTPUT:</p>
<p>a non-negative integer</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">number_of_left_special_factors</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="go">[1, 1, 1, 1, 1, 1, 1, 1, 1, 1]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">number_of_left_special_factors</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="go">[1, 2, 2, 4, 2, 4, 4, 2, 2, 4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.number_of_letter_occurrences">
<span class="sig-name descname"><span class="pre">number_of_letter_occurrences</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">letter</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.number_of_letter_occurrences" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of occurrences of <code class="docutils literal notranslate"><span class="pre">letter</span></code> in <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">letter</span></code> - a letter</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>integer</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abbabaab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">number_of_letter_occurrences</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">number_of_letter_occurrences</span><span class="p">(</span><span class="s1">&#39;ab&#39;</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>This methods is equivalent to <code class="docutils literal notranslate"><span class="pre">list(w).count(letter)</span></code> and
<code class="docutils literal notranslate"><span class="pre">tuple(w).count(letter)</span></code>, thus <code class="docutils literal notranslate"><span class="pre">count</span></code> is an alias for the method
<code class="docutils literal notranslate"><span class="pre">number_of_letter_occurrences</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
<p>But notice that if <code class="docutils literal notranslate"><span class="pre">s</span></code> and <code class="docutils literal notranslate"><span class="pre">w</span></code> are strings,
<code class="docutils literal notranslate"><span class="pre">Word(s).count(w)</span></code> counts the number occurrences of <code class="docutils literal notranslate"><span class="pre">w</span></code> as a
letter in <code class="docutils literal notranslate"><span class="pre">Word(s)</span></code> which is not the same as <code class="docutils literal notranslate"><span class="pre">s.count(w)</span></code> which
counts the number of occurrences of the string <code class="docutils literal notranslate"><span class="pre">w</span></code> inside <code class="docutils literal notranslate"><span class="pre">s</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;abbabaab&#39;</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;ab&#39;</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;ab&#39;</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.combinat.words.finite_word.FiniteWord_class.number_of_factor_occurrences" title="sage.combinat.words.finite_word.FiniteWord_class.number_of_factor_occurrences"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.combinat.words.finite_word.FiniteWord_class.number_of_factor_occurrences()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.number_of_right_special_factors">
<span class="sig-name descname"><span class="pre">number_of_right_special_factors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.number_of_right_special_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of right special factors of length <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p>
<p>A factor <span class="math notranslate nohighlight">\(u\)</span> of a word <span class="math notranslate nohighlight">\(w\)</span> is <em>right special</em> if there are
two distinct letters <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> such that <span class="math notranslate nohighlight">\(ua\)</span> and <span class="math notranslate nohighlight">\(ub\)</span>
are factors of <span class="math notranslate nohighlight">\(w\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – integer</p></li>
</ul>
<p>OUTPUT:</p>
<p>a non-negative integer</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">number_of_right_special_factors</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="go">[1, 1, 1, 1, 1, 1, 1, 1, 1, 1]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">number_of_right_special_factors</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="go">[1, 2, 2, 4, 2, 4, 4, 2, 2, 4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.number_of_subword_occurrences">
<span class="sig-name descname"><span class="pre">number_of_subword_occurrences</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.number_of_subword_occurrences" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of times <code class="docutils literal notranslate"><span class="pre">other</span></code> appears in <code class="docutils literal notranslate"><span class="pre">self</span></code> as a subword.</p>
<p>This corresponds to the notion of <span class="math notranslate nohighlight">\(binomial coefficient\)</span> of two
finite words whose properties are presented in the chapter of
Lothaire’s book written by Sakarovitch and Simon <a class="reference internal" href="../../../../references/index.html#lot1997" id="id48"><span>[Lot1997]</span></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> – finite word</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">tm</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">tm</span><span class="p">[:</span><span class="mi">1000</span><span class="p">]</span><span class="o">.</span><span class="n">number_of_subword_occurrences</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">2604124996</span>

<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">tm</span><span class="p">[:</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">number_of_subword_occurrences</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">20370432</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This code, based on <a class="reference internal" href="../../../../references/index.html#mssy2001" id="id49"><span>[MSSY2001]</span></a>, actually compute the number of
occurrences of all prefixes of <code class="docutils literal notranslate"><span class="pre">self</span></code> as subwords in all
prefixes of <code class="docutils literal notranslate"><span class="pre">other</span></code>.  In particular, its complexity is
bounded by <code class="docutils literal notranslate"><span class="pre">len(self)</span> <span class="pre">*</span> <span class="pre">len(other)</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.order">
<span class="sig-name descname"><span class="pre">order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the order of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>Let <span class="math notranslate nohighlight">\(p(w)\)</span> be the period of a word <span class="math notranslate nohighlight">\(w\)</span>. The positive rational number
<span class="math notranslate nohighlight">\(|w|/p(w)\)</span> is the <em>order</em> of <span class="math notranslate nohighlight">\(w\)</span>. See Chapter 8 of <a class="reference internal" href="../../../../references/index.html#lot2002" id="id50"><span>[Lot2002]</span></a>.</p>
<p>OUTPUT:</p>
<p>rational – the order</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abaaba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;ababaaba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">8/5</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;aa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.overlap_partition">
<span class="sig-name descname"><span class="pre">overlap_partition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">involution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.overlap_partition" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the partition of the alphabet induced by the overlap of
<code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">other</span></code> with the given <code class="docutils literal notranslate"><span class="pre">delay</span></code>.</p>
<p>The partition of the alphabet is given by the equivalence
relation obtained from the symmetric, reflexive and transitive
closure of the set of pairs of letters
<span class="math notranslate nohighlight">\(R_{u,v,d} = \{ (u_k, v_{k-d}) : 0 \leq k &lt; n, 0\leq k-d &lt; m \}\)</span>
where <span class="math notranslate nohighlight">\(u = u_0 u_1 \cdots u_{n-1}\)</span>, <span class="math notranslate nohighlight">\(v = v_0v_1\cdots v_{m-1}\)</span> are
two words on the alphabet <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(d\)</span> is an integer.</p>
<p>The equivalence relation defined by <span class="math notranslate nohighlight">\(R\)</span> is inspired from <a class="reference internal" href="../../../../references/index.html#lab2008" id="id51"><span>[Lab2008]</span></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> – word on the same alphabet as <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">delay</span></code> – integer (default: <code class="docutils literal notranslate"><span class="pre">0</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – disjoint sets data structure (optional, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>),
a partition of the alphabet into disjoint sets to start with.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, each letter start in distinct equivalence classes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">involution</span></code> – callable (optional, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>), an
involution on the alphabet. If <code class="docutils literal notranslate"><span class="pre">involution</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, the relation
<span class="math notranslate nohighlight">\(R_{u,v,d} \cup R_{involution(u),involution(v),d}\)</span> is considered.</p></li>
</ul>
<p>OUTPUT:</p>
<p>a disjoint set data structure</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abc012345&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="s1">&#39;01234&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">overlap_partition</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">{{&#39;0&#39;, &#39;a&#39;}, {&#39;1&#39;, &#39;b&#39;}, {&#39;2&#39;, &#39;c&#39;}, {&#39;3&#39;}, {&#39;4&#39;}, {&#39;5&#39;}}</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">overlap_partition</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">{{&#39;0&#39;, &#39;c&#39;}, {&#39;1&#39;}, {&#39;2&#39;}, {&#39;3&#39;}, {&#39;4&#39;}, {&#39;5&#39;}, {&#39;a&#39;}, {&#39;b&#39;}}</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">overlap_partition</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">{{&#39;0&#39;}, {&#39;1&#39;, &#39;a&#39;}, {&#39;2&#39;, &#39;b&#39;}, {&#39;3&#39;, &#39;c&#39;}, {&#39;4&#39;}, {&#39;5&#39;}}</span>
</pre></div>
</div>
<p>You can re-use the same disjoint set and do more than one overlap:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">overlap_partition</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span>
<span class="go">{{&#39;0&#39;, &#39;c&#39;}, {&#39;1&#39;}, {&#39;2&#39;}, {&#39;3&#39;}, {&#39;4&#39;}, {&#39;5&#39;}, {&#39;a&#39;}, {&#39;b&#39;}}</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">overlap_partition</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="go">{{&#39;0&#39;, &#39;1&#39;, &#39;b&#39;, &#39;c&#39;}, {&#39;2&#39;}, {&#39;3&#39;}, {&#39;4&#39;}, {&#39;5&#39;}, {&#39;a&#39;}}</span>
</pre></div>
</div>
<p>The function  <code class="docutils literal notranslate"><span class="pre">overlap_partition</span></code> can be used to study equations
on words. For example, if a word <span class="math notranslate nohighlight">\(w\)</span> overlaps itself with delay <span class="math notranslate nohighlight">\(d\)</span>, then
<span class="math notranslate nohighlight">\(d\)</span> is a period of <span class="math notranslate nohighlight">\(w\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">14</span><span class="p">));</span> <span class="n">w</span>
<span class="go">word: 0,1,2,3,4,5,6,7,8,9,10,11,12,13</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">overlap_partition</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">element_to_root_dict</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">w2</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="n">w</span><span class="p">);</span> <span class="n">w2</span>
<span class="go">word: 56789567895678</span>
<span class="gp">sage: </span><span class="n">w2</span><span class="o">.</span><span class="n">minimal_period</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If a word is equal to its reversal, then it is a palindrome:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">17</span><span class="p">));</span> <span class="n">w</span>
<span class="go">word: 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">overlap_partition</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">reversal</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">element_to_root_dict</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">w2</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="n">w</span><span class="p">);</span> <span class="n">w2</span>
<span class="go">word: 01234567876543210</span>
<span class="gp">sage: </span><span class="n">w2</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Finite words over {0, 1, 2, 3, 4, 5, 6, 7, 8, 17, 18, 19}</span>
<span class="gp">sage: </span><span class="n">w2</span><span class="o">.</span><span class="n">is_palindrome</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If the reversal of a word <span class="math notranslate nohighlight">\(w\)</span> is factor of its square <span class="math notranslate nohighlight">\(w^2\)</span>, then
<span class="math notranslate nohighlight">\(w\)</span> is symmetric, i.e. the product of two palindromes:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span> <span class="n">w</span>
<span class="go">word: 0123456789</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">overlap_partition</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">reversal</span><span class="p">(),</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">element_to_root_dict</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">w2</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="n">w</span><span class="p">);</span> <span class="n">w2</span>
<span class="go">word: 0110456654</span>
<span class="gp">sage: </span><span class="n">w2</span><span class="o">.</span><span class="n">is_symmetric</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If the image of the reversal of a word <span class="math notranslate nohighlight">\(w\)</span> under an involution <span class="math notranslate nohighlight">\(f\)</span>
is factor of its square <span class="math notranslate nohighlight">\(w^2\)</span>, then <span class="math notranslate nohighlight">\(w\)</span> is <span class="math notranslate nohighlight">\(f\)</span>-symmetric:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">([</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span><span class="o">..</span><span class="p">,</span><span class="mi">11</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">..</span><span class="p">,</span><span class="mi">11</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span>
<span class="go">word: 1,3,5,7,9,11</span>
<span class="gp">sage: </span><span class="n">inv</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="o">-</span><span class="n">x</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">inv</span><span class="p">(</span><span class="n">a</span><span class="p">))</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">W</span><span class="o">.</span><span class="n">alphabet</span><span class="p">()))</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">overlap_partition</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">reversal</span><span class="p">(),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">involution</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">element_to_root_dict</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">m</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">word: 1,-1,5,7,-7,-5</span>
<span class="gp">sage: </span><span class="n">m</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">is_symmetric</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.palindrome_prefixes">
<span class="sig-name descname"><span class="pre">palindrome_prefixes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.palindrome_prefixes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of all palindrome prefixes of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<p>a list – A list of all palindrome prefixes of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abaaba&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">palindrome_prefixes</span><span class="p">()</span>
<span class="go">[word: , word: a, word: aba, word: abaaba]</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abbbbbbbbbb&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">palindrome_prefixes</span><span class="p">()</span>
<span class="go">[word: , word: a]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.palindromes">
<span class="sig-name descname"><span class="pre">palindromes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.palindromes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the set of all palindromic (or <code class="docutils literal notranslate"><span class="pre">f</span></code>-palindromic) factors of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> – involution (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) on the alphabet of <code class="docutils literal notranslate"><span class="pre">self</span></code>. It must
be callable on letters as well as words (e.g. <code class="docutils literal notranslate"><span class="pre">WordMorphism</span></code>).</p></li>
</ul>
<p>OUTPUT:</p>
<p>a set – If <code class="docutils literal notranslate"><span class="pre">f</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the set of all palindromic factors of <code class="docutils literal notranslate"><span class="pre">self</span></code>;
otherwise, the set of all <code class="docutils literal notranslate"><span class="pre">f</span></code>-palindromic factors of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;01101001&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">palindromes</span><span class="p">())</span>
<span class="go">[word: , word: 0, word: 00, word: 010, word: 0110, word: 1, word: 1001, word: 101, word: 11]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;00000&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">palindromes</span><span class="p">())</span>
<span class="go">[word: , word: 0, word: 00, word: 000, word: 0000, word: 00000]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">palindromes</span><span class="p">())</span>
<span class="go">[word: , word: 0]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">palindromes</span><span class="p">())</span>
<span class="go">[word: ]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">palindromes</span><span class="p">())</span>
<span class="go">[word: ]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abbabaab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">palindromes</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
<span class="go">[word: , word: ab, word: abbabaab, word: ba, word: baba, word: bbabaa]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.palindromic_closure">
<span class="sig-name descname"><span class="pre">palindromic_closure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">side</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'right'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.palindromic_closure" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the shortest palindrome having <code class="docutils literal notranslate"><span class="pre">self</span></code> as a prefix
(or as a suffix if <code class="docutils literal notranslate"><span class="pre">side</span></code> is <code class="docutils literal notranslate"><span class="pre">'left'</span></code>).</p>
<p>See <a class="reference internal" href="../../../../references/index.html#deluca2006" id="id52"><span>[DeLuca2006]</span></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">side</span></code> – <code class="docutils literal notranslate"><span class="pre">'right'</span></code> or <code class="docutils literal notranslate"><span class="pre">'left'</span></code> (default: <code class="docutils literal notranslate"><span class="pre">'right'</span></code>) the
direction of the  closure</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> – involution (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) on the alphabet of <code class="docutils literal notranslate"><span class="pre">self</span></code>.
It must be callable on letters as well as words (e.g. <code class="docutils literal notranslate"><span class="pre">WordMorphism</span></code>).</p></li>
</ul>
<p>OUTPUT:</p>
<p>a word – If <code class="docutils literal notranslate"><span class="pre">f</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the right palindromic closure of <code class="docutils literal notranslate"><span class="pre">self</span></code>;
otherwise, the right <code class="docutils literal notranslate"><span class="pre">f</span></code>-palindromic closure of <code class="docutils literal notranslate"><span class="pre">self</span></code>.
If <code class="docutils literal notranslate"><span class="pre">side</span></code> is <code class="docutils literal notranslate"><span class="pre">'left'</span></code>, the left palindromic closure.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;1233&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">palindromic_closure</span><span class="p">()</span>
<span class="go">word: 123321</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;12332&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">palindromic_closure</span><span class="p">()</span>
<span class="go">word: 123321</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;0110343&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">palindromic_closure</span><span class="p">()</span>
<span class="go">word: 01103430110</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;0110343&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">palindromic_closure</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="go">word: 3430110343</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;01105678&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">palindromic_closure</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="go">word: 876501105678</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abbaba&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">palindromic_closure</span><span class="p">()</span>
<span class="go">word: abbababba</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">palindromic_closure</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<span class="go">word: abbabaab</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">palindromic_closure</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="go">word: babaabbaba</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.palindromic_complexity">
<span class="sig-name descname"><span class="pre">palindromic_complexity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.palindromic_complexity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of distinct palindromic factors of length <code class="docutils literal notranslate"><span class="pre">n</span></code> of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – the length of the factors.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">palindromic_complexity</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">1000</span><span class="p">]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">palindromic_complexity</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[1, 2, 2, 2, 2, 0, 4, 0, 4, 0, 4, 0, 4, 0, 2, 0, 2, 0, 4, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.palindromic_lacunas_study">
<span class="sig-name descname"><span class="pre">palindromic_lacunas_study</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.palindromic_lacunas_study" title="Permalink to this definition">¶</a></dt>
<dd><p>Return interesting statistics about longest (<code class="docutils literal notranslate"><span class="pre">f</span></code>-)palindromic suffixes
and lacunas of <code class="docutils literal notranslate"><span class="pre">self</span></code> (see <a class="reference internal" href="../../../../references/index.html#bmbl2008" id="id53"><span>[BMBL2008]</span></a> and <a class="reference internal" href="../../../../references/index.html#bmbflr2008" id="id54"><span>[BMBFLR2008]</span></a>).</p>
<p>Note that a word <span class="math notranslate nohighlight">\(w\)</span> has at most <span class="math notranslate nohighlight">\(|w| + 1\)</span> different palindromic factors
(see <a class="reference internal" href="../../../../references/index.html#djp2001" id="id55"><span>[DJP2001]</span></a>). For <span class="math notranslate nohighlight">\(f\)</span>-palindromes (or pseudopalidromes or theta-palindromes),
the maximum number of <span class="math notranslate nohighlight">\(f\)</span>-palindromic factors is <span class="math notranslate nohighlight">\(|w|+1-g_f(w)\)</span>, where
<span class="math notranslate nohighlight">\(g_f(w)\)</span> is the number of pairs <span class="math notranslate nohighlight">\(\{a, f(a)\}\)</span> such that <span class="math notranslate nohighlight">\(a\)</span> is a letter,
<span class="math notranslate nohighlight">\(a\)</span> is not equal to <span class="math notranslate nohighlight">\(f(a)\)</span>, and <span class="math notranslate nohighlight">\(a\)</span> or <span class="math notranslate nohighlight">\(f(a)\)</span> occurs in <span class="math notranslate nohighlight">\(w\)</span>, see <a class="reference internal" href="../../../../references/index.html#star2011" id="id56"><span>[Star2011]</span></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> – involution (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) on the alphabet of <code class="docutils literal notranslate"><span class="pre">self</span></code>.
It must be callable on letters as well as words (e.g. <code class="docutils literal notranslate"><span class="pre">WordMorphism</span></code>).
The default value corresponds to usual palindromes, i.e.,
<code class="docutils literal notranslate"><span class="pre">f</span></code> equal to the identity.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">list</span></code> – list of the length of the longest palindromic
suffix (lps) for each non-empty prefix of <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">list</span></code> – list of all the lacunas, i.e. positions where there is no
unioccurrent lps</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">set</span></code> – set of palindromic factors of <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abbabaabbaab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">palindromic_lacunas_study</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">a</span>
<span class="go">[1, 1, 2, 4, 3, 3, 2, 4, 2, 4, 6, 8]</span>
<span class="gp">sage: </span><span class="n">b</span>
<span class="go">[8, 9]</span>
<span class="gp">sage: </span><span class="n">c</span>          <span class="c1"># random order</span>
<span class="go">set([word: , word: b, word: bab, word: abba, word: bb, word: aa, word: baabbaab, word: baab, word: aba, word: aabbaa, word: a])</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abbabaab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">palindromic_lacunas_study</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span>
<span class="go">[0, 2, 0, 2, 2, 4, 6, 8]</span>
<span class="gp">sage: </span><span class="n">b</span>
<span class="go">[0, 2, 4]</span>
<span class="gp">sage: </span><span class="n">c</span>           <span class="c1"># random order</span>
<span class="go">set([word: , word: ba, word: baba, word: ab, word: bbabaa, word: abbabaab])</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">==</span> <span class="nb">set</span><span class="p">([</span><span class="n">Word</span><span class="p">(),</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;ba&#39;</span><span class="p">),</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;baba&#39;</span><span class="p">),</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;ab&#39;</span><span class="p">),</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;bbabaa&#39;</span><span class="p">),</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abbabaab&#39;</span><span class="p">)])</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.periods">
<span class="sig-name descname"><span class="pre">periods</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">divide_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.periods" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list containing the periods of <code class="docutils literal notranslate"><span class="pre">self</span></code>
between <span class="math notranslate nohighlight">\(1\)</span> and <span class="math notranslate nohighlight">\(n - 1\)</span>, where <span class="math notranslate nohighlight">\(n\)</span> is the length
of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">divide_length</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>).
When set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, then only periods that divide
the length of <code class="docutils literal notranslate"><span class="pre">self</span></code> are considered.</p></li>
</ul>
<p>OUTPUT:</p>
<p>a list of positive integers</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;ababab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">periods</span><span class="p">()</span>
<span class="go">[2, 4]</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">periods</span><span class="p">(</span><span class="n">divide_length</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[2]</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;ababa&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">periods</span><span class="p">()</span>
<span class="go">[2, 4]</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">periods</span><span class="p">(</span><span class="n">divide_length</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.phi">
<span class="sig-name descname"><span class="pre">phi</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.phi" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the phi function to <code class="docutils literal notranslate"><span class="pre">self</span></code> and return the result. This is
the word obtained by taking the first letter of the words obtained
by iterating delta on <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<p>a word – the result of the phi function</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">phi</span><span class="p">()</span>
<span class="go">word: 222222</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">phi</span><span class="p">()</span>
<span class="go">word: 212113</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">()</span><span class="o">.</span><span class="n">phi</span><span class="p">()</span>
<span class="go">word:</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">phi</span><span class="p">()</span>
<span class="go">word: 212113</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">phi</span><span class="p">()</span>
<span class="go">word: 21215</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s2">&quot;aabbabaabaabba&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">phi</span><span class="p">()</span>
<span class="go">word: a22222</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="../../../../references/index.html#bl2003" id="id57"><span>[BL2003]</span></a> and <a class="reference internal" href="../../../../references/index.html#bdlv2006" id="id58"><span>[BDLV2006]</span></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.phi_inv">
<span class="sig-name descname"><span class="pre">phi_inv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.phi_inv" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the inverse of the phi function to <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – a word over the integers</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">W</span></code> – a parent object of words defined over integers</p></li>
</ul>
<p>OUTPUT:</p>
<p>a word – the inverse of the phi function</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">phi_inv</span><span class="p">()</span>
<span class="go">word: 22112122</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">phi_inv</span><span class="p">(</span><span class="n">Words</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="go">word: 2233</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.prefix_function_table">
<span class="sig-name descname"><span class="pre">prefix_function_table</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.prefix_function_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a vector containing the length of the proper prefix-suffixes
for all the non-empty prefixes of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;121321&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">prefix_function_table</span><span class="p">()</span>
<span class="go">[0, 0, 1, 0, 0, 1]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;1241245&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">prefix_function_table</span><span class="p">()</span>
<span class="go">[0, 0, 0, 1, 2, 3, 0]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">prefix_function_table</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.primitive">
<span class="sig-name descname"><span class="pre">primitive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.primitive" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the primitive of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;12312&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">primitive</span><span class="p">()</span>
<span class="go">word: 12312</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;121212&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">primitive</span><span class="p">()</span>
<span class="go">word: 12</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.primitive_length">
<span class="sig-name descname"><span class="pre">primitive_length</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.primitive_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the length of the primitive of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;1231&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">primitive_length</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;121212&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">primitive_length</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.quasiperiods">
<span class="sig-name descname"><span class="pre">quasiperiods</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.quasiperiods" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the quasiperiods of <code class="docutils literal notranslate"><span class="pre">self</span></code> as a list ordered from shortest to
longest.</p>
<p>Let <span class="math notranslate nohighlight">\(w\)</span> be a finite or infinite word. A <em>quasiperiod</em> of <span class="math notranslate nohighlight">\(w\)</span> is a
proper factor <span class="math notranslate nohighlight">\(u\)</span> of <span class="math notranslate nohighlight">\(w\)</span> such that the occurrences of <span class="math notranslate nohighlight">\(u\)</span> in <span class="math notranslate nohighlight">\(w\)</span>
entirely cover <span class="math notranslate nohighlight">\(w\)</span>, i.e., every position of <span class="math notranslate nohighlight">\(w\)</span> falls within some
occurrence of <span class="math notranslate nohighlight">\(u\)</span> in <span class="math notranslate nohighlight">\(w\)</span>. See for instance <a class="reference internal" href="../../../../references/index.html#ae1993" id="id59"><span>[AE1993]</span></a>, <a class="reference internal" href="../../../../references/index.html#mar2004" id="id60"><span>[Mar2004]</span></a>,
and <a class="reference internal" href="../../../../references/index.html#glr2008" id="id61"><span>[GLR2008]</span></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abaababaabaababaaba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">quasiperiods</span><span class="p">()</span>
<span class="go">[word: aba, word: abaaba, word: abaababaaba]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abaaba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">quasiperiods</span><span class="p">()</span>
<span class="go">[word: aba]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abacaba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">quasiperiods</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.rauzy_graph">
<span class="sig-name descname"><span class="pre">rauzy_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.rauzy_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Rauzy graph of the factors of length <code class="docutils literal notranslate"><span class="pre">n</span></code> of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>The vertices are the factors of length <span class="math notranslate nohighlight">\(n\)</span> and there is an edge from
<span class="math notranslate nohighlight">\(u\)</span> to <span class="math notranslate nohighlight">\(v\)</span> if <span class="math notranslate nohighlight">\(ua = bv\)</span> is a factor of length <span class="math notranslate nohighlight">\(n+1\)</span> for some letters
<span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – integer</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span> <span class="n">w</span>
<span class="go">word: 0123456789</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">rauzy_graph</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">g</span>
<span class="go">Looped digraph on 8 vertices</span>
<span class="gp">sage: </span><span class="n">WordOptions</span><span class="p">(</span><span class="n">identifier</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[012, 123, 234, 345, 456, 567, 678, 789]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(012, 123, 3),</span>
<span class="go"> (123, 234, 4),</span>
<span class="go"> (234, 345, 5),</span>
<span class="go"> (345, 456, 6),</span>
<span class="go"> (456, 567, 7),</span>
<span class="go"> (567, 678, 8),</span>
<span class="go"> (678, 789, 9)]</span>
<span class="gp">sage: </span><span class="n">WordOptions</span><span class="p">(</span><span class="n">identifier</span><span class="o">=</span><span class="s1">&#39;word: &#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">rauzy_graph</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="go">Looped digraph on 9 vertices</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;1111111&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">rauzy_graph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(word: 111, word: 111, word: 1)]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;111&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">:</span> <span class="n">w</span><span class="o">.</span><span class="n">rauzy_graph</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="go">Looped multi-digraph on 1 vertex</span>
<span class="go">Looped digraph on 1 vertex</span>
<span class="go">Looped digraph on 1 vertex</span>
<span class="go">Looped digraph on 1 vertex</span>
<span class="go">Looped digraph on 0 vertices</span>
</pre></div>
</div>
<p>Multi-edges are allowed for the empty word:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s1">&#39;abcde&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">rauzy_graph</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Looped multi-digraph on 1 vertex</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(word: , word: , word: a),</span>
<span class="go"> (word: , word: , word: b),</span>
<span class="go"> (word: , word: , word: c)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.reduced_rauzy_graph">
<span class="sig-name descname"><span class="pre">reduced_rauzy_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.reduced_rauzy_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the reduced Rauzy graph of order <code class="docutils literal notranslate"><span class="pre">n</span></code> of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – a non-negative integer. Every vertex of a reduced
Rauzy graph of order <code class="docutils literal notranslate"><span class="pre">n</span></code> is a factor of length <code class="docutils literal notranslate"><span class="pre">n</span></code> of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>a looped multi-digraph</p>
<p>DEFINITION:</p>
<p>For infinite periodic words (resp. for finite words of type <span class="math notranslate nohighlight">\(u^i
u[0:j]\)</span>), the reduced Rauzy graph of order <span class="math notranslate nohighlight">\(n\)</span> (resp. for <span class="math notranslate nohighlight">\(n\)</span>
smaller or equal to <span class="math notranslate nohighlight">\((i-1)|u|+j\)</span>) is the directed graph whose
unique vertex is the prefix <span class="math notranslate nohighlight">\(p\)</span> of length <span class="math notranslate nohighlight">\(n\)</span> of <code class="docutils literal notranslate"><span class="pre">self</span></code> and which has
an only edge which is a loop on <span class="math notranslate nohighlight">\(p\)</span> labelled by <span class="math notranslate nohighlight">\(w[n+1:|w|] p\)</span>
where <span class="math notranslate nohighlight">\(w\)</span> is the unique return word to <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>In other cases, it is the directed graph defined as followed.  Let
<span class="math notranslate nohighlight">\(G_n\)</span> be the Rauzy graph of order <span class="math notranslate nohighlight">\(n\)</span> of self. The vertices are the
vertices of <span class="math notranslate nohighlight">\(G_n\)</span> that are either special or not prolongable to the
right or to the left. For each couple (<span class="math notranslate nohighlight">\(u\)</span>, <span class="math notranslate nohighlight">\(v\)</span>) of such vertices
and each directed path in <span class="math notranslate nohighlight">\(G_n\)</span> from <span class="math notranslate nohighlight">\(u\)</span> to <span class="math notranslate nohighlight">\(v\)</span> that contains no
other vertices that are special, there is an edge from <span class="math notranslate nohighlight">\(u\)</span> to <span class="math notranslate nohighlight">\(v\)</span>
in the reduced Rauzy graph of order <span class="math notranslate nohighlight">\(n\)</span> whose label is the label of
the path in <span class="math notranslate nohighlight">\(G_n\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the case of infinite recurrent non-periodic words, this
definition corresponds to the following one that can be
found in <a class="reference internal" href="../../../../references/index.html#bdlgz2009" id="id62"><span>[BDLGZ2009]</span></a> and <a class="reference internal" href="../../../../references/index.html#bps2008" id="id63"><span>[BPS2008]</span></a> where a simple path is a
path that begins with a special factor, ends with a
special factor and contains no other vertices that are
special:</p>
<p>The reduced Rauzy graph of factors of length <span class="math notranslate nohighlight">\(n\)</span> is obtained
from <span class="math notranslate nohighlight">\(G_n\)</span> by replacing each simple path <span class="math notranslate nohighlight">\(P=v_1 v_2 ...
v_{\ell}\)</span> with an edge <span class="math notranslate nohighlight">\(v_1 v_{\ell}\)</span> whose label is the
concatenation of the labels of the edges of <span class="math notranslate nohighlight">\(P\)</span>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span> <span class="n">w</span>
<span class="go">word: 0123456789</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">reduced_rauzy_graph</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">g</span>
<span class="go">Looped multi-digraph on 2 vertices</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[word: 012, word: 789]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(word: 012, word: 789, word: 3456789)]</span>
</pre></div>
</div>
<p>For the Fibonacci word:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">FibonacciWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">reduced_rauzy_graph</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span><span class="n">g</span>
<span class="go">Looped multi-digraph on 2 vertices</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[word: 01001010, word: 01010010]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(word: 01001010, word: 01010010, word: 010), (word: 01010010, word: 01001010, word: 01010), (word: 01010010, word: 01001010, word: 10)]</span>
</pre></div>
</div>
<p>For periodic words:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">cycle</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="n">cycle</span><span class="p">(</span><span class="s1">&#39;abcd&#39;</span><span class="p">))[:</span><span class="mi">100</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">reduced_rauzy_graph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(word: abc, word: abc, word: dabc)]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;111&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">:</span> <span class="n">w</span><span class="o">.</span><span class="n">reduced_rauzy_graph</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="go">Looped digraph on 1 vertex</span>
<span class="go">Looped digraph on 1 vertex</span>
<span class="go">Looped digraph on 1 vertex</span>
<span class="go">Looped multi-digraph on 1 vertex</span>
<span class="go">Looped multi-digraph on 0 vertices</span>
</pre></div>
</div>
<p>For ultimately periodic words:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sigma</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;abcd,b-&gt;cd,c-&gt;cd,d-&gt;cd&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">sigma</span><span class="o">.</span><span class="n">fixed_point</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)[:</span><span class="mi">100</span><span class="p">];</span> <span class="n">w</span>
<span class="go">word: abcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcd...</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">reduced_rauzy_graph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[word: abcdc, word: cdcdc]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(word: abcdc, word: cdcdc, word: dc), (word: cdcdc, word: cdcdc, word: dc)]</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<p>Julien Leroy (March 2010): initial version</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.return_words">
<span class="sig-name descname"><span class="pre">return_words</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fact</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.return_words" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the set of return words of <code class="docutils literal notranslate"><span class="pre">fact</span></code> in <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>This is the set of all factors starting by the given factor and ending
just before the next occurrence of this factor.
See <a class="reference internal" href="../../../../references/index.html#dur1998" id="id64"><span>[Dur1998]</span></a> and <a class="reference internal" href="../../../../references/index.html#hz1999" id="id65"><span>[HZ1999]</span></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fact</span></code> – a non-empty finite word</p></li>
</ul>
<p>OUTPUT:</p>
<p>a Python set of finite words</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;21331233213231&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">return_words</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">))</span>
<span class="go">{word: 213, word: 21331, word: 233}</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">()</span><span class="o">.</span><span class="n">return_words</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;213&#39;</span><span class="p">))</span>
<span class="go">set()</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;121212&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">return_words</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;1212&#39;</span><span class="p">))</span>
<span class="go">{word: 12}</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">TM</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">1000</span><span class="p">]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">TM</span><span class="o">.</span><span class="n">return_words</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">])))</span>
<span class="go">[word: 0, word: 01, word: 011]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.return_words_derivate">
<span class="sig-name descname"><span class="pre">return_words_derivate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fact</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.return_words_derivate" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the word generated by mapping a letter to each occurrence of
the return words for the given factor dropping any dangling prefix and
suffix. See for instance <a class="reference internal" href="../../../../references/index.html#dur1998" id="id66"><span>[Dur1998]</span></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;12131221312313122&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">return_words_derivate</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">))</span>
<span class="go">word: 123242</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.rev_lex_less">
<span class="sig-name descname"><span class="pre">rev_lex_less</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.rev_lex_less" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if the word <code class="docutils literal notranslate"><span class="pre">self</span></code> is reverse
lexicographically less than <code class="docutils literal notranslate"><span class="pre">other</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">rev_lex_less</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">rev_lex_less</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.reversal">
<span class="sig-name descname"><span class="pre">reversal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.reversal" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the reversal of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;124563&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reversal</span><span class="p">()</span>
<span class="go">word: 365421</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.rfind">
<span class="sig-name descname"><span class="pre">rfind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.rfind" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the index of the last occurrence of <code class="docutils literal notranslate"><span class="pre">sub</span></code> in <code class="docutils literal notranslate"><span class="pre">self</span></code>,
such that <code class="docutils literal notranslate"><span class="pre">sub</span></code> is contained within <code class="docutils literal notranslate"><span class="pre">self[start:end]</span></code>.
Return <code class="docutils literal notranslate"><span class="pre">-1</span></code> on failure.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sub</span></code> – string, list, tuple or word to search for.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">start</span></code> – non-negative integer (default: <code class="docutils literal notranslate"><span class="pre">0</span></code>) specifying
the position at which the search must stop.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">end</span></code> – non-negative integer (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) specifying
the position from which to start the search. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then
the search is performed up to the end of the string.</p></li>
</ul>
<p>OUTPUT:</p>
<p>a non-negative integer or <code class="docutils literal notranslate"><span class="pre">-1</span></code></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">3</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">sub</span></code> parameter can also be a list or a tuple:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">rfind</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">rfind</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="go">3</span>
</pre></div>
</div>
<p>Examples using the argument <code class="docutils literal notranslate"><span class="pre">start</span></code> and <code class="docutils literal notranslate"><span class="pre">end</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">start</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">start</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">-1</span>
</pre></div>
</div>
<p>Instances of <code class="docutils literal notranslate"><span class="pre">Word_str</span></code> handle string inputs as well:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abac&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">))</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">rfind</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">-1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.right_special_factors">
<span class="sig-name descname"><span class="pre">right_special_factors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.right_special_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the right special factors (of length <code class="docutils literal notranslate"><span class="pre">n</span></code>).</p>
<p>A factor <span class="math notranslate nohighlight">\(u\)</span> of a word <span class="math notranslate nohighlight">\(w\)</span> is <em>right special</em> if there are
two distinct letters <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> such that <span class="math notranslate nohighlight">\(ua\)</span> and <span class="math notranslate nohighlight">\(ub\)</span>
are factors of <span class="math notranslate nohighlight">\(w\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – integer (optional, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>). If <code class="docutils literal notranslate"><span class="pre">None</span></code>, it returns
all right special factors.</p></li>
</ul>
<p>OUTPUT:</p>
<p>a list of words</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">30</span><span class="p">]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;{} {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">right_special_factors</span><span class="p">(</span><span class="n">i</span><span class="p">))))</span>
<span class="go">0 [word: ]</span>
<span class="go">1 [word: 0, word: 1]</span>
<span class="go">2 [word: 01, word: 10]</span>
<span class="go">3 [word: 001, word: 010, word: 101, word: 110]</span>
<span class="go">4 [word: 0110, word: 1001]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.right_special_factors_iterator">
<span class="sig-name descname"><span class="pre">right_special_factors_iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.right_special_factors_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an iterator over the right special factors (of length <code class="docutils literal notranslate"><span class="pre">n</span></code>).</p>
<p>A factor <span class="math notranslate nohighlight">\(u\)</span> of a word <span class="math notranslate nohighlight">\(w\)</span> is <em>right special</em> if there are
two distinct letters <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> such that <span class="math notranslate nohighlight">\(ua\)</span> and <span class="math notranslate nohighlight">\(ub\)</span>
are factors of <span class="math notranslate nohighlight">\(w\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – integer (optional, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>). If <code class="docutils literal notranslate"><span class="pre">None</span></code>, it returns
an iterator over all right special factors.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="mf">0.61</span><span class="p">,</span> <span class="mf">0.54</span><span class="p">,</span> <span class="mf">0.3</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">CodingOfRotationWord</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="p">)[:</span><span class="mi">40</span><span class="p">]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">right_special_factors_iterator</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">[word: 010, word: 101]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">right_special_factors_iterator</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="go">[word: 0101, word: 1010]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">right_special_factors_iterator</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">[word: 00101, word: 11010]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.robinson_schensted">
<span class="sig-name descname"><span class="pre">robinson_schensted</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.robinson_schensted" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the semistandard tableau and standard tableau pair
obtained by running the Robinson-Schensted algorithm on <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>This can also be done by running
<a class="reference internal" href="../rsk.html#sage.combinat.rsk.RSK" title="sage.combinat.rsk.RSK"><code class="xref py py-func docutils literal notranslate"><span class="pre">RSK()</span></code></a> on <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">robinson_schensted</span><span class="p">()</span>
<span class="go">[[[1, 1, 1, 1, 3], [2], [3]], [[1, 2, 3, 5, 6], [4], [7]]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.schuetzenberger_involution">
<span class="sig-name descname"><span class="pre">schuetzenberger_involution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.schuetzenberger_involution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Schützenberger involution of the word <code class="docutils literal notranslate"><span class="pre">self</span></code>, which is obtained
by reverting the word and then complementing all letters within the
underlying ordered alphabet. If <code class="docutils literal notranslate"><span class="pre">n</span></code> is specified, the underlying
alphabet is assumed to be <span class="math notranslate nohighlight">\([1,2,\ldots,n]\)</span>. If no alphabet is specified,
<span class="math notranslate nohighlight">\(n\)</span> is the maximal letter appearing in <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – a word</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – an integer specifying the maximal letter in the alphabet (optional)</p></li>
</ul>
<p>OUTPUT:</p>
<p>a word, the Schützenberger involution of <code class="docutils literal notranslate"><span class="pre">self</span></code></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">schuetzenberger_involution</span><span class="p">();</span> <span class="n">v</span>
<span class="go">word: 7849631</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Finite words over Set of Python objects of class &#39;object&#39;</span>

<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="n">alphabet</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">schuetzenberger_involution</span><span class="p">();</span><span class="n">v</span>
<span class="go">word: 345</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Finite words over {1, 2, 3, 4, 5}</span>

<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">schuetzenberger_involution</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">);</span><span class="n">v</span>
<span class="go">word: 345</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Finite words over Set of Python objects of class &#39;object&#39;</span>

<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">11</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">69</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">41</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">schuetzenberger_involution</span><span class="p">()</span>
<span class="go">word: 29,52,67,68,69,17,68,1,38,59</span>

<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([],</span><span class="n">alphabet</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">schuetzenberger_involution</span><span class="p">()</span>
<span class="go">word:</span>

<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">schuetzenberger_involution</span><span class="p">()</span>
<span class="go">word:</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.shifted_shuffle">
<span class="sig-name descname"><span class="pre">shifted_shuffle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.shifted_shuffle" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the combinatorial class representing the shifted shuffle
product between words <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">other</span></code>. This is the same as the
shuffle product of <code class="docutils literal notranslate"><span class="pre">self</span></code> with the word obtained from <code class="docutils literal notranslate"><span class="pre">other</span></code> by
incrementing its values (i.e. its letters) by the given <code class="docutils literal notranslate"><span class="pre">shift</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> – finite word over the integers</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">shift</span></code> – integer or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) added to each letter of
<code class="docutils literal notranslate"><span class="pre">other</span></code>. When <code class="docutils literal notranslate"><span class="pre">shift</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, it is replaced by <code class="docutils literal notranslate"><span class="pre">self.length()</span></code></p></li>
</ul>
<p>OUTPUT:</p>
<p>combinatorial class of shifted shuffle products of <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">other</span></code></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">sp</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">shifted_shuffle</span><span class="p">(</span><span class="n">w</span><span class="p">);</span> <span class="n">sp</span>
<span class="go">Shuffle product of word: 011 and word: 344</span>
<span class="gp">sage: </span><span class="n">sp</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">shifted_shuffle</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="n">sp</span>
<span class="go">Shuffle product of word: 011 and word: 233</span>
<span class="gp">sage: </span><span class="n">sp</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">20</span>
<span class="gp">sage: </span><span class="n">WordOptions</span><span class="p">(</span><span class="n">identifier</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sp</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="go">[011233, 012133, 012313, 012331, 021133, 021313, 021331, 023113, 023131, 023311, 201133, 201313, 201331, 203113, 203131, 203311, 230113, 230131, 230311, 233011]</span>
<span class="gp">sage: </span><span class="n">WordOptions</span><span class="p">(</span><span class="n">identifier</span><span class="o">=</span><span class="s1">&#39;word: &#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;aba&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">shifted_shuffle</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: for shifted shuffle, words must only contain integers as letters</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.shuffle">
<span class="sig-name descname"><span class="pre">shuffle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.shuffle" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the combinatorial class representing the shuffle product
between words <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">other</span></code>. This consists of all words of length
<code class="docutils literal notranslate"><span class="pre">self.length()+other.length()</span></code> that have both <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">other</span></code> as
subwords.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">overlap</span></code> is non-zero, then the combinatorial class representing
the shuffle product with overlaps is returned. The calculation of
the shift in each overlap is done relative to the order of the
alphabet. For example, <span class="math notranslate nohighlight">\(a\)</span> shifted by <span class="math notranslate nohighlight">\(a\)</span> is <span class="math notranslate nohighlight">\(b\)</span> in the alphabet
<span class="math notranslate nohighlight">\([a, b, c]\)</span> and <span class="math notranslate nohighlight">\(0\)</span> shifted by <span class="math notranslate nohighlight">\(1\)</span> in <span class="math notranslate nohighlight">\([0, 1, 2, 3]\)</span> is <span class="math notranslate nohighlight">\(2\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> – finite word</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">overlap</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">0</span></code>) integer or <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
</ul>
<p>OUTPUT:</p>
<p>combinatorial class of shuffle product of <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">other</span></code></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ab</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s2">&quot;ab&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cd</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s2">&quot;cd&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sp</span> <span class="o">=</span> <span class="n">ab</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">cd</span><span class="p">);</span> <span class="n">sp</span>
<span class="go">Shuffle product of word: ab and word: cd</span>
<span class="gp">sage: </span><span class="n">sp</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">sp</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="go">[word: abcd, word: acbd, word: acdb, word: cabd, word: cadb, word: cdab]</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">Shuffle product of word: 01 and word: 01</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">Shuffle product of word: 23 and word: 23</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">Shuffle product of word: 01 and word: 23</span>
<span class="gp">sage: </span><span class="n">sp2</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span> <span class="n">sp2</span>
<span class="go">Overlapping shuffle product of word: 01 and word: 23 with 2 overlaps</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">sp2</span><span class="p">)</span>
<span class="go">[word: 24]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.squares">
<span class="sig-name descname"><span class="pre">squares</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.squares" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a set of all distinct squares of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;cacao&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">squares</span><span class="p">())</span>
<span class="go">[word: , word: caca]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;1111&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">squares</span><span class="p">())</span>
<span class="go">[word: , word: 11, word: 1111]</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;00110011010&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">squares</span><span class="p">())</span>
<span class="go">[word: , word: 00, word: 00110011, word: 01100110, word: 1010, word: 11]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.standard_factorization">
<span class="sig-name descname"><span class="pre">standard_factorization</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.standard_factorization" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the standard factorization of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>The <em>standard factorization</em> of a word <span class="math notranslate nohighlight">\(w\)</span> of length greater than
<span class="math notranslate nohighlight">\(1\)</span> is the factorization <span class="math notranslate nohighlight">\(w = uv\)</span> where <span class="math notranslate nohighlight">\(v\)</span> is the longest proper
suffix of <span class="math notranslate nohighlight">\(w\)</span> that is a Lyndon word.</p>
<p>Note that if <span class="math notranslate nohighlight">\(w\)</span> is a Lyndon word of length greater than <span class="math notranslate nohighlight">\(1\)</span> with
standard factorization <span class="math notranslate nohighlight">\(w = uv\)</span>, then <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(v\)</span> are also Lyndon
words and <span class="math notranslate nohighlight">\(u &lt; v\)</span>.</p>
<p>See for instance <a class="reference internal" href="../../../../references/index.html#cfl1958" id="id67"><span>[CFL1958]</span></a>, <a class="reference internal" href="../../../../references/index.html#duv1983" id="id68"><span>[Duv1983]</span></a> and <a class="reference internal" href="../../../../references/index.html#lot2002" id="id69"><span>[Lot2002]</span></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – finite word of length greater than <span class="math notranslate nohighlight">\(1\)</span></p></li>
</ul>
<p>OUTPUT:</p>
<p><span class="math notranslate nohighlight">\(2\)</span>-tuple <span class="math notranslate nohighlight">\((u, v)\)</span></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Words</span><span class="p">(</span><span class="s1">&#39;01&#39;</span><span class="p">)(</span><span class="s1">&#39;0010110011&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">standard_factorization</span><span class="p">()</span>
<span class="go">(word: 001011, word: 0011)</span>
<span class="gp">sage: </span><span class="n">Words</span><span class="p">(</span><span class="s1">&#39;123&#39;</span><span class="p">)(</span><span class="s1">&#39;1223312&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">standard_factorization</span><span class="p">()</span>
<span class="go">(word: 12233, word: 12)</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">standard_factorization</span><span class="p">()</span>
<span class="go">(word: 32, word: 1)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;0010110011&#39;</span><span class="p">,</span><span class="n">alphabet</span><span class="o">=</span><span class="s1">&#39;01&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">standard_factorization</span><span class="p">()</span>
<span class="go">(word: 001011, word: 0011)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;0010110011&#39;</span><span class="p">,</span><span class="n">alphabet</span><span class="o">=</span><span class="s1">&#39;10&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">standard_factorization</span><span class="p">()</span>
<span class="go">(word: 001011001, word: 1)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;1223312&#39;</span><span class="p">,</span><span class="n">alphabet</span><span class="o">=</span><span class="s1">&#39;123&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">standard_factorization</span><span class="p">()</span>
<span class="go">(word: 12233, word: 12)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.standard_permutation">
<span class="sig-name descname"><span class="pre">standard_permutation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.standard_permutation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the standard permutation of the word
<code class="docutils literal notranslate"><span class="pre">self</span></code> on the ordered alphabet. It is defined as
the permutation with exactly the same inversions as
<code class="docutils literal notranslate"><span class="pre">self</span></code>. Equivalently, it is the permutation
of minimal length whose inverse sorts <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span> <span class="n">w</span>
<span class="go">word: 123221</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">standard_permutation</span><span class="p">();</span> <span class="n">p</span>
<span class="go">[1, 3, 6, 4, 5, 2]</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">w</span><span class="p">));</span> <span class="n">v</span>
<span class="go">word: 112223</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">q</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">Permutations</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">length</span><span class="p">())</span>
<span class="gp">....: </span>     <span class="k">if</span> <span class="n">q</span><span class="o">.</span><span class="n">length</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">p</span><span class="o">.</span><span class="n">length</span><span class="p">()</span> <span class="ow">and</span>
<span class="gp">....: </span>     <span class="n">q</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">(</span><span class="n">v</span><span class="p">)]</span>
<span class="go">[[1, 3, 6, 4, 5, 2]]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Words</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span> <span class="n">w</span>
<span class="go">word: 12322121</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">standard_permutation</span><span class="p">();</span> <span class="n">p</span>
<span class="go">[1, 4, 8, 5, 6, 2, 7, 3]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
<span class="go">word: 11122223</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Words</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span> <span class="n">w</span>
<span class="go">word: 12322121</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">standard_permutation</span><span class="p">();</span> <span class="n">p</span>
<span class="go">[6, 2, 1, 3, 4, 7, 5, 8]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
<span class="go">word: 32222111</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s1">&#39;ab&#39;</span><span class="p">)(</span><span class="s1">&#39;abbaba&#39;</span><span class="p">);</span> <span class="n">w</span>
<span class="go">word: abbaba</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">standard_permutation</span><span class="p">();</span> <span class="n">p</span>
<span class="go">[1, 4, 5, 2, 6, 3]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
<span class="go">word: aaabbb</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s1">&#39;ba&#39;</span><span class="p">)(</span><span class="s1">&#39;abbaba&#39;</span><span class="p">);</span> <span class="n">w</span>
<span class="go">word: abbaba</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">standard_permutation</span><span class="p">();</span> <span class="n">p</span>
<span class="go">[4, 1, 2, 5, 3, 6]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
<span class="go">word: bbbaaa</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.sturmian_desubstitute_as_possible">
<span class="sig-name descname"><span class="pre">sturmian_desubstitute_as_possible</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.sturmian_desubstitute_as_possible" title="Permalink to this definition">¶</a></dt>
<dd><p>Sturmian-desubstitute the word <code class="docutils literal notranslate"><span class="pre">self</span></code> as much as possible.</p>
<p>The finite word <code class="docutils literal notranslate"><span class="pre">self</span></code> must be defined on a two-letter
alphabet or use at most two letters.</p>
<p>It can be Sturmian desubstituted if one letter appears
isolated: the Sturmian desubstitution consists in removing one
letter per run of the non-isolated letter. The accelerated
Sturmian desubstitution consists in removing a run equal to
the length of the shortest inner run from any run of the
non-isolated letter (including possible leading and trailing
runs even if they have shorter length). The (accelerated)
Sturmian desubstitution is done as much as possible. A word is
a factor of a Sturmian word if, and only if, the result is the
empty word.</p>
<p>OUTPUT:</p>
<p>a finite word defined on a two-letter alphabet</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;10111101101110111&#39;</span><span class="p">,</span><span class="n">alphabet</span><span class="o">=</span><span class="s1">&#39;01&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">u</span>
<span class="go">word: 10111101101110111</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">sturmian_desubstitute_as_possible</span><span class="p">()</span> <span class="p">;</span> <span class="n">v</span>
<span class="go">word: 01100101</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">==</span> <span class="n">v</span><span class="o">.</span><span class="n">sturmian_desubstitute_as_possible</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;azaazaaazaaazaazaaaz&#39;</span><span class="p">,</span> <span class="n">alphabet</span><span class="o">=</span><span class="s1">&#39;az&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sturmian_desubstitute_as_possible</span><span class="p">()</span>
<span class="go">word:</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li><p>Thierry Monteil</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.subword_complementaries">
<span class="sig-name descname"><span class="pre">subword_complementaries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.subword_complementaries" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the possible complementaries <code class="docutils literal notranslate"><span class="pre">other</span></code> minus <code class="docutils literal notranslate"><span class="pre">self</span></code> if
<code class="docutils literal notranslate"><span class="pre">self</span></code> is a subword of <code class="docutils literal notranslate"><span class="pre">other</span></code> (empty list otherwise).
The complementary is made of all the letters that are in <code class="docutils literal notranslate"><span class="pre">other</span></code> once
we removed the letters of <code class="docutils literal notranslate"><span class="pre">self</span></code>.
There can be more than one.</p>
<p>To check whether <code class="docutils literal notranslate"><span class="pre">self</span></code> is a subword of <code class="docutils literal notranslate"><span class="pre">other`</span> <span class="pre">(without</span> <span class="pre">knowing</span> <span class="pre">its</span>
<span class="pre">complementaries),</span> <span class="pre">use</span> <span class="pre">``self.is_subword_of(other)</span></code>, and to count the
number of occurrences of <code class="docutils literal notranslate"><span class="pre">self</span></code> in <code class="docutils literal notranslate"><span class="pre">other</span></code>, use
<code class="docutils literal notranslate"><span class="pre">other.number_of_subword_occurrences(self)</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> – finite word</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>list of all the complementary subwords of <code class="docutils literal notranslate"><span class="pre">self</span></code> in <code class="docutils literal notranslate"><span class="pre">other</span></code>.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;tamtam&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">subword_complementaries</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;ta&#39;</span><span class="p">))</span>
<span class="go">[]</span>

<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;mta&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">subword_complementaries</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;tamtam&#39;</span><span class="p">))</span>
<span class="go">[word: tam]</span>

<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;ta&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">subword_complementaries</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;tamtam&#39;</span><span class="p">))</span>
<span class="go">[word: mtam, word: amtm, word: tamm]</span>

<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">subword_complementaries</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">))</span>
<span class="go">[word: ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.suffix_tree">
<span class="sig-name descname"><span class="pre">suffix_tree</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.suffix_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <code class="docutils literal notranslate"><span class="pre">implicit_suffix_tree()</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abbabaab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">suffix_tree</span><span class="p">()</span>
<span class="go">Implicit Suffix Tree of the word: abbabaab</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.suffix_trie">
<span class="sig-name descname"><span class="pre">suffix_trie</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.suffix_trie" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the suffix trie of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>The <em>suffix trie</em> of a finite word <span class="math notranslate nohighlight">\(w\)</span> is a data structure
representing the factors of <span class="math notranslate nohighlight">\(w\)</span>. It is a tree whose edges are
labelled with letters of <span class="math notranslate nohighlight">\(w\)</span>, and whose leafs correspond to
suffixes of <span class="math notranslate nohighlight">\(w\)</span>.</p>
<p>Type <code class="docutils literal notranslate"><span class="pre">sage.combinat.words.suffix_trees.SuffixTrie?</span></code> for more information.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s2">&quot;cacao&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">suffix_trie</span><span class="p">()</span>
<span class="go">Suffix Trie of the word: cacao</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">suffix_trie</span><span class="p">()</span>
<span class="go">Suffix Trie of the word: 01011</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.swap">
<span class="sig-name descname"><span class="pre">swap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.swap" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the word <span class="math notranslate nohighlight">\(w\)</span> with entries at positions <code class="docutils literal notranslate"><span class="pre">i</span></code> and
<code class="docutils literal notranslate"><span class="pre">j</span></code> swapped. By default, <code class="docutils literal notranslate"><span class="pre">j</span> <span class="pre">=</span> <span class="pre">i+1</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">word: 321</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">word: 132</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s2">&quot;abba&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">word: aabb</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.swap_decrease">
<span class="sig-name descname"><span class="pre">swap_decrease</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.swap_decrease" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the word with positions <code class="docutils literal notranslate"><span class="pre">i</span></code> and <code class="docutils literal notranslate"><span class="pre">i+1</span></code> exchanged
if <code class="docutils literal notranslate"><span class="pre">self[i]</span> <span class="pre">&lt;</span> <span class="pre">self[i+1]</span></code>. Otherwise, it returns <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">swap_decrease</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">word: 312</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">swap_decrease</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">word: 132</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">swap_decrease</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="ow">is</span> <span class="n">w</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Words</span><span class="p">(</span><span class="s2">&quot;ab&quot;</span><span class="p">)(</span><span class="s2">&quot;abba&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">swap_decrease</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">word: baba</span>
<span class="gp">sage: </span><span class="n">Words</span><span class="p">(</span><span class="s2">&quot;ba&quot;</span><span class="p">)(</span><span class="s2">&quot;abba&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">swap_decrease</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">word: abba</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.swap_increase">
<span class="sig-name descname"><span class="pre">swap_increase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.swap_increase" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the word with positions <code class="docutils literal notranslate"><span class="pre">i</span></code> and <code class="docutils literal notranslate"><span class="pre">i+1</span></code> exchanged
if <code class="docutils literal notranslate"><span class="pre">self[i]</span> <span class="pre">&gt;</span> <span class="pre">self[i+1]</span></code>. Otherwise, it returns <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">swap_increase</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">word: 123</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">swap_increase</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">word: 132</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">swap_increase</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="ow">is</span> <span class="n">w</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Words</span><span class="p">(</span><span class="s2">&quot;ab&quot;</span><span class="p">)(</span><span class="s2">&quot;abba&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">swap_increase</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">word: abba</span>
<span class="gp">sage: </span><span class="n">Words</span><span class="p">(</span><span class="s2">&quot;ba&quot;</span><span class="p">)(</span><span class="s2">&quot;abba&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">swap_increase</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">word: baba</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.to_integer_list">
<span class="sig-name descname"><span class="pre">to_integer_list</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.to_integer_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of integers from <code class="docutils literal notranslate"><span class="pre">[0,1,...,self.length()-1]</span></code> in the
same relative order as the letters in <code class="docutils literal notranslate"><span class="pre">self</span></code> in the parent.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">count</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abbabaab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">to_integer_list</span><span class="p">()</span>
<span class="go">[0, 1, 1, 0, 1, 0, 0, 1]</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="s2">&quot;cacao&quot;</span><span class="p">),</span> <span class="n">length</span><span class="o">=</span><span class="s2">&quot;finite&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">to_integer_list</span><span class="p">()</span>
<span class="go">[1, 0, 1, 0, 2]</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Words</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">to_integer_list</span><span class="p">()</span>
<span class="go">[1, 0, 0, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.to_integer_word">
<span class="sig-name descname"><span class="pre">to_integer_word</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.to_integer_word" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a word over the alphabet <code class="docutils literal notranslate"><span class="pre">[0,1,...,self.length()-1]</span></code>
whose letters are in the same relative order as the letters
of <code class="docutils literal notranslate"><span class="pre">self</span></code> in the parent.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">count</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abbabaab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">to_integer_word</span><span class="p">()</span>
<span class="go">word: 01101001</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="s2">&quot;cacao&quot;</span><span class="p">),</span> <span class="n">length</span><span class="o">=</span><span class="s2">&quot;finite&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">to_integer_word</span><span class="p">()</span>
<span class="go">word: 10102</span>

<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Words</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">to_integer_word</span><span class="p">()</span>
<span class="go">word: 1002</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.to_monoid_element">
<span class="sig-name descname"><span class="pre">to_monoid_element</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.to_monoid_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">self</span></code> as an element of the free monoid with the same alphabet
as <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;aabb&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">to_monoid_element</span><span class="p">()</span>
<span class="go">a^2*b^2</span>
<span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">to_monoid_element</span><span class="p">()</span>
<span class="go">a^2*b^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.to_ordered_set_partition">
<span class="sig-name descname"><span class="pre">to_ordered_set_partition</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.to_ordered_set_partition" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the ordered set partition correspond to <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>If <span class="math notranslate nohighlight">\(w\)</span> is a finite word of length <span class="math notranslate nohighlight">\(n\)</span>, then the corresponding
ordered set partition is an ordered set partition
<span class="math notranslate nohighlight">\((P_1, P_2, \ldots, P_k)\)</span> of <span class="math notranslate nohighlight">\(\{1, 2, \ldots, n\}\)</span>, where
each block <span class="math notranslate nohighlight">\(P_i\)</span> is the set of positions at which the <span class="math notranslate nohighlight">\(i\)</span>-th
smallest letter occurring in <span class="math notranslate nohighlight">\(w\)</span> occurs in <span class="math notranslate nohighlight">\(w\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="s1">&#39;abbabaab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">to_ordered_set_partition</span><span class="p">()</span>
<span class="go">[{1, 4, 6, 7}, {2, 3, 5, 8}]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">to_ordered_set_partition</span><span class="p">()</span>
<span class="go">[{1, 3}, {4}, {2}]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">([])</span><span class="o">.</span><span class="n">to_ordered_set_partition</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">Word</span><span class="p">(</span><span class="s1">&#39;aaaaa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_ordered_set_partition</span><span class="p">()</span>
<span class="go">[{1, 2, 3, 4, 5}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.FiniteWord_class.topological_entropy">
<span class="sig-name descname"><span class="pre">topological_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.FiniteWord_class.topological_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the topological entropy for the factors of length <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p>
<p>The topological entropy of a sequence <span class="math notranslate nohighlight">\(u\)</span> is defined as the
exponential growth rate of the complexity of <span class="math notranslate nohighlight">\(u\)</span> as the length
increases: <span class="math notranslate nohighlight">\(H_{top}(u)=\lim_{n\to\infty}\frac{\log_d(p_u(n))}{n}\)</span>
where <span class="math notranslate nohighlight">\(d\)</span> denotes the cardinality of the alphabet and <span class="math notranslate nohighlight">\(p_u(n)\)</span> is
the complexity function, i.e. the number of factors of length <span class="math notranslate nohighlight">\(n\)</span>
in the sequence <span class="math notranslate nohighlight">\(u\)</span> <a class="reference internal" href="../../../../references/index.html#fog2002" id="id70"><span>[Fog2002]</span></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – a word defined over a finite alphabet</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – positive integer</p></li>
</ul>
<p>OUTPUT:</p>
<p>real number (a symbolic expression)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">topological_entropy</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">t</span>
<span class="go">1/3*log(7)/log(2)</span>
<span class="gp">sage: </span><span class="n">n</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">0.935784974019201</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">ThueMorseWord</span><span class="p">()[:</span><span class="mi">100</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">topo</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">topological_entropy</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;{} {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">(</span><span class="n">topo</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">digits</span><span class="o">=</span><span class="mi">5</span><span class="p">)))</span>
<span class="go">0 1.0000</span>
<span class="go">5 0.71699</span>
<span class="go">10 0.48074</span>
<span class="go">15 0.36396</span>
<span class="go">20 0.28774</span>
<span class="go">25 0.23628</span>
<span class="go">30 0.20075</span>
<span class="go">35 0.17270</span>
<span class="go">40 0.14827</span>
</pre></div>
</div>
<p>If no alphabet is specified, an error is raised:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Word</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">topological_entropy</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: The word must be defined over a finite alphabet</span>
</pre></div>
</div>
<p>The following is ok:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">topological_entropy</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1/3*log(18)/log(20)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.evaluation_dict">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.words.finite_word.</span></span><span class="sig-name descname"><span class="pre">evaluation_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.evaluation_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary keyed by the letters occurring in <code class="docutils literal notranslate"><span class="pre">w</span></code> with
values the number of occurrences of the letter.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">w</span></code> – a word</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.words.finite_word.word_to_ordered_set_partition">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.words.finite_word.</span></span><span class="sig-name descname"><span class="pre">word_to_ordered_set_partition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.finite_word.word_to_ordered_set_partition" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the ordered set partition corresponding to a finite
word <span class="math notranslate nohighlight">\(w\)</span>.</p>
<p>If <span class="math notranslate nohighlight">\(w\)</span> is a finite word of length <span class="math notranslate nohighlight">\(n\)</span>, then the corresponding
ordered set partition is an ordered set partition
<span class="math notranslate nohighlight">\((P_1, P_2, \ldots, P_k)\)</span> of <span class="math notranslate nohighlight">\(\{1, 2, \ldots, n\}\)</span>, where
each block <span class="math notranslate nohighlight">\(P_i\)</span> is the set of positions at which the <span class="math notranslate nohighlight">\(i\)</span>-th
smallest letter occurring in <span class="math notranslate nohighlight">\(w\)</span> occurs in <span class="math notranslate nohighlight">\(w\)</span>.
(Positions are <span class="math notranslate nohighlight">\(1\)</span>-based.)</p>
<p>This is the same functionality that
<a class="reference internal" href="#sage.combinat.words.finite_word.FiniteWord_class.to_ordered_set_partition" title="sage.combinat.words.finite_word.FiniteWord_class.to_ordered_set_partition"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_ordered_set_partition()</span></code></a>
provides, but without the wrapping: The input <span class="math notranslate nohighlight">\(w\)</span> can be given as
a list or tuple, not necessarily as a word; and the output is
returned as a list of lists (which are the blocks of the ordered
set partition in increasing order), not as an ordered set partition.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.words.finite_word</span> <span class="kn">import</span> <span class="n">word_to_ordered_set_partition</span>
<span class="gp">sage: </span><span class="n">word_to_ordered_set_partition</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="go">[[4], [1, 3], [2]]</span>
<span class="gp">sage: </span><span class="n">word_to_ordered_set_partition</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="go">[[1], [2, 3], [4]]</span>
<span class="gp">sage: </span><span class="n">word_to_ordered_set_partition</span><span class="p">(</span><span class="s2">&quot;noob&quot;</span><span class="p">)</span>
<span class="go">[[4], [1], [2, 3]]</span>
<span class="gp">sage: </span><span class="n">word_to_ordered_set_partition</span><span class="p">(</span><span class="n">Word</span><span class="p">(</span><span class="s2">&quot;hell&quot;</span><span class="p">))</span>
<span class="go">[[2], [1], [3, 4]]</span>
<span class="gp">sage: </span><span class="n">word_to_ordered_set_partition</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span>
<span class="go">[[1]]</span>
<span class="gp">sage: </span><span class="n">word_to_ordered_set_partition</span><span class="p">([])</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Finite word</a><ul>
<li><a class="reference internal" href="#creation-of-a-finite-word">Creation of a finite word</a></li>
<li><a class="reference internal" href="#functions-and-algorithms">Functions and algorithms</a></li>
<li><a class="reference internal" href="#factors-and-rauzy-graphs">Factors and Rauzy Graphs</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="alphabet.html"
                        title="previous chapter">Alphabet</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="infinite_word.html"
                        title="next chapter">Infinite word</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/sage/combinat/words/finite_word.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="infinite_word.html" title="Infinite word"
             >next</a> |</li>
        <li class="right" >
          <a href="alphabet.html" title="Alphabet"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Sage 9.4 Reference Manual: Combinatorics</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../../module_list.html" >Comprehensive Module list</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Finite word</a></li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2021, The Sage Development Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.0.1.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* The sidebar toggle adapts its height to the bodywrapper height. */
    const resizeObserver = new ResizeObserver(entries => {
        tog.height(bod.height());
    });
    resizeObserver.observe(bod[0]);

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>