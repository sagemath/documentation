<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="IntegerFactorization objects" href="factorization_integer.html" /><link rel="prev" title="Formal sums" href="formal_sum.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>Factorizations - Parents and Elements</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom-furo.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Parents and Elements</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 10.0 Reference Manual</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../index.html">Home - Parents and Elements</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="sage_object.html">Abstract base class for Sage objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="category_object.html">Base class for objects of a category</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="parent.html">Base class for parent objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="indexed_generators.html">Indexed Generators</a></li>
<li class="toctree-l1"><a class="reference internal" href="nonexact.html">Precision management for non-exact objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="global_options.html">Global options</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="parent_old.html">Base class for old-style parent objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="parent_base.html">Base class for old-style parent objects with a base ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="parent_gens.html">Base class for old-style parent objects with generators</a></li>
<li class="toctree-l1"><a class="reference internal" href="gens_py.html">Pure python code for abstract base class for objects with generators</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="element.html">Elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="element_wrapper.html">Element Wrapper</a></li>
<li class="toctree-l1"><a class="reference internal" href="list_clone.html">Elements, Array and Lists With Clone Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="list_clone_demo.html">Elements, Array and Lists With Clone Protocol, demonstration classes</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="formal_sum.html">Formal sums</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Factorizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="factorization_integer.html">IntegerFactorization objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="sequence.html">Finite Homogeneous Sequences</a></li>
<li class="toctree-l1"><a class="reference internal" href="set_factories.html">Set factories</a></li>
<li class="toctree-l1"><a class="reference internal" href="set_factories_example.html">An example of set factory</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="proof/proof.html">Global proof preferences</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/proof.html">Whether or not computations are provably correct by default</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="richcmp.html">Cython-like rich comparisons in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="unique_representation.html">Unique Representation</a></li>
<li class="toctree-l1"><a class="reference internal" href="factory.html">Factory for cached representations</a></li>
<li class="toctree-l1"><a class="reference internal" href="dynamic_class.html">Dynamic classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="mutability.html">Mutability Cython Implementation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="debug_options.html">Debug options for the <code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.structure</span></code> modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="list_clone_timings.html">Performance Test for Clone Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="list_clone_timings_cy.html">Cython Functions for Timing Clone Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="test_factory.html">Test of the <code class="xref py py-mod docutils literal notranslate"><span class="pre">factory</span></code> module</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="factorizations">
<span id="sage-structure-factorization"></span><h1>Factorizations<a class="headerlink" href="#factorizations" title="Permalink to this heading">#</a></h1>
<span class="target" id="module-sage.structure.factorization"></span><p>The <a class="reference internal" href="#sage.structure.factorization.Factorization" title="sage.structure.factorization.Factorization"><code class="xref py py-class docutils literal notranslate"><span class="pre">Factorization</span></code></a> class provides a structure for holding quite
general lists of objects with integer multiplicities.  These may hold
the results of an arithmetic or algebraic factorization, where the
objects may be primes or irreducible polynomials and the
multiplicities are the (non-zero) exponents in the factorization.  For
other types of examples, see below.</p>
<p><a class="reference internal" href="#sage.structure.factorization.Factorization" title="sage.structure.factorization.Factorization"><code class="xref py py-class docutils literal notranslate"><span class="pre">Factorization</span></code></a> class objects contain a <code class="docutils literal notranslate"><span class="pre">list</span></code>, so can be
printed nicely and be manipulated like a list of prime-exponent pairs,
or easily turned into a plain list.  For example, we factor the
integer <span class="math notranslate nohighlight">\(-45\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="o">-</span><span class="mi">45</span><span class="p">)</span>
</pre></div>
</div>
<p>This returns an object of type <a class="reference internal" href="#sage.structure.factorization.Factorization" title="sage.structure.factorization.Factorization"><code class="xref py py-class docutils literal notranslate"><span class="pre">Factorization</span></code></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.structure.factorization_integer.IntegerFactorization&#39;&gt;</span>
</pre></div>
</div>
<p>It prints in a nice factored form:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span>
<span class="go">-1 * 3^2 * 5</span>
</pre></div>
</div>
<p>There is an underlying list representation, which ignores the unit part:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="go">[(3, 2), (5, 1)]</span>
</pre></div>
</div>
<p>A <a class="reference internal" href="#sage.structure.factorization.Factorization" title="sage.structure.factorization.Factorization"><code class="xref py py-class docutils literal notranslate"><span class="pre">Factorization</span></code></a> is not actually a list:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>However, we can access the <a class="reference internal" href="#sage.structure.factorization.Factorization" title="sage.structure.factorization.Factorization"><code class="xref py py-class docutils literal notranslate"><span class="pre">Factorization</span></code></a> F itself as if it were a list:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">(3, 2)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">(5, 1)</span>
</pre></div>
</div>
<p>To get at the unit part, use the <a class="reference internal" href="#sage.structure.factorization.Factorization.unit" title="sage.structure.factorization.Factorization.unit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Factorization.unit()</span></code></a> function:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">unit</span><span class="p">()</span>
<span class="go">-1</span>
</pre></div>
</div>
<p>All factorizations are immutable, up to ordering with <code class="docutils literal notranslate"><span class="pre">sort()</span></code> and
simplifying with <code class="docutils literal notranslate"><span class="pre">simplify()</span></code>.  Thus if you write a function that
returns a cached version of a factorization, you do not have to return
a copy.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">);</span> <span class="n">F</span>
<span class="go">-1 * 2^2 * 3</span>
<span class="gp">sage: </span><span class="n">F</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: &#39;Factorization&#39; object does not support item assignment</span>
</pre></div>
</div>
<p>EXAMPLES:</p>
<p>This more complicated example involving polynomials also illustrates
that the unit part is not discarded from factorizations:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="mf">.0</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span>
<span class="go">-5*x^2 + 25*x - 30</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">factor</span><span class="p">();</span> <span class="n">F</span>
<span class="go">(-5) * (x - 3) * (x - 2)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">unit</span><span class="p">()</span>
<span class="go">-5</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="go">-5*x^2 + 25*x - 30</span>
</pre></div>
</div>
<p>The underlying list is the list of pairs <span class="math notranslate nohighlight">\((p_i, e_i)\)</span>, where each
<span class="math notranslate nohighlight">\(p_i\)</span> is a ‘prime’ and each <span class="math notranslate nohighlight">\(e_i\)</span> is an integer. The unit part
is discarded by the list:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="go">[(x - 3, 1), (x - 2, 1)]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">F</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">(x - 2, 1)</span>
</pre></div>
</div>
<p>In the ring <span class="math notranslate nohighlight">\(\ZZ[x]\)</span>, the integer <span class="math notranslate nohighlight">\(-5\)</span> is not a unit, so the
factorization has three factors:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="mf">.0</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span>
<span class="go">-5*x^2 + 25*x - 30</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">factor</span><span class="p">();</span> <span class="n">F</span>
<span class="go">(-1) * 5 * (x - 3) * (x - 2)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">universe</span><span class="p">()</span>
<span class="go">Univariate Polynomial Ring in x over Integer Ring</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">unit</span><span class="p">()</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="go">[(5, 1), (x - 3, 1), (x - 2, 1)]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="go">-5*x^2 + 25*x - 30</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>On the other hand, -1 is a unit in <span class="math notranslate nohighlight">\(\ZZ\)</span>, so it is included in the unit:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="mf">.0</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">factor</span><span class="p">();</span> <span class="n">F</span>
<span class="go">(-1) * (x - 3) * (x - 2)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">unit</span><span class="p">()</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="go">[(x - 3, 1), (x - 2, 1)]</span>
</pre></div>
</div>
<p>Factorizations can involve fairly abstract mathematical objects:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">ModularSymbols</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">factorization</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">F</span>
<span class="go">(Modular Symbols subspace of dimension 2 of Modular Symbols space of dimension 6 for Gamma_0(11) of weight 4 with sign 0 over Rational Field) *</span>
<span class="go">(Modular Symbols subspace of dimension 2 of Modular Symbols space of dimension 6 for Gamma_0(11) of weight 4 with sign 0 over Rational Field) *</span>
<span class="go">(Modular Symbols subspace of dimension 2 of Modular Symbols space of dimension 6 for Gamma_0(11) of weight 4 with sign 0 over Rational Field)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.structure.factorization.Factorization&#39;&gt;</span>


<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in a with defining polynomial x^2 + 3</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">15</span><span class="p">);</span> <span class="n">f</span>
<span class="go">(Fractional ideal (1/2*a + 3/2))^2 * (Fractional ideal (5))</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">universe</span><span class="p">()</span>
<span class="go">Monoid of ideals of Number Field in a with defining polynomial x^2 + 3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">unit</span><span class="p">()</span>
<span class="go">Fractional ideal (1)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">=</span><span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span> <span class="n">g</span>
<span class="go">(Fractional ideal (1/2*a + 3/2))^4</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">lcm</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">(Fractional ideal (1/2*a + 3/2))^4 * (Fractional ideal (5))</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">(Fractional ideal (1/2*a + 3/2))^2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>William Stein (2006-01-22): added unit part as suggested by David Kohel.</p></li>
<li><p>William Stein (2008-01-17): wrote much of the documentation and
fixed a couple of bugs.</p></li>
<li><p>Nick Alexander (2008-01-19): added support for non-commuting factors.</p></li>
<li><p>John Cremona (2008-08-22): added division, lcm, gcd, is_integral and
universe functions</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="sage.structure.factorization.Factorization">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.structure.factorization.</span></span><span class="sig-name descname"><span class="pre">Factorization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simplify</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.structure.factorization.Factorization" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="sage_object.html#sage.structure.sage_object.SageObject" title="sage.structure.sage_object.SageObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">SageObject</span></code></a></p>
<p>A formal factorization of an object.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="mi">2006</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">factor</span><span class="p">();</span> <span class="n">F</span>
<span class="go">2 * 17 * 59</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">unit</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="o">-</span><span class="mi">2006</span><span class="p">);</span> <span class="n">F</span>
<span class="go">-1 * 2 * 17 * 59</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">unit</span><span class="p">()</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">dumps</span><span class="p">())</span> <span class="o">==</span> <span class="n">F</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Factorization</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: no conversion of this rational to integer</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.structure.factorization.Factorization.base_change">
<span class="sig-name descname"><span class="pre">base_change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">U</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.structure.factorization.Factorization.base_change" title="Permalink to this definition">#</a></dt>
<dd><p>Return the factorization self, with its factors (including the
unit part) coerced into the universe <span class="math notranslate nohighlight">\(U\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="mi">2006</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">universe</span><span class="p">()</span>
<span class="go">Integer Ring</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">base_change</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">universe</span><span class="p">()</span>
<span class="go">Univariate Polynomial Ring in x over Integer Ring</span>
</pre></div>
</div>
<p>This method will return a TypeError if the coercion is not
possible:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">g</span><span class="p">);</span> <span class="n">F</span>
<span class="go">(x - 1) * (x + 1)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">universe</span><span class="p">()</span>
<span class="go">Univariate Polynomial Ring in x over Integer Ring</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">base_change</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: Impossible to coerce the factors of (x - 1) * (x + 1) into Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.structure.factorization.Factorization.expand">
<span class="sig-name descname"><span class="pre">expand</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.structure.factorization.Factorization.expand" title="Permalink to this definition">#</a></dt>
<dd><p>Return the product of the factors in the factorization, multiplied out.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="o">-</span><span class="mi">2006</span><span class="p">);</span> <span class="n">F</span>
<span class="go">-1 * 2 * 17 * 59</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="go">-2006</span>

<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FreeAlgebra</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Factorization</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">)]);</span> <span class="n">F</span>
<span class="go">x^3 * y^2 * x</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="go">x^3*y^2*x</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.structure.factorization.Factorization.gcd">
<span class="sig-name descname"><span class="pre">gcd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.structure.factorization.Factorization.gcd" title="Permalink to this definition">#</a></dt>
<dd><p>Return the gcd of two factorizations.</p>
<p>If the two factorizations have different universes, this
method will attempt to find a common universe for the
gcd.  A TypeError is raised if this is impossible.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">factor</span><span class="p">(</span><span class="o">-</span><span class="mi">160</span><span class="p">))</span>
<span class="go">2 * 5</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">gcd</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span><span class="mi">160</span><span class="p">))</span>
<span class="go">2 * 5</span>

<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">factor</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">factor</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">10</span><span class="p">)))</span><span class="o">.</span><span class="n">universe</span><span class="p">()</span>
<span class="go">Univariate Polynomial Ring in x over Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.structure.factorization.Factorization.is_commutative">
<span class="sig-name descname"><span class="pre">is_commutative</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.structure.factorization.Factorization.is_commutative" title="Permalink to this definition">#</a></dt>
<dd><p>Return True if my factors commute.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="mi">2006</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">is_commutative</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">23</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">is_commutative</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FreeAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Factorization</span><span class="p">([(</span><span class="n">z</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">is_commutative</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">F</span><span class="o">*</span><span class="n">F</span><span class="o">^-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_commutative</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.structure.factorization.Factorization.is_integral">
<span class="sig-name descname"><span class="pre">is_integral</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.structure.factorization.Factorization.is_integral" title="Permalink to this definition">#</a></dt>
<dd><p>Return True iff all exponents of this Factorization are non-negative.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">);</span> <span class="n">F</span>
<span class="go">-1 * 2 * 5</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span> <span class="o">/</span> <span class="n">factor</span><span class="p">(</span><span class="mi">16</span><span class="p">);</span> <span class="n">F</span>
<span class="go">-1 * 2^-3 * 5</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.structure.factorization.Factorization.lcm">
<span class="sig-name descname"><span class="pre">lcm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.structure.factorization.Factorization.lcm" title="Permalink to this definition">#</a></dt>
<dd><p>Return the lcm of two factorizations.</p>
<p>If the two factorizations have different universes, this
method will attempt to find a common universe for the
lcm.  A TypeError is raised if this is impossible.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">lcm</span><span class="p">(</span><span class="n">factor</span><span class="p">(</span><span class="o">-</span><span class="mi">16</span><span class="p">))</span>
<span class="go">2^4 * 5</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">lcm</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">16</span><span class="p">))</span>
<span class="go">2^4 * 5</span>

<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">factor</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">lcm</span><span class="p">(</span><span class="n">factor</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">10</span><span class="p">)))</span><span class="o">.</span><span class="n">universe</span><span class="p">()</span>
<span class="go">Univariate Polynomial Ring in x over Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.structure.factorization.Factorization.prod">
<span class="sig-name descname"><span class="pre">prod</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.structure.factorization.Factorization.prod" title="Permalink to this definition">#</a></dt>
<dd><p>Return the product of the factors in the factorization, multiplied out.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="o">-</span><span class="mi">2006</span><span class="p">);</span> <span class="n">F</span>
<span class="go">-1 * 2 * 17 * 59</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="go">-2006</span>

<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FreeAlgebra</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Factorization</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">)]);</span> <span class="n">F</span>
<span class="go">x^3 * y^2 * x</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="go">x^3*y^2*x</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.structure.factorization.Factorization.radical">
<span class="sig-name descname"><span class="pre">radical</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.structure.factorization.Factorization.radical" title="Permalink to this definition">#</a></dt>
<dd><p>Return the factorization of the radical of the value of self.</p>
<p>First, check that all exponents in the factorization are
positive, raise ValueError otherwise.  If all exponents are
positive, return self with all exponents set to 1 and with the
unit set to 1.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">);</span> <span class="n">F</span>
<span class="go">-1 * 2^2 * 5^2</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">radical</span><span class="p">()</span>
<span class="go">2 * 5</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">radical</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: All exponents in the factorization must be positive.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.structure.factorization.Factorization.radical_value">
<span class="sig-name descname"><span class="pre">radical_value</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.structure.factorization.Factorization.radical_value" title="Permalink to this definition">#</a></dt>
<dd><p>Return the product of the prime factors in self.</p>
<p>First, check that all exponents in the factorization are
positive, raise ValueError otherwise.  If all exponents are
positive, return the product of the prime factors in self.
This should be functionally equivalent to
self.radical().value()</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">);</span> <span class="n">F</span>
<span class="go">-1 * 2^2 * 5^2</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">radical_value</span><span class="p">()</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">radical_value</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: All exponents in the factorization must be positive.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.structure.factorization.Factorization.simplify">
<span class="sig-name descname"><span class="pre">simplify</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.structure.factorization.Factorization.simplify" title="Permalink to this definition">#</a></dt>
<dd><p>Combine adjacent products as much as possible.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.structure.factorization.Factorization.sort">
<span class="sig-name descname"><span class="pre">sort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.structure.factorization.Factorization.sort" title="Permalink to this definition">#</a></dt>
<dd><p>Sort the factors in this factorization.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">key</span></code> - (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) comparison key</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>changes this factorization to be sorted (inplace)</p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">key</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, we determine the comparison key as
follows:</p>
<p>If the prime in the first factor has a dimension
method, then we sort based first on <em>dimension</em> then on
the exponent.</p>
<p>If there is no dimension method, we next
attempt to sort based on a degree method, in which case, we
sort based first on <em>degree</em>, then exponent to break ties
when two factors have the same degree, and if those match
break ties based on the actual prime itself.</p>
<p>Otherwise, we sort according to the prime itself.</p>
<p>EXAMPLES:</p>
<p>We create a factored polynomial:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span> <span class="n">F</span>
<span class="go">(x + 1) * (x^2 - x + 1)</span>
</pre></div>
</div>
<p>We sort it by decreasing degree:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:(</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">degree</span><span class="p">(),</span> <span class="n">x</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">F</span>
<span class="go">(x^2 - x + 1) * (x + 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.structure.factorization.Factorization.unit">
<span class="sig-name descname"><span class="pre">unit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.structure.factorization.Factorization.unit" title="Permalink to this definition">#</a></dt>
<dd><p>Return the unit part of this factorization.</p>
<p>EXAMPLES:</p>
<p>We create a polynomial over the real double field and factor it:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">RDF</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span> <span class="n">F</span>
<span class="go">(-2.0) * (x^2 + 0.5000000000000001)</span>
</pre></div>
</div>
<p>Note that the unit part of the factorization is <span class="math notranslate nohighlight">\(-2.0\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">unit</span><span class="p">()</span>
<span class="go">-2.0</span>

<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="o">-</span><span class="mi">2006</span><span class="p">);</span> <span class="n">F</span>
<span class="go">-1 * 2 * 17 * 59</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">unit</span><span class="p">()</span>
<span class="go">-1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.structure.factorization.Factorization.universe">
<span class="sig-name descname"><span class="pre">universe</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.structure.factorization.Factorization.universe" title="Permalink to this definition">#</a></dt>
<dd><p>Return the parent structure of my factors.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This used to be called <code class="docutils literal notranslate"><span class="pre">base_ring</span></code>, but the universe
of a factorization need not be a ring.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="mi">2006</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">universe</span><span class="p">()</span>
<span class="go">Integer Ring</span>

<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FreeAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Factorization</span><span class="p">([(</span><span class="n">z</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">F</span><span class="o">*</span><span class="n">F</span><span class="o">^-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">universe</span><span class="p">()</span>
<span class="go">Free Algebra on 3 generators (x, y, z) over Rational Field</span>

<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">ModularSymbols</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">factorization</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">universe</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.structure.factorization.Factorization.value">
<span class="sig-name descname"><span class="pre">value</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.structure.factorization.Factorization.value" title="Permalink to this definition">#</a></dt>
<dd><p>Return the product of the factors in the factorization, multiplied out.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="o">-</span><span class="mi">2006</span><span class="p">);</span> <span class="n">F</span>
<span class="go">-1 * 2 * 17 * 59</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="go">-2006</span>

<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FreeAlgebra</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Factorization</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">)]);</span> <span class="n">F</span>
<span class="go">x^3 * y^2 * x</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="go">x^3*y^2*x</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="factorization_integer.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">IntegerFactorization objects</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="formal_sum.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Formal sums</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2023, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Factorizations</a><ul>
<li><a class="reference internal" href="#sage.structure.factorization.Factorization"><code class="docutils literal notranslate"><span class="pre">Factorization</span></code></a><ul>
<li><a class="reference internal" href="#sage.structure.factorization.Factorization.base_change"><code class="docutils literal notranslate"><span class="pre">base_change()</span></code></a></li>
<li><a class="reference internal" href="#sage.structure.factorization.Factorization.expand"><code class="docutils literal notranslate"><span class="pre">expand()</span></code></a></li>
<li><a class="reference internal" href="#sage.structure.factorization.Factorization.gcd"><code class="docutils literal notranslate"><span class="pre">gcd()</span></code></a></li>
<li><a class="reference internal" href="#sage.structure.factorization.Factorization.is_commutative"><code class="docutils literal notranslate"><span class="pre">is_commutative()</span></code></a></li>
<li><a class="reference internal" href="#sage.structure.factorization.Factorization.is_integral"><code class="docutils literal notranslate"><span class="pre">is_integral()</span></code></a></li>
<li><a class="reference internal" href="#sage.structure.factorization.Factorization.lcm"><code class="docutils literal notranslate"><span class="pre">lcm()</span></code></a></li>
<li><a class="reference internal" href="#sage.structure.factorization.Factorization.prod"><code class="docutils literal notranslate"><span class="pre">prod()</span></code></a></li>
<li><a class="reference internal" href="#sage.structure.factorization.Factorization.radical"><code class="docutils literal notranslate"><span class="pre">radical()</span></code></a></li>
<li><a class="reference internal" href="#sage.structure.factorization.Factorization.radical_value"><code class="docutils literal notranslate"><span class="pre">radical_value()</span></code></a></li>
<li><a class="reference internal" href="#sage.structure.factorization.Factorization.simplify"><code class="docutils literal notranslate"><span class="pre">simplify()</span></code></a></li>
<li><a class="reference internal" href="#sage.structure.factorization.Factorization.sort"><code class="docutils literal notranslate"><span class="pre">sort()</span></code></a></li>
<li><a class="reference internal" href="#sage.structure.factorization.Factorization.unit"><code class="docutils literal notranslate"><span class="pre">unit()</span></code></a></li>
<li><a class="reference internal" href="#sage.structure.factorization.Factorization.universe"><code class="docutils literal notranslate"><span class="pre">universe()</span></code></a></li>
<li><a class="reference internal" href="#sage.structure.factorization.Factorization.value"><code class="docutils literal notranslate"><span class="pre">value()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/scripts/furo.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="../../../_static/mathjax/tex-chtml.js"></script>
    </body>
</html>