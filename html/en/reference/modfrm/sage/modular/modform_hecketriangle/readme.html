<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="Graded rings of modular forms for Hecke triangle groups" href="abstract_ring.html" /><link rel="prev" title="Design notes" href="../modform/notes.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>Overview of Hecke triangle groups and modular forms for Hecke triangle groups - Modular Forms</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-furo.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-codemirror-monokai.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Modular Forms</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 10.2 Reference Manual</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../../index.html">Home - Modular Forms</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../modform/constructor.html">Creating spaces of modular forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modform/space.html">Generic spaces of modular forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modform/ambient.html">Ambient spaces of modular forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modform/ambient_eps.html">Modular forms with character</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modform/ambient_g0.html">Modular forms for <span class="math notranslate nohighlight">\(\Gamma_0(N)\)</span> over <span class="math notranslate nohighlight">\(\QQ\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../modform/ambient_g1.html">Modular forms for <span class="math notranslate nohighlight">\(\Gamma_1(N)\)</span> and <span class="math notranslate nohighlight">\(\Gamma_H(N)\)</span> over <span class="math notranslate nohighlight">\(\QQ\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../modform/ambient_R.html">Modular forms over a non-minimal base ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modform/submodule.html">Submodules of spaces of modular forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modform/cuspidal_submodule.html">The cuspidal subspace</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modform/eisenstein_submodule.html">The Eisenstein subspace</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modform/eis_series.html">Eisenstein series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modform/eis_series_cython.html">Eisenstein series, optimized</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modform/element.html">Elements of modular forms spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modform/hecke_operator_on_qexp.html">Hecke operators on <span class="math notranslate nohighlight">\(q\)</span>-expansions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modform/numerical.html">Numerical computation of newforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modform/vm_basis.html">The Victor Miller basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modform/half_integral.html">Compute spaces of half-integral weight modular forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modform/ring.html">Graded rings of modular forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modform/j_invariant.html"><span class="math notranslate nohighlight">\(q\)</span>-expansion of <span class="math notranslate nohighlight">\(j\)</span>-invariant</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modform/theta.html"><span class="math notranslate nohighlight">\(q\)</span>-expansions of theta series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modform/notes.html">Design notes</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Overview of Hecke triangle groups and modular forms for Hecke triangle groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="abstract_ring.html">Graded rings of modular forms for Hecke triangle groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="abstract_space.html">Modular forms for Hecke triangle groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="element.html">Elements of Hecke modular forms spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="graded_ring_element.html">Elements of graded rings of modular forms for Hecke triangle groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="constructor.html">Constructor for spaces of modular forms for Hecke triangle groups based on a type</a></li>
<li class="toctree-l1"><a class="reference internal" href="functors.html">Functor construction for all spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="hecke_triangle_groups.html">Hecke triangle groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="hecke_triangle_group_element.html">Hecke triangle group elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="analytic_type.html">Analytic types of modular forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="graded_ring.html">Graded rings of modular forms for Hecke triangle groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="space.html">Modular forms for Hecke triangle groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="subspace.html">Subspaces of modular forms for Hecke triangle groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="series_constructor.html">Series constructor for modular forms for Hecke triangle groups</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quasimodform/ring.html">Graded quasimodular forms ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quasimodform/element.html">Elements of quasimodular forms rings</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dirichlet.html">Dirichlet characters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cusps.html">The set <span class="math notranslate nohighlight">\(\mathbb{P}^1(\QQ)\)</span> of cusps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dims.html">Dimensions of spaces of modular forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../buzzard.html">Conjectural slopes of Hecke polynomials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../local_comp/local_comp.html">Local components of modular forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../local_comp/smoothchar.html">Smooth characters of <span class="math notranslate nohighlight">\(p\)</span>-adic fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="../local_comp/type_space.html">Type spaces of newforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../local_comp/liftings.html">Helper functions for local components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../etaproducts.html">Eta-products on modular curves <span class="math notranslate nohighlight">\(X_0(N)\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../overconvergent/weightspace.html">The space of <span class="math notranslate nohighlight">\(p\)</span>-adic weights</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overconvergent/genus0.html">Overconvergent <span class="math notranslate nohighlight">\(p\)</span>-adic modular forms for small primes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overconvergent/hecke_series.html">Atkin/Hecke series for overconvergent modular forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ssmod/ssmod.html">Module of supersingular points</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quatalg/brandt.html">Brandt modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cusps_nf.html">The set <span class="math notranslate nohighlight">\(\mathbb{P}^1(K)\)</span> of cusps of a number field <span class="math notranslate nohighlight">\(K\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../hypergeometric_motive.html">Hypergeometric motives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../multiple_zeta.html">Algebra of motivic multiple zeta values</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="overview-of-hecke-triangle-groups-and-modular-forms-for-hecke-triangle-groups">
<span id="sage-modular-modform-hecketriangle-readme"></span><h1>Overview of Hecke triangle groups and modular forms for Hecke triangle groups<a class="headerlink" href="#overview-of-hecke-triangle-groups-and-modular-forms-for-hecke-triangle-groups" title="Permalink to this heading">#</a></h1>
<span class="target" id="module-sage.modular.modform_hecketriangle.readme"></span><p>AUTHORS:</p>
<ul class="simple">
<li><p>Jonas Jermann (2013): initial version</p></li>
</ul>
<section id="hecke-triangle-groups-and-elements">
<h2>Hecke triangle groups and elements:<a class="headerlink" href="#hecke-triangle-groups-and-elements" title="Permalink to this heading">#</a></h2>
<ul>
<li><p><strong>Hecke triangle group:</strong>
The Von Dyck group corresponding to the triangle group with angles
<code class="docutils literal notranslate"><span class="pre">(pi/2,</span> <span class="pre">pi/n,</span> <span class="pre">0)</span></code> for <code class="docutils literal notranslate"><span class="pre">n=3,</span> <span class="pre">4,</span> <span class="pre">5,</span> <span class="pre">...</span></code>, generated by the conformal
circle inversion <code class="docutils literal notranslate"><span class="pre">S</span></code> and by the translation <code class="docutils literal notranslate"><span class="pre">T</span></code> by <code class="docutils literal notranslate"><span class="pre">lambda=2*cos(pi/n)</span></code>.
I.e. the subgroup of orientation preserving elements of the triangle
group generated by reflections along the boundaries of the above hyperbolic
triangle. The group is arithmetic iff <code class="docutils literal notranslate"><span class="pre">n=3,</span> <span class="pre">4,</span> <span class="pre">6,</span> <span class="pre">infinity</span></code>.</p>
<p>The group elements correspond to matrices over ZZ[lambda], namely the
corresponding order in the number field defined by the minimal polynomial
of lambda (which embeds into <code class="docutils literal notranslate"><span class="pre">AlgebraicReal</span></code> accordingly).</p>
<p>An exact symbolic expression of the corresponding transfinite diameter <code class="docutils literal notranslate"><span class="pre">d</span></code>
(which is used as a formal parameter for Fourier expansion of modular forms)
can be obtained. For arithmetic groups the (correct) rational number is
returned instead.</p>
<p>Basic matrices like <code class="docutils literal notranslate"><span class="pre">S,</span> <span class="pre">T,</span> <span class="pre">U,</span> <span class="pre">V(j)</span></code> are available.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.hecke_triangle_groups</span> <span class="kn">import</span> <span class="n">HeckeTriangleGroup</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">HeckeTriangleGroup</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span>
<span class="go">Hecke triangle group for n = 12</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_arithmetic</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">dvalue</span><span class="p">()</span>
<span class="go">e^(2*euler_gamma - 4*pi/(sqrt(6) + sqrt(2)) + psi(19/24) + psi(17/24))</span>
<span class="gp">sage: </span><span class="n">AA</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">lam</span><span class="p">())</span>
<span class="go">1.9318516525781...?</span>

<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">HeckeTriangleGroup</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span>
<span class="go">Hecke triangle group for n = 6</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_arithmetic</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">dvalue</span><span class="p">()</span>
<span class="go">1/108</span>
<span class="gp">sage: </span><span class="n">AA</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">lam</span><span class="p">())</span> <span class="o">==</span> <span class="n">AA</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(</span>
<span class="go">[ 0 -1]  [  1 lam]</span>
<span class="go">[ 1  0], [  0   1]</span>
<span class="go">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">U</span><span class="p">()</span><span class="o">^</span><span class="mi">3</span>
<span class="go">[ lam   -2]</span>
<span class="go">[   2 -lam]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">U</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Hecke triangle group for n = 6</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">U</span><span class="p">()</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Full MatrixSpace of 2 by 2 dense matrices over Maximal Order in Number Field in lam with defining polynomial x^2 - 3 with lam = 1.732050807568878?</span>
</pre></div>
</div>
</li>
<li><p><strong>Decomposition into product of generators:</strong>
It is possible to decompose any group element into products
of generators the <code class="docutils literal notranslate"><span class="pre">S</span></code> and <code class="docutils literal notranslate"><span class="pre">T</span></code>. In particular this allows
to check whether a given matrix indeed is a group element.</p>
<p>It also allows one to calculate the automorphy factor
of a modular form for the Hecke triangle group for
arbitrary arguments.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.hecke_triangle_groups</span> <span class="kn">import</span> <span class="n">HeckeTriangleGroup</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">HeckeTriangleGroup</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">element_repr_method</span><span class="p">(</span><span class="s2">&quot;basic&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">sgn</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">word_S_T</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">(S, T^(-2), S, T^(-1), S, T^(-1))</span>
<span class="gp">sage: </span><span class="n">sgn</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">sgn</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Hecke triangle group for n = 6</span>

<span class="gp">sage: </span><span class="n">G</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="n">G</span><span class="o">.</span><span class="n">lam</span><span class="p">()],[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]))</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: The matrix is not an element of Hecke triangle group for n = 6, up to equivalence it identifies two nonequivalent points.</span>
<span class="gp">sage: </span><span class="n">G</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">G</span><span class="o">.</span><span class="n">lam</span><span class="p">()],[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]))</span>
<span class="go">-T^(-1)</span>

<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">element_repr_method</span><span class="p">(</span><span class="s2">&quot;basic&quot;</span><span class="p">)</span>

<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.space</span> <span class="kn">import</span> <span class="n">ModularForms</span>
<span class="gp">sage: </span><span class="n">MF</span> <span class="o">=</span> <span class="n">ModularForms</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ep</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">AlgebraicField</span><span class="p">()(</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MF</span><span class="o">.</span><span class="n">aut_factor</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="go">37.62113890008...? + 12.18405525839...?*I</span>
</pre></div>
</div>
</li>
<li><p><strong>Representation of elements:</strong>
An element can be represented in several ways:</p>
<ul class="simple">
<li><p>As a matrix over the base ring (default)</p></li>
<li><p>As a product of the generators <code class="docutils literal notranslate"><span class="pre">S</span></code> and <code class="docutils literal notranslate"><span class="pre">T</span></code></p></li>
<li><p>As a product of basic blocks conjugated by some element</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.hecke_triangle_groups</span> <span class="kn">import</span> <span class="n">HeckeTriangleGroup</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">HeckeTriangleGroup</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">el</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">S</span><span class="p">()</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">T</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">S</span><span class="p">()</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">T</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">element_repr_method</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">el</span>
<span class="go">[        -1      2*lam]</span>
<span class="go">[     3*lam -6*lam - 7]</span>

<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">element_repr_method</span><span class="p">(</span><span class="s2">&quot;basic&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">el</span>
<span class="go">S*T^3*S*T^(-2)</span>

<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">element_repr_method</span><span class="p">(</span><span class="s2">&quot;block&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">el</span>
<span class="go">-(S*T^3) * (V(4)^2*V(1)^3) * (S*T^3)^(-1)</span>

<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">element_repr_method</span><span class="p">(</span><span class="s2">&quot;conj&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">el</span>
<span class="go">[-V(4)^2*V(1)^3]</span>

<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">element_repr_method</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><strong>Group action on the (extended) upper half plane:</strong>
The group action of Hecke triangle groups on the (extended)
upper half plane (by linear fractional transformations)
is implemented. The implementation is not based on a
specific upper half plane model but is defined formally
(for arbitrary arguments) instead.</p>
<p>It is possible to determine the group translate of an
element in the classic (strict) fundamental domain for
the group, together with the corresponding mapping
group element.</p>
<p>The corresponding action of the group on itself by
conjugation is supported as well.</p>
<p>The usual <span class="math notranslate nohighlight">\(slash\)</span>-operator for even integer weights is
also available. It acts on rational functions (resp. polynomials).
For modular forms an evaluation argument is required.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.hecke_triangle_groups</span> <span class="kn">import</span> <span class="n">HeckeTriangleGroup</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">HeckeTriangleGroup</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">element_repr_method</span><span class="p">(</span><span class="s2">&quot;basic&quot;</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">S</span><span class="p">()</span><span class="o">.</span><span class="n">acton</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
<span class="go">-1/(e^(-2) + I)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span>
<span class="go">-S*T^(-2)*S*T^(-1)*S*T^(-1)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">acton</span><span class="p">(</span><span class="n">CC</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)))</span>
<span class="go">0.344549645079... + 0.0163901095115...*I</span>

<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">S</span><span class="p">()</span><span class="o">.</span><span class="n">acton</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">-T^(-2)*S*T^(-1)*S*T^(-1)*S</span>

<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">AlgebraicField</span><span class="p">()(</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">7</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">in_FD</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">get_FD</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span>
<span class="go">T^2*S*T^(-1)*S</span>
<span class="gp">sage: </span><span class="n">w</span>
<span class="go">0.516937798396...? + 0.964078044600...?*I</span>

<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">acton</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">==</span> <span class="n">z</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">in_FD</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">base_ring</span><span class="p">(),</span> <span class="s1">&#39;z&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rat</span> <span class="o">=</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">G</span><span class="o">.</span><span class="n">lam</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">S</span><span class="p">()</span><span class="o">.</span><span class="n">slash</span><span class="p">(</span><span class="n">rat</span><span class="p">)</span>
<span class="go">(z^6 - lam*z^4 - z^3)/(-lam*z^4 - z^3)</span>

<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">element_repr_method</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><strong>Basic properties of group elements:</strong>
The trace, sign (based on the trace), discriminant and
elliptic/parabolic/hyperbolic type are available.</p>
<p>Group elements can be displayed/represented in several ways:</p>
<ul class="simple">
<li><p>As matrices over the base ring.</p></li>
<li><p>As a word in (powers of) the generators <code class="docutils literal notranslate"><span class="pre">S</span></code> and <code class="docutils literal notranslate"><span class="pre">T</span></code>.</p></li>
<li><p>As a word in (powers of) basic block matrices <code class="docutils literal notranslate"><span class="pre">V(j)</span></code>
(resp. <code class="docutils literal notranslate"><span class="pre">U,</span> <span class="pre">S</span></code> in the elliptic case) together
with the conjugation matrix that maps the element to
this form (also see below).</p></li>
</ul>
<p>For the case <code class="docutils literal notranslate"><span class="pre">n=infinity</span></code> the last method is not
properly implemented.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.hecke_triangle_groups</span> <span class="kn">import</span> <span class="n">HeckeTriangleGroup</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">HeckeTriangleGroup</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="o">-</span><span class="n">G</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>

<span class="gp">sage: </span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">string_repr</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">))</span>
<span class="go">[               lam         -lam^2 + 1]</span>
<span class="go">[       2*lam^2 - 1 -2*lam^2 - lam + 2]</span>
<span class="gp">sage: </span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">string_repr</span><span class="p">(</span><span class="s2">&quot;basic&quot;</span><span class="p">))</span>
<span class="go">S*T^(-2)*S*T^(-1)*S*T^(-1)</span>
<span class="gp">sage: </span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">string_repr</span><span class="p">(</span><span class="s2">&quot;block&quot;</span><span class="p">))</span>
<span class="go">-(-S*T^(-1)*S) * (V(3)) * (-S*T^(-1)*S)^(-1)</span>
<span class="gp">sage: </span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">string_repr</span><span class="p">(</span><span class="s2">&quot;conj&quot;</span><span class="p">))</span>
<span class="go">[-V(3)]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span>
<span class="go">-2*lam^2 + 2</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">sign</span><span class="p">()</span>
<span class="go">[-1  0]</span>
<span class="go">[ 0 -1]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">4*lam^2 + 4*lam - 4</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_elliptic</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_hyperbolic</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</li>
<li><p><strong>Fixed points:</strong>
Elliptic, parabolic or hyperbolic fixed points of group
can be obtained. They are implemented as a (relative)
quadratic extension (given by the square root of the discriminant)
of the base ring. It is possible to query the correct embedding
into a given field.</p>
<p>Note that for hyperbolic (and parabolic) fixed points there is a
1-1 correspondence with primitive hyperbolic/parabolic group
elements (at least if <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">&lt;</span> <span class="pre">infinity</span></code>). The group action on
fixed points resp. on matrices is compatible with this correspondence.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.hecke_triangle_groups</span> <span class="kn">import</span> <span class="n">HeckeTriangleGroup</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">HeckeTriangleGroup</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">S</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">fixed_points</span><span class="p">()</span>
<span class="go">(1/2*e, -1/2*e)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">fixed_points</span><span class="p">(</span><span class="n">embedded</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(I, -I)</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">U</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">fixed_points</span><span class="p">()</span>
<span class="go">(1/2*e + 1/2*lam, -1/2*e + 1/2*lam)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">fixed_points</span><span class="p">(</span><span class="n">embedded</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(0.9009688679024...? + 0.4338837391175...?*I, 0.9009688679024...? - 0.4338837391175...?*I)</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="o">-</span><span class="n">G</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">fixed_points</span><span class="p">()</span>
<span class="go">((-3/7*lam^2 + 2/7*lam + 11/14)*e - 1/7*lam^2 + 3/7*lam + 3/7, (3/7*lam^2 - 2/7*lam - 11/14)*e - 1/7*lam^2 + 3/7*lam + 3/7)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">fixed_points</span><span class="p">(</span><span class="n">embedded</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(0.3707208390178...?, 1.103231619181...?)</span>

<span class="gp">sage: </span><span class="n">el</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">fixed_points</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">root_extension_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">==</span> <span class="n">el</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">root_extension_embedding</span><span class="p">(</span><span class="n">CC</span><span class="p">)</span>
<span class="go">Relative number field morphism:</span>
<span class="go">  From: Number Field in e with defining polynomial x^2 - 4*lam^2 - 4*lam + 4 over its base field</span>
<span class="go">  To:   Complex Field with 53 bits of precision</span>
<span class="go">  Defn: e |--&gt; 4.02438434522465</span>
<span class="go">        lam |--&gt; 1.80193773580484</span>

<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">acton</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">fixed_points</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">G</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">acton</span><span class="p">(</span><span class="n">el</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</li>
<li><p><strong>Lambda-continued fractions:</strong>
For parabolic or hyperbolic elements (resp. their corresponding
fixed point) the (negative) lambda-continued fraction expansion
is eventually periodic. The lambda-CF (i.e. the preperiod and period)
is calculated exactly.</p>
<p>In particular this allows to determine primitive and reduced
generators of group elements and the corresponding primitive
power of the element.</p>
<p>The case <code class="docutils literal notranslate"><span class="pre">n=infinity</span></code> is not properly implemented.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.hecke_triangle_groups</span> <span class="kn">import</span> <span class="n">HeckeTriangleGroup</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">HeckeTriangleGroup</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">element_repr_method</span><span class="p">(</span><span class="s2">&quot;block&quot;</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">continued_fraction</span><span class="p">()</span>
<span class="go">((1,), (1, 1, 1, 1, 2))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="n">G</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">continued_fraction</span><span class="p">()</span>
<span class="go">((1,), (2,))</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">primitive_power</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_reduced</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">continued_fraction</span><span class="p">()</span>
<span class="go">((1, 1, 1, 1), (1, 2))</span>

<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">primitive_part</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">B</span>
<span class="go">(-S*T^(-1)*S) * (V(3)) * (-S*T^(-1)*S)^(-1)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">is_reduced</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">continued_fraction</span><span class="p">()</span>
<span class="go">((1, 1, 1, 1), (1, 2))</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">==</span> <span class="n">A</span><span class="o">.</span><span class="n">sign</span><span class="p">()</span> <span class="o">*</span> <span class="n">B</span><span class="o">^</span><span class="n">A</span><span class="o">.</span><span class="n">primitive_power</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">reduce</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">B</span>
<span class="go">(T*S*T) * (V(3)) * (T*S*T)^(-1)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">is_reduced</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">continued_fraction</span><span class="p">()</span>
<span class="go">((), (1, 2))</span>

<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">element_repr_method</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><strong>Reduced and simple elements, Hecke-symmetric elements:</strong>
For primitive conjugacy classes of hyperbolic elements
the cycle of reduced elements can be obtain as well as
all simple elements. It is also possible to determine
whether a class is Hecke-symmetric.</p>
<p>The case <code class="docutils literal notranslate"><span class="pre">n=infinity</span></code> is not properly implemented.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.hecke_triangle_groups</span> <span class="kn">import</span> <span class="n">HeckeTriangleGroup</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">HeckeTriangleGroup</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">el</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">el</span><span class="o">.</span><span class="n">reduced_elements</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">continued_fraction</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">R</span><span class="p">]</span>
<span class="go">[((), (2, 1, 1, 4)), ((), (1, 1, 4, 2)), ((), (1, 4, 2, 1)), ((), (4, 2, 1, 1))]</span>

<span class="gp">sage: </span><span class="n">el</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">el</span><span class="o">.</span><span class="n">simple_elements</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">is_simple</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">R</span><span class="p">]</span>
<span class="go">[True, True, True, True]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">fp1</span><span class="p">,</span> <span class="n">fp2</span><span class="p">)</span> <span class="o">=</span> <span class="n">R</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">fixed_points</span><span class="p">(</span><span class="n">embedded</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fp2</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">fp1</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">el</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">el</span><span class="o">.</span><span class="n">is_hecke_symmetric</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">el</span><span class="o">.</span><span class="n">simple_fixed_point_set</span><span class="p">(),</span> <span class="n">el</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span><span class="o">.</span><span class="n">simple_fixed_point_set</span><span class="p">())</span>
<span class="go">({1/2*e, (-1/2*lam + 1/2)*e}, {-1/2*e, (1/2*lam - 1/2)*e})</span>
<span class="gp">sage: </span><span class="n">el</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">el</span><span class="o">.</span><span class="n">is_hecke_symmetric</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">el</span><span class="o">.</span><span class="n">simple_fixed_point_set</span><span class="p">()</span> <span class="o">==</span> <span class="n">el</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span><span class="o">.</span><span class="n">simple_fixed_point_set</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</li>
<li><p><strong>Rational period functions:</strong>
For each primitive (hyperbolic) conjugacy classes and each even
weight <code class="docutils literal notranslate"><span class="pre">k</span></code> we can associate a corresponding rational period
function. I.e. a rational function <code class="docutils literal notranslate"><span class="pre">q</span></code> of weight <code class="docutils literal notranslate"><span class="pre">k</span></code> which satisfies:
<code class="docutils literal notranslate"><span class="pre">q</span> <span class="pre">|</span> <span class="pre">S</span> <span class="pre">==</span> <span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">q</span> <span class="pre">+</span> <span class="pre">q|U</span> <span class="pre">+</span> <span class="pre">...</span> <span class="pre">+</span> <span class="pre">q|U^(n-1)</span> <span class="pre">==</span> <span class="pre">0</span></code>,
where <code class="docutils literal notranslate"><span class="pre">S</span></code>, <code class="docutils literal notranslate"><span class="pre">U</span></code> are the corresponding group elements and
<code class="docutils literal notranslate"><span class="pre">|</span></code> is the usual <span class="math notranslate nohighlight">\(slash-operator\)</span> of weight <code class="docutils literal notranslate"><span class="pre">k</span></code>.</p>
<p>The set of all rational period function is expected
to be generated by such functions.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.hecke_triangle_groups</span> <span class="kn">import</span> <span class="n">HeckeTriangleGroup</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">HeckeTriangleGroup</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">S</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">U</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">U</span><span class="p">()</span>

<span class="gp">sage: </span><span class="k">def</span> <span class="nf">is_rpf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span> <span class="o">+</span> <span class="n">S</span><span class="o">.</span><span class="n">slash</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="gp">....: </span>        <span class="k">return</span> <span class="kc">False</span>
<span class="gp">....: </span>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">sum</span><span class="p">([(</span><span class="n">U</span><span class="o">^</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">slash</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">n</span><span class="p">())])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="gp">....: </span>        <span class="k">return</span> <span class="kc">False</span>
<span class="gp">....: </span>    <span class="k">return</span> <span class="kc">True</span>

<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">base_ring</span><span class="p">(),</span> <span class="s1">&#39;z&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">is_rpf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">z</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="p">),</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>  <span class="c1"># long time</span>
<span class="go">[True, True, True, True, True, True]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">is_rpf</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">z</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>
<span class="go">[False, False, False, False, True, False]</span>

<span class="gp">sage: </span><span class="n">el</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">el</span><span class="o">.</span><span class="n">is_hecke_symmetric</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">rpf</span> <span class="o">=</span> <span class="n">el</span><span class="o">.</span><span class="n">rational_period_function</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_rpf</span><span class="p">(</span><span class="n">rpf</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">rpf</span>
<span class="go">-lam*z^4 + lam</span>
<span class="gp">sage: </span><span class="n">rpf</span> <span class="o">=</span> <span class="n">el</span><span class="o">.</span><span class="n">rational_period_function</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_rpf</span><span class="p">(</span><span class="n">rpf</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">rpf</span>
<span class="go">(lam + 1)*z^2 - lam - 1</span>
<span class="gp">sage: </span><span class="n">el</span><span class="o">.</span><span class="n">rational_period_function</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">rpf</span> <span class="o">=</span> <span class="n">el</span><span class="o">.</span><span class="n">rational_period_function</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_rpf</span><span class="p">(</span><span class="n">rpf</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">rpf</span>
<span class="go">((lam + 1)*z^2 - lam - 1)/(lam*z^4 + (-lam - 2)*z^2 + lam)</span>

<span class="gp">sage: </span><span class="n">el</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">el</span><span class="o">.</span><span class="n">is_hecke_symmetric</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">el</span><span class="o">.</span><span class="n">rational_period_function</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">rpf</span> <span class="o">=</span> <span class="n">el</span><span class="o">.</span><span class="n">rational_period_function</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">rpf</span>
<span class="go">(8*lam + 4)*z^2 - 8*lam - 4</span>
<span class="gp">sage: </span><span class="n">rpf</span> <span class="o">=</span> <span class="n">el</span><span class="o">.</span><span class="n">rational_period_function</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_rpf</span><span class="p">(</span><span class="n">rpf</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">rpf</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span>
<span class="go">(144*lam + 89)*z^8 + (-618*lam - 382)*z^6 + (951*lam + 588)*z^4 + (-618*lam - 382)*z^2 + 144*lam + 89</span>
<span class="gp">sage: </span><span class="n">el</span><span class="o">.</span><span class="n">rational_period_function</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">HeckeTriangleGroup</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">rational_period_functions</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="go">[(z^4 - 1)/z^4]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">rational_period_functions</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="go">[(z^2 - 1)/z^2, 1/z, (24*z^6 - 120*z^4 + 120*z^2 - 24)/(9*z^8 - 80*z^6 + 146*z^4 - 80*z^2 + 9), (24*z^6 - 120*z^4 + 120*z^2 - 24)/(9*z^8 - 80*z^6 + 146*z^4 - 80*z^2 + 9)]</span>
</pre></div>
</div>
</li>
<li><p><strong>Block decomposition of elements:</strong>
For each group element a very specific conjugacy representative
can be obtained. For hyperbolic and parabolic elements the
representative is a product <code class="docutils literal notranslate"><span class="pre">V(j)</span></code>-matrices. They all
have non-negative trace and the number of factors is called
the block length of the element (which is implemented).</p>
<p>Note: For this decomposition special care is given to the
sign (of the trace) of the matrices.</p>
<p>The case <code class="docutils literal notranslate"><span class="pre">n=infinity</span></code> for everything above is not properly implemented.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.hecke_triangle_groups</span> <span class="kn">import</span> <span class="n">HeckeTriangleGroup</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">HeckeTriangleGroup</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">element_repr_method</span><span class="p">(</span><span class="s2">&quot;block&quot;</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="o">-</span><span class="n">G</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span>
<span class="go">-(T*S*T) * (V(6)^3*V(3)*V(2)) * (T*S*T)^(-1)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">sign</span><span class="p">()</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">sgn</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">block_decomposition</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">((-S*T^(-1)*S) * (V(6)^3) * (-S*T^(-1)*S)^(-1), (T*S*T*S*T) * (V(3)) * (T*S*T*S*T)^(-1), (T*S*T) * (V(2)) * (T*S*T)^(-1))</span>
<span class="gp">sage: </span><span class="n">prod</span><span class="p">(</span><span class="n">L</span><span class="p">)</span><span class="o">.</span><span class="n">sign</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">==</span> <span class="n">sgn</span> <span class="o">*</span> <span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">acton</span><span class="p">(</span><span class="n">prod</span><span class="p">(</span><span class="n">L</span><span class="p">)))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">block_length</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">t</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">AA</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">discriminant</span><span class="p">())</span> <span class="o">&gt;=</span> <span class="n">AA</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="n">G</span><span class="o">.</span><span class="n">lam</span><span class="p">()</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</li>
<li><p><strong>Class number and class representatives</strong>:
The block length provides a lower bound for the
discriminant. This allows to enlist all (representatives of)
matrices of (or up to) a given discriminant.</p>
<p>Using the 1-1 correspondence with hyperbolic fixed points
(and certain hyperbolic binary quadratic forms) this
makes it possible to calculate the corresponding class number
(number of conjugacy classes for a given discriminant).</p>
<p>It also allows to list all occurring discriminants up
to some bound. Or to enlist all reduced/simple elements
resp. their corresponding hyperbolic fixed points
for the given discriminant.</p>
<p>Warning: The currently used algorithm is very slow!</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.hecke_triangle_groups</span> <span class="kn">import</span> <span class="n">HeckeTriangleGroup</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">HeckeTriangleGroup</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">element_repr_method</span><span class="p">(</span><span class="s2">&quot;basic&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_discriminant</span><span class="p">(</span><span class="mi">68</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">class_number</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">list_discriminants</span><span class="p">(</span><span class="n">D</span><span class="o">=</span><span class="mi">68</span><span class="p">)</span>
<span class="go">[4, 12, 14, 28, 32, 46, 60, 68]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">list_discriminants</span><span class="p">(</span><span class="n">D</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">hyperbolic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">primitive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[-4, -2, 0]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">class_number</span><span class="p">(</span><span class="mi">68</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">class_representatives</span><span class="p">(</span><span class="mi">68</span><span class="p">))</span>
<span class="go">[S*T^(-5)*S*T^(-1)*S, S*T^(-2)*S*T^(-1)*S*T, T*S*T^5, -S*T^(-1)*S*T^2*S*T]</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">reduced_elements</span><span class="p">(</span><span class="mi">68</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">is_reduced</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">R</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">simple_elements</span><span class="p">(</span><span class="mi">68</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">is_simple</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">R</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">element_repr_method</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">HeckeTriangleGroup</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">element_repr_method</span><span class="p">(</span><span class="s2">&quot;basic&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">list_discriminants</span><span class="p">(</span><span class="mi">9</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">lam</span><span class="p">()</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">[4*lam, 7*lam + 6, 9*lam + 5]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">list_discriminants</span><span class="p">(</span><span class="n">D</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">hyperbolic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">primitive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[-4, -lam - 2, lam - 3, 0]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">class_number</span><span class="p">(</span><span class="mi">9</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">lam</span><span class="p">()</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">class_representatives</span><span class="p">(</span><span class="mi">9</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">lam</span><span class="p">()</span> <span class="o">+</span> <span class="mi">5</span><span class="p">))</span>
<span class="go">[S*T^(-2)*S*T^(-1)*S, T*S*T^2]</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">reduced_elements</span><span class="p">(</span><span class="mi">9</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">lam</span><span class="p">()</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">is_reduced</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">R</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">simple_elements</span><span class="p">(</span><span class="mi">7</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">lam</span><span class="p">()</span> <span class="o">+</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">R</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">string_repr</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">))</span>
<span class="go">[lam + 2     lam]</span>
<span class="go">[    lam       1]</span>
<span class="go">[      1     lam]</span>
<span class="go">[    lam lam + 2]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">element_repr_method</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="modular-forms-ring-and-spaces-for-hecke-triangle-groups">
<h2>Modular forms ring and spaces for Hecke triangle groups:<a class="headerlink" href="#modular-forms-ring-and-spaces-for-hecke-triangle-groups" title="Permalink to this heading">#</a></h2>
<ul>
<li><p><strong>Analytic type:</strong>
The analytic type of forms, including the behavior at infinity:</p>
<ul class="simple">
<li><p>Meromorphic (and meromorphic at infinity)</p></li>
<li><p>Weakly holomorphic (holomorphic and meromorphic at infinity)</p></li>
<li><p>Holomorphic (and holomorphic at infinity)</p></li>
<li><p>Cuspidal (holomorphic and zero at infinity)</p></li>
</ul>
<p>Additionally the type specifies whether the form is modular or only quasi modular.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.analytic_type</span> <span class="kn">import</span> <span class="n">AnalyticType</span>
<span class="gp">sage: </span><span class="n">AnalyticType</span><span class="p">()([</span><span class="s2">&quot;quasi&quot;</span><span class="p">,</span> <span class="s2">&quot;cusp&quot;</span><span class="p">])</span>
<span class="go">quasi cuspidal</span>
</pre></div>
</div>
</li>
<li><p><strong>Modular form (for Hecke triangle groups):</strong>
A function of some analytic type which transforms like a modular form
for the given group, weight <code class="docutils literal notranslate"><span class="pre">k</span></code> and multiplier <code class="docutils literal notranslate"><span class="pre">epsilon</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f(z+lambda)</span> <span class="pre">=</span> <span class="pre">f(lambda)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f(-1/z)</span> <span class="pre">=</span> <span class="pre">epsilon</span> <span class="pre">*</span> <span class="pre">(z/i)^k</span> <span class="pre">*</span> <span class="pre">f(z)</span></code></p></li>
</ul>
<p>The multiplier is either <code class="docutils literal notranslate"><span class="pre">1</span></code> or <code class="docutils literal notranslate"><span class="pre">-1</span></code>.
The weight is a rational number of the form <code class="docutils literal notranslate"><span class="pre">4*(n*l+l')/(n-2)</span> <span class="pre">+</span> <span class="pre">(1-epsilon)*n/(n-2)</span></code>.
If <code class="docutils literal notranslate"><span class="pre">n</span></code> is odd, then the multiplier is unique and given by <code class="docutils literal notranslate"><span class="pre">(-1)^(k*(n-2)/2)</span></code>.
The space of modular forms for a given group, weight and multiplier forms a module
over the base ring. It is finite dimensional if the analytic type is <code class="docutils literal notranslate"><span class="pre">holomorphic</span></code>.</p>
<p>Modular forms can be constructed in several ways:</p>
<ul class="simple">
<li><p>Using some already available construction function for modular forms
(those function are available for all spaces/rings and in general
do not return elements of the same parent)</p></li>
<li><p>Specifying the form as a rational function in the basic generators (see below)</p></li>
<li><p>For weakly holomorphic modular forms it is possible to exactly determine the
form by specifying (sufficiently many) initial coefficients of its Fourier expansion.</p></li>
<li><p>There is even hope (no guarantee) to determine a (exact) form from
the initial numerical coefficients (see below).</p></li>
<li><p>By specifying the coefficients with respect to a basis of the space
(if the corresponding space supports coordinate vectors)</p></li>
<li><p>Arithmetic combination of forms or differential operators applied to forms</p></li>
</ul>
<p>The implementation is based on the implementation of the graded ring (see below).
All calculations are exact (no precision argument is required).
The analytic type of forms is checked during construction.
The analytic type of parent spaces after arithmetic/differential operations
with elements is changed (extended/reduced) accordingly.</p>
<p>In particular it is possible to multiply arbitrary modular forms (and end up
with an element of a modular forms space). If two forms of different
weight/multiplier are added then an element of the corresponding
modular forms ring is returned instead.</p>
<p>Elements of modular forms spaces are represented by their Fourier expansion.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.space</span> <span class="kn">import</span> <span class="n">CuspForms</span><span class="p">,</span> <span class="n">ModularForms</span><span class="p">,</span> <span class="n">MeromorphicModularForms</span>
<span class="gp">sage: </span><span class="n">MeromorphicModularForms</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">ep</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">MeromorphicModularForms(n=4, k=8, ep=1) over Integer Ring</span>
<span class="gp">sage: </span><span class="n">CF</span> <span class="o">=</span> <span class="n">CuspForms</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ep</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">CF</span>
<span class="go">CuspForms(n=7, k=12, ep=1) over Integer Ring</span>

<span class="gp">sage: </span><span class="n">MF</span> <span class="o">=</span> <span class="n">ModularForms</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ep</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">MF</span><span class="o">.</span><span class="n">pol_ring</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
</pre></div>
</div>
<p>Using existing functions:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CF</span><span class="o">.</span><span class="n">Delta</span><span class="p">()</span>
<span class="go">q + 17/(56*d)*q^2 + 88887/(2458624*d^2)*q^3 + 941331/(481890304*d^3)*q^4 + O(q^5)</span>
</pre></div>
</div>
<p>Using rational function in the basic generators:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">MF</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1 + 720*q + 179280*q^2 + 16954560*q^3 + 396974160*q^4 + O(q^5)</span>
</pre></div>
</div>
<p>Using Fourier expansions:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">qexp</span> <span class="o">=</span> <span class="n">CF</span><span class="o">.</span><span class="n">Delta</span><span class="p">()</span><span class="o">.</span><span class="n">q_expansion</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">qexp</span>
<span class="go">q + O(q^2)</span>
<span class="gp">sage: </span><span class="n">qexp</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Power Series Ring in q over Fraction Field of Univariate Polynomial Ring in d over Integer Ring</span>
<span class="gp">sage: </span><span class="n">MF</span><span class="p">(</span><span class="n">qexp</span><span class="p">)</span>
<span class="go">q - 24*q^2 + 252*q^3 - 1472*q^4 + O(q^5)</span>
</pre></div>
</div>
<p>Using coordinate vectors:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">MF</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="n">MF</span><span class="o">.</span><span class="n">f_inf</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Using arithmetic expressions:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">CF</span><span class="o">.</span><span class="n">get_d</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">CF</span><span class="o">.</span><span class="n">f_rho</span><span class="p">()</span><span class="o">^</span><span class="mi">7</span> <span class="o">/</span> <span class="p">(</span><span class="n">d</span><span class="o">*</span><span class="n">CF</span><span class="o">.</span><span class="n">f_rho</span><span class="p">()</span><span class="o">^</span><span class="mi">7</span> <span class="o">-</span> <span class="n">d</span><span class="o">*</span><span class="n">CF</span><span class="o">.</span><span class="n">f_i</span><span class="p">()</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="n">CF</span><span class="o">.</span><span class="n">j_inv</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">MF</span><span class="o">.</span><span class="n">E4</span><span class="p">()</span><span class="o">.</span><span class="n">serre_derivative</span><span class="p">()</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span> <span class="o">*</span> <span class="n">MF</span><span class="o">.</span><span class="n">E6</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</li>
<li><p><strong>Hauptmodul:</strong>
The <code class="docutils literal notranslate"><span class="pre">j-function</span></code> for Hecke triangle groups is given by the unique Riemann map
from the hyperbolic triangle with vertices at <code class="docutils literal notranslate"><span class="pre">rho</span></code>, <code class="docutils literal notranslate"><span class="pre">i</span></code> and <code class="docutils literal notranslate"><span class="pre">infinity</span></code> to the
upper half plane, normalized such that its Fourier coefficients are real and such
that the first nontrivial Fourier coefficient is 1. The function extends to a
completely invariant weakly holomorphic function from the upper half plane to the
complex numbers. Another used normalization (in capital letters) is <code class="docutils literal notranslate"><span class="pre">J(i)=1</span></code>.
The coefficients of <code class="docutils literal notranslate"><span class="pre">j</span></code> are rational numbers up to a power of <code class="docutils literal notranslate"><span class="pre">d=1/j(i)</span></code>
which is only rational in the arithmetic cases <code class="docutils literal notranslate"><span class="pre">n=3,</span> <span class="pre">4,</span> <span class="pre">6,</span> <span class="pre">infinity</span></code>.</p>
<p>All Fourier coefficients of modular forms are based on the coefficients of <code class="docutils literal notranslate"><span class="pre">j</span></code>.
The coefficients of <code class="docutils literal notranslate"><span class="pre">j</span></code> are calculated by inverting the Fourier series of its
inverse (the series inversion is also by far the most expensive operation of all).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.graded_ring</span> <span class="kn">import</span> <span class="n">WeakModularFormsRing</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.space</span> <span class="kn">import</span> <span class="n">WeakModularForms</span>
<span class="gp">sage: </span><span class="n">WeakModularForms</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ep</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">j_inv</span><span class="p">()</span>
<span class="go">q^-1 + 744 + 196884*q + 21493760*q^2 + 864299970*q^3 + 20245856256*q^4 + O(q^5)</span>
<span class="gp">sage: </span><span class="n">WeakModularFormsRing</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">j_inv</span><span class="p">()</span>
<span class="go">f_rho^7/(f_rho^7*d - f_i^2*d)</span>
<span class="gp">sage: </span><span class="n">WeakModularFormsRing</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">red_hom</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">j_inv</span><span class="p">()</span>
<span class="go">q^-1 + 151/(392*d) + 165229/(2458624*d^2)*q + 107365/(15059072*d^3)*q^2 + 25493858865/(48358655787008*d^4)*q^3 + 2771867459/(92561489592320*d^5)*q^4 + O(q^5)</span>
</pre></div>
</div>
</li>
<li><p><strong>Basic generators:</strong>
There exist unique modular forms <code class="docutils literal notranslate"><span class="pre">f_rho</span></code>, <code class="docutils literal notranslate"><span class="pre">f_i</span></code> and <code class="docutils literal notranslate"><span class="pre">f_inf</span></code> such that
each has a simple zero at <code class="docutils literal notranslate"><span class="pre">rho=exp(pi/n)</span></code>, <code class="docutils literal notranslate"><span class="pre">i</span></code> and <code class="docutils literal notranslate"><span class="pre">infinity</span></code> resp. and
no other zeros. The forms are normalized such that their first Fourier coefficient
is <code class="docutils literal notranslate"><span class="pre">1</span></code>. They have the weight and multiplier <code class="docutils literal notranslate"><span class="pre">(4/(n-2),</span> <span class="pre">1)</span></code>, <code class="docutils literal notranslate"><span class="pre">(2*n/(n-2),</span> <span class="pre">-1)</span></code>,
<code class="docutils literal notranslate"><span class="pre">(4*n/(n-2),</span> <span class="pre">1)</span></code> resp. and can be defined in terms of the Hauptmodul <code class="docutils literal notranslate"><span class="pre">j</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.graded_ring</span> <span class="kn">import</span> <span class="n">ModularFormsRing</span>
<span class="gp">sage: </span><span class="n">ModularFormsRing</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">red_hom</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">f_rho</span><span class="p">()</span>
<span class="go">1 + 7/(100*d)*q + 21/(160000*d^2)*q^2 + 1043/(192000000*d^3)*q^3 + 45479/(1228800000000*d^4)*q^4 + O(q^5)</span>
<span class="gp">sage: </span><span class="n">ModularFormsRing</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">red_hom</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">f_i</span><span class="p">()</span>
<span class="go">1 - 13/(40*d)*q - 351/(64000*d^2)*q^2 - 13819/(76800000*d^3)*q^3 - 1163669/(491520000000*d^4)*q^4 + O(q^5)</span>
<span class="gp">sage: </span><span class="n">ModularFormsRing</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">red_hom</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">f_inf</span><span class="p">()</span>
<span class="go">q - 9/(200*d)*q^2 + 279/(640000*d^2)*q^3 + 961/(192000000*d^3)*q^4 + O(q^5)</span>
<span class="gp">sage: </span><span class="n">ModularFormsRing</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">f_inf</span><span class="p">()</span>
<span class="go">f_rho^5*d - f_i^2*d</span>
</pre></div>
</div>
</li>
<li><p><strong>Eisenstein series and Delta:</strong>
The Eisenstein series of weight <code class="docutils literal notranslate"><span class="pre">2</span></code>, <code class="docutils literal notranslate"><span class="pre">4</span></code> and <code class="docutils literal notranslate"><span class="pre">6</span></code> exist for all <code class="docutils literal notranslate"><span class="pre">n</span></code> and
are all implemented . Note that except for <code class="docutils literal notranslate"><span class="pre">n=3</span></code> the series <code class="docutils literal notranslate"><span class="pre">E4</span></code> and <code class="docutils literal notranslate"><span class="pre">E6</span></code>
do not coincide with <code class="docutils literal notranslate"><span class="pre">f_rho</span></code> and <code class="docutils literal notranslate"><span class="pre">f_i</span></code>.</p>
<p>Similarly there always exists a (generalization of) <code class="docutils literal notranslate"><span class="pre">Delta</span></code>. Except for <code class="docutils literal notranslate"><span class="pre">n=3</span></code>
it also does not coincide with <code class="docutils literal notranslate"><span class="pre">f_inf</span></code>.</p>
<p>In general Eisenstein series of all even weights exist for all <code class="docutils literal notranslate"><span class="pre">n</span></code>.
In the non-arithmetic cases they are however very hard to determine
(it’s an open problem(?) and consequently not yet implemented,
except for trivial one-dimensional cases).</p>
<p>The Eisenstein series in the arithmetic cases <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">=</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">6</span></code> are fully
implemented though. Note that this requires a lot more work/effort
for <code class="docutils literal notranslate"><span class="pre">k</span> <span class="pre">!=</span> <span class="pre">2,</span> <span class="pre">4,</span> <span class="pre">6</span></code> resp. for multidimensional spaces.</p>
<p>The case <code class="docutils literal notranslate"><span class="pre">n=infinity</span></code> is a special case (since there are two cusps)
and is not implemented yet.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.graded_ring</span> <span class="kn">import</span> <span class="n">ModularFormsRing</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.space</span> <span class="kn">import</span> <span class="n">ModularForms</span>
<span class="gp">sage: </span><span class="n">ModularFormsRing</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">E4</span><span class="p">()</span>
<span class="go">f_rho^3</span>
<span class="gp">sage: </span><span class="n">ModularFormsRing</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">E6</span><span class="p">()</span>
<span class="go">f_rho^2*f_i</span>
<span class="gp">sage: </span><span class="n">ModularFormsRing</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">Delta</span><span class="p">()</span>
<span class="go">f_rho^9*d - f_rho^4*f_i^2*d</span>
<span class="gp">sage: </span><span class="n">ModularFormsRing</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">Delta</span><span class="p">()</span> <span class="o">==</span> <span class="n">ModularFormsRing</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">f_inf</span><span class="p">()</span><span class="o">*</span><span class="n">ModularFormsRing</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">f_rho</span><span class="p">()</span><span class="o">^</span><span class="mi">4</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The basic generators in some arithmetic cases:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ModularForms</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">E6</span><span class="p">()</span>
<span class="go">1 - 504*q - 16632*q^2 - 122976*q^3 - 532728*q^4 + O(q^5)</span>
<span class="gp">sage: </span><span class="n">ModularForms</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">E6</span><span class="p">()</span>
<span class="go">1 - 56*q - 2296*q^2 - 13664*q^3 - 73976*q^4 + O(q^5)</span>
<span class="gp">sage: </span><span class="n">ModularForms</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">infinity</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">E4</span><span class="p">()</span>
<span class="go">1 + 16*q + 112*q^2 + 448*q^3 + 1136*q^4 + O(q^5)</span>
</pre></div>
</div>
<p>General Eisenstein series in some arithmetic cases:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ModularFormsRing</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">EisensteinSeries</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="o">*</span> <span class="mi">34</span>
<span class="go">25*f_rho^4 + 9*f_i^2</span>
<span class="gp">sage: </span><span class="n">ModularForms</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">EisensteinSeries</span><span class="p">()</span>
<span class="go">1 + 65520/691*q + 134250480/691*q^2 + 11606736960/691*q^3 + 274945048560/691*q^4 + O(q^5)</span>
<span class="gp">sage: </span><span class="n">ModularForms</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">EisensteinSeries</span><span class="p">()</span>
<span class="go">1 + 6552/50443*q + 13425048/50443*q^2 + 1165450104/50443*q^3 + 27494504856/50443*q^4 + O(q^5)</span>
<span class="gp">sage: </span><span class="n">ModularForms</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span> <span class="n">ep</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">EisensteinSeries</span><span class="p">()</span>
<span class="go">1 - 184/53057489*q - 386252984/53057489*q^2 - 1924704989536/53057489*q^3 - 810031218278584/53057489*q^4 + O(q^5)</span>
</pre></div>
</div>
</li>
<li><p><strong>Generator for ``k=0``, ``ep=-1``:</strong>
If <code class="docutils literal notranslate"><span class="pre">n</span></code> is even then the space of weakly holomorphic modular forms of weight
<code class="docutils literal notranslate"><span class="pre">0</span></code> and multiplier <code class="docutils literal notranslate"><span class="pre">-1</span></code> is not empty and generated by one element,
denoted by <code class="docutils literal notranslate"><span class="pre">g_inv</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.space</span> <span class="kn">import</span> <span class="n">WeakModularForms</span>
<span class="gp">sage: </span><span class="n">WeakModularForms</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ep</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">g_inv</span><span class="p">()</span>
<span class="go">q^-1 - 24 - 3820*q - 100352*q^2 - 1217598*q^3 - 10797056*q^4 + O(q^5)</span>
<span class="gp">sage: </span><span class="n">WeakModularFormsRing</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">g_inv</span><span class="p">()</span>
<span class="go">f_rho^4*f_i/(f_rho^8*d - f_i^2*d)</span>
</pre></div>
</div>
</li>
<li><p><strong>Quasi modular form (for Hecke triangle groups):</strong>
<code class="docutils literal notranslate"><span class="pre">E2</span></code> no longer transforms like a modular form but like a quasi modular form.
More generally quasi modular forms are given in terms of modular forms and powers
of <code class="docutils literal notranslate"><span class="pre">E2</span></code>. E.g. a holomorphic quasi modular form is a sum of holomorphic modular
forms multiplied with a power of <code class="docutils literal notranslate"><span class="pre">E2</span></code> such that the weights and multipliers match up.
The space of quasi modular forms for a given group, weight and multiplier forms a
module over the base ring. It is finite dimensional if the analytic type is
<code class="docutils literal notranslate"><span class="pre">holomorphic</span></code>.</p>
<p>The implementation and construction are analogous to modular forms (see above).
In particular construction of quasi weakly holomorphic forms by their initial
Laurent coefficients is supported as well!</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.graded_ring</span> <span class="kn">import</span> <span class="n">ModularFormsRing</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.space</span> <span class="kn">import</span> <span class="n">QuasiCuspForms</span><span class="p">,</span> <span class="n">QuasiModularForms</span><span class="p">,</span> <span class="n">QuasiWeakModularForms</span>
<span class="gp">sage: </span><span class="n">QuasiCuspForms</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ep</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">QuasiCuspForms(n=7, k=12, ep=1) over Integer Ring</span>
<span class="gp">sage: </span><span class="n">QuasiModularForms</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">ep</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">QuasiModularForms(n=4, k=8, ep=-1) over Integer Ring</span>

<span class="gp">sage: </span><span class="n">QuasiModularForms</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ep</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">E2</span><span class="p">()</span>
<span class="go">1 - 8*q - 40*q^2 - 32*q^3 - 104*q^4 + O(q^5)</span>
</pre></div>
</div>
<p>A quasi weak form can be constructed by using its initial Laurent expansion:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QF</span> <span class="o">=</span> <span class="n">QuasiWeakModularForms</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">ep</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">qexp</span> <span class="o">=</span> <span class="p">(</span><span class="n">QF</span><span class="o">.</span><span class="n">quasi_part_gens</span><span class="p">(</span><span class="n">min_exp</span><span class="o">=-</span><span class="mi">1</span><span class="p">)[</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">q_expansion</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">qexp</span>
<span class="go">q^-1 - 19/(64*d) - 7497/(262144*d^2)*q + 15889/(8388608*d^3)*q^2 + 543834047/(1649267441664*d^4)*q^3 + 711869853/(43980465111040*d^5)*q^4 + O(q^5)</span>
<span class="gp">sage: </span><span class="n">qexp</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Laurent Series Ring in q over Fraction Field of Univariate Polynomial Ring in d over Integer Ring</span>
<span class="gp">sage: </span><span class="n">QF</span><span class="p">(</span><span class="n">qexp</span><span class="p">)</span><span class="o">.</span><span class="n">as_ring_element</span><span class="p">()</span>
<span class="go">f_rho^3*f_i*E2^2/(f_rho^8*d - f_i^2*d)</span>
<span class="gp">sage: </span><span class="n">QF</span><span class="p">(</span><span class="n">qexp</span><span class="p">)</span><span class="o">.</span><span class="n">reduced_parent</span><span class="p">()</span>
<span class="go">QuasiWeakModularForms(n=8, k=10/3, ep=-1) over Integer Ring</span>
</pre></div>
</div>
<p>Derivatives of (quasi weak) modular forms are again quasi (weak) modular forms:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CF</span><span class="o">.</span><span class="n">f_inf</span><span class="p">()</span><span class="o">.</span><span class="n">derivative</span><span class="p">()</span> <span class="o">==</span> <span class="n">CF</span><span class="o">.</span><span class="n">f_inf</span><span class="p">()</span><span class="o">*</span><span class="n">CF</span><span class="o">.</span><span class="n">E2</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</li>
<li><p><strong>Ring of (quasi) modular forms:</strong>
The ring of (quasi) modular forms for a given analytic type and Hecke triangle group.
In fact it is a graded algebra over the base ring where the grading is over
<code class="docutils literal notranslate"><span class="pre">1/(n-2)*Z</span> <span class="pre">x</span> <span class="pre">Z/(2Z)</span></code> corresponding to the weight and multiplier.
A ring element is thus a finite linear combination of (quasi) modular forms
of (possibly) varying weights and multipliers.</p>
<p>Each ring element is represented as a rational function in the
generators <code class="docutils literal notranslate"><span class="pre">f_rho</span></code>, <code class="docutils literal notranslate"><span class="pre">f_i</span></code> and <code class="docutils literal notranslate"><span class="pre">E2</span></code>. The representations and arithmetic
operations are exact (no precision argument is required).</p>
<p>Elements of the ring are represented by the rational function in the generators.</p>
<p>If the parameter <code class="docutils literal notranslate"><span class="pre">red_hom</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code> (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) then
operations with homogeneous elements try to return an element of the corresponding
vector space (if the element is homogeneous) instead of the forms ring.
It is also easier to use the forms ring with <code class="docutils literal notranslate"><span class="pre">red_hom=True</span></code> to construct known
forms (since then it is not required to specify the weight and multiplier).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.graded_ring</span> <span class="kn">import</span> <span class="n">QuasiModularFormsRing</span><span class="p">,</span> <span class="n">ModularFormsRing</span>
<span class="gp">sage: </span><span class="n">QuasiModularFormsRing</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">red_hom</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">QuasiModularFormsRing(n=5) over Integer Ring</span>
<span class="gp">sage: </span><span class="n">ModularFormsRing</span><span class="p">()</span>
<span class="go">ModularFormsRing(n=3) over Integer Ring</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">ModularFormsRing</span><span class="p">()</span><span class="o">.</span><span class="n">pol_ring</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>

<span class="gp">sage: </span><span class="n">ModularFormsRing</span><span class="p">()(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span>
<span class="go">f_rho + f_i</span>

<span class="gp">sage: </span><span class="n">QuasiModularFormsRing</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">red_hom</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">reduce</span><span class="p">()</span>
<span class="go">1/d*q - 9/(200*d^2)*q^2 + 279/(640000*d^3)*q^3 + 961/(192000000*d^4)*q^4 + O(q^5)</span>
</pre></div>
</div>
</li>
<li><p><strong>Construction of modular forms spaces and rings:</strong>
There are functorial constructions behind all forms spaces and rings
which assure that arithmetic operations between those spaces and rings
work and fit into the coercion framework. In particular ring elements
are interpreted as constant modular forms in this context and base
extensions are done if necessary.</p></li>
<li><p><strong>Fourier expansion of (quasi) modular forms (for Hecke triangle groups):</strong>
Each (quasi) modular form (in fact each ring element) possesses a Fourier
expansion of the form <code class="docutils literal notranslate"><span class="pre">sum_{n&gt;=n_0}</span> <span class="pre">a_n</span> <span class="pre">q^n</span></code>, where <code class="docutils literal notranslate"><span class="pre">n_0</span></code> is an integer,
<code class="docutils literal notranslate"><span class="pre">q=exp(2*pi*i*z/lambda)</span></code> and the coefficients <code class="docutils literal notranslate"><span class="pre">a_n</span></code> are rational numbers
(or more generally an extension of rational numbers) up to a power of <code class="docutils literal notranslate"><span class="pre">d</span></code>,
where <code class="docutils literal notranslate"><span class="pre">d</span></code> is the (possibly) transcendental parameter described above.
I.e. the coefficient ring is given by <code class="docutils literal notranslate"><span class="pre">Frac(R)(d)</span></code>.</p>
<p>The coefficients are calculated exactly in terms of the (formal) parameter
<code class="docutils literal notranslate"><span class="pre">d</span></code>. The expansion is calculated exactly up to the specified precision.
It is also possible to get a Fourier expansion where <code class="docutils literal notranslate"><span class="pre">d</span></code> is evaluated
to its numerical approximation.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.graded_ring</span> <span class="kn">import</span> <span class="n">ModularFormsRing</span><span class="p">,</span> <span class="n">QuasiModularFormsRing</span>
<span class="gp">sage: </span><span class="n">ModularFormsRing</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">j_inv</span><span class="p">()</span><span class="o">.</span><span class="n">q_expansion</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">q^-1 + 13/(32*d) + 1093/(16384*d^2)*q + 47/(8192*d^3)*q^2 + O(q^3)</span>
<span class="gp">sage: </span><span class="n">QuasiModularFormsRing</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">E2</span><span class="p">()</span><span class="o">.</span><span class="n">q_expansion</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1 - 9/(200*d)*q - 369/(320000*d^2)*q^2 + O(q^3)</span>
<span class="gp">sage: </span><span class="n">QuasiModularFormsRing</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">E2</span><span class="p">()</span><span class="o">.</span><span class="n">q_expansion_fixed_d</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1.000000000000... - 6.380956565426...*q - 23.18584547617...*q^2 + O(q^3)</span>
</pre></div>
</div>
</li>
<li><p><strong>Evaluation of forms:</strong>
(Quasi) modular forms (and also ring elements) can be viewed as
functions from the upper half plane and can be numerically evaluated
by using the Fourier expansion.</p>
<p>The evaluation uses the (quasi) modularity properties (if possible)
for a faster and more precise evaluation. The precision of the result
depends both on the numerical precision and on the default precision
used for the Fourier expansion.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.graded_ring</span> <span class="kn">import</span> <span class="n">ModularFormsRing</span>
<span class="gp">sage: </span><span class="n">f_i</span> <span class="o">=</span> <span class="n">ModularFormsRing</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">f_i</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f_i</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">f_i</span><span class="p">(</span><span class="n">infinity</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">f_i</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">7</span> <span class="o">+</span> <span class="mf">0.01</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<span class="go">32189.02016723... + 21226.62951394...*I</span>
</pre></div>
</div>
</li>
<li><p><strong>L-functions of forms:</strong>
Using the (pari based) function <code class="docutils literal notranslate"><span class="pre">Dokchitser</span></code> L-functions of non-constant
holomorphic modular forms are supported for all values of <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p>
<p>Note: For non-arithmetic groups this involves an irrational conductor.
The conductor for the arithmetic groups <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">=</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">6,</span> <span class="pre">infinity</span></code> is
<code class="docutils literal notranslate"><span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4</span></code> respectively.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform.eis_series</span> <span class="kn">import</span> <span class="n">eisenstein_series_lseries</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.space</span> <span class="kn">import</span> <span class="n">ModularForms</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">ModularForms</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">E4</span><span class="p">()</span><span class="o">/</span><span class="mi">240</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">lseries</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">conductor</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">check_functional_equation</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">-0.0304484570583...</span>
<span class="gp">sage: </span><span class="nb">abs</span><span class="p">(</span><span class="n">L</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">eisenstein_series_lseries</span><span class="p">(</span><span class="mi">4</span><span class="p">)(</span><span class="mi">1</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">53</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">taylor_series</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">-0.0304484570583... - 0.0504570844798...*z - 0.0350657360354...*z^2 + O(z^3)</span>
<span class="gp">sage: </span><span class="n">coeffs</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">q_expansion_vector</span><span class="p">(</span><span class="n">min_exp</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_exp</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fix_d</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">abs</span><span class="p">(</span><span class="n">L</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">([</span><span class="n">coeffs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">ZZ</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">coeffs</span><span class="p">))])</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">53</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">ModularForms</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">ep</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">E6</span><span class="p">()</span><span class="o">.</span><span class="n">lseries</span><span class="p">(</span><span class="n">num_prec</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">conductor</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">check_functional_equation</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">eps</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="nb">abs</span><span class="p">(</span><span class="n">L</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">ModularForms</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">Delta</span><span class="p">()</span><span class="o">.</span><span class="n">lseries</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">conductor</span>
<span class="go">3.86494445880...</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">check_functional_equation</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">taylor_series</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">2.15697985314... - 1.17385918996...*z + 0.605865993050...*z^2 + O(z^3)</span>

<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">ModularForms</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">infinity</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ep</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">f_i</span><span class="p">()</span><span class="o">.</span><span class="n">lseries</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">conductor</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">check_functional_equation</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">taylor_series</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">0.000000000000... + 5.76543616701...*z + 9.92776715593...*z^2 + O(z^3)</span>
</pre></div>
</div>
</li>
<li><p><strong>(Serre) derivatives:</strong>
Derivatives and Serre derivatives of forms can be calculated.
The analytic type is extended accordingly.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.graded_ring</span> <span class="kn">import</span> <span class="n">ModularFormsRing</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.space</span> <span class="kn">import</span> <span class="n">QuasiModularForms</span>
<span class="gp">sage: </span><span class="n">f_inf</span> <span class="o">=</span> <span class="n">ModularFormsRing</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">red_hom</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">f_inf</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f_inf</span><span class="o">.</span><span class="n">derivative</span><span class="p">()</span><span class="o">/</span><span class="n">f_inf</span> <span class="o">==</span> <span class="n">QuasiModularForms</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ep</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">E2</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">ModularFormsRing</span><span class="p">()</span><span class="o">.</span><span class="n">E4</span><span class="p">()</span><span class="o">.</span><span class="n">serre_derivative</span><span class="p">()</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span> <span class="o">*</span> <span class="n">ModularFormsRing</span><span class="p">()</span><span class="o">.</span><span class="n">E6</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</li>
<li><p><strong>Basis for weakly holomorphic modular forms and Faber polynomials:</strong>
(Natural) generators of weakly holomorphic modular forms can
be obtained using the corresponding generalized Faber polynomials.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.space</span> <span class="kn">import</span> <span class="n">WeakModularForms</span><span class="p">,</span> <span class="n">CuspForms</span>
<span class="gp">sage: </span><span class="n">MF</span> <span class="o">=</span> <span class="n">WeakModularForms</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">62</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">ep</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MF</span><span class="o">.</span><span class="n">disp_prec</span><span class="p">(</span><span class="n">MF</span><span class="o">.</span><span class="n">_l1</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">MF</span><span class="o">.</span><span class="n">F_basis</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">q^2 - 41/(200*d)*q^3 + O(q^4)</span>
<span class="gp">sage: </span><span class="n">MF</span><span class="o">.</span><span class="n">F_basis</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">q - 13071/(640000*d^2)*q^3 + O(q^4)</span>
<span class="gp">sage: </span><span class="n">MF</span><span class="o">.</span><span class="n">F_basis</span><span class="p">(</span><span class="o">-</span><span class="mi">0</span><span class="p">)</span>
<span class="go">1 - 277043/(192000000*d^3)*q^3 + O(q^4)</span>
<span class="gp">sage: </span><span class="n">MF</span><span class="o">.</span><span class="n">F_basis</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">q^-2 - 162727620113/(40960000000000000*d^5)*q^3 + O(q^4)</span>
</pre></div>
</div>
</li>
<li><p><strong>Basis for quasi weakly holomorphic modular forms:</strong>
(Natural) generators of quasi weakly holomorphic modular forms can
also be obtained. In most cases it is even possible to find a basis consisting
of elements with only one non-trivial Laurent coefficient (up to some coefficient).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.space</span> <span class="kn">import</span> <span class="n">QuasiWeakModularForms</span>
<span class="gp">sage: </span><span class="n">QF</span> <span class="o">=</span> <span class="n">QuasiWeakModularForms</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">ep</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">QF</span><span class="o">.</span><span class="n">default_prec</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">QF</span><span class="o">.</span><span class="n">quasi_part_gens</span><span class="p">(</span><span class="n">min_exp</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[q^-1 + O(q),</span>
<span class="go"> 1 + O(q),</span>
<span class="go"> q^-1 - 9/(128*d) + O(q),</span>
<span class="go"> 1 + O(q),</span>
<span class="go"> q^-1 - 19/(64*d) + O(q),</span>
<span class="go"> q^-1 + 1/(64*d) + O(q)]</span>
<span class="gp">sage: </span><span class="n">QF</span><span class="o">.</span><span class="n">default_prec</span><span class="p">(</span><span class="n">QF</span><span class="o">.</span><span class="n">required_laurent_prec</span><span class="p">(</span><span class="n">min_exp</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">QF</span><span class="o">.</span><span class="n">q_basis</span><span class="p">(</span><span class="n">min_exp</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>    <span class="c1"># long time</span>
<span class="go">[q^-1 + O(q^5),</span>
<span class="go"> 1 + O(q^5),</span>
<span class="go"> q + O(q^5),</span>
<span class="go"> q^2 + O(q^5),</span>
<span class="go"> q^3 + O(q^5),</span>
<span class="go"> q^4 + O(q^5)]</span>
</pre></div>
</div>
</li>
<li><p><strong>Dimension and basis for holomorphic or cuspidal (quasi) modular forms:</strong>
For finite dimensional spaces the dimension and a basis can be obtained.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.space</span> <span class="kn">import</span> <span class="n">QuasiModularForms</span>
<span class="gp">sage: </span><span class="n">MF</span> <span class="o">=</span> <span class="n">QuasiModularForms</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">ep</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MF</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">MF</span><span class="o">.</span><span class="n">default_prec</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MF</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[1 - 37/(200*d)*q + O(q^2),</span>
<span class="go"> 1 + 33/(200*d)*q + O(q^2),</span>
<span class="go"> 1 - 27/(200*d)*q + O(q^2)]</span>
</pre></div>
</div>
</li>
<li><p><strong>Coordinate vectors for (quasi) holomorphic modular forms and (quasi) cusp forms:</strong>
For (quasi) holomorphic modular forms and (quasi) cusp forms it is possible
to determine the coordinate vectors of elements with respect to the basis.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.space</span> <span class="kn">import</span> <span class="n">ModularForms</span>
<span class="gp">sage: </span><span class="n">ModularForms</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ep</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">ModularForms</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ep</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">Delta</span><span class="p">()</span><span class="o">.</span><span class="n">coordinate_vector</span><span class="p">()</span>
<span class="go">(0, 1, 17/(56*d))</span>

<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.space</span> <span class="kn">import</span> <span class="n">QuasiCuspForms</span>
<span class="gp">sage: </span><span class="n">MF</span> <span class="o">=</span> <span class="n">QuasiCuspForms</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ep</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MF</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">13</span>
<span class="gp">sage: </span><span class="n">el</span> <span class="o">=</span> <span class="n">MF</span><span class="p">(</span><span class="n">MF</span><span class="o">.</span><span class="n">Delta</span><span class="p">()</span><span class="o">*</span><span class="n">MF</span><span class="o">.</span><span class="n">E2</span><span class="p">()</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">MF</span><span class="o">.</span><span class="n">Delta</span><span class="p">()</span><span class="o">*</span><span class="n">MF</span><span class="o">.</span><span class="n">E2</span><span class="p">()</span><span class="o">*</span><span class="n">MF</span><span class="o">.</span><span class="n">E6</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">el</span><span class="o">.</span><span class="n">coordinate_vector</span><span class="p">()</span>    <span class="c1"># long time</span>
<span class="go">(0, 0, 0, 1, 29/(196*d), 0, 0, 0, 0, 1, 17/(56*d), 0, 0)</span>
</pre></div>
</div>
</li>
<li><p><strong>Subspaces:</strong>
It is possible to construct subspaces of (quasi) holomorphic modular forms
or (quasi) cusp forms spaces with respect to a specified basis of the
corresponding ambient space. The subspaces also support coordinate
vectors with respect to its basis.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.space</span> <span class="kn">import</span> <span class="n">ModularForms</span>
<span class="gp">sage: </span><span class="n">MF</span> <span class="o">=</span> <span class="n">ModularForms</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ep</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">subspace</span> <span class="o">=</span> <span class="n">MF</span><span class="o">.</span><span class="n">subspace</span><span class="p">([</span><span class="n">MF</span><span class="o">.</span><span class="n">E4</span><span class="p">()</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="n">MF</span><span class="o">.</span><span class="n">Delta</span><span class="p">()])</span>
<span class="gp">sage: </span><span class="n">subspace</span>
<span class="go">Subspace of dimension 2 of ModularForms(n=7, k=12, ep=1) over Integer Ring</span>
<span class="gp">sage: </span><span class="n">el</span> <span class="o">=</span> <span class="n">subspace</span><span class="p">(</span><span class="n">MF</span><span class="o">.</span><span class="n">E6</span><span class="p">()</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">el</span><span class="o">.</span><span class="n">coordinate_vector</span><span class="p">()</span>
<span class="go">(1, -61/(196*d))</span>
<span class="gp">sage: </span><span class="n">el</span><span class="o">.</span><span class="n">ambient_coordinate_vector</span><span class="p">()</span>
<span class="go">(1, -61/(196*d), -51187/(614656*d^2))</span>

<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.space</span> <span class="kn">import</span> <span class="n">QuasiCuspForms</span>
<span class="gp">sage: </span><span class="n">MF</span> <span class="o">=</span> <span class="n">QuasiCuspForms</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ep</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">subspace</span> <span class="o">=</span> <span class="n">MF</span><span class="o">.</span><span class="n">subspace</span><span class="p">([</span><span class="n">MF</span><span class="o">.</span><span class="n">Delta</span><span class="p">()</span><span class="o">*</span><span class="n">MF</span><span class="o">.</span><span class="n">E2</span><span class="p">()</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">MF</span><span class="o">.</span><span class="n">E4</span><span class="p">(),</span> <span class="n">MF</span><span class="o">.</span><span class="n">Delta</span><span class="p">()</span><span class="o">*</span><span class="n">MF</span><span class="o">.</span><span class="n">E2</span><span class="p">()</span><span class="o">^</span><span class="mi">4</span><span class="p">])</span>    <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">subspace</span>    <span class="c1"># long time</span>
<span class="go">Subspace of dimension 2 of QuasiCuspForms(n=7, k=20, ep=1) over Integer Ring</span>
<span class="gp">sage: </span><span class="n">el</span> <span class="o">=</span> <span class="n">subspace</span><span class="p">(</span><span class="n">MF</span><span class="o">.</span><span class="n">Delta</span><span class="p">()</span><span class="o">*</span><span class="n">MF</span><span class="o">.</span><span class="n">E2</span><span class="p">()</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span>    <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">el</span><span class="o">.</span><span class="n">coordinate_vector</span><span class="p">()</span>    <span class="c1"># long time</span>
<span class="go">(0, 1)</span>
<span class="gp">sage: </span><span class="n">el</span><span class="o">.</span><span class="n">ambient_coordinate_vector</span><span class="p">()</span>    <span class="c1"># long time</span>
<span class="go">(0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 17/(56*d), 0, 0)</span>
</pre></div>
</div>
</li>
<li><p><strong>Theta subgroup:</strong>
The Hecke triangle group corresponding to <code class="docutils literal notranslate"><span class="pre">n=infinity</span></code> is also
completely supported. In particular the (special) behavior around
the cusp <code class="docutils literal notranslate"><span class="pre">-1</span></code> is considered and can be specified.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.graded_ring</span> <span class="kn">import</span> <span class="n">QuasiMeromorphicModularFormsRing</span>
<span class="gp">sage: </span><span class="n">MR</span> <span class="o">=</span> <span class="n">QuasiMeromorphicModularFormsRing</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">infinity</span><span class="p">,</span> <span class="n">red_hom</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MR</span>
<span class="go">QuasiMeromorphicModularFormsRing(n=+Infinity) over Integer Ring</span>
<span class="gp">sage: </span><span class="n">j_inv</span> <span class="o">=</span> <span class="n">MR</span><span class="o">.</span><span class="n">j_inv</span><span class="p">()</span><span class="o">.</span><span class="n">full_reduce</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f_i</span> <span class="o">=</span> <span class="n">MR</span><span class="o">.</span><span class="n">f_i</span><span class="p">()</span><span class="o">.</span><span class="n">full_reduce</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E4</span> <span class="o">=</span> <span class="n">MR</span><span class="o">.</span><span class="n">E4</span><span class="p">()</span><span class="o">.</span><span class="n">full_reduce</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">MR</span><span class="o">.</span><span class="n">E2</span><span class="p">()</span><span class="o">.</span><span class="n">full_reduce</span><span class="p">()</span>

<span class="gp">sage: </span><span class="n">j_inv</span>
<span class="go">q^-1 + 24 + 276*q + 2048*q^2 + 11202*q^3 + 49152*q^4 + O(q^5)</span>
<span class="gp">sage: </span><span class="n">MR</span><span class="o">.</span><span class="n">f_rho</span><span class="p">()</span> <span class="o">==</span> <span class="n">MR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E4</span>
<span class="go">1 + 16*q + 112*q^2 + 448*q^3 + 1136*q^4 + O(q^5)</span>
<span class="gp">sage: </span><span class="n">f_i</span>
<span class="go">1 - 24*q + 24*q^2 - 96*q^3 + 24*q^4 + O(q^5)</span>
<span class="gp">sage: </span><span class="n">E2</span>
<span class="go">1 - 8*q - 8*q^2 - 32*q^3 - 40*q^4 + O(q^5)</span>
<span class="gp">sage: </span><span class="n">E4</span><span class="o">.</span><span class="n">derivative</span><span class="p">()</span> <span class="o">==</span> <span class="n">E4</span> <span class="o">*</span> <span class="p">(</span><span class="n">E2</span> <span class="o">-</span> <span class="n">f_i</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">f_i</span><span class="o">.</span><span class="n">serre_derivative</span><span class="p">()</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">E4</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">MF</span> <span class="o">=</span> <span class="n">f_i</span><span class="o">.</span><span class="n">serre_derivative</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MF</span>
<span class="go">ModularForms(n=+Infinity, k=4, ep=1) over Integer Ring</span>
<span class="gp">sage: </span><span class="n">MF</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">MF</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[1 + 240*q^2 + 2160*q^4 + O(q^5), q - 8*q^2 + 28*q^3 - 64*q^4 + O(q^5)]</span>
<span class="gp">sage: </span><span class="n">E4</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="go">1.941017189...</span>
<span class="gp">sage: </span><span class="n">E4</span><span class="o">.</span><span class="n">order_at</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>

<span class="gp">sage: </span><span class="n">MF</span> <span class="o">=</span> <span class="p">(</span><span class="n">E2</span><span class="o">/</span><span class="n">E4</span><span class="p">)</span><span class="o">.</span><span class="n">reduced_parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MF</span><span class="o">.</span><span class="n">quasi_part_gens</span><span class="p">(</span><span class="n">order_1</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[1 - 40*q + 552*q^2 - 4896*q^3 + 33320*q^4 + O(q^5),</span>
<span class="go"> 1 - 24*q + 264*q^2 - 2016*q^3 + 12264*q^4 + O(q^5)]</span>
<span class="gp">sage: </span><span class="n">prec</span> <span class="o">=</span> <span class="n">MF</span><span class="o">.</span><span class="n">required_laurent_prec</span><span class="p">(</span><span class="n">order_1</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">qexp</span> <span class="o">=</span> <span class="p">(</span><span class="n">E2</span><span class="o">/</span><span class="n">E4</span><span class="p">)</span><span class="o">.</span><span class="n">q_expansion</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="n">prec</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">qexp</span>
<span class="go">1 - 3/(8*d)*q + O(q^2)</span>
<span class="gp">sage: </span><span class="n">MF</span><span class="o">.</span><span class="n">construct_quasi_form</span><span class="p">(</span><span class="n">qexp</span><span class="p">,</span> <span class="n">order_1</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">E2</span><span class="o">/</span><span class="n">E4</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">MF</span><span class="o">.</span><span class="n">disp_prec</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MF</span><span class="o">.</span><span class="n">q_basis</span><span class="p">(</span><span class="n">m</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">order_1</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_exp</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">q^-1 - 203528/7*q^5 + O(q^6)</span>
</pre></div>
</div>
<p>Elements with respect to the full group are automatically coerced
to elements of the Theta subgroup if necessary:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">el</span> <span class="o">=</span> <span class="n">QuasiMeromorphicModularFormsRing</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">Delta</span><span class="p">()</span><span class="o">.</span><span class="n">full_reduce</span><span class="p">()</span> <span class="o">+</span> <span class="n">E2</span>
<span class="gp">sage: </span><span class="n">el</span>
<span class="go">(E4*f_i^4 - 2*E4^2*f_i^2 + E4^3 + 4096*E2)/4096</span>
<span class="gp">sage: </span><span class="n">el</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">QuasiModularFormsRing(n=+Infinity) over Integer Ring</span>
</pre></div>
</div>
</li>
<li><p><strong>Determine exact coefficients from numerical ones:</strong>
There is some experimental support for replacing numerical coefficients with
corresponding exact coefficients. There is however NO guarantee that
the procedure will work (and most probably there are cases where it won’t).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.modform_hecketriangle.space</span> <span class="kn">import</span> <span class="n">WeakModularForms</span><span class="p">,</span> <span class="n">QuasiCuspForms</span>
<span class="gp">sage: </span><span class="n">WF</span> <span class="o">=</span> <span class="n">WeakModularForms</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">qexp</span> <span class="o">=</span> <span class="n">WF</span><span class="o">.</span><span class="n">J_inv</span><span class="p">()</span><span class="o">.</span><span class="n">q_expansion_fixed_d</span><span class="p">(</span><span class="n">d_num_prec</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">qexp</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Laurent Series Ring in q over Real Field with 1000 bits of precision</span>
<span class="gp">sage: </span><span class="n">qexp_int</span> <span class="o">=</span> <span class="n">WF</span><span class="o">.</span><span class="n">rationalize_series</span><span class="p">(</span><span class="n">qexp</span><span class="p">)</span>
<span class="go">doctest:...: UserWarning: Using an experimental rationalization of coefficients, please check the result for correctness!</span>
<span class="gp">sage: </span><span class="n">qexp_int</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Laurent Series Ring in q over Fraction Field of Univariate Polynomial Ring in d over Integer Ring</span>
<span class="gp">sage: </span><span class="n">qexp_int</span> <span class="o">==</span> <span class="n">WF</span><span class="o">.</span><span class="n">J_inv</span><span class="p">()</span><span class="o">.</span><span class="n">q_expansion</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">WF</span><span class="p">(</span><span class="n">qexp_int</span><span class="p">)</span> <span class="o">==</span> <span class="n">WF</span><span class="o">.</span><span class="n">J_inv</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">QF</span> <span class="o">=</span> <span class="n">QuasiCuspForms</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">22</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">ep</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">el</span> <span class="o">=</span> <span class="n">QF</span><span class="p">(</span><span class="n">QF</span><span class="o">.</span><span class="n">f_inf</span><span class="p">()</span><span class="o">*</span><span class="n">QF</span><span class="o">.</span><span class="n">E2</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">qexp</span> <span class="o">=</span> <span class="n">el</span><span class="o">.</span><span class="n">q_expansion_fixed_d</span><span class="p">(</span><span class="n">d_num_prec</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">qexp_int</span> <span class="o">=</span> <span class="n">QF</span><span class="o">.</span><span class="n">rationalize_series</span><span class="p">(</span><span class="n">qexp</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">qexp_int</span> <span class="o">==</span> <span class="n">el</span><span class="o">.</span><span class="n">q_expansion</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">QF</span><span class="p">(</span><span class="n">qexp_int</span><span class="p">)</span> <span class="o">==</span> <span class="n">el</span>
<span class="go">True</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="future-ideas">
<h2>Future ideas:<a class="headerlink" href="#future-ideas" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Complete support for the case <code class="docutils literal notranslate"><span class="pre">n=infinity</span></code> (e.g. lambda-CF)</p></li>
<li><p>Properly implemented lambda-CF</p></li>
<li><p>Binary quadratic forms for Hecke triangle groups</p></li>
<li><p>Cycle integrals</p></li>
<li><p>Maybe: Proper spaces (with coordinates) for (quasi) weakly holomorphic forms with bounds on the initial Fourier exponent</p></li>
<li><p>Support for general triangle groups (hard)</p></li>
<li><p>Support for “congruence” subgroups (hard)</p></li>
</ul>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="abstract_ring.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Graded rings of modular forms for Hecke triangle groups</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../modform/notes.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Design notes</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2023, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Overview of Hecke triangle groups and modular forms for Hecke triangle groups</a><ul>
<li><a class="reference internal" href="#hecke-triangle-groups-and-elements">Hecke triangle groups and elements:</a></li>
<li><a class="reference internal" href="#modular-forms-ring-and-spaces-for-hecke-triangle-groups">Modular forms ring and spaces for Hecke triangle groups:</a></li>
<li><a class="reference internal" href="#future-ideas">Future ideas:</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/scripts/furo.js"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script src="../../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "lcm": "\\mathop{\\operatorname{lcm}}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <script src="../../../../_static/jupyter-sphinx-furo.js"></script>
    </body>
</html>