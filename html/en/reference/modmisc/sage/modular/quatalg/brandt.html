<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Brandt Modules &mdash; Sage Reference Manual v7.1: Miscellaneous Modular-Form-Related Modules</title>
    
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '7.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v7.1: Miscellaneous Modular-Form-Related Modules" href="../../../index.html" />
    <link rel="next" title="The set \(\mathbb{P}^1(K)\) of cusps of a number field K" href="../cusps_nf.html" />
    <link rel="prev" title="Module of Supersingular Points" href="../ssmod/ssmod.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../cusps_nf.html" title="The set \(\mathbb{P}^1(K)\) of cusps of a number field K"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../ssmod/ssmod.html" title="Module of Supersingular Points"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../../index.html">Miscellaneous Modular-Form-Related Modules</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="brandt-modules">
<span id="sage-modular-quatalg-brandt"></span><h1>Brandt Modules<a class="headerlink" href="#brandt-modules" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.modular.quatalg.brandt"></span><p>AUTHORS:</p>
<ul class="simple">
<li>Jon Bober</li>
<li>Alia Hamieh</li>
<li>Victoria de Quehen</li>
<li>William Stein</li>
<li>Gonzalo Tornaria</li>
</ul>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This tutorial outlines the construction of Brandt modules in Sage. The
importance of this construction is that it provides us with a method
to compute modular forms on <span class="math">\(\Gamma_0(N)\)</span> as outlined in Pizer&#8217;s paper
[Pi]. In fact there exists a non-canonical Hecke algebra isomorphism
between the Brandt modules and a certain subspace of
<span class="math">\(S_{2}(\Gamma_0(pM))\)</span> which contains all the newforms.</p>
<p>The Brandt module is the free abelian group on right ideal classes of
a quaternion order together with a natural Hecke action determined by
Brandt matrices.</p>
<div class="section" id="quaternion-algebras">
<h3>Quaternion Algebras<a class="headerlink" href="#quaternion-algebras" title="Permalink to this headline">¶</a></h3>
<p>A quaternion algebra over <span class="math">\(\QQ\)</span> is a central simple algebra of
dimension 4 over <span class="math">\(\QQ\)</span>. Such an algebra <span class="math">\(A\)</span> is said to be
ramified at a place <span class="math">\(v\)</span> of <span class="math">\(\QQ\)</span> if and only if <span class="math">\(A_v=A\otimes
\QQ_v\)</span> is a division algebra. Otherwise <span class="math">\(A\)</span> is said to be split
at <span class="math">\(v\)</span>.</p>
<p><tt class="docutils literal"><span class="pre">A</span> <span class="pre">=</span> <span class="pre">QuaternionAlgebra(p)</span></tt> returns the quaternion algebra <span class="math">\(A\)</span> over
<span class="math">\(\QQ\)</span> ramified precisely at the places <span class="math">\(p\)</span> and <span class="math">\(\infty\)</span>.</p>
<p><tt class="docutils literal"><span class="pre">A</span> <span class="pre">=</span> <span class="pre">QuaternionAlgebra(k,a,b)</span></tt> returns a quaternion algebra with basis
<span class="math">\(\{1,i,j,j\}\)</span> over <span class="math">\(\mathbb{K}\)</span> such that <span class="math">\(i^2=a\)</span>, <span class="math">\(j^2=b\)</span> and <span class="math">\(ij=k.\)</span></p>
<p>An order <span class="math">\(R\)</span> in a quaternion algebra is a 4-dimensional lattice on <span class="math">\(A\)</span>
which is also a subring containing the identity.</p>
<p><tt class="docutils literal"><span class="pre">R</span> <span class="pre">=</span> <span class="pre">A.maximal_order()</span></tt> returns a maximal order <span class="math">\(R\)</span> in the quaternion
algebra <span class="math">\(A.\)</span></p>
<p>An Eichler order <span class="math">\(\mathcal{O}\)</span> in a quaternion algebra is the
intersection of two maximal orders. The level of <span class="math">\(\mathcal{O}\)</span> is its
index in any maximal order containing it.</p>
<p><tt class="docutils literal"><span class="pre">O</span> <span class="pre">=</span> <span class="pre">A.order_of_level_N</span></tt> returns an Eichler order <span class="math">\(\mathcal{O}\)</span> in <span class="math">\(A\)</span>
of level <span class="math">\(N\)</span> where <span class="math">\(p\)</span> does not divide <span class="math">\(N\)</span>.</p>
<p>A right <span class="math">\(\mathcal{O}\)</span>-ideal <span class="math">\(I\)</span> is a lattice on <span class="math">\(A\)</span> such that
<span class="math">\(I_p=a_p\mathcal{O}\)</span> (for some <span class="math">\(a_p\in A_p^*\)</span>) for all <span class="math">\(p&lt;\infty\)</span>. Two
right <span class="math">\(\mathcal{O}\)</span>-ideals <span class="math">\(I\)</span> and <span class="math">\(J\)</span> are said to belong to the same
class if <span class="math">\(I=aJ\)</span> for some <span class="math">\(a \in A^*\)</span>. (Left <span class="math">\(\mathcal{O}\)</span>-ideals are
defined in a similar fashion.)</p>
<p>The right order of <span class="math">\(I\)</span> is defined to be the set of elements in <span class="math">\(A\)</span>
which fix <span class="math">\(I\)</span> under right multiplication.</p>
<p>right_order (R, basis) returns the right ideal of <span class="math">\(I\)</span> in <span class="math">\(R\)</span> given a
basis for the right ideal <span class="math">\(I\)</span> contained in the maximal order <span class="math">\(R.\)</span></p>
<p>ideal_classes(self) returns a tuple of all right ideal classes in self
which, for the purpose of constructing the Brandt module B(p,M), is
taken to be an Eichler order of level M.</p>
<p>The implementation of this method is especially interesting. It
depends on the construction of a Hecke module defined as a free
abelian group on right ideal classes of a quaternion algebra with the
following action</p>
<p>where <span class="math">\((n,pM)=1\)</span> and the sum is over cyclic <span class="math">\(\mathcal{O}\)</span>-module
homomorphisms <span class="math">\(\phi :I\rightarrow J ` of degree `n\)</span> up to isomorphism
of <span class="math">\(J\)</span>. Equivalently one can sum over the inclusions of the submodules
<span class="math">\(J \rightarrow n^{-1}I\)</span>. The rough idea is to start with the trivial
ideal class containing the order <span class="math">\(\mathcal{O}\)</span> itself. Using the
method cyclic_submodules(self, I, p) one computes <span class="math">\(T_p([\mathcal{O}])\)</span>
for some prime integer <span class="math">\(p\)</span> not dividing the level of the order
<span class="math">\(\mathcal{O}\)</span>. Apply this method repeatedly and test for equivalence
among resulting ideals. A theorem of Serre asserts that one gets a
complete set of ideal class representatives after a finite number of
repetitions.</p>
<p>One can prove that two ideals <span class="math">\(I\)</span> and <span class="math">\(J\)</span> are equivalent if and only
if there exists an element <span class="math">\(\alpha \in I \overline{J}\)</span> such
<span class="math">\(N(\alpha)=N(I)N(J)\)</span>.</p>
<p>is_equivalent(I,J) returns true if <span class="math">\(I\)</span> and <span class="math">\(J\)</span> are equivalent. This
method first compares the theta series of <span class="math">\(I\)</span> and <span class="math">\(J\)</span>. If they are the
same, it computes the theta series of the lattice <span class="math">\(I\overline(J)\)</span>. It
returns true if the <span class="math">\(n^{th}\)</span> coefficient of this series is nonzero
where <span class="math">\(n=N(J)N(I)\)</span>.</p>
<p>The theta series of a lattice <span class="math">\(L\)</span> over the quaternion algebra <span class="math">\(A\)</span> is
defined as</p>
<p>L.theta_series(T,q) returns a power series representing <span class="math">\(\theta_L(q)\)</span>
up to a precision of <span class="math">\(\mathcal{O}(q^{T+1})\)</span>.</p>
</div>
<div class="section" id="hecke-structure">
<h3>Hecke Structure<a class="headerlink" href="#hecke-structure" title="Permalink to this headline">¶</a></h3>
<p>The Hecke structure defined on the Brandt module is given by the
Brandt matrices which can be computed using the definition of the
Hecke operators given earlier.</p>
<p>hecke_matrix_from_defn (self,n) returns the matrix of the nth Hecke
operator <span class="math">\(B_{0}(n)\)</span> acting on self, computed directly from the
definition.</p>
<p>However, one can efficiently compute Brandt matrices using theta
series. In fact, let {<span class="math">\(I_{1},.....,I_{h}\)</span>} be a set of right
<span class="math">\(\mathcal{O}\)</span>-ideal class representatives. The (i,j) entry in the
Brandt matrix <span class="math">\(B_{0}(n)\)</span> is the product of the <span class="math">\(n^{th}\)</span> coefficient in
the theta series of the lattice <span class="math">\(I_{i}\overline{I_{j}}\)</span> and the first
coefficient in the theta series of the lattice
<span class="math">\(I_{i}\overline{I_{i}}\)</span>.</p>
<p>compute_hecke_matrix_brandt(self,n) returns the nth Hecke matrix,
computed using theta series.</p>
</div>
<div class="section" id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="go">Order of Quaternion Algebra (-1, -23) with base ring Rational Field with basis (1/2 + 1/2*j, 1/2*i + 1/2*k, j, k)</span>

<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()</span>
<span class="go">(Fractional ideal (2 + 2*j, 2*i + 2*k, 4*j, 4*k), Fractional ideal (2 + 2*j, 2*i + 6*k, 8*j, 8*k), Fractional ideal (2 + 10*j + 8*k, 2*i + 8*j + 6*k, 16*j, 16*k))</span>

<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">hecke_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[1 2 0]</span>
<span class="go">[1 1 1]</span>
<span class="go">[0 3 0]</span>

<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">brandt_series</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[1/4 + q + q^2 + O(q^3)     1/4 + q^2 + O(q^3)           1/4 + O(q^3)]</span>
<span class="go">[  1/2 + 2*q^2 + O(q^3) 1/2 + q + q^2 + O(q^3)   1/2 + 3*q^2 + O(q^3)]</span>
<span class="go">[          1/6 + O(q^3)     1/6 + q^2 + O(q^3)       1/6 + q + O(q^3)]</span>
</pre></div>
</div>
</div>
<div class="section" id="references">
<h3>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>[Pi] Arnold Pizer, <em>An Algorithm for Computing Modular Forms on</em> <span class="math">\(\Gamma_{0}(N)\)</span></li>
<li>[Ko] David Kohel, <em>Hecke Module Structure of Quaternions</em></li>
</ul>
</div>
<div class="section" id="further-examples">
<h3>Further Examples<a class="headerlink" href="#further-examples" title="Permalink to this headline">¶</a></h3>
<p>We decompose a Brandt module over both <span class="math">\(\ZZ\)</span> and <span class="math">\(\QQ\)</span>.:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">43</span><span class="p">,</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">ZZ</span><span class="p">);</span> <span class="n">B</span>
<span class="go">Brandt module of dimension 4 of level 43 of weight 2 over Integer Ring</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">decomposition</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span>
<span class="go">[</span>
<span class="go">Subspace of dimension 1 of Brandt module of dimension 4 of level 43 of weight 2 over Integer Ring,</span>
<span class="go">Subspace of dimension 1 of Brandt module of dimension 4 of level 43 of weight 2 over Integer Ring,</span>
<span class="go">Subspace of dimension 2 of Brandt module of dimension 4 of level 43 of weight 2 over Integer Ring</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">((0, 0, 1, -1),)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">((1, 2, 2, 2),)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">((1, 1, -1, -1), (0, 2, -1, -1))</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">43</span><span class="p">,</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">);</span> <span class="n">B</span>
<span class="go">Brandt module of dimension 4 of level 43 of weight 2 over Rational Field</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">decomposition</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">((1, 0, -1/2, -1/2), (0, 1, -1/2, -1/2))</span>
</pre></div>
</div>
<dl class="function">
<dt id="sage.modular.quatalg.brandt.BrandtModule">
<tt class="descclassname">sage.modular.quatalg.brandt.</tt><tt class="descname">BrandtModule</tt><big>(</big><em>N</em>, <em>M=1</em>, <em>weight=2</em>, <em>base_ring=Rational Field</em>, <em>use_cache=True</em><big>)</big><a class="headerlink" href="#sage.modular.quatalg.brandt.BrandtModule" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Brandt module of given weight associated to the prime
power p^r and integer M, where p and M are coprime.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><ul class="first last simple">
<li>N &#8211; a product of primes with odd exponents</li>
<li>M &#8211; an integer coprime to q (default: 1)</li>
<li>weight &#8211; an integer that is at least 2 (default: 2)</li>
<li>base_ring &#8211; the base ring (default: QQ)</li>
<li>use_cache &#8211; whether to use the cache (default: True)</li>
</ul>
</dd>
<dt>OUTPUT:</dt>
<dd><ul class="first last simple">
<li>a Brandt module</li>
</ul>
</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<span class="go">Brandt module of dimension 2 of level 17 of weight 2 over Rational Field</span>
<span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
<span class="go">Brandt module of dimension 32 of level 17*15 of weight 2 over Rational Field</span>
<span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="go">Brandt module of dimension 2 of level 3*7 of weight 2 over Rational Field</span>
<span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">weight</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Brandt module of dimension 1 of level 3 of weight 2 over Rational Field</span>
<span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">ZZ</span><span class="p">)</span>
<span class="go">Brandt module of dimension 2 of level 11 of weight 2 over Integer Ring</span>
<span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">QQbar</span><span class="p">)</span>
<span class="go">Brandt module of dimension 2 of level 11 of weight 2 over Algebraic Field</span>
</pre></div>
</div>
<p>The use_cache option determines whether the Brandt module returned
by this function is cached.:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span> <span class="ow">is</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="n">use_cache</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span> <span class="ow">is</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="n">use_cache</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Note that N and M must be coprime:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">M must be coprime to N</span>
</pre></div>
</div>
<p>Only weight 2 is currently implemented:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">weight</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">weight != 2 not yet implemented</span>
</pre></div>
</div>
<p>Brandt modules are cached:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="ow">is</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ZZ</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.modular.quatalg.brandt.BrandtModuleElement">
<em class="property">class </em><tt class="descclassname">sage.modular.quatalg.brandt.</tt><tt class="descname">BrandtModuleElement</tt><big>(</big><em>parent</em>, <em>x</em><big>)</big><a class="headerlink" href="#sage.modular.quatalg.brandt.BrandtModuleElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../hecke/sage/modular/hecke/element.html#sage.modular.hecke.element.HeckeModuleElement" title="(in Sage Reference Manual: General Hecke Algebras and Hecke Modules v7.1)"><tt class="xref py py-class docutils literal"><span class="pre">sage.modular.hecke.element.HeckeModuleElement</span></tt></a></p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">B</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span> <span class="n">x</span>
<span class="go">(1, 2, 3)</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">Brandt module of dimension 3 of level 37 of weight 2 over Rational Field</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.modular.quatalg.brandt.BrandtModuleElement.monodromy_pairing">
<tt class="descname">monodromy_pairing</tt><big>(</big><em>x</em><big>)</big><a class="headerlink" href="#sage.modular.quatalg.brandt.BrandtModuleElement.monodromy_pairing" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the monodromy pairing of self and x.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">monodromy_weights</span><span class="p">()</span>
<span class="go">(1, 3, 1, 1, 1, 3)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="mi">0</span> <span class="o">+</span> <span class="n">B</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">monodromy_pairing</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="mi">0</span> <span class="o">+</span> <span class="n">B</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.modular.quatalg.brandt.BrandtModule_class">
<em class="property">class </em><tt class="descclassname">sage.modular.quatalg.brandt.</tt><tt class="descname">BrandtModule_class</tt><big>(</big><em>N</em>, <em>M</em>, <em>weight</em>, <em>base_ring</em><big>)</big><a class="headerlink" href="#sage.modular.quatalg.brandt.BrandtModule_class" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../hecke/sage/modular/hecke/ambient_module.html#sage.modular.hecke.ambient_module.AmbientHeckeModule" title="(in Sage Reference Manual: General Hecke Algebras and Hecke Modules v7.1)"><tt class="xref py py-class docutils literal"><span class="pre">sage.modular.hecke.ambient_module.AmbientHeckeModule</span></tt></a></p>
<p>A Brandt module.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">Brandt module of dimension 4 of level 3*10 of weight 2 over Rational Field</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.modular.quatalg.brandt.BrandtModule_class.M">
<tt class="descname">M</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.modular.quatalg.brandt.BrandtModule_class.M" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the auxiliary level (prime to p part) of the quaternion
order used to compute this Brandt module.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ZZ</span><span class="p">)</span><span class="o">.</span><span class="n">M</span><span class="p">()</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.quatalg.brandt.BrandtModule_class.N">
<tt class="descname">N</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.modular.quatalg.brandt.BrandtModule_class.N" title="Permalink to this definition">¶</a></dt>
<dd><p>Return ramification level N.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ZZ</span><span class="p">)</span><span class="o">.</span><span class="n">N</span><span class="p">()</span>
<span class="go">7</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.quatalg.brandt.BrandtModule_class.brandt_series">
<tt class="descname">brandt_series</tt><big>(</big><em>prec</em>, <em>var='q'</em><big>)</big><a class="headerlink" href="#sage.modular.quatalg.brandt.BrandtModule_class.brandt_series" title="Permalink to this definition">¶</a></dt>
<dd><p>Return matrix of power series <span class="math">\(\sum T_n q^n\)</span> to the given
precision.  Note that the Hecke operators in this series are
always over <span class="math">\(\QQ\)</span>, even if the base ring of this Brandt module
is not <span class="math">\(\QQ\)</span>.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><ul class="first last simple">
<li>prec &#8211; positive intege</li>
<li>var &#8211; string (default: <span class="math">\(q\)</span>)</li>
</ul>
</dd>
<dt>OUTPUT:</dt>
<dd>matrix of power series with coefficients in <span class="math">\(\QQ\)</span></dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">brandt_series</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[1/4 + q + O(q^2)     1/4 + O(q^2)]</span>
<span class="go">[    1/6 + O(q^2) 1/6 + q + O(q^2)]</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">brandt_series</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[1/4 + q + q^2 + 2*q^3 + 5*q^4 + O(q^5)   1/4 + 3*q^2 + 3*q^3 + 3*q^4 + O(q^5)]</span>
<span class="go">[  1/6 + 2*q^2 + 2*q^3 + 2*q^4 + O(q^5)         1/6 + q + q^3 + 4*q^4 + O(q^5)]</span>
</pre></div>
</div>
<p>Asking for a smaller precision works.:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">brandt_series</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[1/4 + q + q^2 + O(q^3)   1/4 + 3*q^2 + O(q^3)]</span>
<span class="go">[  1/6 + 2*q^2 + O(q^3)       1/6 + q + O(q^3)]</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">brandt_series</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">var</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="go">[1/4 + t + t^2 + O(t^3)   1/4 + 3*t^2 + O(t^3)]</span>
<span class="go">[  1/6 + 2*t^2 + O(t^3)       1/6 + t + O(t^3)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.quatalg.brandt.BrandtModule_class.character">
<tt class="descname">character</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.modular.quatalg.brandt.BrandtModule_class.character" title="Permalink to this definition">¶</a></dt>
<dd><p>The character of this space. Always trivial.</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">character</span><span class="p">()</span>
<span class="go">Dirichlet character modulo 55 of conductor 1 mapping 12 |--&gt; 1, 46 |--&gt; 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.quatalg.brandt.BrandtModule_class.cyclic_submodules">
<tt class="descname">cyclic_submodules</tt><big>(</big><em>I</em>, <em>p</em><big>)</big><a class="headerlink" href="#sage.modular.quatalg.brandt.BrandtModule_class.cyclic_submodules" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of rescaled versions of the fractional right
ideals <span class="math">\(J\)</span> such that <span class="math">\(J\)</span> contains <span class="math">\(I\)</span> and the quotient has
group structure the product of two cyclic groups of order <span class="math">\(p\)</span>.</p>
<p>We emphasize again that <span class="math">\(J\)</span> is rescaled to be integral.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd>I &#8211; ideal I in R = self.order_of_level_N()
p &#8211; prime p coprime to self.level()</dd>
<dt>OUTPUT:</dt>
<dd>list of the p+1 fractional right R-ideals that contain I
such that J/I is GF(p) x GF(p).</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">order_of_level_N</span><span class="p">()</span><span class="o">.</span><span class="n">unit_ideal</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">cyclic_submodules</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">[Fractional ideal (1/2 + 3/2*j + k, 1/2*i + j + 1/2*k, 2*j, 2*k),</span>
<span class="go"> Fractional ideal (1/2 + 1/2*i + 1/2*j + 1/2*k, i + k, j + k, 2*k),</span>
<span class="go"> Fractional ideal (1/2 + 1/2*j + k, 1/2*i + j + 3/2*k, 2*j, 2*k)]</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">cyclic_submodules</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">[Fractional ideal (1/2 + 1/2*j, 1/2*i + 5/2*k, 3*j, 3*k),</span>
<span class="go"> Fractional ideal (1/2 + 3/2*j + 2*k, 1/2*i + 2*j + 3/2*k, 3*j, 3*k),</span>
<span class="go"> Fractional ideal (1/2 + 3/2*j + k, 1/2*i + j + 3/2*k, 3*j, 3*k),</span>
<span class="go"> Fractional ideal (1/2 + 5/2*j, 1/2*i + 1/2*k, 3*j, 3*k)]</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">cyclic_submodules</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">p must be coprime to the level</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.quatalg.brandt.BrandtModule_class.eisenstein_subspace">
<tt class="descname">eisenstein_subspace</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.modular.quatalg.brandt.BrandtModule_class.eisenstein_subspace" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the 1-dimensional subspace of self on which the Hecke
operators <span class="math">\(T_p\)</span> act as <span class="math">\(p+1\)</span> for <span class="math">\(p\)</span> coprime to the level.</p>
<p>NOTE: This function assumes that the base field has
characteristic 0.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">11</span><span class="p">);</span> <span class="n">B</span><span class="o">.</span><span class="n">eisenstein_subspace</span><span class="p">()</span>
<span class="go">Subspace of dimension 1 of Brandt module of dimension 2 of level 11 of weight 2 over Rational Field</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">eisenstein_subspace</span><span class="p">()</span> <span class="ow">is</span> <span class="n">B</span><span class="o">.</span><span class="n">eisenstein_subspace</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">eisenstein_subspace</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">((1, 1),)</span>
<span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">eisenstein_subspace</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">((1, 1, 1, 1/2, 1, 1, 1/2, 1, 1, 1),)</span>
<span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">base_ring</span><span class="o">=</span><span class="n">ZZ</span><span class="p">)</span><span class="o">.</span><span class="n">eisenstein_subspace</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">((2, 2, 2, 1, 2, 2, 1, 2, 2, 2),)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.quatalg.brandt.BrandtModule_class.free_module">
<tt class="descname">free_module</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.modular.quatalg.brandt.BrandtModule_class.free_module" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the underlying free module of the Brandt module.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">10007</span><span class="p">,</span><span class="mi">389</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="go">Vector space of dimension 325196 over Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.quatalg.brandt.BrandtModule_class.hecke_matrix">
<tt class="descname">hecke_matrix</tt><big>(</big><em>n</em>, <em>algorithm='default'</em>, <em>sparse=False</em>, <em>B=None</em><big>)</big><a class="headerlink" href="#sage.modular.quatalg.brandt.BrandtModule_class.hecke_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the matrix of the n-th Hecke operator.</p>
<p>INPUT:</p>
<blockquote>
<div><ul>
<li><p class="first"><span class="math">\(n\)</span> &#8211; integer</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">algorithm</span></tt> &#8211; string (default: &#8216;default&#8217;)</p>
<blockquote>
<div><ul class="simple">
<li>&#8216;default&#8217; &#8211; let Sage guess which algorithm is best</li>
<li>&#8216;direct&#8217; &#8211; use cyclic subideals (generally much
better when you want few Hecke operators and the
dimension is very large); uses &#8216;theta&#8217; if n divides
the level.</li>
<li>&#8216;brandt&#8217; &#8211; use Brandt matrices (generally much
better when you want many Hecke operators and the
dimension is very small; bad when the dimension
is large)</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">sparse</span></tt> &#8211; bool (default: False)</p>
</li>
<li><p class="first"><span class="math">\(B\)</span> &#8211; integer or None (default: None); in direct algorithm,
use theta series to this precision as an initial check for
equality of ideal classes.</p>
</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">);</span> <span class="n">B</span><span class="o">.</span><span class="n">hecke_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[0 3]</span>
<span class="go">[1 2]</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">hecke_matrix</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;brandt&#39;</span><span class="p">)</span>
<span class="go">[0 6]</span>
<span class="go">[2 4]</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">hecke_matrix</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;brandt&#39;</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">t</span>
<span class="go">[ 6  6]</span>
<span class="go">[ 2 10]</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">&lt;type &#39;sage.matrix.matrix_rational_sparse.Matrix_rational_sparse&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">hecke_matrix</span><span class="p">(</span><span class="mi">19</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;direct&#39;</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[ 8 12]</span>
<span class="go">[ 4 16]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.quatalg.brandt.BrandtModule_class.is_cuspidal">
<tt class="descname">is_cuspidal</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.modular.quatalg.brandt.BrandtModule_class.is_cuspidal" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns whether self is cuspidal, i.e. has no Eisenstein part.</p>
<dl class="docutils">
<dt>EXAMPLES:</dt>
<dd>sage: B = BrandtModule(3, 4)
sage: B.is_cuspidal()
False
sage: B.eisenstein_subspace()
Brandt module of dimension 1 of level 3*4 of weight 2 over Rational Field</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="sage.modular.quatalg.brandt.BrandtModule_class.maximal_order">
<tt class="descname">maximal_order</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.modular.quatalg.brandt.BrandtModule_class.maximal_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a maximal order in the quaternion algebra associated to this Brandt module.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="go">Order of Quaternion Algebra (-17, -3) with base ring Rational Field with basis (1/2 + 1/2*j, 1/2*i + 1/2*k, -1/3*j - 1/3*k, k)</span>
<span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span> <span class="ow">is</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.quatalg.brandt.BrandtModule_class.monodromy_weights">
<tt class="descname">monodromy_weights</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.modular.quatalg.brandt.BrandtModule_class.monodromy_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the weights for the monodromy pairing on this Brandt
module.  The weights are associated to each ideal class in our
fixed choice of basis. The weight of an ideal class <span class="math">\([I]\)</span> is
half the number of units of the right order <span class="math">\(I\)</span>.</p>
<p>NOTE: The base ring must be <span class="math">\(\QQ\)</span> or <span class="math">\(\ZZ\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">monodromy_weights</span><span class="p">()</span>
<span class="go">(2, 3)</span>
<span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span><span class="o">.</span><span class="n">monodromy_weights</span><span class="p">()</span>
<span class="go">(1, 1, 1)</span>
<span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span><span class="o">.</span><span class="n">monodromy_weights</span><span class="p">()</span>
<span class="go">(2, 1, 1, 1)</span>
<span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">monodromy_weights</span><span class="p">()</span>
<span class="go">(1, 1, 1, 2, 1, 1, 2, 1, 1, 1)</span>
<span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span><span class="o">.</span><span class="n">monodromy_weights</span><span class="p">()</span>
<span class="go">(1, 3, 1, 1, 1, 3)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.quatalg.brandt.BrandtModule_class.order_of_level_N">
<tt class="descname">order_of_level_N</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.modular.quatalg.brandt.BrandtModule_class.order_of_level_N" title="Permalink to this definition">¶</a></dt>
<dd><p>Return Eichler order of level N = p^(2*r+1)*M in the quaternion algebra.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">order_of_level_N</span><span class="p">()</span>
<span class="go">Order of Quaternion Algebra (-1, -7) with base ring Rational Field with basis (1/2 + 1/2*j, 1/2*i + 1/2*k, j, k)</span>
<span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span><span class="o">.</span><span class="n">order_of_level_N</span><span class="p">()</span>
<span class="go">Order of Quaternion Algebra (-1, -7) with base ring Rational Field with basis (1/2 + 1/2*j + 12*k, 1/2*i + 9/2*k, j + 11*k, 13*k)</span>
<span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">order_of_level_N</span><span class="p">()</span>
<span class="go">Order of Quaternion Algebra (-1, -7) with base ring Rational Field with basis (1/2 + 1/2*j + 35*k, 1/2*i + 65/2*k, j + 19*k, 51*k)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.quatalg.brandt.BrandtModule_class.quaternion_algebra">
<tt class="descname">quaternion_algebra</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.modular.quatalg.brandt.BrandtModule_class.quaternion_algebra" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the quaternion algebra A over QQ ramified precisely at
p and infinity used to compute this Brandt module.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">997</span><span class="p">)</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="p">()</span>
<span class="go">Quaternion Algebra (-2, -997) with base ring Rational Field</span>
<span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="p">()</span>
<span class="go">Quaternion Algebra (-1, -1) with base ring Rational Field</span>
<span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="p">()</span>
<span class="go">Quaternion Algebra (-1, -3) with base ring Rational Field</span>
<span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="p">()</span>
<span class="go">Quaternion Algebra (-2, -5) with base ring Rational Field</span>
<span class="gp">sage: </span><span class="n">BrandtModule</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="p">()</span>
<span class="go">Quaternion Algebra (-17, -3) with base ring Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.quatalg.brandt.BrandtModule_class.right_ideals">
<tt class="descname">right_ideals</tt><big>(</big><em>B=None</em><big>)</big><a class="headerlink" href="#sage.modular.quatalg.brandt.BrandtModule_class.right_ideals" title="Permalink to this definition">¶</a></dt>
<dd><p>Return sorted tuple of representatives for the equivalence
classes of right ideals in self.</p>
<dl class="docutils">
<dt>OUTPUT:</dt>
<dd><ul class="first last simple">
<li>sorted tuple of fractional ideals</li>
</ul>
</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()</span>
<span class="go">(Fractional ideal (2 + 2*j, 2*i + 2*k, 4*j, 4*k),</span>
<span class="go"> Fractional ideal (2 + 2*j, 2*i + 6*k, 8*j, 8*k),</span>
<span class="go"> Fractional ideal (2 + 10*j + 8*k, 2*i + 8*j + 6*k, 16*j, 16*k))</span>
</pre></div>
</div>
<p>TEST:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">1009</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Is</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Is</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">prod</span><span class="p">(</span><span class="ow">not</span> <span class="n">Is</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">is_equivalent</span><span class="p">(</span><span class="n">Is</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.modular.quatalg.brandt.BrandtSubmodule">
<em class="property">class </em><tt class="descclassname">sage.modular.quatalg.brandt.</tt><tt class="descname">BrandtSubmodule</tt><big>(</big><em>ambient</em>, <em>submodule</em>, <em>dual_free_module=None</em>, <em>check=True</em><big>)</big><a class="headerlink" href="#sage.modular.quatalg.brandt.BrandtSubmodule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../hecke/sage/modular/hecke/submodule.html#sage.modular.hecke.submodule.HeckeSubmodule" title="(in Sage Reference Manual: General Hecke Algebras and Hecke Modules v7.1)"><tt class="xref py py-class docutils literal"><span class="pre">sage.modular.hecke.submodule.HeckeSubmodule</span></tt></a></p>
<p>Initialise a submodule of an ambient Hecke module.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">ambient</span></tt> - an ambient Hecke module</li>
<li><tt class="docutils literal"><span class="pre">submodule</span></tt> - a free module over the base ring which is a submodule
of the free module attached to the ambient Hecke module. This should
be invariant under all Hecke operators.</li>
<li><tt class="docutils literal"><span class="pre">dual_free_module</span></tt> - the submodule of the dual of the ambient
module corresponding to this submodule (or None).</li>
<li><tt class="docutils literal"><span class="pre">check</span></tt> - whether or not to explicitly check that the submodule is
Hecke equivariant.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CuspForms</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">60</span><span class="p">)</span> <span class="c1"># indirect doctest</span>
<span class="go">Cuspidal subspace of dimension 5 of Modular Forms space of dimension 6 for Modular Group SL(2,Z) of weight 60 over Rational Field</span>

<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">ModularForms</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">hecke</span><span class="o">.</span><span class="n">submodule</span><span class="o">.</span><span class="n">HeckeSubmodule</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">M</span><span class="o">.</span><span class="n">submodule</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">basis</span><span class="p">()[:</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">free_module</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">S</span>
<span class="go">Rank 3 submodule of a Hecke module of level 4</span>

<span class="gp">sage: </span><span class="n">S</span> <span class="o">==</span> <span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">S</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.modular.quatalg.brandt.basis_for_left_ideal">
<tt class="descclassname">sage.modular.quatalg.brandt.</tt><tt class="descname">basis_for_left_ideal</tt><big>(</big><em>R</em>, <em>gens</em><big>)</big><a class="headerlink" href="#sage.modular.quatalg.brandt.basis_for_left_ideal" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a basis for the left ideal of R with given generators.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><ul class="first last simple">
<li>R &#8211; quaternion order</li>
<li>gens &#8211; list of elements of R</li>
</ul>
</dd>
<dt>OUTPUT:</dt>
<dd><ul class="first last simple">
<li>list of four elements of R</li>
</ul>
</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">17</span><span class="p">);</span> <span class="n">A</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="p">();</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">quatalg</span><span class="o">.</span><span class="n">brandt</span><span class="o">.</span><span class="n">basis_for_left_ideal</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">(),</span> <span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="o">-</span><span class="n">j</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
<span class="go">[1/2 + 1/6*j + 2/3*k, 1/2*i + 1/2*k, 1/3*j + 1/3*k, k]</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">quatalg</span><span class="o">.</span><span class="n">brandt</span><span class="o">.</span><span class="n">basis_for_left_ideal</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">(),</span> <span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">),</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="n">j</span><span class="p">),</span><span class="mi">6</span><span class="o">*</span><span class="n">k</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
<span class="go">[3/2 + 1/2*j + 2*k, 3/2*i + 3/2*k, j + k, 3*k]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.modular.quatalg.brandt.benchmark_magma">
<tt class="descclassname">sage.modular.quatalg.brandt.</tt><tt class="descname">benchmark_magma</tt><big>(</big><em>levels</em>, <em>silent=False</em><big>)</big><a class="headerlink" href="#sage.modular.quatalg.brandt.benchmark_magma" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>INPUT:</dt>
<dd><ul class="first last simple">
<li>levels &#8211; list of pairs (p,M) where p is a prime not dividing M</li>
<li>silent &#8211; bool, default False; if True suppress printing during computation</li>
</ul>
</dd>
<dt>OUTPUT:</dt>
<dd><ul class="first last simple">
<li>list of 4-tuples (&#8216;magma&#8217;, p, M, tm), where tm is the
CPU time in seconds to compute T2 using Magma</li>
</ul>
</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">quatalg</span><span class="o">.</span><span class="n">brandt</span><span class="o">.</span><span class="n">benchmark_magma</span><span class="p">([(</span><span class="mi">11</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">43</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">97</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>  <span class="c1"># optional - magma</span>
<span class="go">(&#39;magma&#39;, 11, 1, ...)</span>
<span class="go">(&#39;magma&#39;, 37, 1, ...)</span>
<span class="go">(&#39;magma&#39;, 43, 1, ...)</span>
<span class="go">(&#39;magma&#39;, 97, 1, ...)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">quatalg</span><span class="o">.</span><span class="n">brandt</span><span class="o">.</span><span class="n">benchmark_magma</span><span class="p">([(</span><span class="mi">11</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">43</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">97</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>  <span class="c1"># optional - magma</span>
<span class="go">(&#39;magma&#39;, 11, 2, ...)</span>
<span class="go">(&#39;magma&#39;, 37, 2, ...)</span>
<span class="go">(&#39;magma&#39;, 43, 2, ...)</span>
<span class="go">(&#39;magma&#39;, 97, 2, ...)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.modular.quatalg.brandt.benchmark_sage">
<tt class="descclassname">sage.modular.quatalg.brandt.</tt><tt class="descname">benchmark_sage</tt><big>(</big><em>levels</em>, <em>silent=False</em><big>)</big><a class="headerlink" href="#sage.modular.quatalg.brandt.benchmark_sage" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>INPUT:</dt>
<dd><ul class="first last simple">
<li>levels &#8211; list of pairs (p,M) where p is a prime not dividing M</li>
<li>silent &#8211; bool, default False; if True suppress printing during computation</li>
</ul>
</dd>
<dt>OUTPUT:</dt>
<dd><ul class="first last simple">
<li>list of 4-tuples (&#8216;sage&#8217;, p, M, tm), where tm is the
CPU time in seconds to compute T2 using Sage</li>
</ul>
</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">quatalg</span><span class="o">.</span><span class="n">brandt</span><span class="o">.</span><span class="n">benchmark_sage</span><span class="p">([(</span><span class="mi">11</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">43</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">97</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="go">(&#39;sage&#39;, 11, 1, ...)</span>
<span class="go">(&#39;sage&#39;, 37, 1, ...)</span>
<span class="go">(&#39;sage&#39;, 43, 1, ...)</span>
<span class="go">(&#39;sage&#39;, 97, 1, ...)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">quatalg</span><span class="o">.</span><span class="n">brandt</span><span class="o">.</span><span class="n">benchmark_sage</span><span class="p">([(</span><span class="mi">11</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">43</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">97</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="go">(&#39;sage&#39;, 11, 2, ...)</span>
<span class="go">(&#39;sage&#39;, 37, 2, ...)</span>
<span class="go">(&#39;sage&#39;, 43, 2, ...)</span>
<span class="go">(&#39;sage&#39;, 97, 2, ...)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.modular.quatalg.brandt.class_number">
<tt class="descclassname">sage.modular.quatalg.brandt.</tt><tt class="descname">class_number</tt><big>(</big><em>p</em>, <em>r</em>, <em>M</em><big>)</big><a class="headerlink" href="#sage.modular.quatalg.brandt.class_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the class number of an order of level N = p^r*M in the
quaternion algebra over QQ ramified precisely at p and infinity.</p>
<p>This is an implementation of Theorem 1.12 of [Pizer, 1980].</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><ul class="first last simple">
<li>p &#8211; a prime</li>
<li>r &#8211; an odd positive integer (default: 1)</li>
<li>M &#8211; an integer coprime to q (default: 1)</li>
</ul>
</dd>
<dt>OUTPUT:</dt>
<dd>Integer</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">quatalg</span><span class="o">.</span><span class="n">brandt</span><span class="o">.</span><span class="n">class_number</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">33</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">quatalg</span><span class="o">.</span><span class="n">brandt</span><span class="o">.</span><span class="n">class_number</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># TODO -- right?</span>
<span class="go">97</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">quatalg</span><span class="o">.</span><span class="n">brandt</span><span class="o">.</span><span class="n">class_number</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># TODO -- right?</span>
<span class="go">4892713</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.modular.quatalg.brandt.maximal_order">
<tt class="descclassname">sage.modular.quatalg.brandt.</tt><tt class="descname">maximal_order</tt><big>(</big><em>A</em><big>)</big><a class="headerlink" href="#sage.modular.quatalg.brandt.maximal_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a maximal order in the quaternion algebra ramified
at p and infinity.</p>
<p>This is an implementation of Proposition 5.2 of [Pizer, 1980].</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><ul class="first last simple">
<li>A &#8211; quaternion algebra ramified precisely at p and infinity</li>
</ul>
</dd>
<dt>OUTPUT:</dt>
<dd><ul class="first last simple">
<li>a maximal order in A</li>
</ul>
</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">quatalg</span><span class="o">.</span><span class="n">brandt</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">Order of Quaternion Algebra (-17, -3) with base ring Rational Field with basis (1/2 + 1/2*j, 1/2*i + 1/2*k, -1/3*j - 1/3*k, k)</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="s1">&#39;i,j,k&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="go">Order of Quaternion Algebra (-3, -17) with base ring Rational Field with basis (1/2 + 1/2*i, 1/2*j - 1/2*k, -1/3*i + 1/3*k, -k)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.modular.quatalg.brandt.quaternion_order_with_given_level">
<tt class="descclassname">sage.modular.quatalg.brandt.</tt><tt class="descname">quaternion_order_with_given_level</tt><big>(</big><em>A</em>, <em>level</em><big>)</big><a class="headerlink" href="#sage.modular.quatalg.brandt.quaternion_order_with_given_level" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an order in the quaternion algebra A with given level.
(Implemented only when the base field is the rational numbers.)</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><dl class="first last docutils">
<dt>level &#8211; The level of the order to be returned. Currently this is only implemented</dt>
<dd>when the level is divisible by at most one power of a prime that
ramifies in this quaternion algebra.</dd>
</dl>
</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.quatalg.brandt</span> <span class="kn">import</span> <span class="n">quaternion_order_with_given_level</span><span class="p">,</span> <span class="n">maximal_order</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">level</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">17</span>
<span class="gp">sage: </span><span class="n">O</span> <span class="o">=</span> <span class="n">quaternion_order_with_given_level</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">maximal_order</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">O</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">print</span> <span class="n">L</span><span class="o">.</span><span class="n">index_in</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">==</span> <span class="n">level</span><span class="o">/</span><span class="mi">5</span>  <span class="c1">#check that the order has the right index in the maximal order</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.modular.quatalg.brandt.right_order">
<tt class="descclassname">sage.modular.quatalg.brandt.</tt><tt class="descname">right_order</tt><big>(</big><em>R</em>, <em>basis</em><big>)</big><a class="headerlink" href="#sage.modular.quatalg.brandt.right_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a basis for a left ideal I, return the right order in the
quaternion order R of elements such that I*x is contained in I.</p>
<dl class="docutils">
<dt>INPUT:</dt>
<dd><ul class="first last simple">
<li>R &#8211; order in quaternion algebra</li>
<li>basis &#8211; basis for an ideal I</li>
</ul>
</dd>
<dt>OUTPUT:</dt>
<dd><ul class="first last simple">
<li>order in quaternion algebra</li>
</ul>
</dd>
</dl>
<p>EXAMPLES:</p>
<p>We do a consistency check with the ideal equal to a maximal order.:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">17</span><span class="p">);</span> <span class="n">basis</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">quatalg</span><span class="o">.</span><span class="n">brandt</span><span class="o">.</span><span class="n">basis_for_left_ideal</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">(),</span> <span class="n">B</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">quatalg</span><span class="o">.</span><span class="n">brandt</span><span class="o">.</span><span class="n">right_order</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">(),</span> <span class="n">basis</span><span class="p">)</span>
<span class="go">Order of Quaternion Algebra (-17, -3) with base ring Rational Field with basis (1/2 + 1/6*j + 2/3*k, 1/2*i + 1/2*k, 1/3*j + 1/3*k, k)</span>
<span class="gp">sage: </span><span class="n">basis</span>
<span class="go">[1/2 + 1/6*j + 2/3*k, 1/2*i + 1/2*k, 1/3*j + 1/3*k, k]</span>

<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">17</span><span class="p">);</span> <span class="n">A</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="p">();</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">basis</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">quatalg</span><span class="o">.</span><span class="n">brandt</span><span class="o">.</span><span class="n">basis_for_left_ideal</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">(),</span> <span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">j</span><span class="o">-</span><span class="n">j</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">modular</span><span class="o">.</span><span class="n">quatalg</span><span class="o">.</span><span class="n">brandt</span><span class="o">.</span><span class="n">right_order</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">(),</span> <span class="n">basis</span><span class="p">)</span>
<span class="go">Order of Quaternion Algebra (-17, -3) with base ring Rational Field with basis (1/2 + 1/2*i + 1/2*j + 17/2*k, i, j + 8*k, 9*k)</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="../../../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">Brandt Modules</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a><ul>
<li><a class="reference internal" href="#quaternion-algebras">Quaternion Algebras</a></li>
<li><a class="reference internal" href="#hecke-structure">Hecke Structure</a></li>
<li><a class="reference internal" href="#example">Example</a></li>
<li><a class="reference internal" href="#references">References</a></li>
<li><a class="reference internal" href="#further-examples">Further Examples</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="../ssmod/ssmod.html"
                                  title="previous chapter">Module of Supersingular Points</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="../cusps_nf.html"
                                  title="next chapter">The set <span class="math">\(\mathbb{P}^1(K)\)</span> of cusps of a number field K</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../_sources/sage/modular/quatalg/brandt.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../cusps_nf.html" title="The set \(\mathbb{P}^1(K)\) of cusps of a number field K"
             >next</a> |</li>
        <li class="right" >
          <a href="../ssmod/ssmod.html" title="Module of Supersingular Points"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../../index.html">Miscellaneous Modular-Form-Related Modules</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer">
        &copy; Copyright 2005--2016, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>