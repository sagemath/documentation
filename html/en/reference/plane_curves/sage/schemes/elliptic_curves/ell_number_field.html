<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Elliptic curves over number fields &mdash; Sage Reference Manual v7.0: Plane curves</title>
    
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '7.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v7.0: Plane curves" href="../../../index.html" />
    <link rel="next" title="Canonical heights for elliptic curves over number fields" href="height.html" />
    <link rel="prev" title="Tables of elliptic curves of given rank" href="ec_database.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="height.html" title="Canonical heights for elliptic curves over number fields"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ec_database.html" title="Tables of elliptic curves of given rank"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../../index.html">Plane curves</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="elliptic-curves-over-number-fields">
<span id="sage-schemes-elliptic-curves-ell-number-field"></span><h1>Elliptic curves over number fields<a class="headerlink" href="#elliptic-curves-over-number-fields" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.schemes.elliptic_curves.ell_number_field"></span><p>An elliptic curve <span class="math">\(E\)</span> over a number field <span class="math">\(K\)</span> can be given
by a Weierstrass equation whose coefficients lie in <span class="math">\(K\)</span> or by
using <tt class="docutils literal"><span class="pre">base_extend</span></tt> on an elliptic curve defined over a subfield.</p>
<p>One major difference to elliptic curves over <span class="math">\(\QQ\)</span> is that there
might not exist a global minimal equation over <span class="math">\(K\)</span>, when <span class="math">\(K\)</span> does
not have class number one.
Another difference is the lack of understanding of modularity for
general elliptic curves over general number fields.</p>
<p>Currently Sage can obtain local information about <span class="math">\(E/K_v\)</span> for finite places
<span class="math">\(v\)</span>, it has an interface to Denis Simon&#8217;s script for 2-descent, it can compute
the torsion subgroup of the Mordell-Weil group <span class="math">\(E(K)\)</span>, and it can work with
isogenies defined over <span class="math">\(K\)</span>.</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="o">+</span><span class="n">i</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">-3456*i - 6480</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">+</span><span class="n">P</span>
<span class="go">(-2*i + 9/16 : -9/4*i - 101/64 : 1)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_good_reduction</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">local_data</span><span class="p">(</span><span class="mi">4</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>
<span class="go">Local data at Fractional ideal (i + 4):</span>
<span class="go">Reduction type: bad additive</span>
<span class="go">Local minimal model: Elliptic Curve defined by y^2 = x^3 + (i+4) over Number Field in i with defining polynomial x^2 + 1</span>
<span class="go">Minimal discriminant valuation: 2</span>
<span class="go">Conductor exponent: 2</span>
<span class="go">Kodaira Symbol: II</span>
<span class="go">Tamagawa Number: 1</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">tamagawa_product_bsd</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">simon_two_descent</span><span class="p">()</span>
<span class="go">(1, 1, [(i : 2 : 1)])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">torsion_order</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">isogenies_prime_degree</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[Isogeny of degree 3 from Elliptic Curve defined by y^2 = x^3 + (i+4) over Number Field in i with defining polynomial x^2 + 1 to Elliptic Curve defined by y^2 = x^3 + (-27*i-108) over Number Field in i with defining polynomial x^2 + 1]</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Robert Bradshaw 2007</li>
<li>John Cremona</li>
<li>Chris Wuthrich</li>
</ul>
<p>REFERENCE:</p>
<ul class="simple">
<li>[Sil] Silverman, Joseph H. The arithmetic of elliptic curves. Second edition. Graduate Texts in
Mathematics, 106. Springer, 2009.</li>
<li>[Sil2] Silverman, Joseph H. Advanced topics in the arithmetic of elliptic curves. Graduate Texts in
Mathematics, 151. Springer, 1994.</li>
</ul>
<dl class="class">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field">
<em class="property">class </em><tt class="descclassname">sage.schemes.elliptic_curves.ell_number_field.</tt><tt class="descname">EllipticCurve_number_field</tt><big>(</big><em>K</em>, <em>ainvs</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="ell_field.html#sage.schemes.elliptic_curves.ell_field.EllipticCurve_field" title="sage.schemes.elliptic_curves.ell_field.EllipticCurve_field"><tt class="xref py py-class docutils literal"><span class="pre">sage.schemes.elliptic_curves.ell_field.EllipticCurve_field</span></tt></a></p>
<p>Elliptic curve over a number field.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">24</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">35</span><span class="p">])</span>
<span class="go">Elliptic Curve defined by y^2 + i*x*y + (i+1)*y = x^3 + (i-1)*x^2 + (24*i+15)*x + (14*i+35) over Number Field in i with defining polynomial x^2 + 1</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.base_extend">
<tt class="descname">base_extend</tt><big>(</big><em>R</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.base_extend" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the base extension of <tt class="docutils literal"><span class="pre">self</span></tt> to <span class="math">\(R\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;11a3&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 + (-1)*x^2 over Number Field in a with defining polynomial x^2 + 5</span>
</pre></div>
</div>
<p>Check that non-torsion points are remembered when extending
the base field (see <a class="reference external" href="http://trac.sagemath.org/16034">trac ticket #16034</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1751</span><span class="p">,</span> <span class="o">-</span><span class="mi">31352</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">d</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[(52 : 111 : 1)]</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[(52 : 111 : 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.cm_discriminant">
<tt class="descname">cm_discriminant</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.cm_discriminant" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the CM discriminant of the <span class="math">\(j\)</span>-invariant of this curve.</p>
<p>OUTPUT:</p>
<p>An integer <span class="math">\(D\)</span> which is either <span class="math">\(0\)</span> if this curve <span class="math">\(E\)</span> does not
have Complex Multiplication) (CM), or an imaginary quadratic
discriminant if <span class="math">\(j(E)\)</span> is the <span class="math">\(j\)</span>-invariant of the order with
discriminant <span class="math">\(D\)</span>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If <span class="math">\(E\)</span> has CM but the discriminant <span class="math">\(D\)</span> is not a square in
the base field <span class="math">\(K\)</span> then the extra endomorphisms will not be
defined over <span class="math">\(K\)</span>.  See also <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_rational_cm" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_rational_cm"><tt class="xref py py-meth docutils literal"><span class="pre">has_rational_cm()</span></tt></a>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">cm_discriminant</span><span class="p">()</span>
<span class="go">-3</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cm_discriminant</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Elliptic Curve defined by y^2 + x*y = x^3 + 36*x + 3455 over Rational Field does not have CM</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">1728</span><span class="p">)</span><span class="o">.</span><span class="n">cm_discriminant</span><span class="p">()</span>
<span class="go">-4</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">8000</span><span class="p">)</span><span class="o">.</span><span class="n">cm_discriminant</span><span class="p">()</span>
<span class="go">-8</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">282880</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">632000</span><span class="p">)</span><span class="o">.</span><span class="n">cm_discriminant</span><span class="p">()</span>
<span class="go">-20</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">31710790944000</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">39953093016000</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">50337742902000</span><span class="p">)</span><span class="o">.</span><span class="n">cm_discriminant</span><span class="p">()</span>
<span class="go">-108</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.conductor">
<tt class="descname">conductor</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.conductor" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the conductor of this elliptic curve as a fractional
ideal of the base field.</p>
<p>OUTPUT:</p>
<p>(fractional ideal) The conductor of the curve.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">24</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">35</span><span class="p">])</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">Fractional ideal (21*i - 3)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span> <span class="o">+</span> <span class="n">a</span> <span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">a</span> <span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a</span> <span class="p">,</span> <span class="o">-</span><span class="mi">11</span> <span class="o">+</span> <span class="n">a</span> <span class="p">,</span> <span class="mi">5</span> <span class="o">-</span><span class="mi">9</span><span class="o">*</span><span class="n">a</span>  <span class="p">])</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">Fractional ideal (-6*a)</span>
</pre></div>
</div>
<p>A not so well known curve with everywhere good reduction:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">38</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">21796814856932765568243810</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">134364590724198567128296995</span><span class="p">,</span> <span class="mi">121774567239345229314269094644186997594</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">750668847495706904791115375024037711300</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">Fractional ideal (1)</span>
</pre></div>
</div>
<p>An example which used to fail (see <a class="reference external" href="http://trac.sagemath.org/5307">trac ticket #5307</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">([</span><span class="n">w</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">w</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">Fractional ideal (86304, w + 5898)</span>
</pre></div>
</div>
<p>An example raised in <a class="reference external" href="http://trac.sagemath.org/11346">trac ticket #11346</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">g</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E1</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">48</span><span class="p">,</span><span class="o">-</span><span class="mi">161</span><span class="o">/</span><span class="mi">864</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">p</span><span class="o">.</span><span class="n">smallest_integer</span><span class="p">(),</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="n">E1</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()]</span>
<span class="go">[(2, 4), (3, 1), (5, 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.division_field">
<tt class="descname">division_field</tt><big>(</big><em>p</em>, <em>names</em>, <em>map=False</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.division_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an elliptic curve over a number field <span class="math">\(F\)</span> and a prime number <span class="math">\(p\)</span>,
construct the field <span class="math">\(F(E[p])\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">p</span></tt> &#8211; a prime number (an element of <span class="math">\(\ZZ\)</span>)</li>
<li><tt class="docutils literal"><span class="pre">names</span></tt> &#8211; a variable name for the number field</li>
<li><tt class="docutils literal"><span class="pre">map</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">False</span></tt>) also return an embedding of
the <tt class="xref py py-meth docutils literal"><span class="pre">base_field()</span></tt> into the resulting field.</li>
<li><tt class="docutils literal"><span class="pre">kwds</span></tt> &#8211; additional keywords passed to
<a class="reference external" href="../../../../number_fields/sage/rings/number_field/splitting_field.html#sage.rings.number_field.splitting_field.splitting_field" title="(in Sage Reference Manual: Algebraic Numbers and Number Fields v7.0)"><tt class="xref py py-func docutils literal"><span class="pre">sage.rings.number_field.splitting_field.splitting_field()</span></tt></a>.</li>
</ul>
<p>OUTPUT:</p>
<p>If <tt class="docutils literal"><span class="pre">map</span></tt> is <tt class="docutils literal"><span class="pre">False</span></tt>, the division field as an absolute number
field.  If <tt class="docutils literal"><span class="pre">map</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt>, a tuple <tt class="docutils literal"><span class="pre">(K,</span> <span class="pre">phi)</span></tt> where <tt class="docutils literal"><span class="pre">phi</span></tt>
is an embedding of the base field in the division field <tt class="docutils literal"><span class="pre">K</span></tt>.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This takes a very long time when the degree of the division
field is large (e.g. when <span class="math">\(p\)</span> is large or when the Galois
representation is surjective).  The <tt class="docutils literal"><span class="pre">simplify</span></tt> flag also
has a big influence on the running time: sometimes
<tt class="docutils literal"><span class="pre">simplify=False</span></tt> is faster, sometimes <tt class="docutils literal"><span class="pre">simplify=True</span></tt>
(the default) is faster.</p>
</div>
<p>EXAMPLES:</p>
<p>The 2-division field is the same as the splitting field of
the 2-division polynomial (therefore, it has degree 1, 2, 3 or 6):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;15a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">division_field</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in b with defining polynomial x</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;14a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">division_field</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in b with defining polynomial x^2 + 5*x + 92</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;196b1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">division_field</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in b with defining polynomial x^3 + x^2 - 114*x - 127</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;19a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">division_field</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in b with defining polynomial x^6 + 10*x^5 + 24*x^4 - 212*x^3 + 1364*x^2 + 24072*x + 104292</span>
</pre></div>
</div>
<p>For odd primes <span class="math">\(p\)</span>, the division field is either the splitting
field of the <span class="math">\(p\)</span>-division polynomial, or a quadratic extension
of it.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;50a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">division_polynomial</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">splitting_field</span><span class="p">(</span><span class="n">simplify_all</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">F</span>
<span class="go">Number Field in a with defining polynomial x^6 - 3*x^5 + 4*x^4 - 3*x^3 - 2*x^2 + 3*x + 3</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">division_field</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">simplify_all</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in b with defining polynomial x^6 - 3*x^5 + 4*x^4 - 3*x^3 - 2*x^2 + 3*x + 3</span>
</pre></div>
</div>
<p>If we take any quadratic twist, the splitting field of the
3-division polynomial remains the same, but the 3-division field
becomes a quadratic extension:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">quadratic_twist</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="c"># 50b3</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">division_polynomial</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">splitting_field</span><span class="p">(</span><span class="n">simplify_all</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">F</span>
<span class="go">Number Field in a with defining polynomial x^6 - 3*x^5 + 4*x^4 - 3*x^3 - 2*x^2 + 3*x + 3</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">division_field</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">simplify_all</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in b with defining polynomial x^12 - 3*x^11 + 8*x^10 - 15*x^9 + 30*x^8 - 63*x^7 + 109*x^6 - 144*x^5 + 150*x^4 - 120*x^3 + 68*x^2 - 24*x + 4</span>
</pre></div>
</div>
<p>Try another quadratic twist, this time over a subfield of <span class="math">\(F\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">.&lt;</span><span class="n">c</span><span class="o">&gt;</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">subfields</span><span class="p">(</span><span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">G</span><span class="p">)</span><span class="o">.</span><span class="n">quadratic_twist</span><span class="p">(</span><span class="n">c</span><span class="p">);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + 5*a0*x^2 + (-200*a0^2)*x + (-42000*a0^2+42000*a0+126000) over Number Field in a0 with defining polynomial x^3 - 3*x^2 + 3*x + 9</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">division_field</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">simplify_all</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in b with defining polynomial x^12 - 10*x^10 + 55*x^8 - 60*x^6 + 75*x^4 + 1350*x^2 + 2025</span>
</pre></div>
</div>
<p>Some higher-degree examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">division_field</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in b with defining polynomial x^6 + 2*x^5 - 48*x^4 - 436*x^3 + 1668*x^2 + 28792*x + 73844</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">division_field</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">K</span>  <span class="c"># long time (3s on sage.math, 2014)</span>
<span class="go">Number Field in b with defining polynomial x^48 ...</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">division_field</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in b with defining polynomial x^4 - x^3 + x^2 - x + 1</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">division_field</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="n">simplify</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">Number Field in b with defining polynomial x^4 + x^3 + 11*x^2 + 41*x + 101</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">torsion_subgroup</span><span class="p">()</span>  <span class="c"># long time (2s on sage.math, 2014)</span>
<span class="go">Torsion Subgroup isomorphic to Z/5 + Z/5 associated to the Elliptic Curve defined by y^2 + y = x^3 + (-1)*x^2 + (-10)*x + (-20) over Number Field in b with defining polynomial x^4 - x^3 + x^2 - x + 1</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;27a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">division_field</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in b with defining polynomial x^2 + 3*x + 9</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">division_field</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in b with defining polynomial x^6 + 6*x^5 + 24*x^4 - 52*x^3 - 228*x^2 + 744*x + 3844</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">division_field</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">simplify_all</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in b with defining polynomial x^6 - 3*x^5 + 5*x^3 - 3*x + 1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">division_field</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span> <span class="n">K</span>   <span class="c"># long time (4s on sage.math, 2014)</span>
<span class="go">Number Field in b with defining polynomial x^48 ...</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">division_field</span><span class="p">(</span><span class="mi">7</span><span class="p">);</span> <span class="n">K</span>  <span class="c"># long time (8s on sage.math, 2014)</span>
<span class="go">Number Field in b with defining polynomial x^72 ...</span>
</pre></div>
</div>
<p>Over a number field:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">division_field</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">L</span>
<span class="go">Number Field in b with defining polynomial x^4 - x^2 + 1</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">division_field</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">map</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">phi</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Number Field in i with defining polynomial x^2 + 1</span>
<span class="go">  To:   Number Field in b with defining polynomial x^4 - x^2 + 1</span>
<span class="go">  Defn: i |--&gt; -b^3</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">division_field</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="nb">map</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">Number Field in b with defining polynomial x^24 - 6*x^22 - 12*x^21 - 21*x^20 + 216*x^19 + 48*x^18 + 804*x^17 + 1194*x^16 - 13488*x^15 + 21222*x^14 + 44196*x^13 - 47977*x^12 - 102888*x^11 + 173424*x^10 - 172308*x^9 + 302046*x^8 + 252864*x^7 - 931182*x^6 + 180300*x^5 + 879567*x^4 - 415896*x^3 + 1941012*x^2 + 650220*x + 443089</span>
<span class="gp">sage: </span><span class="n">phi</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Number Field in i with defining polynomial x^2 + 1</span>
<span class="go">  To:   Number Field in b with defining polynomial x^24 ...</span>
<span class="go">  Defn: i |--&gt; -215621657062634529/183360797284413355040732*b^23 ...</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Jeroen Demeyer (2014-01-06): <a class="reference external" href="http://trac.sagemath.org/11905">trac ticket #11905</a>, use
<tt class="docutils literal"><span class="pre">splitting_field</span></tt> method, moved from <tt class="docutils literal"><span class="pre">gal_reps.py</span></tt>, make
it work over number fields.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.galois_representation">
<tt class="descname">galois_representation</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.galois_representation" title="Permalink to this definition">¶</a></dt>
<dd><p>The compatible family of the Galois representation
attached to this elliptic curve.</p>
<p>Given an elliptic curve <span class="math">\(E\)</span> over a number field <span class="math">\(K\)</span>
and a rational prime number <span class="math">\(p\)</span>, the <span class="math">\(p^n\)</span>-torsion
<span class="math">\(E[p^n]\)</span> points of <span class="math">\(E\)</span> is a representation of the
absolute Galois group of <span class="math">\(K\)</span>. As <span class="math">\(n\)</span> varies
we obtain the Tate module <span class="math">\(T_p E\)</span> which is a
a representation of <span class="math">\(G_K\)</span> on a free <span class="math">\(\ZZ_p\)</span>-module
of rank <span class="math">\(2\)</span>. As <span class="math">\(p\)</span> varies the representations
are compatible.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;11a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span>
<span class="go">Compatible family of Galois representations associated to the Elliptic Curve defined by y^2 + y = x^3 + (-1)*x^2 + (-10)*x + (-20) over Number Field in a with defining polynomial x^2 + 1</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="c"># long time (4s on sage.math, 2014)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">non_surjective</span><span class="p">()</span>
<span class="go">[5]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.gens">
<tt class="descname">gens</tt><big>(</big><em>**kwds</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.gens" title="Permalink to this definition">¶</a></dt>
<dd><p>Return some points of infinite order on this elliptic curve.</p>
<p>Contrary to what the name of this method suggests, the points
it returns do not always generate a subgroup of full rank in
the Mordell-Weil group, nor are they necessarily linearly
independent.  Moreover, the number of points can be smaller or
larger than what one could expect after calling <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.rank" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.rank"><tt class="xref py py-meth docutils literal"><span class="pre">rank()</span></tt></a>
or <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.rank_bounds" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.rank_bounds"><tt class="xref py py-meth docutils literal"><span class="pre">rank_bounds()</span></tt></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The optional parameters control the Simon two descent algorithm;
see the documentation of <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.simon_two_descent" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.simon_two_descent"><tt class="xref py py-meth docutils literal"><span class="pre">simon_two_descent()</span></tt></a> for more
details.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">verbose</span></tt> &#8211; 0, 1, 2, or 3 (default: 0), the verbosity level</li>
<li><tt class="docutils literal"><span class="pre">lim1</span></tt>    &#8211; (default: 2) limit on trivial points on quartics</li>
<li><tt class="docutils literal"><span class="pre">lim3</span></tt>  &#8211; (default: 4) limit on points on ELS quartics</li>
<li><tt class="docutils literal"><span class="pre">limtriv</span></tt> &#8211; (default: 2) limit on trivial points on elliptic curve</li>
<li><tt class="docutils literal"><span class="pre">maxprob</span></tt> &#8211; (default: 20)</li>
<li><tt class="docutils literal"><span class="pre">limbigprime</span></tt> &#8211; (default: 30) to distinguish between
small and large prime numbers. Use probabilistic tests for
large primes. If 0, don&#8217;t use probabilistic tests.</li>
<li><tt class="docutils literal"><span class="pre">known_points</span></tt> &#8211; (default: None) list of known points on
the curve</li>
</ul>
<p>OUTPUT:</p>
<p>A set of points of infinite order given by the Simon two-descent.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For non-quadratic number fields, this code does return, but it takes
a long time.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">23</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="s">&#39;37&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">==</span> <span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">E</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[(0 : 0 : 1), (1/8*a + 5/8 : -3/16*a - 7/16 : 1)]</span>
</pre></div>
</div>
<p>It can happen that no points are found if the height bounds
used in the search are too small (see <a class="reference external" href="http://trac.sagemath.org/10745">trac ticket #10745</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">(</span><span class="n">lim1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">lim3</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">rank</span><span class="p">(),</span> <span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>  <span class="c"># long time (about 3 s)</span>
<span class="go">(1, [(9/25*y^2 + 26/25 : -229/125*y^3 - 67/25*y^2 - 731/125*y - 213/25 : 1)])</span>
</pre></div>
</div>
<p>Here is a curve of rank 2, yet the list contains many points:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">17</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[(-1/2*t + 1/2 : -1/2*t + 1/2 : 1),</span>
<span class="go">(-2*t + 8 : -8*t + 32 : 1),</span>
<span class="go">(1/2*t + 3/2 : -1/2*t - 7/2 : 1),</span>
<span class="go">(-1/8*t - 7/8 : -1/16*t - 23/16 : 1),</span>
<span class="go">(1/8*t - 7/8 : -1/16*t + 23/16 : 1),</span>
<span class="go">(t + 3 : -2*t - 10 : 1),</span>
<span class="go">(2*t + 8 : -8*t - 32 : 1),</span>
<span class="go">(1/2*t + 1/2 : -1/2*t - 1/2 : 1),</span>
<span class="go">(-1/2*t + 3/2 : -1/2*t + 7/2 : 1),</span>
<span class="go">(t + 7 : -4*t - 20 : 1),</span>
<span class="go">(-t + 7 : -4*t + 20 : 1),</span>
<span class="go">(-t + 3 : -2*t + 10 : 1)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Test that points of finite order are not included (see <a class="reference external" href="http://trac.sagemath.org/13593">trac ticket #13593</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&quot;17a3&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>IMPLEMENTATION:</p>
<p>Uses Denis Simon&#8217;s PARI/GP scripts from
<a class="reference external" href="http://www.math.unicaen.fr/~simon/">http://www.math.unicaen.fr/~simon/</a>.</p>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.global_integral_model">
<tt class="descname">global_integral_model</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.global_integral_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a model of self which is integral at all primes.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P1</span><span class="p">,</span><span class="n">P2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_integral_model</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 + (-i)*x*y + (-25*i)*y = x^3 + 5*i*x^2 + 125*i*x + 3125*i over Number Field in i with defining polynomial x^2 + 1</span>
</pre></div>
</div>
<p><a class="reference external" href="http://trac.sagemath.org/7935">trac ticket #7935</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">38</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_integral_model</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + 1444*a*x + 27436 over Number Field in a with defining polynomial x^2 - 38</span>
</pre></div>
</div>
<p><a class="reference external" href="http://trac.sagemath.org/9266">trac ticket #9266</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">s</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="n">w</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_integral_model</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + 2*x + (1/2*s+1/2) over Number Field in s with defining polynomial x^2 - 5</span>
</pre></div>
</div>
<p><a class="reference external" href="http://trac.sagemath.org/12151">trac ticket #12151</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">161</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">150</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">25105</span><span class="o">/</span><span class="mi">216</span><span class="o">*</span><span class="n">v</span> <span class="o">-</span> <span class="mi">3839</span><span class="o">/</span><span class="mi">36</span><span class="p">,</span> <span class="mi">634768555</span><span class="o">/</span><span class="mi">7776</span><span class="o">*</span><span class="n">v</span> <span class="o">-</span> <span class="mi">98002625</span><span class="o">/</span><span class="mi">1296</span><span class="p">,</span> <span class="mi">634768555</span><span class="o">/</span><span class="mi">7776</span><span class="o">*</span><span class="n">v</span> <span class="o">-</span> <span class="mi">98002625</span><span class="o">/</span><span class="mi">1296</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_integral_model</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 + (2094779518028859*v-1940492905300351)*x*y + (477997268472544193101178234454165304071127500*v-442791377441346852919930773849502871958097500)*y = x^3 + (26519784690047674853185542622500*v-24566525306469707225840460652500)*x^2 over Number Field in v with defining polynomial x^2 + 161*x - 150</span>
</pre></div>
</div>
<p><a class="reference external" href="http://trac.sagemath.org/14476">trac ticket #14476</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">g</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span> <span class="o">-</span><span class="mi">43</span><span class="o">/</span><span class="mi">625</span><span class="o">*</span><span class="n">g</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">14</span><span class="o">/</span><span class="mi">625</span><span class="o">*</span><span class="n">g</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">/</span><span class="mi">625</span><span class="o">*</span><span class="n">g</span> <span class="o">+</span> <span class="mi">706</span><span class="o">/</span><span class="mi">625</span><span class="p">,</span> <span class="o">-</span><span class="mi">4862</span><span class="o">/</span><span class="mi">78125</span><span class="o">*</span><span class="n">g</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">4074</span><span class="o">/</span><span class="mi">78125</span><span class="o">*</span><span class="n">g</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">711</span><span class="o">/</span><span class="mi">78125</span><span class="o">*</span><span class="n">g</span> <span class="o">+</span> <span class="mi">10304</span><span class="o">/</span><span class="mi">78125</span><span class="p">,</span>  <span class="o">-</span><span class="mi">4862</span><span class="o">/</span><span class="mi">78125</span><span class="o">*</span><span class="n">g</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">4074</span><span class="o">/</span><span class="mi">78125</span><span class="o">*</span><span class="n">g</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">711</span><span class="o">/</span><span class="mi">78125</span><span class="o">*</span><span class="n">g</span> <span class="o">+</span> <span class="mi">10304</span><span class="o">/</span><span class="mi">78125</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_integral_model</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 + (15*g^3-48*g-42)*x*y + (-111510*g^3-162162*g^2-44145*g+37638)*y = x^3 + (-954*g^3-1134*g^2+81*g+576)*x^2 over Number Field in g with defining polynomial t^4 - t^3 - 3*t^2 - t + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.global_minimal_model">
<tt class="descname">global_minimal_model</tt><big>(</big><em>proof=None</em>, <em>semi_global=False</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.global_minimal_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a model of self that is integral, and minimal.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Over fields of class number greater than 1, a global
minimal model may not exist.  If it does not, set the
parameter <tt class="docutils literal"><span class="pre">semi_global</span></tt> to <tt class="docutils literal"><span class="pre">True</span></tt> to obtain a model
minimal at all but one prime.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">proof</span></tt> &#8211; whether to only use provably correct methods
(default controlled by global proof module).  Note that the
proof module is number_field, not elliptic_curves, since the
functions that actually need the flag are in number fields.</li>
<li><tt class="docutils literal"><span class="pre">semi_global</span></tt> (boolean, default False) &#8211; if there is no
global minimal mode, return a semi-global minimal model
(minimal at all but one prime) instead, if True; raise an
error if False.  No effect if a global minimal model exists.</li>
</ul>
<p>OUTPUT:</p>
<p>A global integral and minimal model, or an integral model
minimal at all but one prime of there is no global minimal
model and the flag <tt class="docutils literal"><span class="pre">semi_global</span></tt> is True.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">38</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">21796814856932765568243810</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">134364590724198567128296995</span><span class="p">,</span> <span class="mi">121774567239345229314269094644186997594</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">750668847495706904791115375024037711300</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">global_minimal_model</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E2</span>
<span class="go">Elliptic Curve defined by y^2 + a*x*y + (a+1)*y = x^3 + (a+1)*x^2 + (4*a+15)*x + (4*a+21) over Number Field in a with defining polynomial x^2 - 38</span>
<span class="gp">sage: </span><span class="n">E2</span><span class="o">.</span><span class="n">local_data</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>See <a class="reference external" href="http://trac.sagemath.org/11347">trac ticket #11347</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">g</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">48</span><span class="p">,</span><span class="mi">161</span><span class="o">/</span><span class="mi">864</span><span class="p">])</span><span class="o">.</span><span class="n">integral_model</span><span class="p">()</span><span class="o">.</span><span class="n">global_minimal_model</span><span class="p">();</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 over Number Field in g with defining polynomial x^2 - x - 1</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">p</span><span class="o">.</span><span class="n">norm</span><span class="p">(),</span> <span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">E</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()]</span>
<span class="go">[(9, 1), (5, 1)]</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">p</span><span class="o">.</span><span class="n">norm</span><span class="p">(),</span> <span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()]</span>
<span class="go">[(-5, 2), (9, 1)]</span>
</pre></div>
</div>
<p>See <a class="reference external" href="http://trac.sagemath.org/14472">trac ticket #14472</a>, this used not to work over a relative extension:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K1</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K2</span><span class="o">.&lt;</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K1</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">w</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="o">*</span><span class="n">v</span><span class="p">,</span><span class="o">-</span><span class="mi">432</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_minimal_model</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 over Number Field in v with defining polynomial x^2 - w + 1 over its base field</span>
</pre></div>
</div>
<p>See <a class="reference external" href="http://trac.sagemath.org/18662">trac ticket #18662</a>: for fields of class number greater than 1,
even when global minimal models did exist, their computation
was not implemented.  Now it is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">class_number</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">186408</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">589491</span><span class="p">,</span> <span class="mi">78055704</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">246833838</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">16375845905239507992576</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">2^31 * 3^27</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_global_minimal_model</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Emin</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">global_minimal_model</span><span class="p">();</span> <span class="n">Emin</span>
<span class="go">Elliptic Curve defined by y^2 + (a+1)*x*y + (a+1)*y = x^3 + (-a)*x^2 + (a-12)*x + (-2*a+2) over Number Field in a with defining polynomial x^2 - 10</span>
<span class="gp">sage: </span><span class="n">Emin</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">3456</span>
<span class="gp">sage: </span><span class="n">Emin</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">2^7 * 3^3</span>
</pre></div>
</div>
<p>If there is no global minimal model, this method will raise an
error unless you set the parameter <tt class="docutils literal"><span class="pre">semi_global</span></tt> to <tt class="docutils literal"><span class="pre">True</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">class_number</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_global_minimal_model</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_minimal_model</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Elliptic Curve defined by y^2 + a*x*y = x^3 + a*x^2 + (3*a+8)*x + (4*a+3) over Number Field in a with defining polynomial x^2 - 10 has no global minimal model!  For a semi-global minimal model use semi_global=True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_minimal_model</span><span class="p">(</span><span class="n">semi_global</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by y^2 + a*x*y = x^3 + a*x^2 + (3*a+8)*x + (4*a+3) over Number Field in a with defining polynomial x^2 - 10</span>
</pre></div>
</div>
<p>An example of a curve with everywhere good reduction but which
has no model with unit discriminant:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">-</span><span class="mi">16</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">class_number</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">15221331</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">53748576</span><span class="p">,</span> <span class="o">-</span><span class="mi">79617688290</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">281140318368</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Emin</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">global_minimal_model</span><span class="p">(</span><span class="n">semi_global</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Emin</span><span class="o">.</span><span class="n">ainvs</span><span class="p">()</span>
<span class="go">(a, a - 1, a, 605*a - 2728, 15887*a - 71972)</span>
<span class="gp">sage: </span><span class="n">Emin</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">-17*a - 16</span>
<span class="gp">sage: </span><span class="n">Emin</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">-4096</span>
<span class="gp">sage: </span><span class="n">Emin</span><span class="o">.</span><span class="n">minimal_discriminant_ideal</span><span class="p">()</span>
<span class="go">Fractional ideal (1)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">Fractional ideal (1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.global_minimality_class">
<tt class="descname">global_minimality_class</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.global_minimality_class" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the obstruction to this curve having a global minimal model.</p>
<p>OUTPUT:</p>
<p>An ideal class of the base number field, which is trivial if
and only if the elliptic curve has a global minimal model, and
which can be used to find global and semi-global minimal
models.</p>
<p>EXAMPLES:</p>
<p>A curve defined over a field of class number 2 with no global
minimal model was a nontrivial minimality class:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">class_number</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">22500</span><span class="p">,</span> <span class="mi">750000</span><span class="o">*</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_minimality_class</span><span class="p">()</span>
<span class="go">Fractional ideal class (10, 5*a)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_minimality_class</span><span class="p">()</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Over the same field, a curve defined by a non-minimal model
has trivial class, showing that a global minimal model does
exist:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4536</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">14148</span><span class="p">,</span><span class="o">-</span><span class="mi">163728</span><span class="o">*</span><span class="n">a</span><span class="o">-</span> <span class="mi">474336</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">is_global_minimal_model</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_minimality_class</span><span class="p">()</span>
<span class="go">Trivial principal fractional ideal class</span>
</pre></div>
</div>
<p>Over a field of class number 1 the result is always the
trivial class:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">K</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="mi">64</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_minimality_class</span><span class="p">()</span>
<span class="go">Trivial principal fractional ideal class</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">64</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">base_field</span><span class="p">()</span>
<span class="go">Rational Field</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_minimality_class</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_additive_reduction">
<tt class="descname">has_additive_reduction</tt><big>(</big><em>P</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_additive_reduction" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this elliptic curve has (bad) additive reduction at the prime <span class="math">\(P\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">P</span></tt> &#8211; a prime ideal of the base field of self, or a field
element generating such an ideal.</li>
</ul>
<p>OUTPUT:</p>
<p>(bool) True if the curve has additive reduction at <span class="math">\(P\)</span>, else False.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;27a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">p</span><span class="p">,</span><span class="n">E</span><span class="o">.</span><span class="n">has_additive_reduction</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">15</span><span class="p">)]</span>
<span class="go">[(2, False), (3, True), (5, False), (7, False), (11, False), (13, False)]</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P17a</span><span class="p">,</span> <span class="n">P17b</span> <span class="o">=</span> <span class="p">[</span><span class="n">P</span> <span class="k">for</span> <span class="n">P</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">17</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">p</span><span class="p">,</span><span class="n">E</span><span class="o">.</span><span class="n">has_additive_reduction</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="n">P17a</span><span class="p">,</span><span class="n">P17b</span><span class="p">]]</span>
<span class="go">[(Fractional ideal (4*a^2 - 2*a + 1), False),</span>
<span class="go">(Fractional ideal (2*a + 1), True)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_bad_reduction">
<tt class="descname">has_bad_reduction</tt><big>(</big><em>P</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_bad_reduction" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this elliptic curve has bad reduction at the prime <span class="math">\(P\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">P</span></tt> &#8211; a prime ideal of the base field of self, or a field
element generating such an ideal.</li>
</ul>
<p>OUTPUT:</p>
<p>(bool) True if the curve has bad reduction at <span class="math">\(P\)</span>, else False.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This requires determining a local integral minimal model;
we do not just check that the discriminant of the current
model has valuation zero.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;14a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">p</span><span class="p">,</span><span class="n">E</span><span class="o">.</span><span class="n">has_bad_reduction</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">15</span><span class="p">)]</span>
<span class="go">[(2, True), (3, False), (5, False), (7, True), (11, False), (13, False)]</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P17a</span><span class="p">,</span> <span class="n">P17b</span> <span class="o">=</span> <span class="p">[</span><span class="n">P</span> <span class="k">for</span> <span class="n">P</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">17</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">p</span><span class="p">,</span><span class="n">E</span><span class="o">.</span><span class="n">has_bad_reduction</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="n">P17a</span><span class="p">,</span><span class="n">P17b</span><span class="p">]]</span>
<span class="go">[(Fractional ideal (4*a^2 - 2*a + 1), False),</span>
<span class="go">(Fractional ideal (2*a + 1), True)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_cm">
<tt class="descname">has_cm</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_cm" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns whether or not this curve has a CM <span class="math">\(j\)</span>-invariant.</p>
<p>OUTPUT:</p>
<p><tt class="docutils literal"><span class="pre">True</span></tt> if this curve has CM over the algebraic closure
of the base field, otherwise <tt class="docutils literal"><span class="pre">False</span></tt>.  See also
<a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.cm_discriminant" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.cm_discriminant"><tt class="xref py py-meth docutils literal"><span class="pre">cm_discriminant()</span></tt></a> and <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_rational_cm" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_rational_cm"><tt class="xref py py-meth docutils literal"><span class="pre">has_rational_cm()</span></tt></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Even if <span class="math">\(E\)</span> has CM in this sense (that its <span class="math">\(j\)</span>-invariant is
a CM <span class="math">\(j\)</span>-invariant), since the associated negative
discriminant <span class="math">\(D\)</span> is not a square in the base field <span class="math">\(K\)</span>, the
extra endomorphisms will not be defined over <span class="math">\(K\)</span>.  See also
the method <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_rational_cm" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_rational_cm"><tt class="xref py py-meth docutils literal"><span class="pre">has_rational_cm()</span></tt></a> which tests whether <span class="math">\(E\)</span>
has extra endomorphisms defined over <span class="math">\(K\)</span> or a given
extension of <span class="math">\(K\)</span>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">has_cm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">has_cm</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">1728</span><span class="p">)</span><span class="o">.</span><span class="n">has_cm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">8000</span><span class="p">)</span><span class="o">.</span><span class="n">has_cm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">282880</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">632000</span><span class="p">)</span><span class="o">.</span><span class="n">has_cm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">31710790944000</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">39953093016000</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">50337742902000</span><span class="p">)</span><span class="o">.</span><span class="n">has_cm</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_global_minimal_model">
<tt class="descname">has_global_minimal_model</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_global_minimal_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns whether this elliptic curve has a global minimal model.</p>
<p>OUTPUT:</p>
<p>Boolean, True iff a global minimal model exists, i.e. an
integral model which is minimal at every prime.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4536</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">14148</span><span class="p">,</span><span class="o">-</span><span class="mi">163728</span><span class="o">*</span><span class="n">a</span><span class="o">-</span><span class="mi">474336</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">is_global_minimal_model</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_global_minimal_model</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_good_reduction">
<tt class="descname">has_good_reduction</tt><big>(</big><em>P</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_good_reduction" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this elliptic curve has good reduction at the prime <span class="math">\(P\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">P</span></tt> &#8211; a prime ideal of the base field of self, or a field
element generating such an ideal.</li>
</ul>
<p>OUTPUT:</p>
<p>(bool) &#8211; True if the curve has good reduction at <span class="math">\(P\)</span>, else False.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This requires determining a local integral minimal model;
we do not just check that the discriminant of the current
model has valuation zero.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;14a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">p</span><span class="p">,</span><span class="n">E</span><span class="o">.</span><span class="n">has_good_reduction</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">15</span><span class="p">)]</span>
<span class="go">[(2, False), (3, True), (5, True), (7, False), (11, True), (13, True)]</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P17a</span><span class="p">,</span> <span class="n">P17b</span> <span class="o">=</span> <span class="p">[</span><span class="n">P</span> <span class="k">for</span> <span class="n">P</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">17</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">p</span><span class="p">,</span><span class="n">E</span><span class="o">.</span><span class="n">has_good_reduction</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="n">P17a</span><span class="p">,</span><span class="n">P17b</span><span class="p">]]</span>
<span class="go">[(Fractional ideal (4*a^2 - 2*a + 1), True),</span>
<span class="go">(Fractional ideal (2*a + 1), False)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_multiplicative_reduction">
<tt class="descname">has_multiplicative_reduction</tt><big>(</big><em>P</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_multiplicative_reduction" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this elliptic curve has (bad) multiplicative reduction at the prime <span class="math">\(P\)</span>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">See also <tt class="docutils literal"><span class="pre">has_split_multiplicative_reduction()</span></tt> and
<tt class="docutils literal"><span class="pre">has_nonsplit_multiplicative_reduction()</span></tt>.</p>
</div>
<p>INPUT:</p>
<ul>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">P</span></tt> &#8211; a prime ideal of the base field of self, or a field</dt>
<dd><p class="first last">element generating such an ideal.</p>
</dd>
</dl>
</li>
</ul>
<p>OUTPUT:</p>
<p>(bool) True if the curve has multiplicative reduction at <span class="math">\(P\)</span>,
else False.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;14a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">p</span><span class="p">,</span><span class="n">E</span><span class="o">.</span><span class="n">has_multiplicative_reduction</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">15</span><span class="p">)]</span>
<span class="go">[(2, True), (3, False), (5, False), (7, True), (11, False), (13, False)]</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P17a</span><span class="p">,</span> <span class="n">P17b</span> <span class="o">=</span> <span class="p">[</span><span class="n">P</span> <span class="k">for</span> <span class="n">P</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">17</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">p</span><span class="p">,</span><span class="n">E</span><span class="o">.</span><span class="n">has_multiplicative_reduction</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="n">P17a</span><span class="p">,</span><span class="n">P17b</span><span class="p">]]</span>
<span class="go">[(Fractional ideal (4*a^2 - 2*a + 1), False), (Fractional ideal (2*a + 1), False)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_nonsplit_multiplicative_reduction">
<tt class="descname">has_nonsplit_multiplicative_reduction</tt><big>(</big><em>P</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_nonsplit_multiplicative_reduction" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this elliptic curve has (bad) non-split multiplicative reduction at the prime <span class="math">\(P\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">P</span></tt> &#8211; a prime ideal of the base field of self, or a field
element generating such an ideal.</li>
</ul>
<p>OUTPUT:</p>
<p>(bool) True if the curve has non-split multiplicative
reduction at <span class="math">\(P\)</span>, else False.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;14a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">p</span><span class="p">,</span><span class="n">E</span><span class="o">.</span><span class="n">has_nonsplit_multiplicative_reduction</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">15</span><span class="p">)]</span>
<span class="go">[(2, True), (3, False), (5, False), (7, False), (11, False), (13, False)]</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P17a</span><span class="p">,</span> <span class="n">P17b</span> <span class="o">=</span> <span class="p">[</span><span class="n">P</span> <span class="k">for</span> <span class="n">P</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">17</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">p</span><span class="p">,</span><span class="n">E</span><span class="o">.</span><span class="n">has_nonsplit_multiplicative_reduction</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="n">P17a</span><span class="p">,</span><span class="n">P17b</span><span class="p">]]</span>
<span class="go">[(Fractional ideal (4*a^2 - 2*a + 1), False), (Fractional ideal (2*a + 1), False)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_rational_cm">
<tt class="descname">has_rational_cm</tt><big>(</big><em>field=None</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_rational_cm" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns whether or not this curve has CM defined over its
base field or a given extension.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">field</span></tt> &#8211; a field, which should be an extension of the
base field of the curve.  If <tt class="docutils literal"><span class="pre">field</span></tt> is <tt class="docutils literal"><span class="pre">None</span></tt> (the
default), it is taken to be the base field of the curve.</li>
</ul>
<p>OUTPUT:</p>
<p><tt class="docutils literal"><span class="pre">True</span></tt> if the ring of endomorphisms of this curve over
the given field is larger than <span class="math">\(\ZZ\)</span>; otherwise <tt class="docutils literal"><span class="pre">False</span></tt>.
See also <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.cm_discriminant" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.cm_discriminant"><tt class="xref py py-meth docutils literal"><span class="pre">cm_discriminant()</span></tt></a> and <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_cm" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_cm"><tt class="xref py py-meth docutils literal"><span class="pre">has_cm()</span></tt></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If <span class="math">\(E\)</span> has CM but the discriminant <span class="math">\(D\)</span> is not a square in
the given field <span class="math">\(K\)</span> then the extra endomorphisms will not
be defined over <span class="math">\(K\)</span>, and this function will return
<tt class="docutils literal"><span class="pre">False</span></tt>.  See also <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_cm" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_cm"><tt class="xref py py-meth docutils literal"><span class="pre">has_cm()</span></tt></a>.  To obtain the CM
discriminant, use <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.cm_discriminant" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.cm_discriminant"><tt class="xref py py-meth docutils literal"><span class="pre">cm_discriminant()</span></tt></a>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_cm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_rational_cm</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">cm_discriminant</span><span class="p">();</span> <span class="n">D</span>
<span class="go">-3</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_rational_cm</span><span class="p">(</span><span class="n">QuadraticField</span><span class="p">(</span><span class="n">D</span><span class="p">))</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">1728</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_cm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_rational_cm</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">cm_discriminant</span><span class="p">();</span> <span class="n">D</span>
<span class="go">-4</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_rational_cm</span><span class="p">(</span><span class="n">QuadraticField</span><span class="p">(</span><span class="n">D</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Higher degree examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">282880</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">632000</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_cm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_rational_cm</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cm_discriminant</span><span class="p">()</span>
<span class="go">-20</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_rational_cm</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>An error is raised if a field is given which is not an extension of the base field:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_rational_cm</span><span class="p">(</span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Error in has_rational_cm: Number Field in a with defining polynomial x^2 + 20 is not an extension field of Number Field in a with defining polynomial x^2 - 5</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">31710790944000</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">39953093016000</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">50337742902000</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_cm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_rational_cm</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">cm_discriminant</span><span class="p">();</span> <span class="n">D</span>
<span class="go">-108</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_rational_cm</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">108</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_split_multiplicative_reduction">
<tt class="descname">has_split_multiplicative_reduction</tt><big>(</big><em>P</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.has_split_multiplicative_reduction" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this elliptic curve has (bad) split multiplicative reduction at the prime <span class="math">\(P\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">P</span></tt> &#8211; a prime ideal of the base field of self, or a field
element generating such an ideal.</li>
</ul>
<p>OUTPUT:</p>
<p>(bool) True if the curve has split multiplicative reduction at
<span class="math">\(P\)</span>, else False.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;14a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">p</span><span class="p">,</span><span class="n">E</span><span class="o">.</span><span class="n">has_split_multiplicative_reduction</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">15</span><span class="p">)]</span>
<span class="go">[(2, False), (3, False), (5, False), (7, True), (11, False), (13, False)]</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P17a</span><span class="p">,</span> <span class="n">P17b</span> <span class="o">=</span> <span class="p">[</span><span class="n">P</span> <span class="k">for</span> <span class="n">P</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">17</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">p</span><span class="p">,</span><span class="n">E</span><span class="o">.</span><span class="n">has_split_multiplicative_reduction</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="n">P17a</span><span class="p">,</span><span class="n">P17b</span><span class="p">]]</span>
<span class="go">[(Fractional ideal (4*a^2 - 2*a + 1), False), (Fractional ideal (2*a + 1), False)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.height_function">
<tt class="descname">height_function</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.height_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the canonical height function attached to self.</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="s">&#39;11a3&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
<span class="go">EllipticCurveCanonicalHeight object associated to Elliptic Curve defined by y^2 + y = x^3 + (-1)*x^2 over Number Field in a with defining polynomial x^2 - 5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.height_pairing_matrix">
<tt class="descname">height_pairing_matrix</tt><big>(</big><em>points=None</em>, <em>precision=None</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.height_pairing_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the height pairing matrix of the given points.</p>
<p>INPUT:</p>
<ul class="simple">
<li>points - either a list of points, which must be on this
curve, or (default) None, in which case self.gens() will be
used.</li>
<li>precision - number of bits of precision of result
(default: None, for default RealField precision)</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">height_pairing_matrix</span><span class="p">()</span>
<span class="go">[0.0511114082399688]</span>
</pre></div>
</div>
<p>For rank 0 curves, the result is a valid 0x0 matrix:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;11a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">height_pairing_matrix</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;5077a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">height_pairing_matrix</span><span class="p">([</span><span class="n">E</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span> <span class="n">precision</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">[  1.3685725053539301120518194471  -1.3095767070865761992624519454 -0.63486715783715592064475542573]</span>
<span class="go">[ -1.3095767070865761992624519454   2.7173593928122930896610589220   1.0998184305667292139777571432]</span>
<span class="go">[-0.63486715783715592064475542573   1.0998184305667292139777571432  0.66820516565192793503314205089]</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">,</span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">point</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span><span class="n">E</span><span class="o">.</span><span class="n">point</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">height_pairing_matrix</span><span class="p">([</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">])</span>
<span class="go">[0.686667083305587 0.268478098806726]</span>
<span class="go">[0.268478098806726 0.327000773651605]</span>
</pre></div>
</div>
<p>Over a number field:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">47</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">height_pairing_matrix</span><span class="p">([</span><span class="n">EK</span><span class="p">(</span><span class="n">P</span><span class="p">),</span><span class="n">EK</span><span class="p">(</span><span class="n">Q</span><span class="p">)])</span>
<span class="go">[0.686667083305587 0.268478098806726]</span>
<span class="go">[0.268478098806726 0.327000773651605]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="o">-</span><span class="mi">9</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="o">-</span><span class="mi">18</span><span class="o">-</span><span class="mi">25</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="o">-</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">height_pairing_matrix</span><span class="p">([</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">])</span>
<span class="go">[  2.16941934493768 -0.870059380421505]</span>
<span class="go">[-0.870059380421505  0.424585837470709]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">([</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">])</span>
<span class="go">0.164101403936070</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.integral_model">
<tt class="descname">integral_model</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.integral_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a model of self which is integral at all primes.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P1</span><span class="p">,</span><span class="n">P2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_integral_model</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 + (-i)*x*y + (-25*i)*y = x^3 + 5*i*x^2 + 125*i*x + 3125*i over Number Field in i with defining polynomial x^2 + 1</span>
</pre></div>
</div>
<p><a class="reference external" href="http://trac.sagemath.org/7935">trac ticket #7935</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">38</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_integral_model</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + 1444*a*x + 27436 over Number Field in a with defining polynomial x^2 - 38</span>
</pre></div>
</div>
<p><a class="reference external" href="http://trac.sagemath.org/9266">trac ticket #9266</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">s</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="n">w</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_integral_model</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + 2*x + (1/2*s+1/2) over Number Field in s with defining polynomial x^2 - 5</span>
</pre></div>
</div>
<p><a class="reference external" href="http://trac.sagemath.org/12151">trac ticket #12151</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">161</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">150</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">25105</span><span class="o">/</span><span class="mi">216</span><span class="o">*</span><span class="n">v</span> <span class="o">-</span> <span class="mi">3839</span><span class="o">/</span><span class="mi">36</span><span class="p">,</span> <span class="mi">634768555</span><span class="o">/</span><span class="mi">7776</span><span class="o">*</span><span class="n">v</span> <span class="o">-</span> <span class="mi">98002625</span><span class="o">/</span><span class="mi">1296</span><span class="p">,</span> <span class="mi">634768555</span><span class="o">/</span><span class="mi">7776</span><span class="o">*</span><span class="n">v</span> <span class="o">-</span> <span class="mi">98002625</span><span class="o">/</span><span class="mi">1296</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_integral_model</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 + (2094779518028859*v-1940492905300351)*x*y + (477997268472544193101178234454165304071127500*v-442791377441346852919930773849502871958097500)*y = x^3 + (26519784690047674853185542622500*v-24566525306469707225840460652500)*x^2 over Number Field in v with defining polynomial x^2 + 161*x - 150</span>
</pre></div>
</div>
<p><a class="reference external" href="http://trac.sagemath.org/14476">trac ticket #14476</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">g</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span> <span class="o">-</span><span class="mi">43</span><span class="o">/</span><span class="mi">625</span><span class="o">*</span><span class="n">g</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">14</span><span class="o">/</span><span class="mi">625</span><span class="o">*</span><span class="n">g</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">/</span><span class="mi">625</span><span class="o">*</span><span class="n">g</span> <span class="o">+</span> <span class="mi">706</span><span class="o">/</span><span class="mi">625</span><span class="p">,</span> <span class="o">-</span><span class="mi">4862</span><span class="o">/</span><span class="mi">78125</span><span class="o">*</span><span class="n">g</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">4074</span><span class="o">/</span><span class="mi">78125</span><span class="o">*</span><span class="n">g</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">711</span><span class="o">/</span><span class="mi">78125</span><span class="o">*</span><span class="n">g</span> <span class="o">+</span> <span class="mi">10304</span><span class="o">/</span><span class="mi">78125</span><span class="p">,</span>  <span class="o">-</span><span class="mi">4862</span><span class="o">/</span><span class="mi">78125</span><span class="o">*</span><span class="n">g</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">4074</span><span class="o">/</span><span class="mi">78125</span><span class="o">*</span><span class="n">g</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">711</span><span class="o">/</span><span class="mi">78125</span><span class="o">*</span><span class="n">g</span> <span class="o">+</span> <span class="mi">10304</span><span class="o">/</span><span class="mi">78125</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">global_integral_model</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 + (15*g^3-48*g-42)*x*y + (-111510*g^3-162162*g^2-44145*g+37638)*y = x^3 + (-954*g^3-1134*g^2+81*g+576)*x^2 over Number Field in g with defining polynomial t^4 - t^3 - 3*t^2 - t + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.is_global_integral_model">
<tt class="descname">is_global_integral_model</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.is_global_integral_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Return true iff self is integral at all primes.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P1</span><span class="p">,</span><span class="n">P2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Emin</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">global_integral_model</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Emin</span><span class="o">.</span><span class="n">is_global_integral_model</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.is_global_minimal_model">
<tt class="descname">is_global_minimal_model</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.is_global_minimal_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns whether this elliptic curve is a global minimal model.</p>
<p>OUTPUT:</p>
<p>Boolean, False if E is not integral, or if E is non-minimal at
some prime, else True.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">22500</span><span class="p">,</span> <span class="mi">750000</span><span class="o">*</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">is_global_minimal_model</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">non_minimal_primes</span><span class="p">()</span>
<span class="go">[Fractional ideal (2, a), Fractional ideal (5, a)]</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">3024</span><span class="p">,</span><span class="mi">46224</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">is_global_minimal_model</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">non_minimal_primes</span><span class="p">()</span>
<span class="go">[2, 3]</span>
<span class="gp">sage: </span><span class="n">Emin</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">global_minimal_model</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Emin</span><span class="o">.</span><span class="n">is_global_minimal_model</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A necessary condition to be a global minimal model is that the
model must be globally integral:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">is_global_minimal_model</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Emin</span><span class="o">.</span><span class="n">is_global_minimal_model</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Emin</span><span class="o">.</span><span class="n">ainvs</span><span class="p">()</span>
<span class="go">(0, 1, 1, -2, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.is_isogenous">
<tt class="descname">is_isogenous</tt><big>(</big><em>other</em>, <em>proof=True</em>, <em>maxnorm=100</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.is_isogenous" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns whether or not self is isogenous to other.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">other</span></tt> &#8211; another elliptic curve.</li>
<li><tt class="docutils literal"><span class="pre">proof</span></tt> (default True) &#8211; If <tt class="docutils literal"><span class="pre">False</span></tt>, the function will
return <tt class="docutils literal"><span class="pre">True</span></tt> whenever the two curves have the same
conductor and are isogenous modulo <span class="math">\(p\)</span> for all primes <span class="math">\(p\)</span> of
norm up to <tt class="docutils literal"><span class="pre">maxnorm</span></tt>.  If <tt class="docutils literal"><span class="pre">True</span></tt>, the function returns
False when the previous condition does not hold, and if it
does hold we compute the complete isogeny class to see if
the curves are indeed isogenous.</li>
<li><tt class="docutils literal"><span class="pre">maxnorm</span></tt> (integer, default 100) &#8211; The maximum norm of
primes <span class="math">\(p\)</span> for which isogeny modulo <span class="math">\(p\)</span> will be checked.</li>
</ul>
<p>OUTPUT:</p>
<p>(bool) True if there is an isogeny from curve <tt class="docutils literal"><span class="pre">self</span></tt> to
curve <tt class="docutils literal"><span class="pre">other</span></tt>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="s">&#39;s&#39;</span><span class="p">);</span> <span class="n">F</span>
<span class="go">Number Field in s with defining polynomial x^2 - 2</span>
<span class="gp">sage: </span><span class="n">E1</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E3</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E1</span><span class="o">.</span><span class="n">is_isogenous</span><span class="p">(</span><span class="n">E2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">E1</span><span class="o">.</span><span class="n">is_isogenous</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E2</span><span class="o">.</span><span class="n">is_isogenous</span><span class="p">(</span><span class="n">E2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E2</span><span class="o">.</span><span class="n">is_isogenous</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">E2</span><span class="o">.</span><span class="n">is_isogenous</span><span class="p">(</span><span class="n">E3</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="s">&#39;s&#39;</span><span class="p">);</span> <span class="n">F</span>
<span class="go">Number Field in s with defining polynomial x^2 - 2</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;14a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EE</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;14a2&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E1</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">EE</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E1</span><span class="o">.</span><span class="n">is_isogenous</span><span class="p">(</span><span class="n">E2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="s">&#39;s&#39;</span><span class="p">);</span> <span class="n">F</span>
<span class="go">Number Field in s with defining polynomial x^2 - 2</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">EE</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">is_isogenous</span><span class="p">(</span><span class="n">EE</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Second argument must be defined over the same number field.</span>
</pre></div>
</div>
<p>Some examples from Cremona&#8217;s 1981 tables:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E1</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">240</span><span class="o">*</span><span class="n">i</span> <span class="o">-</span> <span class="mi">400</span><span class="p">,</span> <span class="o">-</span><span class="mi">2869</span><span class="o">*</span><span class="n">i</span> <span class="o">-</span> <span class="mi">2627</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E1</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">Fractional ideal (-4*i - 7)</span>
<span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E2</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">Fractional ideal (-4*i - 7)</span>
<span class="gp">sage: </span><span class="n">E1</span><span class="o">.</span><span class="n">is_isogenous</span><span class="p">(</span><span class="n">E2</span><span class="p">)</span> <span class="c"># slower (~500ms)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E1</span><span class="o">.</span><span class="n">is_isogenous</span><span class="p">(</span><span class="n">E2</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span> <span class="c"># faster  (~170ms)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>In this case E1 and E2 are in fact 9-isogenous, as may be
deduced from the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E3</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="n">i</span> <span class="o">-</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span> <span class="o">-</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E3</span><span class="o">.</span><span class="n">is_isogenous</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E3</span><span class="o">.</span><span class="n">is_isogenous</span><span class="p">(</span><span class="n">E2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E1</span><span class="o">.</span><span class="n">isogeny_degree</span><span class="p">(</span><span class="n">E2</span><span class="p">)</span>
<span class="go">9</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Check that <a class="reference external" href="http://trac.sagemath.org/15890">trac ticket #15890</a> is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">s</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">229</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c4</span> <span class="o">=</span> <span class="mi">2173</span> <span class="o">-</span> <span class="mi">235</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">c6</span> <span class="o">=</span> <span class="o">-</span><span class="mi">124369</span> <span class="o">+</span> <span class="mi">15988</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">c4c</span> <span class="o">=</span> <span class="mi">2173</span> <span class="o">-</span> <span class="mi">235</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">c6c</span> <span class="o">=</span> <span class="o">-</span><span class="mi">124369</span> <span class="o">+</span> <span class="mi">15988</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_c4c6</span><span class="p">(</span><span class="n">c4</span><span class="p">,</span> <span class="n">c6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Ec</span> <span class="o">=</span> <span class="n">EllipticCurve_from_c4c6</span><span class="p">(</span><span class="n">c4c</span><span class="p">,</span> <span class="n">c6c</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">is_isogenous</span><span class="p">(</span><span class="n">Ec</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Check that <a class="reference external" href="http://trac.sagemath.org/17295">trac ticket #17295</a> is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">s</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">s</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">s</span><span class="p">),</span> <span class="mi">2</span><span class="o">*</span><span class="n">s</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">14</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="mi">11</span><span class="o">*</span><span class="n">s</span><span class="o">^</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">Ec</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">s</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">5</span><span class="o">*</span><span class="n">s</span><span class="p">),</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">s</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">14</span><span class="o">*</span><span class="n">s</span> <span class="o">+</span> <span class="mi">11</span><span class="o">*</span><span class="n">s</span><span class="o">^</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EcK</span> <span class="o">=</span> <span class="n">Ec</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">is_isogenous</span><span class="p">(</span><span class="n">EcK</span><span class="p">)</span>      <span class="c"># long time (about 3.5 s)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.is_local_integral_model">
<tt class="descname">is_local_integral_model</tt><big>(</big><em>*P</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.is_local_integral_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests if self is integral at the prime ideal <span class="math">\(P\)</span>, or at all the
primes if <span class="math">\(P\)</span> is a list or tuple.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">*P</span></tt> &#8211; a prime ideal, or a list or tuple of primes.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P1</span><span class="p">,</span><span class="n">P2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">is_local_integral_model</span><span class="p">(</span><span class="n">P1</span><span class="p">,</span><span class="n">P2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Emin</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">local_integral_model</span><span class="p">(</span><span class="n">P1</span><span class="p">,</span><span class="n">P2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Emin</span><span class="o">.</span><span class="n">is_local_integral_model</span><span class="p">(</span><span class="n">P1</span><span class="p">,</span><span class="n">P2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.isogenies_prime_degree">
<tt class="descname">isogenies_prime_degree</tt><big>(</big><em>l=None</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.isogenies_prime_degree" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of <span class="math">\(\ell\)</span>-isogenies from self, where <span class="math">\(\ell\)</span> is a
prime.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">l</span></tt> &#8211; either None or a prime or a list of primes.</li>
</ul>
<p>OUTPUT:</p>
<p>(list) <span class="math">\(\ell\)</span>-isogenies for the given <span class="math">\(\ell\)</span> or if <span class="math">\(\ell\)</span> is None, all
isogenies of prime degree (see below for the CM case).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Over <span class="math">\(\QQ\)</span>, the codomains of the isogenies returned are
standard minimal models.  Over other number fields they are
global minimal models if these exist, otherwise models
which are minimal at all but one prime.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For curves with rational CM, isogenies of primes degree
exist for infinitely many primes <span class="math">\(\ell\)</span>, though there are
only finitely many isogenous curves up to isomoprhism.  The
list returned only includes one isogeny of prime degree for
each codomain.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">isogs</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogenies_prime_degree</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">phi</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span> <span class="k">for</span> <span class="n">phi</span> <span class="ow">in</span> <span class="n">isogs</span><span class="p">]</span>
<span class="go">[2, 3]</span>

<span class="gp">sage: </span><span class="n">pol</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s">&#39;x&#39;</span><span class="p">)([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">pol</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">js</span> <span class="o">=</span> <span class="n">hilbert_class_polynomial</span><span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">)</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">multiplicities</span><span class="o">=</span><span class="bp">False</span><span class="p">);</span> <span class="nb">len</span><span class="p">(</span><span class="n">js</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">js</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">isogenies_prime_degree</span><span class="p">())</span>
<span class="go">3</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">isogenies_prime_degree</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">4 is not prime.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.isogeny_class">
<tt class="descname">isogeny_class</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.isogeny_class" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the isogeny class of this elliptic curve.</p>
<p>OUTPUT:</p>
<p>An instance of the class
<a class="reference internal" href="isogeny_class.html#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC_NumberField" title="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC_NumberField"><tt class="xref py py-class docutils literal"><span class="pre">sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC_NumberField</span></tt></a>.
From this object may be obtained a list of curves in the
class, a matrix of the degrees of the isogenies between them,
and the isogenies themselves.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The curves in the isogeny class will all be minimal models
if these exist (for example, when the class number is
<span class="math">\(1\)</span>); otherwise they will be minimal at all but one prime.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">();</span> <span class="n">C</span>
<span class="go">Isogeny class of Elliptic Curve defined by y^2 = x^3 + 1 over Number Field in i with defining polynomial x^2 + 1</span>
</pre></div>
</div>
<p>The curves in the class (sorted):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="p">[</span><span class="n">E1</span><span class="o">.</span><span class="n">ainvs</span><span class="p">()</span> <span class="k">for</span> <span class="n">E1</span> <span class="ow">in</span> <span class="n">C</span><span class="p">]</span>
<span class="go">[(0, 0, 0, 0, -27),</span>
<span class="go">(0, 0, 0, 0, 1),</span>
<span class="go">(i + 1, i, i + 1, -i + 3, 4*i),</span>
<span class="go">(i + 1, i, i + 1, -i + 33, -58*i)]</span>
</pre></div>
</div>
<p>The matrix of degrees of cyclic isogenies between curves:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[1 3 6 2]</span>
<span class="go">[3 1 2 6]</span>
<span class="go">[6 2 1 3]</span>
<span class="go">[2 6 3 1]</span>
</pre></div>
</div>
<p>The array of isogenies themselves is not filled out but only
contains those used to construct the class, the other entries
containing the interger 0.  This will be changed when the
class <a class="reference internal" href="ell_curve_isogeny.html#sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny" title="sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny"><tt class="xref py py-class docutils literal"><span class="pre">EllipticCurveIsogeny</span></tt></a> allowed composition.  In
this case we used <span class="math">\(2\)</span>-isogenies to go from 0 to 2 and from 1
to 3, and <span class="math">\(3\)</span>-isogenies to go from 0 to 1 and from 2 to 3:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">isogs</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">isogenies</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[((</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="n">isogs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">degree</span><span class="p">())</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="k">if</span> <span class="n">isogs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">]</span>
<span class="go">[((0, 1), 3),</span>
<span class="go">((0, 3), 2),</span>
<span class="go">((1, 0), 3),</span>
<span class="go">((1, 2), 2),</span>
<span class="go">((2, 1), 2),</span>
<span class="go">((2, 3), 3),</span>
<span class="go">((3, 0), 2),</span>
<span class="go">((3, 2), 3)]</span>
<span class="gp">sage: </span><span class="p">[((</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="n">isogs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">x_rational_map</span><span class="p">())</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="k">if</span> <span class="n">isogs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">]</span>
<span class="go">[((0, 1), (1/9*x^3 - 12)/x^2),</span>
<span class="go"> ((0, 3), (-1/2*i*x^2 + i*x - 12*i)/(x - 3)),</span>
<span class="go"> ((1, 0), (x^3 + 4)/x^2),</span>
<span class="go"> ((1, 2), (-1/2*i*x^2 - i*x - 2*i)/(x + 1)),</span>
<span class="go"> ((2, 1), (1/2*i*x^2 - x)/(x + 3/2*i)),</span>
<span class="go"> ((2, 3), (x^3 + 4*i*x^2 - 10*x - 10*i)/(x^2 + 4*i*x - 4)),</span>
<span class="go"> ((3, 0), (1/2*i*x^2 + x + 4*i)/(x - 5/2*i)),</span>
<span class="go"> ((3, 2), (1/9*x^3 - 4/3*i*x^2 - 34/3*x + 226/9*i)/(x^2 - 8*i*x - 16))]</span>
</pre></div>
</div>
<p>The isogeny class may be visualized by obtaining its graph and
plotting it:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c"># long time</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">();</span> <span class="n">C</span>
<span class="go">Isogeny class of Elliptic Curve defined by y^2 + (i+1)*x*y + i*y = x^3 + (-i)*x^2 + x over Number Field in i with defining polynomial x^2 + 1</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[ 1  3  9 18  6  2]</span>
<span class="go">[ 3  1  3  6  2  6]</span>
<span class="go">[ 9  3  1  2  6 18]</span>
<span class="go">[18  6  2  1  3  9]</span>
<span class="go">[ 6  2  6  3  1  3]</span>
<span class="go">[ 2  6 18  9  3  1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E1</span><span class="o">.</span><span class="n">ainvs</span><span class="p">()</span> <span class="k">for</span> <span class="n">E1</span> <span class="ow">in</span> <span class="n">C</span><span class="p">]</span>
<span class="go">[(i + 1, i - 1, i, -i - 1, -i + 1),</span>
<span class="go">(i + 1, i - 1, i, 14*i + 4, 7*i + 14),</span>
<span class="go">(i + 1, i - 1, i, 59*i + 99, 372*i - 410),</span>
<span class="go">(i + 1, -i, i, -240*i - 399, 2869*i + 2627),</span>
<span class="go">(i + 1, -i, i, -5*i - 4, 2*i + 5),</span>
<span class="go">(i + 1, -i, i, 1, 0)]</span>
</pre></div>
</div>
<p>An example with CM by <span class="math">\(\sqrt{-5}\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">pol</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s">&#39;x&#39;</span><span class="p">)([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">c</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">pol</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1480640</span><span class="o">+</span><span class="mi">565760</span><span class="o">*</span><span class="n">c</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">j</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_cm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_rational_cm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cm_discriminant</span><span class="p">()</span>
<span class="go">-20</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[1 2]</span>
<span class="go">[2 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">ainvs</span><span class="p">()</span> <span class="k">for</span> <span class="n">E</span> <span class="ow">in</span> <span class="n">C</span><span class="p">]</span>
<span class="go">[(0, 0, 0, 83490*c^2 - 147015, -64739840*c^2 - 84465260),</span>
<span class="go">(0, 0, 0, -161535*c^2 + 70785, -62264180*c^3 + 6229080*c)]</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">isogenies</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="go">Isogeny of degree 2 from Elliptic Curve defined by y^2 = x^3 + (83490*c^2-147015)*x + (-64739840*c^2-84465260) over Number Field in c with defining polynomial x^4 + 3*x^2 + 1 to Elliptic Curve defined by y^2 = x^3 + (-161535*c^2+70785)*x + (-62264180*c^3+6229080*c) over Number Field in c with defining polynomial x^4 + 3*x^2 + 1</span>
</pre></div>
</div>
<p>An example with CM by <span class="math">\(\sqrt{-23}\)</span> (class number <span class="math">\(3\)</span>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">pol</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s">&#39;x&#39;</span><span class="p">)([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">pol</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">js</span> <span class="o">=</span> <span class="n">hilbert_class_polynomial</span><span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">)</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">multiplicities</span><span class="o">=</span><span class="bp">False</span><span class="p">);</span> <span class="nb">len</span><span class="p">(</span><span class="n">js</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">js</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_rational_cm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">isogenies_prime_degree</span><span class="p">())</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">();</span> <span class="nb">len</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="go">6</span>
</pre></div>
</div>
<p>The reason for the isogeny class having size six while the
class number is only <span class="math">\(3\)</span> is that the class also contains three
curves with CM by the order of discriminant <span class="math">\(-92=4\cdot(-23)\)</span>,
which also has class number <span class="math">\(3\)</span>.  The curves in the class are
sorted first by CM discriminant (then lexicographically using
a-invariants):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="p">[</span><span class="n">F</span><span class="o">.</span><span class="n">cm_discriminant</span><span class="p">()</span> <span class="k">for</span> <span class="n">F</span> <span class="ow">in</span> <span class="n">C</span><span class="p">]</span>
<span class="go">[-23, -23, -23, -92, -92, -92]</span>
</pre></div>
</div>
<p><span class="math">\(2\)</span> splits in the order with discriminant <span class="math">\(-23\)</span>, into two
primes of order <span class="math">\(3\)</span> in the class group, each of which induces
a <span class="math">\(2\)</span>-isogeny to a curve with the same endomorphism ring; the
third <span class="math">\(2\)</span>-isogeny is to a curve with the smaller endomorphism
ring:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="p">[</span><span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span><span class="o">.</span><span class="n">cm_discriminant</span><span class="p">()</span> <span class="k">for</span> <span class="n">phi</span> <span class="ow">in</span> <span class="n">E</span><span class="o">.</span><span class="n">isogenies_prime_degree</span><span class="p">()]</span>
<span class="go">[-92, -23, -23]</span>

<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[1 2 2 4 2 4]</span>
<span class="go">[2 1 2 2 4 4]</span>
<span class="go">[2 2 1 4 4 2]</span>
<span class="go">[4 2 4 1 3 3]</span>
<span class="go">[2 4 4 3 1 3]</span>
<span class="go">[4 4 2 3 3 1]</span>
</pre></div>
</div>
<p>The graph of this isogeny class has a shape which does not
occur over <span class="math">\(\QQ\)</span>: a triangular prism.  Note that for curves
without CM, the graph has an edge between two curves if and
only if they are connected by an isogeny of prime degree, and
this degree is uniquely determined by the two curves, but in
the CM case this property does not hold, since for pairs of
curves in the class with the same endomorphism ring <span class="math">\(O\)</span>, the
set of degrees of isogenies between them is the set of
integers represented by a primitive integral binary quadratic
form of discriminant <span class="math">\(\text{disc}(O)\)</span>, and this form
represents infinitely many primes.  In the matrix we give a
small prime represented by the appropriate form.  In this
example, the matrix is formed by four <span class="math">\(3\times3\)</span> blocks.  The
isogenies of degree <span class="math">\(2\)</span> indicated by the upper left <span class="math">\(3\times3\)</span>
block of the matrix could be replaced by isogenies of any
degree represented by the quadratic form <span class="math">\(2x^2+xy+3y^2\)</span> of
discriminant <span class="math">\(-23\)</span>.  Similarly in the lower right block, the
entries of <span class="math">\(3\)</span> could be represented by any integers
represented by the quadratic form <span class="math">\(3x^2+2xy+8y^2\)</span> of
discriminant <span class="math">\(-92\)</span>.  In the top right block and lower left
blocks, by contrast, the prime entries <span class="math">\(2\)</span> are unique
determined:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">()</span>
<span class="go">[0 1 1 0 1 0]</span>
<span class="go">[1 0 1 1 0 0]</span>
<span class="go">[1 1 0 0 0 1]</span>
<span class="go">[0 1 0 0 1 1]</span>
<span class="go">[1 0 0 1 0 1]</span>
<span class="go">[0 0 1 1 1 0]</span>
</pre></div>
</div>
<p>To display the graph without any edge labels:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">G</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c"># long time</span>
</pre></div>
</div>
<p>To display the graph with edge labels: by default, for curves
with rational CM, the labels are the coefficients of the
associated quadratic forms:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">G</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c"># long time</span>
</pre></div>
</div>
<p>For an alternative view, first relabel the edges using only 2
labels to distinguish between isogenies between curves with
the same endomorphism ring and isogenies between curves with
different endomorphism rings, then use a 3-dimensional plot
which can be rotated:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">l</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">edge_iterator</span><span class="p">():</span>  <span class="n">G</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">l</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">show3d</span><span class="p">(</span><span class="n">color_by_label</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>A class number <span class="math">\(6\)</span> example.  First we set up the fields: <tt class="docutils literal"><span class="pre">pol</span></tt>
defines the same field as <tt class="docutils literal"><span class="pre">pol26</span></tt> but is simpler:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">pol26</span> <span class="o">=</span> <span class="n">hilbert_class_polynomial</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="mi">26</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pol</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">pol</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">26</span><span class="p">)</span>
</pre></div>
</div>
<p>Only <span class="math">\(2\)</span> of the <span class="math">\(j\)</span>-invariants with discriminant -104 are in
<span class="math">\(K\)</span>, though all are in <span class="math">\(L\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">pol26</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">K</span><span class="p">))</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">pol26</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">L</span><span class="p">))</span>
<span class="go">6</span>
</pre></div>
</div>
<p>We create an elliptic curve defined over <span class="math">\(K\)</span> with one of the
<span class="math">\(j\)</span>-invariants in <span class="math">\(K\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">j1</span> <span class="o">=</span> <span class="n">pol26</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">K</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">j1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_cm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_rational_cm</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_rational_cm</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Over <span class="math">\(K\)</span> the isogeny class has size <span class="math">\(4\)</span>, with <span class="math">\(2\)</span> curves for
each of the <span class="math">\(2\)</span> <span class="math">\(K\)</span>-rational <span class="math">\(j\)</span>-invariants:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">();</span> <span class="nb">len</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="c"># long time (~11s)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>                    <span class="c"># long time</span>
<span class="go">[ 1 13  2 26]</span>
<span class="go">[13  1 26  2]</span>
<span class="go">[ 2 26  1 13]</span>
<span class="go">[26  2 13  1]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">Set</span><span class="p">([</span><span class="n">EE</span><span class="o">.</span><span class="n">j_invariant</span><span class="p">()</span> <span class="k">for</span> <span class="n">EE</span> <span class="ow">in</span> <span class="n">C</span><span class="o">.</span><span class="n">curves</span><span class="p">]))</span>  <span class="c"># long time</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Over <span class="math">\(L\)</span>, the isogeny class grows to size <span class="math">\(6\)</span> (the class
number):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">EL</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">CL</span> <span class="o">=</span> <span class="n">EL</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">();</span> <span class="nb">len</span><span class="p">(</span><span class="n">CL</span><span class="p">)</span> <span class="c"># long time (~21s)</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">Set</span><span class="p">([</span><span class="n">EE</span><span class="o">.</span><span class="n">j_invariant</span><span class="p">()</span> <span class="k">for</span> <span class="n">EE</span> <span class="ow">in</span> <span class="n">CL</span><span class="o">.</span><span class="n">curves</span><span class="p">])</span> <span class="o">==</span> <span class="n">Set</span><span class="p">(</span><span class="n">pol26</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">multiplicities</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span> <span class="c"># long time</span>
<span class="go">True</span>
</pre></div>
</div>
<p>In each position in the matrix of degrees, we see primes (or
<span class="math">\(1\)</span>).  In fact the set of degrees of cyclic isogenies from
curve <span class="math">\(i\)</span> to curve <span class="math">\(j\)</span> is infinite, and is the set of all
integers represented by one of the primitive binary quadratic
forms of discriminant <span class="math">\(-104\)</span>, from which we have selected a
small prime:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">CL</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span> <span class="c"># long time</span>
<span class="go">[1 2 3 3 5 5]</span>
<span class="go">[2 1 5 5 3 3]</span>
<span class="go">[3 5 1 3 2 5]</span>
<span class="go">[3 5 3 1 5 2]</span>
<span class="go">[5 3 2 5 1 3]</span>
<span class="go">[5 3 5 2 3 1]</span>
</pre></div>
</div>
<p>To see the array of binary quadratic forms:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">CL</span><span class="o">.</span><span class="n">qf_matrix</span><span class="p">()</span>  <span class="c"># long time</span>
<span class="go">[[[1], [2, 0, 13], [3, -2, 9], [3, -2, 9], [5, -4, 6], [5, -4, 6]],</span>
<span class="go"> [[2, 0, 13], [1], [5, -4, 6], [5, -4, 6], [3, -2, 9], [3, -2, 9]],</span>
<span class="go"> [[3, -2, 9], [5, -4, 6], [1], [3, -2, 9], [2, 0, 13], [5, -4, 6]],</span>
<span class="go"> [[3, -2, 9], [5, -4, 6], [3, -2, 9], [1], [5, -4, 6], [2, 0, 13]],</span>
<span class="go"> [[5, -4, 6], [3, -2, 9], [2, 0, 13], [5, -4, 6], [1], [3, -2, 9]],</span>
<span class="go"> [[5, -4, 6], [3, -2, 9], [5, -4, 6], [2, 0, 13], [3, -2, 9], [1]]]</span>
</pre></div>
</div>
<p>As in the non-CM case, the isogeny class may be visualized by
obtaining its graph and plotting it.  Since there are more
edges than in the non-CM case, it may be preferable to omit
the edge_labels:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span> <span class="c"># long time</span>
</pre></div>
</div>
<p>It is possible to display a 3-dimensional plot, with colours
to represent the different edge labels, in a form which can be
rotated!:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">show3d</span><span class="p">(</span><span class="n">color_by_label</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c"># long time</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.isogeny_degree">
<tt class="descname">isogeny_degree</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.isogeny_degree" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the minimal degree of an isogeny between self and
other, or 0 if no isogeny exists.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">other</span></tt> &#8211; another elliptic curve.</li>
</ul>
<p>OUTPUT:</p>
<p>(int) The degree of an isogeny from <tt class="docutils literal"><span class="pre">self</span></tt> to <tt class="docutils literal"><span class="pre">other</span></tt>, or 0.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="s">&#39;s&#39;</span><span class="p">);</span> <span class="n">F</span>
<span class="go">Number Field in s with defining polynomial x^2 - 2</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;14a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EE</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;14a2&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E1</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">EE</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E1</span><span class="o">.</span><span class="n">isogeny_degree</span><span class="p">(</span><span class="n">E2</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">E2</span><span class="o">.</span><span class="n">isogeny_degree</span><span class="p">(</span><span class="n">E2</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">E5</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;14a5&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E1</span><span class="o">.</span><span class="n">isogeny_degree</span><span class="p">(</span><span class="n">E5</span><span class="p">)</span>
<span class="go">6</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E2</span><span class="o">.</span><span class="n">label</span><span class="p">()</span> <span class="k">for</span> <span class="n">E2</span> <span class="ow">in</span> <span class="n">cremona_curves</span><span class="p">([</span><span class="mf">11.</span><span class="o">.</span><span class="mi">20</span><span class="p">])</span> <span class="k">if</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny_degree</span><span class="p">(</span><span class="n">E2</span><span class="p">)]</span>
<span class="go">[&#39;11a1&#39;, &#39;11a2&#39;, &#39;11a3&#39;]</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">isogeny_degree</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="k">for</span> <span class="n">F</span> <span class="ow">in</span> <span class="n">C</span><span class="p">]</span>
<span class="go">[2, 6, 18, 9, 3, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.kodaira_symbol">
<tt class="descname">kodaira_symbol</tt><big>(</big><em>P</em>, <em>proof=None</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.kodaira_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Kodaira Symbol of this elliptic curve at the prime <span class="math">\(P\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">P</span></tt> &#8211; either None or a prime ideal of the base field of self.</li>
<li><tt class="docutils literal"><span class="pre">proof</span></tt> &#8211; whether to only use provably correct methods
(default controlled by global proof module).  Note that the
proof module is number_field, not elliptic_curves, since the
functions that actually need the flag are in number fields.</li>
</ul>
<p>OUTPUT:</p>
<p>The Kodaira Symbol of the curve at P, represented as a string.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">625</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">6875</span><span class="p">,</span> <span class="mi">31250</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">46875</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">bad_primes</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">support</span><span class="p">();</span> <span class="n">bad_primes</span>
<span class="go">[Fractional ideal (-a), Fractional ideal (7/2*a - 81/2), Fractional ideal (-a - 52), Fractional ideal (2)]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">kodaira_symbol</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="k">for</span> <span class="n">P</span> <span class="ow">in</span> <span class="n">bad_primes</span><span class="p">]</span>
<span class="go">[I0, I1, I1, II]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;11a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">kodaira_symbol</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="k">for</span> <span class="n">P</span> <span class="ow">in</span> <span class="n">K</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">support</span><span class="p">()]</span>
<span class="go">[I10]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.lll_reduce">
<tt class="descname">lll_reduce</tt><big>(</big><em>points</em>, <em>height_matrix=None</em>, <em>precision=None</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.lll_reduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an LLL-reduced basis from a given basis, with transform
matrix.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">points</span></tt> - a list of points on this elliptic
curve, which should be independent.</li>
<li><tt class="docutils literal"><span class="pre">height_matrix</span></tt> - the height-pairing matrix of
the points, or <tt class="docutils literal"><span class="pre">None</span></tt>. If <tt class="docutils literal"><span class="pre">None</span></tt>, it will be computed.</li>
<li><tt class="docutils literal"><span class="pre">precision</span></tt> - number of bits of precision of intermediate
computations (default: <tt class="docutils literal"><span class="pre">None</span></tt>, for default RealField
precision; ignored if <tt class="docutils literal"><span class="pre">height_matrix</span></tt> is supplied)</li>
</ul>
<p>OUTPUT: A tuple (newpoints, U) where U is a unimodular integer
matrix, new_points is the transform of points by U, such that
new_points has LLL-reduced height pairing matrix</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the input points are not independent, the output
depends on the undocumented behaviour of PARI&#8217;s
<tt class="docutils literal"><span class="pre">qflllgram()</span></tt> function when applied to a gram matrix which
is not positive definite.</p>
</div>
<p>EXAMPLES:</p>
<p>Some examples over <span class="math">\(\QQ\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">42</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Pi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">();</span> <span class="n">Pi</span>
<span class="go">[(-4 : 1 : 1), (-3 : 5 : 1), (-11/4 : 43/8 : 1), (-2 : 6 : 1)]</span>
<span class="gp">sage: </span><span class="n">Qi</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">lll_reduce</span><span class="p">(</span><span class="n">Pi</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">Pi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="o">==</span> <span class="n">Qi</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">Qi</span><span class="p">)</span>
<span class="go">[(-4 : 1 : 1), (-3 : 5 : 1), (-2 : 6 : 1), (0 : 6 : 1)]</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">(</span><span class="n">Pi</span><span class="p">)</span>
<span class="go">4.59088036960573</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">(</span><span class="n">Qi</span><span class="p">)</span>
<span class="go">4.59088036960574</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">120039822036992245303534619191166796374</span><span class="p">,</span><span class="mi">504224992484910670010801799168082726759443756222911415116</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">xi</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2005024558054813068</span><span class="p">,</span>            <span class="o">-</span><span class="mi">4690836759490453344</span><span class="p">,</span>            <span class="mi">4700156326649806635</span><span class="p">,</span>            <span class="mi">6785546256295273860</span><span class="p">,</span>            <span class="mi">6823803569166584943</span><span class="p">,</span>            <span class="mi">7788809602110240789</span><span class="p">,</span>            <span class="mi">27385442304350994620556</span><span class="p">,</span>            <span class="mi">54284682060285253719</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span>            <span class="o">-</span><span class="mi">94200235260395075139</span><span class="o">/</span><span class="mi">25</span><span class="p">,</span>            <span class="o">-</span><span class="mi">3463661055331841724647</span><span class="o">/</span><span class="mi">576</span><span class="p">,</span>            <span class="o">-</span><span class="mi">6684065934033506970637</span><span class="o">/</span><span class="mi">676</span><span class="p">,</span>            <span class="o">-</span><span class="mi">956077386192640344198</span><span class="o">/</span><span class="mi">2209</span><span class="p">,</span>            <span class="o">-</span><span class="mi">27067471797013364392578</span><span class="o">/</span><span class="mi">2809</span><span class="p">,</span>            <span class="o">-</span><span class="mi">25538866857137199063309</span><span class="o">/</span><span class="mi">3721</span><span class="p">,</span>            <span class="o">-</span><span class="mi">1026325011760259051894331</span><span class="o">/</span><span class="mi">108241</span><span class="p">,</span>            <span class="mi">9351361230729481250627334</span><span class="o">/</span><span class="mi">1366561</span><span class="p">,</span>            <span class="mi">10100878635879432897339615</span><span class="o">/</span><span class="mi">1423249</span><span class="p">,</span>            <span class="mi">11499655868211022625340735</span><span class="o">/</span><span class="mi">17522596</span><span class="p">,</span>            <span class="mi">110352253665081002517811734</span><span class="o">/</span><span class="mi">21353641</span><span class="p">,</span>            <span class="mi">414280096426033094143668538257</span><span class="o">/</span><span class="mi">285204544</span><span class="p">,</span>            <span class="mi">36101712290699828042930087436</span><span class="o">/</span><span class="mi">4098432361</span><span class="p">,</span>            <span class="mi">45442463408503524215460183165</span><span class="o">/</span><span class="mi">5424617104</span><span class="p">,</span>            <span class="mi">983886013344700707678587482584</span><span class="o">/</span><span class="mi">141566320009</span><span class="p">,</span>            <span class="mi">1124614335716851053281176544216033</span><span class="o">/</span><span class="mi">152487126016</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xi</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">newpoints</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">lll_reduce</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>  <span class="c"># long time (35s on sage.math, 2011)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">P</span> <span class="ow">in</span> <span class="n">newpoints</span><span class="p">]</span>            <span class="c"># long time</span>
<span class="go">[6823803569166584943, 5949539878899294213, 2005024558054813068, 5864879778877955778, 23955263915878682727/4, 5922188321411938518, 5286988283823825378, 175620639884534615751/25, -11451575907286171572, 3502708072571012181, 1500143935183238709184/225, 27180522378120223419/4, -5811874164190604461581/625, 26807786527159569093, 7404442636649562303, 475656155255883588, 265757454726766017891/49, 7272142121019825303, 50628679173833693415/4, 6951643522366348968, 6842515151518070703, 111593750389650846885/16, 2607467890531740394315/9, -1829928525835506297]</span>
</pre></div>
</div>
<p>An example to show the explicit use of the height pairing matrix:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">42</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Pi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_pairing_matrix</span><span class="p">(</span><span class="n">Pi</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">lll_reduce</span><span class="p">(</span><span class="n">Pi</span><span class="p">,</span><span class="n">height_matrix</span><span class="o">=</span><span class="n">H</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">                                                          [1 0 0 1]</span>
<span class="go">                                                          [0 1 0 1]</span>
<span class="go">                                                          [0 0 0 1]</span>
<span class="go">[(-4 : 1 : 1), (-3 : 5 : 1), (-2 : 6 : 1), (1 : -7 : 1)], [0 0 1 1]</span>
<span class="go">)</span>
</pre></div>
</div>
<p>Some examples over number fields (see <a class="reference external" href="http://trac.sagemath.org/9411">trac ticket #9411</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="s">&#39;37&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">lll_reduce</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">())</span>
<span class="go">(</span>
<span class="go">                                        [ 1 -1]</span>
<span class="go">[(0 : 0 : 1), (-2 : -1/2*a - 1/2 : 1)], [ 0  1]</span>
<span class="go">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">point</span><span class="p">([</span><span class="o">-</span><span class="mi">211</span><span class="o">/</span><span class="mi">841</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">6044</span><span class="o">/</span><span class="mi">841</span><span class="p">,</span><span class="o">-</span><span class="mi">209584</span><span class="o">/</span><span class="mi">24389</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">53634</span><span class="o">/</span><span class="mi">24389</span><span class="p">]),</span><span class="n">E</span><span class="o">.</span><span class="n">point</span><span class="p">([</span><span class="o">-</span><span class="mi">17</span><span class="o">/</span><span class="mi">18</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">109</span><span class="o">/</span><span class="mi">108</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">277</span><span class="o">/</span><span class="mi">108</span><span class="p">])</span> <span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">lll_reduce</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">[(-a + 4 : -3*a + 7 : 1), (-17/18*a - 1/9 : 109/108*a + 277/108 : 1)],</span>
<span class="go">[ 1  0]</span>
<span class="go">[ 1 -1]</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.local_data">
<tt class="descname">local_data</tt><big>(</big><em>P=None</em>, <em>proof=None</em>, <em>algorithm='pari'</em>, <em>globally=False</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.local_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Local data for this elliptic curve at the prime <span class="math">\(P\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">P</span></tt> &#8211; either None or a prime ideal of the base field of self.</li>
<li><tt class="docutils literal"><span class="pre">proof</span></tt> &#8211; whether to only use provably correct methods
(default controlled by global proof module).  Note that the
proof module is number_field, not elliptic_curves, since the
functions that actually need the flag are in number fields.</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> (string, default: &#8220;pari&#8221;) &#8211; Ignored unless the
base field is <span class="math">\(\QQ\)</span>.  If &#8220;pari&#8221;, use the PARI C-library
<tt class="docutils literal"><span class="pre">ellglobalred</span></tt> implementation of Tate&#8217;s algorithm over
<span class="math">\(\QQ\)</span>. If &#8220;generic&#8221;, use the general number field
implementation.</li>
<li><tt class="docutils literal"><span class="pre">globally</span></tt> &#8211; whether the local algorithm uses global generators
for the prime ideals. Default is False, which won&#8217;t require any
information about the class group. If True, a generator for <span class="math">\(P\)</span>
will be used if <span class="math">\(P\)</span> is principal. Otherwise, or if <tt class="docutils literal"><span class="pre">globally</span></tt>
is False, the minimal model returned will preserve integrality
at other primes, but not minimality.</li>
</ul>
<p>OUTPUT:</p>
<p>If <span class="math">\(P\)</span> is specified, returns the <tt class="docutils literal"><span class="pre">EllipticCurveLocalData</span></tt>
object associated to the prime <span class="math">\(P\)</span> for this curve.  Otherwise,
returns a list of such objects, one for each prime <span class="math">\(P\)</span> in the
support of the discriminant of this model.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The model is not required to be integral on input.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">local_data</span><span class="p">()</span>
<span class="go">[Local data at Fractional ideal (2*i + 1):</span>
<span class="go">Reduction type: bad non-split multiplicative</span>
<span class="go">Local minimal model: Elliptic Curve defined by y^2 + (i+1)*x*y + y = x^3 over Number Field in i with defining polynomial x^2 + 1</span>
<span class="go">Minimal discriminant valuation: 1</span>
<span class="go">Conductor exponent: 1</span>
<span class="go">Kodaira Symbol: I1</span>
<span class="go">Tamagawa Number: 1,</span>
<span class="go">Local data at Fractional ideal (-3*i - 2):</span>
<span class="go">Reduction type: bad split multiplicative</span>
<span class="go">Local minimal model: Elliptic Curve defined by y^2 + (i+1)*x*y + y = x^3 over Number Field in i with defining polynomial x^2 + 1</span>
<span class="go">Minimal discriminant valuation: 2</span>
<span class="go">Conductor exponent: 1</span>
<span class="go">Kodaira Symbol: I2</span>
<span class="go">Tamagawa Number: 2]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">local_data</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">Local data at Fractional ideal (3):</span>
<span class="go">Reduction type: good</span>
<span class="go">Local minimal model: Elliptic Curve defined by y^2 + (i+1)*x*y + y = x^3 over Number Field in i with defining polynomial x^2 + 1</span>
<span class="go">Minimal discriminant valuation: 0</span>
<span class="go">Conductor exponent: 0</span>
<span class="go">Kodaira Symbol: I0</span>
<span class="go">Tamagawa Number: 1</span>
</pre></div>
</div>
<p>An example raised in <a class="reference external" href="http://trac.sagemath.org/3897">trac ticket #3897</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">local_data</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Local data at Principal ideal (3) of Integer Ring:</span>
<span class="go">Reduction type: good</span>
<span class="go">Local minimal model: Elliptic Curve defined by y^2 = x^3 + x + 1 over Rational Field</span>
<span class="go">Minimal discriminant valuation: 0</span>
<span class="go">Conductor exponent: 0</span>
<span class="go">Kodaira Symbol: I0</span>
<span class="go">Tamagawa Number: 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.local_integral_model">
<tt class="descname">local_integral_model</tt><big>(</big><em>*P</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.local_integral_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a model of self which is integral at the prime ideal
<span class="math">\(P\)</span>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The integrality at other primes is not affected, even if
<span class="math">\(P\)</span> is non-principal.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">*P</span></tt> &#8211; a prime ideal, or a list or tuple of primes.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P1</span><span class="p">,</span><span class="n">P2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">local_integral_model</span><span class="p">((</span><span class="n">P1</span><span class="p">,</span><span class="n">P2</span><span class="p">))</span>
<span class="go">Elliptic Curve defined by y^2 + (-i)*x*y + (-25*i)*y = x^3 + 5*i*x^2 + 125*i*x + 3125*i over Number Field in i with defining polynomial x^2 + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.local_minimal_model">
<tt class="descname">local_minimal_model</tt><big>(</big><em>P</em>, <em>proof=None</em>, <em>algorithm='pari'</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.local_minimal_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a model which is integral at all primes and minimal at <span class="math">\(P\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">P</span></tt> &#8211; either None or a prime ideal of the base field of self.</li>
<li><tt class="docutils literal"><span class="pre">proof</span></tt> &#8211; whether to only use provably correct methods
(default controlled by global proof module).  Note that the
proof module is number_field, not elliptic_curves, since the
functions that actually need the flag are in number fields.</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> (string, default: &#8220;pari&#8221;) &#8211; Ignored unless the
base field is <span class="math">\(\QQ\)</span>.  If &#8220;pari&#8221;, use the PARI C-library
<tt class="docutils literal"><span class="pre">ellglobalred</span></tt> implementation of Tate&#8217;s algorithm over
<span class="math">\(\QQ\)</span>. If &#8220;generic&#8221;, use the general number field
implementation.</li>
</ul>
<p>OUTPUT:</p>
<p>A model of the curve which is minimal (and integral) at <span class="math">\(P\)</span>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The model is not required to be integral on input.</p>
<p class="last">For principal <span class="math">\(P\)</span>, a generator is used as a uniformizer,
and integrality or minimality at other primes is not
affected.  For non-principal <span class="math">\(P\)</span>, the minimal model
returned will preserve integrality at other primes, but not
minimality.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">1250</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">6250</span><span class="p">,</span> <span class="mi">62500</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">15625</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">local_minimal_model</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">ainvs</span><span class="p">()</span>
<span class="go">(0, 1, 0, 2*a - 34, -4*a + 66)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.minimal_discriminant_ideal">
<tt class="descname">minimal_discriminant_ideal</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.minimal_discriminant_ideal" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the minimal discriminant ideal of this elliptic curve.</p>
<p>OUTPUT:</p>
<p>The integral ideal <span class="math">\(D\)</span> whose valuation at every prime <span class="math">\(P\)</span> is
that of the local minimal model for <span class="math">\(E\)</span> at <span class="math">\(P\)</span>.  If <span class="math">\(E\)</span> has a
global minimal model, this will be the principal ideal
generated by the discriminant of any such model, bt otherwise
it can be a proper divisor of the discrimanant of any model.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">-</span><span class="mi">57</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">class_number</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="o">-</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="o">-</span><span class="mi">5692</span><span class="o">-</span><span class="mi">820</span><span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="o">-</span><span class="mi">259213</span><span class="o">-</span><span class="mi">36720</span><span class="o">*</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">())</span>
<span class="go">Fractional ideal (90118662980*a + 636812084644)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">())</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(Fractional ideal (2))^2 * (Fractional ideal (3, a + 2))^12</span>
</pre></div>
</div>
<p>Here the minimal discriminant ideal is principal but there is
no global minimal model since the quotient is the 12th power
of a non-principal ideal:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">minimal_discriminant_ideal</span><span class="p">()</span>
<span class="go">Fractional ideal (4)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">minimal_discriminant_ideal</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(Fractional ideal (2))^2</span>
</pre></div>
</div>
<p>If (and only if) the curve has everywhere good reduction the
result is the unit ideal:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">26</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">Fractional ideal (1)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">-104030*a - 530451</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">minimal_discriminant_ideal</span><span class="p">()</span>
<span class="go">Fractional ideal (1)</span>
</pre></div>
</div>
<p>Over <span class="math">\(\QQ\)</span>, the result returned is an ideal of <span class="math">\(\ZZ\)</span> rather
than a fractional ideal of <span class="math">\(\QQ\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">minimal_discriminant_ideal</span><span class="p">()</span>
<span class="go">Principal ideal (10351) of Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.non_minimal_primes">
<tt class="descname">non_minimal_primes</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.non_minimal_primes" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of primes at which this elliptic curve is not minimal.</p>
<p>OUTPUT:</p>
<p>A list of prime ideals (or prime numbers when the base field
is <span class="math">\(\QQ\)</span>, empty if this is a global minimal model.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">22500</span><span class="p">,</span> <span class="mi">750000</span><span class="o">*</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">non_minimal_primes</span><span class="p">()</span>
<span class="go">[Fractional ideal (2, a), Fractional ideal (5, a)]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">())</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(Fractional ideal (2, a))^24 * (Fractional ideal (3, a + 1))^5 * (Fractional ideal (3, a + 2))^5 * (Fractional ideal (5, a))^24 * (Fractional ideal (7))</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">minimal_discriminant_ideal</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(Fractional ideal (2, a))^12 * (Fractional ideal (3, a + 1))^5 * (Fractional ideal (3, a + 2))^5 * (Fractional ideal (7))</span>
</pre></div>
</div>
<p>Over <span class="math">\(\QQ\)</span>, the primes returned are integers, not ideals:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">3024</span><span class="p">,</span><span class="mi">46224</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">non_minimal_primes</span><span class="p">()</span>
<span class="go">[2, 3]</span>
<span class="gp">sage: </span><span class="n">Emin</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">global_minimal_model</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Emin</span><span class="o">.</span><span class="n">non_minimal_primes</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>If the model is not globally integral, a <tt class="docutils literal"><span class="pre">ValueError</span></tt> is
raised:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">non_minimal_primes</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">non_minimal_primes only defined for integral models</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.period_lattice">
<tt class="descname">period_lattice</tt><big>(</big><em>embedding</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.period_lattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the period lattice of the elliptic curve for the given
embedding of its base field with respect to the differential
<span class="math">\(dx/(2y + a_1x + a_3)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">embedding</span></tt> - an embedding of the base number field into <span class="math">\(\RR\)</span> or <span class="math">\(\CC\)</span>.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The precision of the embedding is ignored: we only use the
given embedding to determine which embedding into <tt class="docutils literal"><span class="pre">QQbar</span></tt>
to use.  Once the lattice has been initialized, periods can
be computed to arbitrary precision.</p>
</div>
<p>EXAMPLES:</p>
<p>First define a field with two real embeddings:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">embs</span><span class="o">=</span><span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">CC</span><span class="p">);</span> <span class="nb">len</span><span class="p">(</span><span class="n">embs</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>For each embedding we have a different period lattice:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">embs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">Period lattice associated to Elliptic Curve defined by y^2 = x^3 + a*x + 2 over Number Field in a with defining polynomial x^3 - 2 with respect to the embedding Ring morphism:</span>
<span class="go">From: Number Field in a with defining polynomial x^3 - 2</span>
<span class="go">To:   Algebraic Field</span>
<span class="go">Defn: a |--&gt; -0.6299605249474365? - 1.091123635971722?*I</span>

<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">embs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">Period lattice associated to Elliptic Curve defined by y^2 = x^3 + a*x + 2 over Number Field in a with defining polynomial x^3 - 2 with respect to the embedding Ring morphism:</span>
<span class="go">From: Number Field in a with defining polynomial x^3 - 2</span>
<span class="go">To:   Algebraic Field</span>
<span class="go">Defn: a |--&gt; -0.6299605249474365? + 1.091123635971722?*I</span>

<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">embs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">Period lattice associated to Elliptic Curve defined by y^2 = x^3 + a*x + 2 over Number Field in a with defining polynomial x^3 - 2 with respect to the embedding Ring morphism:</span>
<span class="go">From: Number Field in a with defining polynomial x^3 - 2</span>
<span class="go">To:   Algebraic Field</span>
<span class="go">Defn: a |--&gt; 1.259921049894873?</span>
</pre></div>
</div>
<p>Although the original embeddings have only the default
precision, we can obtain the basis with higher precision
later:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">L</span><span class="o">=</span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">embs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1.86405007647981 - 0.903761485143226*I, -0.149344633143919 - 2.06619546272945*I)</span>

<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">(1.8640500764798108425920506200 - 0.90376148514322594749786960975*I, -0.14934463314391922099120107422 - 2.0661954627294548995621225062*I)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.rank">
<tt class="descname">rank</tt><big>(</big><em>**kwds</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.rank" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the rank of this elliptic curve, if it can be determined.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The optional parameters control the Simon two descent algorithm;
see the documentation of <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.simon_two_descent" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.simon_two_descent"><tt class="xref py py-meth docutils literal"><span class="pre">simon_two_descent()</span></tt></a> for more
details.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">verbose</span></tt> &#8211; 0, 1, 2, or 3 (default: 0), the verbosity level</li>
<li><tt class="docutils literal"><span class="pre">lim1</span></tt>    &#8211; (default: 2) limit on trivial points on quartics</li>
<li><tt class="docutils literal"><span class="pre">lim3</span></tt>  &#8211; (default: 4) limit on points on ELS quartics</li>
<li><tt class="docutils literal"><span class="pre">limtriv</span></tt> &#8211; (default: 2) limit on trivial points on elliptic curve</li>
<li><tt class="docutils literal"><span class="pre">maxprob</span></tt> &#8211; (default: 20)</li>
<li><tt class="docutils literal"><span class="pre">limbigprime</span></tt> &#8211; (default: 30) to distinguish between
small and large prime numbers. Use probabilistic tests for
large primes. If 0, don&#8217;t use probabilistic tests.</li>
<li><tt class="docutils literal"><span class="pre">known_points</span></tt> &#8211; (default: None) list of known points on
the curve</li>
</ul>
<p>OUTPUT:</p>
<p>If the upper and lower bounds given by Simon two-descent are
the same, then the rank has been uniquely identified and we
return this. Otherwise, we raise a ValueError with an error
message specifying the upper and lower bounds.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For non-quadratic number fields, this code does return, but it takes
a long time.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">23</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="s">&#39;37&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">==</span> <span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">E</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Here is a curve with two-torsion in the Tate-Shafarevich group,
so here the bounds given by the algorithm do not uniquely
determine the rank:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&quot;15a5&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">lim1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">lim3</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">limtriv</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">There is insufficient data to determine the rank -</span>
<span class="go">2-descent gave lower bound 0 and upper bound 2</span>
</pre></div>
</div>
<p>IMPLEMENTATION:</p>
<p>Uses Denis Simon&#8217;s PARI/GP scripts from
<a class="reference external" href="http://www.math.unicaen.fr/~simon/">http://www.math.unicaen.fr/~simon/</a>.</p>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.rank_bounds">
<tt class="descname">rank_bounds</tt><big>(</big><em>**kwds</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.rank_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the lower and upper bounds using <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.simon_two_descent" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.simon_two_descent"><tt class="xref py py-meth docutils literal"><span class="pre">simon_two_descent()</span></tt></a>.
The results of <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.simon_two_descent" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.simon_two_descent"><tt class="xref py py-meth docutils literal"><span class="pre">simon_two_descent()</span></tt></a> are cached.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The optional parameters control the Simon two descent algorithm;
see the documentation of <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.simon_two_descent" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.simon_two_descent"><tt class="xref py py-meth docutils literal"><span class="pre">simon_two_descent()</span></tt></a> for more
details.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">verbose</span></tt> &#8211; 0, 1, 2, or 3 (default: 0), the verbosity level</li>
<li><tt class="docutils literal"><span class="pre">lim1</span></tt>    &#8211; (default: 2) limit on trivial points on quartics</li>
<li><tt class="docutils literal"><span class="pre">lim3</span></tt>  &#8211; (default: 4) limit on points on ELS quartics</li>
<li><tt class="docutils literal"><span class="pre">limtriv</span></tt> &#8211; (default: 2) limit on trivial points on elliptic curve</li>
<li><tt class="docutils literal"><span class="pre">maxprob</span></tt> &#8211; (default: 20)</li>
<li><tt class="docutils literal"><span class="pre">limbigprime</span></tt> &#8211; (default: 30) to distinguish between
small and large prime numbers. Use probabilistic tests for
large primes. If 0, don&#8217;t use probabilistic tests.</li>
<li><tt class="docutils literal"><span class="pre">known_points</span></tt> &#8211; (default: None) list of known points on
the curve</li>
</ul>
<p>OUTPUT:</p>
<p>lower and upper bounds for the rank of the Mordell-Weil group</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For non-quadratic number fields, this code does
return, but it takes a long time.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">23</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="s">&#39;37&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">==</span> <span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">E</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">rank_bounds</span><span class="p">()</span>
<span class="go">(2, 2)</span>
</pre></div>
</div>
<p>Here is a curve with two-torsion, again the bounds coincide:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Qrt5</span><span class="o">.&lt;</span><span class="n">rt5</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="o">-</span><span class="n">rt5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">rt5</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">rank_bounds</span><span class="p">()</span>
<span class="go">(1, 1)</span>
</pre></div>
</div>
<p>Finally an example with non-trivial 2-torsion in Sha. So the
2-descent will not be able to determine the rank, but can only
give bounds:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&quot;15a5&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">rank_bounds</span><span class="p">(</span><span class="n">lim1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">lim3</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">limtriv</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(0, 2)</span>
</pre></div>
</div>
<p>IMPLEMENTATION:</p>
<p>Uses Denis Simon&#8217;s PARI/GP scripts from
<a class="reference external" href="http://www.math.unicaen.fr/~simon/">http://www.math.unicaen.fr/~simon/</a>.</p>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.reduction">
<tt class="descname">reduction</tt><big>(</big><em>place</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.reduction" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the reduction of the elliptic curve at a place of good reduction.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">place</span></tt> &#8211; a prime ideal in the base field of the curve</li>
</ul>
<p>OUTPUT:</p>
<p>An elliptic curve over a finite field, the residue field of the place.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">fractional_ideal</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">reduction</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by y^2  = x^3 + 5*x + 8 over Residue field of Fractional ideal (2*i + 3)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">reduction</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The curve must have good reduction at the place.</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">reduction</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The ideal must be prime.</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">=</span><span class="n">QQ</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;a&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1024</span><span class="o">*</span><span class="n">K</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span><span class="mi">1024</span><span class="o">*</span><span class="n">K</span><span class="o">.</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">reduction</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">K</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by y^2 + (abar+1)*y = x^3 over Residue field in abar of Fractional ideal (2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.regulator_of_points">
<tt class="descname">regulator_of_points</tt><big>(</big><em>points=</em>, <span class="optional">[</span><span class="optional">]</span><em>precision=None</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.regulator_of_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the regulator of the given points on this curve.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">points</span></tt> -(default: empty list)  a list of points on this curve</li>
<li><tt class="docutils literal"><span class="pre">precision</span></tt> - int or None (default: None): the precision
in bits of the result (default real precision if None)</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">([</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">])</span>
<span class="go">0.000000000000000</span>
<span class="gp">sage: </span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="o">==</span><span class="n">Q</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;5077a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
<span class="go">0.417143558758384</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">(</span><span class="n">points</span><span class="p">,</span><span class="n">precision</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">0.41714355875838396981711954462</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">()</span>
<span class="go">1.00000000000000</span>
<span class="gp">sage: </span><span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">E</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
<span class="go">0.152460177943144</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">0.15246017794314375162432475705</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="go">0.15246017794314375162432475704945582324372707748663081784028</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="go">0.152460177943143751624324757049455823243727077486630817840280980046053225683562463604114816</span>
</pre></div>
</div>
<p>Examples over number fields:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">97</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">0.476223106404866</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">([</span><span class="n">P</span><span class="p">])</span>
<span class="go">0.476223106404866</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">47</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">([</span><span class="n">P</span><span class="p">,</span><span class="n">T</span><span class="p">])</span> <span class="c"># random very small output</span>
<span class="go">-1.23259516440783e-32</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">([</span><span class="n">P</span><span class="p">,</span><span class="n">T</span><span class="p">])</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">1e-30</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">,</span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">([</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">])</span>
<span class="go">0.152460177943144</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">47</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">([</span><span class="n">EK</span><span class="p">(</span><span class="n">P</span><span class="p">),</span><span class="n">EK</span><span class="p">(</span><span class="n">Q</span><span class="p">)])</span>
<span class="go">0.152460177943144</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="o">-</span><span class="mi">9</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="o">-</span><span class="mi">18</span><span class="o">-</span><span class="mi">25</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="o">-</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">height_pairing_matrix</span><span class="p">([</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">])</span>
<span class="go">[  2.16941934493768 -0.870059380421505]</span>
<span class="go">[-0.870059380421505  0.424585837470709]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">([</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">])</span>
<span class="go">0.164101403936070</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.simon_two_descent">
<tt class="descname">simon_two_descent</tt><big>(</big><em>verbose=0</em>, <em>lim1=2</em>, <em>lim3=4</em>, <em>limtriv=2</em>, <em>maxprob=20</em>, <em>limbigprime=30</em>, <em>known_points=None</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.simon_two_descent" title="Permalink to this definition">¶</a></dt>
<dd><p>Return lower and upper bounds on the rank of the Mordell-Weil
group <span class="math">\(E(K)\)</span> and a list of points.</p>
<p>This method is used internally by the <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.rank" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.rank"><tt class="xref py py-meth docutils literal"><span class="pre">rank()</span></tt></a>,
<a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.rank_bounds" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.rank_bounds"><tt class="xref py py-meth docutils literal"><span class="pre">rank_bounds()</span></tt></a> and <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.gens" title="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.gens"><tt class="xref py py-meth docutils literal"><span class="pre">gens()</span></tt></a> methods.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">self</span></tt> &#8211; an elliptic curve <span class="math">\(E\)</span> over a number field <span class="math">\(K\)</span></li>
<li><tt class="docutils literal"><span class="pre">verbose</span></tt> &#8211; 0, 1, 2, or 3 (default: 0), the verbosity level</li>
<li><tt class="docutils literal"><span class="pre">lim1</span></tt> &#8211; (default: 2) limit on trivial points on quartics</li>
<li><tt class="docutils literal"><span class="pre">lim3</span></tt> &#8211; (default: 4) limit on points on ELS quartics</li>
<li><tt class="docutils literal"><span class="pre">limtriv</span></tt> &#8211; (default: 2) limit on trivial points on <span class="math">\(E\)</span></li>
<li><tt class="docutils literal"><span class="pre">maxprob</span></tt> &#8211; (default: 20)</li>
<li><tt class="docutils literal"><span class="pre">limbigprime</span></tt> &#8211; (default: 30) to distinguish between
small and large prime numbers. Use probabilistic tests for
large primes. If 0, don&#8217;t use probabilistic tests.</li>
<li><tt class="docutils literal"><span class="pre">known_points</span></tt> &#8211; (default: None) list of known points on
the curve</li>
</ul>
<p>OUTPUT: a triple <tt class="docutils literal"><span class="pre">(lower,</span> <span class="pre">upper,</span> <span class="pre">list)</span></tt> consisting of</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">lower</span></tt> (integer) &#8211; lower bound on the rank</li>
<li><tt class="docutils literal"><span class="pre">upper</span></tt> (integer) &#8211; upper bound on the rank</li>
<li><tt class="docutils literal"><span class="pre">list</span></tt> &#8211; list of points in <span class="math">\(E(K)\)</span></li>
</ul>
<p>The integer <tt class="docutils literal"><span class="pre">upper</span></tt> is in fact an upper bound on the
dimension of the 2-Selmer group, hence on the dimension of
<span class="math">\(E(K)/2E(K)\)</span>.  It is equal to the dimension of the 2-Selmer
group except possibly if <span class="math">\(E(K)[2]\)</span> has dimension 1.  In that
case, <tt class="docutils literal"><span class="pre">upper</span></tt> may exceed the dimension of the 2-Selmer group
by an even number, due to the fact that the algorithm does not
perform a second descent.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For non-quadratic number fields, this code does return, but
it takes a long time.</p>
</div>
<p>ALGORITHM:</p>
<p>Uses Denis Simon&#8217;s PARI/GP scripts from
<a class="reference external" href="http://www.math.unicaen.fr/~simon/">http://www.math.unicaen.fr/~simon/</a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">23</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="s">&#39;37&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">==</span> <span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">E</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">simon_two_descent</span><span class="p">()</span>
<span class="go">(2, 2, [(0 : 0 : 1), (1/8*a + 5/8 : -3/16*a - 7/16 : 1)])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">simon_two_descent</span><span class="p">(</span><span class="n">lim1</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">lim3</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">limtriv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">maxprob</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">limbigprime</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">(2, 2, [(-1 : 0 : 1), (-1/8*a + 5/8 : -3/16*a - 9/16 : 1)])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">7</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="p">]);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2  = x^3 + x + a over Number Field in a with defining polynomial x^2 + 7</span>

<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">simon_two_descent</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span> <span class="n">v</span>
<span class="go"> elliptic curve: Y^2 = x^3 + Mod(1, y^2 + 7)*x + Mod(y, y^2 + 7)</span>
<span class="go"> Trivial points on the curve = [[1, 1, 0], [Mod(1/2*y + 3/2, y^2 + 7), Mod(-y - 2, y^2 + 7), 1]]</span>
<span class="go">#S(E/K)[2]    = 2</span>
<span class="go">#E(K)/2E(K)   = 2</span>
<span class="go">#III(E/K)[2]  = 1</span>
<span class="go">rank(E/K)     = 1</span>
<span class="go"> listpoints = [[Mod(1/2*y + 3/2, y^2 + 7), Mod(-y - 2, y^2 + 7), 1]]</span>
<span class="go">(1, 1, [(1/2*a + 3/2 : -a - 2 : 1)])</span>

<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">simon_two_descent</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">K = bnfinit(y^2 + 7);</span>
<span class="go">a = Mod(y,K.pol);</span>
<span class="go">bnfellrank(K, [0, 0, 0, 1, a], [[Mod(1/2*y + 3/2, y^2 + 7), Mod(-y - 2, y^2 + 7)]]);</span>
<span class="go"> elliptic curve: Y^2 = x^3 + Mod(1, y^2 + 7)*x + Mod(y, y^2 + 7)</span>
<span class="go">  A = Mod(0, y^2 + 7)</span>
<span class="go">  B = Mod(1, y^2 + 7)</span>
<span class="go">  C = Mod(y, y^2 + 7)</span>

<span class="go">  Computing L(S,2)</span>
<span class="go">  L(S,2) = [Mod(Mod(-1, y^2 + 7)*x^2 + Mod(-1/2*y + 1/2, y^2 + 7)*x + 1, x^3 + Mod(1, y^2 + 7)*x + Mod(y, y^2 + 7)), Mod(Mod(-1, y^2 + 7)*x^2 + Mod(-1/2*y - 1/2, y^2 + 7)*x + 1, x^3 + Mod(1, y^2 + 7)*x + Mod(y, y^2 + 7)), Mod(-1, x^3 + Mod(1, y^2 + 7)*x + Mod(y, y^2 + 7)), Mod(x^2 + 2, x^3 + Mod(1, y^2 + 7)*x + Mod(y, y^2 + 7)), Mod(Mod(1, y^2 + 7)*x + Mod(1/2*y + 3/2, y^2 + 7), x^3 + Mod(1, y^2 + 7)*x + Mod(y, y^2 + 7)), Mod(Mod(1, y^2 + 7)*x + Mod(1/2*y - 3/2, y^2 + 7), x^3 + Mod(1, y^2 + 7)*x + Mod(y, y^2 + 7))]</span>

<span class="go">  Computing the Selmer group</span>
<span class="go">  #LS2gen = 2</span>
<span class="go">   LS2gen = [Mod(Mod(-5, y^2 + 7)*x^2 + Mod(-3*y, y^2 + 7)*x + Mod(8, y^2 + 7), x^3 + Mod(1, y^2 + 7)*x + Mod(y, y^2 + 7)), Mod(Mod(1, y^2 + 7)*x^2 + Mod(1/2*y - 1/2, y^2 + 7)*x - 1, x^3 + Mod(1, y^2 + 7)*x + Mod(y, y^2 + 7))]</span>
<span class="go">  Search for trivial points on the curve</span>
<span class="go"> Trivial points on the curve = [[Mod(1/2*y + 3/2, y^2 + 7), Mod(-y - 2, y^2 + 7)], [1, 1, 0], [Mod(1/2*y + 3/2, y^2 + 7), Mod(-y - 2, y^2 + 7), 1]]</span>
<span class="go">  zc = Mod(Mod(-5, y^2 + 7)*x^2 + Mod(-3*y, y^2 + 7)*x + Mod(8, y^2 + 7), x^3 + Mod(1, y^2 + 7)*x + Mod(y, y^2 + 7))</span>
<span class="go">  Hilbert symbol (Mod(2, y^2 + 7),Mod(-5, y^2 + 7)) =</span>
<span class="go">  zc = Mod(Mod(1, y^2 + 7)*x^2 + Mod(1/2*y - 1/2, y^2 + 7)*x + Mod(-1, y^2 + 7), x^3 + Mod(1, y^2 + 7)*x + Mod(y, y^2 + 7))</span>
<span class="go">  Hilbert symbol (Mod(-2*y + 2, y^2 + 7),Mod(1, y^2 + 7)) =</span>
<span class="go">  sol of quadratic equation = [1, 0, 1]~</span>
<span class="go">  zc*z1^2 = Mod(Mod(2*y - 2, y^2 + 7)*x + Mod(2*y + 10, y^2 + 7), x^3 + Mod(1, y^2 + 7)*x + Mod(y, y^2 + 7))</span>
<span class="go">  quartic: (-1/2*y + 1/2)*Y^2 = x^4 + (-3*y - 15)*x^2 + (-8*y - 16)*x + (-11/2*y - 15/2)</span>
<span class="go">  reduced: Y^2 = (-1/2*y + 1/2)*x^4 - 4*x^3 + (-3*y + 3)*x^2 + (2*y - 2)*x + (1/2*y + 3/2)</span>
<span class="go">  not ELS at [2, [0, 1]~, 1, 1, [1, -2; 1, 0]]</span>
<span class="go">  zc = Mod(Mod(1, y^2 + 7)*x^2 + Mod(1/2*y + 1/2, y^2 + 7)*x + Mod(-1, y^2 + 7), x^3 + Mod(1, y^2 + 7)*x + Mod(y, y^2 + 7))</span>
<span class="go">  comes from the trivial point [Mod(1/2*y + 3/2, y^2 + 7), Mod(-y - 2, y^2 + 7)]</span>
<span class="go">  m1 = 1</span>
<span class="go">  m2 = 1</span>
<span class="go">#S(E/K)[2]    = 2</span>
<span class="go">#E(K)/2E(K)   = 2</span>
<span class="go">#III(E/K)[2]  = 1</span>
<span class="go">rank(E/K)     = 1</span>
<span class="go"> listpoints = [[Mod(1/2*y + 3/2, y^2 + 7), Mod(-y - 2, y^2 + 7)]]</span>
<span class="go">v = [1, 1, [[Mod(1/2*y + 3/2, y^2 + 7), Mod(-y - 2, y^2 + 7)]]]</span>
<span class="gp">sage: </span><span class="n">v</span>
<span class="go">(1, 1, [(1/2*a + 3/2 : -a - 2 : 1)])</span>
</pre></div>
</div>
<p>A curve with 2-torsion:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="s">&#39;15a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">simon_two_descent</span><span class="p">()</span>  <span class="c"># long time (3s on sage.math, 2013), points can vary</span>
<span class="go">(1, 3, [...])</span>
</pre></div>
</div>
<p>Check that the bug reported in <a class="reference external" href="http://trac.sagemath.org/15483">trac ticket #15483</a> is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">s</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">229</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c4</span> <span class="o">=</span> <span class="mi">2173</span> <span class="o">-</span> <span class="mi">235</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">c6</span> <span class="o">=</span> <span class="o">-</span><span class="mi">124369</span> <span class="o">+</span> <span class="mi">15988</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="n">c4</span><span class="o">/</span><span class="mi">48</span><span class="p">,</span> <span class="o">-</span><span class="n">c6</span><span class="o">/</span><span class="mi">864</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">simon_two_descent</span><span class="p">()</span>
<span class="go">(0, 0, [])</span>

<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">g</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">9</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">13</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E1</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">L</span><span class="p">,[</span><span class="mi">1</span><span class="o">-</span><span class="n">g</span><span class="o">*</span><span class="p">(</span><span class="n">g</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">g</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">g</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="n">g</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">g</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E1</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>  <span class="c"># long time (about 5 s)</span>
<span class="go">0</span>

<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span><span class="o">.</span><span class="n">subfields</span><span class="p">(</span><span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="s">&#39;37&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">simon_two_descent</span><span class="p">()</span>  <span class="c"># long time (4s on sage.math, 2013)</span>
<span class="go">(3, 3, [(0 : 0 : 1), (-1/4*zeta43_0^2 - 1/2*zeta43_0 + 3 : -3/8*zeta43_0^2 - 3/4*zeta43_0 + 4 : 1)])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.tamagawa_exponent">
<tt class="descname">tamagawa_exponent</tt><big>(</big><em>P</em>, <em>proof=None</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.tamagawa_exponent" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Tamagawa index of this elliptic curve at the prime <span class="math">\(P\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">P</span></tt> &#8211; either None or a prime ideal of the base field of self.</li>
<li><tt class="docutils literal"><span class="pre">proof</span></tt> &#8211; whether to only use provably correct methods
(default controlled by global proof module).  Note that the
proof module is number_field, not elliptic_curves, since the
functions that actually need the flag are in number fields.</li>
</ul>
<p>OUTPUT:</p>
<p>(positive integer) The Tamagawa index of the curve at P.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">625</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">6875</span><span class="p">,</span> <span class="mi">31250</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">46875</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">tamagawa_exponent</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="k">for</span> <span class="n">P</span> <span class="ow">in</span> <span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">support</span><span class="p">()]</span>
<span class="go">[1, 1, 1, 1]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;11a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">tamagawa_exponent</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="k">for</span> <span class="n">P</span> <span class="ow">in</span> <span class="n">K</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">support</span><span class="p">()]</span>
<span class="go">[10]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.tamagawa_number">
<tt class="descname">tamagawa_number</tt><big>(</big><em>P</em>, <em>proof=None</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.tamagawa_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Tamagawa number of this elliptic curve at the prime <span class="math">\(P\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">P</span></tt> &#8211; either None or a prime ideal of the base field of self.</li>
<li><tt class="docutils literal"><span class="pre">proof</span></tt> &#8211; whether to only use provably correct methods
(default controlled by global proof module).  Note that the
proof module is number_field, not elliptic_curves, since the
functions that actually need the flag are in number fields.</li>
</ul>
<p>OUTPUT:</p>
<p>(positive integer) The Tamagawa number of the curve at <span class="math">\(P\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">625</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">6875</span><span class="p">,</span> <span class="mi">31250</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">46875</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">tamagawa_number</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="k">for</span> <span class="n">P</span> <span class="ow">in</span> <span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">support</span><span class="p">()]</span>
<span class="go">[1, 1, 1, 1]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;11a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">tamagawa_number</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="k">for</span> <span class="n">P</span> <span class="ow">in</span> <span class="n">K</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">support</span><span class="p">()]</span>
<span class="go">[10]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.tamagawa_numbers">
<tt class="descname">tamagawa_numbers</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.tamagawa_numbers" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of all Tamagawa numbers for all prime divisors of the
conductor (in order).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;30a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">tamagawa_numbers</span><span class="p">()</span>
<span class="go">[2, 3, 1]</span>
<span class="gp">sage: </span><span class="n">vector</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">tamagawa_numbers</span><span class="p">())</span>
<span class="go">(2, 3, 1)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">eK</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">eK</span><span class="o">.</span><span class="n">tamagawa_numbers</span><span class="p">()</span>
<span class="go">[4, 6, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.tamagawa_product_bsd">
<tt class="descname">tamagawa_product_bsd</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.tamagawa_product_bsd" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an elliptic curve <span class="math">\(E\)</span> over a number field <span class="math">\(K\)</span>, this function returns the
integer <span class="math">\(C(E/K)\)</span> that appears in the Birch and Swinnerton-Dyer conjecture accounting
for the local information at finite places. If the model is a global minimal model then <span class="math">\(C(E/K)\)</span> is
simply the product of the Tamagawa numbers <span class="math">\(c_v\)</span> where <span class="math">\(v\)</span> runs over all prime ideals of <span class="math">\(K\)</span>. Otherwise, if the model has to be changed at a place <span class="math">\(v\)</span> a correction factor appears.
The definition is such that <span class="math">\(C(E/K)\)</span> times the periods at the infinite places is invariant
under change of the Weierstrass model. See [Ta2] and [Do] for details.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This definition is slightly different from the definition of <tt class="docutils literal"><span class="pre">tamagawa_product</span></tt>
for curves defined over <span class="math">\(\QQ\)</span>. Over the rational number it is always defined to be the product
of the Tamagawa numbers, so the two definitions only agree when the model is global minimal.</p>
</div>
<p>OUTPUT:</p>
<p>A rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">tamagawa_product_bsd</span><span class="p">()</span>
<span class="go">1</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">tamagawa_product_bsd</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
<p>An example where the Neron model changes over K:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="s">&#39;75a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">tamagawa_product_bsd</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">da</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">local_data</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">dav</span><span class="o">.</span><span class="n">tamagawa_number</span><span class="p">()</span> <span class="k">for</span> <span class="n">dav</span> <span class="ow">in</span> <span class="n">da</span><span class="p">]</span>
<span class="go">[1, 1]</span>
</pre></div>
</div>
<p>An example over <span class="math">\(\mathbb{Q}\)</span> (<a class="reference external" href="http://trac.sagemath.org/9413">trac ticket #9413</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;30a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">tamagawa_product_bsd</span><span class="p">()</span>
<span class="go">6</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[Ta2] Tate, John, On the conjectures of Birch and Swinnerton-Dyer and a geometric analog. Seminaire Bourbaki, Vol. 9, Exp. No. 306.</li>
<li>[Do] Dokchitser, Tim and Vladimir, On the Birch-Swinnerton-Dyer quotients modulo squares, Annals of Math., 2010.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.torsion_order">
<tt class="descname">torsion_order</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.torsion_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the order of the torsion subgroup of this elliptic curve.</p>
<p>OUTPUT:</p>
<p>(integer) the order of the torsion subgroup of this elliptic curve.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">11</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">41</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">101</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">torsion_order</span><span class="p">()</span>  <span class="c"># long time (2s on sage.math, 2014)</span>
<span class="go">25</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;15a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">torsion_order</span><span class="p">()</span>
<span class="go">16</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;19a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">9</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">8</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">7</span><span class="o">+</span><span class="mi">16</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">21</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">torsion_order</span><span class="p">()</span>
<span class="go">9</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">torsion_order</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.torsion_points">
<tt class="descname">torsion_points</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.torsion_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of the torsion points of this elliptic curve.</p>
<p>OUTPUT:</p>
<p>(list) A sorted list of the torsion points.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">torsion_points</span><span class="p">()</span>
<span class="go">[(0 : 1 : 0), (5 : -6 : 1), (5 : 5 : 1), (16 : -61 : 1), (16 : 60 : 1)]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">11</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">41</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">101</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">torsion_points</span><span class="p">()</span>  <span class="c"># long time (1s on sage.math, 2014)</span>
<span class="go">[(16 : 60 : 1),</span>
<span class="go"> (5 : 5 : 1),</span>
<span class="go"> (5 : -6 : 1),</span>
<span class="go"> (16 : -61 : 1),</span>
<span class="go"> (t : 1/11*t^3 + 6/11*t^2 + 19/11*t + 48/11 : 1),</span>
<span class="go"> (-3/55*t^3 - 7/55*t^2 - 2/55*t - 133/55 : 6/55*t^3 + 3/55*t^2 + 25/11*t + 156/55 : 1),</span>
<span class="go"> (-9/121*t^3 - 21/121*t^2 - 127/121*t - 377/121 : -7/121*t^3 + 24/121*t^2 + 197/121*t + 16/121 : 1),</span>
<span class="go"> (5/121*t^3 - 14/121*t^2 - 158/121*t - 453/121 : -49/121*t^3 - 129/121*t^2 - 315/121*t - 207/121 : 1),</span>
<span class="go"> (10/121*t^3 + 49/121*t^2 + 168/121*t + 73/121 : 32/121*t^3 + 60/121*t^2 - 261/121*t - 807/121 : 1),</span>
<span class="go"> (1/11*t^3 - 5/11*t^2 + 19/11*t - 40/11 : -6/11*t^3 - 3/11*t^2 - 26/11*t - 321/11 : 1),</span>
<span class="go"> (14/121*t^3 - 15/121*t^2 + 90/121*t + 232/121 : 16/121*t^3 - 69/121*t^2 + 293/121*t - 46/121 : 1),</span>
<span class="go"> (3/55*t^3 + 7/55*t^2 + 2/55*t + 78/55 : 7/55*t^3 - 24/55*t^2 + 9/11*t + 17/55 : 1),</span>
<span class="go"> (-5/121*t^3 + 36/121*t^2 - 84/121*t + 24/121 : 34/121*t^3 - 27/121*t^2 + 305/121*t + 708/121 : 1),</span>
<span class="go"> (-26/121*t^3 + 20/121*t^2 - 219/121*t - 995/121 : 15/121*t^3 + 156/121*t^2 - 232/121*t + 2766/121 : 1),</span>
<span class="go"> (1/11*t^3 - 5/11*t^2 + 19/11*t - 40/11 : 6/11*t^3 + 3/11*t^2 + 26/11*t + 310/11 : 1),</span>
<span class="go"> (-26/121*t^3 + 20/121*t^2 - 219/121*t - 995/121 : -15/121*t^3 - 156/121*t^2 + 232/121*t - 2887/121 : 1),</span>
<span class="go"> (-5/121*t^3 + 36/121*t^2 - 84/121*t + 24/121 : -34/121*t^3 + 27/121*t^2 - 305/121*t - 829/121 : 1),</span>
<span class="go"> (3/55*t^3 + 7/55*t^2 + 2/55*t + 78/55 : -7/55*t^3 + 24/55*t^2 - 9/11*t - 72/55 : 1),</span>
<span class="go"> (14/121*t^3 - 15/121*t^2 + 90/121*t + 232/121 : -16/121*t^3 + 69/121*t^2 - 293/121*t - 75/121 : 1),</span>
<span class="go"> (t : -1/11*t^3 - 6/11*t^2 - 19/11*t - 59/11 : 1),</span>
<span class="go"> (10/121*t^3 + 49/121*t^2 + 168/121*t + 73/121 : -32/121*t^3 - 60/121*t^2 + 261/121*t + 686/121 : 1),</span>
<span class="go"> (5/121*t^3 - 14/121*t^2 - 158/121*t - 453/121 : 49/121*t^3 + 129/121*t^2 + 315/121*t + 86/121 : 1),</span>
<span class="go"> (-9/121*t^3 - 21/121*t^2 - 127/121*t - 377/121 : 7/121*t^3 - 24/121*t^2 - 197/121*t - 137/121 : 1),</span>
<span class="go"> (-3/55*t^3 - 7/55*t^2 - 2/55*t - 133/55 : -6/55*t^3 - 3/55*t^2 - 25/11*t - 211/55 : 1),</span>
<span class="go"> (0 : 1 : 0)]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;15a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">torsion_points</span><span class="p">()</span>
<span class="go">[(-7 : -5*t - 2 : 1),</span>
<span class="go"> (-7 : 5*t + 8 : 1),</span>
<span class="go"> (-13/4 : 9/8 : 1),</span>
<span class="go"> (-2 : -2 : 1),</span>
<span class="go"> (-2 : 3 : 1),</span>
<span class="go"> (-t - 2 : -t - 7 : 1),</span>
<span class="go"> (-t - 2 : 2*t + 8 : 1),</span>
<span class="go"> (-1 : 0 : 1),</span>
<span class="go"> (t : t - 5 : 1),</span>
<span class="go"> (t : -2*t + 4 : 1),</span>
<span class="go"> (0 : 1 : 0),</span>
<span class="go"> (1/2 : -5/4*t - 2 : 1),</span>
<span class="go"> (1/2 : 5/4*t + 1/2 : 1),</span>
<span class="go"> (3 : -2 : 1),</span>
<span class="go"> (8 : -27 : 1),</span>
<span class="go"> (8 : 18 : 1)]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">torsion_points</span> <span class="p">()</span>
<span class="go"> [(-2 : -3*i : 1), (-2 : 3*i : 1), (0 : -i : 1), (0 : i : 1), (0 : 1 : 0), (1 : 0 : 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.torsion_subgroup">
<tt class="descname">torsion_subgroup</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_number_field.EllipticCurve_number_field.torsion_subgroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the torsion subgroup of this elliptic curve.</p>
<p>OUTPUT:</p>
<p>(<tt class="docutils literal"><span class="pre">EllipticCurveTorsionSubgroup</span></tt>) The
<tt class="docutils literal"><span class="pre">EllipticCurveTorsionSubgroup</span></tt> associated to this elliptic
curve.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">11</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">41</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">101</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">tor</span> <span class="o">=</span> <span class="n">EK</span><span class="o">.</span><span class="n">torsion_subgroup</span><span class="p">()</span>  <span class="c"># long time (2s on sage.math, 2014)</span>
<span class="gp">sage: </span><span class="n">tor</span>  <span class="c"># long time</span>
<span class="go">Torsion Subgroup isomorphic to Z/5 + Z/5 associated to the Elliptic Curve defined by y^2 + y = x^3 + (-1)*x^2 + (-10)*x + (-20) over Number Field in t with defining polynomial x^4 + x^3 + 11*x^2 + 41*x + 101</span>
<span class="gp">sage: </span><span class="n">tor</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>  <span class="c"># long time</span>
<span class="go">((16 : 60 : 1), (t : 1/11*t^3 + 6/11*t^2 + 19/11*t + 48/11 : 1))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;15a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">=</span><span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">torsion_subgroup</span><span class="p">()</span>
<span class="go">Torsion Subgroup isomorphic to Z/4 + Z/4 associated to the Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 + (-10)*x + (-10) over Number Field in t with defining polynomial x^2 + 2*x + 10</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;19a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">9</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">8</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">7</span><span class="o">+</span><span class="mi">16</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">21</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">=</span><span class="n">E</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">torsion_subgroup</span><span class="p">()</span>
<span class="go">Torsion Subgroup isomorphic to Z/9 associated to the Elliptic Curve defined by y^2 + y = x^3 + x^2 + (-9)*x + (-15) over Number Field in t with defining polynomial x^9 - 3*x^8 - 4*x^7 + 16*x^6 - 3*x^5 - 21*x^4 + 5*x^3 + 7*x^2 - 7*x + 1</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">torsion_subgroup</span> <span class="p">()</span>
<span class="go">Torsion Subgroup isomorphic to Trivial group associated to the Elliptic Curve defined by y^2  = x^3 + i*x + (i+3) over Number Field in i with defining polynomial x^2 + 1</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="ec_database.html"
                                  title="previous chapter">Tables of elliptic curves of given rank</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="height.html"
                                  title="next chapter">Canonical heights for elliptic curves over number fields</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../_sources/sage/schemes/elliptic_curves/ell_number_field.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="height.html" title="Canonical heights for elliptic curves over number fields"
             >next</a> |</li>
        <li class="right" >
          <a href="ec_database.html" title="Tables of elliptic curves of given rank"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../../index.html">Plane curves</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer">
        &copy; Copyright 2005--2016, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>