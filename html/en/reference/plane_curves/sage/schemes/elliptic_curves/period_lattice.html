<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Period lattices of elliptic curves and related functions &mdash; Sage Reference Manual v6.9: Plane curves</title>
    
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '6.9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v6.9: Plane curves" href="../../../index.html" />
    <link rel="next" title="Regions in fundamental domains of period lattices" href="period_lattice_region.html" />
    <link rel="prev" title="Weierstrass \(\wp\)-function for elliptic curves" href="ell_wp.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="period_lattice_region.html" title="Regions in fundamental domains of period lattices"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ell_wp.html" title="Weierstrass \(\wp\)-function for elliptic curves"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../../index.html">Plane curves</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="period-lattices-of-elliptic-curves-and-related-functions">
<span id="sage-schemes-elliptic-curves-period-lattice"></span><h1>Period lattices of elliptic curves and related functions<a class="headerlink" href="#period-lattices-of-elliptic-curves-and-related-functions" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.schemes.elliptic_curves.period_lattice"></span><p>Let <span class="math">\(E\)</span> be an elliptic curve defined over a number field <span class="math">\(K\)</span>
(including <span class="math">\(\QQ\)</span>).  We attach a period lattice (a discrete rank 2
subgroup of <span class="math">\(\CC\)</span>) to each embedding of <span class="math">\(K\)</span> into <span class="math">\(\CC\)</span>.</p>
<p>In the case of real embeddings, the lattice is stable under complex
conjugation and is called a real lattice.  These have two types:
rectangular, (the real curve has two connected components and positive
discriminant) or non-rectangular (one connected component, negative
discriminant).</p>
<p>The periods are computed to arbitrary precision using the AGM (Gauss&#8217;s
Arithmetic-Geometric Mean).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
</pre></div>
</div>
<p>First we try a real embedding:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">RealField</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">);</span> <span class="n">L</span>
<span class="go">Period lattice associated to Elliptic Curve defined by y^2 = x^3 + x^2 + a*x + a over Number Field in a with defining polynomial x^3 - 2 with respect to the embedding Ring morphism:</span>
<span class="go">From: Number Field in a with defining polynomial x^3 - 2</span>
<span class="go">To:   Algebraic Real Field</span>
<span class="go">Defn: a |--&gt; 1.259921049894873?</span>
</pre></div>
</div>
<p>The first basis period is real:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(3.81452977217855, 1.90726488608927 + 1.34047785962440*I)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">is_real</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>For a basis <span class="math">\(\omega_1,\omega_2\)</span> normalised so that <span class="math">\(\omega_1/\omega_2\)</span>
is in the fundamental region of the upper half-plane, use the function
<tt class="docutils literal"><span class="pre">normalised_basis()</span></tt> instead:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">normalised_basis</span><span class="p">()</span>
<span class="go">(1.90726488608927 - 1.34047785962440*I, -1.90726488608927 - 1.34047785962440*I)</span>
</pre></div>
</div>
<p>Next a complex embedding:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">ComplexField</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">);</span> <span class="n">L</span>
<span class="go">Period lattice associated to Elliptic Curve defined by y^2 = x^3 + x^2 + a*x + a over Number Field in a with defining polynomial x^3 - 2 with respect to the embedding Ring morphism:</span>
<span class="go">From: Number Field in a with defining polynomial x^3 - 2</span>
<span class="go">To:   Algebraic Field</span>
<span class="go">Defn: a |--&gt; -0.6299605249474365? - 1.091123635971722?*I</span>
</pre></div>
</div>
<p>In this case, the basis <span class="math">\(\omega_1\)</span>, <span class="math">\(\omega_2\)</span> is always normalised so
that <span class="math">\(\tau = \omega_1/\omega_2\)</span> is in the fundamental region in the
upper half plane:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">w1</span><span class="p">,</span><span class="n">w2</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">basis</span><span class="p">();</span> <span class="n">w1</span><span class="p">,</span><span class="n">w2</span>
<span class="go">(-1.37588604166076 - 2.58560946624443*I, -2.10339907847356 + 0.428378776460622*I)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">is_real</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">tau</span> <span class="o">=</span> <span class="n">w1</span><span class="o">/</span><span class="n">w2</span><span class="p">;</span> <span class="n">tau</span>
<span class="go">0.387694505032876 + 1.30821088214407*I</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">normalised_basis</span><span class="p">()</span>
<span class="go">(-1.37588604166076 - 2.58560946624443*I, -2.10339907847356 + 0.428378776460622*I)</span>
</pre></div>
</div>
<p>We test that bug #8415 (caused by a PARI bug fixed in v2.3.5) is OK:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">complex_embeddings</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">Period lattice associated to Elliptic Curve defined by y^2 + y = x^3 + (-1)*x over Number Field in a with defining polynomial x^2 + 7 with respect to the embedding Ring morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial x^2 + 7</span>
<span class="go">  To:   Algebraic Field</span>
<span class="go">  Defn: a |--&gt; -2.645751311064591?*I</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="ct" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[CT]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id2">2</a>)</em> J. E. Cremona and T. Thongjunthug, The Complex AGM, periods of
elliptic curves over $CC$ and complex elliptic logarithms.
Journal of Number Theory Volume 133, Issue 8, August 2013, pages
2813-2841.</td></tr>
</tbody>
</table>
<p>AUTHORS:</p>
<ul class="simple">
<li>?: initial version.</li>
<li>John Cremona:<ul>
<li>Adapted to handle real embeddings of number fields, September 2008.</li>
<li>Added basis_matrix function, November 2008</li>
<li>Added support for complex embeddings, May 2009.</li>
<li>Added complex elliptic logs, March 2010; enhanced, October 2010.</li>
</ul>
</li>
</ul>
<dl class="class">
<dt id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice">
<em class="property">class </em><tt class="descclassname">sage.schemes.elliptic_curves.period_lattice.</tt><tt class="descname">PeriodLattice</tt><big>(</big><em>base_ring</em>, <em>rank</em>, <em>degree</em>, <em>sparse=False</em>, <em>coordinate_ring=None</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../modules/sage/modules/free_module.html#sage.modules.free_module.FreeModule_generic_pid" title="(in Sage Reference Manual: Modules v6.9)"><tt class="xref py py-class docutils literal"><span class="pre">sage.modules.free_module.FreeModule_generic_pid</span></tt></a></p>
<p>The class for the period lattice of an algebraic variety.</p>
</dd></dl>

<dl class="class">
<dt id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell">
<em class="property">class </em><tt class="descclassname">sage.schemes.elliptic_curves.period_lattice.</tt><tt class="descname">PeriodLattice_ell</tt><big>(</big><em>E</em>, <em>embedding=None</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice" title="sage.schemes.elliptic_curves.period_lattice.PeriodLattice"><tt class="xref py py-class docutils literal"><span class="pre">sage.schemes.elliptic_curves.period_lattice.PeriodLattice</span></tt></a></p>
<p>The class for the period lattice of an elliptic curve.</p>
<p>Currently supported are elliptic curves defined over <span class="math">\(\QQ\)</span>, and
elliptic curves defined over a number field with a real or complex
embedding, where the lattice constructed depends on that
embedding.</p>
<dl class="method">
<dt id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.basis">
<tt class="descname">basis</tt><big>(</big><em>prec=None</em>, <em>algorithm='sage'</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a basis for this period lattice as a 2-tuple.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">prec</span></tt> (default: <tt class="docutils literal"><span class="pre">None</span></tt>) &#8211; precision in bits (default
precision if <tt class="docutils literal"><span class="pre">None</span></tt>).</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> (string, default &#8216;sage&#8217;) &#8211; choice of
implementation (for real embeddings only) between &#8216;sage&#8217;
(native Sage implementation) or &#8216;pari&#8217; (use the PARI
library: only available for real embeddings).</li>
</ul>
<p>OUTPUT:</p>
<p>(tuple of Complex) <span class="math">\((\omega_1,\omega_2)\)</span> where the lattice is
<span class="math">\(\ZZ\omega_1 + \ZZ\omega_2\)</span>.  If the lattice is real then
<span class="math">\(\omega_1\)</span> is real and positive, <span class="math">\(\Im(\omega_2)&gt;0\)</span> and
<span class="math">\(\Re(\omega_1/\omega_2)\)</span> is either <span class="math">\(0\)</span> (for rectangular
lattices) or <span class="math">\(\frac{1}{2}\)</span> (for non-rectangular lattices).
Otherwise, <span class="math">\(\omega_1/\omega_2\)</span> is in the fundamental region of
the upper half-plane.  If the latter normalisation is required
for real lattices, use the function <tt class="docutils literal"><span class="pre">normalised_basis()</span></tt>
instead.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(2.99345864623196, 2.45138938198679*I)</span>
</pre></div>
</div>
<p>This shows that the issue reported at trac #3954 is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b1</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b2</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b1</span> <span class="o">==</span> <span class="n">b2</span>
<span class="go">True</span>
</pre></div>
</div>
<p>This shows that the issue reported at trac #4064 is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">30</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Real Field with 30 bits of precision</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Real Field with 100 bits of precision</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">RealField</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span>
<span class="go">(3.81452977217854509, 1.90726488608927255 + 1.34047785962440202*I)</span>

<span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">ComplexField</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w1</span><span class="p">,</span><span class="n">w2</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">basis</span><span class="p">();</span> <span class="n">w1</span><span class="p">,</span><span class="n">w2</span>
<span class="go">(-1.37588604166076 - 2.58560946624443*I, -2.10339907847356 + 0.428378776460622*I)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">is_real</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">tau</span> <span class="o">=</span> <span class="n">w1</span><span class="o">/</span><span class="n">w2</span><span class="p">;</span> <span class="n">tau</span>
<span class="go">0.387694505032876 + 1.30821088214407*I</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.basis_matrix">
<tt class="descname">basis_matrix</tt><big>(</big><em>prec=None</em>, <em>normalised=False</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.basis_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the basis matrix of this period lattice.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">prec</span></tt> (int or <tt class="docutils literal"><span class="pre">None``(default))</span> <span class="pre">--</span> <span class="pre">real</span> <span class="pre">precision</span> <span class="pre">in</span>
<span class="pre">bits</span> <span class="pre">(default</span> <span class="pre">real</span> <span class="pre">precision</span> <span class="pre">if</span> <span class="pre">``None</span></tt>).</li>
<li><tt class="docutils literal"><span class="pre">normalised</span></tt> (bool, default None) &#8211; if True and the
embedding is real, use the normalised basis (see
<tt class="docutils literal"><span class="pre">normalised_basis()</span></tt>) instead of the default.</li>
</ul>
<p>OUTPUT:</p>
<p>A 2x2 real matrix whose rows are the lattice basis vectors,
after identifying <span class="math">\(\CC\)</span> with <span class="math">\(\RR^2\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">()</span>
<span class="go">[ 2.99345864623196 0.000000000000000]</span>
<span class="go">[0.000000000000000  2.45138938198679]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">RealField</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span>
<span class="go">[ 3.81452977217854509 0.000000000000000000]</span>
<span class="go">[ 1.90726488608927255  1.34047785962440202]</span>
</pre></div>
</div>
<p>See #4388:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;11a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">()</span>
<span class="go">[ 1.26920930427955 0.000000000000000]</span>
<span class="go">[0.634604652139777  1.45881661693850]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">(</span><span class="n">normalised</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[0.634604652139777 -1.45881661693850]</span>
<span class="go">[-1.26920930427955 0.000000000000000]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">()</span>
<span class="go">[ 2.49021256085505 0.000000000000000]</span>
<span class="go">[0.000000000000000  1.97173770155165]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">(</span><span class="n">normalised</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[ 2.49021256085505 0.000000000000000]</span>
<span class="go">[0.000000000000000 -1.97173770155165]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.complex_area">
<tt class="descname">complex_area</tt><big>(</big><em>prec=None</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.complex_area" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the area of a fundamental domain for the period lattice
of the elliptic curve.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">prec</span></tt> (int or <tt class="docutils literal"><span class="pre">None``(default))</span> <span class="pre">--</span> <span class="pre">real</span> <span class="pre">precision</span> <span class="pre">in</span>
<span class="pre">bits</span> <span class="pre">(default</span> <span class="pre">real</span> <span class="pre">precision</span> <span class="pre">if</span> <span class="pre">``None</span></tt>).</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">complex_area</span><span class="p">()</span>
<span class="go">7.33813274078958</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">embs</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">ComplexField</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span><span class="o">.</span><span class="n">is_real</span><span class="p">()</span> <span class="k">for</span> <span class="n">emb</span> <span class="ow">in</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">CC</span><span class="p">)]</span>
<span class="go">[False, False, True]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span><span class="o">.</span><span class="n">complex_area</span><span class="p">()</span> <span class="k">for</span> <span class="n">emb</span> <span class="ow">in</span> <span class="n">embs</span><span class="p">]</span>
<span class="go">[6.02796894766694, 6.02796894766694, 5.11329270448345]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.coordinates">
<tt class="descname">coordinates</tt><big>(</big><em>z</em>, <em>rounding=None</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the coordinates of a complex number w.r.t. the lattice basis</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">z</span></tt> (complex) &#8211; A complex number.</p>
</li>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">rounding</span></tt> (default <tt class="docutils literal"><span class="pre">None</span></tt>) &#8211; whether and how to round the</dt>
<dd><p class="first last">output (see below).</p>
</dd>
</dl>
</li>
</ul>
<p>OUTPUT:</p>
<p>When <tt class="docutils literal"><span class="pre">rounding</span></tt> is <tt class="docutils literal"><span class="pre">None</span></tt> (the default), returns a tuple
of reals <span class="math">\(x\)</span>, <span class="math">\(y\)</span> such that <span class="math">\(z=xw_1+yw_2\)</span> where <span class="math">\(w_1\)</span>, <span class="math">\(w_2\)</span>
are a basis for the lattice (normalised in the case of complex
embeddings).</p>
<p>When <tt class="docutils literal"><span class="pre">rounding</span></tt> is &#8216;round&#8217;, returns a tuple of integers <span class="math">\(n_1\)</span>,
<span class="math">\(n_2\)</span> which are the closest integers to the <span class="math">\(x\)</span>, <span class="math">\(y\)</span> defined
above.  If <span class="math">\(z\)</span> is in the lattice these are the coordinates of
<span class="math">\(z\)</span> with respect to the lattice basis.</p>
<p>When <tt class="docutils literal"><span class="pre">rounding</span></tt> is &#8216;floor&#8217;, returns a tuple of integers
<span class="math">\(n_1\)</span>, <span class="math">\(n_2\)</span> which are the integer parts to the <span class="math">\(x\)</span>, <span class="math">\(y\)</span>
defined above. These are used in :meth:<tt class="docutils literal"><span class="pre">.reduce</span></tt></p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w1</span><span class="p">,</span> <span class="n">w2</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">zP</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">100</span><span class="p">);</span> <span class="n">zP</span>
<span class="go">0.47934825019021931612953301006 + 0.98586885077582410221120384908*I</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="n">zP</span><span class="p">)</span>
<span class="go">(0.19249290511394227352563996419, 0.50000000000000000000000000000)</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="o">*</span><span class="n">w</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">w</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="n">zP</span><span class="p">),</span> <span class="n">L</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">))])</span>
<span class="go">0.47934825019021931612953301006 + 0.98586885077582410221120384908*I</span>

<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="mi">12</span><span class="o">*</span><span class="n">w1</span><span class="o">+</span><span class="mi">23</span><span class="o">*</span><span class="n">w2</span><span class="p">)</span>
<span class="go">(12.000000000000000000000000000, 23.000000000000000000000000000)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="mi">12</span><span class="o">*</span><span class="n">w1</span><span class="o">+</span><span class="mi">23</span><span class="o">*</span><span class="n">w2</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="s">&#39;floor&#39;</span><span class="p">)</span>
<span class="go">(11, 22)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="mi">12</span><span class="o">*</span><span class="n">w1</span><span class="o">+</span><span class="mi">23</span><span class="o">*</span><span class="n">w2</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="s">&#39;round&#39;</span><span class="p">)</span>
<span class="go">(12, 23)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.curve">
<tt class="descname">curve</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.curve" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the elliptic curve associated with this period lattice.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">curve</span><span class="p">()</span> <span class="ow">is</span> <span class="n">E</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">RealField</span><span class="p">())[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">curve</span><span class="p">()</span> <span class="ow">is</span> <span class="n">E</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">ComplexField</span><span class="p">())[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">curve</span><span class="p">()</span> <span class="ow">is</span> <span class="n">E</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.e_log_RC">
<tt class="descname">e_log_RC</tt><big>(</big><em>xP</em>, <em>yP</em>, <em>prec=None</em>, <em>reduce=True</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.e_log_RC" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the elliptic logarithm of a real or complex point.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">xP,</span> <span class="pre">yP</span></tt> (real or complex) &#8211; Coordinates of a point on
the embedded elliptic curve associated with this period
lattice.</li>
<li><tt class="docutils literal"><span class="pre">prec</span></tt> (default: <tt class="docutils literal"><span class="pre">None</span></tt>) &#8211; real precision in bits
(default real precision if None).</li>
<li><tt class="docutils literal"><span class="pre">reduce</span></tt> (default: <tt class="docutils literal"><span class="pre">True</span></tt>) &#8211; if <tt class="docutils literal"><span class="pre">True</span></tt>, the result
is reduced with respect to the period lattice basis.</li>
</ul>
<p>OUTPUT:</p>
<p>(complex number) The elliptic logarithm of the point <span class="math">\((xP,yP)\)</span>
with respect to this period lattice.  If <span class="math">\(E\)</span> is the elliptic
curve and <span class="math">\(\sigma:K\to\CC\)</span> the embedding, the the returned
value <span class="math">\(z\)</span> is such that <span class="math">\(z\pmod{L}\)</span> maps to <span class="math">\((xP,yP)=\sigma(P)\)</span>
under the standard Weierstrass isomorphism from <span class="math">\(\CC/L\)</span> to
<span class="math">\(\sigma(E)\)</span>.  If <tt class="docutils literal"><span class="pre">reduce</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt>, the output is reduced
so that it is in the fundamental period parallelogram with
respect to the normalised lattice basis.</p>
<p>ALGORITHM:</p>
<p>Uses the complex AGM.  See <a class="reference internal" href="#ct" id="id1">[CT]</a> for details.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">xP</span><span class="p">,</span> <span class="n">yP</span> <span class="o">=</span> <span class="p">[</span><span class="n">RR</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">P</span><span class="o">.</span><span class="n">xy</span><span class="p">()]</span>
</pre></div>
</div>
<p>The elliptic log from the real coordinates:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">e_log_RC</span><span class="p">(</span><span class="n">xP</span><span class="p">,</span> <span class="n">yP</span><span class="p">)</span>
<span class="go">0.479348250190219 + 0.985868850775824*I</span>
</pre></div>
</div>
<p>The same elliptic log from the algebraic point:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">L</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">0.479348250190219 + 0.985868850775824*I</span>
</pre></div>
</div>
<p>A number field example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">real_places</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">5</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">3.51086196882538</span>
<span class="gp">sage: </span><span class="n">xP</span><span class="p">,</span> <span class="n">yP</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">P</span><span class="o">.</span><span class="n">xy</span><span class="p">()]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">e_log_RC</span><span class="p">(</span><span class="n">xP</span><span class="p">,</span> <span class="n">yP</span><span class="p">)</span>
<span class="go">3.51086196882538</span>
</pre></div>
</div>
<p>Elliptic logs of real points which do not come from algebraic
points:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">ER</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">v</span><span class="p">(</span><span class="n">ai</span><span class="p">)</span> <span class="k">for</span> <span class="n">ai</span> <span class="ow">in</span> <span class="n">E</span><span class="o">.</span><span class="n">a_invariants</span><span class="p">()])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">ER</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="mf">12.34</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">xP</span><span class="p">,</span> <span class="n">yP</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">xy</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">xP</span><span class="p">,</span> <span class="n">yP</span>
<span class="go">(12.3400000000000, 43.3628968710567)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">e_log_RC</span><span class="p">(</span><span class="n">xP</span><span class="p">,</span> <span class="n">yP</span><span class="p">)</span>
<span class="go">3.76298229503967</span>
<span class="gp">sage: </span><span class="n">xP</span><span class="p">,</span> <span class="n">yP</span> <span class="o">=</span> <span class="n">ER</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">xy</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">e_log_RC</span><span class="p">(</span><span class="n">xP</span><span class="p">,</span> <span class="n">yP</span><span class="p">)</span>
<span class="go">2.69842609082114</span>
</pre></div>
</div>
<p>Elliptic logs of complex points:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">complex_embeddings</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">5</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">1.68207104397706 - 1.87873661686704*I</span>
<span class="gp">sage: </span><span class="n">xP</span><span class="p">,</span> <span class="n">yP</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">P</span><span class="o">.</span><span class="n">xy</span><span class="p">()]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">e_log_RC</span><span class="p">(</span><span class="n">xP</span><span class="p">,</span> <span class="n">yP</span><span class="p">)</span>
<span class="go">1.68207104397706 - 1.87873661686704*I</span>
<span class="gp">sage: </span><span class="n">EC</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">v</span><span class="p">(</span><span class="n">ai</span><span class="p">)</span> <span class="k">for</span> <span class="n">ai</span> <span class="ow">in</span> <span class="n">E</span><span class="o">.</span><span class="n">a_invariants</span><span class="p">()])</span>
<span class="gp">sage: </span><span class="n">xP</span><span class="p">,</span> <span class="n">yP</span> <span class="o">=</span> <span class="n">EC</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">xy</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">e_log_RC</span><span class="p">(</span><span class="n">xP</span><span class="p">,</span> <span class="n">yP</span><span class="p">)</span>
<span class="go">1.03355715602040 - 0.867257428417356*I</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.ei">
<tt class="descname">ei</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.ei" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the x-coordinates of the 2-division points of the elliptic curve associated with this period lattice, as elements of QQbar.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">ei</span><span class="p">()</span>
<span class="go">[-1.107159871688768?, 0.2695944364054446?, 0.8375654352833230?]</span>
</pre></div>
</div>
<p>In the following example, we should have one purely real 2-division point coordinate,
and two conjugate purely imaginary coordinates.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">RealField</span><span class="p">())[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">ei</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">abs</span><span class="p">(</span><span class="n">x1</span><span class="o">.</span><span class="n">real</span><span class="p">())</span><span class="o">+</span><span class="nb">abs</span><span class="p">(</span><span class="n">x2</span><span class="o">.</span><span class="n">real</span><span class="p">())</span><span class="o">&lt;</span><span class="mf">1e-14</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">x1</span><span class="o">.</span><span class="n">imag</span><span class="p">(),</span><span class="n">x2</span><span class="o">.</span><span class="n">imag</span><span class="p">(),</span><span class="n">x3</span>
<span class="go">(-1.122462048309373?, 1.122462048309373?, -1)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">ComplexField</span><span class="p">())[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">ei</span><span class="p">()</span>
<span class="go">[-1.000000000000000? + 0.?e-1...*I,</span>
<span class="go">-0.9720806486198328? - 0.561231024154687?*I,</span>
<span class="go">0.9720806486198328? + 0.561231024154687?*I]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.elliptic_exponential">
<tt class="descname">elliptic_exponential</tt><big>(</big><em>z</em>, <em>to_curve=True</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.elliptic_exponential" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the elliptic exponential of a complex number.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">z</span></tt> (complex) &#8211; A complex number (viewed modulo this period lattice).</li>
<li><tt class="docutils literal"><span class="pre">to_curve</span></tt> (bool, default True):  see below.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>If <tt class="docutils literal"><span class="pre">to_curve</span></tt> is False, a 2-tuple of real or complex
numbers representing the point <span class="math">\((x,y) = (\wp(z),\wp'(z))\)</span>
where <span class="math">\(\wp\)</span> denotes the Weierstrass <span class="math">\(\wp\)</span>-function with
respect to this lattice.</li>
<li>If <tt class="docutils literal"><span class="pre">to_curve</span></tt> is True, the point <span class="math">\((X,Y) =
(x-b_2/12,y-(a_1(x-b_2/12)-a_3)/2)\)</span> as a point in <span class="math">\(E(\RR)\)</span>
or <span class="math">\(E(\CC)\)</span>, with <span class="math">\((x,y) = (\wp(z),\wp'(z))\)</span> as above, where
<span class="math">\(E\)</span> is the elliptic curve over <span class="math">\(\RR\)</span> or <span class="math">\(\CC\)</span> whose period
lattice this is.</li>
<li>If the lattice is real and <span class="math">\(z\)</span> is also real then the output
is a pair of real numbers if <tt class="docutils literal"><span class="pre">to_curve</span></tt> is True, or a
point in <span class="math">\(E(\RR)\)</span> if <tt class="docutils literal"><span class="pre">to_curve</span></tt> is False.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The precision is taken from that of the input <tt class="docutils literal"><span class="pre">z</span></tt>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">L</span><span class="p">(</span><span class="n">P</span><span class="p">);</span> <span class="n">z</span>
<span class="go">1.17044757240090</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="go">(0.999999999999999 : -2.00000000000000 : 1.00000000000000)</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">curve</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 + 1.00000000000000*x*y + 1.00000000000000*y = x^3 + 1.00000000000000*x^2 - 8.00000000000000*x + 6.00000000000000 over Real Field with 53 bits of precision</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">to_curve</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">(1.41666666666667, -1.00000000000000)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">L</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">prec</span><span class="o">=</span><span class="mi">201</span><span class="p">);</span> <span class="n">z</span>
<span class="go">1.17044757240089592298992188482371493504472561677451007994189</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="go">(1.00000000000000000000000000000000000000000000000000000000000 : -2.00000000000000000000000000000000000000000000000000000000000 : 1.00000000000000000000000000000000000000000000000000000000000)</span>
</pre></div>
</div>
<p>Examples over number fields:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">embs</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">CC</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Li</span> <span class="o">=</span> <span class="p">[</span><span class="n">EK</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">embs</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">EK</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">zi</span> <span class="o">=</span> <span class="p">[</span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">Li</span><span class="p">]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">real</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">Li</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="n">zi</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
<span class="go">[-1.00000000000000, -1.00000000000000, 1.00000000000000]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">real</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">Li</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="n">zi</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
<span class="go">[-1.00000000000000, -1.00000000000000, 1.00000000000000]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">real</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">Li</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="n">zi</span><span class="p">[</span><span class="mi">2</span><span class="p">])]</span>
<span class="go">[-1.00000000000000, -1.00000000000000, 1.00000000000000]</span>

<span class="gp">sage: </span><span class="n">zi</span> <span class="o">=</span> <span class="p">[</span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span> <span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="n">Li</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">Li</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="n">zi</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">(-1.62996052494744 - 1.09112363597172*I : 1.79370052598410 - 1.37472963699860*I : 1.00000000000000)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">embs</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">Q</span><span class="p">]</span>
<span class="go">[-1.62996052494744 - 1.09112363597172*I, 1.79370052598410 - 1.37472963699860*I, 1.00000000000000]</span>
<span class="gp">sage: </span><span class="n">Li</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="n">zi</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">(-1.62996052494744 + 1.09112363597172*I : 1.79370052598410 + 1.37472963699860*I : 1.00000000000000)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">embs</span><span class="p">[</span><span class="mi">1</span><span class="p">](</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">Q</span><span class="p">]</span>
<span class="go">[-1.62996052494744 + 1.09112363597172*I, 1.79370052598410 + 1.37472963699860*I, 1.00000000000000]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">real</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">Li</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="n">zi</span><span class="p">[</span><span class="mi">2</span><span class="p">])]</span>
<span class="go">[0.259921049894873, -0.587401051968199, 1.00000000000000]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">embs</span><span class="p">[</span><span class="mi">2</span><span class="p">](</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">Q</span><span class="p">]</span>
<span class="go">[0.259921049894873, -0.587401051968200, 1.00000000000000]</span>
</pre></div>
</div>
<p>Test to show that #8820 is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">places</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="n">CDF</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span><span class="o">.</span><span class="mi">1</span><span class="p">))</span>
<span class="go">(0.0000142854026029... - 49.9960001066650*I : 249.520141250950 + 250.019855549131*I : 1.00000000000000)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="n">CDF</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span><span class="o">.</span><span class="mi">1</span><span class="p">),</span> <span class="n">to_curve</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">(0.0000142854026029... - 49.9960001066650*I, 250.020141250950 + 250.019855549131*I)</span>
</pre></div>
</div>
<p><span class="math">\(z=0\)</span> is treated as a special case:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(0.000000000000000 : 1.00000000000000 : 0.000000000000000)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">to_curve</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">(+infinity, +infinity)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">places</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">P</span>
<span class="go">(0.000000000000000 : 1.00000000000000 : 0.000000000000000)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Abelian group of points on Elliptic Curve defined by y^2 + 1.00000000000000*y = x^3 + (-1.00000000000000)*x over Complex Field with 53 bits of precision</span>
</pre></div>
</div>
<p>Very small <span class="math">\(z\)</span> are handled properly (see #8820):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">complex_embeddings</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="mf">1e-100</span><span class="p">)</span>
<span class="go">(0.000000000000000 : 1.00000000000000 : 0.000000000000000)</span>
</pre></div>
</div>
<p>The elliptic exponential of <span class="math">\(z\)</span> is returned as (0 : 1 : 0) if
the coordinates of z with respect to the period lattice are
approximately integral:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="p">(</span><span class="mi">100</span><span class="o">/</span><span class="n">log</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span><span class="o">/</span><span class="mf">0.8</span>
<span class="go">415.241011860920</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">((</span><span class="n">RealField</span><span class="p">(</span><span class="mi">415</span><span class="p">)(</span><span class="mf">1e-100</span><span class="p">)))</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">((</span><span class="n">RealField</span><span class="p">(</span><span class="mi">420</span><span class="p">)(</span><span class="mf">1e-100</span><span class="p">)))</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.elliptic_logarithm">
<tt class="descname">elliptic_logarithm</tt><big>(</big><em>P</em>, <em>prec=None</em>, <em>reduce=True</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.elliptic_logarithm" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the elliptic logarithm of a point.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">P</span></tt> (point) &#8211; A point on the elliptic curve associated
with this period lattice.</li>
<li><tt class="docutils literal"><span class="pre">prec</span></tt> (default: <tt class="docutils literal"><span class="pre">None</span></tt>) &#8211; real precision in bits
(default real precision if None).</li>
<li><tt class="docutils literal"><span class="pre">reduce</span></tt> (default: <tt class="docutils literal"><span class="pre">True</span></tt>) &#8211; if <tt class="docutils literal"><span class="pre">True</span></tt>, the result
is reduced with respect to the period lattice basis.</li>
</ul>
<p>OUTPUT:</p>
<p>(complex number) The elliptic logarithm of the point <span class="math">\(P\)</span> with
respect to this period lattice.  If <span class="math">\(E\)</span> is the elliptic curve
and <span class="math">\(\sigma:K\to\CC\)</span> the embedding, the the returned value <span class="math">\(z\)</span>
is such that <span class="math">\(z\pmod{L}\)</span> maps to <span class="math">\(\sigma(P)\)</span> under the
standard Weierstrass isomorphism from <span class="math">\(\CC/L\)</span> to <span class="math">\(\sigma(E)\)</span>.
If <tt class="docutils literal"><span class="pre">reduce</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt>, the output is reduced so that it is
in the fundamental period parallelogram with respect to the
normalised lattice basis.</p>
<p>ALGORITHM:</p>
<p>Uses the complex AGM.  See <a class="reference internal" href="#ct" id="id2">[CT]</a> for details.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">real_flag</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">is_on_identity_component</span> <span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">96</span><span class="p">)</span>
<span class="go">0.4793482501902193161295330101 + 0.9858688507758241022112038491*I</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">=</span><span class="n">E</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_on_identity_component</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">96</span><span class="p">)</span>
<span class="go">1.931128271542559442488585220</span>
</pre></div>
</div>
<p>Note that this is actually the inverse of the Weierstrass isomorphism:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">(3.00000000000000000000000000... : 5.00000000000000000000000000... : 1.000000000000000000000000000)</span>
</pre></div>
</div>
<p>An example with negative discriminant, and a torsion point:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">0</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">real_flag</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">16</span><span class="p">,</span><span class="o">-</span><span class="mi">61</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">0.253841860855911</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">real_period</span><span class="p">()</span> <span class="o">/</span> <span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">5.00000000000000</span>
</pre></div>
</div>
<p>An example where precision is problematic:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">85357462</span><span class="p">,</span> <span class="mi">303528987048</span><span class="p">])</span> <span class="c">#18074g1</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">4458713781401</span><span class="o">/</span><span class="mi">835903744</span><span class="p">,</span> <span class="o">-</span><span class="mi">64466909836503771</span><span class="o">/</span><span class="mi">24167649046528</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">ei</span><span class="p">()</span>
<span class="go">[5334.003952567705? - 1.964393150436?e-6*I, 5334.003952567705? + 1.964393150436?e-6*I, -10668.25790513541?]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">0.27656204014107061464076203097</span>
</pre></div>
</div>
<p>Some complex examples, taken from the paper by Cremona and Thongjunthug:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a4</span> <span class="o">=</span> <span class="mi">9</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">10</span>
<span class="gp">sage: </span><span class="n">a6</span> <span class="o">=</span> <span class="mi">21</span><span class="o">-</span><span class="n">i</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a4</span><span class="p">,</span><span class="n">a6</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">e1</span> <span class="o">=</span> <span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">;</span> <span class="n">e2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">;</span> <span class="n">e3</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span><span class="o">+</span><span class="n">i</span>
<span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">CC</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
<p>By default, the output is reduced with respect to the
normalised lattice basis, so that its coordinates with respect
to that basis lie in the interval [0,1):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">);</span> <span class="n">z</span>
<span class="go">0.70448375537782208460499649302 - 0.79246725643650979858266018068*I</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="go">(0.46247636364807931766105406092, 0.79497588726808704200760395829)</span>
</pre></div>
</div>
<p>Using <tt class="docutils literal"><span class="pre">reduce=False</span></tt> this step can be omitted.  In this case
the coordinates are usually in the interval [-0.5,0.5), but
this is not guaranteed.  This option is mainly for testing
purposes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="nb">reduce</span><span class="o">=</span><span class="bp">False</span><span class="p">);</span> <span class="n">z</span>
<span class="go">0.57002153834710752778063503023 + 0.46476340520469798857457031393*I</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="go">(0.46247636364807931766105406092, -0.20502411273191295799239604171)</span>
</pre></div>
</div>
<p>The elliptic logs of the 2-torsion points are half-periods:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="n">e1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">0.64607575874356525952487867052 + 0.22379609053909448304176885364*I</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="n">e2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">0.71330686725892253793705940192 - 0.40481924028150941053684639367*I</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="n">e3</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">0.067231108515357278412180731396 - 0.62861533082060389357861524731*I</span>
</pre></div>
</div>
<p>We check this by doubling and seeing that the resulting
coordinates are integers:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="n">e1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
<span class="go">(1.0000000000000000000000000000, 0.00000000000000000000000000000)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="n">e2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
<span class="go">(1.0000000000000000000000000000, 1.0000000000000000000000000000)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="n">e3</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
<span class="go">(0.00000000000000000000000000000, 1.0000000000000000000000000000)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">a4</span> <span class="o">=</span> <span class="o">-</span><span class="mi">78</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">104</span>
<span class="gp">sage: </span><span class="n">a6</span> <span class="o">=</span> <span class="o">-</span><span class="mi">216</span><span class="o">*</span><span class="n">i</span> <span class="o">-</span> <span class="mi">312</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a4</span><span class="p">,</span><span class="n">a6</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">CC</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="mi">14</span><span class="o">-</span><span class="mi">7</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">0.297147783912228 - 0.546125549639461*I</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">P</span><span class="p">))</span>
<span class="go">(0.628653378040238, 0.371417754610223)</span>
<span class="gp">sage: </span><span class="n">e1</span> <span class="o">=</span> <span class="mi">1</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="p">;</span> <span class="n">e2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span><span class="o">-</span><span class="mi">12</span><span class="o">*</span><span class="n">i</span><span class="p">;</span> <span class="n">e3</span><span class="o">=-</span><span class="n">e1</span><span class="o">-</span><span class="n">e2</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="n">e1</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span>
<span class="go">(0.500000000000000, 0.500000000000000)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="n">e2</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span>
<span class="go">(1.00000000000000, 0.500000000000000)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="n">e3</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span>
<span class="go">(0.500000000000000, 0.000000000000000)</span>
</pre></div>
</div>
<p>TESTS (see #10026 and #11767):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">w</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">w</span> <span class="o">+</span> <span class="mi">4</span> <span class="p">])</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">simon_two_descent</span><span class="p">(</span><span class="n">lim1</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">lim3</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">limtriv</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">,</span><span class="n">Q</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">embs</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">CC</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Lambda</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">embs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Lambda</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="go">4.7100131126199672766973600998</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Lambda</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">curve</span><span class="p">()</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">ComplexField</span><span class="p">(</span><span class="mi">600</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Lambda</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
<span class="go">-0.842248166487739393375018008381693990800588864069506187033873183845246233548058477561706400464057832396643843146464236956684557207157300006542470428493573195030603817094900751609464 - 0.571366031453267388121279381354098224265947866751130917440598461117775339240176310729173301979590106474259885638797913383502735083088736326391919063211421189027226502851390118943491*I</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">curve</span><span class="p">()</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">ComplexField</span><span class="p">())[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="go">1.17058357737548897849026170185581196033579563441850967539191867385734983296504066660506637438866628981886518901958717288150400849746892393771983141354 - 1.13513899565966043682474529757126359416758251309237866586896869548539516543734207347695898664875799307727928332953834601460994992792519799260968053875*I</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="go">1.17058357737548897849026170185581196033579563441850967539191867385734983296504066660506637438866628981886518901958717288150400849746892393771983141354014895386251320571643977497740116710952913769943240797618468987304985625823413440999754037939123032233879499904283600304184828809773650066658885672885 - 1.13513899565966043682474529757126359416758251309237866586896869548539516543734207347695898664875799307727928332953834601460994992792519799260968053875387282656993476491590607092182964878750169490985439873220720963653658829712494879003124071110818175013453207439440032582917366703476398880865439217473*I</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.is_real">
<tt class="descname">is_real</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.is_real" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this period lattice is real.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">is_real</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">ComplexField</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">is_real</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span><span class="o">.</span><span class="n">is_real</span><span class="p">()</span> <span class="k">for</span> <span class="n">emb</span> <span class="ow">in</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">CC</span><span class="p">)]</span>
<span class="go">[False, False, True]</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>The lattice is real if it is associated to a real embedding;
such lattices are stable under conjugation.</p>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.is_rectangular">
<tt class="descname">is_rectangular</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.is_rectangular" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this period lattice is rectangular.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Only defined for real lattices; a RuntimeError is raised for
non-real lattices.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1.26920930427955, 0.634604652139777 + 1.45881661693850*I)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">is_rectangular</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37b&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1.08852159290423, 1.76761067023379*I)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">is_rectangular</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>The period lattice is rectangular precisely if the
discriminant of the Weierstrass equation is positive, or
equivalently if the number of real components is 2.</p>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.normalised_basis">
<tt class="descname">normalised_basis</tt><big>(</big><em>prec=None</em>, <em>algorithm='sage'</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.normalised_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a normalised basis for this period lattice as a 2-tuple.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">prec</span></tt> (default: <tt class="docutils literal"><span class="pre">None</span></tt>) &#8211; precision in bits (default
precision if <tt class="docutils literal"><span class="pre">None</span></tt>).</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> (string, default &#8216;sage&#8217;) &#8211; choice of
implementation (for real embeddings only) between &#8216;sage&#8217;
(native Sage implementation) or &#8216;pari&#8217; (use the PARI
library: only available for real embeddings).</li>
</ul>
<p>OUTPUT:</p>
<p>(tuple of Complex) <span class="math">\((\omega_1,\omega_2)\)</span> where the lattice has
the form <span class="math">\(\ZZ\omega_1 + \ZZ\omega_2\)</span>.  The basis is normalised
so that <span class="math">\(\omega_1/\omega_2\)</span> is in the fundamental region of
the upper half-plane.  For an alternative normalisation for
real lattices (with the first period real), use the function
basis() instead.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">normalised_basis</span><span class="p">()</span>
<span class="go">(2.99345864623196, -2.45138938198679*I)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">RealField</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">normalised_basis</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span>
<span class="go">(1.90726488608927255 - 1.34047785962440202*I, -1.90726488608927255 - 1.34047785962440202*I)</span>

<span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">ComplexField</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w1</span><span class="p">,</span><span class="n">w2</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">normalised_basis</span><span class="p">();</span> <span class="n">w1</span><span class="p">,</span><span class="n">w2</span>
<span class="go">(-1.37588604166076 - 2.58560946624443*I, -2.10339907847356 + 0.428378776460622*I)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">is_real</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">tau</span> <span class="o">=</span> <span class="n">w1</span><span class="o">/</span><span class="n">w2</span><span class="p">;</span> <span class="n">tau</span>
<span class="go">0.387694505032876 + 1.30821088214407*I</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.omega">
<tt class="descname">omega</tt><big>(</big><em>prec=None</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.omega" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the real or complex volume of this period lattice.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">prec</span></tt> (int or <tt class="docutils literal"><span class="pre">None``(default))</span> <span class="pre">--</span> <span class="pre">real</span> <span class="pre">precision</span> <span class="pre">in</span>
<span class="pre">bits</span> <span class="pre">(default</span> <span class="pre">real</span> <span class="pre">precision</span> <span class="pre">if</span> <span class="pre">``None</span></tt>)</li>
</ul>
<p>OUTPUT:</p>
<p>(real) For real lattices, this is the real period times the
number of connected components.  For non-real lattices it is
the complex area.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the curve is defined over <span class="math">\(\QQ\)</span> and is given by a
<em>minimal</em> Weierstrass equation, then this is the correct
period in the BSD conjecture, i.e., it is the least real
period * 2 when the period lattice is rectangular.  More
generally the product of this quantity over all embeddings
appears in the generalised BSD formula.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">omega</span><span class="p">()</span>
<span class="go">5.98691729246392</span>
</pre></div>
</div>
<p>This is not a minimal model:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">432</span><span class="o">*</span><span class="mi">6</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">omega</span><span class="p">()</span>
<span class="go">0.486109385710056</span>
</pre></div>
</div>
<p>If you were to plug the above omega into the BSD conjecture, you
would get nonsense.   The following works though:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">minimal_model</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">omega</span><span class="p">()</span>
<span class="go">0.972218771420113</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">RealField</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">omega</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span>
<span class="go">3.81452977217854509</span>
</pre></div>
</div>
<p>A complex example (taken from J.E.Cremona and E.Whitley,
<em>Periods of cusp forms and elliptic curves over imaginary
quadratic fields</em>, Mathematics of Computation 62 No. 205
(1994), 407-429):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="o">-</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">CC</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">omega</span><span class="p">()</span>
<span class="go">8.80694160502647</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.real_period">
<tt class="descname">real_period</tt><big>(</big><em>prec=None</em>, <em>algorithm='sage'</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.real_period" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the real period of this period lattice.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">prec</span></tt> (int or <tt class="docutils literal"><span class="pre">None</span></tt> (default)) &#8211; real precision in
bits (default real precision if <tt class="docutils literal"><span class="pre">None</span></tt>)</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> (string, default &#8216;sage&#8217;) &#8211; choice of
implementation (for real embeddings only) between &#8216;sage&#8217;
(native Sage implementation) or &#8216;pari&#8217; (use the PARI
library: only available for real embeddings).</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Only defined for real lattices; a RuntimeError is raised for
non-real lattices.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">real_period</span><span class="p">()</span>
<span class="go">2.99345864623196</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">RealField</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">real_period</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span>
<span class="go">3.81452977217854509</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.reduce">
<tt class="descname">reduce</tt><big>(</big><em>z</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.reduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce a complex number modulo the lattice</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">z</span></tt> (complex) &#8211; A complex number.</li>
</ul>
<p>OUTPUT:</p>
<p>(complex) the reduction of <span class="math">\(z\)</span> modulo the lattice, lying in
the fundamental period parallelogram with respect to the
lattice basis.  For curves defined over the reals (i.e. real
embeddings) the output will be real when possible.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w1</span><span class="p">,</span> <span class="n">w2</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">zP</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">100</span><span class="p">);</span> <span class="n">zP</span>
<span class="go">0.47934825019021931612953301006 + 0.98586885077582410221120384908*I</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">zP</span><span class="o">+</span><span class="mi">10</span><span class="o">*</span><span class="n">w1</span><span class="o">-</span><span class="mi">20</span><span class="o">*</span><span class="n">w2</span><span class="p">;</span> <span class="n">z</span>
<span class="go">25.381473858740770069343110929 - 38.448885180257139986236950114*I</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="go">0.47934825019021931612953301006 + 0.98586885077582410221120384908*I</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span>
<span class="go">0.958696500380439</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">))</span>
<span class="go">0.958696500380439</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_logarithm</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">+</span><span class="mi">10</span><span class="o">*</span><span class="n">w1</span><span class="o">-</span><span class="mi">20</span><span class="o">*</span><span class="n">w2</span><span class="p">)</span>
<span class="go">0.958696500380444</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.sigma">
<tt class="descname">sigma</tt><big>(</big><em>z</em>, <em>prec=None</em>, <em>flag=0</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.sigma" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the value of the Weierstrass sigma function for this elliptic curve  period lattice.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">z</span></tt> &#8211; a complex number</p>
</li>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">prec</span></tt> (default: <tt class="docutils literal"><span class="pre">None</span></tt>) &#8211; real precision in bits</dt>
<dd><p class="first last">(default real precision if None).</p>
</dd>
</dl>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">flag</span></tt> &#8211;</p>
<blockquote>
<div><p>0: (default) ???;</p>
<p>1: computes an arbitrary determination of log(sigma(z))</p>
<p>2, 3: same using the product expansion instead of theta series. ???</p>
</div></blockquote>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The reason for the ???&#8217;s above, is that the PARI
documentation for ellsigma is very vague.  Also this is
only implemented for curves defined over <span class="math">\(\QQ\)</span>.</p>
</div>
<p>TODO:</p>
<p>This function does not use any of the PeriodLattice functions
and so should be moved to ell_rational_field.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">sigma</span><span class="p">(</span><span class="n">CC</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="go">2.60912163570108 - 0.200865080824587*I</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.tau">
<tt class="descname">tau</tt><big>(</big><em>prec=None</em>, <em>algorithm='sage'</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.PeriodLattice_ell.tau" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the upper half-plane parameter in the fundamental region.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">prec</span></tt> (default: <tt class="docutils literal"><span class="pre">None</span></tt>) &#8211; precision in bits (default
precision if <tt class="docutils literal"><span class="pre">None</span></tt>).</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> (string, default &#8216;sage&#8217;) &#8211; choice of
implementation (for real embeddings only) between &#8216;sage&#8217;
(native Sage implementation) or &#8216;pari&#8217; (use the PARI
library: only available for real embeddings).</li>
</ul>
<p>OUTPUT:</p>
<p>(Complex) <span class="math">\(\tau = \omega_1/\omega_2\)</span> where the lattice has the
form <span class="math">\(\ZZ\omega_1 + \ZZ\omega_2\)</span>, normalised so that <span class="math">\(\tau =
\omega_1/\omega_2\)</span> is in the fundamental region of the upper
half-plane.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">tau</span><span class="p">()</span>
<span class="go">1.22112736076463*I</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">RealField</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">tau</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">tau</span><span class="p">();</span> <span class="n">tau</span>
<span class="go">-0.338718341018919 + 0.940887817679340*I</span>
<span class="gp">sage: </span><span class="n">tau</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="go">1.00000000000000</span>
<span class="gp">sage: </span><span class="o">-</span><span class="mf">0.5</span> <span class="o">&lt;=</span> <span class="n">tau</span><span class="o">.</span><span class="n">real</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mf">0.5</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">ComplexField</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">tau</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">tau</span><span class="p">();</span> <span class="n">tau</span>
<span class="go">0.387694505032876 + 1.30821088214407*I</span>
<span class="gp">sage: </span><span class="n">tau</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="go">1.36444961115933</span>
<span class="gp">sage: </span><span class="o">-</span><span class="mf">0.5</span> <span class="o">&lt;=</span> <span class="n">tau</span><span class="o">.</span><span class="n">real</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mf">0.5</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.period_lattice.extended_agm_iteration">
<tt class="descclassname">sage.schemes.elliptic_curves.period_lattice.</tt><tt class="descname">extended_agm_iteration</tt><big>(</big><em>a</em>, <em>b</em>, <em>c</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.extended_agm_iteration" title="Permalink to this definition">¶</a></dt>
<dd><p>Internal function for the extended AGM used in elliptic logarithm computation.
INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">a</span></tt>, <tt class="docutils literal"><span class="pre">b</span></tt>, <tt class="docutils literal"><span class="pre">c</span></tt> (real or complex) &#8211; three real or complex numbers.</li>
</ul>
<p>OUTPUT:</p>
<p>(3-tuple) <span class="math">\((a_0,b_0,c_0)\)</span>, the limit of the iteration <span class="math">\((a,b,c) \mapsto ((a+b)/2,\sqrt{ab},(c+\sqrt(c^2+b^2-a^2))/2)\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.period_lattice</span> <span class="kn">import</span> <span class="n">extended_agm_iteration</span>
<span class="gp">sage: </span><span class="n">extended_agm_iteration</span><span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">RR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">RR</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">(1.45679103104691, 1.45679103104691, 3.21245294970054)</span>
<span class="gp">sage: </span><span class="n">extended_agm_iteration</span><span class="p">(</span><span class="n">CC</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">CC</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">CC</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="go">(1.46242448156430 + 2.47791311676267*I,</span>
<span class="go">1.46242448156430 + 2.47791311676267*I,</span>
<span class="go">3.22202144343535 + 4.28383734262540*I)</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">extended_agm_iteration</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">values must be real or complex numbers</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.period_lattice.normalise_periods">
<tt class="descclassname">sage.schemes.elliptic_curves.period_lattice.</tt><tt class="descname">normalise_periods</tt><big>(</big><em>w1</em>, <em>w2</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.normalise_periods" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalise the period basis <span class="math">\((w_1,w_2)\)</span> so that <span class="math">\(w_1/w_2\)</span> is in the fundamental region.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">w1,w2</span></tt> (complex) &#8211; two complex numbers with non-real ratio</li>
</ul>
<p>OUTPUT:</p>
<p>(tuple) <span class="math">\(((\omega_1',\omega_2'),[a,b,c,d])\)</span> where <span class="math">\(a,b,c,d\)</span> are
integers such that</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(ad-bc=\pm1\)</span>;</li>
<li><span class="math">\((\omega_1',\omega_2') = (a\omega_1+b\omega_2,c\omega_1+d\omega_2)\)</span>;</li>
<li><span class="math">\(\tau=\omega_1'/\omega_2'\)</span> is in the upper half plane;</li>
<li><span class="math">\(|\tau|\ge1\)</span> and <span class="math">\(|\Re(\tau)|\le\frac{1}{2}\)</span>.</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.period_lattice</span> <span class="kn">import</span> <span class="n">reduce_tau</span><span class="p">,</span> <span class="n">normalise_periods</span>
<span class="gp">sage: </span><span class="n">w1</span> <span class="o">=</span> <span class="n">CC</span><span class="p">(</span><span class="mf">1.234</span><span class="p">,</span> <span class="mf">3.456</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w2</span> <span class="o">=</span> <span class="n">CC</span><span class="p">(</span><span class="mf">1.234</span><span class="p">,</span> <span class="mf">3.456000001</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w1</span><span class="o">/</span><span class="n">w2</span>    <span class="c"># in lower half plane!</span>
<span class="go">0.999999999743367 - 9.16334785827644e-11*I</span>
<span class="gp">sage: </span><span class="n">w1w2</span><span class="p">,</span> <span class="n">abcd</span> <span class="o">=</span> <span class="n">normalise_periods</span><span class="p">(</span><span class="n">w1</span><span class="p">,</span><span class="n">w2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span> <span class="o">=</span> <span class="n">abcd</span>
<span class="gp">sage: </span><span class="n">w1w2</span> <span class="o">==</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">w1</span><span class="o">+</span><span class="n">b</span><span class="o">*</span><span class="n">w2</span><span class="p">,</span> <span class="n">c</span><span class="o">*</span><span class="n">w1</span><span class="o">+</span><span class="n">d</span><span class="o">*</span><span class="n">w2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w1w2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">w1w2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">1.23400010389203e9*I</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">*</span><span class="n">d</span><span class="o">-</span><span class="n">b</span><span class="o">*</span><span class="n">c</span> <span class="c"># note change of orientation</span>
<span class="go">-1</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.period_lattice.reduce_tau">
<tt class="descclassname">sage.schemes.elliptic_curves.period_lattice.</tt><tt class="descname">reduce_tau</tt><big>(</big><em>tau</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.period_lattice.reduce_tau" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform a point in the upper half plane to the fundamental region.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">tau</span></tt> (complex) &#8211; a complex number with positive imaginary part</li>
</ul>
<p>OUTPUT:</p>
<p>(tuple) <span class="math">\((\tau',[a,b,c,d])\)</span> where <span class="math">\(a,b,c,d\)</span> are integers such that</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(ad-bc=1\)</span>;</li>
<li><span class="math">\(\tau`=(a\tau+b)/(c\tau+d)\)</span>;</li>
<li><span class="math">\(|\tau'|\ge1\)</span>;</li>
<li><span class="math">\(|\Re(\tau')|\le\frac{1}{2}\)</span>.</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.period_lattice</span> <span class="kn">import</span> <span class="n">reduce_tau</span>
<span class="gp">sage: </span><span class="n">reduce_tau</span><span class="p">(</span><span class="n">CC</span><span class="p">(</span><span class="mf">1.23</span><span class="p">,</span><span class="mf">3.45</span><span class="p">))</span>
<span class="go">(0.230000000000000 + 3.45000000000000*I, [1, -1, 0, 1])</span>
<span class="gp">sage: </span><span class="n">reduce_tau</span><span class="p">(</span><span class="n">CC</span><span class="p">(</span><span class="mf">1.23</span><span class="p">,</span><span class="mf">0.0345</span><span class="p">))</span>
<span class="go">(-0.463960069171512 + 1.35591888067914*I, [-5, 6, 4, -5])</span>
<span class="gp">sage: </span><span class="n">reduce_tau</span><span class="p">(</span><span class="n">CC</span><span class="p">(</span><span class="mf">1.23</span><span class="p">,</span><span class="mf">0.0000345</span><span class="p">))</span>
<span class="go">(0.130000000001761 + 2.89855072463768*I, [13, -16, 100, -123])</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="ell_wp.html"
                                  title="previous chapter">Weierstrass <span class="math">\(\wp\)</span>-function for elliptic curves</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="period_lattice_region.html"
                                  title="next chapter">Regions in fundamental domains of period lattices</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../_sources/sage/schemes/elliptic_curves/period_lattice.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="period_lattice_region.html" title="Regions in fundamental domains of period lattices"
             >next</a> |</li>
        <li class="right" >
          <a href="ell_wp.html" title="Weierstrass \(\wp\)-function for elliptic curves"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../../index.html">Plane curves</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer">
        &copy; Copyright 2005--2015, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>