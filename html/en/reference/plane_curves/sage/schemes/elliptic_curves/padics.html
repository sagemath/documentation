<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Miscellaneous \(p\)-adic functions &mdash; Sage Reference Manual v6.9: Plane curves</title>
    
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '6.9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v6.9: Plane curves" href="../../../index.html" />
    <link rel="next" title="Weierstrass \(\wp\)-function for elliptic curves" href="ell_wp.html" />
    <link rel="prev" title="Tate’s parametrisation of \(p\)-adic curves with multiplicative reduction" href="ell_tate_curve.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ell_wp.html" title="Weierstrass \(\wp\)-function for elliptic curves"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ell_tate_curve.html" title="Tate’s parametrisation of \(p\)-adic curves with multiplicative reduction"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../../index.html">Plane curves</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="miscellaneous-adic-functions">
<span id="sage-schemes-elliptic-curves-padics"></span><h1>Miscellaneous <span class="math">\(p\)</span>-adic functions<a class="headerlink" href="#miscellaneous-adic-functions" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.schemes.elliptic_curves.padics"></span><p><span class="math">\(p\)</span>-adic functions from ell_rational_field.py, moved here to reduce
crowding in that file.</p>
<dl class="function">
<dt id="sage.schemes.elliptic_curves.padics.matrix_of_frobenius">
<tt class="descclassname">sage.schemes.elliptic_curves.padics.</tt><tt class="descname">matrix_of_frobenius</tt><big>(</big><em>self</em>, <em>p</em>, <em>prec=20</em>, <em>check=False</em>, <em>check_hypotheses=True</em>, <em>algorithm='auto'</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.padics.matrix_of_frobenius" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the matrix of Frobenius on the Monsky Washnitzer cohomology of the elliptic curve.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">p</span></tt> - prime (= 5) for which <span class="math">\(E\)</span> is good
and ordinary</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">prec</span></tt> - (relative) <span class="math">\(p\)</span>-adic precision for
result  (default 20)</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">check</span></tt> - boolean (default: False), whether to perform a
consistency check. This will slow down the computation by a
constant factor 2. (The consistency check is to verify
that its trace is correct to the specified precision. Otherwise,
the trace is used to compute one column from the other one
(possibly after a change of basis).)</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">check_hypotheses</span></tt> - boolean, whether to check
that this is a curve for which the <span class="math">\(p\)</span>-adic sigma function makes
sense</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">algorithm</span></tt> - one of &#8220;standard&#8221;, &#8220;sqrtp&#8221;, or
&#8220;auto&#8221;. This selects which version of Kedlaya&#8217;s algorithm is used.
The &#8220;standard&#8221; one is the one described in Kedlaya&#8217;s paper. The
&#8220;sqrtp&#8221; one has better performance for large <span class="math">\(p\)</span>, but only
works when <span class="math">\(p &gt; 6N\)</span> (<span class="math">\(N=\)</span> prec). The &#8220;auto&#8221; option
selects &#8220;sqrtp&#8221; whenever possible.</p>
<p>Note that if the &#8220;sqrtp&#8221; algorithm is used, a consistency check
will automatically be applied, regardless of the setting of the
&#8220;check&#8221; flag.</p>
</li>
</ul>
<p>OUTPUT: a matrix of <span class="math">\(p\)</span>-adic number to precision <tt class="docutils literal"><span class="pre">prec</span></tt></p>
<p>See also the documentation of padic_E2.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">matrix_of_frobenius</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">[             2*7 + 4*7^2 + 5*7^4 + 6*7^5 + 6*7^6 + 7^8 + 4*7^9 + 3*7^10 + 2*7^11 + 5*7^12 + 4*7^14 + 7^16 + 2*7^17 + 3*7^18 + 4*7^19 + 3*7^20 + O(7^21)                                   2 + 3*7 + 6*7^2 + 7^3 + 3*7^4 + 5*7^5 + 3*7^7 + 7^8 + 3*7^9 + 6*7^13 + 7^14 + 7^16 + 5*7^17 + 4*7^18 + 7^19 + O(7^20)]</span>
<span class="go">[    2*7 + 3*7^2 + 7^3 + 3*7^4 + 6*7^5 + 2*7^6 + 3*7^7 + 5*7^8 + 3*7^9 + 2*7^11 + 6*7^12 + 5*7^13 + 4*7^16 + 4*7^17 + 6*7^18 + 6*7^19 + 4*7^20 + O(7^21) 6 + 4*7 + 2*7^2 + 6*7^3 + 7^4 + 6*7^7 + 5*7^8 + 2*7^9 + 3*7^10 + 4*7^11 + 7^12 + 6*7^13 + 2*7^14 + 6*7^15 + 5*7^16 + 4*7^17 + 3*7^18 + 2*7^19 + O(7^20)]</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">matrix_of_frobenius</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="n">prec</span><span class="o">=</span><span class="mi">3</span><span class="p">);</span> <span class="n">M</span>
<span class="go">[   9*11 + 9*11^3 + O(11^4)          10 + 11 + O(11^3)]</span>
<span class="go">[     2*11 + 11^2 + O(11^4) 6 + 11 + 10*11^2 + O(11^3)]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
<span class="go">11 + O(11^4)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span>
<span class="go">6 + 10*11 + 10*11^2 + O(11^3)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">ap</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">-5</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.padics.padic_E2">
<tt class="descclassname">sage.schemes.elliptic_curves.padics.</tt><tt class="descname">padic_E2</tt><big>(</big><em>self</em>, <em>p</em>, <em>prec=20</em>, <em>check=False</em>, <em>check_hypotheses=True</em>, <em>algorithm='auto'</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.padics.padic_E2" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the value of the <span class="math">\(p\)</span>-adic modular form <span class="math">\(E2\)</span>
for <span class="math">\((E, \omega)\)</span> where <span class="math">\(\omega\)</span> is the usual
invariant differential <span class="math">\(dx/(2y + a_1 x + a_3)\)</span>.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">p</span></tt> - prime (= 5) for which <span class="math">\(E\)</span> is good
and ordinary</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">prec</span></tt> - (relative) p-adic precision (= 1) for
result</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">check</span></tt> - boolean, whether to perform a
consistency check. This will slow down the computation by a
constant factor 2. (The consistency check is to compute the whole
matrix of frobenius on Monsky-Washnitzer cohomology, and verify
that its trace is correct to the specified precision. Otherwise,
the trace is used to compute one column from the other one
(possibly after a change of basis).)</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">check_hypotheses</span></tt> - boolean, whether to check
that this is a curve for which the p-adic sigma function makes
sense</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">algorithm</span></tt> - one of &#8220;standard&#8221;, &#8220;sqrtp&#8221;, or
&#8220;auto&#8221;. This selects which version of Kedlaya&#8217;s algorithm is used.
The &#8220;standard&#8221; one is the one described in Kedlaya&#8217;s paper. The
&#8220;sqrtp&#8221; one has better performance for large <span class="math">\(p\)</span>, but only
works when <span class="math">\(p &gt; 6N\)</span> (<span class="math">\(N=\)</span> prec). The &#8220;auto&#8221; option
selects &#8220;sqrtp&#8221; whenever possible.</p>
<p>Note that if the &#8220;sqrtp&#8221; algorithm is used, a consistency check
will automatically be applied, regardless of the setting of the
&#8220;check&#8221; flag.</p>
</li>
</ul>
<p>OUTPUT: p-adic number to precision prec</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the discriminant of the curve has nonzero valuation at p,
then the result will not be returned mod <span class="math">\(p^\text{prec}\)</span>,
but it still <em>will</em> have prec <em>digits</em> of precision.</p>
</div>
<p>TODO: - Once we have a better implementation of the &#8220;standard&#8221;
algorithm, the algorithm selection strategy for &#8220;auto&#8221; needs to be
revisited.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>David Harvey (2006-09-01): partly based on code written
by Robert Bradshaw at the MSRI 2006 modular forms workshop</li>
</ul>
<p>ACKNOWLEDGMENT: - discussion with Eyal Goren that led to the trace
trick.</p>
<p>EXAMPLES: Here is the example discussed in the paper &#8220;Computation
of p-adic Heights and Log Convergence&#8221; (Mazur, Stein, Tate):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">padic_E2</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">2 + 4*5 + 2*5^3 + 5^4 + 3*5^5 + 2*5^6 + 5^8 + 3*5^9 + 4*5^10 + 2*5^11 + 2*5^12 + 2*5^14 + 3*5^15 + 3*5^16 + 3*5^17 + 4*5^18 + 2*5^19 + O(5^20)</span>
</pre></div>
</div>
<p>Let&#8217;s try to higher precision (this is the same answer the MAGMA
implementation gives):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">padic_E2</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="go">2 + 4*5 + 2*5^3 + 5^4 + 3*5^5 + 2*5^6 + 5^8 + 3*5^9 + 4*5^10 + 2*5^11 + 2*5^12 + 2*5^14 + 3*5^15 + 3*5^16 + 3*5^17 + 4*5^18 + 2*5^19 + 4*5^20 + 5^21 + 4*5^22 + 2*5^23 + 3*5^24 + 3*5^26 + 2*5^27 + 3*5^28 + 2*5^30 + 5^31 + 4*5^33 + 3*5^34 + 4*5^35 + 5^36 + 4*5^37 + 4*5^38 + 3*5^39 + 4*5^41 + 2*5^42 + 3*5^43 + 2*5^44 + 2*5^48 + 3*5^49 + 4*5^50 + 2*5^51 + 5^52 + 4*5^53 + 4*5^54 + 3*5^55 + 2*5^56 + 3*5^57 + 4*5^58 + 4*5^59 + 5^60 + 3*5^61 + 5^62 + 4*5^63 + 5^65 + 3*5^66 + 2*5^67 + 5^69 + 2*5^70 + 3*5^71 + 3*5^72 + 5^74 + 5^75 + 5^76 + 3*5^77 + 4*5^78 + 4*5^79 + 2*5^80 + 3*5^81 + 5^82 + 5^83 + 4*5^84 + 3*5^85 + 2*5^86 + 3*5^87 + 5^88 + 2*5^89 + 4*5^90 + 4*5^92 + 3*5^93 + 4*5^94 + 3*5^95 + 2*5^96 + 4*5^97 + 4*5^98 + 2*5^99 + O(5^100)</span>
</pre></div>
</div>
<p>Check it works at low precision too:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">padic_E2</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">2 + O(5)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">padic_E2</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">2 + 4*5 + O(5^2)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">padic_E2</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">2 + 4*5 + O(5^3)</span>
</pre></div>
</div>
<p>TODO: With the old(-er), i.e., = sage-2.4 p-adics we got
<span class="math">\(5 + O(5^2)\)</span> as output, i.e., relative precision 1, but
with the newer p-adics we get relative precision 0 and absolute
precision 1.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">padic_E2</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">O(5)</span>
</pre></div>
</div>
<p>Check it works for different models of the same curve (37a), even
when the discriminant changes by a power of p (note that E2 depends
on the differential too, which is why it gets scaled in some of the
examples below):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">X1</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X1</span><span class="o">.</span><span class="n">j_invariant</span><span class="p">(),</span> <span class="n">X1</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go"> (110592/37, 37)</span>
<span class="gp">sage: </span><span class="n">X1</span><span class="o">.</span><span class="n">padic_E2</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go"> 2 + 4*5 + 2*5^3 + 5^4 + 3*5^5 + 2*5^6 + 5^8 + 3*5^9 + O(5^10)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">X2</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X2</span><span class="o">.</span><span class="n">j_invariant</span><span class="p">(),</span> <span class="n">X2</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go"> (110592/37, 37)</span>
<span class="gp">sage: </span><span class="n">X2</span><span class="o">.</span><span class="n">padic_E2</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go"> 2 + 4*5 + 2*5^3 + 5^4 + 3*5^5 + 2*5^6 + 5^8 + 3*5^9 + O(5^10)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">X3</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">4</span><span class="p">),</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">6</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">X3</span><span class="o">.</span><span class="n">j_invariant</span><span class="p">(),</span> <span class="n">X3</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="o">**</span><span class="mi">12</span>
<span class="go"> (110592/37, 37)</span>
<span class="gp">sage: </span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">X3</span><span class="o">.</span><span class="n">padic_E2</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go"> 2 + 4*5 + 2*5^3 + 5^4 + 3*5^5 + 2*5^6 + 5^8 + 3*5^9 + O(5^10)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">X4</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="mi">7</span><span class="o">**</span><span class="mi">4</span><span class="p">),</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="mi">7</span><span class="o">**</span><span class="mi">6</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">X4</span><span class="o">.</span><span class="n">j_invariant</span><span class="p">(),</span> <span class="n">X4</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span> <span class="o">/</span> <span class="mi">7</span><span class="o">**</span><span class="mi">12</span>
<span class="go"> (110592/37, 37)</span>
<span class="gp">sage: </span><span class="mi">7</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">X4</span><span class="o">.</span><span class="n">padic_E2</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go"> 2 + 4*5 + 2*5^3 + 5^4 + 3*5^5 + 2*5^6 + 5^8 + 3*5^9 + O(5^10)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">X5</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="mi">5</span><span class="o">**</span><span class="mi">4</span><span class="p">),</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="mi">5</span><span class="o">**</span><span class="mi">6</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">X5</span><span class="o">.</span><span class="n">j_invariant</span><span class="p">(),</span> <span class="n">X5</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span> <span class="o">/</span> <span class="mi">5</span><span class="o">**</span><span class="mi">12</span>
<span class="go"> (110592/37, 37)</span>
<span class="gp">sage: </span><span class="mi">5</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">X5</span><span class="o">.</span><span class="n">padic_E2</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go"> 2 + 4*5 + 2*5^3 + 5^4 + 3*5^5 + 2*5^6 + 5^8 + 3*5^9 + O(5^10)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">X6</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">5</span><span class="o">**</span><span class="mi">4</span><span class="p">),</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">/</span><span class="p">(</span><span class="mi">5</span><span class="o">**</span><span class="mi">6</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">X6</span><span class="o">.</span><span class="n">j_invariant</span><span class="p">(),</span> <span class="n">X6</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span> <span class="o">*</span> <span class="mi">5</span><span class="o">**</span><span class="mi">12</span>
<span class="go"> (110592/37, 37)</span>
<span class="gp">sage: </span><span class="mi">5</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">X6</span><span class="o">.</span><span class="n">padic_E2</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go"> 2 + 4*5 + 2*5^3 + 5^4 + 3*5^5 + 2*5^6 + 5^8 + 3*5^9 + O(5^10)</span>
</pre></div>
</div>
<p>Test check=True vs check=False:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">padic_E2</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">2 + O(5)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">padic_E2</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">2 + O(5)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">padic_E2</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">2 + 4*5 + 2*5^3 + 5^4 + 3*5^5 + 2*5^6 + 5^8 + 3*5^9 + 4*5^10 + 2*5^11 + 2*5^12 + 2*5^14 + 3*5^15 + 3*5^16 + 3*5^17 + 4*5^18 + 2*5^19 + 4*5^20 + 5^21 + 4*5^22 + 2*5^23 + 3*5^24 + 3*5^26 + 2*5^27 + 3*5^28 + O(5^30)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">padic_E2</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">2 + 4*5 + 2*5^3 + 5^4 + 3*5^5 + 2*5^6 + 5^8 + 3*5^9 + 4*5^10 + 2*5^11 + 2*5^12 + 2*5^14 + 3*5^15 + 3*5^16 + 3*5^17 + 4*5^18 + 2*5^19 + 4*5^20 + 5^21 + 4*5^22 + 2*5^23 + 3*5^24 + 3*5^26 + 2*5^27 + 3*5^28 + O(5^30)</span>
</pre></div>
</div>
<p>Here&#8217;s one using the <span class="math">\(p^{1/2}\)</span> algorithm:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">padic_E2</span><span class="p">(</span><span class="mi">3001</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;sqrtp&quot;</span><span class="p">)</span>
<span class="go">1907 + 2819*3001 + 1124*3001^2 + O(3001^3)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.padics.padic_height">
<tt class="descclassname">sage.schemes.elliptic_curves.padics.</tt><tt class="descname">padic_height</tt><big>(</big><em>self</em>, <em>p</em>, <em>prec=20</em>, <em>sigma=None</em>, <em>check_hypotheses=True</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.padics.padic_height" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the cyclotomic p-adic height.</p>
<p>The equation of the curve must be minimal at <span class="math">\(p\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">p</span></tt> - prime = 5 for which the curve has
semi-stable reduction</li>
<li><tt class="docutils literal"><span class="pre">prec</span></tt> - integer = 1, desired precision of result</li>
<li><tt class="docutils literal"><span class="pre">sigma</span></tt> - precomputed value of sigma. If not
supplied, this function will call padic_sigma to compute it.</li>
<li><tt class="docutils literal"><span class="pre">check_hypotheses</span></tt> - boolean, whether to check
that this is a curve for which the p-adic height makes sense</li>
</ul>
<p>OUTPUT: A function that accepts two parameters:</p>
<ul class="simple">
<li>a Q-rational point on the curve whose height should be computed</li>
<li>optional boolean flag &#8216;check&#8217;: if False, it skips some input
checking, and returns the p-adic height of that point to the
desired precision.</li>
<li>The normalization (sign and a factor 1/2 with respect to some other
normalizations that appear in the literature) is chosen in such a way
as to make the p-adic Birch Swinnerton-Dyer conjecture hold as stated
in [Mazur-Tate-Teitelbaum].</li>
</ul>
<p>AUTHORS:</p>
<ul class="simple">
<li>Jennifer Balakrishnan: original code developed at the 2006 MSRI
graduate workshop on modular forms</li>
<li>David Harvey (2006-09-13): integrated into Sage, optimised to
speed up repeated evaluations of the returned height function,
addressed some thorny precision questions</li>
<li>David Harvey (2006-09-30): rewrote to use division polynomials
for computing denominator of <span class="math">\(nP\)</span>.</li>
<li>David Harvey (2007-02): cleaned up according to algorithms in
&#8220;Efficient Computation of p-adic Heights&#8221;</li>
<li>Chris Wuthrich (2007-05): added supersingular and multiplicative heights</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&quot;37a&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">padic_height</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">h</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">5 + 5^2 + 5^3 + 3*5^6 + 4*5^7 + 5^9 + O(5^10)</span>
</pre></div>
</div>
<p>An anomalous case:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">padic_height</span><span class="p">(</span><span class="mi">53</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">h</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">26*53^-1 + 30 + 20*53 + 47*53^2 + 10*53^3 + 32*53^4 + 9*53^5 + 22*53^6 + 35*53^7 + 30*53^8 + 17*53^9 + O(53^10)</span>
</pre></div>
</div>
<p>Boundary case:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">padic_height</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)(</span><span class="n">P</span><span class="p">)</span>
<span class="go">5 + 5^2 + O(5^3)</span>
</pre></div>
</div>
<p>A case that works the division polynomial code a little harder:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">padic_height</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)(</span><span class="mi">5</span><span class="o">*</span><span class="n">P</span><span class="p">)</span>
<span class="go">5^3 + 5^4 + 5^5 + 3*5^8 + 4*5^9 + O(5^10)</span>
</pre></div>
</div>
<p>Check that answers agree over a range of precisions:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">max_prec</span> <span class="o">=</span> <span class="mi">30</span>    <span class="c"># make sure we get past p^2    # long time</span>
<span class="gp">sage: </span><span class="n">full</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">padic_height</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">max_prec</span><span class="p">)(</span><span class="n">P</span><span class="p">)</span>           <span class="c"># long time</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">prec</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_prec</span><span class="p">):</span>                 <span class="c"># long time</span>
<span class="go">....:     assert E.padic_height(5, prec)(P) == full   # long time</span>
</pre></div>
</div>
<p>A supersingular prime for a curve:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">is_supersingular</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">padic_height</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">h</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">(3 + 3^3 + O(3^6), 2*3^2 + 3^3 + 3^4 + 3^5 + 2*3^6 + O(3^7))</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">padic_regulator</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">5 + 5^2 + 5^3 + 3*5^6 + 4*5^7 + 5^9 + 5^10 + 3*5^11 + 3*5^12 + 5^13 + 4*5^14 + 5^15 + 2*5^16 + 5^17 + 2*5^18 + 4*5^19 + O(5^20)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">padic_regulator</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">(3 + 2*3^2 + 3^3 + O(3^4), 3^2 + 2*3^3 + 3^4 + O(3^5))</span>
</pre></div>
</div>
<p>A torsion point in both the good and supersingular cases:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">torsion_subgroup</span><span class="p">()</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">element</span><span class="p">();</span> <span class="n">P</span>
<span class="go">(5 : 5 : 1)</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">padic_height</span><span class="p">(</span><span class="mi">19</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">h</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">padic_height</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">h</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>The result is not dependent on the model for the curve:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">^</span><span class="mi">12</span><span class="o">*</span><span class="mi">17</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Em</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">minimal_model</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">Pm</span> <span class="o">=</span> <span class="n">Em</span><span class="o">.</span><span class="n">gens</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">padic_height</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">hm</span> <span class="o">=</span> <span class="n">Em</span><span class="o">.</span><span class="n">padic_height</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">h</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">==</span> <span class="n">hm</span><span class="p">(</span><span class="n">Pm</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.padics.padic_height_pairing_matrix">
<tt class="descclassname">sage.schemes.elliptic_curves.padics.</tt><tt class="descname">padic_height_pairing_matrix</tt><big>(</big><em>self</em>, <em>p</em>, <em>prec=20</em>, <em>height=None</em>, <em>check_hypotheses=True</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.padics.padic_height_pairing_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the cyclotomic <span class="math">\(p\)</span>-adic height pairing matrix of
this curve with respect to the basis self.gens() for the
Mordell-Weil group for a given odd prime p of good ordinary
reduction.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">p</span></tt> - prime = 5</li>
<li><tt class="docutils literal"><span class="pre">prec</span></tt> - answer will be returned modulo
<span class="math">\(p^{\mathrm{prec}}\)</span></li>
<li><tt class="docutils literal"><span class="pre">height</span></tt> - precomputed height function. If not
supplied, this function will call padic_height to compute it.</li>
<li><tt class="docutils literal"><span class="pre">check_hypotheses</span></tt> - boolean, whether to check
that this is a curve for which the p-adic height makes sense</li>
</ul>
<p>OUTPUT: The p-adic cyclotomic height pairing matrix of this curve
to the given precision.</p>
<p>TODO: - remove restriction that curve must be in minimal
Weierstrass form. This is currently required for E.gens().</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>David Harvey, Liang Xiao, Robert Bradshaw, Jennifer
Balakrishnan: original implementation at the 2006 MSRI graduate
workshop on modular forms</li>
<li>David Harvey (2006-09-13): cleaned up and integrated into Sage,
removed some redundant height computations</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&quot;37a&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">padic_height_pairing_matrix</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">[5 + 5^2 + 5^3 + 3*5^6 + 4*5^7 + 5^9 + O(5^10)]</span>
</pre></div>
</div>
<p>A rank two example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">_set_gens</span><span class="p">([</span><span class="n">e</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">e</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>  <span class="c"># avoid platform dependent gens</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">padic_height_pairing_matrix</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[                      3*5 + 2*5^2 + 5^4 + 5^5 + 5^7 + 4*5^9 + O(5^10) 5 + 4*5^2 + 5^3 + 2*5^4 + 3*5^5 + 4*5^6 + 5^7 + 5^8 + 2*5^9 + O(5^10)]</span>
<span class="go">[5 + 4*5^2 + 5^3 + 2*5^4 + 3*5^5 + 4*5^6 + 5^7 + 5^8 + 2*5^9 + O(5^10)                         4*5 + 2*5^4 + 3*5^6 + 4*5^7 + 4*5^8 + O(5^10)]</span>
</pre></div>
</div>
<p>An anomalous rank 3 example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&quot;5077a&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">_set_gens</span><span class="p">([</span><span class="n">e</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">e</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">e</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">padic_height_pairing_matrix</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="go">[4 + 3*5 + 4*5^2 + 4*5^3 + O(5^4)       4 + 4*5^2 + 2*5^3 + O(5^4)       3*5 + 4*5^2 + 5^3 + O(5^4)]</span>
<span class="go">[      4 + 4*5^2 + 2*5^3 + O(5^4)   3 + 4*5 + 3*5^2 + 5^3 + O(5^4)                 2 + 4*5 + O(5^4)]</span>
<span class="go">[      3*5 + 4*5^2 + 5^3 + O(5^4)                 2 + 4*5 + O(5^4)     1 + 3*5 + 5^2 + 5^3 + O(5^4)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.padics.padic_height_via_multiply">
<tt class="descclassname">sage.schemes.elliptic_curves.padics.</tt><tt class="descname">padic_height_via_multiply</tt><big>(</big><em>self</em>, <em>p</em>, <em>prec=20</em>, <em>E2=None</em>, <em>check_hypotheses=True</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.padics.padic_height_via_multiply" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the cyclotomic p-adic height.</p>
<p>The equation of the curve must be minimal at <span class="math">\(p\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">p</span></tt> - prime = 5 for which the curve has good
ordinary reduction</li>
<li><tt class="docutils literal"><span class="pre">prec</span></tt> - integer = 2, desired precision of result</li>
<li><tt class="docutils literal"><span class="pre">E2</span></tt> - precomputed value of E2. If not supplied,
this function will call padic_E2 to compute it. The value supplied
must be correct mod <span class="math">\(p^(prec-2)\)</span> (or slightly higher in the
anomalous case; see the code for details).</li>
<li><tt class="docutils literal"><span class="pre">check_hypotheses</span></tt> - boolean, whether to check
that this is a curve for which the p-adic height makes sense</li>
</ul>
<p>OUTPUT: A function that accepts two parameters:</p>
<ul class="simple">
<li>a Q-rational point on the curve whose height should be computed</li>
<li>optional boolean flag &#8216;check&#8217;: if False, it skips some input
checking, and returns the p-adic height of that point to the
desired precision.</li>
<li>The normalization (sign and a factor 1/2 with respect to some other
normalizations that appear in the literature) is chosen in such a way
as to make the p-adic Birch Swinnerton-Dyer conjecture hold as stated
in [Mazur-Tate-Teitelbaum].</li>
</ul>
<p>AUTHORS:</p>
<ul class="simple">
<li>David Harvey (2008-01): based on the padic_height() function,
using the algorithm of&#8221;Computing p-adic heights via
point multiplication&#8221;</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&quot;37a&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">padic_height_via_multiply</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">h</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">5 + 5^2 + 5^3 + 3*5^6 + 4*5^7 + 5^9 + O(5^10)</span>
</pre></div>
</div>
<p>An anomalous case:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">padic_height_via_multiply</span><span class="p">(</span><span class="mi">53</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">h</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">26*53^-1 + 30 + 20*53 + 47*53^2 + 10*53^3 + 32*53^4 + 9*53^5 + 22*53^6 + 35*53^7 + 30*53^8 + 17*53^9 + O(53^10)</span>
</pre></div>
</div>
<p>Supply the value of E2 manually:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">padic_E2</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E2</span>
<span class="go">2 + 4*5 + 2*5^3 + 5^4 + 3*5^5 + 2*5^6 + O(5^8)</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">padic_height_via_multiply</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">E2</span><span class="o">=</span><span class="n">E2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">h</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">5 + 5^2 + 5^3 + 3*5^6 + 4*5^7 + 5^9 + O(5^10)</span>
</pre></div>
</div>
<p>Boundary case:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">padic_height_via_multiply</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)(</span><span class="n">P</span><span class="p">)</span>
<span class="go">5 + 5^2 + O(5^3)</span>
</pre></div>
</div>
<p>Check that answers agree over a range of precisions:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">max_prec</span> <span class="o">=</span> <span class="mi">30</span>    <span class="c"># make sure we get past p^2    # long time</span>
<span class="gp">sage: </span><span class="n">full</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">padic_height</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">max_prec</span><span class="p">)(</span><span class="n">P</span><span class="p">)</span>           <span class="c"># long time</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">prec</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">max_prec</span><span class="p">):</span>                 <span class="c"># long time</span>
<span class="go">....:     assert E.padic_height_via_multiply(5, prec)(P) == full   # long time</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.padics.padic_lseries">
<tt class="descclassname">sage.schemes.elliptic_curves.padics.</tt><tt class="descname">padic_lseries</tt><big>(</big><em>self</em>, <em>p</em>, <em>normalize='L_ratio'</em>, <em>use_eclib=True</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.padics.padic_lseries" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <span class="math">\(p\)</span>-adic <span class="math">\(L\)</span>-series of self at
<span class="math">\(p\)</span>, which is an object whose approx method computes
approximation to the true <span class="math">\(p\)</span>-adic <span class="math">\(L\)</span>-series to
any desired precision.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">p</span></tt> - prime</li>
<li><tt class="docutils literal"><span class="pre">use_eclib</span></tt> - bool (default:True); whether or not to use
John Cremona&#8217;s eclib for the computation of modular
symbols</li>
<li><tt class="docutils literal"><span class="pre">normalize</span></tt> -  &#8216;L_ratio&#8217; (default), &#8216;period&#8217; or &#8216;none&#8217;;
this is describes the way the modular symbols
are normalized. See modular_symbol for
more details.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">padic_lseries</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span> <span class="n">L</span>
<span class="go">5-adic L-series of Elliptic Curve defined by y^2 + y = x^3 - x over Rational Field</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.padic_lseries.pAdicLseriesOrdinary&#39;&gt;</span>
</pre></div>
</div>
<p>We compute the <span class="math">\(3\)</span>-adic <span class="math">\(L\)</span>-series of two curves of
rank <span class="math">\(0\)</span> and in each case verify the interpolation property
for their leading coefficient (i.e., value at 0):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ms</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">modular_symbol</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">ms</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">11</span><span class="p">),</span> <span class="n">ms</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="n">ms</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">ms</span><span class="p">(</span><span class="n">oo</span><span class="p">)]</span>
<span class="go">[0, -3/10, 1/5, 0]</span>
<span class="gp">sage: </span><span class="n">ms</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">1/5</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">padic_lseries</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">2 + 3 + 3^2 + 2*3^3 + 2*3^5 + 3^6 + O(3^7)</span>
<span class="gp">sage: </span><span class="n">alpha</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">alpha</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span> <span class="n">alpha</span>
<span class="go">2 + 3^2 + 2*3^3 + 2*3^4 + 2*3^6 + 3^8 + O(3^9)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">e</span><span class="o">.</span><span class="n">ap</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
<span class="go">O(3^9)</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">lseries</span><span class="p">()</span><span class="o">.</span><span class="n">L_ratio</span><span class="p">();</span> <span class="n">r</span>
<span class="go">1/5</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="n">r</span>
<span class="go">2 + 3 + 3^2 + 2*3^3 + 2*3^5 + 3^6 + 3^7 + O(3^9)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">2 + 3 + 3^2 + 2*3^3 + 2*3^5 + 3^6 + O(3^7)</span>
</pre></div>
</div>
<p>Next consider the curve 37b:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37b&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">padic_lseries</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">alpha</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">alpha</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span> <span class="n">alpha</span>
<span class="go">1 + 2*3 + 3^2 + 2*3^5 + 2*3^7 + 3^8 + O(3^9)</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">lseries</span><span class="p">()</span><span class="o">.</span><span class="n">L_ratio</span><span class="p">();</span> <span class="n">r</span>
<span class="go">1/3</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="n">r</span>
<span class="go">3 + 3^2 + 2*3^4 + 2*3^5 + 2*3^6 + 3^7 + O(3^9)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">3 + 3^2 + 2*3^4 + 2*3^5 + O(3^6)</span>
</pre></div>
</div>
<p>We can use Sage modular symbols instead to compute the <span class="math">\(L\)</span>-series:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">padic_lseries</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">use_eclib</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">prec</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">2 + 3 + 3^2 + 2*3^3 + 2*3^5 + 3^6 + O(3^7) + (1 + 3 + 2*3^2 + 3^3 + O(3^4))*T + (1 + 2*3 + O(3^4))*T^2 + (3 + 2*3^2 + O(3^3))*T^3 + (2*3 + 3^2 + O(3^3))*T^4 + (2 + 2*3 + 2*3^2 + O(3^3))*T^5 + (1 + 3^2 + O(3^3))*T^6 + (2 + 3^2 + O(3^3))*T^7 + (2 + 2*3 + 2*3^2 + O(3^3))*T^8 + (2 + O(3^2))*T^9 + O(T^10)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.padics.padic_regulator">
<tt class="descclassname">sage.schemes.elliptic_curves.padics.</tt><tt class="descname">padic_regulator</tt><big>(</big><em>self</em>, <em>p</em>, <em>prec=20</em>, <em>height=None</em>, <em>check_hypotheses=True</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.padics.padic_regulator" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the cyclotomic <span class="math">\(p\)</span>-adic regulator of this curve.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">p</span></tt> - prime = 5</li>
<li><tt class="docutils literal"><span class="pre">prec</span></tt> - answer will be returned modulo
<span class="math">\(p^{\mathrm{prec}}\)</span></li>
<li><tt class="docutils literal"><span class="pre">height</span></tt> - precomputed height function. If not
supplied, this function will call padic_height to compute it.</li>
<li><tt class="docutils literal"><span class="pre">check_hypotheses</span></tt> - boolean, whether to check
that this is a curve for which the p-adic height makes sense</li>
</ul>
<p>OUTPUT: The p-adic cyclotomic regulator of this curve, to the
requested precision.</p>
<p>If the rank is 0, we output 1.</p>
<p>TODO: - remove restriction that curve must be in minimal
Weierstrass form. This is currently required for E.gens().</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>Liang Xiao: original implementation at the 2006 MSRI
graduate workshop on modular forms</li>
<li>David Harvey (2006-09-13): cleaned up and integrated into Sage,
removed some redundant height computations</li>
<li>Chris Wuthrich (2007-05-22): added multiplicative and
supersingular cases</li>
<li>David Harvey (2007-09-20): fixed some precision loss that was
occurring</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&quot;37a&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">padic_regulator</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">5 + 5^2 + 5^3 + 3*5^6 + 4*5^7 + 5^9 + O(5^10)</span>
</pre></div>
</div>
<p>An anomalous case:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">padic_regulator</span><span class="p">(</span><span class="mi">53</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">26*53^-1 + 30 + 20*53 + 47*53^2 + 10*53^3 + 32*53^4 + 9*53^5 + 22*53^6 + 35*53^7 + 30*53^8 + O(53^9)</span>
</pre></div>
</div>
<p>An anomalous case where the precision drops some:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&quot;5077a&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">padic_regulator</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">5 + 5^2 + 4*5^3 + 2*5^4 + 2*5^5 + 2*5^6 + 4*5^7 + 2*5^8 + 5^9 + O(5^10)</span>
</pre></div>
</div>
<p>Check that answers agree over a range of precisions:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">max_prec</span> <span class="o">=</span> <span class="mi">30</span>    <span class="c"># make sure we get past p^2    # long time</span>
<span class="gp">sage: </span><span class="n">full</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">padic_regulator</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">max_prec</span><span class="p">)</span>           <span class="c"># long time</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">prec</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_prec</span><span class="p">):</span>                 <span class="c"># long time</span>
<span class="go">....:     assert E.padic_regulator(5, prec) == full   # long time</span>
</pre></div>
</div>
<p>A case where the generator belongs to the formal group already
(trac #3632):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">37</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">padic_regulator</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="go">2*5^2 + 2*5^3 + 5^4 + 5^5 + 4*5^6 + 3*5^8 + 4*5^9 + O(5^10)</span>
</pre></div>
</div>
<p>The result is not dependent on the model for the curve:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">^</span><span class="mi">12</span><span class="o">*</span><span class="mi">17</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Em</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">minimal_model</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">padic_regulator</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">==</span> <span class="n">Em</span><span class="o">.</span><span class="n">padic_regulator</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Allow a Python int as input:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">padic_regulator</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">5 + 5^2 + 5^3 + 3*5^6 + 4*5^7 + 5^9 + 5^10 + 3*5^11 + 3*5^12 + 5^13 + 4*5^14 + 5^15 + 2*5^16 + 5^17 + 2*5^18 + 4*5^19 + O(5^20)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.padics.padic_sigma">
<tt class="descclassname">sage.schemes.elliptic_curves.padics.</tt><tt class="descname">padic_sigma</tt><big>(</big><em>self</em>, <em>p</em>, <em>N=20</em>, <em>E2=None</em>, <em>check=False</em>, <em>check_hypotheses=True</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.padics.padic_sigma" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the p-adic sigma function with respect to the standard
invariant differential <span class="math">\(dx/(2y + a_1 x + a_3)\)</span>, as
defined by Mazur and Tate, as a power series in the usual
uniformiser <span class="math">\(t\)</span> at the origin.</p>
<p>The equation of the curve must be minimal at <span class="math">\(p\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">p</span></tt> - prime = 5 for which the curve has good
ordinary reduction</li>
<li><tt class="docutils literal"><span class="pre">N</span></tt> - integer = 1, indicates precision of result;
see OUTPUT section for description</li>
<li><tt class="docutils literal"><span class="pre">E2</span></tt> - precomputed value of E2. If not supplied,
this function will call padic_E2 to compute it. The value supplied
must be correct mod <span class="math">\(p^{N-2}\)</span>.</li>
<li><tt class="docutils literal"><span class="pre">check</span></tt> - boolean, whether to perform a
consistency check (i.e. verify that the computed sigma satisfies
the defining</li>
<li><tt class="docutils literal"><span class="pre">differential</span> <span class="pre">equation</span></tt> - note that this does NOT
guarantee correctness of all the returned digits, but it comes
pretty close :-))</li>
<li><tt class="docutils literal"><span class="pre">check_hypotheses</span></tt> - boolean, whether to check
that this is a curve for which the p-adic sigma function makes
sense</li>
</ul>
<p>OUTPUT: A power series <span class="math">\(t + \cdots\)</span> with coefficients in
<span class="math">\(\ZZ_p\)</span>.</p>
<p>The output series will be truncated at <span class="math">\(O(t^{N+1})\)</span>, and
the coefficient of <span class="math">\(t^n\)</span> for <span class="math">\(n \geq 1\)</span> will be
correct to precision <span class="math">\(O(p^{N-n+1})\)</span>.</p>
<p>In practice this means the following. If <span class="math">\(t_0 = p^k u\)</span>,
where <span class="math">\(u\)</span> is a <span class="math">\(p\)</span>-adic unit with at least
<span class="math">\(N\)</span> digits of precision, and <span class="math">\(k \geq 1\)</span>, then the
returned series may be used to compute <span class="math">\(\sigma(t_0)\)</span>
correctly modulo <span class="math">\(p^{N+k}\)</span> (i.e. with <span class="math">\(N\)</span> correct
<span class="math">\(p\)</span>-adic digits).</p>
<p>ALGORITHM: Described in &#8220;Efficient Computation of p-adic Heights&#8221;
(David Harvey), which is basically an optimised version of the
algorithm from &#8220;p-adic Heights and Log Convergence&#8221; (Mazur, Stein,
Tate).</p>
<p>Running time is soft-<span class="math">\(O(N^2 \log p)\)</span>, plus whatever time is
necessary to compute <span class="math">\(E_2\)</span>.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>David Harvey (2006-09-12)</li>
<li>David Harvey (2007-02): rewrote</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">padic_sigma</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">O(5^11) + (1 + O(5^10))*t + O(5^9)*t^2 + (3 + 2*5^2 + 3*5^3 + 3*5^6 + 4*5^7 + O(5^8))*t^3 + O(5^7)*t^4 + (2 + 4*5^2 + 4*5^3 + 5^4 + 5^5 + O(5^6))*t^5 + O(5^5)*t^6 + (2 + 2*5 + 5^2 + 4*5^3 + O(5^4))*t^7 + O(5^3)*t^8 + (1 + 2*5 + O(5^2))*t^9 + O(5)*t^10 + O(t^11)</span>
</pre></div>
</div>
<p>Run it with a consistency check:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&quot;37a&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">padic_sigma</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">O(5^11) + (1 + O(5^10))*t + O(5^9)*t^2 + (3 + 2*5^2 + 3*5^3 + 3*5^6 + 4*5^7 + O(5^8))*t^3 + (3 + 2*5 + 2*5^2 + 2*5^3 + 2*5^4 + 2*5^5 + 2*5^6 + O(5^7))*t^4 + (2 + 4*5^2 + 4*5^3 + 5^4 + 5^5 + O(5^6))*t^5 + (2 + 3*5 + 5^4 + O(5^5))*t^6 + (4 + 3*5 + 2*5^2 + O(5^4))*t^7 + (2 + 3*5 + 2*5^2 + O(5^3))*t^8 + (4*5 + O(5^2))*t^9 + (1 + O(5))*t^10 + O(t^11)</span>
</pre></div>
</div>
<p>Boundary cases:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">padic_sigma</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go"> (1 + O(5))*t + O(t^2)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">padic_sigma</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go"> (1 + O(5^2))*t + (3 + O(5))*t^2 + O(t^3)</span>
</pre></div>
</div>
<p>Supply your very own value of E2:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&quot;37a&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">my_E2</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">padic_E2</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">my_E2</span> <span class="o">=</span> <span class="n">my_E2</span> <span class="o">+</span> <span class="mi">5</span><span class="o">**</span><span class="mi">5</span>    <span class="c"># oops!!!</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">padic_sigma</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">E2</span><span class="o">=</span><span class="n">my_E2</span><span class="p">)</span>
<span class="go">O(5^11) + (1 + O(5^10))*t + O(5^9)*t^2 + (3 + 2*5^2 + 3*5^3 + 4*5^5 + 2*5^6 + 3*5^7 + O(5^8))*t^3 + (3 + 2*5 + 2*5^2 + 2*5^3 + 2*5^4 + 2*5^5 + 2*5^6 + O(5^7))*t^4 + (2 + 4*5^2 + 4*5^3 + 5^4 + 3*5^5 + O(5^6))*t^5 + (2 + 3*5 + 5^4 + O(5^5))*t^6 + (4 + 3*5 + 2*5^2 + O(5^4))*t^7 + (2 + 3*5 + 2*5^2 + O(5^3))*t^8 + (4*5 + O(5^2))*t^9 + (1 + O(5))*t^10 + O(t^11)</span>
</pre></div>
</div>
<p>Check that sigma is &#8220;weight 1&#8221;.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">padic_sigma</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">4</span><span class="p">),</span> <span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">6</span><span class="p">)])</span><span class="o">.</span><span class="n">padic_sigma</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="go">(1 + O(5^10))*t + (4 + 3*5 + 3*5^2 + 3*5^3 + 4*5^4 + 4*5^5 + 3*5^6 + 5^7 + O(5^8))*t^3 + (3 + 3*5^2 + 5^4 + 2*5^5 + O(5^6))*t^5 + (4 + 5 + 3*5^3 + O(5^4))*t^7 + (4 + 2*5 + O(5^2))*t^9 + O(5)*t^10 + O(t^11)</span>
<span class="gp">sage: </span><span class="n">g</span>
<span class="go">O(5^11) + (1 + O(5^10))*t + O(5^9)*t^2 + (4 + 3*5 + 3*5^2 + 3*5^3 + 4*5^4 + 4*5^5 + 3*5^6 + 5^7 + O(5^8))*t^3 + O(5^7)*t^4 + (3 + 3*5^2 + 5^4 + 2*5^5 + O(5^6))*t^5 + O(5^5)*t^6 + (4 + 5 + 3*5^3 + O(5^4))*t^7 + O(5^3)*t^8 + (4 + 2*5 + O(5^2))*t^9 + O(5)*t^10 + O(t^11)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span><span class="n">g</span>
<span class="go">O(t^11)</span>
</pre></div>
</div>
<p>Test that it returns consistent results over a range of precision:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">max_N</span> <span class="o">=</span> <span class="mi">30</span>   <span class="c"># get up to at least p^2         # long time</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>            <span class="c"># long time</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">5</span>                                         <span class="c"># long time</span>
<span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">padic_E2</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">max_N</span><span class="p">)</span>                     <span class="c"># long time</span>
<span class="gp">sage: </span><span class="n">max_sigma</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">padic_sigma</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">max_N</span><span class="p">,</span> <span class="n">E2</span><span class="o">=</span><span class="n">E2</span><span class="p">)</span>    <span class="c"># long time</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">max_N</span><span class="p">):</span>                     <span class="c"># long time</span>
<span class="go">....:    sigma = E.padic_sigma(p, N, E2=E2)         # long time</span>
<span class="go">....:    assert sigma == max_sigma</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.padics.padic_sigma_truncated">
<tt class="descclassname">sage.schemes.elliptic_curves.padics.</tt><tt class="descname">padic_sigma_truncated</tt><big>(</big><em>self</em>, <em>p</em>, <em>N=20</em>, <em>lamb=0</em>, <em>E2=None</em>, <em>check_hypotheses=True</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.padics.padic_sigma_truncated" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the p-adic sigma function with respect to the standard
invariant differential <span class="math">\(dx/(2y + a_1 x + a_3)\)</span>, as
defined by Mazur and Tate, as a power series in the usual
uniformiser <span class="math">\(t\)</span> at the origin.</p>
<p>The equation of the curve must be minimal at <span class="math">\(p\)</span>.</p>
<p>This function differs from padic_sigma() in the precision profile
of the returned power series; see OUTPUT below.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">p</span></tt> - prime = 5 for which the curve has good
ordinary reduction</li>
<li><tt class="docutils literal"><span class="pre">N</span></tt> - integer = 2, indicates precision of result;
see OUTPUT section for description</li>
<li><tt class="docutils literal"><span class="pre">lamb</span></tt> - integer = 0, see OUTPUT section for
description</li>
<li><tt class="docutils literal"><span class="pre">E2</span></tt> - precomputed value of E2. If not supplied,
this function will call padic_E2 to compute it. The value supplied
must be correct mod <span class="math">\(p^{N-2}\)</span>.</li>
<li><tt class="docutils literal"><span class="pre">check_hypotheses</span></tt> - boolean, whether to check
that this is a curve for which the p-adic sigma function makes
sense</li>
</ul>
<p>OUTPUT: A power series <span class="math">\(t + \cdots\)</span> with coefficients in
<span class="math">\(\ZZ_p\)</span>.</p>
<p>The coefficient of <span class="math">\(t^j\)</span> for <span class="math">\(j \geq 1\)</span> will be
correct to precision <span class="math">\(O(p^{N - 2 + (3 - j)(lamb + 1)})\)</span>.</p>
<p>ALGORITHM: Described in &#8220;Efficient Computation of p-adic Heights&#8221;
(David Harvey, to appear in LMS JCM), which is basically an
optimised version of the algorithm from &#8220;p-adic Heights and Log
Convergence&#8221; (Mazur, Stein, Tate), and &#8220;Computing p-adic heights
via point multiplication&#8221; (David Harvey, still draft form).</p>
<p>Running time is soft-<span class="math">\(O(N^2 \lambda^{-1} \log p)\)</span>, plus
whatever time is necessary to compute <span class="math">\(E_2\)</span>.</p>
<p>AUTHOR:</p>
<ul class="simple">
<li>David Harvey (2008-01): wrote based on previous
padic_sigma function</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">padic_sigma_truncated</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">O(5^11) + (1 + O(5^10))*t + O(5^9)*t^2 + (3 + 2*5^2 + 3*5^3 + 3*5^6 + 4*5^7 + O(5^8))*t^3 + O(5^7)*t^4 + (2 + 4*5^2 + 4*5^3 + 5^4 + 5^5 + O(5^6))*t^5 + O(5^5)*t^6 + (2 + 2*5 + 5^2 + 4*5^3 + O(5^4))*t^7 + O(5^3)*t^8 + (1 + 2*5 + O(5^2))*t^9 + O(5)*t^10 + O(t^11)</span>
</pre></div>
</div>
<p>Note the precision of the <span class="math">\(t^3\)</span> coefficient depends only on
<span class="math">\(N\)</span>, not on lamb:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">padic_sigma_truncated</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">lamb</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">O(5^17) + (1 + O(5^14))*t + O(5^11)*t^2 + (3 + 2*5^2 + 3*5^3 + 3*5^6 + 4*5^7 + O(5^8))*t^3 + O(5^5)*t^4 + (2 + O(5^2))*t^5 + O(t^6)</span>
</pre></div>
</div>
<p>Compare against plain padic_sigma() function over a dense range of
N and lamb</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>                            <span class="c"># long time</span>
<span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">padic_E2</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>                                        <span class="c"># long time</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>                                        <span class="c"># long time</span>
<span class="go">....:    for lamb in range(10):                                     # long time</span>
<span class="go">....:       correct = E.padic_sigma(5, N + 3*lamb, E2=E2)           # long time</span>
<span class="go">....:       compare = E.padic_sigma_truncated(5, N=N, lamb=lamb, E2=E2)    # long time</span>
<span class="go">....:       assert compare == correct                               # long time</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="ell_tate_curve.html"
                                  title="previous chapter">Tate&#8217;s parametrisation of <span class="math">\(p\)</span>-adic curves with multiplicative reduction</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="ell_wp.html"
                                  title="next chapter">Weierstrass <span class="math">\(\wp\)</span>-function for elliptic curves</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../_sources/sage/schemes/elliptic_curves/padics.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ell_wp.html" title="Weierstrass \(\wp\)-function for elliptic curves"
             >next</a> |</li>
        <li class="right" >
          <a href="ell_tate_curve.html" title="Tate’s parametrisation of \(p\)-adic curves with multiplicative reduction"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../../index.html">Plane curves</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer">
        &copy; Copyright 2005--2015, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>