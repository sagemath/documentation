<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Heegner points on elliptic curves over the rational numbers &mdash; Sage Reference Manual v7.0: Plane curves</title>
    
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '7.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v7.0: Plane curves" href="../../../index.html" />
    <link rel="next" title="p-adic L-functions of elliptic curves" href="padic_lseries.html" />
    <link rel="prev" title="L-series for elliptic curves" href="lseries_ell.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="padic_lseries.html" title="p-adic L-functions of elliptic curves"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="lseries_ell.html" title="L-series for elliptic curves"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../../index.html">Plane curves</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="heegner-points-on-elliptic-curves-over-the-rational-numbers">
<span id="sage-schemes-elliptic-curves-heegner"></span><h1>Heegner points on elliptic curves over the rational numbers<a class="headerlink" href="#heegner-points-on-elliptic-curves-over-the-rational-numbers" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.schemes.elliptic_curves.heegner"></span><p>AUTHORS:</p>
<blockquote>
<div><ul class="simple">
<li>William Stein (August 2009)&#8211; most of the initial version</li>
<li>Robert Bradshaw (July 2009) &#8211; an early version of some specific code</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;433a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">point_exact</span><span class="p">(</span><span class="mi">201</span><span class="p">);</span> <span class="n">z</span>
<span class="go">(-4/3 : 1/27*a - 4/27 : 1)</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="go">Abelian group of points on Elliptic Curve defined by y^2 + x*y = x^3 + 1 over Number Field in a with defining polynomial x^2 - 44*x + 1159</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">-3</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">quadratic_twist</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(Fractional ideal (1/2*a + 1)) * (Fractional ideal (-1/2*a + 1))</span>
</pre></div>
</div>
<p>Next try an inert prime:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Fractional ideal (5)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">point_exact</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(x^6 + x^5 - 1/4*x^4 + 19/10*x^3 + 31/20*x^2 - 7/10*x + 49/100)^2</span>
<span class="gp">sage: </span><span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">x^12 - x^11 + 6/5*x^10 - 33/40*x^9 - 89/320*x^8 + 3287/800*x^7 - 5273/1600*x^6 + 993/4000*x^5 + 823/320*x^4 - 2424/625*x^3 + 12059/12500*x^2 + 3329/25000*x + 123251/250000</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">x_poly_exact</span><span class="p">(</span><span class="mi">300</span><span class="p">);</span> <span class="n">f</span>
<span class="go">x^6 + x^5 - 1/4*x^4 + 19/10*x^3 + 31/20*x^2 - 7/10*x + 49/100</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">-1 * 2^-9 * 5^-9 * 7^2 * 281^2 * 1021^2</span>
</pre></div>
</div>
<p>We find some Mordell-Weil generators in the rank 1 case using Heegner points:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;43a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">x_poly_exact</span><span class="p">()</span>
<span class="go">x</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">point_exact</span><span class="p">()</span>
<span class="go">(0 : 0 : 1)</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;997a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_discriminants_list</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[-19, -23, -31, -35, -39, -40, -52, -55, -56, -59]</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">19</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">x_poly_exact</span><span class="p">()</span>
<span class="go">x - 141/49</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">point_exact</span><span class="p">()</span>
<span class="go">(141/49 : -162/343 : 1)</span>
</pre></div>
</div>
<p>Here we find that the Heegner point generates a subgroup of index 3:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;92b1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_discriminants_list</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[-7]</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">);</span> <span class="n">z</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">point_exact</span><span class="p">();</span> <span class="n">z</span>
<span class="go">(0 : 1 : 1)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator</span><span class="p">()</span>
<span class="go">0.0498083972980648</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">0.448275575682583</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span> <span class="n">P</span> <span class="c"># a generator</span>
<span class="go">(1 : 1 : 1)</span>
<span class="gp">sage: </span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">P</span>
<span class="go">(0 : 1 : 1)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">tamagawa_product</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
<p>The above is consistent with the following analytic computation:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_index</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">3.0000?</span>
</pre></div>
</div>
<dl class="class">
<dt id="sage.schemes.elliptic_curves.heegner.GaloisAutomorphism">
<em class="property">class </em><tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">GaloisAutomorphism</tt><big>(</big><em>parent</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphism" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Sage Reference Manual: Basic Structures v7.0)"><tt class="xref py py-class docutils literal"><span class="pre">sage.structure.sage_object.SageObject</span></tt></a></p>
<p>An abstract automorphism of a ring class field.</p>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">make <a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphism" title="sage.schemes.elliptic_curves.heegner.GaloisAutomorphism"><tt class="xref py py-class docutils literal"><span class="pre">GaloisAutomorphism</span></tt></a> derive from GroupElement, so
that one gets powers for free, etc.</p>
</div>
<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.GaloisAutomorphism.domain">
<tt class="descname">domain</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphism.domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the domain of this automorphism.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">galois_group</span><span class="p">()</span><span class="o">.</span><span class="n">complex_conjugation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span>
<span class="go">Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.GaloisAutomorphism.parent">
<tt class="descname">parent</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphism.parent" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the parent of this automorphism, which is a Galois
group of a ring class field.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">galois_group</span><span class="p">()</span><span class="o">.</span><span class="n">complex_conjugation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Galois group of Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.elliptic_curves.heegner.GaloisAutomorphismComplexConjugation">
<em class="property">class </em><tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">GaloisAutomorphismComplexConjugation</tt><big>(</big><em>parent</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphismComplexConjugation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphism" title="sage.schemes.elliptic_curves.heegner.GaloisAutomorphism"><tt class="xref py py-class docutils literal"><span class="pre">sage.schemes.elliptic_curves.heegner.GaloisAutomorphism</span></tt></a></p>
<p>The complex conjugation automorphism of a ring class field.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">conj</span> <span class="o">=</span> <span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">galois_group</span><span class="p">()</span><span class="o">.</span><span class="n">complex_conjugation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">conj</span>
<span class="go">Complex conjugation automorphism of Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
<span class="gp">sage: </span><span class="n">conj</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span>
<span class="go">Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">conj</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.heegner.GaloisAutomorphismComplexConjugation&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">conj</span><span class="p">))</span> <span class="o">==</span> <span class="n">conj</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.GaloisAutomorphismComplexConjugation.order">
<tt class="descname">order</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphismComplexConjugation.order" title="Permalink to this definition">¶</a></dt>
<dd><p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">conj</span> <span class="o">=</span> <span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">galois_group</span><span class="p">()</span><span class="o">.</span><span class="n">complex_conjugation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">conj</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm">
<em class="property">class </em><tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">GaloisAutomorphismQuadraticForm</tt><big>(</big><em>parent</em>, <em>quadratic_form</em>, <em>alpha=None</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphism" title="sage.schemes.elliptic_curves.heegner.GaloisAutomorphism"><tt class="xref py py-class docutils literal"><span class="pre">sage.schemes.elliptic_curves.heegner.GaloisAutomorphism</span></tt></a></p>
<p>An automorphism of a ring class field defined by a quadratic form.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sigma</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">())[</span><span class="mi">0</span><span class="p">];</span> <span class="n">sigma</span>
<span class="go">Class field automorphism defined by x^2 + 45*y^2</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">sigma</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">sigma</span><span class="p">))</span> <span class="o">==</span> <span class="n">sigma</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm.alpha">
<tt class="descname">alpha</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm.alpha" title="Permalink to this definition">¶</a></dt>
<dd><p>Optional data that specified element corresponding element of
<span class="math">\((\mathcal{O}_K / c\mathcal{O}_K)^* / (\ZZ/c\ZZ)^*\)</span>, via class
field theory.</p>
<p>This is a generator of the ideal corresponding to this
automorphism.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K3</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K1</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">K3</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">orb</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">g</span><span class="o">.</span><span class="n">alpha</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">G</span><span class="p">]);</span> <span class="n">orb</span> <span class="c"># random (the sign depends on the database being installed or not)</span>
<span class="go">[1, 1/2*sqrt_minus_52 + 1, -1/2*sqrt_minus_52, 1/2*sqrt_minus_52 - 1]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">orb</span><span class="p">])</span> <span class="c"># this is just for testing</span>
<span class="go">[-13, -sqrt_minus_52 - 12, sqrt_minus_52 - 12, 1]</span>

<span class="gp">sage: </span><span class="n">K5</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K1</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">K5</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">orb</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">g</span><span class="o">.</span><span class="n">alpha</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">G</span><span class="p">]);</span> <span class="n">orb</span> <span class="c"># random (the sign depends on the database being installed or not)</span>
<span class="go">[1, -1/2*sqrt_minus_52, 1/2*sqrt_minus_52 + 1, 1/2*sqrt_minus_52 - 1, 1/2*sqrt_minus_52 - 2, -1/2*sqrt_minus_52 - 2]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">orb</span><span class="p">])</span> <span class="c"># just for testing</span>
<span class="go">[-13, -sqrt_minus_52 - 12, sqrt_minus_52 - 12, -2*sqrt_minus_52 - 9, 2*sqrt_minus_52 - 9, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm.ideal">
<tt class="descname">ideal</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm.ideal" title="Permalink to this definition">¶</a></dt>
<dd><p>Return ideal of ring of integers of quadratic imaginary field
corresponding to this quadratic form.  This is the ideal</p>
<blockquote>
<div><span class="math">\(I = \left(A, \frac{-B+ c\sqrt{D}}{2}\right) \mathcal{O}_K\)</span>.</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">);</span> <span class="n">F</span><span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">G</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">ideal</span><span class="p">()</span>
<span class="go">Fractional ideal (2, 1/2*sqrt_minus_20 + 1)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">ideal</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">G</span><span class="p">]</span>
<span class="go">[(1, 3/2*sqrt_minus_20), (2, 3/2*sqrt_minus_20 - 1), (5, 3/2*sqrt_minus_20), (7, 3/2*sqrt_minus_20 - 2)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm.order">
<tt class="descname">order</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm.order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the multiplicative order of this Galois group automorphism.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K3</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K1</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">K3</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">([</span><span class="n">g</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">G</span><span class="p">])</span>
<span class="go">[1, 2, 4, 4]</span>
<span class="gp">sage: </span><span class="n">K5</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K1</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">K5</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">([</span><span class="n">g</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">G</span><span class="p">])</span>
<span class="go">[1, 2, 3, 3, 6, 6]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm.p1_element">
<tt class="descname">p1_element</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm.p1_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Return element of the projective line corresponding to this
automorphism.</p>
<p>This only makes sense if this automorphism is in the Galois
group <span class="math">\(\textrm{Gal}(K_c/K_1)\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K3</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K1</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">K3</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">([</span><span class="n">g</span><span class="o">.</span><span class="n">p1_element</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">G</span><span class="p">])</span>
<span class="go">[(0, 1), (1, 0), (1, 1), (1, 2)]</span>

<span class="gp">sage: </span><span class="n">K5</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K1</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">K5</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">([</span><span class="n">g</span><span class="o">.</span><span class="n">p1_element</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">G</span><span class="p">])</span>
<span class="go">[(0, 1), (1, 0), (1, 1), (1, 2), (1, 3), (1, 4)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm.quadratic_form">
<tt class="descname">quadratic_form</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisAutomorphismQuadraticForm.quadratic_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Return reduced quadratic form corresponding to this Galois
automorphism.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> <span class="n">s</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">quadratic_form</span><span class="p">()</span>
<span class="go">x^2 + 45*y^2</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.elliptic_curves.heegner.GaloisGroup">
<em class="property">class </em><tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">GaloisGroup</tt><big>(</big><em>field</em>, <em>base=Rational Field</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisGroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Sage Reference Manual: Basic Structures v7.0)"><tt class="xref py py-class docutils literal"><span class="pre">sage.structure.sage_object.SageObject</span></tt></a></p>
<p>A Galois group of a ring class field.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">galois_group</span><span class="p">();</span> <span class="n">G</span>
<span class="go">Galois group of Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">field</span><span class="p">()</span>
<span class="go">Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">complex_conjugation</span><span class="p">()</span>
<span class="go">Complex conjugation automorphism of Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">galois_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">G</span><span class="p">))</span> <span class="o">==</span> <span class="n">G</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.heegner.GaloisGroup&#39;&gt;</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.GaloisGroup.base_field">
<tt class="descname">base_field</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisGroup.base_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the base field, which the field fixed by all the
automorphisms in this Galois group.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Kc</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">();</span> <span class="n">Kc</span>
<span class="go">Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Kc</span><span class="o">.</span><span class="n">galois_group</span><span class="p">();</span> <span class="n">G</span>
<span class="go">Galois group of Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">base_field</span><span class="p">()</span>
<span class="go">Rational Field</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">Kc</span><span class="o">.</span><span class="n">absolute_degree</span><span class="p">()</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Kc</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">K</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Galois group of Ring class field extension of QQ[sqrt(-7)] of conductor 5 over Number Field in sqrt_minus_7 with defining polynomial x^2 + 7</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">base_field</span><span class="p">()</span>
<span class="go">Number Field in sqrt_minus_7 with defining polynomial x^2 + 7</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Kc</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">Kc</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Galois group of Ring class field extension of QQ[sqrt(-7)] of conductor 5 over Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">base_field</span><span class="p">()</span>
<span class="go">Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.GaloisGroup.cardinality">
<tt class="descname">cardinality</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisGroup.cardinality" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the cardinality of this Galois group.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">galois_group</span><span class="p">();</span> <span class="n">G</span>
<span class="go">Galois group of Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">galois_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">55</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">galois_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">120</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.GaloisGroup.complex_conjugation">
<tt class="descname">complex_conjugation</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisGroup.complex_conjugation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the automorphism of <tt class="docutils literal"><span class="pre">self</span></tt> determined by complex
conjugation.  The base field must be the rational numbers.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">galois_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">complex_conjugation</span><span class="p">()</span>
<span class="go">Complex conjugation automorphism of Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.GaloisGroup.field">
<tt class="descname">field</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisGroup.field" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the ring class field that this Galois group acts on.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">galois_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">field</span><span class="p">()</span>
<span class="go">Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.GaloisGroup.is_kolyvagin">
<tt class="descname">is_kolyvagin</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisGroup.is_kolyvagin" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <tt class="docutils literal"><span class="pre">True</span></tt> if conductor <span class="math">\(c\)</span> is prime to the discriminant of the
quadratic field, <span class="math">\(c\)</span> is squarefree and each prime dividing <span class="math">\(c\)</span>
is inert.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K5</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K1</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K5</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span><span class="o">.</span><span class="n">is_kolyvagin</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K7</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K7</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span><span class="o">.</span><span class="n">is_kolyvagin</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">K25</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K25</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span><span class="o">.</span><span class="n">is_kolyvagin</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.GaloisGroup.kolyvagin_generators">
<tt class="descname">kolyvagin_generators</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisGroup.kolyvagin_generators" title="Permalink to this definition">¶</a></dt>
<dd><p>Assuming this Galois group <span class="math">\(G\)</span> is of the form
<span class="math">\(G=\textrm{Gal}(K_c/K_1)\)</span>, with <span class="math">\(c=p_1\dots p_n\)</span> satisfying the
Kolyvagin hypothesis, this function returns noncanonical
choices of lifts of generators for each of the cyclic factors
of <span class="math">\(G\)</span> corresponding to the primes dividing <span class="math">\(c\)</span>.  Thus the
<span class="math">\(i\)</span>-th returned valued is an element of <span class="math">\(G\)</span> that maps to the
identity element of <span class="math">\(\textrm{Gal}(K_p/K_1)\)</span> for all <span class="math">\(p \neq p_i\)</span> and
to a choice of generator of <span class="math">\(\textrm{Gal}(K_{p_i}/K_1)\)</span>.</p>
<p>OUTPUT:</p>
<blockquote>
<div><ul class="simple">
<li>list of elements of <tt class="docutils literal"><span class="pre">self</span></tt></li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K3</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K1</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">K3</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">kolyvagin_generators</span><span class="p">()</span>
<span class="go">(Class field automorphism defined by 9*x^2 - 6*x*y + 14*y^2,)</span>

<span class="gp">sage: </span><span class="n">K5</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K1</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">K5</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">kolyvagin_generators</span><span class="p">()</span>
<span class="go">(Class field automorphism defined by 17*x^2 - 14*x*y + 22*y^2,)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.GaloisGroup.lift_of_hilbert_class_field_galois_group">
<tt class="descname">lift_of_hilbert_class_field_galois_group</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.GaloisGroup.lift_of_hilbert_class_field_galois_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Assuming this Galois group <span class="math">\(G\)</span> is of the form <span class="math">\(G=\textrm{Gal}(K_c/K)\)</span>,
this function returns noncanonical choices of lifts of the
elements of the quotient group <span class="math">\(\textrm{Gal}(K_1/K)\)</span>.</p>
<p>OUTPUT:</p>
<blockquote>
<div><ul class="simple">
<li>tuple of elements of self</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K5</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">K5</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">K5</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">lift_of_hilbert_class_field_galois_group</span><span class="p">()</span>
<span class="go">(Class field automorphism defined by x^2 + 325*y^2, Class field automorphism defined by 2*x^2 + 2*x*y + 163*y^2)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">K5</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">()</span><span class="o">.</span><span class="n">class_number</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPoint">
<em class="property">class </em><tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">HeegnerPoint</tt><big>(</big><em>N</em>, <em>D</em>, <em>c</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Sage Reference Manual: Basic Structures v7.0)"><tt class="xref py py-class docutils literal"><span class="pre">sage.structure.sage_object.SageObject</span></tt></a></p>
<p>A Heegner point of level <span class="math">\(N\)</span>, discriminant <span class="math">\(D\)</span> and conductor <span class="math">\(c\)</span>
is any point on a modular curve or elliptic curve that is
concocted in some way from a quadratic imaginary <span class="math">\(\tau\)</span> in the upper
half plane with <span class="math">\(\Delta(\tau) = D c = \Delta(N \tau)\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">HeegnerPoint</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">13</span><span class="p">);</span> <span class="n">x</span>
<span class="go">Heegner point of level 389, discriminant -7, and conductor 13</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.heegner.HeegnerPoint&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">==</span> <span class="n">x</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPoint.conductor">
<tt class="descname">conductor</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoint.conductor" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the conductor of this Heegner point.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a1&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">67</span><span class="p">,</span><span class="mi">7</span><span class="p">);</span> <span class="n">P</span>
<span class="go">Kolyvagin point of discriminant -67 and conductor 7 on elliptic curve of conductor 37</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span> <span class="n">P</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPoint.discriminant">
<tt class="descname">discriminant</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoint.discriminant" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the discriminant of the quadratic imaginary field
associated to this Heegner point.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">-7</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a1&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">67</span><span class="p">,</span><span class="mi">7</span><span class="p">);</span> <span class="n">P</span>
<span class="go">Kolyvagin point of discriminant -67 and conductor 7 on elliptic curve of conductor 37</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">-67</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span> <span class="n">P</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">-7</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPoint.level">
<tt class="descname">level</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoint.level" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the level of this Heegner point, which is the level of the
modular curve <span class="math">\(X_0(N)\)</span> on which this is a Heegner point.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">level</span><span class="p">()</span>
<span class="go">389</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPoint.quadratic_field">
<tt class="descname">quadratic_field</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoint.quadratic_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the quadratic number field of discriminant <span class="math">\(D\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">()</span>
<span class="go">Number Field in sqrt_minus_7 with defining polynomial x^2 + 7</span>


<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">40</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">()</span>
<span class="go">Number Field in sqrt_minus_40 with defining polynomial x^2 + 40</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">()</span> <span class="ow">is</span> <span class="n">P</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">())</span>
<span class="go">&lt;class &#39;sage.rings.number_field.number_field.NumberField_quadratic_with_category&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPoint.quadratic_order">
<tt class="descname">quadratic_order</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoint.quadratic_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the order in the quadratic imaginary field of conductor
<span class="math">\(c\)</span>, where <span class="math">\(c\)</span> is the conductor of this Heegner point.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">quadratic_order</span><span class="p">()</span>
<span class="go">Order in Number Field in sqrt_minus_7 with defining polynomial x^2 + 7</span>
<span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">quadratic_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">[1, 5*sqrt_minus_7]</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">quadratic_order</span><span class="p">()</span>
<span class="go">Order in Number Field in sqrt_minus_40 with defining polynomial x^2 + 40</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">quadratic_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">[1, 11*sqrt_minus_40]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPoint.ring_class_field">
<tt class="descname">ring_class_field</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoint.ring_class_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the ring class field associated to this Heegner point.
This is an extension <span class="math">\(K_c\)</span> over <span class="math">\(K\)</span>, where <span class="math">\(K\)</span> is the
quadratic imaginary field and <span class="math">\(c\)</span> is the conductor associated
to this Heegner point.  This Heegner point is defined over
<span class="math">\(K_c\)</span> and the Galois group <span class="math">\(Gal(K_c/K)\)</span> acts transitively on
the Galois conjugates of this Heegner point.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">);</span> <span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">23</span><span class="p">))</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_K</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">23</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_K</span><span class="p">()</span>
<span class="go">22</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="mi">23</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_K</span><span class="p">()</span>
<span class="go">132</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_K</span><span class="p">()</span>
<span class="go">30</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_K</span><span class="p">()</span>
<span class="go">7</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve">
<em class="property">class </em><tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">HeegnerPointOnEllipticCurve</tt><big>(</big><em>E</em>, <em>x</em>, <em>check=True</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoint" title="sage.schemes.elliptic_curves.heegner.HeegnerPoint"><tt class="xref py py-class docutils literal"><span class="pre">sage.schemes.elliptic_curves.heegner.HeegnerPoint</span></tt></a></p>
<p>A Heegner point on a curve associated to an order in a quadratic
imaginary field.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span> <span class="n">P</span>
<span class="go">Heegner point of discriminant -7 and conductor 5 on elliptic curve of conductor 37</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve&#39;&gt;</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.conjugates_over_K">
<tt class="descname">conjugates_over_K</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.conjugates_over_K" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <span class="math">\(Gal(K_c/K)\)</span> conjugates of this Heegner point.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;77a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">52</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span> <span class="n">y</span>
<span class="go">Heegner point of discriminant -52 and conductor 5 on elliptic curve of conductor 77</span>
<span class="gp">sage: </span><span class="k">print</span> <span class="p">[</span><span class="n">z</span><span class="o">.</span><span class="n">quadratic_form</span><span class="p">()</span> <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">y</span><span class="o">.</span><span class="n">conjugates_over_K</span><span class="p">()]</span>
<span class="go">[77*x^2 + 52*x*y + 13*y^2, 154*x^2 + 206*x*y + 71*y^2, 539*x^2 + 822*x*y + 314*y^2, 847*x^2 + 1284*x*y + 487*y^2, 1001*x^2 + 52*x*y + y^2, 1078*x^2 + 822*x*y + 157*y^2, 1309*x^2 + 360*x*y + 25*y^2, 1309*x^2 + 2054*x*y + 806*y^2, 1463*x^2 + 976*x*y + 163*y^2, 2233*x^2 + 2824*x*y + 893*y^2, 2387*x^2 + 2054*x*y + 442*y^2, 3619*x^2 + 3286*x*y + 746*y^2]</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">quadratic_form</span><span class="p">()</span>
<span class="go">77*x^2 + 52*x*y + 13*y^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.curve">
<tt class="descname">curve</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.curve" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the elliptic curve on which this is a Heegner point.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">curve</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 + x^2 - 2*x over Rational Field</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">curve</span><span class="p">()</span> <span class="ow">is</span> <span class="n">E</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.heegner_point_on_X0N">
<tt class="descname">heegner_point_on_X0N</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.heegner_point_on_X0N" title="Permalink to this definition">¶</a></dt>
<dd><p>Return Heegner point on <span class="math">\(X_0(N)\)</span> that maps to this Heegner point on <span class="math">\(E\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span> <span class="n">P</span>
<span class="go">Heegner point of discriminant -7 and conductor 5 on elliptic curve of conductor 37</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">heegner_point_on_X0N</span><span class="p">()</span>
<span class="go">Heegner point 5/74*sqrt(-7) - 11/74 of discriminant -7 and conductor 5 on X_0(37)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.kolyvagin_cohomology_class">
<tt class="descname">kolyvagin_cohomology_class</tt><big>(</big><em>n=None</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.kolyvagin_cohomology_class" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Kolyvagin class associated to this Heegner point.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(n\)</span> &#8211; positive integer that divides the gcd of <span class="math">\(a_p\)</span>
and <span class="math">\(p+1\)</span> for all <span class="math">\(p\)</span> dividing the conductor.  If <span class="math">\(n\)</span> is
<tt class="docutils literal"><span class="pre">None</span></tt>, choose the largest valid <span class="math">\(n\)</span>.</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">kolyvagin_cohomology_class</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Kolyvagin cohomology class c(5) in H^1(K,E[3])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.kolyvagin_point">
<tt class="descname">kolyvagin_point</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.kolyvagin_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Kolyvagin point corresponding to this Heegner
point.  This is the point obtained by applying the Kolyvagin
operator <span class="math">\(J_c I_c\)</span> in the group ring of the Galois group to
this Heegner point.   It is a point that defines an element
of <span class="math">\(H^1(K, E[n])\)</span>, under certain hypotheses on <span class="math">\(n\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a1&#39;</span><span class="p">);</span> <span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">);</span> <span class="n">y</span>
<span class="go">Heegner point of discriminant -7 on elliptic curve of conductor 37</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">();</span> <span class="n">P</span>
<span class="go">Kolyvagin point of discriminant -7 on elliptic curve of conductor 37</span>
<span class="gp">sage: </span><span class="n">PP</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">()</span> <span class="c"># approximately (0 : 0 : 1)</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">1e-15</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">PP</span><span class="o">.</span><span class="n">xy</span><span class="p">()])</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.map_to_complex_numbers">
<tt class="descname">map_to_complex_numbers</tt><big>(</big><em>prec=53</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.map_to_complex_numbers" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the point in the subfield <span class="math">\(M\)</span> of the complex numbers
(well defined only modulo the period lattice) corresponding to
this Heegner point.</p>
<p>EXAMPLES:</p>
<p>We compute a nonzero Heegner point over a ring class field on
a curve of rank 2:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">);</span> <span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">map_to_complex_numbers</span><span class="p">()</span>
<span class="go">1.49979679635196 + 0.369156204821526*I</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">map_to_complex_numbers</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">1.4997967963519640592142411892 + 0.36915620482152626830089145962*I</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">map_to_complex_numbers</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">1.5 + 0.37*I</span>
</pre></div>
</div>
<p>Here we see that the Heegner point is 0 since it lies in the
lattice:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">);</span> <span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">map_to_complex_numbers</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">0.0034 - 3.9*I</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">map_to_complex_numbers</span><span class="p">()</span>
<span class="go">4.71844785465692e-15 - 3.94347540310330*I</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(2.49021256085505, 1.97173770155165*I)</span>
<span class="gp">sage: </span><span class="mi">2</span><span class="o">*</span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">3.94347540310330*I</span>
</pre></div>
</div>
<p>You can also directly coerce to the complex field:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">);</span> <span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">ComplexField</span><span class="p">(</span><span class="mi">100</span><span class="p">)(</span><span class="n">y</span><span class="p">);</span> <span class="n">z</span> <span class="c"># real part approx. 0</span>
<span class="go">-... - 3.9434754031032964088448153963*I</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="go">(0.00000000000000000000000000000 : 1.0000000000000000000000000000 : 0.00000000000000000000000000000)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.numerical_approx">
<tt class="descname">numerical_approx</tt><big>(</big><em>prec=53</em>, <em>algorithm=None</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.numerical_approx" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a numerical approximation to this Heegner point
computed using a working precision of prec bits.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The answer is <em>not</em> provably correct to prec bits!  A
priori, due to rounding and other errors, it is possible that
not a single digit is correct.</p>
</div>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li>prec     &#8211; (default: <tt class="docutils literal"><span class="pre">None</span></tt>) the working precision</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">);</span> <span class="n">P</span>
<span class="go">Heegner point of discriminant -7 on elliptic curve of conductor 37</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">&lt;</span> <span class="mf">1e-15</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">P</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">()</span><span class="o">.</span><span class="n">xy</span><span class="p">()])</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c"># expect random digits</span>
<span class="go">(0.0030 - 0.0028*I : -0.0030 + 0.0028*I : 1.0)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">(</span><span class="mi">100</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c"># expect random digits</span>
<span class="go">8.4...e-31 + 6.0...e-31*I</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">40</span><span class="p">);</span> <span class="n">P</span>
<span class="go">Heegner point of discriminant -40 on elliptic curve of conductor 37</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">()</span>
<span class="go">(-6.6...e-16 + 1.41421356237310*I : 1.00000000000000 - 1.41421356237309*I : 1.00000000000000)</span>
</pre></div>
</div>
<p>A rank 2 curve, where all Heegner points of conductor 1 are 0:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">);</span> <span class="n">E</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">);</span> <span class="n">P</span>
<span class="go">Heegner point of discriminant -7 on elliptic curve of conductor 389</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">()</span>
<span class="go">(0.000000000000000 : 1.00000000000000 : 0.000000000000000)</span>
</pre></div>
</div>
<p>However, Heegner points of bigger conductor are often nonzero:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span> <span class="n">P</span>
<span class="go">Heegner point of discriminant -7 and conductor 5 on elliptic curve of conductor 389</span>
<span class="gp">sage: </span><span class="n">numerical_approx</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">(0.675507556926806 + 0.344749649302635*I : -0.377142931401887 + 0.843366227137146*I : 1.00000000000000)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">()</span>
<span class="go">(0.6755075569268... + 0.3447496493026...*I : -0.3771429314018... + 0.8433662271371...*I : 1.00000000000000)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">()</span>
<span class="go">(0.1795583794118... + 0.02035501750912...*I : -0.5573941377055... + 0.2738940831635...*I : 1.00000000000000)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">()</span>
<span class="go">(1.034302915374... - 3.302744319777...*I : 1.323937875767... + 6.908264226850...*I : 1.00000000000000)</span>
</pre></div>
</div>
<p>We find (probably) the definining polynomial of the
<span class="math">\(x\)</span>-coordinate of <span class="math">\(P\)</span>, which defines a class field.  The shape of
the discriminant below is strong confirmation &#8211; but not proof
&#8211; that this polynomial is correct:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">(</span><span class="mi">70</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">algdep</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span> <span class="n">f</span>
<span class="go">1225*x^6 + 1750*x^5 - 21675*x^4 - 380*x^3 + 110180*x^2 - 129720*x + 48771</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">2^6 * 3^2 * 5^11 * 7^4 * 13^2 * 19^6 * 199^2 * 719^2 * 26161^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.point_exact">
<tt class="descname">point_exact</tt><big>(</big><em>prec=53</em>, <em>algorithm='lll'</em>, <em>var='a'</em>, <em>optimize=False</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.point_exact" title="Permalink to this definition">¶</a></dt>
<dd><p>Return exact point on the elliptic curve over a number field
defined by computing this Heegner point to the given number of
bits of precision.   A ValueError is raised if the precision
is clearly insignificant to define a point on the curve.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">It is in theory possible for this function to not raise a
ValueError, find a point on the curve, but via some very
unlikely coincidence that point is not actually this Heegner
point.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Currently we make an arbitrary choice of <span class="math">\(y\)</span>-coordinate for
the lift of the <span class="math">\(x\)</span>-coordinate.</p>
</div>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">prec</span></tt> &#8211; integer (default: 53)</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> &#8211; see the description of the algorithm
parameter for the <tt class="docutils literal"><span class="pre">x_poly_exact</span></tt> method.</li>
<li><tt class="docutils literal"><span class="pre">var</span></tt> &#8211; string (default: &#8216;a&#8217;)</li>
<li><tt class="docutils literal"><span class="pre">optimize</span></tt> &#8211; book (default; False) if <tt class="docutils literal"><span class="pre">True</span></tt>, try to
optimize defining polynomial for the number field that
the point is defined over.  Off by default, since this
can be very expensive.</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span> <span class="n">P</span>
<span class="go">Heegner point of discriminant -7 and conductor 5 on elliptic curve of conductor 389</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">point_exact</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">optimize</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span>
<span class="go">x^12 + 6*x^11 + 90089/1715*x^10 + 71224/343*x^9 + 52563964/588245*x^8 - 483814934/588245*x^7 - 156744579/16807*x^6 - 2041518032/84035*x^5 + 1259355443184/14706125*x^4 + 3094420220918/14706125*x^3 + 123060442043827/367653125*x^2 + 82963044474852/367653125*x + 211679465261391/1838265625</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">(</span><span class="mi">500</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">algdep</span><span class="p">(</span><span class="mi">12</span><span class="p">);</span> <span class="n">f</span> <span class="o">/</span> <span class="n">f</span><span class="o">.</span><span class="n">leading_coefficient</span><span class="p">()</span>
<span class="go">x^12 + 6*x^11 + 90089/1715*x^10 + 71224/343*x^9 + 52563964/588245*x^8 - 483814934/588245*x^7 - 156744579/16807*x^6 - 2041518032/84035*x^5 + 1259355443184/14706125*x^4 + 3094420220918/14706125*x^3 + 123060442043827/367653125*x^2 + 82963044474852/367653125*x + 211679465261391/1838265625</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;5077a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">point_exact</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">(0 : 1 : 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.quadratic_form">
<tt class="descname">quadratic_form</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.quadratic_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the integral primitive positive definite binary
quadratic form associated to this Heegner point.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">quadratic_form</span><span class="p">()</span>
<span class="go">389*x^2 + 147*x*y + 14*y^2</span>

<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="mi">778</span><span class="p">,</span><span class="mi">925</span><span class="p">,</span><span class="mi">275</span><span class="p">));</span> <span class="n">P</span>
<span class="go">Heegner point of discriminant -7 and conductor 5 on elliptic curve of conductor 389</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">quadratic_form</span><span class="p">()</span>
<span class="go">778*x^2 + 925*x*y + 275*y^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.satisfies_kolyvagin_hypothesis">
<tt class="descname">satisfies_kolyvagin_hypothesis</tt><big>(</big><em>n=None</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.satisfies_kolyvagin_hypothesis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <tt class="docutils literal"><span class="pre">True</span></tt> if this Heegner point and <span class="math">\(n\)</span> satisfy the
Kolyvagin hypothesis, i.e., that each prime dividing the
conductor <span class="math">\(c\)</span> of <tt class="docutils literal"><span class="pre">self</span></tt> is inert in K and coprime to <span class="math">\(ND\)</span>.
Moreover, if <span class="math">\(n\)</span> is not <tt class="docutils literal"><span class="pre">None</span></tt>, also check that for each prime
<span class="math">\(p\)</span> dividing <span class="math">\(c\)</span> we have that <span class="math">\(n | \gcd(a_p(E), p+1)\)</span>.</p>
<p>INPUT:</p>
<blockquote>
<div><span class="math">\(n\)</span> &#8211; positive integer</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">satisfies_kolyvagin_hypothesis</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">satisfies_kolyvagin_hypothesis</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">satisfies_kolyvagin_hypothesis</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.tau">
<tt class="descname">tau</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.tau" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <span class="math">\(\tau\)</span> in the upper half plane that maps via the
modular parametrization to this Heegner point.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">tau</span><span class="p">()</span>
<span class="go">5/778*sqrt_minus_7 - 147/778</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.x_poly_exact">
<tt class="descname">x_poly_exact</tt><big>(</big><em>prec=53</em>, <em>algorithm='lll'</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve.x_poly_exact" title="Permalink to this definition">¶</a></dt>
<dd><p>Return irreducible polynomial over the rational numbers
satisfied by the <span class="math">\(x\)</span> coordinate of this Heegner point.  A
ValueError is raised if the precision is clearly insignificant
to define a point on the curve.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">It is in theory possible for this function to not raise a
ValueError, find a polynomial, but via some very unlikely
coincidence that point is not actually this Heegner point.</p>
</div>
<p>INPUT:</p>
<blockquote>
<div><ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">prec</span></tt> &#8211; integer (default: 53)</p>
</li>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">algorithm</span></tt> &#8211; &#8216;conjugates&#8217; or &#8216;lll&#8217; (default); if</dt>
<dd><p class="first last">&#8216;conjugates&#8217;, compute numerically all the
conjugates <tt class="docutils literal"><span class="pre">y[i]</span></tt> of the Heegner point and construct
the characteristic polynomial as the product
<span class="math">\(f(X)=(X-y[i])\)</span>.  If &#8216;lll&#8217;, compute only one of the
conjugates <tt class="docutils literal"><span class="pre">y[0]</span></tt>, then uses the LLL algorithm to
guess <span class="math">\(f(X)\)</span>.</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<p>We compute some <span class="math">\(x\)</span>-coordinate polynomials of some conductor 1
Heegner points:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_discriminants_list</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="n">D</span><span class="p">)</span><span class="o">.</span><span class="n">x_poly_exact</span><span class="p">()</span> <span class="k">for</span> <span class="n">D</span> <span class="ow">in</span> <span class="n">v</span><span class="p">]</span>
<span class="go">[x, x, x^2 + 2, x^5 - x^4 + x^3 + x^2 - 2*x + 1, x - 6, x^7 - 2*x^6 + 9*x^5 - 10*x^4 - x^3 + 8*x^2 - 5*x + 1, x^3 + 5*x^2 + 10*x + 4, x^4 - 10*x^3 + 10*x^2 + 12*x - 12, x^8 - 5*x^7 + 7*x^6 + 13*x^5 - 10*x^4 - 4*x^3 + x^2 - 5*x + 7, x^6 - 2*x^5 + 11*x^4 - 24*x^3 + 30*x^2 - 16*x + 4]</span>
</pre></div>
</div>
<p>We compute <span class="math">\(x\)</span>-coordinate polynomials for some Heegner points
of conductor bigger than 1 on a rank 2 curve:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span> <span class="n">P</span>
<span class="go">Heegner point of discriminant -7 and conductor 5 on elliptic curve of conductor 389</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">x_poly_exact</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">insufficient precision to determine Heegner point (fails discriminant test)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">x_poly_exact</span><span class="p">(</span><span class="mi">75</span><span class="p">)</span>
<span class="go">x^6 + 10/7*x^5 - 867/49*x^4 - 76/245*x^3 + 3148/35*x^2 - 25944/245*x + 48771/1225</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">x_poly_exact</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
<span class="go">x^10 + 282527/52441*x^9 + 27049007420/2750058481*x^8 - 22058564794/2750058481*x^7 - 140054237301/2750058481*x^6 + 696429998952/30250643291*x^5 + 2791387923058/30250643291*x^4 - 3148473886134/30250643291*x^3 + 1359454055022/30250643291*x^2 - 250620385365/30250643291*x + 181599685425/332757076201</span>
</pre></div>
</div>
<p>Here we compute a Heegner point of conductor 5 on a rank 3 curve:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;5077a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span> <span class="n">P</span>
<span class="go">Heegner point of discriminant -7 and conductor 5 on elliptic curve of conductor 5077</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">x_poly_exact</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
<span class="go">x^6 + 1108754853727159228/72351048803252547*x^5 + 88875505551184048168/1953478317687818769*x^4 - 2216200271166098662132/3255797196146364615*x^3 + 14941627504168839449851/9767391588439093845*x^2 - 3456417460183342963918/3255797196146364615*x + 1306572835857500500459/5426328660243941025</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N">
<em class="property">class </em><tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">HeegnerPointOnX0N</tt><big>(</big><em>N</em>, <em>D</em>, <em>c=1</em>, <em>f=None</em>, <em>check=True</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoint" title="sage.schemes.elliptic_curves.heegner.HeegnerPoint"><tt class="xref py py-class docutils literal"><span class="pre">sage.schemes.elliptic_curves.heegner.HeegnerPoint</span></tt></a></p>
<p>A Heegner point as a point on the modular curve <span class="math">\(X_0(N)\)</span>, which we
view as the upper half plane modulo the action of <span class="math">\(\Gamma_0(N)\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span> <span class="n">x</span>
<span class="go">Heegner point 5/74*sqrt(-7) - 11/74 of discriminant -7 and conductor 5 on X_0(37)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">level</span><span class="p">()</span>
<span class="go">37</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">-7</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">()</span>
<span class="go">Number Field in sqrt_minus_7 with defining polynomial x^2 + 7</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">quadratic_form</span><span class="p">()</span>
<span class="go">37*x^2 + 11*x*y + 2*y^2</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">quadratic_order</span><span class="p">()</span>
<span class="go">Order in Number Field in sqrt_minus_7 with defining polynomial x^2 + 7</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">tau</span><span class="p">()</span>
<span class="go">5/74*sqrt_minus_7 - 11/74</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">==</span> <span class="n">x</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.atkin_lehner_act">
<tt class="descname">atkin_lehner_act</tt><big>(</big><em>Q=None</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.atkin_lehner_act" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an integer Q dividing the level N such that <span class="math">\(\gcd(Q, N/Q) = 1\)</span>, returns the
image of this Heegner point under the Atkin-Lehner operator <span class="math">\(W_Q\)</span>.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(Q\)</span> &#8211; positive divisor of <span class="math">\(N\)</span>; if not given, default to <span class="math">\(N\)</span></li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">atkin_lehner_act</span><span class="p">()</span>
<span class="go">Heegner point 5/199168*sqrt(-7) - 631/199168 of discriminant -7 and conductor 5 on X_0(389)</span>

<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">heegner_point</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span><span class="n">D</span><span class="o">=-</span><span class="mi">11</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span> <span class="n">x</span>
<span class="go">Heegner point 1/90*sqrt(-11) - 13/90 of discriminant -11 on X_0(45)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">atkin_lehner_act</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Heegner point 1/90*sqrt(-11) + 23/90 of discriminant -11 on X_0(45)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">atkin_lehner_act</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span> <span class="n">y</span>
<span class="go">Heegner point 1/90*sqrt(-11) - 23/90 of discriminant -11 on X_0(45)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">atkin_lehner_act</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span> <span class="n">z</span>
<span class="go">Heegner point 1/90*sqrt(-11) - 13/90 of discriminant -11 on X_0(45)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">==</span> <span class="n">x</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.galois_orbit_over_K">
<tt class="descname">galois_orbit_over_K</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.galois_orbit_over_K" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <span class="math">\(Gal(K_c/K)\)</span>-orbit of this Heegner point.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> <span class="n">x</span>
<span class="go">Heegner point 3/778*sqrt(-7) - 223/778 of discriminant -7 and conductor 3 on X_0(389)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">galois_orbit_over_K</span><span class="p">()</span>
<span class="go">[Heegner point 3/778*sqrt(-7) - 223/778 of discriminant -7 and conductor 3 on X_0(389), Heegner point 3/1556*sqrt(-7) - 223/1556 of discriminant -7 and conductor 3 on X_0(389), Heegner point 3/1556*sqrt(-7) - 1001/1556 of discriminant -7 and conductor 3 on X_0(389), Heegner point 3/3112*sqrt(-7) - 223/3112 of discriminant -7 and conductor 3 on X_0(389)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.map_to_curve">
<tt class="descname">map_to_curve</tt><big>(</big><em>E</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.map_to_curve" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the image of this Heegner point on the elliptic curve
<span class="math">\(E\)</span>, which must also have conductor <span class="math">\(N\)</span>, where <span class="math">\(N\)</span> is the
level of <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span> <span class="n">x</span>
<span class="go">Heegner point 5/778*sqrt(-7) - 147/778 of discriminant -7 and conductor 5 on X_0(389)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">map_to_curve</span><span class="p">(</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">));</span> <span class="n">y</span>
<span class="go">Heegner point of discriminant -7 and conductor 5 on elliptic curve of conductor 389</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">curve</span><span class="p">()</span><span class="o">.</span><span class="n">cremona_label</span><span class="p">()</span>
<span class="go">&#39;389a1&#39;</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">heegner_point_on_X0N</span><span class="p">()</span>
<span class="go">Heegner point 5/778*sqrt(-7) - 147/778 of discriminant -7 and conductor 5 on X_0(389)</span>
</pre></div>
</div>
<p>You can also directly apply the modular parametrization of the elliptic curve:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">);</span> <span class="n">x</span>
<span class="go">Heegner point 1/74*sqrt(-7) - 17/74 of discriminant -7 on X_0(37)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">);</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">modular_parametrization</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">Heegner point of discriminant -7 on elliptic curve of conductor 37</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.plot">
<tt class="descname">plot</tt><big>(</big><em>**kwds</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw a point at <span class="math">\((x,y)\)</span> where this Heegner point is
represented by the point <span class="math">\(\tau = x + i y\)</span> in the upper half
plane.</p>
<p>The <tt class="docutils literal"><span class="pre">kwds</span></tt> get passed onto the point plotting command.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pointsize</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.quadratic_form">
<tt class="descname">quadratic_form</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.quadratic_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the integral primitive positive-definite binary
quadratic form associated to this Heegner point.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">quadratic_form</span><span class="p">()</span>
<span class="go">389*x^2 + 147*x*y + 14*y^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.reduced_quadratic_form">
<tt class="descname">reduced_quadratic_form</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.reduced_quadratic_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Return reduced binary quadratic corresponding to this Heegner point.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">quadratic_form</span><span class="p">()</span>
<span class="go">389*x^2 + 147*x*y + 14*y^2</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">reduced_quadratic_form</span><span class="p">()</span>
<span class="go">4*x^2 - x*y + 11*y^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.tau">
<tt class="descname">tau</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPointOnX0N.tau" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an element tau in the upper half plane that corresponds
to this particular Heegner point (actually, tau is in the
quadratic imagqinary field K associated to this Heegner point).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span> <span class="n">tau</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">tau</span><span class="p">();</span> <span class="n">tau</span>
<span class="go">5/74*sqrt_minus_7 - 11/74</span>
<span class="gp">sage: </span><span class="mi">37</span> <span class="o">*</span> <span class="n">tau</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>
<span class="go">37*x^2 + 11*x + 2</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">quadratic_form</span><span class="p">()</span>
<span class="go">37*x^2 + 11*x*y + 2*y^2</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPoints">
<em class="property">class </em><tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">HeegnerPoints</tt><big>(</big><em>N</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Sage Reference Manual: Basic Structures v7.0)"><tt class="xref py py-class docutils literal"><span class="pre">sage.structure.sage_object.SageObject</span></tt></a></p>
<p>The set of Heegner points with given parameters.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">);</span> <span class="n">H</span>
<span class="go">Set of all Heegner points on X_0(389)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.heegner.HeegnerPoints_level&#39;&gt;</span>
<span class="gp">sage: </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">HeegnerPoints</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPoints.level">
<tt class="descname">level</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints.level" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the level <span class="math">\(N\)</span> of the modular curve <span class="math">\(X_0(N)\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span><span class="o">.</span><span class="n">level</span><span class="p">()</span>
<span class="go">389</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level">
<em class="property">class </em><tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">HeegnerPoints_level</tt><big>(</big><em>N</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints" title="sage.schemes.elliptic_curves.heegner.HeegnerPoints"><tt class="xref py py-class docutils literal"><span class="pre">sage.schemes.elliptic_curves.heegner.HeegnerPoints</span></tt></a></p>
<p>Return the infinite set of all Heegner points on <span class="math">\(X_0(N)\)</span> for all
quadratic imaginary fields.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">);</span> <span class="n">H</span>
<span class="go">Set of all Heegner points on X_0(11)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.heegner.HeegnerPoints_level&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">H</span><span class="p">))</span> <span class="o">==</span> <span class="n">H</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level.discriminants">
<tt class="descname">discriminants</tt><big>(</big><em>n=10</em>, <em>weak=False</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level.discriminants" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the first <span class="math">\(n\)</span> quadratic imaginary discriminants that
satisfy the Heegner hypothesis for <span class="math">\(N\)</span>.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(n\)</span> &#8211; nonnegative integer</li>
<li><tt class="docutils literal"><span class="pre">weak</span></tt> &#8211; bool (default: <tt class="docutils literal"><span class="pre">False</span></tt>); if <tt class="docutils literal"><span class="pre">True</span></tt> only require
weak Heegner hypothesis, which is the same as usual but
without the condition that <span class="math">\(\gcd(D,N)=1\)</span>.</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">discriminants</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[-7, -11, -40, -47, -67]</span>
</pre></div>
</div>
<p>The default is 10:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">discriminants</span><span class="p">()</span>
<span class="go">[-7, -11, -40, -47, -67, -71, -83, -84, -95, -104]</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">discriminants</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="go">[-7, -11, -40, -47, -67, -71, -83, -84, -95, -104, -107, -115, -120, -123, -127]</span>
</pre></div>
</div>
<p>The discriminant -111 satisfies only the weak Heegner hypothesis, since it
is divisible by 37:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">discriminants</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="n">weak</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[-7, -11, -40, -47, -67, -71, -83, -84, -95, -104, -107, -111, -115, -120, -123]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level.reduce_mod">
<tt class="descname">reduce_mod</tt><big>(</big><em>ell</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level.reduce_mod" title="Permalink to this definition">¶</a></dt>
<dd><p>Return object that allows for computation with Heegner points
of level <span class="math">\(N\)</span> modulo the prime <span class="math">\(\ell\)</span>, represented using
quaternion algebras.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(\ell\)</span> &#8211; prime</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="p">()</span>
<span class="go">Quaternion Algebra (-1, -7) with base ring Rational Field</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc">
<em class="property">class </em><tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">HeegnerPoints_level_disc</tt><big>(</big><em>N</em>, <em>D</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints" title="sage.schemes.elliptic_curves.heegner.HeegnerPoints"><tt class="xref py py-class docutils literal"><span class="pre">sage.schemes.elliptic_curves.heegner.HeegnerPoints</span></tt></a></p>
<p>Set of Heegner points of given level and all conductors associated
to a quadratic imaginary field.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">);</span> <span class="n">H</span>
<span class="go">Set of all Heegner points on X_0(389) associated to QQ[sqrt(-7)]</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">_repr_</span><span class="p">()</span>
<span class="go">&#39;Set of all Heegner points on X_0(389) associated to QQ[sqrt(-7)]&#39;</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">-7</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">()</span>
<span class="go">Number Field in sqrt_minus_7 with defining polynomial x^2 + 7</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_conductors</span><span class="p">()</span>
<span class="go">[1, 3, 5, 13, 15, 17, 19, 31, 39, 41]</span>

<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">H</span><span class="p">))</span> <span class="o">==</span> <span class="n">H</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc.discriminant">
<tt class="descname">discriminant</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc.discriminant" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the discriminant of the quadratic imaginary extension <span class="math">\(K\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">-7</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc.kolyvagin_conductors">
<tt class="descname">kolyvagin_conductors</tt><big>(</big><em>r=None</em>, <em>n=10</em>, <em>E=None</em>, <em>m=None</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc.kolyvagin_conductors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the first <span class="math">\(n\)</span> conductors that are squarefree products
of distinct primes inert in the quadratic imaginary field
<span class="math">\(K = \QQ(\sqrt{D})\)</span>.  If <span class="math">\(r\)</span> is specified, return only
conductors that are a product of <span class="math">\(r\)</span> distinct primes all inert
in <span class="math">\(K\)</span>.  If <span class="math">\(r = 0\)</span>, always return the list <tt class="docutils literal"><span class="pre">[1]</span></tt>,
no matter what.</p>
<p>If the optional elliptic curve <span class="math">\(E\)</span> and integer <span class="math">\(m\)</span> are given,
then only include conductors <span class="math">\(c\)</span> such that for each prime
divisor <span class="math">\(p\)</span> of <span class="math">\(c\)</span> we have <span class="math">\(m \mid \gcd(a_p(E), p+1)\)</span>.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(r\)</span> &#8211; (default: <tt class="docutils literal"><span class="pre">None</span></tt>) nonnegative integer or <tt class="docutils literal"><span class="pre">None</span></tt></li>
<li><span class="math">\(n\)</span> &#8211; positive integer</li>
<li><span class="math">\(E\)</span> &#8211; an elliptic curve</li>
<li><span class="math">\(m\)</span> &#8211; a positive integer</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_conductors</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[1]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_conductors</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[3, 5, 13, 17, 19, 31, 41, 47, 59, 61]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_conductors</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
<span class="go">[3, 5, 13, 17, 19, 31, 41, 47, 59, 61, 73, 83, 89, 97, 101]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_conductors</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[3, 5, 13, 17, 19]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_conductors</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[5, 17, 41, 59, 83]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_conductors</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[85, 205, 295, 415, 697]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc.quadratic_field">
<tt class="descname">quadratic_field</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc.quadratic_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the quadratic imaginary field <span class="math">\(K = \QQ(\sqrt{D})\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">);</span> <span class="n">K</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">()</span>
<span class="go">Number Field in sqrt_minus_7 with defining polynomial x^2 + 7</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond">
<em class="property">class </em><tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">HeegnerPoints_level_disc_cond</tt><big>(</big><em>N</em>, <em>D</em>, <em>c=1</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level" title="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level"><tt class="xref py py-class docutils literal"><span class="pre">sage.schemes.elliptic_curves.heegner.HeegnerPoints_level</span></tt></a>, <a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc" title="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc"><tt class="xref py py-class docutils literal"><span class="pre">sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc</span></tt></a></p>
<p>The set of Heegner points of given level, discriminant, and conductor.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span> <span class="n">H</span>
<span class="go">All Heegner points of conductor 5 on X_0(389) associated to QQ[sqrt(-7)]</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">-7</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">level</span><span class="p">()</span>
<span class="go">389</span>

<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">points</span><span class="p">())</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">points</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Heegner point 5/778*sqrt(-7) - 147/778 of discriminant -7 and conductor 5 on X_0(389)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">betas</span><span class="p">()</span>
<span class="go">(147, 631)</span>

<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">()</span>
<span class="go">Number Field in sqrt_minus_7 with defining polynomial x^2 + 7</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="go">Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>

<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_conductors</span><span class="p">()</span>
<span class="go">[1, 3, 5, 13, 15, 17, 19, 31, 39, 41]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">satisfies_kolyvagin_hypothesis</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">H</span><span class="p">))</span> <span class="o">==</span> <span class="n">H</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond.betas">
<tt class="descname">betas</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond.betas" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the square roots of <span class="math">\(D c^2\)</span> modulo <span class="math">\(4 N\)</span> all reduced
mod <span class="math">\(2 N\)</span>, without multiplicity.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span> <span class="n">X</span>
<span class="go">All Heegner points of conductor 1 on X_0(45) associated to QQ[sqrt(-11)]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">quadratic_form</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">X</span><span class="p">]</span>
<span class="go">[45*x^2 + 13*x*y + y^2,</span>
<span class="go"> 45*x^2 + 23*x*y + 3*y^2,</span>
<span class="go"> 45*x^2 + 67*x*y + 25*y^2,</span>
<span class="go"> 45*x^2 + 77*x*y + 33*y^2]</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">betas</span><span class="p">()</span>
<span class="go">(13, 23, 67, 77)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">points</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="go">(Heegner point 1/90*sqrt(-11) - 13/90 of discriminant -11 on X_0(45),)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">quadratic_form</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">points</span><span class="p">(</span><span class="mi">13</span><span class="p">)]</span>
<span class="go">[45*x^2 + 13*x*y + y^2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond.conductor">
<tt class="descname">conductor</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond.conductor" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the level of the conductor.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond.plot">
<tt class="descname">plot</tt><big>(</big><em>*args</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns plot of all the representatives in the upper half
plane of the Heegner points in this set of Heegner points.</p>
<p>The inputs to this function get passed onto the point command.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pointsize</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">rgbcolor</span><span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">)</span>
<span class="go">Graphics object consisting of 12 graphics primitives</span>
<span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">53</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pointsize</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">rgbcolor</span><span class="o">=</span><span class="s">&#39;purple&#39;</span><span class="p">)</span>
<span class="go">Graphics object consisting of 48 graphics primitives</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond.points">
<tt class="descname">points</tt><big>(</big><em>beta=None</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond.points" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Heegner points in <tt class="docutils literal"><span class="pre">self</span></tt>.  If <span class="math">\(\beta\)</span> is given,
return only those Heegner points with given <span class="math">\(\beta\)</span>, i.e.,
whose quadratic form has <span class="math">\(B\)</span> congruent to <span class="math">\(\beta\)</span> modulo <span class="math">\(2 N\)</span>.</p>
<p>Use <tt class="docutils literal"><span class="pre">self.beta()</span></tt> to get a list of betas.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span> <span class="n">H</span>
<span class="go">All Heegner points of conductor 5 on X_0(389) associated to QQ[sqrt(-7)]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">points</span><span class="p">()</span>
<span class="go">(Heegner point 5/778*sqrt(-7) - 147/778 of discriminant -7 and conductor 5 on X_0(389), ..., Heegner point 5/5446*sqrt(-7) - 757/778 of discriminant -7 and conductor 5 on X_0(389))</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">betas</span><span class="p">()</span>
<span class="go">(147, 631)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">tau</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">H</span><span class="o">.</span><span class="n">points</span><span class="p">(</span><span class="mi">147</span><span class="p">)]</span>
<span class="go">[5/778*sqrt_minus_7 - 147/778, 5/1556*sqrt_minus_7 - 147/1556, 5/1556*sqrt_minus_7 - 925/1556, 5/3112*sqrt_minus_7 - 1703/3112, 5/3112*sqrt_minus_7 - 2481/3112, 5/5446*sqrt_minus_7 - 21/778]</span>

<span class="gp">sage: </span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">tau</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">H</span><span class="o">.</span><span class="n">points</span><span class="p">(</span><span class="mi">631</span><span class="p">)]</span>
<span class="go">[5/778*sqrt_minus_7 - 631/778, 5/1556*sqrt_minus_7 - 631/1556, 5/1556*sqrt_minus_7 - 1409/1556, 5/3112*sqrt_minus_7 - 631/3112, 5/3112*sqrt_minus_7 - 1409/3112, 5/5446*sqrt_minus_7 - 757/778]</span>
</pre></div>
</div>
<p>The result is cached and is a tuple (since it is immutable):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">points</span><span class="p">()</span> <span class="ow">is</span> <span class="n">H</span><span class="o">.</span><span class="n">points</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">points</span><span class="p">())</span>
<span class="go">&lt;type &#39;tuple&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond.ring_class_field">
<tt class="descname">ring_class_field</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond.ring_class_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the ring class field associated to this set of Heegner
points.  This is an extension <span class="math">\(K_c\)</span> over <span class="math">\(K\)</span>, where <span class="math">\(K\)</span> is the
quadratic imaginary field and <span class="math">\(c\)</span> the conductor associated to
this Heegner point.  This Heegner point is defined over <span class="math">\(K_c\)</span>
and the Galois group <span class="math">\(Gal(K_c/K)\)</span> acts transitively on the
Galois conjugates of this Heegner point.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="go">Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond.satisfies_kolyvagin_hypothesis">
<tt class="descname">satisfies_kolyvagin_hypothesis</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoints_level_disc_cond.satisfies_kolyvagin_hypothesis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <tt class="docutils literal"><span class="pre">True</span></tt> if <tt class="docutils literal"><span class="pre">self</span></tt> satisfies the Kolyvagin hypothesis, i.e.,
that each prime dividing the conductor <span class="math">\(c\)</span> of <tt class="docutils literal"><span class="pre">self</span></tt> is inert in
<span class="math">\(K\)</span> and coprime to <span class="math">\(ND\)</span>.</p>
<p>EXAMPLES:</p>
<p>The prime 5 is inert, but the prime 11 is not:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">satisfies_kolyvagin_hypothesis</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">satisfies_kolyvagin_hypothesis</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg">
<em class="property">class </em><tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">HeegnerQuatAlg</tt><big>(</big><em>level</em>, <em>ell</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Sage Reference Manual: Basic Structures v7.0)"><tt class="xref py py-class docutils literal"><span class="pre">sage.structure.sage_object.SageObject</span></tt></a></p>
<p>Heegner points viewed as supersingular points on the modular curve
<span class="math">\(X_0(N)/\mathbf{F}_{\ell}\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">13</span><span class="p">);</span> <span class="n">H</span>
<span class="go">Heegner points on X_0(11) over F_13</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">H</span><span class="p">))</span> <span class="o">==</span> <span class="n">H</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.brandt_module">
<tt class="descname">brandt_module</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.brandt_module" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Brandt module of right ideal classes that we
used to represent the set of supersingular points on
the modular curve.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">brandt_module</span><span class="p">()</span>
<span class="go">Brandt module of dimension 2 of level 3*11 of weight 2 over Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.cyclic_subideal_p1">
<tt class="descname">cyclic_subideal_p1</tt><big>(</big><em>I</em>, <em>c</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.cyclic_subideal_p1" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute dictionary mapping 2-tuples that defined normalized
elements of <span class="math">\(P^1(\ZZ/c\ZZ)\)</span></p>
<p>INPUT:</p>
<blockquote>
<div><ul>
<li><p class="first"><span class="math">\(I\)</span> &#8211; right ideal of Eichler order or in quaternion algebra</p>
</li>
<li><dl class="first docutils">
<dt><span class="math">\(c\)</span> &#8211; square free integer (currently must be odd prime</dt>
<dd><p class="first last">and coprime to level, discriminant, characteristic,
etc.</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><ul class="simple">
<li>dictionary mapping 2-tuples (u,v) to ideals</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">brandt_module</span><span class="p">()</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">cyclic_subideal_p1</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">iteritems</span><span class="p">())</span>
<span class="go">[((0, 1),</span>
<span class="go">  Fractional ideal (2 + 2*j + 32*k, 2*i + 8*j + 82*k, 12*j + 60*k, 132*k)),</span>
<span class="go"> ((1, 0),</span>
<span class="go">  Fractional ideal (2 + 10*j + 28*k, 2*i + 4*j + 62*k, 12*j + 60*k, 132*k)),</span>
<span class="go"> ((1, 1),</span>
<span class="go">  Fractional ideal (2 + 2*j + 76*k, 2*i + 4*j + 106*k, 12*j + 60*k, 132*k)),</span>
<span class="go"> ((1, 2),</span>
<span class="go">  Fractional ideal (2 + 10*j + 116*k, 2*i + 8*j + 38*k, 12*j + 60*k, 132*k))]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">cyclic_subideal_p1</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="mi">17</span><span class="p">))</span>
<span class="go">18</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.ell">
<tt class="descname">ell</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.ell" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the prime <span class="math">\(\ell\)</span> modulo which we are working.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">ell</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.galois_group_over_hilbert_class_field">
<tt class="descname">galois_group_over_hilbert_class_field</tt><big>(</big><em>D</em>, <em>c</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.galois_group_over_hilbert_class_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Galois group of the extension of ring class fields
<span class="math">\(K_c\)</span> over the Hilbert class field <span class="math">\(K_{1}\)</span> of the quadratic
imaginary field of discriminant <span class="math">\(D\)</span>.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(D\)</span> &#8211; fundamental discriminant</li>
<li><span class="math">\(c\)</span> &#8211; conductor (square-free integer)</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="mi">37</span><span class="p">;</span> <span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span><span class="p">;</span> <span class="n">ell</span> <span class="o">=</span> <span class="mi">17</span><span class="p">;</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">41</span><span class="p">;</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="n">ell</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">galois_group_over_hilbert_class_field</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="go">Galois group of Ring class field extension of QQ[sqrt(-7)] of conductor 41 over Hilbert class field of QQ[sqrt(-7)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.galois_group_over_quadratic_field">
<tt class="descname">galois_group_over_quadratic_field</tt><big>(</big><em>D</em>, <em>c</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.galois_group_over_quadratic_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Galois group of the extension of ring class fields
<span class="math">\(K_c\)</span> over the quadratic imaginary field <span class="math">\(K\)</span> of discriminant <span class="math">\(D\)</span>.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(D\)</span> &#8211; fundamental discriminant</li>
<li><span class="math">\(c\)</span> &#8211; conductor (square-free integer)</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="mi">37</span><span class="p">;</span> <span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span><span class="p">;</span> <span class="n">ell</span> <span class="o">=</span> <span class="mi">17</span><span class="p">;</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">41</span><span class="p">;</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="n">ell</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">galois_group_over_quadratic_field</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="go">Galois group of Ring class field extension of QQ[sqrt(-7)] of conductor 41 over Number Field in sqrt_minus_7 with defining polynomial x^2 + 7</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.heegner_conductors">
<tt class="descname">heegner_conductors</tt><big>(</big><em>D</em>, <em>n=5</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.heegner_conductors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the first <span class="math">\(n\)</span> negative fundamental discriminants
coprime to <span class="math">\(N\ell\)</span> such that <span class="math">\(\ell\)</span> is inert in the
corresponding quadratic imaginary field and that field
satisfies the Heegner hypothesis.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(D\)</span> &#8211; negative integer; a fundamental Heegner
discriminant</li>
<li><span class="math">\(n\)</span> &#8211; positive integer (default: 5)</li>
</ul>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><ul class="simple">
<li>list</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">heegner_conductors</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">[1, 2, 4, 5, 8]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">heegner_conductors</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">[1, 2, 4, 5, 8, 10, 13, 16, 17, 19]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.heegner_discriminants">
<tt class="descname">heegner_discriminants</tt><big>(</big><em>n=5</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.heegner_discriminants" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the first <span class="math">\(n\)</span> negative fundamental discriminants
coprime to <span class="math">\(N\ell\)</span> such that <span class="math">\(\ell\)</span> is inert in the
corresponding quadratic imaginary field and that field
satisfies the Heegner hypothesis, and <span class="math">\(N\)</span> is the level.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(n\)</span> &#8211; positive integer (default: 5)</li>
</ul>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><ul class="simple">
<li>list</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">heegner_discriminants</span><span class="p">()</span>
<span class="go">[-7, -19, -40, -43, -52]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">heegner_discriminants</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[-7, -19, -40, -43, -52, -79, -127, -139, -151, -184]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.heegner_divisor">
<tt class="descname">heegner_divisor</tt><big>(</big><em>D</em>, <em>c=1</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.heegner_divisor" title="Permalink to this definition">¶</a></dt>
<dd><p>Return Heegner divisor as an element of the Brandt module
corresponding to the discriminant <span class="math">\(D\)</span> and conductor <span class="math">\(c\)</span>, which
both must be coprime to <span class="math">\(N\ell\)</span>.</p>
<p>More precisely, we compute the sum of the reductions of the
<span class="math">\(\textrm{Gal}(K_1/K)\)</span>-conjugates of each choice of <span class="math">\(y_1\)</span>,
where the choice comes from choosing the ideal <span class="math">\(\mathcal{N}\)</span>.
Then we apply the Hecke operator <span class="math">\(T_c\)</span> to this sum.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(D\)</span> &#8211; discriminant (negative integer)</li>
<li><span class="math">\(c\)</span> &#8211; conductor (positive integer)</li>
</ul>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><ul class="simple">
<li>Brandt module element</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">heegner_discriminants</span><span class="p">()</span>
<span class="go">[-8, -39, -43, -51, -79]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">heegner_divisor</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span>
<span class="go">(1, 0, 0, 1, 0, 0)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">heegner_divisor</span><span class="p">(</span><span class="o">-</span><span class="mi">39</span><span class="p">)</span>
<span class="go">(1, 2, 2, 1, 2, 0)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">heegner_divisor</span><span class="p">(</span><span class="o">-</span><span class="mi">43</span><span class="p">)</span>
<span class="go">(1, 0, 0, 1, 0, 0)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">heegner_divisor</span><span class="p">(</span><span class="o">-</span><span class="mi">51</span><span class="p">)</span>
<span class="go">(1, 0, 0, 1, 0, 2)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">heegner_divisor</span><span class="p">(</span><span class="o">-</span><span class="mi">79</span><span class="p">)</span>
<span class="go">(3, 2, 2, 3, 0, 0)</span>

<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">heegner_divisor</span><span class="p">(</span><span class="o">-</span><span class="mi">39</span><span class="p">)</span><span class="o">.</span><span class="n">element</span><span class="p">())</span>
<span class="go">8</span>
<span class="gp">sage: </span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">39</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">class_number</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.kolyvagin_cyclic_subideals">
<tt class="descname">kolyvagin_cyclic_subideals</tt><big>(</big><em>I</em>, <em>p</em>, <em>alpha_quaternion</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.kolyvagin_cyclic_subideals" title="Permalink to this definition">¶</a></dt>
<dd><p>Return list of pairs <span class="math">\((J, n)\)</span> where <span class="math">\(J\)</span> runs through the
cyclic subideals of <span class="math">\(I\)</span> of index <span class="math">\((\ZZ/p\ZZ)^2\)</span>, and <span class="math">\(J \sim
\alpha^n(J_0)\)</span> for some fixed choice of cyclic subideal <span class="math">\(J_0\)</span>.</p>
<p>INPUT:</p>
<blockquote>
<div><ul>
<li><p class="first"><span class="math">\(I\)</span> &#8211; right ideal of the quaternion algebra</p>
</li>
<li><p class="first"><span class="math">\(p\)</span> &#8211; prime number</p>
</li>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">alpha_quaternion</span></tt> &#8211; image in the quaternion algebra</dt>
<dd><p class="first last">of generator <span class="math">\(\alpha\)</span> for
<span class="math">\((\mathcal{O}_K / c\mathcal{O}_K)^* / (\ZZ/c\ZZ)^*\)</span>.</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><ul class="simple">
<li>list of 2-tuples</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="mi">37</span><span class="p">;</span> <span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span><span class="p">;</span> <span class="n">ell</span> <span class="o">=</span> <span class="mi">17</span><span class="p">;</span> <span class="n">c</span><span class="o">=</span><span class="mi">5</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="n">ell</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">brandt_module</span><span class="p">();</span> <span class="n">I</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="mi">32</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">optimal_embeddings</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">I</span><span class="o">.</span><span class="n">left_order</span><span class="p">())[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_generators</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span><span class="o">.</span><span class="n">number_field</span><span class="p">(),</span> <span class="n">c</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">alpha_quaternion</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="n">alpha_quaternion</span>
<span class="go">1 - 5/128*i - 77/192*j + 137/384*k</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_cyclic_subideals</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">alpha_quaternion</span><span class="p">)</span>
<span class="go">[(Fractional ideal (2 + 874/3*j + 128356/3*k, 2*i + 932/3*j + 198806/3*k, 2560/3*j + 33280/3*k, 94720*k), 0), (Fractional ideal (2 + 462*j + 82892*k, 2*i + 932/3*j + 141974/3*k, 2560/3*j + 33280/3*k, 94720*k), 1), (Fractional ideal (2 + 2410/3*j + 261988/3*k, 2*i + 652*j + 89650*k, 2560/3*j + 33280/3*k, 94720*k), 2), (Fractional ideal (2 + 2410/3*j + 91492/3*k, 2*i + 1444/3*j + 148630/3*k, 2560/3*j + 33280/3*k, 94720*k), 3), (Fractional ideal (2 + 874/3*j + 71524/3*k, 2*i + 2468/3*j + 275606/3*k, 2560/3*j + 33280/3*k, 94720*k), 4), (Fractional ideal (2 + 462*j + 63948*k, 2*i + 2468/3*j + 218774/3*k, 2560/3*j + 33280/3*k, 94720*k), 5)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.kolyvagin_generator">
<tt class="descname">kolyvagin_generator</tt><big>(</big><em>K</em>, <em>p</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.kolyvagin_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return element in <span class="math">\(K\)</span> that maps to the multiplicative generator
for the quotient group</p>
<blockquote>
<div><span class="math">\((\mathcal{O}_K / p \mathcal{O}_K)^* / (\ZZ/p\ZZ)^*\)</span></div></blockquote>
<p>of the form <span class="math">\(\sqrt{D}+n\)</span> with <span class="math">\(n\geq 1\)</span> minimal.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(K\)</span> &#8211; quadratic imaginary field</li>
<li><span class="math">\(p\)</span> &#8211; inert prime</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="mi">37</span><span class="p">;</span> <span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span><span class="p">;</span> <span class="n">ell</span> <span class="o">=</span> <span class="mi">17</span><span class="p">;</span> <span class="n">p</span><span class="o">=</span><span class="mi">5</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="n">ell</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">brandt_module</span><span class="p">();</span> <span class="n">I</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="mi">32</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">optimal_embeddings</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">I</span><span class="o">.</span><span class="n">left_order</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_generator</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span><span class="o">.</span><span class="n">number_field</span><span class="p">(),</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">a + 1</span>
</pre></div>
</div>
<p>This function requires that p be prime, but kolyvagin_generators works in general:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_generator</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span><span class="o">.</span><span class="n">number_field</span><span class="p">(),</span> <span class="mi">5</span><span class="o">*</span><span class="mi">17</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">p must be prime</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_generators</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span><span class="o">.</span><span class="n">number_field</span><span class="p">(),</span> <span class="mi">5</span><span class="o">*</span><span class="mi">17</span><span class="p">)</span>
<span class="go">[-34*a + 1, 35*a + 106]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.kolyvagin_generators">
<tt class="descname">kolyvagin_generators</tt><big>(</big><em>K</em>, <em>c</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.kolyvagin_generators" title="Permalink to this definition">¶</a></dt>
<dd><p>Return elements in <span class="math">\(\mathcal{O}_K\)</span> that map to multiplicative generators
for the factors of the quotient group</p>
<blockquote>
<div><span class="math">\((\mathcal{O}_K / c \mathcal{O}_K)^* / (\ZZ/c\ZZ)^*\)</span></div></blockquote>
<p>corresponding to the prime divisors of c.  Each generator is
of the form <span class="math">\(\sqrt{D}+n\)</span> with <span class="math">\(n\geq 1\)</span> minimal.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(K\)</span> &#8211; quadratic imaginary field</li>
<li><span class="math">\(c\)</span> &#8211; square free product of inert prime</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="mi">37</span><span class="p">;</span> <span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span><span class="p">;</span> <span class="n">ell</span> <span class="o">=</span> <span class="mi">17</span><span class="p">;</span> <span class="n">p</span><span class="o">=</span><span class="mi">5</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="n">ell</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">brandt_module</span><span class="p">();</span> <span class="n">I</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="mi">32</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">optimal_embeddings</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">I</span><span class="o">.</span><span class="n">left_order</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_generators</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span><span class="o">.</span><span class="n">number_field</span><span class="p">(),</span> <span class="mi">5</span><span class="o">*</span><span class="mi">17</span><span class="p">)</span>
<span class="go">[-34*a + 1, 35*a + 106]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.kolyvagin_point_on_curve">
<tt class="descname">kolyvagin_point_on_curve</tt><big>(</big><em>D</em>, <em>c</em>, <em>E</em>, <em>p</em>, <em>bound=10</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.kolyvagin_point_on_curve" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute image of the Kolyvagin divisor <span class="math">\(P_c\)</span> in
<span class="math">\(E(\GF{\ell^2}) / p E(\GF{\ell^2})\)</span>.  Note that
this image is by definition only well defined up to
scalars.   However, doing multiple computations
will always yield the same result, and working
modulo different <span class="math">\(\ell\)</span> is compatible (since we
always chose the same generator for <span class="math">\(\textrm{Gal}(K_c/K_1)\)</span>).</p>
<p>INPUT:</p>
<blockquote>
<div><ul>
<li><p class="first"><span class="math">\(D\)</span> &#8211; fundamental negative discriminant</p>
</li>
<li><p class="first"><span class="math">\(c\)</span> &#8211; conductor</p>
</li>
<li><p class="first"><span class="math">\(E\)</span> &#8211; elliptic curve of conductor the level of self</p>
</li>
<li><dl class="first docutils">
<dt><span class="math">\(p\)</span> &#8211; odd prime number such that we consider image in</dt>
<dd><p class="first last"><span class="math">\(E(\GF{\ell^2}) / p E(\GF{\ell^2})\)</span></p>
</dd>
</dl>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">bound</span></tt> &#8211; integer (default: 10)</p>
</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="mi">37</span><span class="p">;</span> <span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span><span class="p">;</span> <span class="n">ell</span> <span class="o">=</span> <span class="mi">17</span><span class="p">;</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">41</span><span class="p">;</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="n">ell</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_point_on_curve</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">),</span> <span class="n">p</span><span class="p">)</span>
<span class="go">[2, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.kolyvagin_sigma_operator">
<tt class="descname">kolyvagin_sigma_operator</tt><big>(</big><em>D</em>, <em>c</em>, <em>r</em>, <em>bound=None</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.kolyvagin_sigma_operator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the action of the Kolyvagin sigma operator on the <span class="math">\(r\)</span>-th
basis vector.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(D\)</span> &#8211; fundamental discriminant</li>
<li><span class="math">\(c\)</span> &#8211; conductor (square-free integer, need not be prime)</li>
<li><span class="math">\(r\)</span> &#8211; nonnegative integer</li>
<li><tt class="docutils literal"><span class="pre">bound</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">None</span></tt>), if given, controls
precision of computation of theta series, which could
impact performance, but does not impact correctness</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<p>We first try to verify Kolyvagin&#8217;s conjecture for a rank 2
curve by working modulo 5, but we are unlucky with <span class="math">\(c=17\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="mi">389</span><span class="p">;</span> <span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span><span class="p">;</span> <span class="n">ell</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">17</span><span class="p">;</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="n">ell</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">modp_dual_elliptic_curve_factor</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>  <span class="c"># long time (4s on sage.math, 2012)</span>
<span class="gp">sage: </span><span class="n">k118</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_sigma_operator</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="mi">118</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k104</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_sigma_operator</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="mi">104</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">dot_product</span><span class="p">(</span><span class="n">k104</span><span class="o">.</span><span class="n">element</span><span class="p">()</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">V</span><span class="o">.</span><span class="n">basis</span><span class="p">()]</span>  <span class="c"># long time</span>
<span class="go">[0, 0]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">dot_product</span><span class="p">(</span><span class="n">k118</span><span class="o">.</span><span class="n">element</span><span class="p">()</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">V</span><span class="o">.</span><span class="n">basis</span><span class="p">()]</span>  <span class="c"># long time</span>
<span class="go">[0, 0]</span>
</pre></div>
</div>
<p>Next we try again with <span class="math">\(c=41\)</span> and this does work, in that we
get something nonzero, when dotting with V:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="mi">41</span>
<span class="gp">sage: </span><span class="n">k118</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_sigma_operator</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="mi">118</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k104</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_sigma_operator</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="mi">104</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">dot_product</span><span class="p">(</span><span class="n">k118</span><span class="o">.</span><span class="n">element</span><span class="p">()</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">V</span><span class="o">.</span><span class="n">basis</span><span class="p">()]</span>  <span class="c"># long time</span>
<span class="go">[2, 0]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">dot_product</span><span class="p">(</span><span class="n">k104</span><span class="o">.</span><span class="n">element</span><span class="p">()</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">V</span><span class="o">.</span><span class="n">basis</span><span class="p">()]</span>  <span class="c"># long time</span>
<span class="go">[1, 0]</span>
</pre></div>
</div>
<p>By the way, the above is the first ever provable verification
of Kolyvagin&#8217;s conjecture for any curve of rank at least 2.</p>
<p>Another example, but where the curve has rank 1:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="mi">37</span><span class="p">;</span> <span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span><span class="p">;</span> <span class="n">ell</span> <span class="o">=</span> <span class="mi">17</span><span class="p">;</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">41</span><span class="p">;</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="n">ell</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">heegner_divisor</span><span class="p">(</span><span class="n">D</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">element</span><span class="p">()</span><span class="o">.</span><span class="n">nonzero_positions</span><span class="p">()</span>
<span class="go">[32, 51]</span>
<span class="gp">sage: </span><span class="n">k32</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_sigma_operator</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span> <span class="n">k32</span>
<span class="go">(17, 12, 33, 33, 49, 108, 3, 0, 0, 33, 37, 49, 33, 33, 59, 54, 21, 30, 0, 0, 29, 12, 41, 38, 33, 15, 0, 0, 4, 0, 7, 0, 0, 0, 0, 34, 26, 18, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)</span>
<span class="gp">sage: </span><span class="n">k51</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_sigma_operator</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="mi">51</span><span class="p">);</span> <span class="n">k51</span>
<span class="go">(5, 13, 0, 0, 14, 0, 21, 0, 0, 0, 29, 0, 0, 45, 0, 6, 0, 40, 0, 61, 0, 0, 40, 32, 0, 9, 0, 0, 0, 0, 17, 0, 0, 0, 77, 40, 2, 10, 18, 0, 0, 61, 19, 45, 26, 80, 61, 35, 35, 19, 1, 0)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">modp_dual_elliptic_curve_factor</span><span class="p">(</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">),</span> <span class="n">q</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span> <span class="n">V</span>
<span class="go">Vector space of degree 52 and dimension 2 over Ring of integers modulo 3</span>
<span class="go">Basis matrix:</span>
<span class="go">2 x 52 dense matrix over Ring of integers modulo 3</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">dot_product</span><span class="p">(</span><span class="n">k32</span><span class="o">.</span><span class="n">element</span><span class="p">()</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">q</span><span class="p">)))</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">V</span><span class="o">.</span><span class="n">basis</span><span class="p">()]</span>
<span class="go">[2, 2]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">dot_product</span><span class="p">(</span><span class="n">k51</span><span class="o">.</span><span class="n">element</span><span class="p">()</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">q</span><span class="p">)))</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">V</span><span class="o">.</span><span class="n">basis</span><span class="p">()]</span>
<span class="go">[1, 1]</span>
</pre></div>
</div>
<p>An example with <span class="math">\(c\)</span> a product of two primes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="mi">389</span><span class="p">;</span> <span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span><span class="p">;</span> <span class="n">ell</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="n">ell</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">modp_dual_elliptic_curve_factor</span><span class="p">(</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">),</span> <span class="n">q</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_sigma_operator</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="mi">17</span><span class="o">*</span><span class="mi">41</span><span class="p">,</span> <span class="mi">104</span><span class="p">)</span>     <span class="c"># long time</span>
<span class="gp">sage: </span><span class="n">k</span>                                                 <span class="c"># long time</span>
<span class="go">(990, 656, 219, ..., 246, 534, 1254)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">dot_product</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">element</span><span class="p">()</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">V</span><span class="o">.</span><span class="n">basis</span><span class="p">()]</span>   <span class="c"># long time (but only because depends on something slow)</span>
<span class="go">[0, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.left_orders">
<tt class="descname">left_orders</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.left_orders" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the left orders associated to the representative right
ideals in the Brandt module.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">left_orders</span><span class="p">()</span>
<span class="go">[Order of Quaternion Algebra (-1, -3) with base ring Rational Field with basis (1/2 + 1/2*j + 7*k, 1/2*i + 13/2*k, j + 3*k, 11*k),</span>
<span class="go"> Order of Quaternion Algebra (-1, -3) with base ring Rational Field with basis (1/2 + 1/2*j + 7*k, 1/4*i + 1/2*j + 63/4*k, j + 14*k, 22*k)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.level">
<tt class="descname">level</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.level" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the level.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">level</span><span class="p">()</span>
<span class="go">11</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.modp_dual_elliptic_curve_factor">
<tt class="descname">modp_dual_elliptic_curve_factor</tt><big>(</big><em>E</em>, <em>p</em>, <em>bound=10</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.modp_dual_elliptic_curve_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the factor of the Brandt module space modulo <span class="math">\(p\)</span>
corresponding to the elliptic curve <span class="math">\(E\)</span>, cut out using
Hecke operators up to <tt class="docutils literal"><span class="pre">bound</span></tt>.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(E\)</span> &#8211; elliptic curve of conductor equal to the level of self</li>
<li><span class="math">\(p\)</span> &#8211; prime number</li>
<li><span class="math">\(bound\)</span> &#8211; positive integer (default: 10)</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="mi">37</span><span class="p">;</span> <span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span><span class="p">;</span> <span class="n">ell</span> <span class="o">=</span> <span class="mi">17</span><span class="p">;</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">41</span><span class="p">;</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="n">ell</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">modp_dual_elliptic_curve_factor</span><span class="p">(</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">),</span> <span class="n">q</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span> <span class="n">V</span>
<span class="go">Vector space of degree 52 and dimension 2 over Ring of integers modulo 3</span>
<span class="go">Basis matrix:</span>
<span class="go">2 x 52 dense matrix over Ring of integers modulo 3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.modp_splitting_data">
<tt class="descname">modp_splitting_data</tt><big>(</big><em>p</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.modp_splitting_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Return mod <span class="math">\(p\)</span> splitting data for the quaternion algebra at the
unramified prime <span class="math">\(p\)</span>.  This is a pair of <span class="math">\(2\times 2\)</span> matrices
<span class="math">\(A\)</span>, <span class="math">\(B\)</span> over the finite field <span class="math">\(\GF{p}\)</span> such that if the
quaternion algebra has generators <span class="math">\(i, j, k\)</span>, then the
homomorphism sending <span class="math">\(i\)</span> to <span class="math">\(A\)</span> and <span class="math">\(j\)</span> to <span class="math">\(B\)</span> maps any
maximal order homomorphically onto the ring of <span class="math">\(2\times 2\)</span> matrices.</p>
<p>Because of how the homomorphism is defined, we must assume that the
prime <span class="math">\(p\)</span> is odd.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(p\)</span> &#8211; unramified odd prime</li>
</ul>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><ul class="simple">
<li>2-tuple of matrices over finite field</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="p">()</span>
<span class="go">Quaternion Algebra (-1, -7) with base ring Rational Field</span>
<span class="gp">sage: </span><span class="n">I</span><span class="p">,</span> <span class="n">J</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">modp_splitting_data</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span>
<span class="go">[ 0 12]</span>
<span class="go">[ 1  0]</span>
<span class="gp">sage: </span><span class="n">J</span>
<span class="go">[7 3]</span>
<span class="go">[3 6]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">^</span><span class="mi">2</span>
<span class="go">[12  0]</span>
<span class="go">[ 0 12]</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">^</span><span class="mi">2</span>
<span class="go">[6 0]</span>
<span class="go">[0 6]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">*</span><span class="n">J</span> <span class="o">==</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">I</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The following is a good test because of the asserts in the code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="n">H</span><span class="o">.</span><span class="n">modp_splitting_data</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">primes</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">200</span><span class="p">)]</span>
</pre></div>
</div>
<p>Some edge cases:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">modp_splitting_data</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">[ 0 10]  [6 1]</span>
<span class="go">[ 1  0], [1 5]</span>
<span class="go">)</span>
</pre></div>
</div>
<p>Proper error handling:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">modp_splitting_data</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">p (=7) must be an unramified prime</span>

<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">modp_splitting_data</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">p must be odd</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.modp_splitting_map">
<tt class="descname">modp_splitting_map</tt><big>(</big><em>p</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.modp_splitting_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Return (algebra) map from the (<span class="math">\(p\)</span>-integral) quaternion algebra to
the set of <span class="math">\(2\times 2\)</span> matrices over <span class="math">\(\GF{p}\)</span>.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(p\)</span> &#8211; prime number</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">modp_splitting_map</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="p">();</span> <span class="n">B</span>
<span class="go">Quaternion Algebra (-1, -7) with base ring Rational Field</span>
<span class="gp">sage: </span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="n">j</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">k</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">7</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="n">k</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span>
<span class="go">[12  3]</span>
<span class="go">[10  5]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">[12  3]</span>
<span class="go">[10  5]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.optimal_embeddings">
<tt class="descname">optimal_embeddings</tt><big>(</big><em>D</em>, <em>c</em>, <em>R</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.optimal_embeddings" title="Permalink to this definition">¶</a></dt>
<dd><p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(D\)</span> &#8211; negative fundamental disriminant</li>
<li><span class="math">\(c\)</span> &#8211; integer coprime</li>
<li><span class="math">\(R\)</span> &#8211; Eichler order</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">left_orders</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">optimal_embeddings</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>
<span class="go">[Embedding sending sqrt(-7) to i - j - k,</span>
<span class="go"> Embedding sending sqrt(-7) to -i + j + k]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">optimal_embeddings</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>
<span class="go">[Embedding sending 2*sqrt(-7) to 5*i - k,</span>
<span class="go"> Embedding sending 2*sqrt(-7) to -5*i + k,</span>
<span class="go"> Embedding sending 2*sqrt(-7) to 2*i - 2*j - 2*k,</span>
<span class="go"> Embedding sending 2*sqrt(-7) to -2*i + 2*j + 2*k]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.quadratic_field">
<tt class="descname">quadratic_field</tt><big>(</big><em>D</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.quadratic_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Return our fixed choice of quadratic imaginary field of
discriminant <span class="math">\(D\)</span>.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(D\)</span> &#8211; fundamental discriminant</li>
</ul>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><ul class="simple">
<li>a quadratic number field</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">Number Field in sqrt_minus_7 with defining polynomial x^2 + 7</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.quaternion_algebra">
<tt class="descname">quaternion_algebra</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.quaternion_algebra" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the rational quaternion algebra used to implement self.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="p">()</span>
<span class="go">Quaternion Algebra (-1, -7) with base ring Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.rational_kolyvagin_divisor">
<tt class="descname">rational_kolyvagin_divisor</tt><big>(</big><em>D</em>, <em>c</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.rational_kolyvagin_divisor" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Kolyvagin divisor as an element of the Brandt module
corresponding to the discriminant <span class="math">\(D\)</span> and conductor <span class="math">\(c\)</span>, which
both must be coprime to <span class="math">\(N\ell\)</span>.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(D\)</span> &#8211; discriminant (negative integer)</li>
<li><span class="math">\(c\)</span> &#8211; conductor (positive integer)</li>
</ul>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><ul class="simple">
<li>Brandt module element (or tuple of them)</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="mi">389</span><span class="p">;</span> <span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span><span class="p">;</span> <span class="n">ell</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">17</span><span class="p">;</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="n">ell</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">rational_kolyvagin_divisor</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">c</span><span class="p">);</span> <span class="n">k</span>  <span class="c"># long time (5s on sage.math, 2013)</span>
<span class="go">(2, 0, 0, 0, 0, 0, 16, 0, 0, 0, 0, 4, 0, 0, 9, 11, 0, 6, 0, 0, 7, 0, 0, 0, 0, 14, 12, 13, 15, 17, 0, 0, 0, 0, 8, 0, 0, 0, 0, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">modp_dual_elliptic_curve_factor</span><span class="p">(</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">),</span> <span class="n">q</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">dot_product</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">element</span><span class="p">()</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">q</span><span class="p">)))</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">V</span><span class="o">.</span><span class="n">basis</span><span class="p">()]</span>  <span class="c"># long time</span>
<span class="go">[0, 0]</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">rational_kolyvagin_divisor</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="mi">59</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">dot_product</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">element</span><span class="p">()</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">q</span><span class="p">)))</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">V</span><span class="o">.</span><span class="n">basis</span><span class="p">()]</span>
<span class="go">[2, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.right_ideals">
<tt class="descname">right_ideals</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.right_ideals" title="Permalink to this definition">¶</a></dt>
<dd><p>Return representative right ideals in the Brandt module.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()</span>
<span class="go">(Fractional ideal (2 + 2*j + 28*k, 2*i + 26*k, 4*j + 12*k, 44*k),</span>
<span class="go"> Fractional ideal (2 + 2*j + 28*k, 2*i + 4*j + 38*k, 8*j + 24*k, 88*k))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.satisfies_heegner_hypothesis">
<tt class="descname">satisfies_heegner_hypothesis</tt><big>(</big><em>D</em>, <em>c=1</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlg.satisfies_heegner_hypothesis" title="Permalink to this definition">¶</a></dt>
<dd><p>The fundamental discriminant <span class="math">\(D\)</span> must be coprime to <span class="math">\(N\ell\)</span>,
and must define a quadratic imaginary field <span class="math">\(K\)</span> in which <span class="math">\(\ell\)</span>
is inert.  Also, all primes dividing <span class="math">\(N\)</span> must split in <span class="math">\(K\)</span>,
and <span class="math">\(c\)</span> must be squarefree and coprime to <span class="math">\(ND\ell\)</span>.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(D\)</span> &#8211; negative integer</li>
<li><span class="math">\(c\)</span> &#8211; positive integer (default: 1)</li>
</ul>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><ul class="simple">
<li>bool</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">satisfies_heegner_hypothesis</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">satisfies_heegner_hypothesis</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">satisfies_heegner_hypothesis</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">D</span> <span class="k">for</span> <span class="n">D</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mf">2.</span><span class="o">.-</span><span class="mi">100</span><span class="p">]</span> <span class="k">if</span> <span class="n">H</span><span class="o">.</span><span class="n">satisfies_heegner_hypothesis</span><span class="p">(</span><span class="n">D</span><span class="p">)]</span>
<span class="go">[-8, -39, -43, -51, -79, -95]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding">
<em class="property">class </em><tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">HeegnerQuatAlgEmbedding</tt><big>(</big><em>D</em>, <em>c</em>, <em>R</em>, <em>beta</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Sage Reference Manual: Basic Structures v7.0)"><tt class="xref py py-class docutils literal"><span class="pre">sage.structure.sage_object.SageObject</span></tt></a></p>
<p>The homomorphism <span class="math">\(\mathcal{O} \to R\)</span>, where <span class="math">\(\mathcal{O}\)</span> is the
order of conductor <span class="math">\(c\)</span> in the quadratic field of discriminant <span class="math">\(D\)</span>,
and <span class="math">\(R\)</span> is an Eichler order in a quaternion algebra.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">R</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">left_orders</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">optimal_embeddings</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">R</span><span class="p">)[</span><span class="mi">1</span><span class="p">];</span> <span class="n">f</span>
<span class="go">Embedding sending 2*sqrt(-7) to -5*i + k</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">f</span><span class="p">))</span> <span class="o">==</span> <span class="n">f</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.beta">
<tt class="descname">beta</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.beta" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the element <span class="math">\(\beta\)</span> in the quaternion algebra order
that <span class="math">\(c\sqrt{D}\)</span> maps to.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">R</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">left_orders</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">optimal_embeddings</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">R</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">beta</span><span class="p">()</span>
<span class="go">-5*i + k</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.codomain">
<tt class="descname">codomain</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.codomain" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the codomain of this embedding.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">R</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">left_orders</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">optimal_embeddings</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">R</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="go">Order of Quaternion Algebra (-1, -3) with base ring Rational Field with basis (1/2 + 1/2*j + 7*k, 1/2*i + 13/2*k, j + 3*k, 11*k)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.conjugate">
<tt class="descname">conjugate</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.conjugate" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the conjugate of this embedding, which is also an
embedding.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">R</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">left_orders</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">optimal_embeddings</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">R</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span>
<span class="go">Embedding sending 2*sqrt(-7) to 5*i - k</span>
<span class="gp">sage: </span><span class="n">f</span>
<span class="go">Embedding sending 2*sqrt(-7) to -5*i + k</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.domain">
<tt class="descname">domain</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the domain of this embedding.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">R</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">left_orders</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">optimal_embeddings</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">R</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span>
<span class="go">Order in Number Field in a with defining polynomial x^2 + 7</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.domain_conductor">
<tt class="descname">domain_conductor</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.domain_conductor" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the conductor of the domain.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">R</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">left_orders</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">optimal_embeddings</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">R</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">domain_conductor</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.domain_gen">
<tt class="descname">domain_gen</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.domain_gen" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the specific generator <span class="math">\(c \sqrt{D}\)</span> for the domain
order.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">R</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">left_orders</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">optimal_embeddings</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">R</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">domain_gen</span><span class="p">()</span>
<span class="go">2*a</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">domain_gen</span><span class="p">()</span><span class="o">^</span><span class="mi">2</span>
<span class="go">-28</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.matrix">
<tt class="descname">matrix</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.HeegnerQuatAlgEmbedding.matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return matrix over <span class="math">\(\QQ\)</span> of this morphism, with respect to the
basis 1, <span class="math">\(c\sqrt{D}\)</span> of the domain and the basis <span class="math">\(1,i,j,k\)</span> of
the ambient rational quaternion algebra (which contains the
domain).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">R</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">left_orders</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">optimal_embeddings</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">R</span><span class="p">)[</span><span class="mi">1</span><span class="p">];</span> <span class="n">f</span>
<span class="go">Embedding sending sqrt(-7) to -i + j + k</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[ 1  0  0  0]</span>
<span class="go">[ 0 -1  1  1]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[ 1  0  0  0]</span>
<span class="go">[ 0  1 -1 -1]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClass">
<em class="property">class </em><tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">KolyvaginCohomologyClass</tt><big>(</big><em>kolyvagin_point</em>, <em>n</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClass" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Sage Reference Manual: Basic Structures v7.0)"><tt class="xref py py-class docutils literal"><span class="pre">sage.structure.sage_object.SageObject</span></tt></a></p>
<p>A Kolyvagin cohomology class in <span class="math">\(H^1(K,E[n])\)</span> or <span class="math">\(H^1(K,E)[n]\)</span>
attached to a Heegner point.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">kolyvagin_cohomology_class</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">c</span>
<span class="go">Kolyvagin cohomology class c(1) in H^1(K,E[3])</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClassEn&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">c</span><span class="p">))</span> <span class="o">==</span> <span class="n">c</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">kolyvagin_cohomology_class</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Kolyvagin cohomology class c(1) in H^1(K,E[5])</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClass.conductor">
<tt class="descname">conductor</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClass.conductor" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the integer <span class="math">\(c\)</span> such that this cohomology class is associated
to the Heegner point <span class="math">\(y_c\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">kolyvagin_cohomology_class</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClass.heegner_point">
<tt class="descname">heegner_point</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClass.heegner_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Heegner point <span class="math">\(y_c\)</span> to which this cohomology class
is associated.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">kolyvagin_cohomology_class</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">()</span>
<span class="go">Heegner point of discriminant -7 and conductor 5 on elliptic curve of conductor 37</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClass.kolyvagin_point">
<tt class="descname">kolyvagin_point</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClass.kolyvagin_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Kolyvagin point <span class="math">\(P_c\)</span> to which this cohomology
class is associated.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">kolyvagin_cohomology_class</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">()</span>
<span class="go">Kolyvagin point of discriminant -7 and conductor 5 on elliptic curve of conductor 37</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClass.n">
<tt class="descname">n</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClass.n" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the integer <span class="math">\(n\)</span> so that this is a cohomology class in
<span class="math">\(H^1(K,E[n])\)</span> or <span class="math">\(H^1(K,E)[n]\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">kolyvagin_cohomology_class</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">t</span>
<span class="go">Kolyvagin cohomology class c(1) in H^1(K,E[3])</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClassEn">
<em class="property">class </em><tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">KolyvaginCohomologyClassEn</tt><big>(</big><em>kolyvagin_point</em>, <em>n</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClassEn" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClass" title="sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClass"><tt class="xref py py-class docutils literal"><span class="pre">sage.schemes.elliptic_curves.heegner.KolyvaginCohomologyClass</span></tt></a></p>
<p>EXAMPLES:</p>
</dd></dl>

<dl class="class">
<dt id="sage.schemes.elliptic_curves.heegner.KolyvaginPoint">
<em class="property">class </em><tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">KolyvaginPoint</tt><big>(</big><em>heegner_point</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.elliptic_curves.heegner.HeegnerPoint" title="sage.schemes.elliptic_curves.heegner.HeegnerPoint"><tt class="xref py py-class docutils literal"><span class="pre">sage.schemes.elliptic_curves.heegner.HeegnerPoint</span></tt></a></p>
<p>A Kolyvagin point.</p>
<p>EXAMPLES:</p>
<p>We create a few Kolyvagin points:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;11a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">Kolyvagin point of discriminant -7 on elliptic curve of conductor 11</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">Kolyvagin point of discriminant -7 on elliptic curve of conductor 37</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">67</span><span class="p">)</span>
<span class="go">Kolyvagin point of discriminant -67 on elliptic curve of conductor 37</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">Kolyvagin point of discriminant -7 and conductor 5 on elliptic curve of conductor 389</span>
</pre></div>
</div>
<p>One can also associated a Kolyvagin point to a Heegner point:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">);</span> <span class="n">y</span>
<span class="go">Heegner point of discriminant -7 on elliptic curve of conductor 37</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">()</span>
<span class="go">Kolyvagin point of discriminant -7 on elliptic curve of conductor 37</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.heegner.HeegnerPointOnEllipticCurve&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="o">==</span> <span class="n">y</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.KolyvaginPoint.curve">
<tt class="descname">curve</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint.curve" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the elliptic curve over <span class="math">\(\QQ\)</span> on which this Kolyvagin
point sits.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a1&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">67</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">curve</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 - x over Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.KolyvaginPoint.heegner_point">
<tt class="descname">heegner_point</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint.heegner_point" title="Permalink to this definition">¶</a></dt>
<dd><p>This Kolyvagin point <span class="math">\(P_c\)</span> is associated to some Heegner point
<span class="math">\(y_c\)</span> via Kolyvagin&#8217;s construction.  This function returns that
point <span class="math">\(y_c\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">67</span><span class="p">);</span> <span class="n">P</span>
<span class="go">Kolyvagin point of discriminant -67 on elliptic curve of conductor 37</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">();</span> <span class="n">y</span>
<span class="go">Heegner point of discriminant -67 on elliptic curve of conductor 37</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">()</span> <span class="ow">is</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.KolyvaginPoint.index">
<tt class="descname">index</tt><big>(</big><em>*args</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint.index" title="Permalink to this definition">¶</a></dt>
<dd><p>Return index of this Kolyvagin point in the full group of
<span class="math">\(K_c\)</span> rational points on <span class="math">\(E\)</span>.</p>
<p>When the conductor is 1, this is computed numerically using
the Gross-Zagier formula and explicit point search, and it may
be off by <span class="math">\(2\)</span>. See the documentation for <tt class="docutils literal"><span class="pre">E.heegner_index</span></tt>,
where <span class="math">\(E\)</span> is the curve attached to <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a1&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">67</span><span class="p">);</span> <span class="n">P</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>
<span class="go">6</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.KolyvaginPoint.kolyvagin_cohomology_class">
<tt class="descname">kolyvagin_cohomology_class</tt><big>(</big><em>n=None</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint.kolyvagin_cohomology_class" title="Permalink to this definition">¶</a></dt>
<dd><p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(n\)</span> &#8211; positive integer that divides the gcd of <span class="math">\(a_p\)</span>
and <span class="math">\(p+1\)</span> for all <span class="math">\(p\)</span> dividing the conductor.  If <span class="math">\(n\)</span> is
<tt class="docutils literal"><span class="pre">None</span></tt>, choose the largest valid <span class="math">\(n\)</span>.</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">kolyvagin_cohomology_class</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Kolyvagin cohomology class c(5) in H^1(K,E[3])</span>

<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">kolyvagin_cohomology_class</span><span class="p">()</span>
<span class="go">Kolyvagin cohomology class c(5) in H^1(K,E[2])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.KolyvaginPoint.mod">
<tt class="descname">mod</tt><big>(</big><em>p</em>, <em>prec=53</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint.mod" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the trace of the reduction <span class="math">\(Q\)</span> modulo a prime over <span class="math">\(p\)</span> of this
Kolyvagin point as an element of <span class="math">\(E(\GF{p})\)</span>, where
<span class="math">\(p\)</span> is any prime that is inert in <span class="math">\(K\)</span> that is coprime to <span class="math">\(NDc\)</span>.</p>
<p>The point <span class="math">\(Q\)</span> is only well defined up to an element of
<span class="math">\((p+1) E(\GF{p})\)</span>, i.e., it gives a well defined element
of the abelian group <span class="math">\(E(\GF{p}) / (p+1) E(\GF{p})\)</span>.</p>
<p>See <a class="reference internal" href="#steintoward" id="id1">[SteinToward]</a>, Proposition 5.4 for a proof of the above
well-definedness assertion.</p>
<p>EXAMPLES:</p>
<p>A Kolyvagin point on a rank 1 curve:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a1&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">67</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(1 : 1 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(1 : 0 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">(2 : 2 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">(6 : 0 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">trace_to_real_numerical</span><span class="p">()</span>
<span class="go">(1.61355529131986 : -2.18446840788880 : 1.00000000000000)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">_trace_exact_conductor_1</span><span class="p">()</span>  <span class="c"># the actual point we&#39;re reducing</span>
<span class="go">(1357/841 : -53277/24389 : 1)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">_trace_exact_conductor_1</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">/</span> <span class="n">E</span><span class="o">.</span><span class="n">regulator</span><span class="p">())</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>
<span class="go">12.0000000000000</span>
</pre></div>
</div>
<p>Here the Kolyvagin point is a torsion point (since <span class="math">\(E\)</span> has
rank 1), and we reduce it modulo several primes.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;11a1&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">70</span><span class="p">)</span>  <span class="c"># long time (4s on sage.math, 2013)</span>
<span class="go">(1 : 2 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">70</span><span class="p">)</span>
<span class="go">(1 : 4 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">70</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">p must be coprime to conductors and discriminant</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">70</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">p must be coprime to conductors and discriminant</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">70</span><span class="p">)</span>
<span class="go">(3 : 4 : 1)</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="steintoward" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[SteinToward]</a></td><td>Stein, &#8220;Toward a Generalization of the Gross-Zagier Conjecture&#8221;, Int Math Res Notices (2011), <a class="reference external" href="https://dx.doi.org/10.1093/imrn/rnq075">doi:10.1093/imrn/rnq075</a></td></tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.KolyvaginPoint.numerical_approx">
<tt class="descname">numerical_approx</tt><big>(</big><em>prec=53</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint.numerical_approx" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a numerical approximation to this Kolyvagin point using
prec bits of working precision.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">prec</span></tt> &#8211; precision in bits (default: 53)</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">);</span> <span class="n">P</span>
<span class="go">Kolyvagin point of discriminant -7 on elliptic curve of conductor 37</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">()</span> <span class="c"># approx. (0 : 0 : 1)</span>
<span class="go">(...e-16 - ...e-16*I : ...e-16 + ...e-16*I : 1.00000000000000)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">(</span><span class="mi">100</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">2.0</span><span class="o">^-</span><span class="mi">99</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span> <span class="n">P</span>
<span class="go">Kolyvagin point of discriminant -7 and conductor 5 on elliptic curve of conductor 389</span>
</pre></div>
</div>
<p>Numerical approximation is only implemented for points of conductor 1:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.KolyvaginPoint.plot">
<tt class="descname">plot</tt><big>(</big><em>prec=53</em>, <em>*args</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a Kolyvagin point <span class="math">\(P_1\)</span> if it is defined over the
rational numbers.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">pointsize</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">rgbcolor</span><span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">E</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="go">Graphics object consisting of 3 graphics primitives</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.KolyvaginPoint.point_exact">
<tt class="descname">point_exact</tt><big>(</big><em>prec=53</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint.point_exact" title="Permalink to this definition">¶</a></dt>
<dd><p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">prec</span></tt> &#8211; precision in bits (default: 53)</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<p>A rank 1 curve:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a1&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">67</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">point_exact</span><span class="p">()</span>
<span class="go">(6 : -15 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">point_exact</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>
<span class="go">(6 : -15 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">point_exact</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">insufficient precision to find exact point</span>
</pre></div>
</div>
<p>A rank 0 curve:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;11a1&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">point_exact</span><span class="p">()</span>
<span class="go">(-1/2*sqrt_minus_7 + 1/2 : -2*sqrt_minus_7 - 2 : 1)</span>
</pre></div>
</div>
<p>A rank 2 curve:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a1&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">point_exact</span><span class="p">()</span>
<span class="go">(0 : 1 : 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.KolyvaginPoint.satisfies_kolyvagin_hypothesis">
<tt class="descname">satisfies_kolyvagin_hypothesis</tt><big>(</big><em>n=None</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint.satisfies_kolyvagin_hypothesis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <tt class="docutils literal"><span class="pre">True</span></tt> if this Kolyvagin point satisfies the Heegner
hypothesis for <span class="math">\(n\)</span>, so that it defines a Galois equivariant
element of <span class="math">\(E(K_c)/n E(K_c)\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">kolyvagin_cohomology_class</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Kolyvagin cohomology class c(5) in H^1(K,E[3])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">satisfies_kolyvagin_hypothesis</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">satisfies_kolyvagin_hypothesis</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">satisfies_kolyvagin_hypothesis</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">satisfies_kolyvagin_hypothesis</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.KolyvaginPoint.trace_to_real_numerical">
<tt class="descname">trace_to_real_numerical</tt><big>(</big><em>prec=53</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.KolyvaginPoint.trace_to_real_numerical" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the trace of this Kolyvagin point down to the real
numbers, computed numerically using prec bits of working
precision.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a1&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">67</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">PP</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">();</span> <span class="n">PP</span>
<span class="go">(6.00000000000000 ... : -15.0000000000000 ... : 1.00000000000000)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">real</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">PP</span><span class="p">]</span>
<span class="go">[6.00000000000000, -15.0000000000000, 1.00000000000000]</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">imag</span><span class="p">()</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">1e-14</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">PP</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">trace_to_real_numerical</span><span class="p">()</span>
<span class="go">(1.61355529131986 : -2.18446840788880 : 1.00000000000000)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">trace_to_real_numerical</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
<span class="go">(1.6135552913198573127230 : -2.1844684078888023289187 : 1.0000000000000000000000)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.elliptic_curves.heegner.RingClassField">
<em class="property">class </em><tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">RingClassField</tt><big>(</big><em>D</em>, <em>c</em>, <em>check=True</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.RingClassField" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Sage Reference Manual: Basic Structures v7.0)"><tt class="xref py py-class docutils literal"><span class="pre">sage.structure.sage_object.SageObject</span></tt></a></p>
<p>A Ring class field of a quadratic imaginary field of given conductor.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is a <em>ring</em> class field, not a ray class field. In
general, the ring class field of given conductor is a subfield
of the ray class field of the same conductor.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="go">Hilbert class field of QQ[sqrt(-7)]</span>
<span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="go">Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
<span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">55</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="go">Ring class field extension of QQ[sqrt(-7)] of conductor 55</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K_c</span> <span class="o">=</span> <span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">K_c</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.heegner.RingClassField&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">K_c</span><span class="p">))</span> <span class="o">==</span> <span class="n">K_c</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.RingClassField.absolute_degree">
<tt class="descname">absolute_degree</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.RingClassField.absolute_degree" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the absolute degree of this field over <span class="math">\(\QQ\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">);</span> <span class="n">K</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">absolute_degree</span><span class="p">()</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">degree_over_K</span><span class="p">()</span>
<span class="go">6</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.RingClassField.conductor">
<tt class="descname">conductor</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.RingClassField.conductor" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the conductor of this ring class field.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">);</span> <span class="n">K5</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K5</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.RingClassField.degree_over_H">
<tt class="descname">degree_over_H</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.RingClassField.degree_over_H" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the degree of this field over the Hilbert class field <span class="math">\(H\)</span> of <span class="math">\(K\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">59</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_H</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">59</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_K</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">59</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">class_number</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
<p>Some examples in which prime dividing c is inert:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_H</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_H</span><span class="p">()</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_H</span><span class="p">()</span>
<span class="go">36</span>
</pre></div>
</div>
<p>The prime dividing c is split.  For example, in the first case
<span class="math">\(O_K/cO_K\)</span> is isomorphic to a direct sum of two copies of
<tt class="docutils literal"><span class="pre">GF(2)</span></tt>, so the units are trivial:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_H</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_H</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_H</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
<p>Now c is ramified:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_H</span><span class="p">()</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_H</span><span class="p">()</span>
<span class="go">49</span>
</pre></div>
</div>
<p>Check that <a class="reference external" href="http://trac.sagemath.org/15218">trac ticket #15218</a> is solved:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&quot;19a&quot;</span><span class="p">);</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">galois_group</span><span class="p">()</span><span class="o">.</span><span class="n">complex_conjugation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">domain</span><span class="p">();</span> <span class="n">H</span><span class="o">.</span><span class="n">absolute_degree</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.RingClassField.degree_over_K">
<tt class="descname">degree_over_K</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.RingClassField.degree_over_K" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the relative degree of this ring class field over the
quadratic imaginary field <span class="math">\(K\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K5</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">();</span> <span class="n">K5</span>
<span class="go">Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
<span class="gp">sage: </span><span class="n">K5</span><span class="o">.</span><span class="n">degree_over_K</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">K5</span><span class="o">.</span><span class="n">degree_over_K</span><span class="p">())</span>
<span class="go">&lt;type &#39;sage.rings.integer.Integer&#39;&gt;</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">);</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_K</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_K</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">kronecker</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">degree_over_K</span><span class="p">()</span>
<span class="go">24</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.RingClassField.degree_over_Q">
<tt class="descname">degree_over_Q</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.RingClassField.degree_over_Q" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the absolute degree of this field over <span class="math">\(\QQ\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">);</span> <span class="n">K</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">absolute_degree</span><span class="p">()</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">degree_over_K</span><span class="p">()</span>
<span class="go">6</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.RingClassField.discriminant_of_K">
<tt class="descname">discriminant_of_K</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.RingClassField.discriminant_of_K" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the discriminant of the quadratic imaginary field <span class="math">\(K\)</span> contained in <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">);</span> <span class="n">K5</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K5</span><span class="o">.</span><span class="n">discriminant_of_K</span><span class="p">()</span>
<span class="go">-7</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.RingClassField.galois_group">
<tt class="descname">galois_group</tt><big>(</big><em>base=Rational Field</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.RingClassField.galois_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Galois group of <tt class="docutils literal"><span class="pre">self</span></tt> over base.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">base</span></tt> &#8211; (default: <span class="math">\(\QQ\)</span>) a subfield of <tt class="docutils literal"><span class="pre">self</span></tt> or <span class="math">\(\QQ\)</span></li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">galois_group</span><span class="p">()</span>
<span class="go">Galois group of Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">galois_group</span><span class="p">()</span>
<span class="go">Galois group of Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">Galois group of Ring class field extension of QQ[sqrt(-7)] of conductor 5 over Hilbert class field of QQ[sqrt(-7)]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">galois_group</span><span class="p">()</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">B</span><span class="p">)</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">Galois group of Ring class field extension of QQ[sqrt(-7)] of conductor 15 over Ring class field extension of QQ[sqrt(-7)] of conductor 5</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.RingClassField.is_subfield">
<tt class="descname">is_subfield</tt><big>(</big><em>M</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.RingClassField.is_subfield" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <tt class="docutils literal"><span class="pre">True</span></tt> if this ring class field is a subfield of the ring class field <span class="math">\(M\)</span>.
If <span class="math">\(M\)</span> is not a ring class field, then a TypeError is raised.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">is_subfield</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">is_subfield</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">is_subfield</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">is_subfield</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_subfield</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_subfield</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.RingClassField.quadratic_field">
<tt class="descname">quadratic_field</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.RingClassField.quadratic_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the quadratic imaginary field <span class="math">\(K = \QQ(\sqrt{D})\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">);</span> <span class="n">K</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">quadratic_field</span><span class="p">()</span>
<span class="go">Number Field in sqrt_minus_7 with defining polynomial x^2 + 7</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.heegner.RingClassField.ramified_primes">
<tt class="descname">ramified_primes</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.RingClassField.ramified_primes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the primes of <span class="math">\(\ZZ\)</span> that ramify in this ring class field.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">);</span> <span class="n">K55</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">55</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K55</span><span class="o">.</span><span class="n">ramified_primes</span><span class="p">()</span>
<span class="go">[5, 7, 11]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">ring_class_field</span><span class="p">()</span><span class="o">.</span><span class="n">ramified_primes</span><span class="p">()</span>
<span class="go">[7]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.heegner.class_number">
<tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">class_number</tt><big>(</big><em>D</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.class_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the class number of the quadratic field with fundamental
discriminant <span class="math">\(D\)</span>.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(D\)</span> &#8211; integer</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">class_number</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">class_number</span><span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">class_number</span><span class="p">(</span><span class="o">-</span><span class="mi">163</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>A ValueError is raised when <span class="math">\(D\)</span> is not a fundamental
discriminant:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">class_number</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">D (=-5) must be a fundamental discriminant</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.heegner.ell_heegner_discriminants">
<tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">ell_heegner_discriminants</tt><big>(</big><em>self</em>, <em>bound</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.ell_heegner_discriminants" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of self&#8217;s Heegner discriminants between -1 and
-bound.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">bound</span> <span class="pre">(int)</span></tt> - upper bound for -discriminant</li>
</ul>
<p>OUTPUT: The list of Heegner discriminants between -1 and -bound for
the given elliptic curve.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_discriminants</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>                     <span class="c"># indirect doctest</span>
<span class="go">[-7, -8, -19, -24]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.heegner.ell_heegner_discriminants_list">
<tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">ell_heegner_discriminants_list</tt><big>(</big><em>self</em>, <em>n</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.ell_heegner_discriminants_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of self&#8217;s first <span class="math">\(n\)</span> Heegner discriminants smaller
than -5.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">n</span> <span class="pre">(int)</span></tt> - the number of discriminants to
compute</li>
</ul>
<p>OUTPUT: The list of the first n Heegner discriminants smaller than
-5 for the given elliptic curve.</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_discriminants_list</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>                     <span class="c"># indirect doctest</span>
<span class="go">[-7, -8, -19, -24]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.heegner.ell_heegner_point">
<tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">ell_heegner_point</tt><big>(</big><em>self</em>, <em>D</em>, <em>c=1</em>, <em>f=None</em>, <em>check=True</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.ell_heegner_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Heegner point on this curve associated to the
quadratic imaginary field <span class="math">\(K=\QQ(\sqrt{D})\)</span>.</p>
<p>If the optional parameter <span class="math">\(c\)</span> is given, returns the higher Heegner
point associated to the order of conductor <span class="math">\(c\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><span class="math">\(D\)</span>        &#8211; a Heegner discriminant</li>
<li><span class="math">\(c\)</span>        &#8211; (default: 1) conductor, must be coprime to <span class="math">\(DN\)</span></li>
<li><span class="math">\(f\)</span>        &#8211; binary quadratic form or 3-tuple <span class="math">\((A,B,C)\)</span> of coefficients
of <span class="math">\(AX^2 + BXY + CY^2\)</span></li>
<li><tt class="docutils literal"><span class="pre">check</span></tt>  &#8211; bool (default: <tt class="docutils literal"><span class="pre">True</span></tt>)</li>
</ul>
<p>OUTPUT:</p>
<p>The Heegner point <span class="math">\(y_c\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_discriminants_list</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[-7, -11, -40, -47, -67, -71, -83, -84, -95, -104]</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">);</span> <span class="n">P</span>                          <span class="c"># indirect doctest</span>
<span class="go">Heegner point of discriminant -7 on elliptic curve of conductor 37</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">point_exact</span><span class="p">()</span>
<span class="go">(0 : 0 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">curve</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 - x over Rational Field</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">40</span><span class="p">)</span><span class="o">.</span><span class="n">point_exact</span><span class="p">();</span> <span class="n">P</span>
<span class="go">(a : -a + 1 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">47</span><span class="p">)</span><span class="o">.</span><span class="n">point_exact</span><span class="p">();</span> <span class="n">P</span>
<span class="go">(a : a^4 + a - 1 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Number Field in a with defining polynomial x^5 - x^4 + x^3 + x^2 - 2*x + 1</span>
</pre></div>
</div>
<p>Working out the details manually:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">47</span><span class="p">)</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">algdep</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">5</span><span class="p">);</span> <span class="n">f</span>
<span class="go">x^5 - x^4 + x^3 + x^2 - 2*x + 1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">47^2</span>
</pre></div>
</div>
<p>The Heegner hypothesis is checked:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">);</span> <span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">);</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">N (=389) and D (=-5) must satisfy the Heegner hypothesis</span>
</pre></div>
</div>
<p>We can specify the quadratic form:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_point</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="mi">778</span><span class="p">,</span><span class="mi">925</span><span class="p">,</span><span class="mi">275</span><span class="p">));</span> <span class="n">P</span>
<span class="go">Heegner point of discriminant -7 and conductor 5 on elliptic curve of conductor 389</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">quadratic_form</span><span class="p">()</span>
<span class="go">778*x^2 + 925*x*y + 275*y^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.heegner.heegner_index">
<tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">heegner_index</tt><big>(</big><em>self</em>, <em>D</em>, <em>min_p=2</em>, <em>prec=5</em>, <em>descent_second_limit=12</em>, <em>verbose_mwrank=False</em>, <em>check_rank=True</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.heegner_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an interval that contains the index of the Heegner
point <span class="math">\(y_K\)</span> in the group of <span class="math">\(K\)</span>-rational points modulo torsion
on this elliptic curve, computed using the Gross-Zagier
formula and/or a point search, or possibly half the index
if the rank is greater than one.</p>
<p>If the curve has rank &gt; 1, then the returned index is infinity.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If <tt class="docutils literal"><span class="pre">min_p</span></tt> is bigger than 2 then the index can be off by
any prime less than <tt class="docutils literal"><span class="pre">min_p</span></tt>. This function returns the
index divided by <span class="math">\(2\)</span> exactly when the rank of <span class="math">\(E(K)\)</span> is
greater than 1 and <span class="math">\(E(\QQ)_{/tor} \oplus E^D(\QQ)_{/tor}\)</span>
has index <span class="math">\(2\)</span> in <span class="math">\(E(K)_{/tor}\)</span>, where the second factor
undergoes a twist.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">D</span> <span class="pre">(int)</span></tt> - Heegner discriminant</li>
<li><tt class="docutils literal"><span class="pre">min_p</span> <span class="pre">(int)</span></tt> - (default: 2) only rule out primes
= min_p dividing the index.</li>
<li><tt class="docutils literal"><span class="pre">verbose_mwrank</span> <span class="pre">(bool)</span></tt> - (default: <tt class="docutils literal"><span class="pre">False</span></tt>); print lots of
mwrank search status information when computing regulator</li>
<li><tt class="docutils literal"><span class="pre">prec</span> <span class="pre">(int)</span></tt> - (default: 5), use prec*sqrt(N) +
20 terms of L-series in computations, where N is the conductor.</li>
<li><tt class="docutils literal"><span class="pre">descent_second_limit</span></tt> - (default: 12)- used in 2-descent
when computing regulator of the twist</li>
<li><tt class="docutils literal"><span class="pre">check_rank</span></tt> - whether to check if the rank is at least 2 by
computing the Mordell-Weil rank directly.</li>
</ul>
<p>OUTPUT: an interval that contains the index, or half the index</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_discriminants</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="go">[-7, -8, -19, -24, -35, -39, -40, -43]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_index</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">1.00000?</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37b&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_discriminants</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">[-3, -4, -7, -11, -40, -47, -67, -71, -83, -84, -95]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_index</span><span class="p">(</span><span class="o">-</span><span class="mi">95</span><span class="p">)</span>          <span class="c"># long time (1 second)</span>
<span class="go">2.00000?</span>
</pre></div>
</div>
<p>This tests doing direct computation of the Mordell-Weil group.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;675b&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_index</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">)</span>
<span class="go">3.0000?</span>
</pre></div>
</div>
<p>Currently discriminants -3 and -4 are not supported:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_index</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ArithmeticError</span>: <span class="n">Discriminant (=-3) must not be -3 or -4.</span>
</pre></div>
</div>
<p>The curve 681b returns the true index, which is <span class="math">\(3\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;681b&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_index</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">);</span> <span class="n">I</span>
<span class="go">3.0000?</span>
</pre></div>
</div>
<p>In fact, whenever the returned index has a denominator of
<span class="math">\(2\)</span>, the true index is got by multiplying the returned
index by <span class="math">\(2\)</span>. Unfortunately, this is not an if and only if
condition, i.e., sometimes the index must be multiplied by
<span class="math">\(2\)</span> even though the denominator is not <span class="math">\(2\)</span>.</p>
<p>This example demonstrates the <tt class="docutils literal"><span class="pre">descent_second_limit</span></tt> option,
which can be used to fine tune the 2-descent used to compute
the regulator of the twist:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">34874</span><span class="p">,</span> <span class="o">-</span><span class="mi">2506691</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_index</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">...</span>
</pre></div>
</div>
<p>However when we search higher, we find the points we need:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_index</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="n">descent_second_limit</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">check_rank</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">1.00000?</span>
</pre></div>
</div>
<p>Two higher rank examples (of ranks 2 and 3):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_index</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;5077a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_index</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_index</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="n">check_rank</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">0.001?</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_index</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="n">check_rank</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.heegner.heegner_index_bound">
<tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">heegner_index_bound</tt><big>(</big><em>self</em>, <em>D=0</em>, <em>prec=5</em>, <em>max_height=None</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.heegner_index_bound" title="Permalink to this definition">¶</a></dt>
<dd><p>Assume <tt class="docutils literal"><span class="pre">self</span></tt> has rank 0.</p>
<p>Return a list <span class="math">\(v\)</span> of primes such that if an odd prime <span class="math">\(p\)</span> divides
the index of the Heegner point in the group of rational points
modulo torsion, then <span class="math">\(p\)</span> is in <span class="math">\(v\)</span>.</p>
<p>If 0 is in the interval of the height of the Heegner point
computed to the given prec, then this function returns <span class="math">\(v =
0\)</span>. This does not mean that the Heegner point is torsion, just
that it is very likely torsion.</p>
<p>If we obtain no information from a search up to <tt class="docutils literal"><span class="pre">max_height</span></tt>,
e.g., if the Siksek et al. bound is bigger than <tt class="docutils literal"><span class="pre">max_height</span></tt>,
then we return <span class="math">\(v = -1\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">D</span> <span class="pre">(int)</span></tt> - (default: 0) Heegner discriminant; if
0, use the first discriminant -4 that satisfies the Heegner
hypothesis</li>
<li><tt class="docutils literal"><span class="pre">verbose</span> <span class="pre">(bool)</span></tt> - (default: <tt class="docutils literal"><span class="pre">True</span></tt>)</li>
<li><tt class="docutils literal"><span class="pre">prec</span> <span class="pre">(int)</span></tt> - (default: 5), use <span class="math">\(prec \cdot \sqrt(N) + 20\)</span>
terms of <span class="math">\(L\)</span>-series in computations, where <span class="math">\(N\)</span> is the conductor.</li>
<li><tt class="docutils literal"><span class="pre">max_height</span> <span class="pre">(float)</span></tt> - should be = 21; bound on
logarithmic naive height used in point searches. Make smaller to
make this function faster, at the expense of possibly obtaining a
worse answer. A good range is between 13 and 21.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">v</span></tt> - list or int (bad primes or 0 or -1)</li>
<li><tt class="docutils literal"><span class="pre">D</span></tt> - the discriminant that was used (this is
useful if <span class="math">\(D\)</span> was automatically selected).</li>
<li><tt class="docutils literal"><span class="pre">exact</span></tt> - either False, or the exact Heegner index
(up to factors of 2)</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_index_bound</span><span class="p">()</span>
<span class="go">([2], -7, 2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.heegner.heegner_point">
<tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">heegner_point</tt><big>(</big><em>N</em>, <em>D=None</em>, <em>c=1</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.heegner_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a specific Heegner point of level <span class="math">\(N\)</span> with given
discriminant and conductor.  If <span class="math">\(D\)</span> is not specified, then the
first valid Heegner discriminant is used.  If <span class="math">\(c\)</span> is not given,
then <span class="math">\(c=1\)</span> is used.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(N\)</span> &#8211; level (positive integer)</li>
<li><span class="math">\(D\)</span> &#8211; discriminant (optional: default first valid <span class="math">\(D\)</span>)</li>
<li><span class="math">\(c\)</span> &#8211; conductor (positive integer, optional, default: 1)</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span>
<span class="go">Heegner point 1/778*sqrt(-7) - 185/778 of discriminant -7 on X_0(389)</span>
<span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">Heegner point 1/778*sqrt(-7) - 185/778 of discriminant -7 on X_0(389)</span>
<span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Heegner point 5/778*sqrt(-7) - 147/778 of discriminant -7 and conductor 5 on X_0(389)</span>
<span class="gp">sage: </span><span class="n">heegner_point</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">20</span><span class="p">)</span>
<span class="go">Heegner point 1/778*sqrt(-20) - 165/389 of discriminant -20 on X_0(389)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.heegner.heegner_point_height">
<tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">heegner_point_height</tt><big>(</big><em>self</em>, <em>D</em>, <em>prec=2</em>, <em>check_rank=True</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.heegner_point_height" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the Gross-Zagier formula to compute the Neron-Tate canonical
height over <span class="math">\(K\)</span> of the Heegner point corresponding to <span class="math">\(D\)</span>, as an
interval (it is computed to some precision using <span class="math">\(L\)</span>-functions).</p>
<p>If the curve has rank at least 2, then the returned height is the
exact Sage integer 0.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">D</span> <span class="pre">(int)</span></tt> - fundamental discriminant (=/= -3, -4)</p>
</li>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">prec</span> <span class="pre">(int)</span></tt> - (default: 2), use <span class="math">\(prec \cdot \sqrt(N) + 20\)</span></dt>
<dd><p class="first last">terms of <span class="math">\(L\)</span>-series in computations, where <span class="math">\(N\)</span> is the
conductor.</p>
</dd>
</dl>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">check_rank</span></tt> - whether to check if the rank is at least 2 by
computing the Mordell-Weil rank directly.</p>
</li>
</ul>
<p>OUTPUT: Interval that contains the height of the Heegner point.</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point_height</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">0.22227?</span>
</pre></div>
</div>
<p>Some higher rank examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point_height</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;5077a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point_height</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_point_height</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="n">check_rank</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">0.0000?</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.heegner.heegner_points">
<tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">heegner_points</tt><big>(</big><em>N</em>, <em>D=None</em>, <em>c=None</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.heegner_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all Heegner points of given level <span class="math">\(N\)</span>.  Can also restrict
to Heegner points with specified discriminant <span class="math">\(D\)</span> and optionally
conductor <span class="math">\(c\)</span>.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(N\)</span> &#8211; level (positive integer)</li>
<li><span class="math">\(D\)</span> &#8211; discriminant (negative integer)</li>
<li><span class="math">\(c\)</span> &#8211; conductor (positive integer)</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">Set of all Heegner points on X_0(389) associated to QQ[sqrt(-7)]</span>
<span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">All Heegner points of conductor 1 on X_0(389) associated to QQ[sqrt(-7)]</span>
<span class="gp">sage: </span><span class="n">heegner_points</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">All Heegner points of conductor 5 on X_0(389) associated to QQ[sqrt(-7)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.heegner.heegner_sha_an">
<tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">heegner_sha_an</tt><big>(</big><em>self</em>, <em>D</em>, <em>prec=53</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.heegner_sha_an" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the conjectural (analytic) order of Sha for E over the field <span class="math">\(K=\QQ(\sqrt{D})\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><span class="math">\(D\)</span> &#8211; negative integer; the Heegner discriminant</li>
<li>prec &#8211; integer (default: 53); bits of precision to
compute analytic order of Sha</li>
</ul>
<p>OUTPUT:</p>
<p>(floating point number) an approximation to the conjectural order of Sha.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Often you&#8217;ll want to do <tt class="docutils literal"><span class="pre">proof.elliptic_curve(False)</span></tt> when
using this function, since often the twisted elliptic
curves that come up have enormous conductor, and Sha is
nontrivial, which makes provably finding the Mordell-Weil
group using 2-descent difficult.</p>
</div>
<p>EXAMPLES:</p>
<p>An example where E has conductor 11:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_sha_an</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>                                  <span class="c"># long time</span>
<span class="go">1.00000000000000</span>
</pre></div>
</div>
<p>The cache works:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_sha_an</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span> <span class="ow">is</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_sha_an</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>          <span class="c"># long time</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Lower precision:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_sha_an</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>                               <span class="c"># long time</span>
<span class="go">1.0</span>
</pre></div>
</div>
<p>Checking that the cache works for any precision:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_sha_an</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="ow">is</span> <span class="n">E</span><span class="o">.</span><span class="n">heegner_sha_an</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>    <span class="c"># long time</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Next we consider a rank 1 curve with nontrivial Sha over the
quadratic imaginary field <span class="math">\(K\)</span>; however, there is no Sha for <span class="math">\(E\)</span>
over <span class="math">\(\QQ\)</span> or for the quadratic twist of <span class="math">\(E\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_sha_an</span><span class="p">(</span><span class="o">-</span><span class="mi">40</span><span class="p">)</span>                                 <span class="c"># long time</span>
<span class="go">4.00000000000000</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">quadratic_twist</span><span class="p">(</span><span class="o">-</span><span class="mi">40</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>                     <span class="c"># long time</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>                                          <span class="c"># long time</span>
<span class="go">1</span>
</pre></div>
</div>
<p>A rank 2 curve:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">)</span>                             <span class="c"># long time</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_sha_an</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>                                  <span class="c"># long time</span>
<span class="go">1.00000000000000</span>
</pre></div>
</div>
<p>If we remove the hypothesis that <span class="math">\(E(K)\)</span> has rank 1 in Conjecture
2.3 in [Gross-Zagier, 1986, page 311], then that conjecture is
false, as the following example shows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;65a&#39;</span><span class="p">)</span>                              <span class="c"># long time</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">heegner_sha_an</span><span class="p">(</span><span class="o">-</span><span class="mi">56</span><span class="p">)</span>                                 <span class="c"># long time</span>
<span class="go">1.00000000000000</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">torsion_order</span><span class="p">()</span>                                     <span class="c"># long time</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">tamagawa_product</span><span class="p">()</span>                                  <span class="c"># long time</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">quadratic_twist</span><span class="p">(</span><span class="o">-</span><span class="mi">56</span><span class="p">)</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>                         <span class="c"># long time</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.heegner.is_inert">
<tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">is_inert</tt><big>(</big><em>D</em>, <em>p</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.is_inert" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <tt class="docutils literal"><span class="pre">True</span></tt> if p is an inert prime in the field <span class="math">\(\QQ(\sqrt{D})\)</span>.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(D\)</span> &#8211; fundamental discriminant</li>
<li><span class="math">\(p\)</span> &#8211; prime integer</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">is_inert</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">is_inert</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">is_inert</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.heegner.is_kolyvagin_conductor">
<tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">is_kolyvagin_conductor</tt><big>(</big><em>N</em>, <em>E</em>, <em>D</em>, <em>r</em>, <em>n</em>, <em>c</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.is_kolyvagin_conductor" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <tt class="docutils literal"><span class="pre">True</span></tt> if <span class="math">\(c\)</span> is a Kolyvagin conductor for level <span class="math">\(N\)</span>,
discriminant <span class="math">\(D\)</span>, mod <span class="math">\(n\)</span>, etc., i.e., <span class="math">\(c\)</span> is divisible by exactly
<span class="math">\(r\)</span> prime factors, is coprime to <span class="math">\(ND\)</span>, each prime dividing <span class="math">\(c\)</span> is
inert, and if <span class="math">\(E\)</span> is not <tt class="docutils literal"><span class="pre">None</span></tt> then <span class="math">\(n | \gcd(p+1, a_p(E))\)</span>
for each prime <span class="math">\(p\)</span> dividing <span class="math">\(c\)</span>.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(N\)</span> &#8211; level (positive integer)</li>
<li><span class="math">\(E\)</span> &#8211; elliptic curve or <tt class="docutils literal"><span class="pre">None</span></tt></li>
<li><span class="math">\(D\)</span> &#8211; negative fundamental discriminant</li>
<li><span class="math">\(r\)</span> &#8211; number of prime factors (nonnegative integer) or <tt class="docutils literal"><span class="pre">None</span></tt></li>
<li><span class="math">\(n\)</span> &#8211; torsion order (i.e., do we get class in <span class="math">\((E(K_c)/n E(K_c))^{Gal(K_c/K)}\)</span>?)</li>
<li><span class="math">\(c\)</span> &#8211; conductor (positive integer)</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.heegner</span> <span class="kn">import</span> <span class="n">is_kolyvagin_conductor</span>
<span class="gp">sage: </span><span class="n">is_kolyvagin_conductor</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_kolyvagin_conductor</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_kolyvagin_conductor</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_kolyvagin_conductor</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">),</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_kolyvagin_conductor</span><span class="p">(</span><span class="mi">389</span><span class="p">,</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">),</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.heegner.is_ramified">
<tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">is_ramified</tt><big>(</big><em>D</em>, <em>p</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.is_ramified" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <tt class="docutils literal"><span class="pre">True</span></tt> if p is a ramified prime in the field <span class="math">\(\QQ(\sqrt{D})\)</span>.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(D\)</span> &#8211; fundamental discriminant</li>
<li><span class="math">\(p\)</span> &#8211; prime integer</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">is_ramified</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">is_ramified</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">is_ramified</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.heegner.is_split">
<tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">is_split</tt><big>(</big><em>D</em>, <em>p</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.is_split" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <tt class="docutils literal"><span class="pre">True</span></tt> if p is a split prime in the field <span class="math">\(\QQ(\sqrt{D})\)</span>.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(D\)</span> &#8211; fundamental discriminant</li>
<li><span class="math">\(p\)</span> &#8211; prime integer</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">is_split</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">is_split</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">is_split</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.heegner.kolyvagin_point">
<tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">kolyvagin_point</tt><big>(</big><em>self</em>, <em>D</em>, <em>c=1</em>, <em>check=True</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.kolyvagin_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Kolyvagin point on this curve associated to the
quadratic imaginary field <span class="math">\(K=\QQ(\sqrt{D})\)</span> and conductor <span class="math">\(c\)</span>.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(D\)</span>        &#8211; a Heegner discriminant</li>
<li><span class="math">\(c\)</span>        &#8211; (default: 1) conductor, must be coprime to <span class="math">\(DN\)</span></li>
<li><tt class="docutils literal"><span class="pre">check</span></tt>  &#8211; bool (default: <tt class="docutils literal"><span class="pre">True</span></tt>)</li>
</ul>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div>The Kolyvagin point <span class="math">\(P\)</span> of conductor <span class="math">\(c\)</span>.</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">kolyvagin_point</span><span class="p">(</span><span class="o">-</span><span class="mi">67</span><span class="p">);</span> <span class="n">P</span>
<span class="go">Kolyvagin point of discriminant -67 on elliptic curve of conductor 37</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">()</span> <span class="c"># imaginary parts approx. 0</span>
<span class="go">(6.00000000000000 ... : -15.0000000000000 ... : 1.00000000000000)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="c"># a generator</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">regulator</span><span class="p">()</span> <span class="o">==</span> <span class="n">E</span><span class="o">.</span><span class="n">regulator_of_points</span><span class="p">([</span><span class="n">g</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="mi">6</span><span class="o">*</span><span class="n">g</span>
<span class="go">(6 : -15 : 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.heegner.kolyvagin_reduction_data">
<tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">kolyvagin_reduction_data</tt><big>(</big><em>E</em>, <em>q</em>, <em>first_only=True</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.kolyvagin_reduction_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an elliptic curve of positive rank and a prime <span class="math">\(q\)</span>, this
function returns data about how to use Kolyvagin&#8217;s <span class="math">\(q\)</span>-torsion
Heegner point Euler system to do computations with this curve.
See the precise description of the output below.</p>
<p>INPUT:</p>
<blockquote>
<div><ul>
<li><p class="first"><span class="math">\(E\)</span> &#8211; elliptic curve over <span class="math">\(\QQ\)</span> of rank 1 or 2</p>
</li>
<li><dl class="first docutils">
<dt><span class="math">\(q\)</span> &#8211; an odd prime that does not divide the order of the</dt>
<dd><p class="first last">rational torsion subgroup of <span class="math">\(E\)</span></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">first_only</span></tt> &#8211; bool (default: <tt class="docutils literal"><span class="pre">True</span></tt>) whether two only return</dt>
<dd><p class="first last">the first prime that one can work modulo to get data about
the Euler system</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p>OUTPUT in the rank 1 case or when the default flag <tt class="docutils literal"><span class="pre">first_only=True</span></tt>:</p>
<blockquote>
<div><ul>
<li><dl class="first docutils">
<dt><span class="math">\(\ell\)</span> &#8211; first good odd prime satisfying the Kolyvagin</dt>
<dd><p class="first last">condition that <span class="math">\(q\)</span> divides gcd(a_{ell},ell+1)` and the
reduction map is surjective to <span class="math">\(E(\GF{\ell}) / q
E(\GF{\ell})\)</span></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><span class="math">\(D\)</span> &#8211; discriminant of the first quadratic imaginary field</dt>
<dd><p class="first last"><span class="math">\(K\)</span> that satisfies the Heegner hypothesis for <span class="math">\(E\)</span> such that
both <span class="math">\(\ell\)</span> is inert in <span class="math">\(K\)</span>, and the twist <span class="math">\(E^D\)</span> has analytic
rank <span class="math">\(\leq 1\)</span></p>
</dd>
</dl>
</li>
<li><p class="first"><span class="math">\(h_D\)</span> &#8211; the class number of <span class="math">\(K\)</span></p>
</li>
<li><p class="first">the dimension of the Brandt module <span class="math">\(B(\ell,N)\)</span>, where <span class="math">\(N\)</span> is
the conductor of <span class="math">\(E\)</span></p>
</li>
</ul>
</div></blockquote>
<p>OUTPUT in the rank 2 case:</p>
<blockquote>
<div><ul>
<li><p class="first"><span class="math">\(\ell_1\)</span> &#8211; first prime (as above in the rank 1 case) where
reduction map is surjective</p>
</li>
<li><p class="first"><span class="math">\(\ell_2\)</span> &#8211; second prime (as above) where reduction map is
surjective</p>
</li>
<li><dl class="first docutils">
<dt><span class="math">\(D\)</span> &#8211; discriminant of the first quadratic imaginary field</dt>
<dd><p class="first last"><span class="math">\(K\)</span> that satisfies the Heegner hypothesis for <span class="math">\(E\)</span> such that
both <span class="math">\(\ell_1\)</span> and <span class="math">\(\ell_2\)</span> are simultaneously inert in <span class="math">\(K\)</span>,
and the twist <span class="math">\(E^D\)</span> has analytic rank <span class="math">\(\leq 1\)</span></p>
</dd>
</dl>
</li>
<li><p class="first"><span class="math">\(h_D\)</span> &#8211; the class number of <span class="math">\(K\)</span></p>
</li>
<li><p class="first">the dimension of the Brandt module <span class="math">\(B(\ell_1,N)\)</span>, where <span class="math">\(N\)</span> is
the conductor of <span class="math">\(E\)</span></p>
</li>
<li><p class="first">the dimension of the Brandt module <span class="math">\(B(\ell_2,N)\)</span></p>
</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<p>Import this function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.heegner</span> <span class="kn">import</span> <span class="n">kolyvagin_reduction_data</span>
</pre></div>
</div>
<p>A rank 1 example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">kolyvagin_reduction_data</span><span class="p">(</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a1&#39;</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(17, -7, 1, 52)</span>
</pre></div>
</div>
<p>A rank 3 example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">kolyvagin_reduction_data</span><span class="p">(</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;5077a1&#39;</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(11, -47, 5, 4234)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">5077</span><span class="p">,</span> <span class="o">-</span><span class="mi">47</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_conductors</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;5077a1&#39;</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span> <span class="k">if</span> <span class="n">c</span><span class="o">%</span><span class="mi">11</span><span class="p">]</span>
<span class="go">[667, 943, 1189, 2461]</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="mi">667</span><span class="p">)</span>
<span class="go">23 * 29</span>
</pre></div>
</div>
<p>A rank 4 example (the first Kolyvagin class that we could try to
compute would be <span class="math">\(P_{23\cdot 29\cdot 41}\)</span>, and would require
working in a space of dimension 293060 (so prohibitive at
present):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">elliptic_curves</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="mi">4</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">kolyvagin_reduction_data</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>              <span class="c"># long time</span>
<span class="go">(11, -71, 7, 293060)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">heegner_points</span><span class="p">(</span><span class="mi">293060</span><span class="p">,</span> <span class="o">-</span><span class="mi">71</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">kolyvagin_conductors</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[11, 17, 23, 41]</span>
</pre></div>
</div>
<p>The first rank 2 example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">kolyvagin_reduction_data</span><span class="p">(</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(5, -7, 1, 130)</span>
<span class="gp">sage: </span><span class="n">kolyvagin_reduction_data</span><span class="p">(</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;389a&#39;</span><span class="p">),</span><span class="mi">3</span><span class="p">,</span> <span class="n">first_only</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">(5, 17, -7, 1, 130, 520)</span>
</pre></div>
</div>
<p>A large <span class="math">\(q = 7\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">kolyvagin_reduction_data</span><span class="p">(</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;1143c1&#39;</span><span class="p">),</span><span class="mi">7</span><span class="p">,</span> <span class="n">first_only</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">(13, 83, -59, 3, 1536, 10496)</span>
</pre></div>
</div>
<p>Additive reduction:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">kolyvagin_reduction_data</span><span class="p">(</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;2350g1&#39;</span><span class="p">),</span><span class="mi">5</span><span class="p">,</span> <span class="n">first_only</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">(19, 239, -311, 19, 6480, 85680)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.heegner.make_monic">
<tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">make_monic</tt><big>(</big><em>f</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.make_monic" title="Permalink to this definition">¶</a></dt>
<dd><p><tt class="docutils literal"><span class="pre">make_monic</span></tt> returns a monic integral polynomial <span class="math">\(g\)</span> and an
integer <span class="math">\(d\)</span> such that if <span class="math">\(\alpha\)</span> is a root of <span class="math">\(g\)</span> then a root of
<span class="math">\(f\)</span> is <span class="math">\(\alpha/d\)</span>.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li>f &#8211; polynomial over the rational numbers</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">make_monic</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">14</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">7</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">(x^3 + 14*x^2 - 21*x + 45, 3)</span>
</pre></div>
</div>
<p>In this example we verify that make_monic does what we claim it does:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">17</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">/</span><span class="mi">7</span><span class="o">+</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">minpoly</span><span class="p">();</span> <span class="n">f</span>
<span class="go">x^3 - 2*x^2 + 247/147*x - 4967/9261</span>
<span class="gp">sage: </span><span class="n">g</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">make_monic</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span>
<span class="go">x^3 - 18522*x^2 + 144110421*x - 426000323007</span>
<span class="gp">sage: </span><span class="n">d</span>
<span class="go">9261</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">b</span><span class="o">/</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>
<span class="go">x^3 - 2*x^2 + 247/147*x - 4967/9261</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.heegner.nearby_rational_poly">
<tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">nearby_rational_poly</tt><big>(</big><em>f</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.nearby_rational_poly" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a polynomial whose coefficients are rational numbers close
to the coefficients of <span class="math">\(f\)</span>.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(f\)</span> &#8211; polynomial with real floating point entries</li>
<li><tt class="docutils literal"><span class="pre">**kwds</span></tt> &#8211; passed on to <tt class="docutils literal"><span class="pre">nearby_rational</span></tt> method</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">RR</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">nearby_rational_poly</span><span class="p">(</span><span class="mf">2.1</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">3.5</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mf">1.2</span><span class="p">,</span> <span class="n">max_error</span><span class="o">=</span><span class="mf">10e-16</span><span class="p">)</span>
<span class="go">21/10*X^2 + 7/2*X - 6/5</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">nearby_rational_poly</span><span class="p">(</span><span class="mf">2.1</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">3.5</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mf">1.2</span><span class="p">,</span> <span class="n">max_error</span><span class="o">=</span><span class="mf">10e-17</span><span class="p">)</span>
<span class="go">4728779608739021/2251799813685248*X^2 + 7/2*X - 5404319552844595/4503599627370496</span>
<span class="gp">sage: </span><span class="n">RR</span><span class="p">(</span><span class="mi">4728779608739021</span><span class="o">/</span><span class="mi">2251799813685248</span>  <span class="o">-</span> <span class="mi">21</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span>
<span class="go">8.88178419700125e-17</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.heegner.quadratic_order">
<tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">quadratic_order</tt><big>(</big><em>D</em>, <em>c</em>, <em>names='a'</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.quadratic_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return order of conductor <span class="math">\(c\)</span> in quadratic field with fundamental
discriminant <span class="math">\(D\)</span>.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(D\)</span> &#8211; fundamental discriminant</li>
<li><span class="math">\(c\)</span> &#8211; conductor</li>
<li><tt class="docutils literal"><span class="pre">names</span></tt> &#8211; string (default: &#8216;a&#8217;)</li>
</ul>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><ul class="simple">
<li>order <span class="math">\(R\)</span> of conductor <span class="math">\(c\)</span> in an imaginary quadratic field</li>
<li>the element <span class="math">\(c\sqrt{D}\)</span> as an element of <span class="math">\(R\)</span></li>
</ul>
</div></blockquote>
<p>The generator for the field is named &#8216;a&#8217; by default.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">quadratic_order</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(Order in Number Field in a with defining polynomial x^2 + 7, 3*a)</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">quadratic_order</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="s">&#39;alpha&#39;</span><span class="p">)</span>
<span class="go">(Order in Number Field in alpha with defining polynomial x^2 + 7, 3*alpha)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.heegner.satisfies_heegner_hypothesis">
<tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">satisfies_heegner_hypothesis</tt><big>(</big><em>self</em>, <em>D</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.satisfies_heegner_hypothesis" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <tt class="docutils literal"><span class="pre">True</span></tt> precisely when <span class="math">\(D\)</span> is a fundamental discriminant that
satisfies the Heegner hypothesis for this elliptic curve.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">satisfies_heegner_hypothesis</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">satisfies_heegner_hypothesis</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.heegner.satisfies_weak_heegner_hypothesis">
<tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">satisfies_weak_heegner_hypothesis</tt><big>(</big><em>N</em>, <em>D</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.satisfies_weak_heegner_hypothesis" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that <span class="math">\(D\)</span> satisfies the weak Heegner hypothesis relative to <span class="math">\(N\)</span>.
This is all that is needed to define Heegner points.</p>
<p>The condition is that <span class="math">\(D&lt;0\)</span> is a fundamental discriminant and that
each unramified prime dividing <span class="math">\(N\)</span> splits in <span class="math">\(K=\QQ(\sqrt{D})\)</span> and
each ramified prime exactly divides <span class="math">\(N\)</span>.  We also do not require
that <span class="math">\(D&lt;-4\)</span>.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(N\)</span> &#8211; positive integer</li>
<li><span class="math">\(D\)</span> &#8211; negative integer</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">satisfies_weak_heegner_hypothesis</span>
<span class="gp">sage: </span><span class="n">s</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">s</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">37</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">s</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">37</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">s</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">D</span> <span class="k">for</span> <span class="n">D</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">..</span><span class="p">,</span><span class="o">-</span><span class="mi">40</span><span class="p">]</span> <span class="k">if</span> <span class="n">s</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="n">D</span><span class="p">)]</span>
<span class="go">[-3, -4, -7, -11, -40]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">D</span> <span class="k">for</span> <span class="n">D</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">..</span><span class="p">,</span><span class="o">-</span><span class="mi">100</span><span class="p">]</span> <span class="k">if</span> <span class="n">s</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="n">D</span><span class="p">)]</span>
<span class="go">[-3, -4, -7, -11, -40, -47, -67, -71, -83, -84, -95]</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s">&#39;37a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">heegner_discriminants_list</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[-7, -11, -40, -47, -67, -71, -83, -84, -95, -104]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.heegner.simplest_rational_poly">
<tt class="descclassname">sage.schemes.elliptic_curves.heegner.</tt><tt class="descname">simplest_rational_poly</tt><big>(</big><em>f</em>, <em>prec</em><big>)</big><a class="headerlink" href="#sage.schemes.elliptic_curves.heegner.simplest_rational_poly" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a polynomial whose coefficients are as simple as possible
rationals that are also close to the coefficients of f.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(f\)</span> &#8211; polynomial with real floating point entries</li>
<li><tt class="docutils literal"><span class="pre">prec</span></tt> &#8211; positive integer</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">RR</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">heegner</span><span class="o">.</span><span class="n">simplest_rational_poly</span><span class="p">(</span><span class="mf">2.1</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">3.5</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mi">53</span><span class="p">)</span>
<span class="go">21/10*X^2 + 7/2*X - 6/5</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="lseries_ell.html"
                                  title="previous chapter">L-series for elliptic curves</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="padic_lseries.html"
                                  title="next chapter">p-adic L-functions of elliptic curves</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../_sources/sage/schemes/elliptic_curves/heegner.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="padic_lseries.html" title="p-adic L-functions of elliptic curves"
             >next</a> |</li>
        <li class="right" >
          <a href="lseries_ell.html" title="L-series for elliptic curves"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../../index.html">Plane curves</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer">
        &copy; Copyright 2005--2016, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>