<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=600, initial-scale=1">
    <title>Asymptotic Ring &mdash; Sage Reference Manual v7.4: Asymptotic Expansions</title>
    
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '7.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v7.4: Asymptotic Expansions" href="../../../index.html" />
    <link rel="next" title="Common Asymptotic Expansions" href="asymptotic_expansion_generators.html" />
    <link rel="prev" title="Asymptotic Expansions" href="../../../index.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="asymptotic_expansion_generators.html" title="Common Asymptotic Expansions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../../../index.html" title="Asymptotic Expansions"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Asymptotic Expansions</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="asymptotic-ring">
<span id="sage-rings-asymptotic-asymptotic-ring"></span><h1>Asymptotic Ring<a class="headerlink" href="#asymptotic-ring" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.rings.asymptotic.asymptotic_ring"></span><p>This module provides a ring (called <a class="reference internal" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticRing" title="sage.rings.asymptotic.asymptotic_ring.AsymptoticRing"><code class="xref py py-class docutils literal"><span class="pre">AsymptoticRing</span></code></a>) for
computations with <a class="reference external" href="https://en.wikipedia.org/wiki/Asymptotic_expansion">asymptotic expansions</a>.</p>
<div class="section" id="informal-definition">
<span id="asymptotic-ring-definition"></span><h2>(Informal) Definition<a class="headerlink" href="#informal-definition" title="Permalink to this headline">¶</a></h2>
<p>An asymptotic expansion is a sum such as</p>
<div class="math">
\[5z^3 + 4z^2 + O(z)\]</div>
<p>as <span class="math">\(z \to \infty\)</span> or</p>
<div class="math">
\[3x^{42}y^2 + 7x^3y^3 + O(x^2) + O(y)\]</div>
<p>as <span class="math">\(x\)</span> and <span class="math">\(y\)</span> tend to <span class="math">\(\infty\)</span>. It is a truncated series (after a
finite number of terms), which approximates a function.</p>
<p>The summands of the asymptotic expansions are partially ordered. In
this module these summands are the following:</p>
<ul class="simple">
<li>Exact terms <span class="math">\(c\cdot g\)</span> with a coefficient <span class="math">\(c\)</span> and an element <span class="math">\(g\)</span> of
a growth group (<a class="reference internal" href="#asymptotic-ring-growth"><span class="std std-ref">see below</span></a>).</li>
<li><span class="math">\(O\)</span>-terms <span class="math">\(O(g)\)</span> (see <a class="reference external" href="https://en.wikipedia.org/wiki/Big_O_notation">Big O notation</a>;
also called <em>Bachmann&#8211;Landau notation</em>) for a growth group
element <span class="math">\(g\)</span> (<a class="reference internal" href="#asymptotic-ring-growth"><span class="std std-ref">again see below</span></a>).</li>
</ul>
<p>See
<a class="reference external" href="https://en.wikipedia.org/wiki/Asymptotic_expansion">the Wikipedia article on asymptotic expansions</a>
for more details.
Further examples of such elements can be found <a class="reference internal" href="#asymptotic-ring-intro"><span class="std std-ref">here</span></a>.</p>
<div class="section" id="growth-groups-and-elements">
<span id="asymptotic-ring-growth"></span><h3>Growth Groups and Elements<a class="headerlink" href="#growth-groups-and-elements" title="Permalink to this headline">¶</a></h3>
<p>The elements of a <a class="reference internal" href="growth_group.html"><span class="doc">growth group</span></a> are equipped with
a partial order and usually contain a variable. Examples&#8212;the order
is described below these examples&#8212;are</p>
<ul class="simple">
<li>elements of the form <span class="math">\(z^q\)</span> for some integer or rational <span class="math">\(q\)</span>
(growth groups with <a class="reference internal" href="growth_group.html#growth-group-description"><span class="std std-ref">description strings</span></a>
<code class="docutils literal"><span class="pre">z^ZZ</span></code> or <code class="docutils literal"><span class="pre">z^QQ</span></code>),</li>
<li>elements of the form <span class="math">\(\log(z)^q\)</span> for some integer or rational <span class="math">\(q\)</span>
(growth groups <code class="docutils literal"><span class="pre">log(z)^ZZ</span></code> or <code class="docutils literal"><span class="pre">log(z)^QQ</span></code>),</li>
<li>elements of the form <span class="math">\(a^z\)</span> for some
rational <span class="math">\(a\)</span> (growth group <code class="docutils literal"><span class="pre">QQ^z</span></code>), or</li>
<li>more sophisticated constructions like products
<span class="math">\(x^r \cdot \log(x)^s \cdot a^y \cdot y^q\)</span>
(this corresponds to an element of the growth group
<code class="docutils literal"><span class="pre">x^QQ</span> <span class="pre">*</span> <span class="pre">log(x)^ZZ</span> <span class="pre">*</span> <span class="pre">QQ^y</span> <span class="pre">*</span> <span class="pre">y^QQ</span></code>).</li>
</ul>
<p>The order in all these examples is induced by the magnitude of the
elements as <span class="math">\(x\)</span>, <span class="math">\(y\)</span>, or <span class="math">\(z\)</span> (independently) tend to <span class="math">\(\infty\)</span>. For
elements only using the variable <span class="math">\(z\)</span> this means that <span class="math">\(g_1 \leq g_2\)</span> if</p>
<div class="math">
\[\lim_{z\to\infty} \frac{g_1}{g_2} \leq 1.\]</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Asymptotic rings where the variable tend to some value distinct from
<span class="math">\(\infty\)</span> are not yet implemented.</p>
</div>
<p>To find out more about</p>
<ul class="simple">
<li>growth groups,</li>
<li>on how they are created and</li>
<li>about the above used <em>descriptions strings</em></li>
</ul>
<p>see the top of the module <a class="reference internal" href="growth_group.html"><span class="doc">growth group</span></a>.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>As this code is experimental, a warning is thrown when an
asymptotic ring (or an associated structure) is created for the
first time in a session (see
<a class="reference external" href="../../../../misc/sage/misc/superseded.html#sage.misc.superseded.experimental" title="(in Sage Reference Manual: Utilities v7.4)"><code class="xref py py-class docutils literal"><span class="pre">sage.misc.superseded.experimental</span></code></a>).</p>
<p>TESTS:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.asymptotic.growth_group</span> <span class="kn">import</span> <span class="n">GrowthGroup</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">GrowthGroup</span><span class="p">(</span><span class="s1">&#39;x^ZZ&#39;</span><span class="p">)</span>
<span class="go">doctest:...: FutureWarning: This class/method/function is marked as</span>
<span class="go">experimental. It, its functionality or its interface might change</span>
<span class="go">without a formal deprecation.</span>
<span class="go">See http://trac.sagemath.org/17601 for details.</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="introductory-examples">
<span id="asymptotic-ring-intro"></span><h2>Introductory Examples<a class="headerlink" href="#introductory-examples" title="Permalink to this headline">¶</a></h2>
<p>We start this series of examples by defining two asymptotic rings.</p>
<div class="section" id="two-rings">
<h3>Two Rings<a class="headerlink" href="#two-rings" title="Permalink to this headline">¶</a></h3>
<div class="section" id="a-univariate-asymptotic-ring">
<h4>A Univariate Asymptotic Ring<a class="headerlink" href="#a-univariate-asymptotic-ring" title="Permalink to this headline">¶</a></h4>
<p>First, we construct the following (very simple) asymptotic ring in the variable <span class="math">\(z\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;z^QQ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">ZZ</span><span class="p">);</span> <span class="n">A</span>
<span class="go">Asymptotic Ring &lt;z^QQ&gt; over Integer Ring</span>
</pre></div>
</div>
<p>A typical element of this ring is</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">an_element</span><span class="p">()</span>
<span class="go">z^(3/2) + O(z^(1/2))</span>
</pre></div>
</div>
<p>This element consists of two summands: the exact term with coefficient
<span class="math">\(1\)</span> and growth <span class="math">\(z^{3/2}\)</span> and the <span class="math">\(O\)</span>-term <span class="math">\(O(z^{1/2})\)</span>. Note that the
growth of <span class="math">\(z^{3/2}\)</span> is larger than the growth of <span class="math">\(z^{1/2}\)</span> as
<span class="math">\(z\to\infty\)</span>, thus this expansion cannot be simplified (which would
be done automatically, see below).</p>
<p>Elements can be constructed via the generator <span class="math">\(z\)</span> and the function
<a class="reference external" href="../../../../rings/sage/rings/big_oh.html#sage.rings.big_oh.O" title="(in Sage Reference Manual: General Rings, Ideals, and Morphisms v7.4)"><code class="xref py py-func docutils literal"><span class="pre">O()</span></code></a>, for example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="mi">4</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="go">4*z^2 + O(z)</span>
</pre></div>
</div>
</div>
<div class="section" id="a-multivariate-asymptotic-ring">
<h4>A Multivariate Asymptotic Ring<a class="headerlink" href="#a-multivariate-asymptotic-ring" title="Permalink to this headline">¶</a></h4>
<p>Next, we construct a more sophisticated asymptotic ring in the
variables <span class="math">\(x\)</span> and <span class="math">\(y\)</span> by</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;x^QQ * log(x)^ZZ * QQ^y * y^QQ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">);</span> <span class="n">B</span>
<span class="go">Asymptotic Ring &lt;x^QQ * log(x)^ZZ * QQ^y * y^QQ&gt; over Rational Field</span>
</pre></div>
</div>
<p>Again, we can look at a typical (nontrivial) element:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">an_element</span><span class="p">()</span>
<span class="go">1/8*x^(3/2)*log(x)^3*(1/8)^y*y^(3/2) + O(x^(1/2)*log(x)*(1/2)^y*y^(1/2))</span>
</pre></div>
</div>
<p>Again, elements can be created using the generators <span class="math">\(x\)</span> and <span class="math">\(y\)</span>, as well as
the function <a class="reference external" href="../../../../rings/sage/rings/big_oh.html#sage.rings.big_oh.O" title="(in Sage Reference Manual: General Rings, Ideals, and Morphisms v7.4)"><code class="xref py py-func docutils literal"><span class="pre">O()</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="o">/</span><span class="mi">42</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">^</span><span class="n">y</span><span class="p">)</span>
<span class="go">1/42*log(x)*y + O((1/2)^y)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="arithmetical-operations">
<h3>Arithmetical Operations<a class="headerlink" href="#arithmetical-operations" title="Permalink to this headline">¶</a></h3>
<p>In this section we explain how to perform various arithmetical
operations with the elements of the asymptotic rings constructed
above.</p>
<div class="section" id="the-ring-operations-plus-and-times">
<h4>The Ring Operations Plus and Times<a class="headerlink" href="#the-ring-operations-plus-and-times" title="Permalink to this headline">¶</a></h4>
<p>We start our calculations in the ring</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span>
<span class="go">Asymptotic Ring &lt;z^QQ&gt; over Integer Ring</span>
</pre></div>
</div>
<p>Of course, we can perform the usual ring operations <span class="math">\(+\)</span> and <span class="math">\(*\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">z</span><span class="p">)</span>
<span class="go">-2*z^2 + 3*z</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span>
<span class="go">27*z^3 + 54*z^2 + 36*z + 8</span>
</pre></div>
</div>
<p>In addition to that, special powers&#8212;our growth group <code class="docutils literal"><span class="pre">z^QQ</span></code> allows
the exponents to be out of <span class="math">\(\QQ\)</span>&#8212;can also be computed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">z</span><span class="o">^</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">z</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">7</span><span class="p">))</span> <span class="o">*</span> <span class="n">z</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
<span class="go">z^(23/10) + z^(-2/35)</span>
</pre></div>
</div>
<p>The central concepts of computations with asymptotic expansions is
that the <span class="math">\(O\)</span>-notation can be used. For example, we have</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">z</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">z^3 + O(z^2)</span>
</pre></div>
</div>
<p>where the result is simplified automatically. A more sophisticated example is</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">z</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">O</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">+</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">4*z^6 + O(z^5)</span>
</pre></div>
</div>
</div>
<div class="section" id="division">
<h4>Division<a class="headerlink" href="#division" title="Permalink to this headline">¶</a></h4>
<p>The asymptotic expansions support division. For example, we can
expand <span class="math">\(1/(z-1)\)</span> to a geometric series:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">z^(-1) + z^(-2) + z^(-3) + z^(-4) + ... + z^(-20) + O(z^(-21))</span>
</pre></div>
</div>
<p>A default precision (parameter <code class="docutils literal"><span class="pre">default_prec</span></code> of
<a class="reference internal" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticRing" title="sage.rings.asymptotic.asymptotic_ring.AsymptoticRing"><code class="xref py py-class docutils literal"><span class="pre">AsymptoticRing</span></code></a>) is predefined. Thus, only the first <span class="math">\(20\)</span>
summands are calculated. However, if we only want the first <span class="math">\(5\)</span> exact
terms, we cut of the rest by using</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">z^(-1) + z^(-2) + z^(-3) + z^(-4) + z^(-5) + O(z^(-6))</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">z</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">))</span>
<span class="go">z^(-1) + z^(-2) + z^(-3) + z^(-4) + z^(-5) + O(z^(-6))</span>
</pre></div>
</div>
<p>Of course, we can work with more complicated expansions as well:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">z</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">z</span><span class="o">+</span><span class="n">O</span><span class="p">(</span><span class="n">z</span><span class="o">^</span><span class="mi">0</span><span class="p">))</span>
<span class="go">4*z^(-2) - 3*z^(-3) - z^(-4) + O(z^(-5))</span>
</pre></div>
</div>
<p>Not all elements are invertible, for instance,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="mi">1</span> <span class="o">/</span> <span class="n">O</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ZeroDivisionError</span>: <span class="n">Cannot invert O(z).</span>
</pre></div>
</div>
<p>is not invertible, since it includes <span class="math">\(0\)</span>.</p>
</div>
<div class="section" id="powers-expontials-and-logarithms">
<h4>Powers, Expontials and Logarithms<a class="headerlink" href="#powers-expontials-and-logarithms" title="Permalink to this headline">¶</a></h4>
<p>It works as simple as it can be; just use the usual operators <code class="docutils literal"><span class="pre">^</span></code>,
<code class="docutils literal"><span class="pre">exp</span></code> and <code class="docutils literal"><span class="pre">log</span></code>. For example, we obtain the usual series expansion
of the logarithm</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="o">-</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">z</span><span class="p">)</span>
<span class="go">z^(-1) + 1/2*z^(-2) + 1/3*z^(-3) + ... + O(z^(-21))</span>
</pre></div>
</div>
<p>as <span class="math">\(z \to \infty\)</span>.</p>
<p>Similarly, we can apply the exponential function of an asymptotic expansion:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">z</span><span class="p">)</span>
<span class="go">1 + z^(-1) + 1/2*z^(-2) + 1/6*z^(-3) + 1/24*z^(-4) + ... + O(z^(-20))</span>
</pre></div>
</div>
<p>Arbitrary powers work as well; for example, we have</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">z</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">z</span><span class="o">^</span><span class="mi">5</span><span class="p">))</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">z</span><span class="p">)</span>
<span class="go">1 + z^(-1) + z^(-2) + 1/2*z^(-3) + 1/3*z^(-4) + O(z^(-5))</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>In the asymptotic ring</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">n</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;QQ^n * n^QQ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">ZZ</span><span class="p">)</span>
</pre></div>
</div>
<p>the operation</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="n">n</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">1/2 is not in Exact Term Monoid QQ^n * n^QQ</span>
<span class="go">with coefficients in Integer Ring. ...</span>
</pre></div>
</div>
<p>fails, since the rational <span class="math">\(1/2\)</span> is not contained in <span class="math">\(M\)</span>. You can use</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">rpow</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(1/2)^n</span>
</pre></div>
</div>
<p>instead. (See also the examples in
<a class="reference internal" href="term_monoid.html#sage.rings.asymptotic.term_monoid.ExactTerm.rpow" title="sage.rings.asymptotic.term_monoid.ExactTerm.rpow"><code class="xref py py-meth docutils literal"><span class="pre">ExactTerm.rpow()</span></code></a>
for a detailed explanation.)
Another way is to use a larger coefficient ring:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M_QQ</span><span class="o">.&lt;</span><span class="n">n</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;QQ^n * n^QQ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="n">n</span>
<span class="go">(1/2)^n</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="multivariate-arithmetic">
<h4>Multivariate Arithmetic<a class="headerlink" href="#multivariate-arithmetic" title="Permalink to this headline">¶</a></h4>
<p>Now let us move on to arithmetic in the multivariate ring</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span>
<span class="go">Asymptotic Ring &lt;x^QQ * log(x)^ZZ * QQ^y * y^QQ&gt; over Rational Field</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">write this part</p>
</div>
</div>
</div>
</div>
<div class="section" id="more-examples">
<h2>More Examples<a class="headerlink" href="#more-examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="the-mathematical-constant-e-as-a-limit">
<h3>The mathematical constant e as a limit<a class="headerlink" href="#the-mathematical-constant-e-as-a-limit" title="Permalink to this headline">¶</a></h3>
<p>The base of the natural logarithm <span class="math">\(e\)</span> satisfies the equation</p>
<div class="math">
\[e = \lim_{n\to\infty} \left(1+\frac{1}{n}\right)^n\]</div>
<p>By using asymptotic expansions, we obtain the more precise result</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.&lt;</span><span class="n">n</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;n^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">SR</span><span class="p">,</span> <span class="n">default_prec</span><span class="o">=</span><span class="mi">5</span><span class="p">);</span> <span class="n">E</span>
<span class="go">Asymptotic Ring &lt;n^ZZ&gt; over Symbolic Ring</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">n</span><span class="p">)</span><span class="o">^</span><span class="n">n</span>
<span class="go">e - 1/2*e*n^(-1) + 11/24*e*n^(-2) - 7/16*e*n^(-3) + 2447/5760*e*n^(-4) + O(n^(-5))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="selected-technical-details">
<h2>Selected Technical Details<a class="headerlink" href="#selected-technical-details" title="Permalink to this headline">¶</a></h2>
<div class="section" id="coercions-and-functorial-constructions">
<h3>Coercions and Functorial Constructions<a class="headerlink" href="#coercions-and-functorial-constructions" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticRing" title="sage.rings.asymptotic.asymptotic_ring.AsymptoticRing"><code class="xref py py-class docutils literal"><span class="pre">AsymptoticRing</span></code></a> fully supports
<a class="reference external" href="../../../../coercion/index.html">coercion</a>. For example, the coefficient ring is automatically extended when needed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span>
<span class="go">Asymptotic Ring &lt;z^QQ&gt; over Integer Ring</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">z</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Asymptotic Ring &lt;z^QQ&gt; over Rational Field</span>
</pre></div>
</div>
<p>Here, the coefficient ring was extended to allow <span class="math">\(1/2\)</span> as a
coefficient. Another example is</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span><span class="o">.&lt;</span><span class="n">c</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;c^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">ZZ</span><span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">an_element</span><span class="p">()</span>
<span class="go">e^3*c^3 + O(c)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">an_element</span><span class="p">()</span> <span class="o">/</span> <span class="mi">7</span>
<span class="go">1/7*e^3*c^3 + O(c)</span>
</pre></div>
</div>
<p>Here the result&#8217;s coefficient ring is the newly found</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">an_element</span><span class="p">()</span> <span class="o">/</span> <span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Asymptotic Ring &lt;c^ZZ&gt; over</span>
<span class="go">Univariate Polynomial Ring in e over Rational Field</span>
</pre></div>
</div>
<p>Not only the coefficient ring can be extended, but the growth group as
well. For example, we can add/multiply elements of the asymptotic
rings <code class="docutils literal"><span class="pre">A</span></code> and <code class="docutils literal"><span class="pre">C</span></code> to get an expansion of new asymptotic ring:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">c</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">z</span><span class="p">);</span> <span class="n">r</span>
<span class="go">c*z + 1/2*c + O(z)</span>
<span class="gp">sage: </span><span class="n">r</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Asymptotic Ring &lt;c^ZZ * z^QQ&gt; over</span>
<span class="go">Univariate Polynomial Ring in e over Rational Field</span>
</pre></div>
</div>
</div>
<div class="section" id="data-structures">
<h3>Data Structures<a class="headerlink" href="#data-structures" title="Permalink to this headline">¶</a></h3>
<p>The summands of an
<a class="reference internal" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion" title="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion"><code class="xref py py-class docutils literal"><span class="pre">asymptotic</span> <span class="pre">expansion</span></code></a> are wrapped
<a class="reference internal" href="growth_group.html"><span class="doc">growth group elements</span></a>.
This wrapping is done by the
<a class="reference internal" href="term_monoid.html"><span class="doc">term monoid module</span></a>.
However, inside an
<a class="reference internal" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion" title="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion"><code class="xref py py-class docutils literal"><span class="pre">asymptotic</span> <span class="pre">expansion</span></code></a> these summands
(terms) are stored together with their growth-relationship, i.e., each
summand knows its direct predecessors and successors. As a data
structure a special poset (namely a
<a class="reference external" href="../../../../data_structures/sage/data_structures/mutable_poset.html#module-sage.data_structures.mutable_poset" title="(in Sage Reference Manual: Data Structures v7.4)"><code class="xref py py-mod docutils literal"><span class="pre">mutable</span> <span class="pre">poset</span></code></a>)
is used. We can have a look at this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">summands</span><span class="o">.</span><span class="n">repr_full</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="go">poset(x*y^2, x^3*y, x^2*y, O(x), O(y))</span>
<span class="go">+-- oo</span>
<span class="go">|   +-- no successors</span>
<span class="go">|   +-- predecessors:   x*y^2, x^3*y</span>
<span class="go">+-- x*y^2</span>
<span class="go">|   +-- successors:   oo</span>
<span class="go">|   +-- predecessors:   O(x), O(y)</span>
<span class="go">+-- x^3*y</span>
<span class="go">|   +-- successors:   oo</span>
<span class="go">|   +-- predecessors:   x^2*y</span>
<span class="go">+-- x^2*y</span>
<span class="go">|   +-- successors:   x^3*y</span>
<span class="go">|   +-- predecessors:   O(x), O(y)</span>
<span class="go">+-- O(x)</span>
<span class="go">|   +-- successors:   x*y^2, x^2*y</span>
<span class="go">|   +-- predecessors:   null</span>
<span class="go">+-- O(y)</span>
<span class="go">|   +-- successors:   x*y^2, x^2*y</span>
<span class="go">|   +-- predecessors:   null</span>
<span class="go">+-- null</span>
<span class="go">|   +-- successors:   O(x), O(y)</span>
<span class="go">|   +-- no predecessors</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="various">
<h2>Various<a class="headerlink" href="#various" title="Permalink to this headline">¶</a></h2>
<p>AUTHORS:</p>
<ul class="simple">
<li>Benjamin Hackl (2015)</li>
<li>Daniel Krenn (2015)</li>
<li>Clemens Heuberger (2016)</li>
</ul>
<p>ACKNOWLEDGEMENT:</p>
<ul class="simple">
<li>Benjamin Hackl, Clemens Heuberger and Daniel Krenn are supported by the
Austrian Science Fund (FWF): P 24644-N26.</li>
<li>Benjamin Hackl is supported by the Google Summer of Code 2015.</li>
</ul>
</div>
<div class="section" id="classes-and-methods">
<h2>Classes and Methods<a class="headerlink" href="#classes-and-methods" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion">
<em class="property">class </em><code class="descclassname">sage.rings.asymptotic.asymptotic_ring.</code><code class="descname">AsymptoticExpansion</code><span class="sig-paren">(</span><em>parent</em>, <em>summands</em>, <em>simplify=True</em>, <em>convert=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/element.html#sage.structure.element.CommutativeAlgebraElement" title="(in Sage Reference Manual: Basic Structures v7.4)"><code class="xref py py-class docutils literal"><span class="pre">sage.structure.element.CommutativeAlgebraElement</span></code></a></p>
<p>Class for asymptotic expansions, i.e., the elements of an
<a class="reference internal" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticRing" title="sage.rings.asymptotic.asymptotic_ring.AsymptoticRing"><code class="xref py py-class docutils literal"><span class="pre">AsymptoticRing</span></code></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">parent</span></code> &#8211; the parent of the asymptotic expansion.</li>
<li><code class="docutils literal"><span class="pre">summands</span></code> &#8211; the summands as a
<a class="reference external" href="../../../../data_structures/sage/data_structures/mutable_poset.html#sage.data_structures.mutable_poset.MutablePoset" title="(in Sage Reference Manual: Data Structures v7.4)"><code class="xref py py-class docutils literal"><span class="pre">MutablePoset</span></code></a>, which
represents the underlying structure.</li>
<li><code class="docutils literal"><span class="pre">simplify</span></code> &#8211; a boolean (default: <code class="docutils literal"><span class="pre">True</span></code>). It controls
automatic simplification (absorption) of the asymptotic expansion.</li>
<li><code class="docutils literal"><span class="pre">convert</span></code> &#8211; a boolean (default: <code class="docutils literal"><span class="pre">True</span></code>). If set, then the
<code class="docutils literal"><span class="pre">summands</span></code> are converted to the asymptotic ring (the parent of this
expansion). If not, then the summands are taken as they are. In
that case, the caller must ensure that the parent of the terms is
set correctly.</li>
</ul>
<p>EXAMPLES:</p>
<p>There are several ways to create asymptotic expansions; usually
this is done by using the corresponding <a class="reference internal" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticRing" title="sage.rings.asymptotic.asymptotic_ring.AsymptoticRing"><code class="xref py py-class docutils literal"><span class="pre">asymptotic</span> <span class="pre">rings</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R_x</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;x^QQ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">);</span> <span class="n">R_x</span>
<span class="go">Asymptotic Ring &lt;x^QQ&gt; over Rational Field</span>
<span class="gp">sage: </span><span class="n">R_y</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;y^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">ZZ</span><span class="p">);</span> <span class="n">R_y</span>
<span class="go">Asymptotic Ring &lt;y^ZZ&gt; over Integer Ring</span>
</pre></div>
</div>
<p>At this point, <span class="math">\(x\)</span> and <span class="math">\(y\)</span> are already asymptotic expansions:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.rings.asymptotic.asymptotic_ring.AsymptoticRing_with_category.element_class&#39;&gt;</span>
</pre></div>
</div>
<p>The usual ring operations, but allowing rational exponents (growth
group <code class="docutils literal"><span class="pre">x^QQ</span></code>) can be performed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="p">))</span>
<span class="go">x^2 + 3*x - 3*x^(2/5)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span>
<span class="go">27*x + 54*x^(2/3) + 36*x^(1/3) + 8</span>
</pre></div>
</div>
<p>One of the central ideas behind computing with asymptotic
expansions is that the <span class="math">\(O\)</span>-notation (see
<a class="reference external" href="https://en.wikipedia.org/wiki/Big_O_notation">Wikipedia article Big_O_notation</a>) can be used. For example, we have:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">O</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">4*x^6 + O(x^5)</span>
</pre></div>
</div>
<p>In particular, <a class="reference external" href="../../../../rings/sage/rings/big_oh.html#sage.rings.big_oh.O" title="(in Sage Reference Manual: General Rings, Ideals, and Morphisms v7.4)"><code class="xref py py-func docutils literal"><span class="pre">O()</span></code></a> can be used to
construct the asymptotic expansions. With the help of the
<a class="reference internal" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.summands" title="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.summands"><code class="xref py py-meth docutils literal"><span class="pre">summands()</span></code></a>, we can also have a look at the inner structure
of an asymptotic expansion:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">expr1</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="p">;</span> <span class="n">expr2</span> <span class="o">=</span> <span class="n">O</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">expr1</span><span class="o">.</span><span class="n">summands</span><span class="o">.</span><span class="n">repr_full</span><span class="p">())</span>
<span class="go">poset(x, 2*x^2, 3*x^3, 4*x^4)</span>
<span class="go">+-- null</span>
<span class="go">|   +-- no predecessors</span>
<span class="go">|   +-- successors:   x</span>
<span class="go">+-- x</span>
<span class="go">|   +-- predecessors:   null</span>
<span class="go">|   +-- successors:   2*x^2</span>
<span class="go">+-- 2*x^2</span>
<span class="go">|   +-- predecessors:   x</span>
<span class="go">|   +-- successors:   3*x^3</span>
<span class="go">+-- 3*x^3</span>
<span class="go">|   +-- predecessors:   2*x^2</span>
<span class="go">|   +-- successors:   4*x^4</span>
<span class="go">+-- 4*x^4</span>
<span class="go">|   +-- predecessors:   3*x^3</span>
<span class="go">|   +-- successors:   oo</span>
<span class="go">+-- oo</span>
<span class="go">|   +-- predecessors:   4*x^4</span>
<span class="go">|   +-- no successors</span>
<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">expr2</span><span class="o">.</span><span class="n">summands</span><span class="o">.</span><span class="n">repr_full</span><span class="p">())</span>
<span class="go">poset(O(x), x^2)</span>
<span class="go">+-- null</span>
<span class="go">|   +-- no predecessors</span>
<span class="go">|   +-- successors:   O(x)</span>
<span class="go">+-- O(x)</span>
<span class="go">|   +-- predecessors:   null</span>
<span class="go">|   +-- successors:   x^2</span>
<span class="go">+-- x^2</span>
<span class="go">|   +-- predecessors:   O(x)</span>
<span class="go">|   +-- successors:   oo</span>
<span class="go">+-- oo</span>
<span class="go">|   +-- predecessors:   x^2</span>
<span class="go">|   +-- no successors</span>
<span class="gp">sage: </span><span class="k">print</span><span class="p">((</span><span class="n">expr1</span> <span class="o">*</span> <span class="n">expr2</span><span class="p">)</span><span class="o">.</span><span class="n">summands</span><span class="o">.</span><span class="n">repr_full</span><span class="p">())</span>
<span class="go">poset(O(x^5), 4*x^6)</span>
<span class="go">+-- null</span>
<span class="go">|   +-- no predecessors</span>
<span class="go">|   +-- successors:   O(x^5)</span>
<span class="go">+-- O(x^5)</span>
<span class="go">|   +-- predecessors:   null</span>
<span class="go">|   +-- successors:   4*x^6</span>
<span class="go">+-- 4*x^6</span>
<span class="go">|   +-- predecessors:   O(x^5)</span>
<span class="go">|   +-- successors:   oo</span>
<span class="go">+-- oo</span>
<span class="go">|   +-- predecessors:   4*x^6</span>
<span class="go">|   +-- no successors</span>
</pre></div>
</div>
<p>In addition to the monomial growth elements from above, we can
also compute with logarithmic terms (simply by constructing the
appropriate growth group):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R_log</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;log(x)^QQ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">lx</span> <span class="o">=</span> <span class="n">R_log</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">SR</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">O</span><span class="p">(</span><span class="n">lx</span><span class="p">)</span> <span class="o">+</span> <span class="n">lx</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">^</span><span class="mi">4</span>
<span class="go">log(x)^12 + O(log(x)^10)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="growth_group.html"><span class="doc">(Asymptotic) Growth Groups</span></a>,
<a class="reference internal" href="term_monoid.html"><span class="doc">(Asymptotic) Term Monoids</span></a>,
<a class="reference external" href="../../../../data_structures/sage/data_structures/mutable_poset.html#module-sage.data_structures.mutable_poset" title="(in Sage Reference Manual: Data Structures v7.4)"><code class="xref py py-mod docutils literal"><span class="pre">mutable_poset</span></code></a>.</p>
</div>
<dl class="method">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.O">
<code class="descname">O</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.O" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert all terms in this asymptotic expansion to <span class="math">\(O\)</span>-terms.</p>
<p>INPUT:</p>
<p>Nothing.</p>
<p>OUTPUT:</p>
<p>An asymptotic expansion.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">AR</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;x^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">O</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">O(x)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">O</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">&lt;class &#39;sage.rings.asymptotic.asymptotic_ring.AsymptoticRing_with_category.element_class&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">expr</span> <span class="o">=</span> <span class="mi">42</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">42</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">10</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">);</span> <span class="n">expr</span>
<span class="go">42*x^42 + x^10 + O(x^2)</span>
<span class="gp">sage: </span><span class="n">expr</span><span class="o">.</span><span class="n">O</span><span class="p">()</span>
<span class="go">O(x^42)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">O</span><span class="p">()</span>
<span class="go">O(x)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference external" href="../../../../power_series/sage/rings/power_series_ring.html#sage.rings.power_series_ring.PowerSeriesRing" title="(in Sage Reference Manual: Power Series Rings v7.4)"><code class="xref py py-func docutils literal"><span class="pre">sage.rings.power_series_ring.PowerSeriesRing()</span></code></a>,
<a class="reference external" href="../../../../power_series/sage/rings/laurent_series_ring.html#sage.rings.laurent_series_ring.LaurentSeriesRing" title="(in Sage Reference Manual: Power Series Rings v7.4)"><code class="xref py py-func docutils literal"><span class="pre">sage.rings.laurent_series_ring.LaurentSeriesRing()</span></code></a>.</p>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">AR</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">O</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedOZero</span>: <span class="n">The error term in the result is O(0)</span>
<span class="go">which means 0 for sufficiently large x.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.compare_with_values">
<code class="descname">compare_with_values</code><span class="sig-paren">(</span><em>variable</em>, <em>function</em>, <em>values</em>, <em>rescaled=True</em>, <em>ring=Real Interval Field with 53 bits of precision</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.compare_with_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the (rescaled) difference between this asymptotic
expansion and the given values.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">variable</span></code> &#8211; an asymptotic expansion or a string.</li>
<li><code class="docutils literal"><span class="pre">function</span></code> &#8211; a callable or symbolic expression giving the
comparison values.</li>
<li><code class="docutils literal"><span class="pre">values</span></code> &#8211; a list or iterable of values where the comparison
shall be carried out.</li>
<li><code class="docutils literal"><span class="pre">rescaled</span></code> &#8211; (default: <code class="docutils literal"><span class="pre">True</span></code>) determines whether
the difference is divided by the error term of the asymptotic
expansion.</li>
<li><code class="docutils literal"><span class="pre">ring</span></code> &#8211; (default: <code class="docutils literal"><span class="pre">RIF</span></code>) the parent into which the
difference is converted.</li>
</ul>
<p>OUTPUT:</p>
<p>A list of pairs containing comparison points and (rescaled)
difference values.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">n</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="s1">&#39;QQ^n * n^ZZ&#39;</span><span class="p">,</span> <span class="n">SR</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">catalan</span> <span class="o">=</span> <span class="n">binomial</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">expansion</span> <span class="o">=</span> <span class="mi">4</span><span class="o">^</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">....:     - 9/8/sqrt(pi)*n^(-5/2)</span>
<span class="go">....:     + 145/128/sqrt(pi)*n^(-7/2) + O(n^(-9/2)))</span>
<span class="gp">sage: </span><span class="n">expansion</span><span class="o">.</span><span class="n">compare_with_values</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">catalan</span><span class="p">,</span> <span class="n">srange</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="go">[(5, 0.5303924444775?),</span>
<span class="go"> (6, 0.5455279498787?),</span>
<span class="go"> (7, 0.556880411050?),</span>
<span class="go"> (8, 0.565710587724?),</span>
<span class="go"> (9, 0.572775029098?)]</span>
<span class="gp">sage: </span><span class="n">expansion</span><span class="o">.</span><span class="n">compare_with_values</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">catalan</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="n">rescaled</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(5, 0.3886263699387?), (10, 19.1842458318?), (20, 931314.63637?)]</span>
<span class="gp">sage: </span><span class="n">expansion</span><span class="o">.</span><span class="n">compare_with_values</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">catalan</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="n">rescaled</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">ring</span><span class="o">=</span><span class="n">SR</span><span class="p">)</span>
<span class="go">[(5, 168/5*sqrt(5)/sqrt(pi) - 42),</span>
<span class="go"> (10, 1178112/125*sqrt(10)/sqrt(pi) - 16796),</span>
<span class="go"> (20, 650486218752/125*sqrt(5)/sqrt(pi) - 6564120420)]</span>
</pre></div>
</div>
<p>Instead of a symbolic expression, a callable function can
be specified as well:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">n</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="s1">&#39;n^ZZ * log(n)^ZZ&#39;</span><span class="p">,</span> <span class="n">SR</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">def</span> <span class="nf">H</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="go">....:     return sum(1/k for k in srange(1, n+1))</span>
<span class="gp">sage: </span><span class="n">H_expansion</span> <span class="o">=</span> <span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">euler_gamma</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">)</span>
<span class="go">....:                - 1/(12*n^2) + O(n^-4))</span>
<span class="gp">sage: </span><span class="n">H_expansion</span><span class="o">.</span><span class="n">compare_with_values</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">srange</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span> <span class="c1"># rel tol 1e-6</span>
<span class="go">[(25, -0.008326995?),</span>
<span class="go"> (26, -0.008327472?),</span>
<span class="go"> (27, -0.008327898?),</span>
<span class="go"> (28, -0.00832828?),</span>
<span class="go"> (29, -0.00832862?)]</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.plot_comparison" title="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.plot_comparison"><code class="xref py py-meth docutils literal"><span class="pre">plot_comparison()</span></code></a></p>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>sage: A.&lt;x, y&gt; = AsymptoticRing(&#39;x^ZZ*y^ZZ&#39;, QQ)
sage: expansion = x^2 + O(x) + O(y)
sage: expansion.compare_with_values(y, lambda z: z^2, srange(20, 30))
Traceback (most recent call last):
....
NotImplementedError: exactly one error term required
sage: expansion = x^2
sage: expansion.compare_with_values(y, lambda z: z^2, srange(20, 30))
Traceback (most recent call last):
....
NotImplementedError: exactly one error term required
sage: expansion = x^2 + O(x)
sage: expansion.compare_with_values(y, lambda z: z^2, srange(20, 30))
Traceback (most recent call last):
....
NameError: name &#39;x&#39; is not defined
sage: expansion.compare_with_values(x, lambda z: z^2, srange(20, 30))
[(20, 0), (21, 0), ..., (29, 0)]
sage: expansion.compare_with_values(x, SR(&#39;x*y&#39;), srange(20, 30))
Traceback (most recent call last):
....
NotImplementedError: expression x*y has more than one variable
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.exact_part">
<code class="descname">exact_part</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.exact_part" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the expansion consisting of all exact terms of this
expansion.</p>
<p>INPUT:</p>
<p>Nothing</p>
<p>OUTPUT:</p>
<p>An asymptotic expansion.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="s1">&#39;x^QQ * log(x)^QQ&#39;</span><span class="p">,</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">exact_part</span><span class="p">()</span>
<span class="go">x^2</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">exact_part</span><span class="p">()</span>
<span class="go">x + 1/2*log(x)</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="s1">&#39;x^QQ * y^QQ&#39;</span><span class="p">,</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)))</span><span class="o">.</span><span class="n">exact_part</span><span class="p">()</span>
<span class="go">x + y</span>
<span class="gp">sage: </span><span class="n">O</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">exact_part</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.exp">
<code class="descname">exp</code><span class="sig-paren">(</span><em>precision=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.exp" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the exponential of (i.e., the power of <span class="math">\(e\)</span> to) this asymptotic expansion.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">precision</span></code> &#8211; the precision used for truncating the
expansion. If <code class="docutils literal"><span class="pre">None</span></code> (default value) is used, the
default precision of the parent is used.</li>
</ul>
<p>OUTPUT:</p>
<p>An asymptotic expansion.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The exponential function of this expansion can only be
computed exactly if the respective growth element can be
constructed in the underlying growth group.</p>
</div>
<p>ALGORITHM:</p>
<p>If the corresponding growth can be constructed, return
the exact exponential function. Otherwise, if this term
is <span class="math">\(o(1)\)</span>, try to expand the series and truncate
according to the given precision.</p>
<div class="admonition-todo admonition" id="index-1">
<p class="first admonition-title">Todo</p>
<p class="last">As soon as <span class="math">\(L\)</span>-terms are implemented, this
implementation has to be adapted as well in order to
yield correct results.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="s1">&#39;(e^x)^ZZ * x^ZZ * log(x)^ZZ&#39;</span><span class="p">,</span> <span class="n">SR</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">e^x</span>
<span class="gp">sage: </span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="go">(e^x)^2</span>
<span class="gp">sage: </span><span class="n">exp</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">e^x*x</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="go">1 + x^(-1) + 1/2*x^(-2) + 1/6*x^(-3) + ... + O(x^(-7))</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="s1">&#39;(e^x)^ZZ * x^QQ * log(x)^QQ&#39;</span><span class="p">,</span> <span class="n">SR</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">exp</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">x</span>
<span class="gp">sage: </span><span class="n">log</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">x</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="go">e*e^x</span>
</pre></div>
</div>
<p>See <a class="reference external" href="https://trac.sagemath.org/19521">trac ticket #19521</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">n</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="s1">&#39;n^ZZ&#39;</span><span class="p">,</span> <span class="n">SR</span><span class="o">.</span><span class="n">subring</span><span class="p">(</span><span class="n">no_variables</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">exp</span><span class="p">(</span><span class="n">O</span><span class="p">(</span><span class="n">n</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)))</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Asymptotic Ring &lt;n^ZZ&gt; over Symbolic Constants Subring</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.factorial">
<code class="descname">factorial</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.factorial" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the factorial of this asymptotic expansion.</p>
<p>OUTPUT:</p>
<p>An asymptotic expansion.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">n</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;n^ZZ * log(n)^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">default_prec</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">factorial</span><span class="p">()</span>
<span class="go">sqrt(2)*sqrt(pi)*e^(n*log(n))*(e^n)^(-1)*n^(1/2)</span>
<span class="go">+ 1/12*sqrt(2)*sqrt(pi)*e^(n*log(n))*(e^n)^(-1)*n^(-1/2)</span>
<span class="go">+ 1/288*sqrt(2)*sqrt(pi)*e^(n*log(n))*(e^n)^(-1)*n^(-3/2)</span>
<span class="go">+ O(e^(n*log(n))*(e^n)^(-1)*n^(-5/2))</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Asymptotic Ring &lt;(e^(n*log(n)))^(Symbolic Constants Subring) *</span>
<span class="go">                 (e^n)^(Symbolic Constants Subring) *</span>
<span class="go">                 n^(Symbolic Constants Subring) *</span>
<span class="go">                 log(n)^(Symbolic Constants Subring)&gt;</span>
<span class="go">over Symbolic Constants Subring</span>
</pre></div>
</div>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Catalan_number">Catalan numbers</a>
<span class="math">\(\frac{1}{n+1}\binom{2n}{n}\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">factorial</span><span class="p">()</span> <span class="o">/</span> <span class="n">n</span><span class="o">.</span><span class="n">factorial</span><span class="p">()</span><span class="o">^</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">1/sqrt(pi)*(e^n)^(2*log(2))*n^(-3/2)</span>
<span class="go">- 9/8/sqrt(pi)*(e^n)^(2*log(2))*n^(-5/2)</span>
<span class="go">+ 145/128/sqrt(pi)*(e^n)^(2*log(2))*n^(-7/2)</span>
<span class="go">+ O((e^n)^(2*log(2))*n^(-9/2))</span>
</pre></div>
</div>
<p>Note that this method substitutes the asymptotic expansion into
Stirling&#8217;s formula. This substitution has to be possible which is
not always guaranteed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">s</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;s^QQ * log(s)^QQ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">,</span> <span class="n">default_prec</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">log</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">factorial</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Cannot apply the substitution rules {s: log(s)} on</span>
<span class="go">sqrt(2)*sqrt(pi)*e^(s*log(s))*(e^s)^(-1)*s^(1/2)</span>
<span class="go">+ O(e^(s*log(s))*(e^s)^(-1)*s^(-1/2)) in</span>
<span class="go">Asymptotic Ring &lt;(e^(s*log(s)))^QQ * (e^s)^QQ * s^QQ * log(s)^QQ&gt;</span>
<span class="go">over Symbolic Constants Subring.</span>
<span class="gp">...</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="asymptotic_expansion_generators.html#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.Stirling" title="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.Stirling"><code class="xref py py-meth docutils literal"><span class="pre">Stirling()</span></code></a></p>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">m</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;m^ZZ * log(m)^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">,</span> <span class="n">default_prec</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">factorial</span><span class="p">()</span>
<span class="go">sqrt(2)*sqrt(pi)*e^(m*log(m))*(e^m)^(-1)*m^(1/2)</span>
<span class="go">+ 1/12*sqrt(2)*sqrt(pi)*e^(m*log(m))*(e^m)^(-1)*m^(-1/2)</span>
<span class="go">+ 1/288*sqrt(2)*sqrt(pi)*e^(m*log(m))*(e^m)^(-1)*m^(-3/2)</span>
<span class="go">+ O(e^(m*log(m))*(e^m)^(-1)*m^(-5/2))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">factorial</span><span class="p">()</span>
<span class="go">1/2*sqrt(pi)</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Asymptotic Ring &lt;m^ZZ * log(m)^ZZ&gt; over Symbolic Ring</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="s1">&#39;a^ZZ * b^ZZ&#39;</span><span class="p">,</span> <span class="n">QQ</span><span class="p">,</span> <span class="n">default_prec</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">factorial</span><span class="p">()</span>
<span class="go">O(e^(b*log(b))*(e^b)^(-1)*b^(1/2))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">factorial</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Cannot build the factorial of a*b</span>
<span class="go">since it is not univariate.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.has_same_summands">
<code class="descname">has_same_summands</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.has_same_summands" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether this asymptotic expansion and <code class="docutils literal"><span class="pre">other</span></code> have the
same summands.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">other</span></code> &#8211; an asymptotic expansion.</li>
</ul>
<p>OUTPUT:</p>
<p>A boolean.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>While for example <code class="docutils literal"><span class="pre">O(x)</span> <span class="pre">==</span> <span class="pre">O(x)</span></code> yields <code class="docutils literal"><span class="pre">False</span></code>,
these expansions <em>do</em> have the same summands and this method
returns <code class="docutils literal"><span class="pre">True</span></code>.</p>
<p class="last">Moreover, this method uses the coercion model in order to
find a common parent for this asymptotic expansion and
<code class="docutils literal"><span class="pre">other</span></code>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R_ZZ</span><span class="o">.&lt;</span><span class="n">x_ZZ</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="s1">&#39;x^ZZ&#39;</span><span class="p">,</span> <span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R_QQ</span><span class="o">.&lt;</span><span class="n">x_QQ</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="s1">&#39;x^ZZ&#39;</span><span class="p">,</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="n">x_ZZ</span><span class="o">^</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="o">==</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x_QQ</span><span class="o">^</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>  <span class="c1"># indirect doctest</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">O</span><span class="p">(</span><span class="n">x_ZZ</span><span class="p">)</span> <span class="o">==</span> <span class="n">O</span><span class="p">(</span><span class="n">x_QQ</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x_ZZ</span><span class="o">.</span><span class="n">has_same_summands</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.invert">
<code class="descname">invert</code><span class="sig-paren">(</span><em>precision=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.invert" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the multiplicative inverse of this element.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">precision</span></code> &#8211; the precision used for truncating the
expansion. If <code class="docutils literal"><span class="pre">None</span></code> (default value) is used, the
default precision of the parent is used.</li>
</ul>
<p>OUTPUT:</p>
<p>An asymptotic expansion.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Due to truncation of infinite expansions, the element
returned by this method might not fulfill
<code class="docutils literal"><span class="pre">el</span> <span class="pre">*</span> <span class="pre">~el</span> <span class="pre">==</span> <span class="pre">1</span></code>.</p>
</div>
<div class="admonition-todo admonition" id="index-2">
<p class="first admonition-title">Todo</p>
<p class="last">As soon as <span class="math">\(L\)</span>-terms are implemented, this
implementation has to be adapted as well in order to
yield correct results.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;x^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">,</span> <span class="n">default_prec</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="o">~</span><span class="n">x</span>
<span class="go">x^(-1)</span>
<span class="gp">sage: </span><span class="o">~</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">42</span><span class="p">)</span>
<span class="go">x^(-42)</span>
<span class="gp">sage: </span><span class="n">ex</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="p">);</span> <span class="n">ex</span>
<span class="go">x^(-1) - x^(-2) + x^(-3) - x^(-4) + O(x^(-5))</span>
<span class="gp">sage: </span><span class="n">ex</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="p">)</span>
<span class="go">1 + O(x^(-4))</span>
<span class="gp">sage: </span><span class="o">~</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">))</span>
<span class="go">1 + O(x^(-1))</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;a^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Asymptotic Ring &lt;a^ZZ&gt; over Rational Field</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Asymptotic Ring &lt;a^ZZ&gt; over Rational Field</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="o">~</span><span class="n">A</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ZeroDivisionError</span>: <span class="n">Cannot invert 0 in</span>
<span class="go">Asymptotic Ring &lt;a^ZZ&gt; over Integer Ring.</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;s^ZZ * t^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="o">~</span><span class="p">(</span><span class="n">s</span> <span class="o">+</span> <span class="n">t</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Cannot determine main term of s + t since there</span>
<span class="go">are several maximal elements s, t.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.is_exact">
<code class="descname">is_exact</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.is_exact" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether all terms of this expansion are exact.</p>
<p>OUTPUT:</p>
<p>A boolean.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="s1">&#39;x^QQ * log(x)^QQ&#39;</span><span class="p">,</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">is_exact</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">is_exact</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">is_exact</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">one</span><span class="p">()</span><span class="o">.</span><span class="n">is_exact</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.is_little_o_of_one">
<code class="descname">is_little_o_of_one</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.is_little_o_of_one" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether this expansion is of order <span class="math">\(o(1)\)</span>.</p>
<p>INPUT:</p>
<p>Nothing.</p>
<p>OUTPUT:</p>
<p>A boolean.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="s1">&#39;x^ZZ * log(x)^ZZ&#39;</span><span class="p">,</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_little_o_of_one</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">1234</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)))</span><span class="o">.</span><span class="n">is_little_o_of_one</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">is_little_o_of_one</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="s1">&#39;x^QQ * y^QQ * log(y)^ZZ&#39;</span><span class="p">,</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">16</span><span class="p">)</span> <span class="o">*</span> <span class="n">y</span><span class="o">^</span><span class="mi">32</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">32</span> <span class="o">*</span> <span class="n">y</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">16</span><span class="p">))</span><span class="o">.</span><span class="n">is_little_o_of_one</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">y</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">y</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">is_little_o_of_one</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">y</span> <span class="o">/</span> <span class="n">log</span><span class="p">(</span><span class="n">y</span><span class="p">))</span><span class="o">.</span><span class="n">is_little_o_of_one</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">log</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_little_o_of_one</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.log">
<code class="descname">log</code><span class="sig-paren">(</span><em>base=None</em>, <em>precision=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.log" title="Permalink to this definition">¶</a></dt>
<dd><p>The logarithm of this asymptotic expansion.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">base</span></code> &#8211; the base of the logarithm. If <code class="docutils literal"><span class="pre">None</span></code>
(default value) is used, the natural logarithm is taken.</li>
<li><code class="docutils literal"><span class="pre">precision</span></code> &#8211; the precision used for truncating the
expansion. If <code class="docutils literal"><span class="pre">None</span></code> (default value) is used, the
default precision of the parent is used.</li>
</ul>
<p>OUTPUT:</p>
<p>An asymptotic expansion.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Computing the logarithm of an asymptotic expansion
is possible if and only if there is exactly one maximal
summand in the expansion.</p>
</div>
<p>ALGORITHM:</p>
<p>If the expansion has more than one summand,
the asymptotic expansion for <span class="math">\(\log(1+t)\)</span> as <span class="math">\(t\)</span> tends to <span class="math">\(0\)</span>
is used.</p>
<div class="admonition-todo admonition" id="index-3">
<p class="first admonition-title">Todo</p>
<p class="last">As soon as <span class="math">\(L\)</span>-terms are implemented, this
implementation has to be adapted as well in order to
yield correct results.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;x^ZZ * log(x)^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">log(x)</span>
<span class="gp">sage: </span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">2*log(x)</span>
<span class="gp">sage: </span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">log(x) - x^(-1) - 1/2*x^(-2) - 1/3*x^(-3) - ... + O(x^(-21))</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">log</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">log</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ArithmeticError</span>: <span class="n">Cannot compute log(0) in</span>
<span class="go">Asymptotic Ring &lt;x^ZZ * log(x)^ZZ&gt; over Rational Field.</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.&lt;</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;s^ZZ * t^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">log</span><span class="p">(</span><span class="n">s</span> <span class="o">+</span> <span class="n">t</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Cannot determine main term of s + t since</span>
<span class="go">there are several maximal elements s, t.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.map_coefficients">
<code class="descname">map_coefficients</code><span class="sig-paren">(</span><em>f</em>, <em>new_coefficient_ring=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.map_coefficients" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the asymptotic expansion obtained by applying <code class="docutils literal"><span class="pre">f</span></code> to
each coefficient of this asymptotic expansion.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">f</span></code> &#8211; a callable. A coefficient <span class="math">\(c\)</span> will be mapped to <span class="math">\(f(c)\)</span>.</li>
<li><code class="docutils literal"><span class="pre">new_coefficient_ring</span></code> &#8211; (default: <code class="docutils literal"><span class="pre">None</span></code>) a ring.</li>
</ul>
<p>OUTPUT:</p>
<p>An asymptotic expansion.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">n</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;n^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">n</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">map_coefficients</span><span class="p">(</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="go">2*n^4 + 3*n^3 + 4*n^2 + O(n)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">map_coefficients</span><span class="p">(</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-n^4 + n^2 + O(n)</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">map_coefficients</span><span class="p">(</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">c</span><span class="p">,</span> <span class="n">new_coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="go">n^4 + 1/2*n^3 + 1/3*n^2 + O(n)</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Asymptotic Ring &lt;n^ZZ&gt; over Rational Field</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">map_coefficients</span><span class="p">(</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">c</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">... is not a coefficient in</span>
<span class="go">Exact Term Monoid n^ZZ with coefficients in Integer Ring.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.plot_comparison">
<code class="descname">plot_comparison</code><span class="sig-paren">(</span><em>variable</em>, <em>function</em>, <em>values</em>, <em>rescaled=True</em>, <em>ring=Real Interval Field with 53 bits of precision</em>, <em>relative_tolerance=0.025</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.plot_comparison" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the (rescaled) difference between this asymptotic
expansion and the given values.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">variable</span></code> &#8211; an asymptotic expansion or a string.</li>
<li><code class="docutils literal"><span class="pre">function</span></code> &#8211; a callable or symbolic expression giving the
comparison values.</li>
<li><code class="docutils literal"><span class="pre">values</span></code> &#8211; a list or iterable of values where the comparison
shall be carried out.</li>
<li><code class="docutils literal"><span class="pre">rescaled</span></code> &#8211; (default: <code class="docutils literal"><span class="pre">True</span></code>) determines whether
the difference is divided by the error term of the asymptotic
expansion.</li>
<li><code class="docutils literal"><span class="pre">ring</span></code> &#8211; (default: <code class="docutils literal"><span class="pre">RIF</span></code>) the parent into which the
difference is converted.</li>
<li><code class="docutils literal"><span class="pre">relative_tolerance</span></code> &#8211; (default: <code class="docutils literal"><span class="pre">0.025</span></code>). Raise error
when relative error exceeds this tolerance.</li>
</ul>
<p>Other keyword arguments are passed to <a class="reference external" href="../../../../plotting/sage/plot/plot.html#sage.plot.plot.list_plot" title="(in Sage Reference Manual: 2D Graphics v7.4)"><code class="xref py py-func docutils literal"><span class="pre">list_plot()</span></code></a>.</p>
<p>OUTPUT:</p>
<p>A graphics object.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>If rescaled (i.e. divided by the error term), the output
should be bounded.</p>
<p class="last">This method is mainly meant to have an easily usable
plausability check for asymptotic expansion created in
some way.</p>
</div>
<p>EXAMPLES:</p>
<p>We want to check the quality of the asymptotic expansion of
the harmonic numbers:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">n</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="s1">&#39;n^ZZ * log(n)^ZZ&#39;</span><span class="p">,</span> <span class="n">SR</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">def</span> <span class="nf">H</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="go">....:     return sum(1/k for k in srange(1, n+1))</span>
<span class="gp">sage: </span><span class="n">H_expansion</span> <span class="o">=</span> <span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">euler_gamma</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">)</span>
<span class="go">....:                - 1/(12*n^2) + O(n^-4))</span>
<span class="gp">sage: </span><span class="n">H_expansion</span><span class="o">.</span><span class="n">plot_comparison</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">srange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
</pre></div>
</div>
<p>Alternatively, the unscaled (absolute) difference can be
plotted as well:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H_expansion</span><span class="o">.</span><span class="n">plot_comparison</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">srange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
<span class="go">....:                             rescaled=False)</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
</pre></div>
</div>
<p>Additional keywords are passed to <a class="reference external" href="../../../../plotting/sage/plot/plot.html#sage.plot.plot.list_plot" title="(in Sage Reference Manual: 2D Graphics v7.4)"><code class="xref py py-func docutils literal"><span class="pre">list_plot()</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H_expansion</span><span class="o">.</span><span class="n">plot_comparison</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">srange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
<span class="go">....:                             plotjoined=True, marker=&#39;o&#39;,</span>
<span class="go">....:                             color=&#39;green&#39;)</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.compare_with_values" title="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.compare_with_values"><code class="xref py py-meth docutils literal"><span class="pre">compare_with_values()</span></code></a></p>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H_expansion</span><span class="o">.</span><span class="n">plot_comparison</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="p">[</span><span class="mi">600</span><span class="p">])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Numerical noise is too high, the comparison is inaccurate</span>
<span class="gp">sage: </span><span class="n">H_expansion</span><span class="o">.</span><span class="n">plot_comparison</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="p">[</span><span class="mi">600</span><span class="p">],</span> <span class="n">relative_tolerance</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.pow">
<code class="descname">pow</code><span class="sig-paren">(</span><em>exponent</em>, <em>precision=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.pow" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the power of this asymptotic expansion to the given <code class="docutils literal"><span class="pre">exponent</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">exponent</span></code> &#8211; an element.</li>
<li><code class="docutils literal"><span class="pre">precision</span></code> &#8211; the precision used for truncating the
expansion. If <code class="docutils literal"><span class="pre">None</span></code> (default value) is used, the
default precision of the parent is used.</li>
</ul>
<p>OUTPUT:</p>
<p>An asymptotic expansion.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;x^QQ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span>
<span class="go">x^(1/7)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">0</span><span class="p">))</span><span class="o">^</span><span class="mi">15</span>
<span class="go">x^(15/2) + O(x^7)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Z</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;y^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span>
<span class="go">y^(1/7)</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Asymptotic Ring &lt;y^QQ&gt; over Rational Field</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">y</span><span class="p">))</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">y + O(1)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">y</span><span class="p">))</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">y^(-4) + O(y^(-5))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">y</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="p">))</span><span class="o">^</span><span class="n">pi</span>
<span class="go">1 + pi*y^(-1) + (1/2*pi*(pi - 1))*y^(-2) + O(y^(-3))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;z^QQ * log(z)^QQ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">z</span><span class="p">))</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">z + O(1)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="s1">&#39;QQ^x * x^SR * log(x)^ZZ&#39;</span><span class="p">,</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">*</span> <span class="mi">2</span><span class="o">^</span><span class="n">x</span>
<span class="go">2^x*x</span>
<span class="gp">sage: </span><span class="mi">5</span><span class="o">^</span><span class="n">x</span> <span class="o">*</span> <span class="mi">2</span><span class="o">^</span><span class="n">x</span>
<span class="go">10^x</span>
<span class="gp">sage: </span><span class="mi">2</span><span class="o">^</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">x^(log(2))</span>
<span class="gp">sage: </span><span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">)</span>
<span class="go">2^x + log(2)*2^x*x^(-1) + 1/2*log(2)^2*2^x*x^(-2) + ... + O(2^x*x^(-20))</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Asymptotic Ring &lt;QQ^x * x^SR * log(x)^QQ&gt; over Symbolic Ring</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span><span class="o">.&lt;</span><span class="n">c</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;QQ^c * c^QQ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">,</span> <span class="n">default_prec</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">c</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="n">c</span>
<span class="go">3^c + 1/3*3^c*c^(-1) + 1/18*3^c*c^(-2) - 4/81*3^c*c^(-3)</span>
<span class="go">- 35/1944*3^c*c^(-4) + O(3^c*c^(-5))</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Asymptotic Ring &lt;QQ^c * c^QQ&gt; over Rational Field</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">^</span><span class="n">c</span><span class="p">)</span><span class="o">^</span><span class="n">c</span>
<span class="go">2^c + 1/2*(2/3)^c*c + 1/8*(2/9)^c*c^2 - 1/8*(2/9)^c*c</span>
<span class="go">+ 1/48*(2/27)^c*c^3 + O((2/27)^c*c^2)</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Asymptotic Ring &lt;QQ^c * c^QQ&gt; over Rational Field</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>See <a class="reference external" href="https://trac.sagemath.org/19110">trac ticket #19110</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">O</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ZeroDivisionError</span>: <span class="n">Cannot take O(x) to exponent -1.</span>
<span class="go">&gt; *previous* ZeroDivisionError: rational division by zero</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;z^QQ * log(z)^QQ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">,</span> <span class="n">default_prec</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="n">z</span><span class="p">)</span>
<span class="go">z + log(z) + 1/2*z^(-1)*log(z)^2 + 1/6*z^(-2)*log(z)^3 +</span>
<span class="go">1/24*z^(-3)*log(z)^4 + O(z^(-4)*log(z)^5)</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Asymptotic Ring &lt;z^QQ * log(z)^QQ&gt; over Rational Field</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ZeroDivisionError</span>: <span class="n">Cannot take 0 to the negative exponent -7.</span>
<span class="gp">sage: </span><span class="n">B</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">^</span><span class="n">SR</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">Taking 0 to the exponent a not implemented.</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span><span class="o">.&lt;</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;s^QQ * t^QQ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">s</span> <span class="o">+</span> <span class="n">t</span><span class="p">)</span><span class="o">^</span><span class="n">s</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Cannot take s + t to the exponent s.</span>
<span class="go">&gt; *previous* ValueError: Cannot determine main term of s + t</span>
<span class="go">since there are several maximal elements s, t.</span>
</pre></div>
</div>
<p>Check that <a class="reference external" href="https://trac.sagemath.org/19946">trac ticket #19946</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">n</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="s1">&#39;QQ^n * n^QQ&#39;</span><span class="p">,</span> <span class="n">SR</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="n">n</span><span class="p">;</span> <span class="n">e</span>
<span class="go">2^n</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Asymptotic Ring &lt;SR^n * n^SR&gt; over Symbolic Ring</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="n">e</span><span class="p">);</span> <span class="n">e</span>
<span class="go">2^n</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Asymptotic Ring &lt;QQ^n * n^QQ&gt; over Symbolic Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.rpow">
<code class="descname">rpow</code><span class="sig-paren">(</span><em>base</em>, <em>precision=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.rpow" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the power of <code class="docutils literal"><span class="pre">base</span></code> to this asymptotic expansion.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">base</span></code> &#8211; an element or <code class="docutils literal"><span class="pre">'e'</span></code>.</li>
<li><code class="docutils literal"><span class="pre">precision</span></code> &#8211; the precision used for truncating the
expansion. If <code class="docutils literal"><span class="pre">None</span></code> (default value) is used, the
default precision of the parent is used.</li>
</ul>
<p>OUTPUT:</p>
<p>An asymptotic expansion.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="s1">&#39;x^ZZ&#39;</span><span class="p">,</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">rpow</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">1 + x^(-1) + 1/2*x^(-2) + 1/6*x^(-3) + 1/24*x^(-4) + O(x^(-5))</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">rpow</span><span class="p">(</span><span class="n">SR</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ArithmeticError</span>: <span class="n">Cannot construct y^x in Growth Group x^ZZ</span>
<span class="go">&gt; *previous* TypeError: unsupported operand parent(s) for &#39;*&#39;:</span>
<span class="go">&#39;Growth Group x^ZZ&#39; and &#39;Growth Group SR^x&#39;</span>
</pre></div>
</div>
<p>Check that <a class="reference external" href="https://trac.sagemath.org/19946">trac ticket #19946</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">n</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="s1">&#39;QQ^n * n^QQ&#39;</span><span class="p">,</span> <span class="n">SR</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">rpow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">2^n</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Asymptotic Ring &lt;QQ^n * n^SR&gt; over Symbolic Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.show">
<code class="descname">show</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.show" title="Permalink to this definition">¶</a></dt>
<dd><p>Pretty-print this asymptotic expansion.</p>
<p>OUTPUT:</p>
<p>Nothing, the representation is printed directly on the
screen.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="s1">&#39;QQ^x * x^QQ * log(x)^QQ&#39;</span><span class="p">,</span> <span class="n">SR</span><span class="o">.</span><span class="n">subring</span><span class="p">(</span><span class="n">no_variables</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">5</span><span class="o">^</span><span class="n">x</span> <span class="o">*</span> <span class="n">x</span><span class="o">^</span><span class="p">(</span><span class="mi">42</span><span class="o">/</span><span class="mi">17</span><span class="p">)</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">euler_gamma</span><span class="p">)</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="o">/</span><span class="mi">8</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">&lt;html&gt;&lt;script type=&quot;math/tex&quot;&gt;\newcommand{\Bold}[1]{\mathbf{#1}}\frac{1}{2} \, \pi</span>
<span class="go">5^{x} x^{\frac{42}{17}} - \sqrt{\gamma_E} \log\left(x\right)^{-\frac{7}{8}}&lt;/script&gt;&lt;/html&gt;</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="s1">&#39;(e^x)^QQ * x^QQ&#39;</span><span class="p">,</span> <span class="n">SR</span><span class="o">.</span><span class="n">subring</span><span class="p">(</span><span class="n">no_variables</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">zeta</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="o">^</span><span class="mi">42</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">&lt;html&gt;&lt;script type=&quot;math/tex&quot;&gt;\newcommand{\Bold}[1]{\mathbf{#1}}\zeta(3)</span>
<span class="go">\left(e^{x}\right)^{-\frac{1}{2}} x^{42}&lt;/script&gt;&lt;/html&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.sqrt">
<code class="descname">sqrt</code><span class="sig-paren">(</span><em>precision=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.sqrt" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the square root of this asymptotic expansion.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">precision</span></code> &#8211; the precision used for truncating the
expansion. If <code class="docutils literal"><span class="pre">None</span></code> (default value) is used, the
default precision of the parent is used.</li>
</ul>
<p>OUTPUT:</p>
<p>An asymptotic expansion.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">s</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;s^QQ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>
<span class="go">s^(1/2)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">6</span><span class="p">);</span> <span class="n">a</span>
<span class="go">1 + 1/2*s^(-1) - 1/8*s^(-2) + 1/16*s^(-3)</span>
<span class="go">- 5/128*s^(-4) + 7/256*s^(-5) + O(s^(-6))</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.pow" title="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.pow"><code class="xref py py-meth docutils literal"><span class="pre">pow()</span></code></a>, <a class="reference internal" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.rpow" title="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.rpow"><code class="xref py py-meth docutils literal"><span class="pre">rpow()</span></code></a>, <a class="reference internal" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.exp" title="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.exp"><code class="xref py py-meth docutils literal"><span class="pre">exp()</span></code></a>.</p>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">p</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="n">default_prec</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">bool</span><span class="p">(</span><span class="n">SR</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">exact_part</span><span class="p">())</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span>
<span class="go">....:      SR((1+p).sqrt().polynomial()).subs(p=x) == 0)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.subs">
<code class="descname">subs</code><span class="sig-paren">(</span><em>rules=None</em>, <em>domain=None</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.subs" title="Permalink to this definition">¶</a></dt>
<dd><p>Substitute the given <code class="docutils literal"><span class="pre">rules</span></code> in this asymptotic expansion.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">rules</span></code> &#8211; a dictionary.</li>
<li><code class="docutils literal"><span class="pre">kwds</span></code> &#8211; keyword arguments will be added to the
substitution <code class="docutils literal"><span class="pre">rules</span></code>.</li>
<li><code class="docutils literal"><span class="pre">domain</span></code> &#8211; (default: <code class="docutils literal"><span class="pre">None</span></code>) a parent. The neutral
elements <span class="math">\(0\)</span> and <span class="math">\(1\)</span> (rules for the keys <code class="docutils literal"><span class="pre">'_zero_'</span></code> and
<code class="docutils literal"><span class="pre">'_one_'</span></code>, see note box below) are taken out of this
domain. If <code class="docutils literal"><span class="pre">None</span></code>, then this is determined automatically.</li>
</ul>
<p>OUTPUT:</p>
<p>An object.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The neutral element of the asymptotic ring is replaced by
the value to the key <code class="docutils literal"><span class="pre">'_zero_'</span></code>; the neutral element of
the growth group is replaced by the value to the key
<code class="docutils literal"><span class="pre">'_one_'</span></code>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;(e^x)^QQ * x^ZZ * log(x)^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">,</span> <span class="n">default_prec</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="n">x</span> <span class="o">*</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">SR</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">))</span>
<span class="go">s^2*e^s + log(s)</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Symbolic Ring</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">x^3 + 15*x^2 + 76*x + log(x) + 130 + O(x^(-1))</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Asymptotic Ring &lt;(e^x)^QQ * x^ZZ * log(x)^ZZ&gt; over Rational Field</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="n">x</span> <span class="o">*</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="go">4*(e^x)^2*x^2 + log(x) + log(2)</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Asymptotic Ring &lt;(e^x)^QQ * x^QQ * log(x)^QQ&gt; over Symbolic Ring</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">16*x^2 + 16*x + log(x) + log(4) + 4 + 1/2*x^(-1) + O(x^(-2))</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Asymptotic Ring &lt;(e^x)^QQ * x^ZZ * log(x)^ZZ&gt; over Symbolic Ring</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="n">x</span> <span class="o">*</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">RIF</span><span class="p">(</span><span class="n">pi</span><span class="p">))</span>
<span class="go">229.534211738584?</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Real Interval Field with 53 bits of precision</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference external" href="../../../../calculus/sage/symbolic/expression.html#sage.symbolic.expression.Expression.subs" title="(in Sage Reference Manual: Symbolic Calculus v7.4)"><code class="xref py py-meth docutils literal"><span class="pre">sage.symbolic.expression.Expression.subs()</span></code></a></p>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">})</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Cannot substitute y in x since it is not a generator of</span>
<span class="go">Asymptotic Ring &lt;(e^x)^QQ * x^ZZ * log(x)^ZZ&gt; over Rational Field.</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;u^QQ * v^QQ * w^QQ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">u</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s1">&#39;u&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Cannot apply the substitution rules {u: 0} on u^(-1) in</span>
<span class="go">Asymptotic Ring &lt;u^QQ * v^QQ * w^QQ&gt; over Rational Field.</span>
<span class="go">&gt; *previous* ZeroDivisionError: Cannot substitute in u^(-1) in</span>
<span class="go">Asymptotic Ring &lt;u^QQ * v^QQ * w^QQ&gt; over Rational Field.</span>
<span class="go">&gt;&gt; *previous* ZeroDivisionError: Cannot substitute in u^(-1) in</span>
<span class="go">Exact Term Monoid u^QQ * v^QQ * w^QQ with coefficients in Rational Field.</span>
<span class="go">&gt;...&gt; *previous* ZeroDivisionError: Cannot substitute in u^(-1) in</span>
<span class="go">Growth Group u^QQ * v^QQ * w^QQ.</span>
<span class="go">&gt;...&gt; *previous* ZeroDivisionError: Cannot substitute in u^(-1) in</span>
<span class="go">Growth Group u^QQ.</span>
<span class="go">&gt;...&gt; *previous* ZeroDivisionError: rational division by zero</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">u</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s1">&#39;u&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">:</span> <span class="n">SR</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">)})</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Cannot apply the substitution rules {u: 0, v: v} on u^(-1) in</span>
<span class="go">Asymptotic Ring &lt;u^QQ * v^QQ * w^QQ&gt; over Rational Field.</span>
<span class="go">&gt; *previous* ZeroDivisionError: Cannot substitute in u^(-1) in</span>
<span class="go">Asymptotic Ring &lt;u^QQ * v^QQ * w^QQ&gt; over Rational Field.</span>
<span class="go">&gt;&gt; *previous* ZeroDivisionError: Cannot substitute in u^(-1) in</span>
<span class="go">Exact Term Monoid u^QQ * v^QQ * w^QQ with coefficients in Rational Field.</span>
<span class="go">&gt;...&gt; *previous* ZeroDivisionError: Cannot substitute in u^(-1) in</span>
<span class="go">Growth Group u^QQ * v^QQ * w^QQ.</span>
<span class="go">&gt;...&gt; *previous* ZeroDivisionError: Cannot substitute in u^(-1) in</span>
<span class="go">Growth Group u^QQ.</span>
<span class="go">&gt;...&gt; *previous* ZeroDivisionError: rational division by zero</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">u</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">:</span> <span class="n">SR</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">)})</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">u</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">:</span> <span class="n">SR</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">)})</span>
<span class="go">v</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Symbolic Ring</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">SR</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">})</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Cannot substitute u in u since it is neither an</span>
<span class="go">asymptotic expansion nor a string</span>
<span class="go">(but a &lt;type &#39;sage.symbolic.expression.Expression&#39;&gt;).</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">u</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">u</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">u</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">u</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Cannot substitute in u: duplicate key u.</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">u</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">u</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Cannot substitute in u: duplicate key u.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.substitute">
<code class="descname">substitute</code><span class="sig-paren">(</span><em>rules=None</em>, <em>domain=None</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.substitute" title="Permalink to this definition">¶</a></dt>
<dd><p>Substitute the given <code class="docutils literal"><span class="pre">rules</span></code> in this asymptotic expansion.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">rules</span></code> &#8211; a dictionary.</li>
<li><code class="docutils literal"><span class="pre">kwds</span></code> &#8211; keyword arguments will be added to the
substitution <code class="docutils literal"><span class="pre">rules</span></code>.</li>
<li><code class="docutils literal"><span class="pre">domain</span></code> &#8211; (default: <code class="docutils literal"><span class="pre">None</span></code>) a parent. The neutral
elements <span class="math">\(0\)</span> and <span class="math">\(1\)</span> (rules for the keys <code class="docutils literal"><span class="pre">'_zero_'</span></code> and
<code class="docutils literal"><span class="pre">'_one_'</span></code>, see note box below) are taken out of this
domain. If <code class="docutils literal"><span class="pre">None</span></code>, then this is determined automatically.</li>
</ul>
<p>OUTPUT:</p>
<p>An object.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The neutral element of the asymptotic ring is replaced by
the value to the key <code class="docutils literal"><span class="pre">'_zero_'</span></code>; the neutral element of
the growth group is replaced by the value to the key
<code class="docutils literal"><span class="pre">'_one_'</span></code>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;(e^x)^QQ * x^ZZ * log(x)^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">,</span> <span class="n">default_prec</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="n">x</span> <span class="o">*</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">SR</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">))</span>
<span class="go">s^2*e^s + log(s)</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Symbolic Ring</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">x^3 + 15*x^2 + 76*x + log(x) + 130 + O(x^(-1))</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Asymptotic Ring &lt;(e^x)^QQ * x^ZZ * log(x)^ZZ&gt; over Rational Field</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="n">x</span> <span class="o">*</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="go">4*(e^x)^2*x^2 + log(x) + log(2)</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Asymptotic Ring &lt;(e^x)^QQ * x^QQ * log(x)^QQ&gt; over Symbolic Ring</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">16*x^2 + 16*x + log(x) + log(4) + 4 + 1/2*x^(-1) + O(x^(-2))</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Asymptotic Ring &lt;(e^x)^QQ * x^ZZ * log(x)^ZZ&gt; over Symbolic Ring</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="n">x</span> <span class="o">*</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">RIF</span><span class="p">(</span><span class="n">pi</span><span class="p">))</span>
<span class="go">229.534211738584?</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Real Interval Field with 53 bits of precision</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference external" href="../../../../calculus/sage/symbolic/expression.html#sage.symbolic.expression.Expression.subs" title="(in Sage Reference Manual: Symbolic Calculus v7.4)"><code class="xref py py-meth docutils literal"><span class="pre">sage.symbolic.expression.Expression.subs()</span></code></a></p>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">})</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Cannot substitute y in x since it is not a generator of</span>
<span class="go">Asymptotic Ring &lt;(e^x)^QQ * x^ZZ * log(x)^ZZ&gt; over Rational Field.</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;u^QQ * v^QQ * w^QQ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">u</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s1">&#39;u&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Cannot apply the substitution rules {u: 0} on u^(-1) in</span>
<span class="go">Asymptotic Ring &lt;u^QQ * v^QQ * w^QQ&gt; over Rational Field.</span>
<span class="go">&gt; *previous* ZeroDivisionError: Cannot substitute in u^(-1) in</span>
<span class="go">Asymptotic Ring &lt;u^QQ * v^QQ * w^QQ&gt; over Rational Field.</span>
<span class="go">&gt;&gt; *previous* ZeroDivisionError: Cannot substitute in u^(-1) in</span>
<span class="go">Exact Term Monoid u^QQ * v^QQ * w^QQ with coefficients in Rational Field.</span>
<span class="go">&gt;...&gt; *previous* ZeroDivisionError: Cannot substitute in u^(-1) in</span>
<span class="go">Growth Group u^QQ * v^QQ * w^QQ.</span>
<span class="go">&gt;...&gt; *previous* ZeroDivisionError: Cannot substitute in u^(-1) in</span>
<span class="go">Growth Group u^QQ.</span>
<span class="go">&gt;...&gt; *previous* ZeroDivisionError: rational division by zero</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">u</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s1">&#39;u&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">:</span> <span class="n">SR</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">)})</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Cannot apply the substitution rules {u: 0, v: v} on u^(-1) in</span>
<span class="go">Asymptotic Ring &lt;u^QQ * v^QQ * w^QQ&gt; over Rational Field.</span>
<span class="go">&gt; *previous* ZeroDivisionError: Cannot substitute in u^(-1) in</span>
<span class="go">Asymptotic Ring &lt;u^QQ * v^QQ * w^QQ&gt; over Rational Field.</span>
<span class="go">&gt;&gt; *previous* ZeroDivisionError: Cannot substitute in u^(-1) in</span>
<span class="go">Exact Term Monoid u^QQ * v^QQ * w^QQ with coefficients in Rational Field.</span>
<span class="go">&gt;...&gt; *previous* ZeroDivisionError: Cannot substitute in u^(-1) in</span>
<span class="go">Growth Group u^QQ * v^QQ * w^QQ.</span>
<span class="go">&gt;...&gt; *previous* ZeroDivisionError: Cannot substitute in u^(-1) in</span>
<span class="go">Growth Group u^QQ.</span>
<span class="go">&gt;...&gt; *previous* ZeroDivisionError: rational division by zero</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">u</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">:</span> <span class="n">SR</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">)})</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">u</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">:</span> <span class="n">SR</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">)})</span>
<span class="go">v</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Symbolic Ring</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">SR</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">})</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Cannot substitute u in u since it is neither an</span>
<span class="go">asymptotic expansion nor a string</span>
<span class="go">(but a &lt;type &#39;sage.symbolic.expression.Expression&#39;&gt;).</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">u</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">u</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">u</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">u</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Cannot substitute in u: duplicate key u.</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">u</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">u</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Cannot substitute in u: duplicate key u.</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.summands">
<code class="descname">summands</code><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.summands" title="Permalink to this definition">¶</a></dt>
<dd><p>The summands of this asymptotic expansion stored in the
underlying data structure (a
<a class="reference external" href="../../../../data_structures/sage/data_structures/mutable_poset.html#sage.data_structures.mutable_poset.MutablePoset" title="(in Sage Reference Manual: Data Structures v7.4)"><code class="xref py py-class docutils literal"><span class="pre">MutablePoset</span></code></a>).</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;x^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">expr</span> <span class="o">=</span> <span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">12</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">expr</span><span class="o">.</span><span class="n">summands</span>
<span class="go">poset(O(x^3), x^5, 7*x^12)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference external" href="../../../../data_structures/sage/data_structures/mutable_poset.html#sage.data_structures.mutable_poset.MutablePoset" title="(in Sage Reference Manual: Data Structures v7.4)"><code class="xref py py-class docutils literal"><span class="pre">sage.data_structures.mutable_poset.MutablePoset</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.symbolic_expression">
<code class="descname">symbolic_expression</code><span class="sig-paren">(</span><em>R=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.symbolic_expression" title="Permalink to this definition">¶</a></dt>
<dd><p>Return this asymptotic expansion as a symbolic expression.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">R</span></code> &#8211; (a subring of) the symbolic ring or <code class="docutils literal"><span class="pre">None</span></code>.
The output is will be an element of <code class="docutils literal"><span class="pre">R</span></code>. If <code class="docutils literal"><span class="pre">None</span></code>,
then the symbolic ring is used.</li>
</ul>
<p>OUTPUT:</p>
<p>A symbolic expression.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;x^ZZ * y^QQ * log(y)^QQ * QQ^z * z^QQ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">SR</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">an_element</span><span class="p">())</span>  <span class="c1"># indirect doctest</span>
<span class="go">1/8*(1/8)^z*x^3*y^(3/2)*z^(3/2)*log(y)^(3/2) +</span>
<span class="go">Order((1/2)^z*x*sqrt(y)*sqrt(z)*sqrt(log(y)))</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">an_element</span><span class="p">();</span> <span class="n">a</span>
<span class="go">1/8*x^3*y^(3/2)*log(y)^(3/2)*(1/8)^z*z^(3/2) +</span>
<span class="go">O(x*y^(1/2)*log(y)^(1/2)*(1/2)^z*z^(1/2))</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">symbolic_expression</span><span class="p">()</span>
<span class="go">1/8*(1/8)^z*x^3*y^(3/2)*z^(3/2)*log(y)^(3/2) +</span>
<span class="go">Order((1/2)^z*x*sqrt(y)*sqrt(z)*sqrt(log(y)))</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Symbolic Ring</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.symbolic.ring</span> <span class="kn">import</span> <span class="n">SymbolicRing</span>
<span class="gp">sage: </span><span class="k">class</span> <span class="nc">MySymbolicRing</span><span class="p">(</span><span class="n">SymbolicRing</span><span class="p">):</span>
<span class="go">....:     pass</span>
<span class="gp">sage: </span><span class="n">mySR</span> <span class="o">=</span> <span class="n">MySymbolicRing</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">symbolic_expression</span><span class="p">(</span><span class="n">mySR</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">mySR</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.truncate">
<code class="descname">truncate</code><span class="sig-paren">(</span><em>precision=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.truncate" title="Permalink to this definition">¶</a></dt>
<dd><p>Truncate this asymptotic expansion.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">precision</span></code> &#8211; a positive integer or <code class="docutils literal"><span class="pre">None</span></code>. Number of
summands that are kept. If <code class="docutils literal"><span class="pre">None</span></code> (default value) is
given, then <code class="docutils literal"><span class="pre">default_prec</span></code> from the parent is used.</li>
</ul>
<p>OUTPUT:</p>
<p>An asymptotic expansion.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For example, truncating an asymptotic expansion with
<code class="docutils literal"><span class="pre">precision=20</span></code> does not yield an expansion with exactly 20
summands! Rather than that, it keeps the 20 summands
with the largest growth, and adds appropriate
<span class="math">\(O\)</span>-Terms.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="s1">&#39;x^ZZ&#39;</span><span class="p">,</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ex</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">));</span> <span class="n">ex</span>
<span class="go">x^4 + x^3 + x^2 + x + 1</span>
<span class="gp">sage: </span><span class="n">ex</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x^4 + x^3 + O(x^2)</span>
<span class="gp">sage: </span><span class="n">ex</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">O(x^4)</span>
<span class="gp">sage: </span><span class="n">ex</span><span class="o">.</span><span class="n">truncate</span><span class="p">()</span>
<span class="go">x^4 + x^3 + x^2 + x + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.variable_names">
<code class="descname">variable_names</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.variable_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the names of the variables of this asymptotic expansion.</p>
<p>OUTPUT:</p>
<p>A tuple of strings.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="s1">&#39;QQ^m * m^QQ * n^ZZ * log(n)^ZZ&#39;</span><span class="p">,</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="mi">2</span><span class="o">^</span><span class="n">m</span><span class="o">*</span><span class="n">m</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">n</span><span class="p">))</span><span class="o">.</span><span class="n">variable_names</span><span class="p">()</span>
<span class="go">(&#39;m&#39;, &#39;n&#39;)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="mi">2</span><span class="o">^</span><span class="n">m</span><span class="o">*</span><span class="n">m</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">variable_names</span><span class="p">()</span>
<span class="go">(&#39;m&#39;,)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">n</span><span class="p">))</span><span class="o">.</span><span class="n">variable_names</span><span class="p">()</span>
<span class="go">(&#39;n&#39;,)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">variable_names</span><span class="p">()</span>
<span class="go">(&#39;m&#39;,)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="o">^</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">variable_names</span><span class="p">()</span>
<span class="go">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="mi">2</span><span class="o">^</span><span class="n">m</span><span class="o">*</span><span class="n">m</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">n</span><span class="p">))</span><span class="o">.</span><span class="n">variable_names</span><span class="p">()</span>
<span class="go">(&#39;m&#39;, &#39;n&#39;)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="n">m</span> <span class="o">+</span> <span class="n">m</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">n</span><span class="p">))</span><span class="o">.</span><span class="n">variable_names</span><span class="p">()</span>
<span class="go">(&#39;m&#39;, &#39;n&#39;)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="n">m</span> <span class="o">+</span> <span class="n">m</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">variable_names</span><span class="p">()</span>
<span class="go">(&#39;m&#39;,)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticRing">
<em class="property">class </em><code class="descclassname">sage.rings.asymptotic.asymptotic_ring.</code><code class="descname">AsymptoticRing</code><span class="sig-paren">(</span><em>growth_group</em>, <em>coefficient_ring</em>, <em>category</em>, <em>default_prec</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticRing" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../rings/sage/rings/ring.html#sage.rings.ring.Algebra" title="(in Sage Reference Manual: General Rings, Ideals, and Morphisms v7.4)"><code class="xref py py-class docutils literal"><span class="pre">sage.rings.ring.Algebra</span></code></a>, <a class="reference external" href="../../../../structure/sage/structure/unique_representation.html#sage.structure.unique_representation.UniqueRepresentation" title="(in Sage Reference Manual: Basic Structures v7.4)"><code class="xref py py-class docutils literal"><span class="pre">sage.structure.unique_representation.UniqueRepresentation</span></code></a></p>
<p>A ring consisting of <a class="reference internal" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion" title="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion"><code class="xref py py-class docutils literal"><span class="pre">asymptotic</span> <span class="pre">expansions</span></code></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">growth_group</span></code> &#8211; either a partially ordered group (see
<a class="reference internal" href="growth_group.html"><span class="doc">(Asymptotic) Growth Groups</span></a>) or a string
describing such a growth group (see
<a class="reference internal" href="growth_group.html#sage.rings.asymptotic.growth_group.GrowthGroupFactory" title="sage.rings.asymptotic.growth_group.GrowthGroupFactory"><code class="xref py py-class docutils literal"><span class="pre">GrowthGroupFactory</span></code></a>).</li>
<li><code class="docutils literal"><span class="pre">coefficient_ring</span></code> &#8211; the ring which contains the
coefficients of the expansions.</li>
<li><code class="docutils literal"><span class="pre">default_prec</span></code> &#8211; a positive integer. This is the number of
summands that are kept before truncating an infinite series.</li>
<li><code class="docutils literal"><span class="pre">category</span></code> &#8211; the category of the parent can be specified
in order to broaden the base structure. It has to be a
subcategory of <code class="docutils literal"><span class="pre">Category</span> <span class="pre">of</span> <span class="pre">rings</span></code>. This is also the default
category if <code class="docutils literal"><span class="pre">None</span></code> is specified.</li>
</ul>
<p>EXAMPLES:</p>
<p>We begin with the construction of an asymptotic ring in various
ways. First, we simply pass a string specifying the underlying
growth group:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R1_x</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;x^QQ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">);</span> <span class="n">R1_x</span>
<span class="go">Asymptotic Ring &lt;x^QQ&gt; over Rational Field</span>
<span class="gp">sage: </span><span class="n">x</span>
<span class="go">x</span>
</pre></div>
</div>
<p>This is equivalent to the following code, which explicitly
specifies the underlying growth group:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.asymptotic.growth_group</span> <span class="kn">import</span> <span class="n">GrowthGroup</span>
<span class="gp">sage: </span><span class="n">G_QQ</span> <span class="o">=</span> <span class="n">GrowthGroup</span><span class="p">(</span><span class="s1">&#39;x^QQ&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R2_x</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="n">G_QQ</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">);</span> <span class="n">R2_x</span>
<span class="go">Asymptotic Ring &lt;x^QQ&gt; over Rational Field</span>
</pre></div>
</div>
<p>Of course, the coefficient ring of the asymptotic ring and the
base ring of the underlying growth group do not need to
coincide:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R_ZZ_x</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;x^QQ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">ZZ</span><span class="p">);</span> <span class="n">R_ZZ_x</span>
<span class="go">Asymptotic Ring &lt;x^QQ&gt; over Integer Ring</span>
</pre></div>
</div>
<p>Note, we can also create and use logarithmic growth groups:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R_log</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;log(x)^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">);</span> <span class="n">R_log</span>
<span class="go">Asymptotic Ring &lt;log(x)^ZZ&gt; over Rational Field</span>
</pre></div>
</div>
<p>Other growth groups are available. See <a class="reference internal" href="#"><span class="doc">Asymptotic Ring</span></a> for
more examples.</p>
<p>Below there are some technical details.</p>
<p>According to the conventions for parents, uniqueness is ensured:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R1_x</span> <span class="ow">is</span> <span class="n">R2_x</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Furthermore, the coercion framework is also involved. Coercion
between two asymptotic rings is possible (given that the
underlying growth groups and coefficient rings are chosen
appropriately):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R1_x</span><span class="o">.</span><span class="n">has_coerce_map_from</span><span class="p">(</span><span class="n">R_ZZ_x</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Additionally, for the sake of convenience, the coefficient ring
also coerces into the asymptotic ring (representing constant
quantities):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R1_x</span><span class="o">.</span><span class="n">has_coerce_map_from</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.asymptotic.asymptotic_ring</span> <span class="kn">import</span> <span class="n">AsymptoticRing</span> <span class="k">as</span> <span class="n">AR_class</span>
<span class="gp">sage: </span><span class="k">class</span> <span class="nc">AR</span><span class="p">(</span><span class="n">AR_class</span><span class="p">):</span>
<span class="go">....:     class Element(AR_class.Element):</span>
<span class="go">....:         __eq__ = AR_class.Element.has_same_summands</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AR</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;z^QQ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">islice</span>
<span class="gp">sage: </span><span class="n">TestSuite</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>  <span class="c1"># not tested  # long time  # see #19424</span>
<span class="go">....:     verbose=True,</span>
<span class="go">....:     elements=tuple(islice(A.some_elements(), 10)),</span>
<span class="go">....:     skip=(&#39;_test_some_elements&#39;,  # to many elements</span>
<span class="go">....:           &#39;_test_distributivity&#39;))  # due to cancellations: O(z) != O(z^2)</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticRing.Element">
<code class="descname">Element</code><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticRing.Element" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion" title="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion"><code class="xref py py-class docutils literal"><span class="pre">AsymptoticExpansion</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticRing.change_parameter">
<code class="descname">change_parameter</code><span class="sig-paren">(</span><em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticRing.change_parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an asymptotic ring with a change in one or more of the given parameters.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">growth_group</span></code> &#8211; (default: <code class="docutils literal"><span class="pre">None</span></code>) the new growth group.</li>
<li><code class="docutils literal"><span class="pre">coefficient_ring</span></code> &#8211; (default: <code class="docutils literal"><span class="pre">None</span></code>) the new coefficient ring.</li>
<li><code class="docutils literal"><span class="pre">category</span></code> &#8211; (default: <code class="docutils literal"><span class="pre">None</span></code>) the new category.</li>
<li><code class="docutils literal"><span class="pre">default_prec</span></code> &#8211; (default: <code class="docutils literal"><span class="pre">None</span></code>) the new default precision.</li>
</ul>
<p>OUTPUT:</p>
<p>An asymptotic ring.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;x^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">change_parameter</span><span class="p">(</span><span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="go">Asymptotic Ring &lt;x^ZZ&gt; over Rational Field</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">change_parameter</span><span class="p">(</span><span class="n">coefficient_ring</span><span class="o">=</span><span class="n">ZZ</span><span class="p">)</span> <span class="ow">is</span> <span class="n">A</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">change_parameter</span><span class="p">(</span><span class="n">coefficient_ring</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span> <span class="ow">is</span> <span class="n">A</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticRing.coefficient_ring">
<code class="descname">coefficient_ring</code><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticRing.coefficient_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>The coefficient ring of this asymptotic ring.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">AR</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;x^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">AR</span><span class="o">.</span><span class="n">coefficient_ring</span>
<span class="go">Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticRing.coefficients_of_generating_function">
<code class="descname">coefficients_of_generating_function</code><span class="sig-paren">(</span><em>function</em>, <em>singularities</em>, <em>precision=None</em>, <em>return_singular_expansions=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticRing.coefficients_of_generating_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the asymptotic growth of the coefficients of some
generating function by means of Singularity Analysis.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">function</span></code> &#8211; a callable function in one variable.</li>
<li><code class="docutils literal"><span class="pre">singularities</span></code> &#8211; list of dominant singularities of the function.</li>
<li><code class="docutils literal"><span class="pre">precision</span></code> &#8211; (default: <code class="docutils literal"><span class="pre">None</span></code>) an integer. If <code class="docutils literal"><span class="pre">None</span></code>, then
the default precision of the asymptotic ring is used.</li>
<li><code class="docutils literal"><span class="pre">return_singular_expansions</span></code> &#8211; (default: <code class="docutils literal"><span class="pre">False</span></code>) a boolean.
If set, the singular expansions are also returned.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>If <code class="docutils literal"><span class="pre">return_singular_expansions=False</span></code>: An asymptotic expansion from
this ring.</li>
<li>If <code class="docutils literal"><span class="pre">return_singular_expansions=True</span></code>: A named tuple with
components <code class="docutils literal"><span class="pre">asymptotic_expansion</span></code> and
<code class="docutils literal"><span class="pre">singular_expansions</span></code>. The former contains an asymptotic
expansion from this ring, the latter is a dictionary which
contains the singular expansions around the singularities.</li>
</ul>
<div class="admonition-todo admonition" id="index-4">
<p class="first admonition-title">Todo</p>
<p class="last">Make this method more usable by implementing the
processing of symbolic expressions.</p>
</div>
<p>EXAMPLES:</p>
<p>Catalan numbers:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">def</span> <span class="nf">catalan</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
<span class="go">....:     return (1-(1-4*z)^(1/2))/(2*z)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">n</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="s1">&#39;QQ^n * n^QQ&#39;</span><span class="p">,</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">coefficients_of_generating_function</span><span class="p">(</span><span class="n">catalan</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1/sqrt(pi)*4^n*n^(-3/2) - 9/8/sqrt(pi)*4^n*n^(-5/2)</span>
<span class="go">+ 145/128/sqrt(pi)*4^n*n^(-7/2) + O(4^n*n^(-4))</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">coefficients_of_generating_function</span><span class="p">(</span><span class="n">catalan</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="go">....:                        return_singular_expansions=True)</span>
<span class="go">SingularityAnalysisResult(asymptotic_expansion=1/sqrt(pi)*4^n*n^(-3/2)</span>
<span class="go">- 9/8/sqrt(pi)*4^n*n^(-5/2) + O(4^n*n^(-3)),</span>
<span class="go">singular_expansions={1/4: 2 - 2*T^(-1/2)</span>
<span class="go">+ 2*T^(-1) - 2*T^(-3/2) + O(T^(-2))})</span>
</pre></div>
</div>
<p>Unit fractions:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">def</span> <span class="nf">logarithmic</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
<span class="go">....:     return -log(1-z)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">coefficients_of_generating_function</span><span class="p">(</span><span class="n">logarithmic</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">n^(-1) + O(n^(-3))</span>
</pre></div>
</div>
<p>Harmonic numbers:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">def</span> <span class="nf">harmonic</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
<span class="go">....:     return -log(1-z)/(1-z)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">n</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="s1">&#39;QQ^n * n^QQ * log(n)^QQ&#39;</span><span class="p">,</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ex</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">coefficients_of_generating_function</span><span class="p">(</span><span class="n">harmonic</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">13</span><span class="p">);</span> <span class="n">ex</span>
<span class="go">log(n) + euler_gamma + 1/2*n^(-1) - 1/12*n^(-2) + 1/120*n^(-4)</span>
<span class="go">+ O(n^(-6))</span>
<span class="gp">sage: </span><span class="n">ex</span><span class="o">.</span><span class="n">has_same_summands</span><span class="p">(</span><span class="n">asymptotic_expansions</span><span class="o">.</span><span class="n">HarmonicNumber</span><span class="p">(</span>
<span class="go">....:    &#39;n&#39;, precision=5))</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Once singular expansions around points other than infinity
are implemented (<a class="reference external" href="https://trac.sagemath.org/20050">trac ticket #20050</a>), the output in the case
<code class="docutils literal"><span class="pre">return_singular_expansions</span></code> will change to return singular
expansions around the singularities.</p>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
<span class="go">....:     return z/(1-z)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">coefficients_of_generating_function</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedOZero</span>: <span class="n">The error term in the result is O(0)</span>
<span class="go">which means 0 for sufficiently large n.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticRing.construction">
<code class="descname">construction</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticRing.construction" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the construction of this asymptotic ring.</p>
<p>OUTPUT:</p>
<p>A pair whose first entry is an
<a class="reference internal" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticRingFunctor" title="sage.rings.asymptotic.asymptotic_ring.AsymptoticRingFunctor"><code class="xref py py-class docutils literal"><span class="pre">asymptotic</span> <span class="pre">ring</span> <span class="pre">construction</span> <span class="pre">functor</span></code></a>
and its second entry the coefficient ring.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;x^ZZ * QQ^y&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">construction</span><span class="p">()</span>
<span class="go">(AsymptoticRing&lt;x^ZZ * QQ^y&gt;, Rational Field)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#"><span class="doc">Asymptotic Ring</span></a>,
<a class="reference internal" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticRing" title="sage.rings.asymptotic.asymptotic_ring.AsymptoticRing"><code class="xref py py-class docutils literal"><span class="pre">AsymptoticRing</span></code></a>,
<a class="reference internal" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticRingFunctor" title="sage.rings.asymptotic.asymptotic_ring.AsymptoticRingFunctor"><code class="xref py py-class docutils literal"><span class="pre">AsymptoticRingFunctor</span></code></a>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticRing.create_summand">
<code class="descname">create_summand</code><span class="sig-paren">(</span><em>type</em>, <em>data=None</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticRing.create_summand" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a simple asymptotic expansion consisting of a single
summand.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">type</span></code> &#8211; &#8216;O&#8217; or &#8216;exact&#8217;.</li>
<li><code class="docutils literal"><span class="pre">data</span></code> &#8211; the element out of which a summand has to be created.</li>
<li><code class="docutils literal"><span class="pre">growth</span></code> &#8211; an element of the <a class="reference internal" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticRing.growth_group" title="sage.rings.asymptotic.asymptotic_ring.AsymptoticRing.growth_group"><code class="xref py py-meth docutils literal"><span class="pre">growth_group()</span></code></a>.</li>
<li><code class="docutils literal"><span class="pre">coefficient</span></code> &#8211; an element of the <a class="reference internal" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticRing.coefficient_ring" title="sage.rings.asymptotic.asymptotic_ring.AsymptoticRing.coefficient_ring"><code class="xref py py-meth docutils literal"><span class="pre">coefficient_ring()</span></code></a>.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Either <code class="docutils literal"><span class="pre">growth</span></code> and <code class="docutils literal"><span class="pre">coefficient</span></code> or <code class="docutils literal"><span class="pre">data</span></code> have to
be specified.</p>
</div>
<p>OUTPUT:</p>
<p>An asymptotic expansion.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method calls the factory <a class="reference internal" href="term_monoid.html#sage.rings.asymptotic.term_monoid.TermMonoidFactory" title="sage.rings.asymptotic.term_monoid.TermMonoidFactory"><code class="xref py py-class docutils literal"><span class="pre">TermMonoid</span></code></a>
with the appropriate arguments.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;x^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">create_summand</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">O(x^2)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">create_summand</span><span class="p">(</span><span class="s1">&#39;exact&#39;</span><span class="p">,</span> <span class="n">growth</span><span class="o">=</span><span class="n">x</span><span class="o">^</span><span class="mi">456</span><span class="p">,</span> <span class="n">coefficient</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
<span class="go">123*x^456</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">create_summand</span><span class="p">(</span><span class="s1">&#39;exact&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="mi">12</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">13</span><span class="p">)</span>
<span class="go">12*x^13</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">create_summand</span><span class="p">(</span><span class="s1">&#39;exact&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;12*x^13&#39;</span><span class="p">)</span>
<span class="go">12*x^13</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">create_summand</span><span class="p">(</span><span class="s1">&#39;exact&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;x^13 * 12&#39;</span><span class="p">)</span>
<span class="go">12*x^13</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">create_summand</span><span class="p">(</span><span class="s1">&#39;exact&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;x^13&#39;</span><span class="p">)</span>
<span class="go">x^13</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">create_summand</span><span class="p">(</span><span class="s1">&#39;exact&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;12&#39;</span><span class="p">)</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">create_summand</span><span class="p">(</span><span class="s1">&#39;exact&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="go">12</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Z</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">change_parameter</span><span class="p">(</span><span class="n">coefficient_ring</span><span class="o">=</span><span class="n">Zmod</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Z</span><span class="o">.</span><span class="n">create_summand</span><span class="p">(</span><span class="s1">&#39;exact&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">create_summand</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="n">growth</span><span class="o">=</span><span class="mi">42</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">coefficient</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Growth 42*x^2 is not in O-Term Monoid x^ZZ with implicit coefficients in Integer Ring.</span>
<span class="go">&gt; *previous* ValueError: 42*x^2 is not in Growth Group x^ZZ.</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">AR</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="s1">&#39;z^QQ&#39;</span><span class="p">,</span> <span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">AR</span><span class="o">.</span><span class="n">create_summand</span><span class="p">(</span><span class="s1">&#39;exact&#39;</span><span class="p">,</span> <span class="n">growth</span><span class="o">=</span><span class="s1">&#39;z^2&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Cannot create exact term: only &#39;growth&#39; but</span>
<span class="go">no &#39;coefficient&#39; specified.</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticRing.default_prec">
<code class="descname">default_prec</code><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticRing.default_prec" title="Permalink to this definition">¶</a></dt>
<dd><p>The default precision of this asymptotic ring.</p>
<p>This is the parameter used to determine how many summands
are kept before truncating an infinite series (which occur
when inverting asymptotic expansions).</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">AR</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;x^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">AR</span><span class="o">.</span><span class="n">default_prec</span>
<span class="go">20</span>
<span class="gp">sage: </span><span class="n">AR</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="s1">&#39;x^ZZ&#39;</span><span class="p">,</span> <span class="n">ZZ</span><span class="p">,</span> <span class="n">default_prec</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">AR</span><span class="o">.</span><span class="n">default_prec</span>
<span class="go">123</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticRing.gen">
<code class="descname">gen</code><span class="sig-paren">(</span><em>n=0</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticRing.gen" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <code class="docutils literal"><span class="pre">n</span></code>-th generator of this asymptotic ring.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">n</span></code> &#8211; (default: <span class="math">\(0\)</span>) a non-negative integer.</li>
</ul>
<p>OUTPUT:</p>
<p>An asymptotic expansion.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;x^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="go">x</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticRing.gens">
<code class="descname">gens</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticRing.gens" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a tuple with generators of this asymptotic ring.</p>
<p>INPUT:</p>
<p>Nothing.</p>
<p>OUTPUT:</p>
<p>A tuple of asymptotic expansions.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Generators do not necessarily exist. This depends on the
underlying growth group. For example,
<a class="reference internal" href="growth_group.html#sage.rings.asymptotic.growth_group.MonomialGrowthGroup" title="sage.rings.asymptotic.growth_group.MonomialGrowthGroup"><code class="xref py py-class docutils literal"><span class="pre">monomial</span> <span class="pre">growth</span> <span class="pre">groups</span></code></a>
have a generator, and exponential growth groups
do not.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">AR</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;x^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">AR</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(x,)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;y^ZZ * z^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(y, z)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticRing.growth_group">
<code class="descname">growth_group</code><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticRing.growth_group" title="Permalink to this definition">¶</a></dt>
<dd><p>The growth group of this asymptotic ring.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">AR</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;x^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">AR</span><span class="o">.</span><span class="n">growth_group</span>
<span class="go">Growth Group x^ZZ</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="growth_group.html"><span class="doc">(Asymptotic) Growth Groups</span></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticRing.ngens">
<code class="descname">ngens</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticRing.ngens" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of generators of this asymptotic ring.</p>
<p>INPUT:</p>
<p>Nothing.</p>
<p>OUTPUT:</p>
<p>An integer.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">AR</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;x^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">AR</span><span class="o">.</span><span class="n">ngens</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticRing.some_elements">
<code class="descname">some_elements</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticRing.some_elements" title="Permalink to this definition">¶</a></dt>
<dd><p>Return some elements of this term monoid.</p>
<p>See <a class="reference external" href="../../../../misc/sage/misc/sage_unittest.html#sage.misc.sage_unittest.TestSuite" title="(in Sage Reference Manual: Utilities v7.4)"><code class="xref py py-class docutils literal"><span class="pre">TestSuite</span></code></a> for a typical use case.</p>
<p>INPUT:</p>
<p>Nothing.</p>
<p>OUTPUT:</p>
<p>An iterator.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">islice</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;z^QQ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">tuple</span><span class="p">(</span><span class="n">islice</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">some_elements</span><span class="p">(),</span> <span class="mi">10</span><span class="p">))</span>
<span class="go">(z^(3/2) + O(z^(1/2)),</span>
<span class="go"> O(z^(1/2)),</span>
<span class="go"> z^(3/2) + O(z^(-1/2)),</span>
<span class="go"> -z^(3/2) + O(z^(1/2)),</span>
<span class="go"> O(z^(-1/2)),</span>
<span class="go"> O(z^2),</span>
<span class="go"> z^6 + O(z^(1/2)),</span>
<span class="go"> -z^(3/2) + O(z^(-1/2)),</span>
<span class="go"> O(z^2),</span>
<span class="go"> z^(3/2) + O(z^(-2)))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticRing.variable_names">
<code class="descname">variable_names</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticRing.variable_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the names of the variables.</p>
<p>OUTPUT:</p>
<p>A tuple of strings.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;x^ZZ * QQ^y&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">variable_names</span><span class="p">()</span>
<span class="go">(&#39;x&#39;, &#39;y&#39;)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticRingFunctor">
<em class="property">class </em><code class="descclassname">sage.rings.asymptotic.asymptotic_ring.</code><code class="descname">AsymptoticRingFunctor</code><span class="sig-paren">(</span><em>growth_group</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticRingFunctor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../categories/sage/categories/pushout.html#sage.categories.pushout.ConstructionFunctor" title="(in Sage Reference Manual: Category Framework v7.4)"><code class="xref py py-class docutils literal"><span class="pre">sage.categories.pushout.ConstructionFunctor</span></code></a></p>
<p>A <a class="reference external" href="../../../../categories/sage/categories/pushout.html#sage.categories.pushout.ConstructionFunctor" title="(in Sage Reference Manual: Category Framework v7.4)"><code class="xref py py-class docutils literal"><span class="pre">construction</span> <span class="pre">functor</span></code></a>
for <a class="reference internal" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticRing" title="sage.rings.asymptotic.asymptotic_ring.AsymptoticRing"><code class="xref py py-class docutils literal"><span class="pre">asymptotic</span> <span class="pre">rings</span></code></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">growth_group</span></code> &#8211; a partially ordered group (see
<a class="reference internal" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticRing" title="sage.rings.asymptotic.asymptotic_ring.AsymptoticRing"><code class="xref py py-class docutils literal"><span class="pre">AsymptoticRing</span></code></a> or
<a class="reference internal" href="growth_group.html"><span class="doc">(Asymptotic) Growth Groups</span></a> for details).</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;x^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">construction</span><span class="p">()</span>  <span class="c1"># indirect doctest</span>
<span class="go">(AsymptoticRing&lt;x^ZZ&gt;, Rational Field)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#"><span class="doc">Asymptotic Ring</span></a>,
<a class="reference internal" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticRing" title="sage.rings.asymptotic.asymptotic_ring.AsymptoticRing"><code class="xref py py-class docutils literal"><span class="pre">AsymptoticRing</span></code></a>,
<a class="reference internal" href="growth_group.html#sage.rings.asymptotic.growth_group.AbstractGrowthGroupFunctor" title="sage.rings.asymptotic.growth_group.AbstractGrowthGroupFunctor"><code class="xref py py-class docutils literal"><span class="pre">sage.rings.asymptotic.growth_group.AbstractGrowthGroupFunctor</span></code></a>,
<a class="reference internal" href="growth_group.html#sage.rings.asymptotic.growth_group.ExponentialGrowthGroupFunctor" title="sage.rings.asymptotic.growth_group.ExponentialGrowthGroupFunctor"><code class="xref py py-class docutils literal"><span class="pre">sage.rings.asymptotic.growth_group.ExponentialGrowthGroupFunctor</span></code></a>,
<a class="reference internal" href="growth_group.html#sage.rings.asymptotic.growth_group.MonomialGrowthGroupFunctor" title="sage.rings.asymptotic.growth_group.MonomialGrowthGroupFunctor"><code class="xref py py-class docutils literal"><span class="pre">sage.rings.asymptotic.growth_group.MonomialGrowthGroupFunctor</span></code></a>,
<a class="reference external" href="../../../../categories/sage/categories/pushout.html#sage.categories.pushout.ConstructionFunctor" title="(in Sage Reference Manual: Category Framework v7.4)"><code class="xref py py-class docutils literal"><span class="pre">sage.categories.pushout.ConstructionFunctor</span></code></a>.</p>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;x^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;y^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cm</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">get_coercion_model</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">cm</span><span class="o">.</span><span class="n">record_exceptions</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">cm</span><span class="o">.</span><span class="n">common_parent</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="go">Asymptotic Ring &lt;x^ZZ * y^ZZ&gt; over Rational Field</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">coercion_traceback</span><span class="p">()</span>  <span class="c1"># not tested</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.categories.pushout</span> <span class="kn">import</span> <span class="n">pushout</span>
<span class="gp">sage: </span><span class="n">pushout</span><span class="p">(</span><span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;x^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">ZZ</span><span class="p">),</span> <span class="n">QQ</span><span class="p">)</span>
<span class="go">Asymptotic Ring &lt;x^ZZ&gt; over Rational Field</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.rings.asymptotic.asymptotic_ring.AsymptoticRingFunctor.merge">
<code class="descname">merge</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.AsymptoticRingFunctor.merge" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge this functor with <code class="docutils literal"><span class="pre">other</span></code> if possible.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">other</span></code> &#8211; a functor.</li>
</ul>
<p>OUTPUT:</p>
<p>A functor or <code class="docutils literal"><span class="pre">None</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;x^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="n">growth_group</span><span class="o">=</span><span class="s1">&#39;y^ZZ&#39;</span><span class="p">,</span> <span class="n">coefficient_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">construction</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">F_Y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">construction</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">F_X</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">F_X</span><span class="p">)</span>
<span class="go">AsymptoticRing&lt;x^ZZ&gt;</span>
<span class="gp">sage: </span><span class="n">F_X</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">F_Y</span><span class="p">)</span>
<span class="go">AsymptoticRing&lt;x^ZZ * y^ZZ&gt;</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="sage.rings.asymptotic.asymptotic_ring.NoConvergenceError">
<em class="property">exception </em><code class="descclassname">sage.rings.asymptotic.asymptotic_ring.</code><code class="descname">NoConvergenceError</code><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_ring.NoConvergenceError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/library/exceptions.html#exceptions.RuntimeError" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">exceptions.RuntimeError</span></code></a></p>
<p>A special <a class="reference external" href="https://docs.python.org/release/2.7.10/library/exceptions.html#exceptions.RuntimeError">RuntimeError</a>
which is raised when an algorithm does not converge/stop.</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <h3><a href="../../../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">Asymptotic Ring</a><ul>
<li><a class="reference internal" href="#informal-definition">(Informal) Definition</a><ul>
<li><a class="reference internal" href="#growth-groups-and-elements">Growth Groups and Elements</a></li>
</ul>
</li>
<li><a class="reference internal" href="#introductory-examples">Introductory Examples</a><ul>
<li><a class="reference internal" href="#two-rings">Two Rings</a><ul>
<li><a class="reference internal" href="#a-univariate-asymptotic-ring">A Univariate Asymptotic Ring</a></li>
<li><a class="reference internal" href="#a-multivariate-asymptotic-ring">A Multivariate Asymptotic Ring</a></li>
</ul>
</li>
<li><a class="reference internal" href="#arithmetical-operations">Arithmetical Operations</a><ul>
<li><a class="reference internal" href="#the-ring-operations-plus-and-times">The Ring Operations Plus and Times</a></li>
<li><a class="reference internal" href="#division">Division</a></li>
<li><a class="reference internal" href="#powers-expontials-and-logarithms">Powers, Expontials and Logarithms</a></li>
<li><a class="reference internal" href="#multivariate-arithmetic">Multivariate Arithmetic</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#more-examples">More Examples</a><ul>
<li><a class="reference internal" href="#the-mathematical-constant-e-as-a-limit">The mathematical constant e as a limit</a></li>
</ul>
</li>
<li><a class="reference internal" href="#selected-technical-details">Selected Technical Details</a><ul>
<li><a class="reference internal" href="#coercions-and-functorial-constructions">Coercions and Functorial Constructions</a></li>
<li><a class="reference internal" href="#data-structures">Data Structures</a></li>
</ul>
</li>
<li><a class="reference internal" href="#various">Various</a></li>
<li><a class="reference internal" href="#classes-and-methods">Classes and Methods</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="../../../index.html"
                                  title="previous chapter">Asymptotic Expansions</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="asymptotic_expansion_generators.html"
                                  title="next chapter">Common Asymptotic Expansions</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../_sources/sage/rings/asymptotic/asymptotic_ring.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="asymptotic_expansion_generators.html" title="Common Asymptotic Expansions"
             >next</a> |</li>
        <li class="right" >
          <a href="../../../index.html" title="Asymptotic Expansions"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Asymptotic Expansions</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &copy; Copyright 2005--2016, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.4.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>