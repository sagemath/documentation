
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Pseudo-Riemannian submanifolds &#8212; Sage Reference Manual v9.0: Manifolds</title>
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Utilities for Calculus" href="../utilities.html" />
    <link rel="prev" title="Levi-Civita Connections" href="levi_civita_connection.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../utilities.html" title="Utilities for Calculus"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="levi_civita_connection.html" title="Levi-Civita Connections"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Manifolds</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../../riem_manifold.html" accesskey="U">Pseudo-Riemannian Manifolds</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="pseudo-riemannian-submanifolds">
<span id="sage-manifolds-differentiable-pseudo-riemannian-submanifold"></span><h1>Pseudo-Riemannian submanifolds<a class="headerlink" href="#pseudo-riemannian-submanifolds" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.manifolds.differentiable.pseudo_riemannian_submanifold"></span><p>An <em>embedded (resp. immersed) submanifold of a pseudo-Riemannian manifold</em>
<span class="math notranslate nohighlight">\((M,g)\)</span> is an embedded (resp. immersed) submanifold <span class="math notranslate nohighlight">\(N\)</span> of <span class="math notranslate nohighlight">\(M\)</span> as a
differentiable manifold (see
<a class="reference internal" href="differentiable_submanifold.html#module-sage.manifolds.differentiable.differentiable_submanifold" title="sage.manifolds.differentiable.differentiable_submanifold"><code class="xref py py-mod docutils literal notranslate"><span class="pre">differentiable_submanifold</span></code></a>) such that
pull back of the metric tensor <span class="math notranslate nohighlight">\(g\)</span> via the embedding (resp. immersion) endows
<span class="math notranslate nohighlight">\(N\)</span> with the structure of a pseudo-Riemannian manifold.</p>
<p>The following example shows how to compute the various quantities related
to the intrinsic and extrinsic geometries of a hyperbolic slicing of the
3-dimensional Minkowski space.</p>
<p>We start by declaring the ambient manifold <span class="math notranslate nohighlight">\(M\)</span> and the submanifold <span class="math notranslate nohighlight">\(N\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s2">&quot;Lorentzian&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">ambient</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s2">&quot;Riemannian&quot;</span><span class="p">,</span> <span class="n">start_index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>The considered slices being spacelike hypersurfaces, they are Riemannian
manifolds.</p>
<p>Let us introduce the Minkowskian coordinates <span class="math notranslate nohighlight">\((w,x,y)\)</span> on <span class="math notranslate nohighlight">\(M\)</span> and the polar
coordinates <span class="math notranslate nohighlight">\((\rho, \theta)\)</span> on the submanifold <span class="math notranslate nohighlight">\(N\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.&lt;</span><span class="n">w</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.&lt;</span><span class="n">rh</span><span class="p">,</span><span class="n">th</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;rh:(0,+oo):\rho th:(0,2*pi):\theta&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Let <span class="math notranslate nohighlight">\(b\)</span> be the hyperbola semi-major axis and <span class="math notranslate nohighlight">\(t\)</span> the parameter of the
foliation:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">b</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>One can then define the embedding <span class="math notranslate nohighlight">\(\phi_t\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="p">{(</span><span class="n">C</span><span class="p">,</span><span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="n">b</span><span class="o">*</span><span class="n">cosh</span><span class="p">(</span><span class="n">rh</span><span class="p">)</span><span class="o">+</span><span class="n">t</span><span class="p">,</span>
<span class="gp">....: </span>                             <span class="n">b</span><span class="o">*</span><span class="n">sinh</span><span class="p">(</span><span class="n">rh</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">),</span>
<span class="gp">....: </span>                             <span class="n">b</span><span class="o">*</span><span class="n">sinh</span><span class="p">(</span><span class="n">rh</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">N --&gt; M</span>
<span class="go">   (rh, th) |--&gt; (w, x, y) = (b*cosh(rh) + t, b*cos(th)*sinh(rh),</span>
<span class="go">                              b*sin(th)*sinh(rh))</span>
</pre></div>
</div>
<p>as well as its inverse (when considered as a diffeomorphism onto its image):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi_inv</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="p">{(</span><span class="n">E</span><span class="p">,</span><span class="n">C</span><span class="p">):</span> <span class="p">[</span><span class="n">log</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">b</span><span class="o">+</span>
<span class="gp">....: </span>                                 <span class="n">sqrt</span><span class="p">((</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">b</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
<span class="gp">....: </span>                                 <span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">phi_inv</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">M --&gt; N</span>
<span class="go">   (w, x, y) |--&gt; (rh, th) = (log(sqrt((b^2 + x^2 + y^2)/b^2 - 1)</span>
<span class="go">                              + sqrt(b^2 + x^2 + y^2)/b), arctan2(y, x))</span>
</pre></div>
</div>
<p>and the partial inverse expressing the foliation parameter <span class="math notranslate nohighlight">\(t\)</span> as a scalar
field on <span class="math notranslate nohighlight">\(M\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi_inv_t</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">scalar_field</span><span class="p">({</span><span class="n">E</span><span class="p">:</span> <span class="n">w</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">2</span><span class="p">)})</span>
<span class="gp">sage: </span><span class="n">phi_inv_t</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">M --&gt; R</span>
<span class="go">(w, x, y) |--&gt; w - sqrt(b^2 + x^2 + y^2)</span>
</pre></div>
</div>
<p>One can check that the inverse is correct with:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">phi</span><span class="o">*</span><span class="n">phi_inv</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">M --&gt; M</span>
<span class="go">   (w, x, y) |--&gt; ((b^2 + x^2 + y^2 + sqrt(b^2 + x^2 + y^2)*(t + sqrt(x^2 +</span>
<span class="go"> y^2)) + sqrt(x^2 + y^2)*t)/(sqrt(b^2 + x^2 + y^2) + sqrt(x^2 + y^2)), x, y)</span>
</pre></div>
</div>
<p>The first item of the 3-uple in the right-hand does not appear as <span class="math notranslate nohighlight">\(w\)</span> because
<span class="math notranslate nohighlight">\(t\)</span> has not been replaced by its value provided by <code class="docutils literal notranslate"><span class="pre">phi_inv_t</span></code>. Once this is
done, we do get <span class="math notranslate nohighlight">\(w\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">phi</span><span class="o">*</span><span class="n">phi_inv</span><span class="p">)</span><span class="o">.</span><span class="n">expr</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">t</span><span class="p">:</span> <span class="n">phi_inv_t</span><span class="o">.</span><span class="n">expr</span><span class="p">()})</span><span class="o">.</span><span class="n">simplify_full</span><span class="p">()</span>
<span class="go">w</span>
</pre></div>
</div>
<p>The embedding can then be declared:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">set_embedding</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="n">phi_inv</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="n">t</span><span class="p">,</span>
<span class="gp">....: </span>                <span class="n">t_inverse</span> <span class="o">=</span> <span class="p">{</span><span class="n">t</span><span class="p">:</span> <span class="n">phi_inv_t</span><span class="p">})</span>
</pre></div>
</div>
<p>This line does not perform any calculation yet. It just check the coherence of
the arguments, but not the inverse, the user is trusted on this point.</p>
<p>Finally, we initialize the metric of <span class="math notranslate nohighlight">\(M\)</span> to be that of Minkowski space:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">metric</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">g</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">g = -dw*dw + dx*dx + dy*dy</span>
</pre></div>
</div>
<p>With this, the declaration the ambient manifold and its foliation parametrized
by <span class="math notranslate nohighlight">\(t\)</span> is finished, and calculations can be performed.</p>
<p>The first step is always to find a chart adapted to the foliation. This is done
by the method “adapted_chart”:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">adapted_chart</span><span class="p">();</span> <span class="n">T</span>
<span class="go">[Chart (M, (rh_M, th_M, t_M))]</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">T</span></code> contains a new chart defined on <span class="math notranslate nohighlight">\(M\)</span>. By default, the coordinate names
are constructed from the names of the submanifold coordinates and the foliation
parameter indexed by the name of the ambient manifold. By this can be
customized, see
<a class="reference internal" href="../topological_submanifold.html#sage.manifolds.topological_submanifold.TopologicalSubmanifold.adapted_chart" title="sage.manifolds.topological_submanifold.TopologicalSubmanifold.adapted_chart"><code class="xref py py-meth docutils literal notranslate"><span class="pre">adapted_chart()</span></code></a>.</p>
<p>One can check that the adapted chart has been added to <span class="math notranslate nohighlight">\(M\)</span>’s atlas, along with
some coordinates changes:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">atlas</span><span class="p">()</span>
<span class="go">[Chart (M, (w, x, y)), Chart (M, (rh_M, th_M, t_M))]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">coord_changes</span><span class="p">())</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Let us compute the induced metric (or first fundamental form):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">gamma</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">induced_metric</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">gamma</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">gamma = b^2 drh*drh + b^2*sinh(rh)^2 dth*dth</span>
<span class="gp">sage: </span><span class="n">gamma</span><span class="p">[:]</span>  <span class="c1"># long time</span>
<span class="go">[           b^2              0]</span>
<span class="go">[             0 b^2*sinh(rh)^2]</span>
<span class="gp">sage: </span><span class="n">gamma</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># long time</span>
<span class="go">b^2</span>
</pre></div>
</div>
<p>the normal vector:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">normal</span><span class="p">()</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">n = sqrt(b^2 + x^2 + y^2)/b d/dw + x/b d/dx + y/b d/dy</span>
</pre></div>
</div>
<p>Check that the hypersurface is indeed spacelike, i.e. that its normal is
timelike:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">ambient_metric</span><span class="p">()(</span><span class="n">N</span><span class="o">.</span><span class="n">normal</span><span class="p">(),</span> <span class="n">N</span><span class="o">.</span><span class="n">normal</span><span class="p">())</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">g(n,n): M --&gt; R</span>
<span class="go">   (w, x, y) |--&gt; -1</span>
<span class="go">   (rh_M, th_M, t_M) |--&gt; -1</span>
</pre></div>
</div>
<p>The lapse function is:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">lapse</span><span class="p">()</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">N: M --&gt; R</span>
<span class="go">   (w, x, y) |--&gt; sqrt(b^2 + x^2 + y^2)/b</span>
<span class="go">   (rh_M, th_M, t_M) |--&gt; cosh(rh_M)</span>
</pre></div>
</div>
<p>while the shift vector is:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">shift</span><span class="p">()</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">beta = -(x^2 + y^2)/b^2 d/dw - sqrt(b^2 + x^2 + y^2)*x/b^2 d/dx</span>
<span class="go"> - sqrt(b^2 + x^2 + y^2)*y/b^2 d/dy</span>
</pre></div>
</div>
<p>The extrinsic curvature (or second fundamental form) as a tensor field on the
ambient manifold:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">ambient_extrinsic_curvature</span><span class="p">()[:]</span> <span class="c1"># long time</span>
<span class="go">[                                 -(x^2 + y^2)/b^3 (b^2*x + x^3 + x*y^2)/(sqrt(b^2 + x^2 + y^2)*b^3) (y^3 + (b^2 + x^2)*y)/(sqrt(b^2 + x^2 + y^2)*b^3)]</span>
<span class="go">[                      sqrt(b^2 + x^2 + y^2)*x/b^3                                  -(b^2 + x^2)/b^3                                          -x*y/b^3]</span>
<span class="go">[                      sqrt(b^2 + x^2 + y^2)*y/b^3                                          -x*y/b^3                                  -(b^2 + y^2)/b^3]</span>
</pre></div>
</div>
<p>The extrinsic curvature as a tensor field on the submanifold:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">extrinsic_curvature</span><span class="p">()[:]</span> <span class="c1"># long time</span>
<span class="go">[           -b             0]</span>
<span class="go">[            0 -b*sinh(rh)^2]</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Florentin Jaffredo (2018): initial version</li>
</ul>
<p>REFERENCES:</p>
<ul class="simple">
<li>B. O’Neill : <em>Semi-Riemannian Geometry</em> <a class="reference internal" href="../../../../references/index.html#one1983" id="id1">[ONe1983]</a></li>
<li>J. M. Lee : <em>Riemannian Manifolds</em> <a class="reference internal" href="../../../../references/index.html#lee1997" id="id2">[Lee1997]</a></li>
</ul>
<dl class="class">
<dt id="sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold">
<em class="property">class </em><code class="descclassname">sage.manifolds.differentiable.pseudo_riemannian_submanifold.</code><code class="descname">PseudoRiemannianSubmanifold</code><span class="sig-paren">(</span><em>n</em>, <em>name</em>, <em>ambient=None</em>, <em>metric_name='g'</em>, <em>signature=None</em>, <em>base_manifold=None</em>, <em>diff_degree=+Infinity</em>, <em>latex_name=None</em>, <em>metric_latex_name=None</em>, <em>start_index=0</em>, <em>category=None</em>, <em>unique_tag=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="pseudo_riemannian.html#sage.manifolds.differentiable.pseudo_riemannian.PseudoRiemannianManifold" title="sage.manifolds.differentiable.pseudo_riemannian.PseudoRiemannianManifold"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.manifolds.differentiable.pseudo_riemannian.PseudoRiemannianManifold</span></code></a>, <a class="reference internal" href="differentiable_submanifold.html#sage.manifolds.differentiable.differentiable_submanifold.DifferentiableSubmanifold" title="sage.manifolds.differentiable.differentiable_submanifold.DifferentiableSubmanifold"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.manifolds.differentiable.differentiable_submanifold.DifferentiableSubmanifold</span></code></a></p>
<p>Pseudo-Riemannian submanifold.</p>
<p>An <em>embedded (resp. immersed) submanifold of a pseudo-Riemannian manifold</em>
<span class="math notranslate nohighlight">\((M,g)\)</span> is an embedded (resp. immersed) submanifold <span class="math notranslate nohighlight">\(N\)</span> of <span class="math notranslate nohighlight">\(M\)</span> as a
differentiable manifold such that pull back of the metric tensor <span class="math notranslate nohighlight">\(g\)</span> via
the embedding (resp. immersion) endows <span class="math notranslate nohighlight">\(N\)</span> with the structure of a
pseudo-Riemannian manifold.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">n</span></code> – positive integer; dimension of the submanifold</li>
<li><code class="docutils literal notranslate"><span class="pre">name</span></code> – string; name (symbol) given to the submanifold</li>
<li><code class="docutils literal notranslate"><span class="pre">ambient</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) pseudo-Riemannian manifold <span class="math notranslate nohighlight">\(M\)</span> in
which the submanifold is embedded (or immersed). If <code class="docutils literal notranslate"><span class="pre">None</span></code>, it is set
to <code class="docutils literal notranslate"><span class="pre">self</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">metric_name</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">'g'</span></code>) string; name (symbol) given to the
submanifold’s metric</li>
<li><code class="docutils literal notranslate"><span class="pre">signature</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) signature <span class="math notranslate nohighlight">\(S\)</span> of the metric as a
single integer: <span class="math notranslate nohighlight">\(S = n_+ - n_-\)</span>, where <span class="math notranslate nohighlight">\(n_+\)</span> (resp. <span class="math notranslate nohighlight">\(n_-\)</span>) is the
number of positive terms (resp. number of negative terms) in any
diagonal writing of the metric components; if <code class="docutils literal notranslate"><span class="pre">signature</span></code> is not
provided, <span class="math notranslate nohighlight">\(S\)</span> is set to the submanifold’s dimension (Riemannian
signature)</li>
<li><code class="docutils literal notranslate"><span class="pre">base_manifold</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) if not <code class="docutils literal notranslate"><span class="pre">None</span></code>, must be a
differentiable manifold; the created object is then an open subset of
<code class="docutils literal notranslate"><span class="pre">base_manifold</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">diff_degree</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">infinity</span></code>) degree of differentiability</li>
<li><code class="docutils literal notranslate"><span class="pre">latex_name</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) string; LaTeX symbol to
denote the submanifold; if none is provided, it is set to <code class="docutils literal notranslate"><span class="pre">name</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">metric_latex_name</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) string; LaTeX symbol to
denote the metric; if none is provided, it is set to <code class="docutils literal notranslate"><span class="pre">metric_name</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">start_index</span></code> – (default: 0) integer; lower value of the range of
indices used for “indexed objects” on the submanifold, e.g. coordinates
in a chart</li>
<li><code class="docutils literal notranslate"><span class="pre">category</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) to specify the category; if <code class="docutils literal notranslate"><span class="pre">None</span></code>,
<code class="docutils literal notranslate"><span class="pre">Manifolds(RR).Differentiable()</span></code> (or <code class="docutils literal notranslate"><span class="pre">Manifolds(RR).Smooth()</span></code>
if <code class="docutils literal notranslate"><span class="pre">diff_degree</span></code> = <code class="docutils literal notranslate"><span class="pre">infinity</span></code>) is assumed (see the category
<a class="reference external" href="../../../../categories/sage/categories/manifolds.html#sage.categories.manifolds.Manifolds" title="(in Sage Reference Manual: Category Framework v9.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Manifolds</span></code></a>)</li>
<li><code class="docutils literal notranslate"><span class="pre">unique_tag</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) tag used to force the construction
of a new object when all the other arguments have been used previously
(without <code class="docutils literal notranslate"><span class="pre">unique_tag</span></code>, the
<a class="reference external" href="../../../../structure/sage/structure/unique_representation.html#sage.structure.unique_representation.UniqueRepresentation" title="(in Sage Reference Manual: Parents and Elements v9.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniqueRepresentation</span></code></a>
behavior inherited from
<a class="reference internal" href="../subset.html#sage.manifolds.subset.ManifoldSubset" title="sage.manifolds.subset.ManifoldSubset"><code class="xref py py-class docutils literal notranslate"><span class="pre">ManifoldSubset</span></code></a>, via
<a class="reference internal" href="manifold.html#sage.manifolds.differentiable.manifold.DifferentiableManifold" title="sage.manifolds.differentiable.manifold.DifferentiableManifold"><code class="xref py py-class docutils literal notranslate"><span class="pre">DifferentiableManifold</span></code></a>
and <a class="reference internal" href="../manifold.html#sage.manifolds.manifold.TopologicalManifold" title="sage.manifolds.manifold.TopologicalManifold"><code class="xref py py-class docutils literal notranslate"><span class="pre">TopologicalManifold</span></code></a>,
would return the previously constructed object corresponding to these
arguments).</li>
</ul>
<p>EXAMPLES:</p>
<p>Let <span class="math notranslate nohighlight">\(N\)</span> be a 2-dimensional submanifold of a 3-dimensional Riemannian
manifold <span class="math notranslate nohighlight">\(M\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span> <span class="o">=</span><span class="s2">&quot;Riemannian&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">ambient</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s2">&quot;Riemannian&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span>
<span class="go">2-dimensional Riemannian submanifold N immersed in the 3-dimensional</span>
<span class="go"> Riemannian manifold M</span>
<span class="gp">sage: </span><span class="n">CM</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">CN</span><span class="o">.&lt;</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
</pre></div>
</div>
<p>Let us define a 1-dimension foliation indexed by <span class="math notranslate nohighlight">\(t\)</span>. The inverse map is
needed in order to compute the adapted chart in the ambient manifold:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="p">{(</span><span class="n">CN</span><span class="p">,</span><span class="n">CM</span><span class="p">):[</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">t</span><span class="o">+</span><span class="n">u</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">v</span><span class="o">^</span><span class="mi">2</span><span class="p">]});</span> <span class="n">phi</span>
<span class="go">Differentiable map from the 2-dimensional Riemannian submanifold N</span>
<span class="go"> immersed in the 3-dimensional Riemannian manifold M to the</span>
<span class="go"> 3-dimensional Riemannian manifold M</span>
<span class="gp">sage: </span><span class="n">phi_inv</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">N</span><span class="p">,{(</span><span class="n">CM</span><span class="p">,</span> <span class="n">CN</span><span class="p">):</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">phi_inv_t</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">scalar_field</span><span class="p">({</span><span class="n">CM</span><span class="p">:</span> <span class="n">z</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">})</span>
</pre></div>
</div>
<p><span class="math notranslate nohighlight">\(\phi\)</span> can then be declared as an embedding <span class="math notranslate nohighlight">\(N\to M\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">set_embedding</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="n">phi_inv</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="n">t</span><span class="p">,</span>
<span class="gp">....: </span>                <span class="n">t_inverse</span><span class="o">=</span><span class="p">{</span><span class="n">t</span><span class="p">:</span> <span class="n">phi_inv_t</span><span class="p">})</span>
</pre></div>
</div>
<p>The foliation can also be used to find new charts on the ambient manifold
that are adapted to the foliation, ie in which the expression of the
immersion is trivial. At the same time, the appropriate coordinate changes
are computed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">adapted_chart</span><span class="p">()</span>
<span class="go">[Chart (M, (u_M, v_M, t_M))]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">coord_changes</span><span class="p">())</span>
<span class="go">2</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../manifold.html#module-sage.manifolds.manifold" title="sage.manifolds.manifold"><code class="xref py py-mod docutils literal notranslate"><span class="pre">manifold</span></code></a> and
<a class="reference internal" href="differentiable_submanifold.html#module-sage.manifolds.differentiable.differentiable_submanifold" title="sage.manifolds.differentiable.differentiable_submanifold"><code class="xref py py-mod docutils literal notranslate"><span class="pre">differentiable_submanifold</span></code></a></p>
</div>
<dl class="method">
<dt id="sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.ambient_extrinsic_curvature">
<code class="descname">ambient_extrinsic_curvature</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.ambient_extrinsic_curvature" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the second fundamental form of the submanifold as a tensor field
on the ambient manifold.</p>
<p>The result is cached, so calling this method multiple times always
returns the same result at no additional cost.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>(0,2) tensor field on the ambient manifold equal to the second
fundamental form once orthogonally projected onto the submanifold</li>
</ul>
<p>EXAMPLES:</p>
<p>A unit circle embedded in the Euclidean plane:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">EuclideanSpace</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">ambient</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s2">&quot;Riemannian&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">U</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">open_subset</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">open_subset</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">declare_union</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">stereoN</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">stereoS</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">stereoN_to_S</span> <span class="o">=</span> <span class="n">stereoN</span><span class="o">.</span><span class="n">transition_map</span><span class="p">(</span><span class="n">stereoS</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="n">x</span><span class="p">),</span>
<span class="gp">....: </span>                  <span class="n">intersection_name</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">,</span>
<span class="gp">....: </span>                  <span class="n">restrictions1</span><span class="o">=</span><span class="n">x</span><span class="o">!=</span><span class="mi">0</span><span class="p">,</span> <span class="n">restrictions2</span><span class="o">=</span><span class="n">y</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">stereoS_to_N</span> <span class="o">=</span> <span class="n">stereoN_to_S</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">cartesian_coordinates</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">M</span><span class="p">,</span>
<span class="gp">....: </span>        <span class="p">{(</span><span class="n">stereoN</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="n">x</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="p">)],</span>
<span class="gp">....: </span>         <span class="p">(</span><span class="n">stereoS</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">4</span><span class="o">/</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="o">/</span><span class="n">y</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">4</span><span class="o">/</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">set_embedding</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">ambient_second_fundamental_form</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">Field of symmetric bilinear forms K along the 1-dimensional</span>
<span class="go"> Riemannian submanifold N embedded in the Euclidean plane E^2 with</span>
<span class="go"> values on the Euclidean plane E^2</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">ambient_second_fundamental_form</span><span class="p">()[:]</span> <span class="c1"># long time</span>
<span class="go">[-x^2/(x^2 + 4)  2*x/(x^2 + 4)]</span>
<span class="go">[ 2*x/(x^2 + 4)   -4/(x^2 + 4)]</span>
</pre></div>
</div>
<p>An alias is <code class="docutils literal notranslate"><span class="pre">ambient_extrinsic_curvature</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">ambient_extrinsic_curvature</span><span class="p">()[:]</span>  <span class="c1"># long time</span>
<span class="go">[-x^2/(x^2 + 4)  2*x/(x^2 + 4)]</span>
<span class="go">[ 2*x/(x^2 + 4)   -4/(x^2 + 4)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.ambient_first_fundamental_form">
<code class="descname">ambient_first_fundamental_form</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.ambient_first_fundamental_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the first fundamental form of the submanifold as a tensor of the
ambient manifold.</p>
<p>The result is cached, so calling this method multiple times always
returns the same result at no additional cost.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>(0,2) tensor field on the ambient manifold describing the induced
metric before projection on the submanifold</li>
</ul>
<p>EXAMPLES:</p>
<p>A unit circle embedded in the Euclidean plane:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">EuclideanSpace</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">ambient</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s2">&quot;Riemannian&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">U</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">open_subset</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">open_subset</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">declare_union</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">stereoN</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">stereoS</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">stereoN_to_S</span> <span class="o">=</span> <span class="n">stereoN</span><span class="o">.</span><span class="n">transition_map</span><span class="p">(</span><span class="n">stereoS</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="n">x</span><span class="p">),</span>
<span class="gp">....: </span>                  <span class="n">intersection_name</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">,</span>
<span class="gp">....: </span>                  <span class="n">restrictions1</span><span class="o">=</span><span class="n">x</span><span class="o">!=</span><span class="mi">0</span><span class="p">,</span> <span class="n">restrictions2</span><span class="o">=</span><span class="n">y</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">stereoS_to_N</span> <span class="o">=</span> <span class="n">stereoN_to_S</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">cartesian_coordinates</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">M</span><span class="p">,</span>
<span class="gp">....: </span>        <span class="p">{(</span><span class="n">stereoN</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="n">x</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="p">)],</span>
<span class="gp">....: </span>         <span class="p">(</span><span class="n">stereoS</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">4</span><span class="o">/</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="o">/</span><span class="n">y</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">4</span><span class="o">/</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">set_embedding</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">ambient_first_fundamental_form</span><span class="p">()</span>
<span class="go">Tensor field gamma of type (0,2) along the 1-dimensional Riemannian</span>
<span class="go"> submanifold N embedded in the Euclidean plane E^2 with values on</span>
<span class="go"> the Euclidean plane E^2</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">ambient_first_fundamental_form</span><span class="p">()[:]</span>
<span class="go">[ x^2/(x^2 + 4) -2*x/(x^2 + 4)]</span>
<span class="go">[-2*x/(x^2 + 4)    4/(x^2 + 4)]</span>
</pre></div>
</div>
<p>An alias is <code class="docutils literal notranslate"><span class="pre">ambient_induced_metric</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">ambient_induced_metric</span><span class="p">()[:]</span>
<span class="go">[ x^2/(x^2 + 4) -2*x/(x^2 + 4)]</span>
<span class="go">[-2*x/(x^2 + 4)    4/(x^2 + 4)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.ambient_induced_metric">
<code class="descname">ambient_induced_metric</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.ambient_induced_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the first fundamental form of the submanifold as a tensor of the
ambient manifold.</p>
<p>The result is cached, so calling this method multiple times always
returns the same result at no additional cost.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>(0,2) tensor field on the ambient manifold describing the induced
metric before projection on the submanifold</li>
</ul>
<p>EXAMPLES:</p>
<p>A unit circle embedded in the Euclidean plane:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">EuclideanSpace</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">ambient</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s2">&quot;Riemannian&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">U</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">open_subset</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">open_subset</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">declare_union</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">stereoN</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">stereoS</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">stereoN_to_S</span> <span class="o">=</span> <span class="n">stereoN</span><span class="o">.</span><span class="n">transition_map</span><span class="p">(</span><span class="n">stereoS</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="n">x</span><span class="p">),</span>
<span class="gp">....: </span>                  <span class="n">intersection_name</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">,</span>
<span class="gp">....: </span>                  <span class="n">restrictions1</span><span class="o">=</span><span class="n">x</span><span class="o">!=</span><span class="mi">0</span><span class="p">,</span> <span class="n">restrictions2</span><span class="o">=</span><span class="n">y</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">stereoS_to_N</span> <span class="o">=</span> <span class="n">stereoN_to_S</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">cartesian_coordinates</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">M</span><span class="p">,</span>
<span class="gp">....: </span>        <span class="p">{(</span><span class="n">stereoN</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="n">x</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="p">)],</span>
<span class="gp">....: </span>         <span class="p">(</span><span class="n">stereoS</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">4</span><span class="o">/</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="o">/</span><span class="n">y</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">4</span><span class="o">/</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">set_embedding</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">ambient_first_fundamental_form</span><span class="p">()</span>
<span class="go">Tensor field gamma of type (0,2) along the 1-dimensional Riemannian</span>
<span class="go"> submanifold N embedded in the Euclidean plane E^2 with values on</span>
<span class="go"> the Euclidean plane E^2</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">ambient_first_fundamental_form</span><span class="p">()[:]</span>
<span class="go">[ x^2/(x^2 + 4) -2*x/(x^2 + 4)]</span>
<span class="go">[-2*x/(x^2 + 4)    4/(x^2 + 4)]</span>
</pre></div>
</div>
<p>An alias is <code class="docutils literal notranslate"><span class="pre">ambient_induced_metric</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">ambient_induced_metric</span><span class="p">()[:]</span>
<span class="go">[ x^2/(x^2 + 4) -2*x/(x^2 + 4)]</span>
<span class="go">[-2*x/(x^2 + 4)    4/(x^2 + 4)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.ambient_metric">
<code class="descname">ambient_metric</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.ambient_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the metric of the ambient manifold.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>the metric of the ambient manifold</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">EuclideanSpace</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">ambient</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s2">&quot;Riemannian&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">ambient_metric</span><span class="p">()</span>
<span class="go">Riemannian metric g on the Euclidean space E^3</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">ambient_metric</span><span class="p">()</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">g = dx*dx + dy*dy + dz*dz</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">ambient_metric</span><span class="p">()</span> <span class="ow">is</span> <span class="n">M</span><span class="o">.</span><span class="n">metric</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.ambient_second_fundamental_form">
<code class="descname">ambient_second_fundamental_form</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.ambient_second_fundamental_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the second fundamental form of the submanifold as a tensor field
on the ambient manifold.</p>
<p>The result is cached, so calling this method multiple times always
returns the same result at no additional cost.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>(0,2) tensor field on the ambient manifold equal to the second
fundamental form once orthogonally projected onto the submanifold</li>
</ul>
<p>EXAMPLES:</p>
<p>A unit circle embedded in the Euclidean plane:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">EuclideanSpace</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">ambient</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s2">&quot;Riemannian&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">U</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">open_subset</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">open_subset</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">declare_union</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">stereoN</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">stereoS</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">stereoN_to_S</span> <span class="o">=</span> <span class="n">stereoN</span><span class="o">.</span><span class="n">transition_map</span><span class="p">(</span><span class="n">stereoS</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="n">x</span><span class="p">),</span>
<span class="gp">....: </span>                  <span class="n">intersection_name</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">,</span>
<span class="gp">....: </span>                  <span class="n">restrictions1</span><span class="o">=</span><span class="n">x</span><span class="o">!=</span><span class="mi">0</span><span class="p">,</span> <span class="n">restrictions2</span><span class="o">=</span><span class="n">y</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">stereoS_to_N</span> <span class="o">=</span> <span class="n">stereoN_to_S</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">cartesian_coordinates</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">M</span><span class="p">,</span>
<span class="gp">....: </span>        <span class="p">{(</span><span class="n">stereoN</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="n">x</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="p">)],</span>
<span class="gp">....: </span>         <span class="p">(</span><span class="n">stereoS</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">4</span><span class="o">/</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="o">/</span><span class="n">y</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">4</span><span class="o">/</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">set_embedding</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">ambient_second_fundamental_form</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">Field of symmetric bilinear forms K along the 1-dimensional</span>
<span class="go"> Riemannian submanifold N embedded in the Euclidean plane E^2 with</span>
<span class="go"> values on the Euclidean plane E^2</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">ambient_second_fundamental_form</span><span class="p">()[:]</span> <span class="c1"># long time</span>
<span class="go">[-x^2/(x^2 + 4)  2*x/(x^2 + 4)]</span>
<span class="go">[ 2*x/(x^2 + 4)   -4/(x^2 + 4)]</span>
</pre></div>
</div>
<p>An alias is <code class="docutils literal notranslate"><span class="pre">ambient_extrinsic_curvature</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">ambient_extrinsic_curvature</span><span class="p">()[:]</span>  <span class="c1"># long time</span>
<span class="go">[-x^2/(x^2 + 4)  2*x/(x^2 + 4)]</span>
<span class="go">[ 2*x/(x^2 + 4)   -4/(x^2 + 4)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.clear_cache">
<code class="descname">clear_cache</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.clear_cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset all the cached functions and the derived quantities.</p>
<p>Use this function if you modified the immersion (or embedding) of the
submanifold. Note that when calling a calculus function after clearing,
new Python objects will be created.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">EuclideanSpace</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">ambient</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s2">&quot;Riemannian&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.&lt;</span><span class="n">th</span><span class="p">,</span><span class="n">ph</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;th:(0,pi):\theta ph:(-pi,pi):\phi&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span> <span class="c1"># foliation parameter</span>
<span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">r</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">cartesian_coordinates</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="p">{(</span><span class="n">C</span><span class="p">,</span><span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span>
<span class="gp">....: </span>                             <span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span>
<span class="gp">....: </span>                             <span class="n">r</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">phi_inv</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="p">{(</span><span class="n">E</span><span class="p">,</span><span class="n">C</span><span class="p">):</span> <span class="p">[</span><span class="n">arccos</span><span class="p">(</span><span class="n">z</span><span class="o">/</span><span class="n">r</span><span class="p">),</span> <span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">phi_inv_r</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">scalar_field</span><span class="p">({</span><span class="n">E</span><span class="p">:</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">)})</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">set_embedding</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="n">phi_inv</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="n">r</span><span class="p">,</span>
<span class="gp">....: </span>                <span class="n">t_inverse</span><span class="o">=</span><span class="p">{</span><span class="n">r</span><span class="p">:</span> <span class="n">phi_inv_r</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">adapted_chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">normal</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="ow">is</span> <span class="n">N</span><span class="o">.</span><span class="n">normal</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">clear_cache</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="ow">is</span> <span class="n">N</span><span class="o">.</span><span class="n">normal</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">==</span> <span class="n">N</span><span class="o">.</span><span class="n">normal</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.difft">
<code class="descname">difft</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.difft" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the differential of the scalar field on the ambient manifold
representing the first parameter of the foliation associated to
<code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>The result is cached, so calling this method multiple times always
returns the same result at no additional cost.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>1-form field on the ambient manifold</li>
</ul>
<p>EXAMPLES:</p>
<p>Foliation of the Euclidean 3-space by 2-spheres parametrized by their
radii:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">EuclideanSpace</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">ambient</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s2">&quot;Riemannian&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.&lt;</span><span class="n">th</span><span class="p">,</span><span class="n">ph</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;th:(0,pi):\theta ph:(-pi,pi):\phi&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">r</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">cartesian_coordinates</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="p">{(</span><span class="n">C</span><span class="p">,</span><span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span>
<span class="gp">....: </span>                             <span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span>
<span class="gp">....: </span>                             <span class="n">r</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">phi_inv</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="p">{(</span><span class="n">E</span><span class="p">,</span><span class="n">C</span><span class="p">):</span> <span class="p">[</span><span class="n">arccos</span><span class="p">(</span><span class="n">z</span><span class="o">/</span><span class="n">r</span><span class="p">),</span> <span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">phi_inv_r</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">scalar_field</span><span class="p">({</span><span class="n">E</span><span class="p">:</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">)})</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">set_embedding</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="n">phi_inv</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="n">r</span><span class="p">,</span>
<span class="gp">....: </span>                <span class="n">t_inverse</span><span class="o">=</span><span class="p">{</span><span class="n">r</span><span class="p">:</span> <span class="n">phi_inv_r</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">difft</span><span class="p">()</span>
<span class="go">1-form dr on the Euclidean space E^3</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">difft</span><span class="p">()</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">dr = x/sqrt(x^2 + y^2 + z^2) dx + y/sqrt(x^2 + y^2 + z^2) dy +</span>
<span class="go"> z/sqrt(x^2 + y^2 + z^2) dz</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.extrinsic_curvature">
<code class="descname">extrinsic_curvature</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.extrinsic_curvature" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the second fundamental form of the submanifold.</p>
<p>The result is cached, so calling this method multiple times always
returns the same result at no additional cost.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>the second fundamental form, as a symmetric tensor field of type
(0,2) on the submanifold</li>
</ul>
<p>EXAMPLES:</p>
<p>A unit circle embedded in the Euclidean plane:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">EuclideanSpace</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">ambient</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s2">&quot;Riemannian&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">U</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">open_subset</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">open_subset</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">declare_union</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">stereoN</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">stereoS</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">stereoN_to_S</span> <span class="o">=</span> <span class="n">stereoN</span><span class="o">.</span><span class="n">transition_map</span><span class="p">(</span><span class="n">stereoS</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="n">x</span><span class="p">),</span>
<span class="gp">....: </span>                  <span class="n">intersection_name</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">,</span>
<span class="gp">....: </span>                  <span class="n">restrictions1</span><span class="o">=</span><span class="n">x</span><span class="o">!=</span><span class="mi">0</span><span class="p">,</span> <span class="n">restrictions2</span><span class="o">=</span><span class="n">y</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">stereoS_to_N</span> <span class="o">=</span> <span class="n">stereoN_to_S</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">cartesian_coordinates</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">M</span><span class="p">,</span>
<span class="gp">....: </span>        <span class="p">{(</span><span class="n">stereoN</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="n">x</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="p">)],</span>
<span class="gp">....: </span>         <span class="p">(</span><span class="n">stereoS</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">4</span><span class="o">/</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="o">/</span><span class="n">y</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">4</span><span class="o">/</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">set_embedding</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">second_fundamental_form</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">Field of symmetric bilinear forms K on the 1-dimensional Riemannian</span>
<span class="go"> submanifold N embedded in the Euclidean plane E^2</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">second_fundamental_form</span><span class="p">()</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">K = -4/(x^4 + 8*x^2 + 16) dx*dx</span>
</pre></div>
</div>
<p>An alias is <code class="docutils literal notranslate"><span class="pre">extrinsic_curvature</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">extrinsic_curvature</span><span class="p">()</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">K = -4/(x^4 + 8*x^2 + 16) dx*dx</span>
</pre></div>
</div>
<p>An example with a non-Euclidean ambient metric:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;Riemannian&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">ambient</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;Riemannian&#39;</span><span class="p">,</span>
<span class="gp">....: </span>             <span class="n">start_index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">CM</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">CN</span><span class="o">.&lt;</span><span class="n">u</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">metric</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">u</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">set_embedding</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">second_fundamental_form</span><span class="p">()</span>
<span class="go">Field of symmetric bilinear forms K on the 1-dimensional Riemannian</span>
<span class="go"> submanifold N embedded in the 2-dimensional Riemannian manifold M</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">second_fundamental_form</span><span class="p">()</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">K = 2*sqrt(u^4 + 2*u^2 + 2)*u/(u^6 + 3*u^4 + 4*u^2 + 2) du*du</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.first_fundamental_form">
<code class="descname">first_fundamental_form</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.first_fundamental_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the first fundamental form of the submanifold.</p>
<p>The result is cached, so calling this method multiple times always
returns the same result at no additional cost.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>the first fundamental form, as an instance of
<a class="reference internal" href="metric.html#sage.manifolds.differentiable.metric.PseudoRiemannianMetric" title="sage.manifolds.differentiable.metric.PseudoRiemannianMetric"><code class="xref py py-class docutils literal notranslate"><span class="pre">PseudoRiemannianMetric</span></code></a></li>
</ul>
<p>EXAMPLES:</p>
<p>A sphere embedded in Euclidean space:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">EuclideanSpace</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">ambient</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s2">&quot;Riemannian&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.&lt;</span><span class="n">th</span><span class="p">,</span><span class="n">ph</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;th:(0,pi):\theta ph:(-pi,pi):\phi&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">r</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">cartesian_coordinates</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="p">{(</span><span class="n">C</span><span class="p">,</span><span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span>
<span class="gp">....: </span>                             <span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span>
<span class="gp">....: </span>                             <span class="n">r</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">set_embedding</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">first_fundamental_form</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">Riemannian metric gamma on the 2-dimensional Riemannian</span>
<span class="go"> submanifold N embedded in the Euclidean space E^3</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">first_fundamental_form</span><span class="p">()[:]</span>  <span class="c1"># long time</span>
<span class="go">[          r^2             0]</span>
<span class="go">[            0 r^2*sin(th)^2]</span>
</pre></div>
</div>
<p>An alias is <code class="docutils literal notranslate"><span class="pre">induced_metric</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">induced_metric</span><span class="p">()[:]</span>  <span class="c1"># long time</span>
<span class="go">[          r^2             0]</span>
<span class="go">[            0 r^2*sin(th)^2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.gauss_curvature">
<code class="descname">gauss_curvature</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.gauss_curvature" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Gauss curvature of the submanifold.</p>
<p>The <em>Gauss curvature</em> is the product or the principal curvatures, or
equivalently the determinant of the projection operator.</p>
<p>The result is cached, so calling this method multiple times always
returns the same result at no additional cost.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>the Gauss curvature as a scalar field on the submanifold</li>
</ul>
<p>EXAMPLES:</p>
<p>A unit circle embedded in the Euclidean plane:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">EuclideanSpace</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">ambient</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s2">&quot;Riemannian&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">U</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">open_subset</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">open_subset</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">declare_union</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">stereoN</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">stereoS</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">stereoN_to_S</span> <span class="o">=</span> <span class="n">stereoN</span><span class="o">.</span><span class="n">transition_map</span><span class="p">(</span><span class="n">stereoS</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="n">x</span><span class="p">),</span>
<span class="gp">....: </span>                  <span class="n">intersection_name</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">,</span>
<span class="gp">....: </span>                  <span class="n">restrictions1</span><span class="o">=</span><span class="n">x</span><span class="o">!=</span><span class="mi">0</span><span class="p">,</span> <span class="n">restrictions2</span><span class="o">=</span><span class="n">y</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">stereoS_to_N</span> <span class="o">=</span> <span class="n">stereoN_to_S</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">cartesian_coordinates</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">M</span><span class="p">,</span>
<span class="gp">....: </span>        <span class="p">{(</span><span class="n">stereoN</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="n">x</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="p">)],</span>
<span class="gp">....: </span>         <span class="p">(</span><span class="n">stereoS</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">4</span><span class="o">/</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="o">/</span><span class="n">y</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">4</span><span class="o">/</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">set_embedding</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">gauss_curvature</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">Scalar field on the 1-dimensional Riemannian submanifold N embedded</span>
<span class="go"> in the Euclidean plane E^2</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">gauss_curvature</span><span class="p">()</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">N --&gt; R</span>
<span class="go">on U: x |--&gt; -1</span>
<span class="go">on V: y |--&gt; -1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.gradt">
<code class="descname">gradt</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.gradt" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the gradient of the scalar field on the ambient manifold
representing the first parameter of the foliation associated to
<code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>The result is cached, so calling this method multiple times always
returns the same result at no additional cost.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>vector field on the ambient manifold</li>
</ul>
<p>EXAMPLES:</p>
<p>Foliation of the Euclidean 3-space by 2-spheres parametrized by their
radii:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">EuclideanSpace</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">ambient</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s2">&quot;Riemannian&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.&lt;</span><span class="n">th</span><span class="p">,</span><span class="n">ph</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;th:(0,pi):\theta ph:(-pi,pi):\phi&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">r</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">cartesian_coordinates</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="p">{(</span><span class="n">C</span><span class="p">,</span><span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span>
<span class="gp">....: </span>                             <span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span>
<span class="gp">....: </span>                             <span class="n">r</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">phi_inv</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="p">{(</span><span class="n">E</span><span class="p">,</span><span class="n">C</span><span class="p">):</span> <span class="p">[</span><span class="n">arccos</span><span class="p">(</span><span class="n">z</span><span class="o">/</span><span class="n">r</span><span class="p">),</span> <span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">phi_inv_r</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">scalar_field</span><span class="p">({</span><span class="n">E</span><span class="p">:</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">)})</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">set_embedding</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="n">phi_inv</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="n">r</span><span class="p">,</span>
<span class="gp">....: </span>                <span class="n">t_inverse</span><span class="o">=</span><span class="p">{</span><span class="n">r</span><span class="p">:</span> <span class="n">phi_inv_r</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">gradt</span><span class="p">()</span>
<span class="go">Vector field grad(r) on the Euclidean space E^3</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">gradt</span><span class="p">()</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">grad(r) = x/sqrt(x^2 + y^2 + z^2) e_x + y/sqrt(x^2 + y^2 + z^2) e_y</span>
<span class="go"> + z/sqrt(x^2 + y^2 + z^2) e_z</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.induced_metric">
<code class="descname">induced_metric</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.induced_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the first fundamental form of the submanifold.</p>
<p>The result is cached, so calling this method multiple times always
returns the same result at no additional cost.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>the first fundamental form, as an instance of
<a class="reference internal" href="metric.html#sage.manifolds.differentiable.metric.PseudoRiemannianMetric" title="sage.manifolds.differentiable.metric.PseudoRiemannianMetric"><code class="xref py py-class docutils literal notranslate"><span class="pre">PseudoRiemannianMetric</span></code></a></li>
</ul>
<p>EXAMPLES:</p>
<p>A sphere embedded in Euclidean space:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">EuclideanSpace</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">ambient</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s2">&quot;Riemannian&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.&lt;</span><span class="n">th</span><span class="p">,</span><span class="n">ph</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;th:(0,pi):\theta ph:(-pi,pi):\phi&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">r</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">cartesian_coordinates</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="p">{(</span><span class="n">C</span><span class="p">,</span><span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span>
<span class="gp">....: </span>                             <span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span>
<span class="gp">....: </span>                             <span class="n">r</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">set_embedding</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">first_fundamental_form</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">Riemannian metric gamma on the 2-dimensional Riemannian</span>
<span class="go"> submanifold N embedded in the Euclidean space E^3</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">first_fundamental_form</span><span class="p">()[:]</span>  <span class="c1"># long time</span>
<span class="go">[          r^2             0]</span>
<span class="go">[            0 r^2*sin(th)^2]</span>
</pre></div>
</div>
<p>An alias is <code class="docutils literal notranslate"><span class="pre">induced_metric</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">induced_metric</span><span class="p">()[:]</span>  <span class="c1"># long time</span>
<span class="go">[          r^2             0]</span>
<span class="go">[            0 r^2*sin(th)^2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.lapse">
<code class="descname">lapse</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.lapse" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the lapse function of the foliation.</p>
<p>The result is cached, so calling this method multiple times always
returns the same result at no additional cost.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>the lapse function, as a scalar field on the ambient manifold</li>
</ul>
<p>EXAMPLES:</p>
<p>Foliation of the Euclidean 3-space by 2-spheres parametrized by their
radii:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">EuclideanSpace</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">ambient</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s2">&quot;Riemannian&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.&lt;</span><span class="n">th</span><span class="p">,</span><span class="n">ph</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;th:(0,pi):\theta ph:(-pi,pi):\phi&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span> <span class="c1"># foliation parameter</span>
<span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">r</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">cartesian_coordinates</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="p">{(</span><span class="n">C</span><span class="p">,</span><span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span>
<span class="gp">....: </span>                             <span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span>
<span class="gp">....: </span>                             <span class="n">r</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">phi_inv</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="p">{(</span><span class="n">E</span><span class="p">,</span><span class="n">C</span><span class="p">):</span> <span class="p">[</span><span class="n">arccos</span><span class="p">(</span><span class="n">z</span><span class="o">/</span><span class="n">r</span><span class="p">),</span> <span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">phi_inv_r</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">scalar_field</span><span class="p">({</span><span class="n">E</span><span class="p">:</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">)})</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">set_embedding</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="n">phi_inv</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="n">r</span><span class="p">,</span>
<span class="gp">....: </span>                <span class="n">t_inverse</span><span class="o">=</span><span class="p">{</span><span class="n">r</span><span class="p">:</span> <span class="n">phi_inv_r</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">adapted_chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">lapse</span><span class="p">()</span>
<span class="go">Scalar field N on the Euclidean space E^3</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">lapse</span><span class="p">()</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">N: E^3 --&gt; R</span>
<span class="go">   (x, y, z) |--&gt; 1</span>
<span class="go">   (th_E3, ph_E3, r_E3) |--&gt; 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.mean_curvature">
<code class="descname">mean_curvature</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.mean_curvature" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Return the mean curvature of the submanifold.</p>
<p>The <em>mean curvature</em> is the arithmetic mean of the principal curvatures,
or equivalently the trace of the projection operator.</p>
<p>The result is cached, so calling this method multiple times always
returns the same result at no additional cost.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>the mean curvature, as a scalar field on the submanifold</li>
</ul>
<p>EXAMPLES:</p>
</div></blockquote>
<p>A unit circle embedded in the Euclidean plane:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">EuclideanSpace</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">ambient</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s2">&quot;Riemannian&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">U</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">open_subset</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">open_subset</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">declare_union</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">stereoN</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">stereoS</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">stereoN_to_S</span> <span class="o">=</span> <span class="n">stereoN</span><span class="o">.</span><span class="n">transition_map</span><span class="p">(</span><span class="n">stereoS</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="n">x</span><span class="p">),</span>
<span class="gp">....: </span>                  <span class="n">intersection_name</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">,</span>
<span class="gp">....: </span>                  <span class="n">restrictions1</span><span class="o">=</span><span class="n">x</span><span class="o">!=</span><span class="mi">0</span><span class="p">,</span> <span class="n">restrictions2</span><span class="o">=</span><span class="n">y</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">stereoS_to_N</span> <span class="o">=</span> <span class="n">stereoN_to_S</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">cartesian_coordinates</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">M</span><span class="p">,</span>
<span class="gp">....: </span>        <span class="p">{(</span><span class="n">stereoN</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="n">x</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="p">)],</span>
<span class="gp">....: </span>         <span class="p">(</span><span class="n">stereoS</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">4</span><span class="o">/</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="o">/</span><span class="n">y</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">4</span><span class="o">/</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">set_embedding</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">mean_curvature</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">Scalar field on the 1-dimensional Riemannian submanifold N</span>
<span class="go"> embedded in the Euclidean plane E^2</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">mean_curvature</span><span class="p">()</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">N --&gt; R</span>
<span class="go">on U: x |--&gt; -1</span>
<span class="go">on V: y |--&gt; -1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.mixed_projection">
<code class="descname">mixed_projection</code><span class="sig-paren">(</span><em>tensor</em>, <em>indices=0</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.mixed_projection" title="Permalink to this definition">¶</a></dt>
<dd><p>Return de n+1 decomposition of a tensor on the submanifold and the
normal vector.</p>
<p>The n+1 decomposition of a tensor of rank <span class="math notranslate nohighlight">\(k\)</span> can be obtained by
contracting each index either with the normal vector or the projection
operator of the submanifold (see
<a class="reference internal" href="#sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.projector" title="sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.projector"><code class="xref py py-meth docutils literal notranslate"><span class="pre">projector()</span></code></a>).</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">tensor</span></code> – any tensor field, eventually along the submanifold if
no foliation is provided.</li>
<li><code class="docutils literal notranslate"><span class="pre">indices</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">0</span></code>) list of integers containing the
indices on which the projection is made on the normal vector.
By default, all projections are made on the submanifold. If
an integer <span class="math notranslate nohighlight">\(n\)</span> is provided, the <span class="math notranslate nohighlight">\(n\)</span> first contractions are made with
the normal vector, all the other ones with the orthogonal projection
operator.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>tensor field of rank <span class="math notranslate nohighlight">\(k\)</span>-<code class="docutils literal notranslate"><span class="pre">len(indices)</span></code></li>
</ul>
<p>EXAMPLES:</p>
<p>Foliation of the Euclidean 3-space by 2-spheres parametrized by their
radii:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">EuclideanSpace</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">ambient</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s2">&quot;Riemannian&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.&lt;</span><span class="n">th</span><span class="p">,</span><span class="n">ph</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;th:(0,pi):\theta ph:(-pi,pi):\phi&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span> <span class="c1"># foliation parameter</span>
<span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">r</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">cartesian_coordinates</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="p">{(</span><span class="n">C</span><span class="p">,</span><span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span>
<span class="gp">....: </span>                             <span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span>
<span class="gp">....: </span>                             <span class="n">r</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">phi_inv</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="p">{(</span><span class="n">E</span><span class="p">,</span><span class="n">C</span><span class="p">):</span> <span class="p">[</span><span class="n">arccos</span><span class="p">(</span><span class="n">z</span><span class="o">/</span><span class="n">r</span><span class="p">),</span> <span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">phi_inv_r</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">scalar_field</span><span class="p">({</span><span class="n">E</span><span class="p">:</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">)})</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">set_embedding</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="n">phi_inv</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="n">r</span><span class="p">,</span>
<span class="gp">....: </span>                <span class="n">t_inverse</span><span class="o">=</span><span class="p">{</span><span class="n">r</span><span class="p">:</span> <span class="n">phi_inv_r</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">adapted_chart</span><span class="p">()</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">indices</span></code> is not specified, the mixed projection of the ambient
metric coincides with the first fundamental form:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">metric</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">gpp</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">mixed_projection</span><span class="p">(</span><span class="n">g</span><span class="p">);</span> <span class="n">gpp</span>  <span class="c1"># long time</span>
<span class="go">Tensor field of type (0,2) on the Euclidean space E^3</span>
<span class="gp">sage: </span><span class="n">gpp</span> <span class="o">==</span> <span class="n">N</span><span class="o">.</span><span class="n">ambient_first_fundamental_form</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The other non-redundant projections are:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">gnp</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">mixed_projection</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="n">gnp</span>  <span class="c1"># long time</span>
<span class="go">1-form on the Euclidean space E^3</span>
</pre></div>
</div>
<p>and:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">gnn</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">mixed_projection</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span> <span class="n">gnn</span>
<span class="go">Scalar field on the Euclidean space E^3</span>
</pre></div>
</div>
<p>which is constant and equal to 1 (the norm of the unit normal vector):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">gnn</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">E^3 --&gt; R</span>
<span class="go">(x, y, z) |--&gt; 1</span>
<span class="go">(th_E3, ph_E3, r_E3) |--&gt; 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.normal">
<code class="descname">normal</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.normal" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a normal unit vector to the submanifold.</p>
<p>If a foliation is defined, it is used to compute the gradient of the
foliation parameter and then the normal vector. If not, the normal
vector is computed using the following formula:</p>
<div class="math notranslate nohighlight">
\[n = \vec{*}(\mathrm{d}x_0\wedge\mathrm{d}x_1\wedge\cdots
\wedge\mathrm{d}x_{n-1})\]</div>
<p>where the star stands for the Hodge dual operator and the wedge for the
exterior product.</p>
<p>This formula does not always define a proper vector field when
multiple charts overlap, because of the arbitrariness of the direction
of the normal vector. To avoid this problem, the method <code class="docutils literal notranslate"><span class="pre">normal()</span></code>
considers the graph defined by the atlas of the submanifold and the
changes of coordinates, and only calculate the normal vector once by
connected component. The expression is then propagate by restriction,
continuation, or change of coordinates using a breadth-first
exploration of the graph.</p>
<p>The result is cached, so calling this method multiple times always
returns the same result at no additional cost.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>vector field on the ambient manifold (case of a foliation) or along
the submanifold with values in the ambient manifold (case of a
single submanifold)</li>
</ul>
<p>EXAMPLES:</p>
<p>Foliation of the Euclidean 3-space by 2-spheres parametrized by their
radii:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">EuclideanSpace</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">ambient</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s2">&quot;Riemannian&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.&lt;</span><span class="n">th</span><span class="p">,</span><span class="n">ph</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;th:(0,pi):\theta ph:(-pi,pi):\phi&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span> <span class="c1"># foliation parameter</span>
<span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">r</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">cartesian_coordinates</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="p">{(</span><span class="n">C</span><span class="p">,</span><span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span>
<span class="gp">....: </span>                             <span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span>
<span class="gp">....: </span>                             <span class="n">r</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">phi_inv</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="p">{(</span><span class="n">E</span><span class="p">,</span><span class="n">C</span><span class="p">):</span> <span class="p">[</span><span class="n">arccos</span><span class="p">(</span><span class="n">z</span><span class="o">/</span><span class="n">r</span><span class="p">),</span> <span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">phi_inv_r</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">scalar_field</span><span class="p">({</span><span class="n">E</span><span class="p">:</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">)})</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">set_embedding</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="n">phi_inv</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="n">r</span><span class="p">,</span>
<span class="gp">....: </span>                <span class="n">t_inverse</span><span class="o">=</span><span class="p">{</span><span class="n">r</span><span class="p">:</span> <span class="n">phi_inv_r</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">adapted_chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">normal</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">Vector field n on the Euclidean space E^3</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">normal</span><span class="p">()</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">n = x/sqrt(x^2 + y^2 + z^2) e_x + y/sqrt(x^2 + y^2 + z^2) e_y</span>
<span class="go"> + z/sqrt(x^2 + y^2 + z^2) e_z</span>
</pre></div>
</div>
<p>Or in spherical coordinates:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">normal</span><span class="p">()</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">frame</span><span class="p">(),</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># long time</span>
<span class="go">n = d/dr_E3</span>
</pre></div>
</div>
<p>Let us now consider a sphere of constant radius, i.e. not assumed to be
part of a foliation, in stereographic coordinates:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">EuclideanSpace</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">ambient</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s2">&quot;Riemannian&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">U</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">open_subset</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">open_subset</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">declare_union</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">stereoN</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">stereoS</span><span class="o">.&lt;</span><span class="n">xp</span><span class="p">,</span><span class="n">yp</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="s2">&quot;xp:x&#39; yp:y&#39;&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">stereoN_to_S</span> <span class="o">=</span> <span class="n">stereoN</span><span class="o">.</span><span class="n">transition_map</span><span class="p">(</span><span class="n">stereoS</span><span class="p">,</span>
<span class="gp">....: </span>                                <span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="n">y</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)),</span>
<span class="gp">....: </span>                                <span class="n">intersection_name</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">,</span>
<span class="gp">....: </span>                                <span class="n">restrictions1</span><span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">!=</span><span class="mi">0</span><span class="p">,</span>
<span class="gp">....: </span>                                <span class="n">restrictions2</span><span class="o">=</span> <span class="n">xp</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">yp</span><span class="o">^</span><span class="mi">2</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">stereoS_to_N</span> <span class="o">=</span> <span class="n">stereoN_to_S</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">stereoN_W</span> <span class="o">=</span> <span class="n">stereoN</span><span class="o">.</span><span class="n">restrict</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">stereoS_W</span> <span class="o">=</span> <span class="n">stereoS</span><span class="o">.</span><span class="n">restrict</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">W</span><span class="o">.</span><span class="n">open_subset</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">coord_def</span><span class="o">=</span><span class="p">{</span><span class="n">stereoN_W</span><span class="p">:</span> <span class="p">(</span><span class="n">y</span><span class="o">!=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">),</span>
<span class="gp">....: </span>                                  <span class="n">stereoS_W</span><span class="p">:</span> <span class="p">(</span><span class="n">yp</span><span class="o">!=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xp</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)})</span>
<span class="gp">sage: </span><span class="n">spher</span><span class="o">.&lt;</span><span class="n">the</span><span class="p">,</span><span class="n">phi</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;the:(0,pi):\theta phi:(0,2*pi):\phi&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">stereoN_A</span> <span class="o">=</span> <span class="n">stereoN_W</span><span class="o">.</span><span class="n">restrict</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">spher_to_stereoN</span> <span class="o">=</span> <span class="n">spher</span><span class="o">.</span><span class="n">transition_map</span><span class="p">(</span><span class="n">stereoN_A</span><span class="p">,</span>
<span class="gp">....: </span>                             <span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">the</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">cos</span><span class="p">(</span><span class="n">the</span><span class="p">)),</span>
<span class="gp">....: </span>                              <span class="n">sin</span><span class="p">(</span><span class="n">the</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">cos</span><span class="p">(</span><span class="n">the</span><span class="p">))))</span>
<span class="gp">sage: </span><span class="n">spher_to_stereoN</span><span class="o">.</span><span class="n">set_inverse</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">atan</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)),</span>
<span class="gp">....: </span>                             <span class="n">atan2</span><span class="p">(</span><span class="o">-</span><span class="n">y</span><span class="p">,</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">pi</span><span class="p">)</span>
<span class="go">Check of the inverse coordinate transformation:</span>
<span class="go">  the == 2*arctan(sqrt(-cos(the) + 1)/sqrt(cos(the) + 1))  **failed**</span>
<span class="go">  phi == pi + arctan2(sin(phi)*sin(the)/(cos(the) - 1),</span>
<span class="go">                      cos(phi)*sin(the)/(cos(the) - 1))  **failed**</span>
<span class="go">  x == x  *passed*</span>
<span class="go">  y == y  *passed*</span>
<span class="go">NB: a failed report can reflect a mere lack of simplification.</span>
<span class="gp">sage: </span><span class="n">stereoN_to_S_A</span> <span class="o">=</span> <span class="n">stereoN_to_S</span><span class="o">.</span><span class="n">restrict</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">spher_to_stereoS</span> <span class="o">=</span> <span class="n">stereoN_to_S_A</span> <span class="o">*</span> <span class="n">spher_to_stereoN</span>
<span class="gp">sage: </span><span class="n">stereoS_to_N_A</span> <span class="o">=</span> <span class="n">stereoN_to_S</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span><span class="o">.</span><span class="n">restrict</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">stereoS_to_spher</span> <span class="o">=</span> <span class="n">spher_to_stereoN</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span> <span class="o">*</span> <span class="n">stereoS_to_N_A</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">cartesian_coordinates</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="p">{(</span><span class="n">stereoN</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">....: </span>                                   <span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">....: </span>                                   <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)],</span>
<span class="gp">....: </span>                  <span class="p">(</span><span class="n">stereoS</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">xp</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">xp</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">yp</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">....: </span>                                 <span class="mi">2</span><span class="o">*</span><span class="n">yp</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">xp</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">yp</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">....: </span>                                <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">xp</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">yp</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">xp</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">yp</span><span class="o">^</span><span class="mi">2</span><span class="p">)]},</span>
<span class="gp">....: </span>                 <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Phi&#39;</span><span class="p">,</span> <span class="n">latex_name</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\Phi&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">set_embedding</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
</pre></div>
</div>
<p>The method <code class="docutils literal notranslate"><span class="pre">normal()</span></code> now returns a tensor field along <code class="docutils literal notranslate"><span class="pre">N</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">normal</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">n</span>  <span class="c1"># long time</span>
<span class="go">Vector field n along the 2-dimensional Riemannian submanifold N</span>
<span class="go"> embedded in the Euclidean space E^3 with values on the Euclidean</span>
<span class="go"> space E^3</span>
</pre></div>
</div>
<p>Let us check that the choice of orientation is coherent on the two top
frames:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">restrict</span><span class="p">(</span><span class="n">V</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">format_spec</span><span class="o">=</span><span class="n">spher</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">n = -cos(phi)*sin(the) e_X - sin(phi)*sin(the) e_Y - cos(the) e_Z</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">restrict</span><span class="p">(</span><span class="n">U</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">format_spec</span><span class="o">=</span><span class="n">spher</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">n = -cos(phi)*sin(the) e_X - sin(phi)*sin(the) e_Y - cos(the) e_Z</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.principal_curvatures">
<code class="descname">principal_curvatures</code><span class="sig-paren">(</span><em>chart</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.principal_curvatures" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the principal curvatures of the submanifold.</p>
<p>The <em>principal curvatures</em> are the eigenvalues of the projection
operator. The resulting scalar fields are named <code class="docutils literal notranslate"><span class="pre">k_i</span></code> with the
index <code class="docutils literal notranslate"><span class="pre">i</span></code> ranging from 0 to the submanifold dimension minus one.</p>
<p>The result is cached, so calling this method multiple times always
returns the same result at no additional cost.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">chart</span></code> –  chart in which the principal curvatures are to be
computed</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>the principal curvatures, as a list of scalar fields on the
submanifold</li>
</ul>
<p>EXAMPLES:</p>
<p>A unit circle embedded in the Euclidean plane:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">EuclideanSpace</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">ambient</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s2">&quot;Riemannian&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">U</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">open_subset</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">open_subset</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">declare_union</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">stereoN</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">stereoS</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">stereoN_to_S</span> <span class="o">=</span> <span class="n">stereoN</span><span class="o">.</span><span class="n">transition_map</span><span class="p">(</span><span class="n">stereoS</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="n">x</span><span class="p">),</span>
<span class="gp">....: </span>                  <span class="n">intersection_name</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">,</span>
<span class="gp">....: </span>                  <span class="n">restrictions1</span><span class="o">=</span><span class="n">x</span><span class="o">!=</span><span class="mi">0</span><span class="p">,</span> <span class="n">restrictions2</span><span class="o">=</span><span class="n">y</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">stereoS_to_N</span> <span class="o">=</span> <span class="n">stereoN_to_S</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">cartesian_coordinates</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">M</span><span class="p">,</span>
<span class="gp">....: </span>        <span class="p">{(</span><span class="n">stereoN</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="n">x</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="p">)],</span>
<span class="gp">....: </span>         <span class="p">(</span><span class="n">stereoS</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">4</span><span class="o">/</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="o">/</span><span class="n">y</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">4</span><span class="o">/</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">set_embedding</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">principal_curvatures</span><span class="p">(</span><span class="n">stereoN</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">[Scalar field k_0 on the 1-dimensional Riemannian submanifold N</span>
<span class="go"> embedded in the Euclidean plane E^2]</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">principal_curvatures</span><span class="p">(</span><span class="n">stereoN</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">k_0: N --&gt; R</span>
<span class="go">on U: x |--&gt; -1</span>
<span class="go">on W: y |--&gt; -1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.principal_directions">
<code class="descname">principal_directions</code><span class="sig-paren">(</span><em>chart</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.principal_directions" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the principal directions of the submanifold.</p>
<p>The <em>principal directions</em> are the eigenvectors of the projection
operator. The result is formatted as a list of pairs
(eigenvector, eigenvalue).</p>
<p>The result is cached, so calling this method multiple times always
returns the same result at no additional cost.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">chart</span></code> –  chart in which the principal directions are to be
computed</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>list of pairs (vector field, scalar field) representing the
principal directions and the associated principal curvatures</li>
</ul>
<p>EXAMPLES:</p>
<p>A unit circle embedded in the Euclidean plane:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">EuclideanSpace</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">ambient</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s2">&quot;Riemannian&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">U</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">open_subset</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">open_subset</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">declare_union</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">stereoN</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">stereoS</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">stereoN_to_S</span> <span class="o">=</span> <span class="n">stereoN</span><span class="o">.</span><span class="n">transition_map</span><span class="p">(</span><span class="n">stereoS</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="n">x</span><span class="p">),</span>
<span class="gp">....: </span>                  <span class="n">intersection_name</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">,</span>
<span class="gp">....: </span>                  <span class="n">restrictions1</span><span class="o">=</span><span class="n">x</span><span class="o">!=</span><span class="mi">0</span><span class="p">,</span> <span class="n">restrictions2</span><span class="o">=</span><span class="n">y</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">stereoS_to_N</span> <span class="o">=</span> <span class="n">stereoN_to_S</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">cartesian_coordinates</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">M</span><span class="p">,</span>
<span class="gp">....: </span>        <span class="p">{(</span><span class="n">stereoN</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="n">x</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="p">)],</span>
<span class="gp">....: </span>         <span class="p">(</span><span class="n">stereoS</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">4</span><span class="o">/</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="o">/</span><span class="n">y</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">4</span><span class="o">/</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">set_embedding</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">principal_directions</span><span class="p">(</span><span class="n">stereoN</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">[(Vector field e_0 on the 1-dimensional Riemannian submanifold N</span>
<span class="go">  embedded in the Euclidean plane E^2, -1)]</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">principal_directions</span><span class="p">(</span><span class="n">stereoN</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">e_0 = d/dx</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.project">
<code class="descname">project</code><span class="sig-paren">(</span><em>tensor</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.project" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the orthogonal projection of a tensor field onto the submanifold.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">tensor</span></code> – any tensor field to be projected onto the submanifold.
If no foliation is provided, must be a tensor field along the
submanifold.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>orthogonal projection of <code class="docutils literal notranslate"><span class="pre">tensor</span></code> onto the submanifold, as a
tensor field of the <em>ambient</em> manifold</li>
</ul>
<p>EXAMPLES:</p>
<p>Foliation of the Euclidean 3-space by 2-spheres parametrized by their
radii:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">EuclideanSpace</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">ambient</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s2">&quot;Riemannian&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.&lt;</span><span class="n">th</span><span class="p">,</span><span class="n">ph</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;th:(0,pi):\theta ph:(-pi,pi):\phi&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span> <span class="c1"># foliation parameter</span>
<span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">r</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">cartesian_coordinates</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="p">{(</span><span class="n">C</span><span class="p">,</span><span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span>
<span class="gp">....: </span>                             <span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span>
<span class="gp">....: </span>                             <span class="n">r</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">phi_inv</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="p">{(</span><span class="n">E</span><span class="p">,</span><span class="n">C</span><span class="p">):</span> <span class="p">[</span><span class="n">arccos</span><span class="p">(</span><span class="n">z</span><span class="o">/</span><span class="n">r</span><span class="p">),</span> <span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">phi_inv_r</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">scalar_field</span><span class="p">({</span><span class="n">E</span><span class="p">:</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">)})</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">set_embedding</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="n">phi_inv</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="n">r</span><span class="p">,</span>
<span class="gp">....: </span>                <span class="n">t_inverse</span><span class="o">=</span><span class="p">{</span><span class="n">r</span><span class="p">:</span> <span class="n">phi_inv_r</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">adapted_chart</span><span class="p">()</span>
</pre></div>
</div>
<p>Let us perform the projection of the ambient metric and check that it
is equal to the first fundamental form:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">pg</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">metric</span><span class="p">());</span> <span class="n">pg</span>  <span class="c1"># long time</span>
<span class="go">Tensor field of type (0,2) on the Euclidean space E^3</span>
<span class="gp">sage: </span><span class="n">pg</span> <span class="o">==</span> <span class="n">N</span><span class="o">.</span><span class="n">ambient_first_fundamental_form</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Note that the output of <code class="docutils literal notranslate"><span class="pre">project()</span></code> is not cached.</p>
</dd></dl>

<dl class="method">
<dt id="sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.projector">
<code class="descname">projector</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.projector" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the orthogonal projector onto the submanifold.</p>
<p>The result is cached, so calling this method multiple times always
returns the same result at no additional cost.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>the orthogonal projector onto the submanifold, as tensor field of
type (1,1) on the ambient manifold</li>
</ul>
<p>EXAMPLES:</p>
<p>Foliation of the Euclidean 3-space by 2-spheres parametrized by their
radii:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">EuclideanSpace</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">ambient</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s2">&quot;Riemannian&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.&lt;</span><span class="n">th</span><span class="p">,</span><span class="n">ph</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;th:(0,pi):\theta ph:(-pi,pi):\phi&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span> <span class="c1"># foliation parameter</span>
<span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">r</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">cartesian_coordinates</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="p">{(</span><span class="n">C</span><span class="p">,</span><span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span>
<span class="gp">....: </span>                             <span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span>
<span class="gp">....: </span>                             <span class="n">r</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">phi_inv</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="p">{(</span><span class="n">E</span><span class="p">,</span><span class="n">C</span><span class="p">):</span> <span class="p">[</span><span class="n">arccos</span><span class="p">(</span><span class="n">z</span><span class="o">/</span><span class="n">r</span><span class="p">),</span> <span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">phi_inv_r</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">scalar_field</span><span class="p">({</span><span class="n">E</span><span class="p">:</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">)})</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">set_embedding</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="n">phi_inv</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="n">r</span><span class="p">,</span>
<span class="gp">....: </span>                <span class="n">t_inverse</span><span class="o">=</span><span class="p">{</span><span class="n">r</span><span class="p">:</span> <span class="n">phi_inv_r</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">adapted_chart</span><span class="p">()</span>
</pre></div>
</div>
<p>The orthogonal projector onto <code class="docutils literal notranslate"><span class="pre">N</span></code> is a type-(1,1) tensor field on
<code class="docutils literal notranslate"><span class="pre">M</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">projector</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">Tensor field gamma of type (1,1) on the Euclidean space E^3</span>
</pre></div>
</div>
<p>Check that the orthogonal projector applied to the normal vector is
zero:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">projector</span><span class="p">()</span><span class="o">.</span><span class="n">contract</span><span class="p">(</span><span class="n">N</span><span class="o">.</span><span class="n">normal</span><span class="p">())</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.second_fundamental_form">
<code class="descname">second_fundamental_form</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.second_fundamental_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the second fundamental form of the submanifold.</p>
<p>The result is cached, so calling this method multiple times always
returns the same result at no additional cost.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>the second fundamental form, as a symmetric tensor field of type
(0,2) on the submanifold</li>
</ul>
<p>EXAMPLES:</p>
<p>A unit circle embedded in the Euclidean plane:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">EuclideanSpace</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">ambient</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s2">&quot;Riemannian&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">U</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">open_subset</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">open_subset</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">declare_union</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">stereoN</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">stereoS</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">stereoN_to_S</span> <span class="o">=</span> <span class="n">stereoN</span><span class="o">.</span><span class="n">transition_map</span><span class="p">(</span><span class="n">stereoS</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="n">x</span><span class="p">),</span>
<span class="gp">....: </span>                  <span class="n">intersection_name</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">,</span>
<span class="gp">....: </span>                  <span class="n">restrictions1</span><span class="o">=</span><span class="n">x</span><span class="o">!=</span><span class="mi">0</span><span class="p">,</span> <span class="n">restrictions2</span><span class="o">=</span><span class="n">y</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">stereoS_to_N</span> <span class="o">=</span> <span class="n">stereoN_to_S</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">cartesian_coordinates</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">M</span><span class="p">,</span>
<span class="gp">....: </span>        <span class="p">{(</span><span class="n">stereoN</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="n">x</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="p">)],</span>
<span class="gp">....: </span>         <span class="p">(</span><span class="n">stereoS</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">4</span><span class="o">/</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="o">/</span><span class="n">y</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">4</span><span class="o">/</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">set_embedding</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">second_fundamental_form</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">Field of symmetric bilinear forms K on the 1-dimensional Riemannian</span>
<span class="go"> submanifold N embedded in the Euclidean plane E^2</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">second_fundamental_form</span><span class="p">()</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">K = -4/(x^4 + 8*x^2 + 16) dx*dx</span>
</pre></div>
</div>
<p>An alias is <code class="docutils literal notranslate"><span class="pre">extrinsic_curvature</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">extrinsic_curvature</span><span class="p">()</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">K = -4/(x^4 + 8*x^2 + 16) dx*dx</span>
</pre></div>
</div>
<p>An example with a non-Euclidean ambient metric:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;Riemannian&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">ambient</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;Riemannian&#39;</span><span class="p">,</span>
<span class="gp">....: </span>             <span class="n">start_index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">CM</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">CN</span><span class="o">.&lt;</span><span class="n">u</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">metric</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">u</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">set_embedding</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">second_fundamental_form</span><span class="p">()</span>
<span class="go">Field of symmetric bilinear forms K on the 1-dimensional Riemannian</span>
<span class="go"> submanifold N embedded in the 2-dimensional Riemannian manifold M</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">second_fundamental_form</span><span class="p">()</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">K = 2*sqrt(u^4 + 2*u^2 + 2)*u/(u^6 + 3*u^4 + 4*u^2 + 2) du*du</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.shape_operator">
<code class="descname">shape_operator</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.shape_operator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the shape operator of the submanifold.</p>
<p>The shape operator is equal to the second fundamental form with one of
the indices upped.</p>
<p>The result is cached, so calling this method multiple times always
returns the same result at no additional cost.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>the shape operator, as a tensor field of type (1,1) on the
submanifold</li>
</ul>
<p>EXAMPLES:</p>
<p>A unit circle embedded in the Euclidean plane:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">EuclideanSpace</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">ambient</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s2">&quot;Riemannian&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">U</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">open_subset</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">open_subset</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">declare_union</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">stereoN</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">stereoS</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">stereoN_to_S</span> <span class="o">=</span> <span class="n">stereoN</span><span class="o">.</span><span class="n">transition_map</span><span class="p">(</span><span class="n">stereoS</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="n">x</span><span class="p">),</span>
<span class="gp">....: </span>                  <span class="n">intersection_name</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">,</span>
<span class="gp">....: </span>                  <span class="n">restrictions1</span><span class="o">=</span><span class="n">x</span><span class="o">!=</span><span class="mi">0</span><span class="p">,</span> <span class="n">restrictions2</span><span class="o">=</span><span class="n">y</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">stereoS_to_N</span> <span class="o">=</span> <span class="n">stereoN_to_S</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">cartesian_coordinates</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">M</span><span class="p">,</span>
<span class="gp">....: </span>        <span class="p">{(</span><span class="n">stereoN</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="n">x</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="p">)],</span>
<span class="gp">....: </span>         <span class="p">(</span><span class="n">stereoS</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">4</span><span class="o">/</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="o">/</span><span class="n">y</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">4</span><span class="o">/</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">set_embedding</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">shape_operator</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">Tensor field of type (1,1) on the 1-dimensional Riemannian</span>
<span class="go"> submanifold N embedded in the Euclidean plane E^2</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">shape_operator</span><span class="p">()</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">-d/dx*dx</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.shift">
<code class="descname">shift</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.pseudo_riemannian_submanifold.PseudoRiemannianSubmanifold.shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the shift vector associated with the first adapted chart of the
foliation.</p>
<p>The result is cached, so calling this method multiple times always
returns the same result at no additional cost.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>shift vector field on the ambient manifold</li>
</ul>
<p>EXAMPLES:</p>
<p>Foliation of the Euclidean 3-space by 2-spheres parametrized by their
radii:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">EuclideanSpace</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="n">ambient</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s2">&quot;Riemannian&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.&lt;</span><span class="n">th</span><span class="p">,</span><span class="n">ph</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;th:(0,pi):\theta ph:(-pi,pi):\phi&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span> <span class="c1"># foliation parameter</span>
<span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">r</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">cartesian_coordinates</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="p">{(</span><span class="n">C</span><span class="p">,</span><span class="n">E</span><span class="p">):</span> <span class="p">[</span><span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span>
<span class="gp">....: </span>                             <span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span>
<span class="gp">....: </span>                             <span class="n">r</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">phi_inv</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="p">{(</span><span class="n">E</span><span class="p">,</span><span class="n">C</span><span class="p">):</span> <span class="p">[</span><span class="n">arccos</span><span class="p">(</span><span class="n">z</span><span class="o">/</span><span class="n">r</span><span class="p">),</span> <span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">phi_inv_r</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">scalar_field</span><span class="p">({</span><span class="n">E</span><span class="p">:</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">)})</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">set_embedding</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="n">phi_inv</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="n">r</span><span class="p">,</span>
<span class="gp">....: </span>                <span class="n">t_inverse</span><span class="o">=</span><span class="p">{</span><span class="n">r</span><span class="p">:</span> <span class="n">phi_inv_r</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">adapted_chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">shift</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">Vector field beta on the Euclidean space E^3</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">shift</span><span class="p">()</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">beta = 0</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="levi_civita_connection.html"
                        title="previous chapter">Levi-Civita Connections</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../utilities.html"
                        title="next chapter">Utilities for Calculus</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/sage/manifolds/differentiable/pseudo_riemannian_submanifold.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../utilities.html" title="Utilities for Calculus"
             >next</a> |</li>
        <li class="right" >
          <a href="levi_civita_connection.html" title="Levi-Civita Connections"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Manifolds</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../../riem_manifold.html" >Pseudo-Riemannian Manifolds</a> &#187;</li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2020, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>