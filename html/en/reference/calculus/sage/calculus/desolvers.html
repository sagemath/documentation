<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Solving ordinary differential equations &mdash; Sage Reference Manual v7.0: Symbolic Calculus</title>
    
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '7.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v7.0: Symbolic Calculus" href="../../index.html" />
    <link rel="next" title="Discrete Wavelet Transform" href="../gsl/dwt.html" />
    <link rel="prev" title="Further examples from Wester’s paper" href="wester.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../gsl/dwt.html" title="Discrete Wavelet Transform"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="wester.html" title="Further examples from Wester’s paper"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../index.html">Symbolic Calculus</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="solving-ordinary-differential-equations">
<span id="sage-calculus-desolvers"></span><h1>Solving ordinary differential equations<a class="headerlink" href="#solving-ordinary-differential-equations" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.calculus.desolvers"></span><p>This file contains functions useful for solving differential equations
which occur commonly in a 1st semester differential equations
course. For another numerical solver see the <a class="reference internal" href="../gsl/ode.html#sage.gsl.ode.ode_solver" title="sage.gsl.ode.ode_solver"><tt class="xref py py-meth docutils literal"><span class="pre">ode_solver()</span></tt></a> function
and the optional package Octave.</p>
<p>Solutions from the Maxima package can contain the three constants
<tt class="docutils literal"><span class="pre">_C</span></tt>, <tt class="docutils literal"><span class="pre">_K1</span></tt>, and <tt class="docutils literal"><span class="pre">_K2</span></tt> where the underscore is used to distinguish
them from symbolic variables that the user might have used. You can
substitute values for them, and make them into accessible usable
symbolic variables, for example with <tt class="docutils literal"><span class="pre">var(&quot;_C&quot;)</span></tt>.</p>
<p>Commands:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">desolve</span></tt> - Compute the &#8220;general solution&#8221; to a 1st or 2nd order
ODE via Maxima.</li>
<li><tt class="docutils literal"><span class="pre">desolve_laplace</span></tt> - Solve an ODE using Laplace transforms via
Maxima. Initial conditions are optional.</li>
<li><tt class="docutils literal"><span class="pre">desolve_rk4</span></tt> - Solve numerically IVP for one first order
equation, return list of points or plot.</li>
<li><tt class="docutils literal"><span class="pre">desolve_system_rk4</span></tt> - Solve numerically IVP for system of first
order equations, return list of points.</li>
<li><tt class="docutils literal"><span class="pre">desolve_odeint</span></tt> - Solve numerically a system of first-order ordinary
differential equations using <tt class="docutils literal"><span class="pre">odeint</span></tt> from scipy.integrate module.</li>
<li><tt class="docutils literal"><span class="pre">desolve_system</span></tt> - Solve any size system of 1st order odes using
Maxima. Initial conditions are optional.</li>
<li><tt class="docutils literal"><span class="pre">eulers_method</span></tt> - Approximate solution to a 1st order DE,
presented as a table.</li>
<li><tt class="docutils literal"><span class="pre">eulers_method_2x2</span></tt> - Approximate solution to a 1st order system
of DEs, presented as a table.</li>
<li><tt class="docutils literal"><span class="pre">eulers_method_2x2_plot</span></tt> - Plot the sequence of points obtained
from Euler&#8217;s method.</li>
</ul>
<p>AUTHORS:</p>
<ul class="simple">
<li>David Joyner (3-2006) - Initial version of functions</li>
<li>Marshall Hampton (7-2007) - Creation of Python module and testing</li>
<li>Robert Bradshaw (10-2008) - Some interface cleanup.</li>
<li>Robert Marik (10-2009) - Some bugfixes and enhancements</li>
<li>Miguel Marco (06-2014) - Tides desolvers</li>
</ul>
<dl class="function">
<dt id="sage.calculus.desolvers.desolve">
<tt class="descclassname">sage.calculus.desolvers.</tt><tt class="descname">desolve</tt><big>(</big><em>de</em>, <em>dvar</em>, <em>ics=None</em>, <em>ivar=None</em>, <em>show_method=False</em>, <em>contrib_ode=False</em><big>)</big><a class="headerlink" href="#sage.calculus.desolvers.desolve" title="Permalink to this definition">¶</a></dt>
<dd><p>Solves a 1st or 2nd order linear ODE via maxima. Including IVP and BVP.</p>
<p><em>Use</em> <tt class="docutils literal"><span class="pre">desolve?</span> <span class="pre">&lt;tab&gt;</span></tt> <em>if the output in truncated in notebook.</em></p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">de</span></tt> - an expression or equation representing the ODE</li>
<li><tt class="docutils literal"><span class="pre">dvar</span></tt> - the dependent variable (hereafter called <tt class="docutils literal"><span class="pre">y</span></tt>)</li>
<li><tt class="docutils literal"><span class="pre">ics</span></tt> - (optional) the initial or boundary conditions<ul>
<li>for a first-order equation, specify the initial <tt class="docutils literal"><span class="pre">x</span></tt> and <tt class="docutils literal"><span class="pre">y</span></tt></li>
<li>for a second-order equation, specify the initial <tt class="docutils literal"><span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">y</span></tt>,
and <tt class="docutils literal"><span class="pre">dy/dx</span></tt>, i.e. write <span class="math">\([x_0, y(x_0), y'(x_0)]\)</span></li>
<li>for a second-order boundary solution, specify initial and
final <tt class="docutils literal"><span class="pre">x</span></tt> and <tt class="docutils literal"><span class="pre">y</span></tt> boundary conditions, i.e. write <span class="math">\([x_0, y(x_0), x_1, y(x_1)]\)</span>.</li>
<li>gives an error if the solution is not SymbolicEquation (as happens for
example for a Clairaut equation)</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">ivar</span></tt> - (optional) the independent variable (hereafter called
x), which must be specified if there is more than one
independent variable in the equation.</li>
<li><tt class="docutils literal"><span class="pre">show_method</span></tt> - (optional) if true, then Sage returns pair
<tt class="docutils literal"><span class="pre">[solution,</span> <span class="pre">method]</span></tt>, where method is the string describing
the method which has been used to get a solution (Maxima uses the
following order for first order equations: linear, separable,
exact (including exact with integrating factor), homogeneous,
bernoulli, generalized homogeneous) - use carefully in class,
see below for the example of the equation which is separable but
this property is not recognized by Maxima and the equation is solved
as exact.</li>
<li><tt class="docutils literal"><span class="pre">contrib_ode</span></tt> - (optional) if true, desolve allows to solve
Clairaut, Lagrange, Riccati and some other equations. This may take
a long time and is thus turned off by default.  Initial conditions
can be used only if the result is one SymbolicEquation (does not
contain a singular solution, for example)</li>
</ul>
<p>OUTPUT:</p>
<p>In most cases return a SymbolicEquation which defines the solution
implicitly.  If the result is in the form y(x)=... (happens for
linear eqs.), return the right-hand side only.  The possible
constant solutions of separable ODE&#8217;s are omitted.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">(_C + e^x)*e^(-x)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ics</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">]);</span> <span class="n">f</span>
<span class="go">(e^10 + e^x)*e^(-x)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
</pre></div>
</div>
<p>We can also solve second-order differential equations.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">de</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span> <span class="o">==</span> <span class="n">x</span>
<span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">de</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">_K2*e^(-x) + _K1*e^x - x</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">desolve</span><span class="p">(</span><span class="n">de</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span> <span class="n">f</span>
<span class="go">-x + 7*e^(x - 10) + 5*e^(-x + 10)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">)(</span><span class="n">x</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">de</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">de</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">_K2*cos(x) + _K1*sin(x)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">de</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="go">cos(x) + 4*sin(x)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="go">-1/2*y(x)^2 == _C - cos(x)</span>
</pre></div>
</div>
<p>Clairaut equation: general and singular solutions:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">y</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">contrib_ode</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">show_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[[y(x) == _C^2 + _C*x, y(x) == -1/4*x^2], &#39;clairault&#39;]</span>
</pre></div>
</div>
<p>For equations involving more variables we specify an independent variable:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a b c n&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">==</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="n">n</span><span class="o">+</span><span class="n">c</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">ivar</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">contrib_ode</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[[y(x) == 0, (b*x^(n - 2) + a/x^2)*c^2*u == 0]]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">==</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="n">n</span><span class="o">+</span><span class="n">c</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">ivar</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">contrib_ode</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">show_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[[[y(x) == 0, (b*x^(n - 2) + a/x^2)*c^2*u == 0]], &#39;riccati&#39;]</span>
</pre></div>
</div>
<p>Higher order equations, not involving independent variable:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">^</span><span class="mi">3</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="go">1/6*y(x)^3 + _K1*y(x) == _K2 + x</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">^</span><span class="mi">3</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="go">1/6*y(x)^3 - 5/3*y(x) == x - 3/2</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">^</span><span class="mi">3</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="n">show_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[1/6*y(x)^3 - 5/3*y(x) == x - 3/2, &#39;freeofx&#39;]</span>
</pre></div>
</div>
<p>Separable equations - Sage returns solution in implicit form:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">y</span><span class="p">)</span>
<span class="go">-cos(y(x)) == _C + sin(x)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">y</span><span class="p">,</span><span class="n">show_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[-cos(y(x)) == _C + sin(x), &#39;separable&#39;]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">y</span><span class="p">,[</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">-cos(y(x)) == -cos(1) + sin(x) - 1</span>
</pre></div>
</div>
<p>Linear equation - Sage returns the expression on the right hand side only:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">y</span><span class="p">)</span>
<span class="go">1/2*((cos(x) + sin(x))*e^x + 2*_C)*e^(-x)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">y</span><span class="p">,</span><span class="n">show_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[1/2*((cos(x) + sin(x))*e^x + 2*_C)*e^(-x), &#39;linear&#39;]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">y</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">1/2*(cos(x)*e^x + e^x*sin(x) + 1)*e^(-x)</span>
</pre></div>
</div>
<p>This ODE with separated variables is solved as
exact. Explanation - factor does not split <span class="math">\(e^{x-y}\)</span> in Maxima
into <span class="math">\(e^{x}e^{y}\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">==</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">),</span><span class="n">y</span><span class="p">,</span><span class="n">show_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[-e^x + e^y(x) == _C, &#39;exact&#39;]</span>
</pre></div>
</div>
<p>You can solve Bessel equations, also using initial
conditions, but you cannot put (sometimes desired) the initial
condition at x=0, since this point is a singular point of the
equation. Anyway, if the solution should be bounded at x=0, then
_K2=0.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">x</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="go">_K1*bessel_J(2, x) + _K2*bessel_Y(2, x)</span>
</pre></div>
</div>
<p>Example of difficult ODE producing an error:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">+</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="c"># not tested</span>
<span class="go">Traceback (click to the left for traceback)</span>
<span class="gp">...</span>
<span class="go">NotImplementedError, &quot;Maxima was unable to solve this ODE. Consider to set option contrib_ode to True.&quot;</span>
</pre></div>
</div>
<p>Another difficult ODE with error - moreover, it takes a long time</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">+</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">contrib_ode</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c"># not tested</span>
</pre></div>
</div>
<p>Some more types of ODE&#8217;s:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">contrib_ode</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">show_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[[y(x) == _C*e^x, y(x) == _C + log(x)], &#39;factor&#39;]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">==</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">contrib_ode</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">show_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[[[x == _C - arctan(sqrt(t)), y(x) == -x - sqrt(t)], [x == _C + arctan(sqrt(t)), y(x) == -x + sqrt(t)]], &#39;lagrange&#39;]</span>
</pre></div>
</div>
<p>These two examples produce an error (as expected, Maxima 5.18 cannot
solve equations from initial conditions). Maxima 5.18
returns false answer in this case!:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">^</span><span class="mi">3</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span> <span class="c"># not tested</span>
<span class="go">Traceback (click to the left for traceback)</span>
<span class="gp">...</span>
<span class="go">NotImplementedError, &quot;Maxima was unable to solve this ODE. Consider to set option contrib_ode to True.&quot;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">^</span><span class="mi">3</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">show_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c"># not tested</span>
<span class="go">Traceback (click to the left for traceback)</span>
<span class="gp">...</span>
<span class="go">NotImplementedError, &quot;Maxima was unable to solve this ODE. Consider to set option contrib_ode to True.&quot;</span>
</pre></div>
</div>
<p>Second order linear ODE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">y</span> <span class="o">==</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">y</span><span class="p">)</span>
<span class="go">(_K2*x + _K1)*e^(-x) + 1/2*sin(x)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">y</span> <span class="o">==</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">y</span><span class="p">,</span><span class="n">show_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[(_K2*x + _K1)*e^(-x) + 1/2*sin(x), &#39;variationofparameters&#39;]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">y</span> <span class="o">==</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">y</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">1/2*(7*x + 6)*e^(-x) + 1/2*sin(x)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">y</span> <span class="o">==</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">y</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">show_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[1/2*(7*x + 6)*e^(-x) + 1/2*sin(x), &#39;variationofparameters&#39;]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">y</span> <span class="o">==</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">y</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">3*(x*(e^(1/2*pi) - 2)/pi + 1)*e^(-x) + 1/2*sin(x)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">y</span> <span class="o">==</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">y</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">show_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[3*(x*(e^(1/2*pi) - 2)/pi + 1)*e^(-x) + 1/2*sin(x), &#39;variationofparameters&#39;]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="go">(_K2*x + _K1)*e^(-x)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">show_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[(_K2*x + _K1)*e^(-x), &#39;constcoeff&#39;]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">(4*x + 3)*e^(-x)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">show_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[(4*x + 3)*e^(-x), &#39;constcoeff&#39;]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">(2*x*(2*e^(1/2*pi) - 3)/pi + 3)*e^(-x)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">show_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[(2*x*(2*e^(1/2*pi) - 3)/pi + 3)*e^(-x), &#39;constcoeff&#39;]</span>
</pre></div>
</div>
<p>TESTS:</p>
<p><a class="reference external" href="http://trac.sagemath.org/9961">trac ticket #9961</a> fixed (allow assumptions on the dependent variable in desolve):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">y</span><span class="o">=</span><span class="n">function</span><span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">);</span> <span class="n">assume</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">);</span> <span class="n">assume</span><span class="p">(</span><span class="n">y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">maxima</span><span class="p">(</span><span class="s">&#39;domain:real&#39;</span><span class="p">)</span>  <span class="c"># needed since Maxima 5.26.0 to get the answer as below</span>
<span class="go">real</span>
<span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">x</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">contrib_ode</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[x - arcsinh(y(x)/x) == _C]</span>
</pre></div>
</div>
<p><a class="reference external" href="http://trac.sagemath.org/10682">trac ticket #10682</a> updated Maxima to 5.26, and it started to show a different
solution in the complex domain for the ODE above:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">forget</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">maxima</span><span class="p">(</span><span class="s">&#39;domain:complex&#39;</span><span class="p">)</span>  <span class="c"># back to the default complex domain</span>
<span class="go">complex</span>
<span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">x</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">contrib_ode</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[x - arcsinh(y(x)^2/(x*sqrt(y(x)^2))) - arcsinh(y(x)/x) + 1/2*log(4*(x^2 + 2*y(x)^2 + 2*x*sqrt((x^2*y(x)^2 + y(x)^4)/x^2))/x^2) == _C]</span>
</pre></div>
</div>
<p><a class="reference external" href="http://trac.sagemath.org/6479">trac ticket #6479</a> fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span> <span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">x</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span> <span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">x + 1</span>
</pre></div>
</div>
<p><a class="reference external" href="http://trac.sagemath.org/9835">trac ticket #9835</a> fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">Unable to use initial condition for this equation (freeofx).</span>
</pre></div>
</div>
<p><a class="reference external" href="http://trac.sagemath.org/8931">trac ticket #8931</a> fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">);</span> <span class="n">f</span><span class="o">=</span><span class="n">function</span><span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">);</span> <span class="n">k</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s">&#39;k&#39;</span><span class="p">);</span> <span class="n">assume</span><span class="p">(</span><span class="n">k</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">f</span><span class="o">==</span><span class="n">k</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">ivar</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<span class="go">_K1*e^(sqrt(k)*x) + _K2*e^(-sqrt(k)*x)</span>
</pre></div>
</div>
<p><a class="reference external" href="http://trac.sagemath.org/15775">trac ticket #15775</a> fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">forget</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">y</span><span class="p">)),</span> <span class="n">dvar</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">ivar</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<span class="go">sqrt(-y(x))*(sgn(y(x)) - 1) + (sgn(y(x)) + 1)*sqrt(y(x)) == _C + x</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>David Joyner (1-2006)</li>
<li>Robert Bradshaw (10-2008)</li>
<li>Robert Marik (10-2009)</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="sage.calculus.desolvers.desolve_laplace">
<tt class="descclassname">sage.calculus.desolvers.</tt><tt class="descname">desolve_laplace</tt><big>(</big><em>de</em>, <em>dvar</em>, <em>ics=None</em>, <em>ivar=None</em><big>)</big><a class="headerlink" href="#sage.calculus.desolvers.desolve_laplace" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve an ODE using Laplace transforms. Initial conditions are optional.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">de</span></tt> - a lambda expression representing the ODE (eg, de =
diff(y,x,2) == diff(y,x)+sin(x))</li>
<li><tt class="docutils literal"><span class="pre">dvar</span></tt> - the dependent variable (eg y)</li>
<li><tt class="docutils literal"><span class="pre">ivar</span></tt> - (optional) the independent variable (hereafter called
x), which must be specified if there is more than one
independent variable in the equation.</li>
<li><tt class="docutils literal"><span class="pre">ics</span></tt> - a list of numbers representing initial conditions, (eg,
f(0)=1, f&#8217;(0)=2 is ics = [0,1,2])</li>
</ul>
<p>OUTPUT:</p>
<p>Solution of the ODE as symbolic expression</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">u</span><span class="o">=</span><span class="n">function</span><span class="p">(</span><span class="s">&#39;u&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">eq</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">u</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="n">desolve_laplace</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span><span class="n">u</span><span class="p">)</span>
<span class="go">1/2*(2*u(0) + 1)*e^x - 1/2*e^(-x)</span>
</pre></div>
</div>
<p>We can use initial conditions:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve_laplace</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">ics</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">-1/2*e^(-x) + 7/2*e^x</span>
</pre></div>
</div>
<p>The initial conditions do not persist in the system (as they persisted
in previous versions):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve_laplace</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span><span class="n">u</span><span class="p">)</span>
<span class="go">1/2*(2*u(0) + 1)*e^x - 1/2*e^(-x)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span><span class="o">=</span><span class="n">function</span><span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">eq</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="n">desolve_laplace</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span><span class="n">f</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">e^(-x)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">de</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span>
<span class="gp">sage: </span><span class="n">desolve_laplace</span><span class="p">(</span><span class="n">de</span><span class="p">,</span><span class="n">f</span><span class="p">)</span>
<span class="go">-x*e^x*f(0) + x*e^x*D[0](f)(0) + e^x*f(0)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve_laplace</span><span class="p">(</span><span class="n">de</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">ics</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">x*e^x + e^x</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Trac #4839 fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">t</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s">&#39;t&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">=</span><span class="n">function</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">soln</span><span class="o">=</span><span class="n">desolve_laplace</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">+</span><span class="n">x</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">ics</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">soln</span>
<span class="go">e^(-t) + 1</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">soln</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">e^(-3) + 1</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>David Joyner (1-2006,8-2007)</li>
<li>Robert Marik (10-2009)</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="sage.calculus.desolvers.desolve_mintides">
<tt class="descclassname">sage.calculus.desolvers.</tt><tt class="descname">desolve_mintides</tt><big>(</big><em>f</em>, <em>ics</em>, <em>initial</em>, <em>final</em>, <em>delta</em>, <em>tolrel=1e-16</em>, <em>tolabs=1e-16</em><big>)</big><a class="headerlink" href="#sage.calculus.desolvers.desolve_mintides" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve numerically a system of first order differential equations using the
taylor series integrator implemented in mintides.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">f</span></tt> &#8211; symbolic function. Its first argument will be the independent
variable. Its output should be de derivatives of the deppendent variables.</li>
<li><tt class="docutils literal"><span class="pre">ics</span></tt> &#8211; a list or tuple with the initial conditions.</li>
<li><tt class="docutils literal"><span class="pre">initial</span></tt> &#8211; the starting value for the independent variable.</li>
<li><tt class="docutils literal"><span class="pre">final</span></tt> &#8211; the final value for the independent value.</li>
<li><tt class="docutils literal"><span class="pre">delta</span></tt> &#8211; the size of the steps in the output.</li>
<li><tt class="docutils literal"><span class="pre">tolrel</span></tt> &#8211; the relative tolerance for the method.</li>
<li><tt class="docutils literal"><span class="pre">tolabs</span></tt> &#8211; the absolute tolerance for the method.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>A list  with the positions of the IVP.</li>
</ul>
<p>EXAMPLES:</p>
<p>We integrate a periodic orbit of the Kepler problem along 50 periods:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;t,x,y,X,Y&#39;</span><span class="p">)</span>
<span class="go">(t, x, y, X, Y)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span><span class="o">=</span><span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="o">-</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="n">y</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">ics</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.22474487139159</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="n">pi</span>
<span class="gp">sage: </span><span class="n">sol</span> <span class="o">=</span> <span class="n">desolve_mintides</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ics</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="mf">1e-12</span><span class="p">,</span> <span class="mf">1e-12</span><span class="p">)</span> <span class="c"># optional -tides</span>
<span class="gp">sage: </span><span class="n">sol</span> <span class="c"># optional -tides # abs tol 1e-5</span>
<span class="go">[[0.000000000000000,</span>
<span class="go">0.800000000000000,</span>
<span class="go">0.000000000000000,</span>
<span class="go">0.000000000000000,</span>
<span class="go">1.22474487139159],</span>
<span class="go">[314.159265358979,</span>
<span class="go">0.800000000028622,</span>
<span class="go">-5.91973525754241e-9,</span>
<span class="go">7.56887091890590e-9,</span>
<span class="go">1.22474487136329]]</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>Uses TIDES.</p>
<p>REFERENCES:</p>
<ul class="simple">
<li>A. Abad, R. Barrio, F. Blesa, M. Rodriguez. Algorithm 924. <em>ACM
Transactions on Mathematical Software</em> , <em>39</em> (1), 1-28.</li>
<li>(<a class="reference external" href="http://www.unizar.es/acz/05Publicaciones/Monografias/MonografiasPublicadas/Monografia36/IndMonogr36.htm">http://www.unizar.es/acz/05Publicaciones/Monografias/MonografiasPublicadas/Monografia36/IndMonogr36.htm</a>)
A. Abad, R. Barrio, F. Blesa, M. Rodriguez.
TIDES tutorial: Integrating ODEs by using the Taylor Series Method.</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="sage.calculus.desolvers.desolve_odeint">
<tt class="descclassname">sage.calculus.desolvers.</tt><tt class="descname">desolve_odeint</tt><big>(</big><em>des</em>, <em>ics</em>, <em>times</em>, <em>dvars</em>, <em>ivar=None</em>, <em>compute_jac=False</em>, <em>args=()</em>, <em>rtol=None</em>, <em>atol=None</em>, <em>tcrit=None</em>, <em>h0=0.0</em>, <em>hmax=0.0</em>, <em>hmin=0.0</em>, <em>ixpr=0</em>, <em>mxstep=0</em>, <em>mxhnil=0</em>, <em>mxordn=12</em>, <em>mxords=5</em>, <em>printmessg=0</em><big>)</big><a class="headerlink" href="#sage.calculus.desolvers.desolve_odeint" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve numerically a system of first-order ordinary differential equations
using <tt class="docutils literal"><span class="pre">odeint</span></tt> from scipy.integrate module.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">des</span></tt>  &#8211; right hand sides of the system</li>
<li><tt class="docutils literal"><span class="pre">ics</span></tt>  &#8211; initial conditions</li>
<li><tt class="docutils literal"><span class="pre">times</span></tt> &#8211; a sequence of time points in which the solution must be found</li>
<li><tt class="docutils literal"><span class="pre">dvars</span></tt> &#8211; dependent variables. ATTENTION: the order must be the same as
in des, that means: d(dvars[i])/dt=des[i]</li>
<li><tt class="docutils literal"><span class="pre">ivar</span></tt> &#8211; independent variable, optional.</li>
<li><tt class="docutils literal"><span class="pre">compute_jac</span></tt> &#8211; boolean. If True, the Jacobian of des is computed and
used during the integration of Stiff Systems. Default value is False.</li>
</ul>
<dl class="docutils">
<dt>Other Parameters (taken from the documentation of odeint function from</dt>
<dd>scipy.integrate module)</dd>
</dl>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">rtol</span></tt>, <tt class="docutils literal"><span class="pre">atol</span></tt> : float
The input parameters rtol and atol determine the error
control performed by the solver.  The solver will control the
vector, e, of estimated local errors in y, according to an
inequality of the form:</p>
<blockquote>
<div><p>max-norm of (e / ewt) &lt;= 1</p>
</div></blockquote>
<p>where ewt is a vector of positive error weights computed as:</p>
<blockquote>
<div><p>ewt = rtol * abs(y) + atol</p>
</div></blockquote>
<p>rtol and atol can be either vectors the same length as y or scalars.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">tcrit</span></tt> : array
Vector of critical points (e.g. singularities) where integration
care should be taken.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">h0</span></tt> : float, (0: solver-determined)
The step size to be attempted on the first step.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">hmax</span></tt> : float, (0: solver-determined)
The maximum absolute step size allowed.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">hmin</span></tt> : float, (0: solver-determined)
The minimum absolute step size allowed.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">ixpr</span></tt> : boolean.
Whether to generate extra printing at method switches.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">mxstep</span></tt> : integer, (0: solver-determined)
Maximum number of (internally defined) steps allowed for each
integration point in t.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">mxhnil</span></tt> : integer, (0: solver-determined)
Maximum number of messages printed.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">mxordn</span></tt> : integer, (0: solver-determined)
Maximum order to be allowed for the nonstiff (Adams) method.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">mxords</span></tt> : integer, (0: solver-determined)
Maximum order to be allowed for the stiff (BDF) method.</p>
</li>
</ul>
<p>OUTPUT:</p>
<p>Return a list with the solution of the system at each time in times.</p>
<p>EXAMPLES:</p>
<p>Lotka Volterra Equations:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.desolvers</span> <span class="kn">import</span> <span class="n">desolve_odeint</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s">&#39;x,y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">y</span><span class="p">),</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">sol</span><span class="o">=</span><span class="n">desolve_odeint</span><span class="p">(</span><span class="n">f</span><span class="p">,[</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">srange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">=</span><span class="n">line</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">sol</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">sol</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Lorenz Equations:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s">&#39;x,y,z&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="c"># Next we define the parameters</span>
<span class="gp">sage: </span><span class="n">sigma</span><span class="o">=</span><span class="mi">10</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">=</span><span class="mi">28</span>
<span class="gp">sage: </span><span class="n">beta</span><span class="o">=</span><span class="mi">8</span><span class="o">/</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="c"># The Lorenz equations</span>
<span class="gp">sage: </span><span class="n">lorenz</span><span class="o">=</span><span class="p">[</span><span class="n">sigma</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">rho</span><span class="o">-</span><span class="n">z</span><span class="p">)</span><span class="o">-</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">-</span><span class="n">beta</span><span class="o">*</span><span class="n">z</span><span class="p">]</span>
<span class="gp">sage: </span><span class="c"># Time and initial conditions</span>
<span class="gp">sage: </span><span class="n">times</span><span class="o">=</span><span class="n">srange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">50.05</span><span class="p">,</span><span class="mf">0.05</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ics</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">sol</span><span class="o">=</span><span class="n">desolve_odeint</span><span class="p">(</span><span class="n">lorenz</span><span class="p">,</span><span class="n">ics</span><span class="p">,</span><span class="n">times</span><span class="p">,[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">],</span><span class="n">rtol</span><span class="o">=</span><span class="mf">1e-13</span><span class="p">,</span><span class="n">atol</span><span class="o">=</span><span class="mf">1e-14</span><span class="p">)</span>
</pre></div>
</div>
<p>One-dimensional Stiff system:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">y</span><span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">epsilon</span><span class="o">=</span><span class="mf">0.01</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">=</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ic</span><span class="o">=</span><span class="n">epsilon</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">=</span><span class="n">srange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="n">epsilon</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sol</span><span class="o">=</span><span class="n">desolve_odeint</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">ic</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">rtol</span><span class="o">=</span><span class="mf">1e-9</span><span class="p">,</span><span class="n">atol</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">,</span><span class="n">compute_jac</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">=</span><span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">sol</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Another Stiff system with some optional parameters with no
default value:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">y1</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">y3</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s">&#39;y1,y2,y3&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f1</span><span class="o">=</span><span class="mf">77.27</span><span class="o">*</span><span class="p">(</span><span class="n">y2</span><span class="o">+</span><span class="n">y1</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mf">8.375</span><span class="o">*</span><span class="mf">1e-6</span><span class="o">*</span><span class="n">y1</span><span class="o">-</span><span class="n">y2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mf">77.27</span><span class="o">*</span><span class="p">(</span><span class="n">y3</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">y1</span><span class="p">)</span><span class="o">*</span><span class="n">y2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f3</span><span class="o">=</span><span class="mf">0.16</span><span class="o">*</span><span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">=</span><span class="p">[</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">,</span><span class="n">f3</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">ci</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.7</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">=</span><span class="n">srange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">=</span><span class="p">[</span><span class="n">y1</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">y3</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">sol</span><span class="o">=</span><span class="n">desolve_odeint</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">ci</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">rtol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span><span class="n">atol</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span><span class="n">h0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">hmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">hmin</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span><span class="n">mxstep</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">mxords</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li>Oriol Castejon (05-2010)</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="sage.calculus.desolvers.desolve_rk4">
<tt class="descclassname">sage.calculus.desolvers.</tt><tt class="descname">desolve_rk4</tt><big>(</big><em>de</em>, <em>dvar</em>, <em>ics=None</em>, <em>ivar=None</em>, <em>end_points=None</em>, <em>step=0.1</em>, <em>output='list'</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.calculus.desolvers.desolve_rk4" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve numerically one first-order ordinary differential
equation. See also <tt class="docutils literal"><span class="pre">ode_solver</span></tt>.</p>
<p>INPUT:</p>
<p>input is similar to <tt class="docutils literal"><span class="pre">desolve</span></tt> command. The differential equation can be
written in a form close to the plot_slope_field or desolve command</p>
<ul class="simple">
<li>Variant 1 (function in two variables)<ul>
<li><tt class="docutils literal"><span class="pre">de</span></tt> - right hand side, i.e. the function <span class="math">\(f(x,y)\)</span> from ODE <span class="math">\(y'=f(x,y)\)</span></li>
<li><tt class="docutils literal"><span class="pre">dvar</span></tt> - dependent variable (symbolic variable declared by var)</li>
</ul>
</li>
<li>Variant 2 (symbolic equation)<ul>
<li><tt class="docutils literal"><span class="pre">de</span></tt> - equation, including term with <tt class="docutils literal"><span class="pre">diff(y,x)</span></tt></li>
<li><tt class="docutils literal"><span class="pre">dvar</span></tt> - dependent variable (declared as function of independent variable)</li>
</ul>
</li>
<li>Other parameters<ul>
<li><tt class="docutils literal"><span class="pre">ivar</span></tt> - should be specified, if there are more variables or if the equation is autonomous</li>
<li><tt class="docutils literal"><span class="pre">ics</span></tt> - initial conditions in the form [x0,y0]</li>
<li><tt class="docutils literal"><span class="pre">end_points</span></tt> - the end points of the interval<ul>
<li>if end_points is a or [a], we integrate on between min(ics[0],a) and max(ics[0],a)</li>
<li>if end_points is None, we use end_points=ics[0]+10</li>
<li>if end_points is [a,b] we integrate on between min(ics[0],a) and max(ics[0],b)</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">step</span></tt> - (optional, default:0.1) the length of the step (positive number)</li>
<li><tt class="docutils literal"><span class="pre">output</span></tt> - (optional, default: &#8216;list&#8217;) one of &#8216;list&#8217;,
&#8216;plot&#8217;, &#8216;slope_field&#8217; (graph of the solution with slope field)</li>
</ul>
</li>
</ul>
<p>OUTPUT:</p>
<p>Return a list of points, or plot produced by list_plot,
optionally with slope field.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.desolvers</span> <span class="kn">import</span> <span class="n">desolve_rk4</span>
</pre></div>
</div>
<p>Variant 2 for input - more common in numerics:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;x,y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">desolve_rk4</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="p">),</span><span class="n">y</span><span class="p">,</span><span class="n">ics</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">end_points</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="go">[[0, 1], [0.5, 1.12419127424558], [1.0, 1.461590162288825]]</span>
</pre></div>
</div>
<p>Variant 1 for input - we can pass ODE in the form used by
desolve function In this example we integrate bakwards, since
<tt class="docutils literal"><span class="pre">end_points</span> <span class="pre">&lt;</span> <span class="pre">ics[0]</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">desolve_rk4</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">ics</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">step</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">end_points</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[[0.0, 8.904257108962112], [0.5, 1.909327945361535], [1, 1]]</span>
</pre></div>
</div>
<p>Here we show how to plot simple pictures. For more advanced
aplications use list_plot instead. To see the resulting picture
use <tt class="docutils literal"><span class="pre">show(P)</span></tt> in Sage notebook.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;x,y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">desolve_rk4</span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="p">),</span><span class="n">y</span><span class="p">,</span><span class="n">ics</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">.</span><span class="mi">1</span><span class="p">],</span><span class="n">ivar</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">output</span><span class="o">=</span><span class="s">&#39;slope_field&#39;</span><span class="p">,</span><span class="n">end_points</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span><span class="n">thickness</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>4th order Runge-Kutta method. Wrapper for command <tt class="docutils literal"><span class="pre">rk</span></tt> in
Maxima&#8217;s dynamics package.  Perhaps could be faster by using
fast_float instead.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>Robert Marik (10-2009)</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="sage.calculus.desolvers.desolve_rk4_determine_bounds">
<tt class="descclassname">sage.calculus.desolvers.</tt><tt class="descname">desolve_rk4_determine_bounds</tt><big>(</big><em>ics</em>, <em>end_points=None</em><big>)</big><a class="headerlink" href="#sage.calculus.desolvers.desolve_rk4_determine_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to determine bounds for numerical integration.</p>
<ul class="simple">
<li>If end_points is None, the interval for integration is from ics[0]
to ics[0]+10</li>
<li>If end_points is a or [a], the interval for integration is from min(ics[0],a)
to max(ics[0],a)</li>
<li>If end_points is [a,b], the interval for integration is from min(ics[0],a)
to max(ics[0],b)</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.desolvers</span> <span class="kn">import</span> <span class="n">desolve_rk4_determine_bounds</span>
<span class="gp">sage: </span><span class="n">desolve_rk4_determine_bounds</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(0, 1)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve_rk4_determine_bounds</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">(0, 10)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve_rk4_determine_bounds</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<span class="go">(-2, 0)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">desolve_rk4_determine_bounds</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="go">(-2, 4)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.calculus.desolvers.desolve_system">
<tt class="descclassname">sage.calculus.desolvers.</tt><tt class="descname">desolve_system</tt><big>(</big><em>des</em>, <em>vars</em>, <em>ics=None</em>, <em>ivar=None</em><big>)</big><a class="headerlink" href="#sage.calculus.desolvers.desolve_system" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve any size system of 1st order ODE&#8217;s. Initial conditions are optional.</p>
<p>Onedimensional systems are passed to <a class="reference internal" href="#sage.calculus.desolvers.desolve_laplace" title="sage.calculus.desolvers.desolve_laplace"><tt class="xref py py-meth docutils literal"><span class="pre">desolve_laplace()</span></tt></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">des</span></tt> - list of ODEs</li>
<li><tt class="docutils literal"><span class="pre">vars</span></tt> - list of dependent variables</li>
<li><tt class="docutils literal"><span class="pre">ics</span></tt> - (optional) list of initial values for ivar and vars.
If ics is defined, it should provide initial conditions for each variable,
otherwise an exception would be raised.</li>
<li><tt class="docutils literal"><span class="pre">ivar</span></tt> - (optional) the independent variable, which must be
specified if there is more than one independent variable in the
equation.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;t&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">de1</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="n">de2</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="n">desolve_system</span><span class="p">([</span><span class="n">de1</span><span class="p">,</span> <span class="n">de2</span><span class="p">],</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
<span class="go">[x(t) == (x(0) - 1)*cos(t) - (y(0) - 1)*sin(t) + 1,</span>
<span class="go"> y(t) == (y(0) - 1)*cos(t) + (x(0) - 1)*sin(t) + 1]</span>
</pre></div>
</div>
<p>Now we give some initial conditions:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">sol</span> <span class="o">=</span> <span class="n">desolve_system</span><span class="p">([</span><span class="n">de1</span><span class="p">,</span> <span class="n">de2</span><span class="p">],</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">],</span> <span class="n">ics</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]);</span> <span class="n">sol</span>
<span class="go">[x(t) == -sin(t) + 1, y(t) == cos(t) + 1]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">solnx</span><span class="p">,</span> <span class="n">solny</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rhs</span><span class="p">(),</span> <span class="n">sol</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">plot</span><span class="p">([</span><span class="n">solnx</span><span class="p">,</span><span class="n">solny</span><span class="p">],(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>  <span class="c"># not tested</span>
<span class="gp">sage: </span><span class="n">parametric_plot</span><span class="p">((</span><span class="n">solnx</span><span class="p">,</span><span class="n">solny</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>  <span class="c"># not tested</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Check that <a class="reference external" href="http://trac.sagemath.org/9823">trac ticket #9823</a> is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;t&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">de1</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="n">desolve_system</span><span class="p">([</span><span class="n">de1</span><span class="p">],</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span>
<span class="go">-t + x(0)</span>
</pre></div>
</div>
<p>Check that <a class="reference external" href="http://trac.sagemath.org/16568">trac ticket #16568</a> is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;t&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">de1</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="n">de2</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="n">des</span> <span class="o">=</span> <span class="p">[</span><span class="n">de1</span><span class="p">,</span><span class="n">de2</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">ics</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="nb">vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">sol</span> <span class="o">=</span> <span class="n">desolve_system</span><span class="p">(</span><span class="n">des</span><span class="p">,</span> <span class="nb">vars</span><span class="p">,</span> <span class="n">ics</span><span class="p">);</span> <span class="n">sol</span>
<span class="go">[x(t) == 2*sin(t) + 1, y(t) == -2*cos(t) + 1]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">solx</span><span class="p">,</span> <span class="n">soly</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rhs</span><span class="p">(),</span> <span class="n">sol</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">RR</span><span class="p">(</span><span class="n">solx</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
<span class="go">1.28224001611973</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">plot</span><span class="p">([</span><span class="n">solx</span><span class="p">,</span><span class="n">soly</span><span class="p">],</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">parametric_plot</span><span class="p">((</span><span class="n">solx</span><span class="p">,</span><span class="n">soly</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<p>Now type show(P1), show(P2) to view these plots.</p>
<p>Check that <a class="reference external" href="http://trac.sagemath.org/9824">trac ticket #9824</a> is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;t&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">epsilon</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;epsilon&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x1</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s">&#39;x1&#39;</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x2</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s">&#39;x2&#39;</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">de1</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">t</span><span class="p">)</span> <span class="o">==</span> <span class="n">epsilon</span>
<span class="gp">sage: </span><span class="n">de2</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="n">t</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">desolve_system</span><span class="p">([</span><span class="n">de1</span><span class="p">,</span> <span class="n">de2</span><span class="p">],</span> <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span> <span class="n">ivar</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
<span class="go">[x1(t) == epsilon*t + x1(0), x2(t) == -2*t + x2(0)]</span>
<span class="gp">sage: </span><span class="n">desolve_system</span><span class="p">([</span><span class="n">de1</span><span class="p">,</span> <span class="n">de2</span><span class="p">],</span> <span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span> <span class="n">ics</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">ivar</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Initial conditions aren&#39;t complete: number of vars is different from number of dependent variables. Got ics = [1, 1], vars = [x1(t), x2(t)]</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Robert Bradshaw (10-2008)</li>
<li>Sergey Bykov (10-2014)</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="sage.calculus.desolvers.desolve_system_rk4">
<tt class="descclassname">sage.calculus.desolvers.</tt><tt class="descname">desolve_system_rk4</tt><big>(</big><em>des</em>, <em>vars</em>, <em>ics=None</em>, <em>ivar=None</em>, <em>end_points=None</em>, <em>step=0.1</em><big>)</big><a class="headerlink" href="#sage.calculus.desolvers.desolve_system_rk4" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve numerically a system of first-order ordinary differential
equations using the 4th order Runge-Kutta method. Wrapper for
Maxima command <tt class="docutils literal"><span class="pre">rk</span></tt>. See also <tt class="docutils literal"><span class="pre">ode_solver</span></tt>.</p>
<p>INPUT:</p>
<p>input is similar to desolve_system and desolve_rk4 commands</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">des</span></tt> - right hand sides of the system</li>
<li><tt class="docutils literal"><span class="pre">vars</span></tt> - dependent variables</li>
<li><tt class="docutils literal"><span class="pre">ivar</span></tt> - (optional) should be specified, if there are more variables or
if the equation is autonomous and the independent variable is
missing</li>
<li><tt class="docutils literal"><span class="pre">ics</span></tt> - initial conditions in the form [x0,y01,y02,y03,....]</li>
<li><tt class="docutils literal"><span class="pre">end_points</span></tt> - the end points of the interval<ul>
<li>if end_points is a or [a], we integrate on between min(ics[0],a) and max(ics[0],a)</li>
<li>if end_points is None, we use end_points=ics[0]+10</li>
<li>if end_points is [a,b] we integrate on between min(ics[0],a) and max(ics[0],b)</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">step</span></tt> &#8211; (optional, default: 0.1) the length of the step</li>
</ul>
<p>OUTPUT:</p>
<p>Return a list of points.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.desolvers</span> <span class="kn">import</span> <span class="n">desolve_system_rk4</span>
</pre></div>
</div>
<p>Lotka Volterra system:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.desolvers</span> <span class="kn">import</span> <span class="n">desolve_system_rk4</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s">&#39;x y t&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">desolve_system_rk4</span><span class="p">([</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">y</span><span class="p">),</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="p">)],[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">],</span><span class="n">ics</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">ivar</span><span class="o">=</span><span class="n">t</span><span class="p">,</span><span class="n">end_points</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">=</span><span class="p">[</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="n">P</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">LP</span><span class="o">=</span><span class="n">list_plot</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">=</span><span class="p">[</span> <span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="n">P</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">LP</span><span class="o">=</span><span class="n">list_plot</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>4th order Runge-Kutta method. Wrapper for command <tt class="docutils literal"><span class="pre">rk</span></tt> in Maxima&#8217;s
dynamics package.  Perhaps could be faster by using <tt class="docutils literal"><span class="pre">fast_float</span></tt>
instead.</p>
<p>AUTHOR:</p>
<ul class="simple">
<li>Robert Marik (10-2009)</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="sage.calculus.desolvers.desolve_tides_mpfr">
<tt class="descclassname">sage.calculus.desolvers.</tt><tt class="descname">desolve_tides_mpfr</tt><big>(</big><em>f</em>, <em>ics</em>, <em>initial</em>, <em>final</em>, <em>delta</em>, <em>tolrel=1e-16</em>, <em>tolabs=1e-16</em>, <em>digits=50</em><big>)</big><a class="headerlink" href="#sage.calculus.desolvers.desolve_tides_mpfr" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve numerically a system of first order differential equations using the
taylor series integrator in arbitrary precission implemented in tides.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">f</span></tt> &#8211; symbolic function. Its first argument will be the independent
variable. Its output should be de derivatives of the deppendent variables.</li>
<li><tt class="docutils literal"><span class="pre">ics</span></tt> &#8211; a list or tuple with the initial conditions.</li>
<li><tt class="docutils literal"><span class="pre">initial</span></tt> &#8211; the starting value for the independent variable.</li>
<li><tt class="docutils literal"><span class="pre">final</span></tt> &#8211; the final value for the independent value.</li>
<li><tt class="docutils literal"><span class="pre">delta</span></tt> &#8211; the size of the steps in the output.</li>
<li><tt class="docutils literal"><span class="pre">tolrel</span></tt> &#8211; the relative tolerance for the method.</li>
<li><tt class="docutils literal"><span class="pre">tolabs</span></tt> &#8211; the absolute tolerance for the method.</li>
<li><tt class="docutils literal"><span class="pre">digits</span></tt> &#8211; the digits of precission used in the computation.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>A list  with the positions of the IVP.</li>
</ul>
<p>EXAMPLES:</p>
<p>We integrate the Lorenz equations with Salztman values for the parameters
along 10 periodic orbits with 100 digits of precission:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;t,x,y,z&#39;</span><span class="p">)</span>
<span class="go">(t, x, y, z)</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="mi">28</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="mi">8</span><span class="o">/</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span><span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">r</span><span class="o">-</span><span class="n">z</span><span class="p">)</span><span class="o">-</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">-</span><span class="n">b</span><span class="o">*</span><span class="n">z</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">x0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">13.7636106821342005250144010543616538641008648540923684535378642921202827747268115852940239346395038284</span>
<span class="gp">sage: </span><span class="n">y0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">19.5787519424517955388380414460095588661142400534276438649791334295426354746147526415973165506704676171</span>
<span class="gp">sage: </span><span class="n">z0</span> <span class="o">=</span> <span class="mi">27</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="mf">15.586522107161747275678702092126960705284805489972439358895215783190198756258880854355851082660142374</span>
<span class="gp">sage: </span><span class="n">sol</span> <span class="o">=</span> <span class="n">desolve_tides_mpfr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">[</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">z0</span><span class="p">],</span><span class="mi">0</span> <span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="mf">1e-100</span><span class="p">,</span> <span class="mf">1e-100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="c"># optional - tides</span>
<span class="gp">sage: </span><span class="n">sol</span> <span class="c"># optional -tides # abs tol 1e-50</span>
<span class="go">[[0.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,</span>
<span class="go">-13.7636106821342005250144010543616538641008648540923684535378642921202827747268115852940239346395038,</span>
<span class="go">-19.5787519424517955388380414460095588661142400534276438649791334295426354746147526415973165506704676,</span>
<span class="go">27.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000],</span>
<span class="go">[15.5865221071617472756787020921269607052848054899724393588952157831901987562588808543558510826601424,</span>
<span class="go">-13.7636106821342005250144010543616538641008648540923684535378642921202827747268115852940239346315658,</span>
<span class="go">-19.5787519424517955388380414460095588661142400534276438649791334295426354746147526415973165506778440,</span>
<span class="go">26.9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999636628]]</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>Uses TIDES.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This requires the package tides.</p>
</div>
<p>REFERENCES:</p>
</dd></dl>

<dl class="function">
<dt id="sage.calculus.desolvers.eulers_method">
<tt class="descclassname">sage.calculus.desolvers.</tt><tt class="descname">eulers_method</tt><big>(</big><em>f</em>, <em>x0</em>, <em>y0</em>, <em>h</em>, <em>x1</em>, <em>algorithm='table'</em><big>)</big><a class="headerlink" href="#sage.calculus.desolvers.eulers_method" title="Permalink to this definition">¶</a></dt>
<dd><p>This implements Euler&#8217;s method for finding numerically the
solution of the 1st order ODE <tt class="docutils literal"><span class="pre">y'</span> <span class="pre">=</span> <span class="pre">f(x,y)</span></tt>, <tt class="docutils literal"><span class="pre">y(a)=c</span></tt>. The &#8220;x&#8221;
column of the table increments from <tt class="docutils literal"><span class="pre">x0</span></tt> to <tt class="docutils literal"><span class="pre">x1</span></tt> by <tt class="docutils literal"><span class="pre">h</span></tt> (so
<tt class="docutils literal"><span class="pre">(x1-x0)/h</span></tt> must be an integer). In the &#8220;y&#8221; column, the new
y-value equals the old y-value plus the corresponding entry in the
last column.</p>
<p><em>For pedagogical purposes only.</em></p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.desolvers</span> <span class="kn">import</span> <span class="n">eulers_method</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&quot;xy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">eulers_method</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">     x                    y                  h*f(x,y)</span>
<span class="go">     0                    1                   -2</span>
<span class="go">   1/2                   -1                 -7/4</span>
<span class="go">     1                -11/4                -11/8</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&quot;xy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">eulers_method</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;none&quot;</span><span class="p">)</span>
<span class="go">[[0, 1], [1/2, -1], [1, -11/4], [3/2, -33/8]]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">RR</span> <span class="o">=</span> <span class="n">RealField</span><span class="p">(</span><span class="n">sci_not</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">rnd</span><span class="o">=</span><span class="s">&#39;RNDU&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">RR</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&quot;xy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">eulers_method</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;None&quot;</span><span class="p">)</span>
<span class="go">[[0, 1], [1/2, -1.0], [1, -2.7], [3/2, -4.0]]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">RR</span> <span class="o">=</span> <span class="n">RealField</span><span class="p">(</span><span class="n">sci_not</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">rnd</span><span class="o">=</span><span class="s">&#39;RNDU&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">RR</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&quot;xy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">eulers_method</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">     x                    y                  h*f(x,y)</span>
<span class="go">     0                    1                 -2.0</span>
<span class="go">   1/2                 -1.0                 -1.7</span>
<span class="go">     1                 -2.7                 -1.3</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&quot;xy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">eulers_method</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">         x                    y                  h*f(x,y)</span>
<span class="go">         1                    1                  1/3</span>
<span class="go">       4/3                  4/3                    1</span>
<span class="go">       5/3                  7/3                 17/9</span>
<span class="go">         2                 38/9                83/27</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">eulers_method</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;none&quot;</span><span class="p">)</span>
<span class="go">[[0, 1], [1/2, -1], [1, -11/4], [3/2, -33/8]]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">pts</span> <span class="o">=</span> <span class="n">eulers_method</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;none&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">list_plot</span><span class="p">(</span><span class="n">pts</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">line</span><span class="p">(</span><span class="n">pts</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">P1</span><span class="o">+</span><span class="n">P2</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>David Joyner</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="sage.calculus.desolvers.eulers_method_2x2">
<tt class="descclassname">sage.calculus.desolvers.</tt><tt class="descname">eulers_method_2x2</tt><big>(</big><em>f</em>, <em>g</em>, <em>t0</em>, <em>x0</em>, <em>y0</em>, <em>h</em>, <em>t1</em>, <em>algorithm='table'</em><big>)</big><a class="headerlink" href="#sage.calculus.desolvers.eulers_method_2x2" title="Permalink to this definition">¶</a></dt>
<dd><p>This implements Euler&#8217;s method for finding numerically the
solution of the 1st order system of two ODEs</p>
<p><tt class="docutils literal"><span class="pre">x'</span> <span class="pre">=</span> <span class="pre">f(t,</span> <span class="pre">x,</span> <span class="pre">y),</span> <span class="pre">x(t0)=x0.</span></tt></p>
<p><tt class="docutils literal"><span class="pre">y'</span> <span class="pre">=</span> <span class="pre">g(t,</span> <span class="pre">x,</span> <span class="pre">y),</span> <span class="pre">y(t0)=y0.</span></tt></p>
<p>The &#8220;t&#8221; column of the table increments from <span class="math">\(t_0\)</span> to <span class="math">\(t_1\)</span> by <span class="math">\(h\)</span>
(so <span class="math">\(\\frac{t_1-t_0}{h}\)</span> must be an integer). In the &#8220;x&#8221; column,
the new x-value equals the old x-value plus the corresponding
entry in the next (third) column.  In the &#8220;y&#8221; column, the new
y-value equals the old y-value plus the corresponding entry in the
next (last) column.</p>
<p><em>For pedagogical purposes only.</em></p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.desolvers</span> <span class="kn">import</span> <span class="n">eulers_method_2x2</span>
<span class="gp">sage: </span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="s">&quot;txy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">+</span><span class="n">t</span><span class="p">;</span> <span class="n">g</span> <span class="o">=</span> <span class="n">x</span><span class="o">-</span><span class="n">y</span>
<span class="gp">sage: </span><span class="n">eulers_method_2x2</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&quot;none&quot;</span><span class="p">)</span>
<span class="go">[[0, 0, 0], [1/3, 0, 0], [2/3, 1/9, 0], [1, 10/27, 1/27], [4/3, 68/81, 4/27]]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">eulers_method_2x2</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">     t                    x                h*f(t,x,y)                    y           h*g(t,x,y)</span>
<span class="go">     0                    0                         0                    0                    0</span>
<span class="go">   1/3                    0                       1/9                    0                    0</span>
<span class="go">   2/3                  1/9                      7/27                    0                 1/27</span>
<span class="go">     1                10/27                     38/81                 1/27                  1/9</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">RR</span> <span class="o">=</span> <span class="n">RealField</span><span class="p">(</span><span class="n">sci_not</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">rnd</span><span class="o">=</span><span class="s">&#39;RNDU&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">RR</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="s">&quot;txy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">+</span><span class="n">t</span><span class="p">;</span> <span class="n">g</span> <span class="o">=</span> <span class="n">x</span><span class="o">-</span><span class="n">y</span>
<span class="gp">sage: </span><span class="n">eulers_method_2x2</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">     t                    x                h*f(t,x,y)                    y           h*g(t,x,y)</span>
<span class="go">     0                    0                      0.00                    0                 0.00</span>
<span class="go">   1/3                 0.00                      0.13                 0.00                 0.00</span>
<span class="go">   2/3                 0.13                      0.29                 0.00                0.043</span>
<span class="go">     1                 0.41                      0.57                0.043                 0.15</span>
</pre></div>
</div>
<p>To numerically approximate <span class="math">\(y(1)\)</span>, where <span class="math">\((1+t^2)y''+y'-y=0\)</span>,
<span class="math">\(y(0)=1\)</span>, <span class="math">\(y'(0)=-1\)</span>, using 4 steps of Euler&#8217;s method, first
convert to a system: <span class="math">\(y_1' = y_2\)</span>, <span class="math">\(y_1(0)=1\)</span>; <span class="math">\(y_2' =
\\frac{y_1-y_2}{1+t^2}\)</span>, <span class="math">\(y_2(0)=-1\)</span>.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">RR</span> <span class="o">=</span> <span class="n">RealField</span><span class="p">(</span><span class="n">sci_not</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">rnd</span><span class="o">=</span><span class="s">&#39;RNDU&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">RR</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="s">&quot;txy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">y</span><span class="p">;</span> <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">eulers_method_2x2</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">    t                    x                h*f(t,x,y)                    y           h*g(t,x,y)</span>
<span class="go">    0                    1                     -0.25                   -1                 0.50</span>
<span class="go">  1/4                 0.75                     -0.12                -0.50                 0.29</span>
<span class="go">  1/2                 0.63                    -0.054                -0.21                 0.19</span>
<span class="go">  3/4                 0.63                   -0.0078               -0.031                 0.11</span>
<span class="go">    1                 0.63                     0.020                0.079                0.071</span>
</pre></div>
</div>
<p>To numerically approximate y(1), where <span class="math">\(y''+ty'+y=0\)</span>, <span class="math">\(y(0)=1\)</span>, <span class="math">\(y'(0)=0\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">RR</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="s">&quot;txy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">y</span><span class="p">;</span> <span class="n">g</span> <span class="o">=</span> <span class="o">-</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="n">t</span>
<span class="gp">sage: </span><span class="n">eulers_method_2x2</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">     t                    x                h*f(t,x,y)                    y           h*g(t,x,y)</span>
<span class="go">     0                    1                      0.00                    0                -0.25</span>
<span class="go">   1/4                  1.0                    -0.062                -0.25                -0.23</span>
<span class="go">   1/2                 0.94                     -0.11                -0.46                -0.17</span>
<span class="go">   3/4                 0.88                     -0.15                -0.62                -0.10</span>
<span class="go">     1                 0.75                     -0.17                -0.68               -0.015</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>David Joyner</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="sage.calculus.desolvers.eulers_method_2x2_plot">
<tt class="descclassname">sage.calculus.desolvers.</tt><tt class="descname">eulers_method_2x2_plot</tt><big>(</big><em>f</em>, <em>g</em>, <em>t0</em>, <em>x0</em>, <em>y0</em>, <em>h</em>, <em>t1</em><big>)</big><a class="headerlink" href="#sage.calculus.desolvers.eulers_method_2x2_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot solution of ODE.</p>
<p>This plots the soln in the rectangle <tt class="docutils literal"><span class="pre">(xrange[0],xrange[1])</span>
<span class="pre">x</span> <span class="pre">(yrange[0],yrange[1])</span></tt> and plots using Euler&#8217;s method the
numerical solution of the 1st order ODEs <span class="math">\(x' = f(t,x,y)\)</span>,
<span class="math">\(x(a)=x_0\)</span>, <span class="math">\(y' = g(t,x,y)\)</span>, <span class="math">\(y(a) = y_0\)</span>.</p>
<p><em>For pedagogical purposes only.</em></p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.desolvers</span> <span class="kn">import</span> <span class="n">eulers_method_2x2_plot</span>
</pre></div>
</div>
<p>The following example plots the solution to
<span class="math">\(\theta''+\sin(\theta)=0\)</span>, <span class="math">\(\theta(0)=\frac 34\)</span>, <span class="math">\(\theta'(0) =
0\)</span>.  Type <tt class="docutils literal"><span class="pre">P[0].show()</span></tt> to plot the solution,
<tt class="docutils literal"><span class="pre">(P[0]+P[1]).show()</span></tt> to plot <span class="math">\((t,\theta(t))\)</span> and
<span class="math">\((t,\theta'(t))\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">z</span> <span class="p">:</span> <span class="n">z</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="n">g</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">z</span> <span class="p">:</span> <span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">eulers_method_2x2_plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="wester.html"
                                  title="previous chapter">Further examples from Wester&#8217;s paper</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="../gsl/dwt.html"
                                  title="next chapter">Discrete Wavelet Transform</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../_sources/sage/calculus/desolvers.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../gsl/dwt.html" title="Discrete Wavelet Transform"
             >next</a> |</li>
        <li class="right" >
          <a href="wester.html" title="Further examples from Wester’s paper"
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../index.html">Symbolic Calculus</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer">
        &copy; Copyright 2005--2016, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>