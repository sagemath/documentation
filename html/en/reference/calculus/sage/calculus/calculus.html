<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Symbolic Computation &mdash; Sage Reference Manual v6.7: Symbolic Calculus</title>
    
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '6.7',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v6.7: Symbolic Calculus" href="../../index.html" />
    <link rel="next" title="Units of measurement" href="../symbolic/units.html" />
    <link rel="prev" title="Symbolic Equations and Inequalities" href="../symbolic/relation.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../symbolic/units.html" title="Units of measurement"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../symbolic/relation.html" title="Symbolic Equations and Inequalities"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../index.html">Symbolic Calculus</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="symbolic-computation">
<span id="sage-calculus-calculus"></span><h1>Symbolic Computation<a class="headerlink" href="#symbolic-computation" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.calculus.calculus"></span><p>AUTHORS:</p>
<ul class="simple">
<li>Bobby Moretti and William Stein (2006-2007)</li>
<li>Robert Bradshaw (2007-10): minpoly(), numerical algorithm</li>
<li>Robert Bradshaw (2008-10): minpoly(), algebraic algorithm</li>
<li>Golam Mortuza Hossain (2009-06-15): _limit_latex()</li>
<li>Golam Mortuza Hossain (2009-06-22): _laplace_latex(), _inverse_laplace_latex()</li>
<li>Tom Coates (2010-06-11): fixed Trac #9217</li>
</ul>
<p>The Sage calculus module is loosely based on the Sage Enhancement
Proposal found at: <a class="reference external" href="http://www.sagemath.org:9001/CalculusSEP">http://www.sagemath.org:9001/CalculusSEP</a>.</p>
<p>EXAMPLES:</p>
<p>The basic units of the calculus package are symbolic expressions which
are elements of the symbolic expression ring (SR). To create a
symbolic variable object in Sage, use the <a class="reference internal" href="var.html#sage.calculus.var.var" title="sage.calculus.var.var"><tt class="xref py py-func docutils literal"><span class="pre">var()</span></tt></a> function, whose
argument is the text of that variable. Note that Sage is intelligent
about LaTeXing variable names.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x1</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;x1&#39;</span><span class="p">);</span> <span class="n">x1</span>
<span class="go">x1</span>
<span class="gp">sage: </span><span class="n">latex</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<span class="go">x_{1}</span>
<span class="gp">sage: </span><span class="n">theta</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;theta&#39;</span><span class="p">);</span> <span class="n">theta</span>
<span class="go">theta</span>
<span class="gp">sage: </span><span class="n">latex</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="go">\theta</span>
</pre></div>
</div>
<p>Sage predefines <tt class="docutils literal"><span class="pre">x</span></tt> to be a global indeterminate.
Thus the following works:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="go">x^2</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">&lt;type &#39;sage.symbolic.expression.Expression&#39;&gt;</span>
</pre></div>
</div>
<p>More complicated expressions in Sage can be built up using ordinary
arithmetic. The following are valid, and follow the rules of Python
arithmetic: (The &#8216;=&#8217; operator represents assignment, and not
equality)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;x,y,z&#39;</span><span class="p">)</span>
<span class="go">(x, y, z)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="o">/</span><span class="mi">55</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">^</span><span class="n">f</span><span class="p">;</span> <span class="n">g</span>
<span class="go">(x + y + 1/2*z/sin(1/55*y*z))^(x + y + 1/2*z/sin(1/55*y*z))</span>
</pre></div>
</div>
<p>Differentiation and integration are available, but behind the
scenes through Maxima:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">2*sin(x)*sin(2*y)/cos(2*y)^2</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="n">g</span>
<span class="go">-cos(x)/cos(2*y)</span>
</pre></div>
</div>
<p>Note that these methods usually require an explicit variable name. If none
is given, Sage will try to find one for you.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">()</span>
<span class="go">cos(x)</span>
</pre></div>
</div>
<p>If the expression is a callable symbolic expression (i.e., the
variable order is specified), then Sage can calculate the matrix
derivative (i.e., the gradient, Jacobian matrix, etc.) if no variables
are specified.  In the example below, we use the second derivative
test to determine that there is a saddle point at (0,-1/2).</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">=</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span> <span class="c"># gradient</span>
<span class="go">(x, y) |--&gt; (2*x*y, x^2 + 2*y + 1)</span>
<span class="gp">sage: </span><span class="n">solve</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">()),[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
<span class="go">[[x == -I, y == 0], [x == I, y == 0], [x == 0, y == (-1/2)]]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">H</span>  <span class="c"># Hessian matrix</span>
<span class="go">[(x, y) |--&gt; 2*y (x, y) |--&gt; 2*x]</span>
<span class="go">[(x, y) |--&gt; 2*x   (x, y) |--&gt; 2]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="o">=-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[-1  0]</span>
<span class="go">[ 0  2]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="o">=-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()</span>
<span class="go">[-1, 2]</span>
</pre></div>
</div>
<p>Here we calculate the Jacobian for the polar coordinate transformation:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">T</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">theta</span><span class="p">)</span><span class="o">=</span><span class="p">[</span><span class="n">r</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span><span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">T</span>
<span class="go">(r, theta) |--&gt; (r*cos(theta), r*sin(theta))</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span> <span class="c"># Jacobian matrix</span>
<span class="go">[   (r, theta) |--&gt; cos(theta) (r, theta) |--&gt; -r*sin(theta)]</span>
<span class="go">[   (r, theta) |--&gt; sin(theta)  (r, theta) |--&gt; r*cos(theta)]</span>
<span class="gp">sage: </span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="c"># Jacobian matrix</span>
<span class="go">[   (r, theta) |--&gt; cos(theta) (r, theta) |--&gt; -r*sin(theta)]</span>
<span class="go">[   (r, theta) |--&gt; sin(theta)  (r, theta) |--&gt; r*cos(theta)]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">det</span><span class="p">()</span> <span class="c"># Jacobian</span>
<span class="go">(r, theta) |--&gt; r*cos(theta)^2 + r*sin(theta)^2</span>
</pre></div>
</div>
<p>When the order of variables is ambiguous, Sage will raise an
exception when differentiating:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">);</span> <span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">ValueError</span>: <span class="n-Identifier">No differentiation variable specified.</span>
</pre></div>
</div>
<p>Simplifying symbolic sums is also possible, using the
sum command, which also uses Maxima in the background:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">k</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;k, m&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">k</span><span class="o">^</span><span class="mi">4</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>
<span class="go">1/90*pi^4</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">k</span><span class="p">),</span> <span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="go">2^m</span>
</pre></div>
</div>
<p>Symbolic matrices can be used as well in various ways,
including exponentiation:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">^</span><span class="mi">2</span>
<span class="go">[x^2 + x   2*x^3]</span>
<span class="go">[      2 x^2 + x]</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">^</span><span class="n">M</span>
<span class="go">[          1/2*(e^(2*sqrt(x)) + 1)*e^(x - sqrt(x)) 1/2*(x*e^(2*sqrt(x)) - x)*sqrt(x)*e^(x - sqrt(x))]</span>
<span class="go">[  1/2*(e^(2*sqrt(x)) - 1)*e^(x - sqrt(x))/x^(3/2)           1/2*(e^(2*sqrt(x)) + 1)*e^(x - sqrt(x))]</span>
</pre></div>
</div>
<p>And complex exponentiation works now:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">matrix</span><span class="p">([[</span><span class="n">pi</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">^</span><span class="n">M</span>
<span class="go">[-1]</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">matrix</span><span class="p">([[</span><span class="n">pi</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">^</span><span class="n">M</span>
<span class="go">[-1  0]</span>
<span class="go">[ 0  1]</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="n">pi</span><span class="p">],[</span><span class="o">-</span><span class="n">pi</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">^</span><span class="n">M</span>
<span class="go">[-1  0]</span>
<span class="go">[ 0 -1]</span>
</pre></div>
</div>
<p>Substitution works similarly. We can substitute with a python
dict:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">({</span><span class="n">x</span><span class="p">:</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;t&#39;</span><span class="p">),</span> <span class="n">y</span><span class="p">:</span> <span class="n">z</span><span class="p">})</span>
<span class="go">sin(t*z - z)</span>
</pre></div>
</div>
<p>Also we can substitute with keywords:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">z</span><span class="p">)</span>
<span class="go">sin(t*z - z)</span>
</pre></div>
</div>
<p>It was formerly the case that if there was no ambiguity of variable
names, we didn&#8217;t have to specify them; that still works for the moment,
but the behavior is deprecated:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">doctest:...: DeprecationWarning: Substitution using function-call</span>
<span class="go">syntax and unnamed arguments is deprecated and will be removed</span>
<span class="go">from a future release of Sage; you can use named arguments instead,</span>
<span class="go">like EXPR(x=..., y=...)</span>
<span class="go">See http://trac.sagemath.org/5930 for details.</span>
<span class="go">sin(y)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>However if there is ambiguity, we should explicitly state what
variables we&#8217;re substituting for:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="go">sin(8*pi/y)</span>
</pre></div>
</div>
<p>We can also make a <tt class="docutils literal"><span class="pre">CallableSymbolicExpression</span></tt>,
which is a <tt class="docutils literal"><span class="pre">SymbolicExpression</span></tt> that is a function of
specified variables in a fixed order. Each
<tt class="docutils literal"><span class="pre">SymbolicExpression</span></tt> has a
<tt class="docutils literal"><span class="pre">function(...)</span></tt> method that is used to create a
<tt class="docutils literal"><span class="pre">CallableSymbolicExpression</span></tt>, as illustrated below:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">log</span><span class="p">((</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">y</span><span class="o">+</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span> <span class="n">f</span>
<span class="go">(x, y) |--&gt; log(-(x - 2)/(y + 5))</span>
</pre></div>
</div>
<p>There is an easier way of creating a
<tt class="docutils literal"><span class="pre">CallableSymbolicExpression</span></tt>, which relies on the
Sage preparser.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">);</span> <span class="n">f</span>
<span class="go">(x, y) |--&gt; cos(y)*log(x)</span>
</pre></div>
</div>
<p>Then we have fixed an order of variables and there is no ambiguity
substituting or evaluating:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">log</span><span class="p">((</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">y</span><span class="o">+</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="go">log(-5/(t + 5))</span>
</pre></div>
</div>
<p>Some further examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span>
<span class="go">5*sin(x)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">5*sin(2)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">pi</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="nb">float</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">pi</span><span class="p">))</span>
<span class="go">0.0</span>
</pre></div>
</div>
<p>Another example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">9</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="n">x</span><span class="p">);</span> <span class="n">f</span>
<span class="go">arcsinh(1/3*x)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">arcsinh(1)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">1/3/sqrt(1/9*x^2 + 1)</span>
</pre></div>
</div>
<p>We compute the length of the parabola from 0 to 2:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">dy</span> <span class="o">=</span> <span class="n">derivative</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">integral</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">dy</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span>
<span class="go">sqrt(17) + 1/4*arcsinh(4)</span>
<span class="gp">sage: </span><span class="n">n</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
<span class="go">4.6467837624329358733826155674904591885104869874232887508703</span>
<span class="gp">sage: </span><span class="nb">float</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="go">4.646783762432936</span>
</pre></div>
</div>
<p>We test pickling:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;x,y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="nb">bool</span><span class="p">(</span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">f</span><span class="p">))</span> <span class="o">==</span> <span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Coercion examples:</p>
<p>We coerce various symbolic expressions into the complex numbers:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">CC</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="go">1.00000000000000*I</span>
<span class="gp">sage: </span><span class="n">CC</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="p">)</span>
<span class="go">2.00000000000000*I</span>
<span class="gp">sage: </span><span class="n">ComplexField</span><span class="p">(</span><span class="mi">200</span><span class="p">)(</span><span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="p">)</span>
<span class="go">2.0000000000000000000000000000000000000000000000000000000000*I</span>
<span class="gp">sage: </span><span class="n">ComplexField</span><span class="p">(</span><span class="mi">200</span><span class="p">)(</span><span class="n">sin</span><span class="p">(</span><span class="n">I</span><span class="p">))</span>
<span class="go">1.1752011936438014568823818505956008151557179813340958702296*I</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">I</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span> <span class="n">f</span>
<span class="go">cos(1/2*I) + sin(I)</span>
<span class="gp">sage: </span><span class="n">CC</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">1.12762596520638 + 1.17520119364380*I</span>
<span class="gp">sage: </span><span class="n">ComplexField</span><span class="p">(</span><span class="mi">200</span><span class="p">)(</span><span class="n">f</span><span class="p">)</span>
<span class="go">1.1276259652063807852262251614026720125478471180986674836290 + 1.1752011936438014568823818505956008151557179813340958702296*I</span>
<span class="gp">sage: </span><span class="n">ComplexField</span><span class="p">(</span><span class="mi">100</span><span class="p">)(</span><span class="n">f</span><span class="p">)</span>
<span class="go">1.1276259652063807852262251614 + 1.1752011936438014568823818506*I</span>
</pre></div>
</div>
<p>We illustrate construction of an inverse sum where each denominator
has a new variable name:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">var</span><span class="p">(</span><span class="s">&#39;n</span><span class="si">%s</span><span class="s">&#39;</span><span class="o">%</span><span class="n">i</span><span class="p">)</span><span class="o">^</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f</span>
<span class="go">1/n1 + 1/n2^2 + 1/n3^3 + 1/n4^4 + 1/n5^5 + 1/n6^6 + 1/n7^7 + 1/n8^8 + 1/n9^9 + 1</span>
</pre></div>
</div>
<p>Note that after calling var, the variables are immediately
available for use:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="p">(</span><span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span><span class="p">)</span><span class="o">^</span><span class="mi">5</span>
<span class="go">(n1 + n2)^5</span>
</pre></div>
</div>
<p>We can, of course, substitute:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">n9</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">n7</span><span class="o">=</span><span class="n">n6</span><span class="p">)</span>
<span class="go">1/n1 + 1/n2^2 + 1/n3^3 + 1/n4^4 + 1/n5^5 + 1/n6^6 + 1/n6^7 + 1/n8^8 + 387420490/387420489</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Substitution:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">5</span>
</pre></div>
</div>
<p>Simplifying expressions involving scientific notation:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;k&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a0</span> <span class="o">=</span> <span class="mf">2e-06</span><span class="p">;</span> <span class="n">a1</span> <span class="o">=</span> <span class="mi">12</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">a1</span> <span class="o">+</span> <span class="n">a0</span><span class="o">*</span><span class="n">k</span><span class="p">;</span> <span class="n">c</span>
<span class="go">(2.00000000000000e-6)*k + 12</span>
<span class="gp">sage: </span><span class="n">sqrt</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">sqrt((2.00000000000000e-6)*k + 12)</span>
<span class="gp">sage: </span><span class="n">sqrt</span><span class="p">(</span><span class="n">c</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="go">sqrt(((2.00000000000000e-6)*k + 12)^3)</span>
</pre></div>
</div>
<p>The symbolic calculus package uses its own copy of Maxima for
simplification, etc., which is separate from the default
system-wide version:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">maxima</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s">&#39;[x,y]: [1,2]&#39;</span><span class="p">)</span>
<span class="go">&#39;[1,2]&#39;</span>
<span class="gp">sage: </span><span class="n">maxima</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s">&#39;expand((x+y)^3)&#39;</span><span class="p">)</span>
<span class="go">&#39;27&#39;</span>
</pre></div>
</div>
<p>If the copy of maxima used by the symbolic calculus package were
the same as the default one, then the following would return 27,
which would be very confusing indeed!</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;x,y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">expand</span><span class="p">((</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="go">x^3 + 3*x^2*y + 3*x*y^2 + y^3</span>
</pre></div>
</div>
<p>Set x to be 5 in maxima:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">maxima</span><span class="p">(</span><span class="s">&#39;x: 5&#39;</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">maxima</span><span class="p">(</span><span class="s">&#39;x + x + %pi&#39;</span><span class="p">)</span>
<span class="go">%pi+10</span>
</pre></div>
</div>
<p>Simplifications like these are now done using Pynac:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">pi</span>
<span class="go">pi + 2*x</span>
</pre></div>
</div>
<p>But this still uses Maxima:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">pi</span><span class="p">)</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="go">pi + 2*x</span>
</pre></div>
</div>
<p>Note that <tt class="docutils literal"><span class="pre">x</span></tt> is still <tt class="docutils literal"><span class="pre">x</span></tt>, since the
maxima used by the calculus package is different than the one in
the interactive interpreter.</p>
<p>Check to see that the problem with the variables method mentioned
in <a class="reference external" href="http://trac.sagemath.org/3779">trac ticket #3779</a> is actually fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s">&#39;F&#39;</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="o">*</span><span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">x</span><span class="p">)</span>
<span class="go">D[0](F)(x)</span>
</pre></div>
</div>
<p>Doubly ensure that <a class="reference external" href="http://trac.sagemath.org/7479">trac ticket #7479</a> is working:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">=</span><span class="n">x</span>
<span class="gp">sage: </span><span class="n">integrate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1/2</span>
</pre></div>
</div>
<p>Check that the problem with Taylor expansions of the gamma function
(<a class="reference external" href="http://trac.sagemath.org/9217">trac ticket #9217</a>) is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">taylor</span><span class="p">(</span><span class="n">gamma</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="o">+</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">-1/432*((72*euler_gamma^3 + 36*euler_gamma^2*(sqrt(3)*pi + 9*log(3)) +</span>
<span class="go">27*pi^2*log(3) + 243*log(3)^3 + 18*euler_gamma*(6*sqrt(3)*pi*log(3) + pi^2</span>
<span class="go">+ 27*log(3)^2 + 12*psi(1, 1/3)) + 324*log(3)*psi(1, 1/3) + sqrt(3)*(pi^3 +</span>
<span class="go">9*pi*(9*log(3)^2 + 4*psi(1, 1/3))))*gamma(1/3) - 72*psi(2,</span>
<span class="go">1/3)*gamma(1/3))*x^3 + 1/24*(6*sqrt(3)*pi*log(3) + 12*euler_gamma^2 + pi^2</span>
<span class="go">+ 4*euler_gamma*(sqrt(3)*pi + 9*log(3)) + 27*log(3)^2 + 12*psi(1,</span>
<span class="go">1/3))*x^2*gamma(1/3) - 1/6*(6*euler_gamma + sqrt(3)*pi +</span>
<span class="go">9*log(3))*x*gamma(1/3) + gamma(1/3)</span>
<span class="gp">sage: </span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">f</span><span class="p">:</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">n</span><span class="p">(),</span> <span class="n">_</span><span class="o">.</span><span class="n">coefficients</span><span class="p">())</span>  <span class="c"># numerical coefficients to make comparison easier; Maple 12 gives same answer</span>
<span class="go">[2.6789385347..., -8.3905259853..., 26.662447494..., -80.683148377...]</span>
</pre></div>
</div>
<p>Ensure that ticket #8582 is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&quot;k&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">k</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="n">k</span><span class="p">,</span> <span class="o">-</span><span class="n">oo</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>
<span class="go">-1/2*I*psi(I + 1) + 1/2*I*psi(-I + 1) - 1/2*I*psi(I) + 1/2*I*psi(-I)</span>
</pre></div>
</div>
<p>Ensure that ticket #8624 is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">integrate</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">pi</span><span class="p">)</span>
<span class="go">1/2</span>
<span class="gp">sage: </span><span class="n">integrate</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span>
<span class="go">2*pi</span>
</pre></div>
</div>
<dl class="function">
<dt id="sage.calculus.calculus.at">
<tt class="descclassname">sage.calculus.calculus.</tt><tt class="descname">at</tt><big>(</big><em>ex</em>, <em>*args</em>, <em>**kwds</em><big>)</big><a class="headerlink" href="#sage.calculus.calculus.at" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses <tt class="docutils literal"><span class="pre">at</span></tt> formulations from other systems, such as Maxima.
Replaces evaluation &#8216;at&#8217; a point with substitution method of
a symbolic expression.</p>
<p>EXAMPLES:</p>
<p>We do not import <tt class="docutils literal"><span class="pre">at</span></tt> at the top level, but we can use it
as a synonym for substitution if we import it:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.calculus</span> <span class="kn">import</span> <span class="n">at</span>
<span class="gp">sage: </span><span class="n">at</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">-2</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">-2</span>
</pre></div>
</div>
<p>We find a formal Taylor expansion:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">h</span><span class="p">,</span><span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;h,x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s">&#39;u&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">h</span><span class="p">)</span>
<span class="go">u(h + x)</span>
<span class="gp">sage: </span><span class="n">diff</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
<span class="go">D[0](u)(h + x)</span>
<span class="gp">sage: </span><span class="n">taylor</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">),</span><span class="n">h</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="go">1/24*h^4*D[0, 0, 0, 0](u)(x) + 1/6*h^3*D[0, 0, 0](u)(x) + 1/2*h^2*D[0, 0](u)(x) + h*D[0](u)(x) + u(x)</span>
</pre></div>
</div>
<p>We compute a Laplace transform:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;s,t&#39;</span><span class="p">)</span>
<span class="go">(s, t)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">=</span><span class="n">function</span><span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">D[0, 0](f)(t)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">s</span><span class="p">)</span>
<span class="go">s^2*laplace(f(t), t, s) - s*f(0) - D[0](f)(0)</span>
</pre></div>
</div>
<p>We can also accept a non-keyword list of expression substitutions,
like Maxima does (<a class="reference external" href="http://trac.sagemath.org/12796">trac ticket #12796</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.calculus</span> <span class="kn">import</span> <span class="n">at</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">at</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">[</span><span class="n">x</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span>
<span class="go">f(1)</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Our one non-keyword argument must be a list:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.calculus</span> <span class="kn">import</span> <span class="n">at</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">at</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">TypeError</span>: <span class="n-Identifier">at can take at most one argument, which must be a list</span>
</pre></div>
</div>
<p>We should convert our first argument to a symbolic expression:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.calculus</span> <span class="kn">import</span> <span class="n">at</span>
<span class="gp">sage: </span><span class="n">at</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.calculus.calculus.dummy_diff">
<tt class="descclassname">sage.calculus.calculus.</tt><tt class="descname">dummy_diff</tt><big>(</big><em>*args</em><big>)</big><a class="headerlink" href="#sage.calculus.calculus.dummy_diff" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is called when &#8216;diff&#8217; appears in a Maxima string.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.calculus</span> <span class="kn">import</span> <span class="n">dummy_diff</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;x,y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">dummy_diff</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">SR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">y</span><span class="p">,</span> <span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">-x*y^2*cos(x*y) - 2*y*sin(x*y)</span>
</pre></div>
</div>
<p>Here the function is used implicitly:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s">&#39;cr&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">a</span><span class="p">);</span> <span class="n">g</span>
<span class="go">D[0](cr)(a)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.calculus.calculus.dummy_integrate">
<tt class="descclassname">sage.calculus.calculus.</tt><tt class="descname">dummy_integrate</tt><big>(</big><em>*args</em><big>)</big><a class="headerlink" href="#sage.calculus.calculus.dummy_integrate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is called to create formal wrappers of integrals that
Maxima can&#8217;t compute:</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.calculus</span> <span class="kn">import</span> <span class="n">dummy_integrate</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">dummy_integrate</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
<span class="go">integrate(f(x), x)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;a,b&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">dummy_integrate</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="go">integrate(f(x), x, a, b)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.calculus.calculus.dummy_inverse_laplace">
<tt class="descclassname">sage.calculus.calculus.</tt><tt class="descname">dummy_inverse_laplace</tt><big>(</big><em>*args</em><big>)</big><a class="headerlink" href="#sage.calculus.calculus.dummy_inverse_laplace" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is called to create formal wrappers of inverse laplace
transforms that Maxima can&#8217;t compute:</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.calculus</span> <span class="kn">import</span> <span class="n">dummy_inverse_laplace</span>
<span class="gp">sage: </span><span class="n">s</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;s,t&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s">&#39;F&#39;</span><span class="p">,</span><span class="n">s</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">dummy_inverse_laplace</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="n">s</span><span class="p">),</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="go">ilt(F(s), s, t)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.calculus.calculus.dummy_laplace">
<tt class="descclassname">sage.calculus.calculus.</tt><tt class="descname">dummy_laplace</tt><big>(</big><em>*args</em><big>)</big><a class="headerlink" href="#sage.calculus.calculus.dummy_laplace" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is called to create formal wrappers of laplace transforms
that Maxima can&#8217;t compute:</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.calculus</span> <span class="kn">import</span> <span class="n">dummy_laplace</span>
<span class="gp">sage: </span><span class="n">s</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;s,t&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">dummy_laplace</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">t</span><span class="p">,</span><span class="n">s</span><span class="p">)</span>
<span class="go">laplace(f(t), t, s)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.calculus.calculus.dummy_limit">
<tt class="descclassname">sage.calculus.calculus.</tt><tt class="descname">dummy_limit</tt><big>(</big><em>*args</em><big>)</big><a class="headerlink" href="#sage.calculus.calculus.dummy_limit" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is called to create formal wrappers of limits that
Maxima can&#8217;t compute:</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">lim</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">erf</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">x</span><span class="o">=</span><span class="n">infinity</span><span class="p">);</span> <span class="n">a</span>
<span class="go">-limit((erf(x) - 1)*e^(x^2), x, +Infinity)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">dummy_limit</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span><span class="n">a</span>
<span class="go">limit(sin(x)/x, x, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.calculus.calculus.inverse_laplace">
<tt class="descclassname">sage.calculus.calculus.</tt><tt class="descname">inverse_laplace</tt><big>(</big><em>ex</em>, <em>t</em>, <em>s</em><big>)</big><a class="headerlink" href="#sage.calculus.calculus.inverse_laplace" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempts to compute the inverse Laplace transform of
<tt class="docutils literal"><span class="pre">self</span></tt> with respect to the variable <span class="math">\(t\)</span> and
transform parameter <span class="math">\(s\)</span>. If this function cannot find a
solution, a formal function is returned.</p>
<p>The function that is returned may be be viewed as a function of
<span class="math">\(s\)</span>.</p>
<p>DEFINITION: The inverse Laplace transform of a function
<span class="math">\(F(s)\)</span>, is the function <span class="math">\(f(t)\)</span> defined by</p>
<div class="math">
\[F(s) = \frac{1}{2\pi i} \int_{\gamma-i\infty}^{\gamma + i\infty} e^{st} F(s) dt,\]</div>
<p>where <span class="math">\(\gamma\)</span> is chosen so that the contour path of
integration is in the region of convergence of <span class="math">\(F(s)\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;w, m&#39;</span><span class="p">)</span>
<span class="go">(w, m)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">w</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">inverse_laplace</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">m</span><span class="p">);</span> <span class="n">f</span>
<span class="go">1/10*sqrt(10)*sin(sqrt(10)*m)</span>
<span class="gp">sage: </span><span class="n">laplace</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<span class="go">1/(w^2 + 10)</span>

<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;s&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">laplace</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span> <span class="n">L</span>
<span class="go">t |--&gt; 2*s^2/(s^2 + 1)^2 - 1/(s^2 + 1)</span>
<span class="gp">sage: </span><span class="n">inverse_laplace</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="go">t |--&gt; t*cos(t)</span>
<span class="gp">sage: </span><span class="n">inverse_laplace</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">s</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="go">1/3*(sqrt(3)*sin(1/2*sqrt(3)*t) - cos(1/2*sqrt(3)*t))*e^(1/2*t) + 1/3*e^(-t)</span>
</pre></div>
</div>
<p>No explicit inverse Laplace transform, so one is returned formally
as a function <tt class="docutils literal"><span class="pre">ilt</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">inverse_laplace</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="go">ilt(cos(s), s, t)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.calculus.calculus.laplace">
<tt class="descclassname">sage.calculus.calculus.</tt><tt class="descname">laplace</tt><big>(</big><em>ex</em>, <em>t</em>, <em>s</em><big>)</big><a class="headerlink" href="#sage.calculus.calculus.laplace" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempts to compute and return the Laplace transform of
<tt class="docutils literal"><span class="pre">self</span></tt> with respect to the variable <span class="math">\(t\)</span> and
transform parameter <span class="math">\(s\)</span>. If this function cannot find a
solution, a formal function is returned.</p>
<p>The function that is returned may be be viewed as a function of
<span class="math">\(s\)</span>.</p>
<p>DEFINITION:</p>
<p>The Laplace transform of a function <span class="math">\(f(t)\)</span>,
defined for all real numbers <span class="math">\(t \geq 0\)</span>, is the function
<span class="math">\(F(s)\)</span> defined by</p>
<div class="math">
\[F(s) = \int_{0}^{\infty} e^{-st} f(t) dt.\]</div>
<p>EXAMPLES:</p>
<p>We compute a few Laplace transforms:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;x, s, z, t, t0&#39;</span><span class="p">)</span>
<span class="go">(x, s, z, t, t0)</span>
<span class="gp">sage: </span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="go">1/(s^2 + 1)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">z</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="go">z/s + 1/(s - 1)</span>
<span class="gp">sage: </span><span class="n">log</span><span class="p">(</span><span class="n">t</span><span class="o">/</span><span class="n">t0</span><span class="p">)</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="go">-(euler_gamma + log(s) + log(t0))/s</span>
</pre></div>
</div>
<p>We do a formal calculation:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="n">g</span>
<span class="go">D[0](f)(x)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="go">s*laplace(f(x), x, s) - f(0)</span>
</pre></div>
</div>
<p>EXAMPLES:</p>
<p>A BATTLE BETWEEN the X-women and the Y-men (by David
Joyner): Solve</p>
<div class="math">
\[x' = -16y, x(0)=270,  y' = -x + 1, y(0) = 90.\]</div>
<p>This models a fight between two sides, the &#8220;X-women&#8221; and the
&#8220;Y-men&#8221;, where the X-women have 270 initially and the Y-men have
90, but the Y-men are better at fighting, because of the higher
factor of &#8220;-16&#8221; vs &#8220;-1&#8221;, and also get an occasional reinforcement,
because of the &#8220;+1&#8221; term.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;t&#39;</span><span class="p">)</span>
<span class="go">t</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;t&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">de1</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mi">16</span><span class="o">*</span><span class="n">y</span>
<span class="gp">sage: </span><span class="n">de2</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">de1</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="go">s*laplace(x(t), t, s) + 16*laplace(y(t), t, s) - x(0)</span>
<span class="gp">sage: </span><span class="n">de2</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="go">s*laplace(y(t), t, s) - 1/s + laplace(x(t), t, s) - y(0)</span>
</pre></div>
</div>
<p>Next we form the augmented matrix of the above system:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="n">s</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">270</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="mi">90</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="n">s</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">xt</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">inverse_laplace</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">yt</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">inverse_laplace</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">xt</span>
<span class="go">-91/2*e^(4*t) + 629/2*e^(-4*t) + 1</span>
<span class="gp">sage: </span><span class="n">yt</span>
<span class="go">91/8*e^(4*t) + 629/8*e^(-4*t)</span>
<span class="gp">sage: </span><span class="n">p1</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">xt</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">p2</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">yt</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">p1</span><span class="o">+</span><span class="n">p2</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SAGE_TMP</span><span class="p">,</span> <span class="s">&quot;de_plot.png&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>Another example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a,s,t&#39;</span><span class="p">)</span>
<span class="go">(a, s, t)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">exp</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">;</span> <span class="n">f</span>
<span class="go">t*e^(a + 2*t)*sin(t)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">laplace</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span> <span class="n">L</span>
<span class="go">2*(s - 2)*e^a/(s^2 - 4*s + 5)^2</span>
<span class="gp">sage: </span><span class="n">inverse_laplace</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="go">t*e^(a + 2*t)*sin(t)</span>
</pre></div>
</div>
<p>Unable to compute solution:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">laplace</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="go">laplace(1/s, s, t)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.calculus.calculus.lim">
<tt class="descclassname">sage.calculus.calculus.</tt><tt class="descname">lim</tt><big>(</big><em>ex</em>, <em>dir=None</em>, <em>taylor=False</em>, <em>algorithm='maxima'</em>, <em>**argv</em><big>)</big><a class="headerlink" href="#sage.calculus.calculus.lim" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the limit as the variable <span class="math">\(v\)</span> approaches <span class="math">\(a\)</span>
from the given direction.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">expr</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">a</span><span class="p">)</span>
<span class="n">expr</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&#39;above&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">dir</span></tt> - (default: None); dir may have the value
&#8216;plus&#8217; (or &#8216;+&#8217; or &#8216;right&#8217;) for a limit from above,
&#8216;minus&#8217; (or &#8216;-&#8216; or &#8216;left&#8217;) for a limit from below, or may be omitted
(implying a two-sided limit is to be computed).</li>
<li><tt class="docutils literal"><span class="pre">taylor</span></tt> - (default: False); if True, use Taylor
series, which allows more limits to be computed (but may also
crash in some obscure cases due to bugs in Maxima).</li>
<li><tt class="docutils literal"><span class="pre">**argv</span></tt> - 1 named parameter</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The output may also use &#8216;und&#8217; (undefined), &#8216;ind&#8217;
(indefinite but bounded), and &#8216;infinity&#8217; (complex
infinity).</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="n">x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">oo</span><span class="p">)</span>
<span class="go">e</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">7776/3125</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="go">2.06961575467...</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">I</span><span class="p">,</span> <span class="n">taylor</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(-I + 1)^I</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">1.2</span><span class="p">)</span>
<span class="go">2.0696157546720...</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">I</span><span class="p">)</span>
<span class="go">(-I + 1)^I</span>
<span class="gp">sage: </span><span class="n">CDF</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">I</span><span class="p">))</span>
<span class="go">2.0628722350809046 + 0.7450070621797239*I</span>
<span class="gp">sage: </span><span class="n">CDF</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">I</span><span class="p">))</span>
<span class="go">2.0628722350809046 + 0.7450070621797239*I</span>
</pre></div>
</div>
<p>Notice that Maxima may ask for more information:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="go">a</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="n">a</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">ValueError</span>: <span class="n-Identifier">Computation failed since Maxima requested additional</span>
<span class="go">constraints; using the &#39;assume&#39; command before evaluation</span>
<span class="go">*may* help (example of legal syntax is &#39;assume(a&gt;0)&#39;, see</span>
<span class="go">`assume?` for more details)</span>
<span class="go">Is a positive, negative or zero?</span>
</pre></div>
</div>
<p>With this example, Maxima is looking for a LOT of information:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">a</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="n">a</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">ValueError</span>: <span class="n-Identifier">Computation failed since Maxima requested additional</span>
<span class="go">constraints; using the &#39;assume&#39; command before evaluation *may* help</span>
<span class="go">(example of legal syntax is &#39;assume(a&gt;0)&#39;, see `assume?` for</span>
<span class="go"> more details)</span>
<span class="go">Is a an integer?</span>
<span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="s">&#39;integer&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="n">a</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">ValueError</span>: <span class="n-Identifier">Computation failed since Maxima requested additional</span>
<span class="go">constraints; using the &#39;assume&#39; command before evaluation *may* help</span>
<span class="go">(example of legal syntax is &#39;assume(a&gt;0)&#39;, see `assume?` for</span>
<span class="go"> more details)</span>
<span class="go">Is a an even number?</span>
<span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="s">&#39;even&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="n">a</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">forget</span><span class="p">()</span>
</pre></div>
</div>
<p>More examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&#39;+&#39;</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">((</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">e</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="n">x</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">oo</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="n">x</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">oo</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="o">-</span><span class="n">e</span><span class="o">^</span><span class="n">x</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">oo</span><span class="p">)</span>
<span class="go">-Infinity</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">((</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">oo</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">sec</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">-Infinity</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&#39;right&#39;</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">)</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">forget</span><span class="p">();</span> <span class="n">assume</span><span class="p">(</span><span class="n">x</span><span class="o">&lt;-</span><span class="mi">2</span><span class="p">);</span> <span class="n">lim</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">taylor</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">forget</span><span class="p">()</span>
</pre></div>
</div>
<p>Here ind means &#8220;indefinite but bounded&#8221;:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">ind</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&#39;nugget&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">ValueError</span>: <span class="n-Identifier">dir must be one of None, &#39;plus&#39;, &#39;+&#39;, &#39;right&#39;,</span>
<span class="go">&#39;minus&#39;, &#39;-&#39;, &#39;left&#39;</span>
</pre></div>
</div>
<p>We check that <a class="reference external" href="http://trac.sagemath.org/3718">trac ticket #3718</a> is fixed, so that
Maxima gives correct limits for the floor function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&#39;-&#39;</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&#39;+&#39;</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">und</span>
</pre></div>
</div>
<p>Maxima gives the right answer here, too, showing
that <a class="reference external" href="http://trac.sagemath.org/4142">trac ticket #4142</a> is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span> <span class="n">g</span>
<span class="go">-x/sqrt(-x^2 + 1)</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&#39;-&#39;</span><span class="p">)</span>
<span class="go">-Infinity</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Infinity</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&#39;+&#39;</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&#39;-&#39;</span><span class="p">)</span>
<span class="go">-Infinity</span>
</pre></div>
</div>
<p>Check that <a class="reference external" href="http://trac.sagemath.org/8942">trac ticket #8942</a> is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">tan</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="o">+</span><span class="n">x</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span> <span class="o">=</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&#39;minus&#39;</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span> <span class="o">=</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&#39;plus&#39;</span><span class="p">)</span>
<span class="go">-Infinity</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span> <span class="o">=</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="go">Infinity</span>
</pre></div>
</div>
<p>Check that we give deprecation warnings for &#8216;above&#8217; and &#8216;below&#8217;,
<a class="reference external" href="http://trac.sagemath.org/9200">trac ticket #9200</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&#39;above&#39;</span><span class="p">)</span>
<span class="go">doctest:...: DeprecationWarning: the keyword</span>
<span class="go">&#39;above&#39; is deprecated. Please use &#39;right&#39; or &#39;+&#39; instead.</span>
<span class="go">See http://trac.sagemath.org/9200 for details.</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&#39;below&#39;</span><span class="p">)</span>
<span class="go">doctest:...: DeprecationWarning: the keyword</span>
<span class="go">&#39;below&#39; is deprecated. Please use &#39;left&#39; or &#39;-&#39; instead.</span>
<span class="go">See http://trac.sagemath.org/9200 for details.</span>
<span class="go">-Infinity</span>
</pre></div>
</div>
<p>Check that <a class="reference external" href="http://trac.sagemath.org/12708">trac ticket #12708</a> is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">tanh</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Check that <a class="reference external" href="http://trac.sagemath.org/15386">trac ticket #15386</a> is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">n</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sequence</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="n">n</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">8</span><span class="o">*</span><span class="n">n</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">infinity</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.calculus.calculus.limit">
<tt class="descclassname">sage.calculus.calculus.</tt><tt class="descname">limit</tt><big>(</big><em>ex</em>, <em>dir=None</em>, <em>taylor=False</em>, <em>algorithm='maxima'</em>, <em>**argv</em><big>)</big><a class="headerlink" href="#sage.calculus.calculus.limit" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the limit as the variable <span class="math">\(v\)</span> approaches <span class="math">\(a\)</span>
from the given direction.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">expr</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">a</span><span class="p">)</span>
<span class="n">expr</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&#39;above&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">dir</span></tt> - (default: None); dir may have the value
&#8216;plus&#8217; (or &#8216;+&#8217; or &#8216;right&#8217;) for a limit from above,
&#8216;minus&#8217; (or &#8216;-&#8216; or &#8216;left&#8217;) for a limit from below, or may be omitted
(implying a two-sided limit is to be computed).</li>
<li><tt class="docutils literal"><span class="pre">taylor</span></tt> - (default: False); if True, use Taylor
series, which allows more limits to be computed (but may also
crash in some obscure cases due to bugs in Maxima).</li>
<li><tt class="docutils literal"><span class="pre">**argv</span></tt> - 1 named parameter</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The output may also use &#8216;und&#8217; (undefined), &#8216;ind&#8217;
(indefinite but bounded), and &#8216;infinity&#8217; (complex
infinity).</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="n">x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">oo</span><span class="p">)</span>
<span class="go">e</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">7776/3125</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="go">2.06961575467...</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">I</span><span class="p">,</span> <span class="n">taylor</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(-I + 1)^I</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">1.2</span><span class="p">)</span>
<span class="go">2.0696157546720...</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">I</span><span class="p">)</span>
<span class="go">(-I + 1)^I</span>
<span class="gp">sage: </span><span class="n">CDF</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">I</span><span class="p">))</span>
<span class="go">2.0628722350809046 + 0.7450070621797239*I</span>
<span class="gp">sage: </span><span class="n">CDF</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">I</span><span class="p">))</span>
<span class="go">2.0628722350809046 + 0.7450070621797239*I</span>
</pre></div>
</div>
<p>Notice that Maxima may ask for more information:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="go">a</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="n">a</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">ValueError</span>: <span class="n-Identifier">Computation failed since Maxima requested additional</span>
<span class="go">constraints; using the &#39;assume&#39; command before evaluation</span>
<span class="go">*may* help (example of legal syntax is &#39;assume(a&gt;0)&#39;, see</span>
<span class="go">`assume?` for more details)</span>
<span class="go">Is a positive, negative or zero?</span>
</pre></div>
</div>
<p>With this example, Maxima is looking for a LOT of information:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">a</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="n">a</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">ValueError</span>: <span class="n-Identifier">Computation failed since Maxima requested additional</span>
<span class="go">constraints; using the &#39;assume&#39; command before evaluation *may* help</span>
<span class="go">(example of legal syntax is &#39;assume(a&gt;0)&#39;, see `assume?` for</span>
<span class="go"> more details)</span>
<span class="go">Is a an integer?</span>
<span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="s">&#39;integer&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="n">a</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">ValueError</span>: <span class="n-Identifier">Computation failed since Maxima requested additional</span>
<span class="go">constraints; using the &#39;assume&#39; command before evaluation *may* help</span>
<span class="go">(example of legal syntax is &#39;assume(a&gt;0)&#39;, see `assume?` for</span>
<span class="go"> more details)</span>
<span class="go">Is a an even number?</span>
<span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="s">&#39;even&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="n">a</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">forget</span><span class="p">()</span>
</pre></div>
</div>
<p>More examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&#39;+&#39;</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">((</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">e</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="n">x</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">oo</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="n">x</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">oo</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="o">-</span><span class="n">e</span><span class="o">^</span><span class="n">x</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">oo</span><span class="p">)</span>
<span class="go">-Infinity</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">((</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">oo</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">sec</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">-Infinity</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&#39;right&#39;</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">)</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">forget</span><span class="p">();</span> <span class="n">assume</span><span class="p">(</span><span class="n">x</span><span class="o">&lt;-</span><span class="mi">2</span><span class="p">);</span> <span class="n">lim</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">taylor</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">forget</span><span class="p">()</span>
</pre></div>
</div>
<p>Here ind means &#8220;indefinite but bounded&#8221;:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">ind</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&#39;nugget&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">ValueError</span>: <span class="n-Identifier">dir must be one of None, &#39;plus&#39;, &#39;+&#39;, &#39;right&#39;,</span>
<span class="go">&#39;minus&#39;, &#39;-&#39;, &#39;left&#39;</span>
</pre></div>
</div>
<p>We check that <a class="reference external" href="http://trac.sagemath.org/3718">trac ticket #3718</a> is fixed, so that
Maxima gives correct limits for the floor function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&#39;-&#39;</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&#39;+&#39;</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">und</span>
</pre></div>
</div>
<p>Maxima gives the right answer here, too, showing
that <a class="reference external" href="http://trac.sagemath.org/4142">trac ticket #4142</a> is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span> <span class="n">g</span>
<span class="go">-x/sqrt(-x^2 + 1)</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&#39;-&#39;</span><span class="p">)</span>
<span class="go">-Infinity</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Infinity</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&#39;+&#39;</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&#39;-&#39;</span><span class="p">)</span>
<span class="go">-Infinity</span>
</pre></div>
</div>
<p>Check that <a class="reference external" href="http://trac.sagemath.org/8942">trac ticket #8942</a> is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">tan</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="o">+</span><span class="n">x</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span> <span class="o">=</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&#39;minus&#39;</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span> <span class="o">=</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&#39;plus&#39;</span><span class="p">)</span>
<span class="go">-Infinity</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span> <span class="o">=</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="go">Infinity</span>
</pre></div>
</div>
<p>Check that we give deprecation warnings for &#8216;above&#8217; and &#8216;below&#8217;,
<a class="reference external" href="http://trac.sagemath.org/9200">trac ticket #9200</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&#39;above&#39;</span><span class="p">)</span>
<span class="go">doctest:...: DeprecationWarning: the keyword</span>
<span class="go">&#39;above&#39; is deprecated. Please use &#39;right&#39; or &#39;+&#39; instead.</span>
<span class="go">See http://trac.sagemath.org/9200 for details.</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&#39;below&#39;</span><span class="p">)</span>
<span class="go">doctest:...: DeprecationWarning: the keyword</span>
<span class="go">&#39;below&#39; is deprecated. Please use &#39;left&#39; or &#39;-&#39; instead.</span>
<span class="go">See http://trac.sagemath.org/9200 for details.</span>
<span class="go">-Infinity</span>
</pre></div>
</div>
<p>Check that <a class="reference external" href="http://trac.sagemath.org/12708">trac ticket #12708</a> is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">tanh</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Check that <a class="reference external" href="http://trac.sagemath.org/15386">trac ticket #15386</a> is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;n&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">n</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sequence</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="n">n</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">8</span><span class="o">*</span><span class="n">n</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">infinity</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.calculus.calculus.mapped_opts">
<tt class="descclassname">sage.calculus.calculus.</tt><tt class="descname">mapped_opts</tt><big>(</big><em>v</em><big>)</big><a class="headerlink" href="#sage.calculus.calculus.mapped_opts" title="Permalink to this definition">¶</a></dt>
<dd><p>Used internally when creating a string of options to pass to
Maxima.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">v</span></tt> - an object</li>
</ul>
<p>OUTPUT: a string.</p>
<p>The main use of this is to turn Python bools into lower case
strings.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">mapped_opts</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="go">&#39;true&#39;</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">mapped_opts</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="go">&#39;false&#39;</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">mapped_opts</span><span class="p">(</span><span class="s">&#39;bar&#39;</span><span class="p">)</span>
<span class="go">&#39;bar&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.calculus.calculus.maxima_options">
<tt class="descclassname">sage.calculus.calculus.</tt><tt class="descname">maxima_options</tt><big>(</big><em>**kwds</em><big>)</big><a class="headerlink" href="#sage.calculus.calculus.maxima_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Used internally to create a string of options to pass to Maxima.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">maxima_options</span><span class="p">(</span><span class="n">an_option</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">another</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">foo</span><span class="o">=</span><span class="s">&#39;bar&#39;</span><span class="p">)</span>
<span class="go">&#39;an_option=true,foo=bar,another=false&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.calculus.calculus.minpoly">
<tt class="descclassname">sage.calculus.calculus.</tt><tt class="descname">minpoly</tt><big>(</big><em>ex</em>, <em>var='x'</em>, <em>algorithm=None</em>, <em>bits=None</em>, <em>degree=None</em>, <em>epsilon=0</em><big>)</big><a class="headerlink" href="#sage.calculus.calculus.minpoly" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the minimal polynomial of self, if possible.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">var</span></tt> - polynomial variable name (default &#8216;x&#8217;)</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">algorithm</span></tt> - &#8216;algebraic&#8217; or &#8216;numerical&#8217; (default
both, but with numerical first)</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">bits</span></tt> - the number of bits to use in numerical
approx</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">degree</span></tt> - the expected algebraic degree</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">epsilon</span></tt> - return without error as long as
f(self) epsilon, in the case that the result cannot be proven.</p>
<p>All of the above parameters are optional, with epsilon=0, bits and
degree tested up to 1000 and 24 by default respectively. The
numerical algorithm will be faster if bits and/or degree are given
explicitly. The algebraic algorithm ignores the last three
parameters.</p>
</li>
</ul>
<p>OUTPUT: The minimal polynomial of self. If the numerical algorithm
is used then it is proved symbolically when epsilon=0 (default).</p>
<p>If the minimal polynomial could not be found, two distinct kinds of
errors are raised. If no reasonable candidate was found with the
given bit/degree parameters, a <tt class="docutils literal"><span class="pre">ValueError</span></tt> will be
raised. If a reasonable candidate was found but (perhaps due to
limits in the underlying symbolic package) was unable to be proved
correct, a <tt class="docutils literal"><span class="pre">NotImplementedError</span></tt> will be raised.</p>
<p>ALGORITHM: Two distinct algorithms are used, depending on the
algorithm parameter. By default, the numerical algorithm is
attempted first, then the algebraic one.</p>
<p>Algebraic: Attempt to evaluate this expression in QQbar, using
cyclotomic fields to resolve exponential and trig functions at
rational multiples of pi, field extensions to handle roots and
rational exponents, and computing compositums to represent the full
expression as an element of a number field where the minimal
polynomial can be computed exactly. The bits, degree, and epsilon
parameters are ignored.</p>
<p>Numerical: Computes a numerical approximation of
<tt class="docutils literal"><span class="pre">self</span></tt> and use PARI&#8217;s algdep to get a candidate
minpoly <span class="math">\(f\)</span>. If <span class="math">\(f(\mathtt{self})\)</span>,
evaluated to a higher precision, is close enough to 0 then evaluate
<span class="math">\(f(\mathtt{self})\)</span> symbolically, attempting to prove
vanishing. If this fails, and <tt class="docutils literal"><span class="pre">epsilon</span></tt> is non-zero,
return <span class="math">\(f\)</span> if and only if
<span class="math">\(f(\mathtt{self}) &lt; \mathtt{epsilon}\)</span>.
Otherwise raise a <tt class="docutils literal"><span class="pre">ValueError</span></tt> (if no suitable
candidate was found) or a <tt class="docutils literal"><span class="pre">NotImplementedError</span></tt> (if a
likely candidate was found but could not be proved correct).</p>
<p>EXAMPLES: First some simple examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>
<span class="go">x^2 - 2</span>
<span class="gp">sage: </span><span class="n">minpoly</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span>
<span class="go">x^3 - 2</span>
<span class="gp">sage: </span><span class="n">minpoly</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="go">x^4 - 2*x^2 + 9</span>
<span class="gp">sage: </span><span class="n">minpoly</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="mi">3</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span>
<span class="go">x^6 - 6*x^4 + 6*x^3 + 12*x^2 + 36*x + 1</span>
</pre></div>
</div>
<p>Works with trig and exponential functions too.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>
<span class="go">x^2 - 3/4</span>
<span class="gp">sage: </span><span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>
<span class="go">x^6 - 7/4*x^4 + 7/8*x^2 - 7/64</span>
<span class="gp">sage: </span><span class="n">minpoly</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">17</span><span class="p">))</span>
<span class="go">x^16 - x^15 + x^14 - x^13 + x^12 - x^11 + x^10 - x^9 + x^8 - x^7 + x^6 - x^5 + x^4 - x^3 + x^2 - x + 1</span>
</pre></div>
</div>
<p>Here we verify it gives the same result as the abstract number
field.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>
<span class="go">x^4 - 22*x^2 - 48*x - 23</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">absolute_minpoly</span><span class="p">()</span>
<span class="go">x^4 - 22*x^2 - 48*x - 23</span>
</pre></div>
</div>
<p>The minpoly function is used implicitly when creating
number fields:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">eqn</span> <span class="o">=</span>  <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">eqn</span><span class="p">,</span> <span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">QQ</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
<span class="go">Number Field in a with defining polynomial x^6 + 10*x^3 - 2*x^2 + 25</span>
</pre></div>
</div>
<p>Here we solve a cubic and then recover it from its complicated
radical expansion.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rhs</span><span class="p">();</span> <span class="n">a</span>
<span class="go">-1/2*(1/18*sqrt(23)*sqrt(3) - 1/2)^(1/3)*(I*sqrt(3) + 1) - 1/6*(-I*sqrt(3) + 1)/(1/18*sqrt(23)*sqrt(3) - 1/2)^(1/3)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>
<span class="go">x^3 - x + 1</span>
</pre></div>
</div>
<p>Note that simplification may be necessary to see that the minimal
polynomial is correct.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">minpoly</span><span class="p">();</span> <span class="n">f</span>
<span class="go">x^8 - 40*x^6 + 352*x^4 - 960*x^2 + 576</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">((((sqrt(5) + sqrt(3) + sqrt(2))^2 - 40)*(sqrt(5) + sqrt(3) + sqrt(2))^2 + 352)*(sqrt(5) + sqrt(3) + sqrt(2))^2 - 960)*(sqrt(5) + sqrt(3) + sqrt(2))^2 + 576</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Here we show use of the <tt class="docutils literal"><span class="pre">epsilon</span></tt> parameter. That
this result is actually exact can be shown using the addition
formula for sin, but maxima is unable to see that.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">minpoly</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;numerical&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">NotImplementedError</span>: <span class="n-Identifier">Could not prove minimal polynomial x^4 - 5/4*x^2 + 5/16 (epsilon 0.00000000000000e-1)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">minpoly</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;numerical&#39;</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">1e-100</span><span class="p">);</span> <span class="n">f</span>
<span class="go">x^4 - 5/4*x^2 + 5/16</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">0.00000000000000000000000000000</span>
</pre></div>
</div>
<p>The degree must be high enough (default tops out at 24).</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">minpoly</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;numerical&#39;</span><span class="p">,</span> <span class="n">bits</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">ValueError</span>: <span class="n-Identifier">Could not find minimal polynomial (100 bits, degree 3).</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">minpoly</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;numerical&#39;</span><span class="p">,</span> <span class="n">bits</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">x^4 - 10*x^2 + 1</span>
</pre></div>
</div>
<p>There is a difference between algorithm=&#8217;algebraic&#8217; and
algorithm=&#8217;numerical&#8217;:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">cos</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">minpoly</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;algebraic&#39;</span><span class="p">)</span>
<span class="go">x^10 + 1/2*x^9 - 5/2*x^8 - 5/4*x^7 + 17/8*x^6 + 17/16*x^5 - 43/64*x^4 - 43/128*x^3 + 3/64*x^2 + 3/128*x + 1/1024</span>
<span class="gp">sage: </span><span class="n">cos</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">minpoly</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;numerical&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">NotImplementedError</span>: <span class="n-Identifier">Could not prove minimal polynomial x^10 + 1/2*x^9 - 5/2*x^8 - 5/4*x^7 + 17/8*x^6 + 17/16*x^5 - 43/64*x^4 - 43/128*x^3 + 3/64*x^2 + 3/128*x + 1/1024 (epsilon ...)</span>
</pre></div>
</div>
<p>Sometimes it fails, as it must given that some numbers aren&#8217;t algebraic:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">sin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">minpoly</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;numerical&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">ValueError</span>: <span class="n-Identifier">Could not find minimal polynomial (1000 bits, degree 24).</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Of course, failure to produce a minimal polynomial does not
necessarily indicate that this number is transcendental.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.calculus.calculus.nintegral">
<tt class="descclassname">sage.calculus.calculus.</tt><tt class="descname">nintegral</tt><big>(</big><em>ex</em>, <em>x</em>, <em>a</em>, <em>b</em>, <em>desired_relative_error='1e-8'</em>, <em>maximum_num_subintervals=200</em><big>)</big><a class="headerlink" href="#sage.calculus.calculus.nintegral" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a floating point machine precision numerical approximation
to the integral of <tt class="docutils literal"><span class="pre">self</span></tt> from <span class="math">\(a\)</span> to
<span class="math">\(b\)</span>, computed using floating point arithmetic via maxima.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">x</span></tt> - variable to integrate with respect to</li>
<li><tt class="docutils literal"><span class="pre">a</span></tt> - lower endpoint of integration</li>
<li><tt class="docutils literal"><span class="pre">b</span></tt> - upper endpoint of integration</li>
<li><tt class="docutils literal"><span class="pre">desired_relative_error</span></tt> - (default: &#8216;1e-8&#8217;) the
desired relative error</li>
<li><tt class="docutils literal"><span class="pre">maximum_num_subintervals</span></tt> - (default: 200)
maxima number of subintervals</li>
</ul>
<p>OUTPUT:</p>
<ul>
<li><p class="first">float: approximation to the integral</p>
</li>
<li><p class="first">float: estimated absolute error of the
approximation</p>
</li>
<li><p class="first">the number of integrand evaluations</p>
</li>
<li><p class="first">an error code:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">0</span></tt> - no problems were encountered</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">1</span></tt> - too many subintervals were done</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">2</span></tt> - excessive roundoff error</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">3</span></tt> - extremely bad integrand behavior</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">4</span></tt> - failed to converge</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">5</span></tt> - integral is probably divergent or slowly
convergent</p>
</li>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">6</span></tt> - the input is invalid; this includes the case of</dt>
<dd><p class="first last">desired_relative_error being too small to be achieved</p>
</dd>
</dl>
</li>
</ul>
</li>
</ul>
<p>ALIAS: nintegrate is the same as nintegral</p>
<p>REMARK: There is also a function
<tt class="docutils literal"><span class="pre">numerical_integral</span></tt> that implements numerical
integration using the GSL C library. It is potentially much faster
and applies to arbitrary user defined functions.</p>
<p>Also, there are limits to the precision to which Maxima can compute
the integral due to limitations in quadpack.
In the following example, remark that the last value of the returned
tuple is <tt class="docutils literal"><span class="pre">6</span></tt>, indicating that the input was invalid, in this case
because of a too high desired precision.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">nintegral</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">1e-14</span><span class="p">)</span>
<span class="go">(0.0, 0.0, 0, 6)</span>
</pre></div>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">nintegral</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">(0.5284822353142306, 4.163...e-11, 231, 0)</span>
</pre></div>
</div>
<p>We can also use the <tt class="docutils literal"><span class="pre">numerical_integral</span></tt> function,
which calls the GSL C library.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">numerical_integral</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">(0.528482232253147, 6.83928460...e-07)</span>
</pre></div>
</div>
<p>Note that in exotic cases where floating point evaluation of the
expression leads to the wrong value, then the output can be
completely wrong:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">163</span><span class="p">))</span> <span class="o">-</span> <span class="mi">262537412640768744</span>
</pre></div>
</div>
<p>Despite appearance, <span class="math">\(f\)</span> is really very close to 0, but one
gets a nonzero value since the definition of
<tt class="docutils literal"><span class="pre">float(f)</span></tt> is that it makes all constants inside the
expression floats, then evaluates each function and each arithmetic
operation using float arithmetic:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">float</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">-480.0</span>
</pre></div>
</div>
<p>Computing to higher precision we see the truth:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
<span class="go">-7.4992740280181431112064614366622348652078895136533593355718e-13</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
<span class="go">-7.49927402801814311120646143662663009137292462589621789352095066181709095575681963967103004e-13</span>
</pre></div>
</div>
<p>Now numerically integrating, we see why the answer is wrong:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">nintegrate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(-480.0000000000001, 5.329070518200754e-12, 21, 0)</span>
</pre></div>
</div>
<p>It is just because every floating point evaluation of return -480.0
in floating point.</p>
<p>Important note: using PARI/GP one can compute numerical integrals
to high precision:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">gp</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s">&#39;intnum(x=17,42,exp(-x^2)*log(x))&#39;</span><span class="p">)</span>
<span class="go">&#39;2.565728500561051474934096410 E-127&#39;            # 32-bit</span>
<span class="go">&#39;2.5657285005610514829176211363206621657 E-127&#39;  # 64-bit</span>
<span class="gp">sage: </span><span class="n">old_prec</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">set_real_precision</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">gp</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s">&#39;intnum(x=17,42,exp(-x^2)*log(x))&#39;</span><span class="p">)</span>
<span class="go">&#39;2.5657285005610514829173563961304957417746108003917 E-127&#39;</span>
<span class="gp">sage: </span><span class="n">gp</span><span class="o">.</span><span class="n">set_real_precision</span><span class="p">(</span><span class="n">old_prec</span><span class="p">)</span>
<span class="go">57</span>
</pre></div>
</div>
<p>Note that the input function above is a string in PARI syntax.</p>
</dd></dl>

<dl class="function">
<dt id="sage.calculus.calculus.nintegrate">
<tt class="descclassname">sage.calculus.calculus.</tt><tt class="descname">nintegrate</tt><big>(</big><em>ex</em>, <em>x</em>, <em>a</em>, <em>b</em>, <em>desired_relative_error='1e-8'</em>, <em>maximum_num_subintervals=200</em><big>)</big><a class="headerlink" href="#sage.calculus.calculus.nintegrate" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a floating point machine precision numerical approximation
to the integral of <tt class="docutils literal"><span class="pre">self</span></tt> from <span class="math">\(a\)</span> to
<span class="math">\(b\)</span>, computed using floating point arithmetic via maxima.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">x</span></tt> - variable to integrate with respect to</li>
<li><tt class="docutils literal"><span class="pre">a</span></tt> - lower endpoint of integration</li>
<li><tt class="docutils literal"><span class="pre">b</span></tt> - upper endpoint of integration</li>
<li><tt class="docutils literal"><span class="pre">desired_relative_error</span></tt> - (default: &#8216;1e-8&#8217;) the
desired relative error</li>
<li><tt class="docutils literal"><span class="pre">maximum_num_subintervals</span></tt> - (default: 200)
maxima number of subintervals</li>
</ul>
<p>OUTPUT:</p>
<ul>
<li><p class="first">float: approximation to the integral</p>
</li>
<li><p class="first">float: estimated absolute error of the
approximation</p>
</li>
<li><p class="first">the number of integrand evaluations</p>
</li>
<li><p class="first">an error code:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">0</span></tt> - no problems were encountered</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">1</span></tt> - too many subintervals were done</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">2</span></tt> - excessive roundoff error</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">3</span></tt> - extremely bad integrand behavior</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">4</span></tt> - failed to converge</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">5</span></tt> - integral is probably divergent or slowly
convergent</p>
</li>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">6</span></tt> - the input is invalid; this includes the case of</dt>
<dd><p class="first last">desired_relative_error being too small to be achieved</p>
</dd>
</dl>
</li>
</ul>
</li>
</ul>
<p>ALIAS: nintegrate is the same as nintegral</p>
<p>REMARK: There is also a function
<tt class="docutils literal"><span class="pre">numerical_integral</span></tt> that implements numerical
integration using the GSL C library. It is potentially much faster
and applies to arbitrary user defined functions.</p>
<p>Also, there are limits to the precision to which Maxima can compute
the integral due to limitations in quadpack.
In the following example, remark that the last value of the returned
tuple is <tt class="docutils literal"><span class="pre">6</span></tt>, indicating that the input was invalid, in this case
because of a too high desired precision.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">nintegral</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">1e-14</span><span class="p">)</span>
<span class="go">(0.0, 0.0, 0, 6)</span>
</pre></div>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">nintegral</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">(0.5284822353142306, 4.163...e-11, 231, 0)</span>
</pre></div>
</div>
<p>We can also use the <tt class="docutils literal"><span class="pre">numerical_integral</span></tt> function,
which calls the GSL C library.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">numerical_integral</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">(0.528482232253147, 6.83928460...e-07)</span>
</pre></div>
</div>
<p>Note that in exotic cases where floating point evaluation of the
expression leads to the wrong value, then the output can be
completely wrong:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">163</span><span class="p">))</span> <span class="o">-</span> <span class="mi">262537412640768744</span>
</pre></div>
</div>
<p>Despite appearance, <span class="math">\(f\)</span> is really very close to 0, but one
gets a nonzero value since the definition of
<tt class="docutils literal"><span class="pre">float(f)</span></tt> is that it makes all constants inside the
expression floats, then evaluates each function and each arithmetic
operation using float arithmetic:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">float</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">-480.0</span>
</pre></div>
</div>
<p>Computing to higher precision we see the truth:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
<span class="go">-7.4992740280181431112064614366622348652078895136533593355718e-13</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
<span class="go">-7.49927402801814311120646143662663009137292462589621789352095066181709095575681963967103004e-13</span>
</pre></div>
</div>
<p>Now numerically integrating, we see why the answer is wrong:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">nintegrate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(-480.0000000000001, 5.329070518200754e-12, 21, 0)</span>
</pre></div>
</div>
<p>It is just because every floating point evaluation of return -480.0
in floating point.</p>
<p>Important note: using PARI/GP one can compute numerical integrals
to high precision:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">gp</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s">&#39;intnum(x=17,42,exp(-x^2)*log(x))&#39;</span><span class="p">)</span>
<span class="go">&#39;2.565728500561051474934096410 E-127&#39;            # 32-bit</span>
<span class="go">&#39;2.5657285005610514829176211363206621657 E-127&#39;  # 64-bit</span>
<span class="gp">sage: </span><span class="n">old_prec</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">set_real_precision</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">gp</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s">&#39;intnum(x=17,42,exp(-x^2)*log(x))&#39;</span><span class="p">)</span>
<span class="go">&#39;2.5657285005610514829173563961304957417746108003917 E-127&#39;</span>
<span class="gp">sage: </span><span class="n">gp</span><span class="o">.</span><span class="n">set_real_precision</span><span class="p">(</span><span class="n">old_prec</span><span class="p">)</span>
<span class="go">57</span>
</pre></div>
</div>
<p>Note that the input function above is a string in PARI syntax.</p>
</dd></dl>

<dl class="function">
<dt id="sage.calculus.calculus.symbolic_expression_from_maxima_string">
<tt class="descclassname">sage.calculus.calculus.</tt><tt class="descname">symbolic_expression_from_maxima_string</tt><big>(</big><em>x</em>, <em>equals_sub=False</em>, <em>maxima=Maxima_lib</em><big>)</big><a class="headerlink" href="#sage.calculus.calculus.symbolic_expression_from_maxima_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a string representation of a Maxima expression, parse it and
return the corresponding Sage symbolic expression.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">x</span></tt> - a string</li>
<li><tt class="docutils literal"><span class="pre">equals_sub</span></tt> - (default: False) if True, replace
&#8216;=&#8217; by &#8216;==&#8217; in self</li>
<li><tt class="docutils literal"><span class="pre">maxima</span></tt> - (default: the calculus package&#8217;s
Maxima) the Maxima interpreter to use.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.calculus</span> <span class="kn">import</span> <span class="n">symbolic_expression_from_maxima_string</span> <span class="k">as</span> <span class="n">sefms</span>
<span class="gp">sage: </span><span class="n">sefms</span><span class="p">(</span><span class="s">&#39;x^</span><span class="si">%e</span><span class="s"> + </span><span class="si">%e</span><span class="s">^%pi + </span><span class="si">%i</span><span class="s"> + sin(0)&#39;</span><span class="p">)</span>
<span class="go">x^e + e^pi + I</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sefms</span><span class="p">(</span><span class="s">&#39;?%at(f(x),x=2)#1&#39;</span><span class="p">)</span>
<span class="go">f(2) != 1</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">maxima</span><span class="p">(</span><span class="s">&quot;x#0&quot;</span><span class="p">);</span> <span class="n">a</span>
<span class="go">x#0</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">sage</span><span class="p">()</span>
<span class="go">x != 0</span>
</pre></div>
</div>
<p>TESTS:</p>
<p><a class="reference external" href="http://trac.sagemath.org/8459">trac ticket #8459</a> fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">maxima</span><span class="p">(</span><span class="s">&#39;3*li[2](u)+8*li[33](exp(u))&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sage</span><span class="p">()</span>
<span class="go">8*polylog(33, e^u) + 3*polylog(2, u)</span>
</pre></div>
</div>
<p>Check if <a class="reference external" href="http://trac.sagemath.org/8345">trac ticket #8345</a> is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="s">&#39;complex&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">latex</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">\overline{x}</span>
<span class="gp">sage: </span><span class="n">latex</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">_maxima_</span><span class="p">()</span><span class="o">.</span><span class="n">_sage_</span><span class="p">())</span>
<span class="go">\overline{x}</span>
</pre></div>
</div>
<p>Check that we can understand maxima&#8217;s not-equals (<a class="reference external" href="http://trac.sagemath.org/8969">trac ticket #8969</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.calculus</span> <span class="kn">import</span> <span class="n">symbolic_expression_from_maxima_string</span> <span class="k">as</span> <span class="n">sefms</span>
<span class="gp">sage: </span><span class="n">sefms</span><span class="p">(</span><span class="s">&quot;x!=3&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">sefms</span><span class="p">(</span><span class="s">&quot;x # 3&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">SR</span><span class="p">(</span><span class="n">x</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">solve</span><span class="p">([</span><span class="n">x</span> <span class="o">!=</span> <span class="mi">5</span><span class="p">],</span> <span class="n">x</span><span class="p">)</span>
<span class="go">#0: solve_rat_ineq(ineq=_SAGE_VAR_x # 5)</span>
<span class="go">[[x - 5 != 0]]</span>
<span class="gp">sage: </span><span class="n">solve</span><span class="p">([</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">==</span><span class="mi">3</span><span class="p">,</span> <span class="n">x</span> <span class="o">!=</span> <span class="mi">5</span><span class="p">],</span> <span class="n">x</span><span class="p">)</span>
<span class="go">[[x == (3/2), (-7/2) != 0]]</span>
</pre></div>
</div>
<p>Make sure that we don&#8217;t accidentally pick up variables in the maxima namespace (trac #8734):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">maxima</span><span class="p">(</span><span class="s">&#39;my_new_var : 2&#39;</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;my_new_var&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">full_simplify</span><span class="p">()</span>
<span class="go">my_new_var</span>
</pre></div>
</div>
<p>ODE solution constants are treated differently (<a class="reference external" href="http://trac.sagemath.org/16007">trac ticket #16007</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.calculus</span> <span class="kn">import</span> <span class="n">symbolic_expression_from_maxima_string</span> <span class="k">as</span> <span class="n">sefms</span>
<span class="gp">sage: </span><span class="n">sefms</span><span class="p">(</span><span class="s">&#39;%k1*x + %k2*y + </span><span class="si">%c</span><span class="s">&#39;</span><span class="p">)</span>
<span class="go">_K1*x + _K2*y + _C</span>
</pre></div>
</div>
<p>Check that some hypothetical variables don&#8217;t end up as special constants (<a class="reference external" href="http://trac.sagemath.org/6882">trac ticket #6882</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.calculus</span> <span class="kn">import</span> <span class="n">symbolic_expression_from_maxima_string</span> <span class="k">as</span> <span class="n">sefms</span>
<span class="gp">sage: </span><span class="n">sefms</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%i</span><span class="s">&#39;</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">ln</span><span class="p">(</span><span class="n">sefms</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%e</span><span class="s">&#39;</span><span class="p">))</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">sefms</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="go">_i^2</span>
<span class="gp">sage: </span><span class="n">sefms</span><span class="p">(</span><span class="s">&#39;I&#39;</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="go">_I^2</span>
<span class="gp">sage: </span><span class="n">sefms</span><span class="p">(</span><span class="s">&#39;ln(e)&#39;</span><span class="p">)</span>
<span class="go">ln(_e)</span>
<span class="gp">sage: </span><span class="n">sefms</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%i</span><span class="s">nf&#39;</span><span class="p">)</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.calculus.calculus.symbolic_expression_from_string">
<tt class="descclassname">sage.calculus.calculus.</tt><tt class="descname">symbolic_expression_from_string</tt><big>(</big><em>s</em>, <em>syms=None</em>, <em>accept_sequence=False</em><big>)</big><a class="headerlink" href="#sage.calculus.calculus.symbolic_expression_from_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a string, (attempt to) parse it and return the
corresponding Sage symbolic expression.  Normally used
to return Maxima output to the user.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">s</span></tt> - a string</li>
<li><tt class="docutils literal"><span class="pre">syms</span></tt> - (default: None) dictionary of
strings to be regarded as symbols or functions</li>
<li><tt class="docutils literal"><span class="pre">accept_sequence</span></tt> - (default: False) controls whether
to allow a (possibly nested) set of lists and tuples
as input</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">symbolic_expression_from_string</span><span class="p">(</span><span class="s">&#39;[sin(0)*x^2,3*spam+e^pi]&#39;</span><span class="p">,</span><span class="n">syms</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;spam&#39;</span><span class="p">:</span><span class="n">y</span><span class="p">},</span><span class="n">accept_sequence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[0, 3*y + e^pi]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.calculus.calculus.symbolic_sum">
<tt class="descclassname">sage.calculus.calculus.</tt><tt class="descname">symbolic_sum</tt><big>(</big><em>expression</em>, <em>v</em>, <em>a</em>, <em>b</em>, <em>algorithm='maxima'</em><big>)</big><a class="headerlink" href="#sage.calculus.calculus.symbolic_sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the symbolic sum <span class="math">\(\sum_{v = a}^b expression\)</span> with respect
to the variable <span class="math">\(v\)</span> with endpoints <span class="math">\(a\)</span> and <span class="math">\(b\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">expression</span></tt> - a symbolic expression</li>
<li><tt class="docutils literal"><span class="pre">v</span></tt> - a variable or variable name</li>
<li><tt class="docutils literal"><span class="pre">a</span></tt> - lower endpoint of the sum</li>
<li><tt class="docutils literal"><span class="pre">b</span></tt> - upper endpoint of the sum</li>
<li><tt class="docutils literal"><span class="pre">algorithm</span></tt> - (default: <tt class="docutils literal"><span class="pre">'maxima'</span></tt>)  one of<ul>
<li><tt class="docutils literal"><span class="pre">'maxima'</span></tt> - use Maxima (the default)</li>
<li><tt class="docutils literal"><span class="pre">'maple'</span></tt> - (optional) use Maple</li>
<li><tt class="docutils literal"><span class="pre">'mathematica'</span></tt> - (optional) use Mathematica</li>
<li><tt class="docutils literal"><span class="pre">'giac'</span></tt> - (optional) use Giac</li>
</ul>
</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">k</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;k,n&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.calculus</span> <span class="kn">import</span> <span class="n">symbolic_sum</span>
<span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">1/2*(n + 1)*n</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">k</span><span class="o">^</span><span class="mi">4</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>
<span class="go">1/90*pi^4</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">k</span><span class="o">^</span><span class="mi">5</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>
<span class="go">zeta(5)</span>
</pre></div>
</div>
<p>A well known binomial identity:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">),</span> <span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="go">2^n</span>
</pre></div>
</div>
<p>And some truncations thereof:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">n</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="go">2^n - 1</span>
<span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="n">k</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="go">2^n - n - 1</span>
<span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="n">k</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">2^n - 1</span>
<span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">2^n - 2</span>
</pre></div>
</div>
<p>The binomial theorem:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;x, y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="o">^</span><span class="n">k</span> <span class="o">*</span> <span class="n">y</span><span class="o">^</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="p">),</span> <span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="go">(x + y)^n</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">),</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="go">2^(n - 1)*n</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="n">k</span><span class="o">*</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">),</span> <span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)),</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>
<span class="go">-log(2) + 1</span>
</pre></div>
</div>
<p>Summing a hypergeometric term:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">/</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">k</span><span class="p">),</span> <span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="go">1/2*sqrt(pi)/factorial(n + 1/2)</span>
</pre></div>
</div>
<p>We check a well known identity:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">bool</span><span class="p">(</span><span class="n">symbolic_sum</span><span class="p">(</span><span class="n">k</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">==</span> <span class="n">symbolic_sum</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A geometric sum:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">a</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;a, q&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="go">(a*q^(n + 1) - a)/(q - 1)</span>
</pre></div>
</div>
<p>For the geometric series, we will have to assume
the right values for the sum to converge:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>
<span class="go">-a/(q - 1)</span>
</pre></div>
</div>
<p>A divergent geometric series.  Don&#8217;t forget
to forget your assumptions:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">forget</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">q</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="nc">ValueError</span>: <span class="n-Identifier">Sum is divergent.</span>
<span class="gp">sage: </span><span class="n">forget</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">assumptions</span><span class="p">()</span> <span class="c"># check the assumptions were really forgotten</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>This summation only Mathematica can perform:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">k</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="n">k</span><span class="p">,</span> <span class="o">-</span><span class="n">oo</span><span class="p">,</span> <span class="n">oo</span><span class="p">,</span> <span class="n">algorithm</span> <span class="o">=</span> <span class="s">&#39;mathematica&#39;</span><span class="p">)</span>     <span class="c"># optional - mathematica</span>
<span class="go">pi*coth(pi)</span>
</pre></div>
</div>
<p>An example of this summation with Giac:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">k</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="n">k</span><span class="p">,</span> <span class="o">-</span><span class="n">oo</span><span class="p">,</span> <span class="n">oo</span><span class="p">,</span> <span class="n">algorithm</span> <span class="o">=</span> <span class="s">&#39;giac&#39;</span><span class="p">)</span>           <span class="c"># optional - giac</span>
<span class="go">-(pi*e^(-2*pi) - pi*e^(2*pi))/(e^(-2*pi) + e^(2*pi) - 2)</span>
</pre></div>
</div>
<p>Use Maple as a backend for summation:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">algorithm</span> <span class="o">=</span> <span class="s">&#39;maple&#39;</span><span class="p">)</span>      <span class="c"># optional - maple</span>
<span class="go">(x + 1)^n</span>
</pre></div>
</div>
<p>TESTS:</p>
<p><a class="reference external" href="http://trac.sagemath.org/10564">trac ticket #10564</a> is fixed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">sum</span> <span class="p">(</span><span class="n">n</span><span class="o">^</span><span class="mi">3</span> <span class="o">*</span> <span class="n">x</span><span class="o">^</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">infinity</span><span class="p">)</span>
<span class="go">(x^3 + 4*x^2 + x)/(x^4 - 4*x^3 + 6*x^2 - 4*x + 1)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Sage can currently only understand a subset of the output of Maxima,
Maple and Mathematica, so even if the chosen backend can perform
the summation the result might not be convertable into a Sage
expression.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.calculus.calculus.var_cmp">
<tt class="descclassname">sage.calculus.calculus.</tt><tt class="descname">var_cmp</tt><big>(</big><em>x</em>, <em>y</em><big>)</big><a class="headerlink" href="#sage.calculus.calculus.var_cmp" title="Permalink to this definition">¶</a></dt>
<dd><p>Return comparison of the two variables x and y, which is just the
comparison of the underlying string representations of the
variables. This is used internally by the Calculus package.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">x,</span> <span class="pre">y</span></tt> - symbolic variables</li>
</ul>
<p>OUTPUT: Python integer; either -1, 0, or 1.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">var_cmp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">var_cmp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">var</span><span class="p">(</span><span class="s">&#39;z&#39;</span><span class="p">))</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">var_cmp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">))</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="../symbolic/relation.html"
                                  title="previous chapter">Symbolic Equations and Inequalities</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="../symbolic/units.html"
                                  title="next chapter">Units of measurement</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../_sources/sage/calculus/calculus.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../symbolic/units.html" title="Units of measurement"
             >next</a> |</li>
        <li class="right" >
          <a href="../symbolic/relation.html" title="Symbolic Equations and Inequalities"
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../index.html">Symbolic Calculus</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer">
        &copy; Copyright 2005--2015, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>