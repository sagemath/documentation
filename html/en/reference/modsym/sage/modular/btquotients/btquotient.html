<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="Spaces of \(p\)-adic automorphic forms" href="pautomorphicform.html" /><link rel="prev" title="Element class for Pollack-Stevens’ modular symbols" href="../pollack_stevens/modsym.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>Quotients of the Bruhat-Tits tree - Modular Symbols</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=a078f75a" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/jupyter-sphinx.css?v=572af1d6" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-furo.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-codemirror-monokai.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Modular Symbols</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 10.3 Reference Manual</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../../index.html">Home - Modular Symbols</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../modsym/modsym.html">Creation of modular symbols spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modsym/space.html">Base class of the space of modular symbols</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modsym/ambient.html">Ambient spaces of modular symbols</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modsym/subspace.html">Subspace of ambient spaces of modular symbols</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modsym/element.html">A single element of an ambient space of modular symbols</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modsym/modular_symbols.html">Modular symbols <span class="math notranslate nohighlight">\(\{\alpha\)</span>, <span class="math notranslate nohighlight">\(\beta\}\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../modsym/manin_symbol.html">Manin symbols</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modsym/manin_symbol_list.html">Manin symbol lists</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modsym/boundary.html">Space of boundary modular symbols</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modsym/heilbronn.html">Heilbronn matrix computation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modsym/p1list.html">Lists of Manin symbols over <span class="math notranslate nohighlight">\(\QQ\)</span>, elements of <span class="math notranslate nohighlight">\(\mathbb{P}^1(\ZZ/N\ZZ)\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../modsym/g1list.html">List of coset representatives for <span class="math notranslate nohighlight">\(\Gamma_1(N)\)</span> in <span class="math notranslate nohighlight">\(\SL_2(\ZZ)\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../modsym/ghlist.html">List of coset representatives for <span class="math notranslate nohighlight">\(\Gamma_H(N)\)</span> in <span class="math notranslate nohighlight">\(\SL_2(\ZZ)\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../modsym/relation_matrix.html">Relation matrices for ambient modular symbols spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modsym/p1list_nf.html">Lists of Manin symbols over number fields, elements of <span class="math notranslate nohighlight">\(\mathbb{P}^1(R/N)\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../modsym/apply.html">Monomial expansion of <span class="math notranslate nohighlight">\((aX + bY)^i (cX + dY)^{j-i}\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../modsym/hecke_operator.html">Sparse action of Hecke operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modsym/relation_matrix_pyx.html">Optimized computing of relation matrices in certain cases</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../pollack_stevens/space.html">Pollack-Stevens’ modular symbols spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pollack_stevens/distributions.html">Spaces of distributions for Pollack-Stevens modular symbols</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pollack_stevens/fund_domain.html">Manin relations for overconvergent modular symbols</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pollack_stevens/padic_lseries.html"><span class="math notranslate nohighlight">\(p\)</span>-adic <span class="math notranslate nohighlight">\(L\)</span>-series attached to overconvergent eigensymbols</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pollack_stevens/manin_map.html">Manin map</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pollack_stevens/modsym.html">Element class for Pollack-Stevens’ modular symbols</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Quotients of the Bruhat-Tits tree</a></li>
<li class="toctree-l1"><a class="reference internal" href="pautomorphicform.html">Spaces of <span class="math notranslate nohighlight">\(p\)</span>-adic automorphic forms</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="quotients-of-the-bruhat-tits-tree">
<span id="sage-modular-btquotients-btquotient"></span><h1>Quotients of the Bruhat-Tits tree<a class="headerlink" href="#quotients-of-the-bruhat-tits-tree" title="Link to this heading">#</a></h1>
<p id="module-sage.modular.btquotients.btquotient">This package contains all the functionality described and developed in <a class="reference internal" href="../../../../references/index.html#fm2014" id="id1"><span>[FM2014]</span></a>.
It allows for computations with fundamental domains of the Bruhat-Tits tree,
under the action of arithmetic groups arising from units in definite
quaternion algebras.</p>
<p>EXAMPLES:</p>
<p>Create the quotient attached to a maximal order of the quaternion algebra of
discriminant <span class="math notranslate nohighlight">\(13\)</span>, at the prime <span class="math notranslate nohighlight">\(p = 5\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
</pre></div>
</div>
<p>We can query for its genus, as well as get it back as a graph:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Y</span><span class="o">.</span><span class="n">genus</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="o">.</span><span class="n">get_graph</span><span class="p">()</span>
<span class="go">Multi-graph on 2 vertices</span>
</pre></div>
</div>
<p>The rest of functionality can be found in the docstrings below.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Cameron Franc and Marc Masdeu (2011): initial version</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.modular.btquotients.btquotient.</span></span><span class="sig-name descname"><span class="pre">BruhatTitsQuotient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nminus</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nplus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">character</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_magma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magma_session</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Parents and Elements v10.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SageObject</span></code></a>, <a class="reference external" href="../../../../structure/sage/structure/unique_representation.html#sage.structure.unique_representation.UniqueRepresentation" title="(in Parents and Elements v10.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniqueRepresentation</span></code></a></p>
<p>This function computes the quotient of the Bruhat-Tits tree
by an arithmetic quaternionic group. The group in question is the
group of norm 1 elements in an Eichler <span class="math notranslate nohighlight">\(\ZZ[1/p]\)</span>-order of some (tame)
level inside of a definite quaternion algebra that is unramified
at the prime <span class="math notranslate nohighlight">\(p\)</span>. Note that this routine relies in Magma in the case
<span class="math notranslate nohighlight">\(p = 2\)</span> or when <span class="math notranslate nohighlight">\(N^{+} &gt; 1\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> - a prime number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Nminus</span></code> - squarefree integer divisible by an odd number of
distinct primes and relatively prime to p. This is the
discriminant of the definite quaternion algebra that one is
quotienting by.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Nplus</span></code> - an integer coprime to pNminus (Default: 1). This is
the tame level. It need not be squarefree! If Nplus is not 1
then the user currently needs magma installed due to sage’s
inability to compute well with nonmaximal Eichler orders in
rational (definite) quaternion algebras.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">character</span></code> - a Dirichlet character (Default: None) of modulus
<span class="math notranslate nohighlight">\(pN^-N^+\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">use_magma</span></code> - boolean (default: False). If True, uses Magma
for quaternion arithmetic.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">magma_session</span></code> – (default: None). If specified, the Magma session
to use.</p></li>
</ul>
<p>EXAMPLES:</p>
<p>Here is an example without a Dirichlet character:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">genus</span><span class="p">()</span>
<span class="go">19</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">get_graph</span><span class="p">();</span> <span class="n">G</span>
<span class="go">Multi-graph on 4 vertices</span>
</pre></div>
</div>
<p>And an example with a Dirichlet character:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">DirichletGroup</span><span class="p">(</span><span class="mi">6</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="mi">7</span><span class="p">,</span><span class="n">character</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">genus</span><span class="p">()</span>
<span class="go">5</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A sage implementation of Eichler orders in rational quaternions
algebras would remove the dependency on magma.</p>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Marc Masdeu (2012-02-20)</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.B_one">
<span class="sig-name descname"><span class="pre">B_one</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.B_one" title="Link to this definition">#</a></dt>
<dd><p>Return the coordinates of <span class="math notranslate nohighlight">\(1\)</span> in the basis for the
quaternion order.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span><span class="p">,</span><span class="nb">pow</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">B_one</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">_conv</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.Nminus">
<span class="sig-name descname"><span class="pre">Nminus</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.Nminus" title="Link to this definition">#</a></dt>
<dd><p>Return the discriminant of the relevant definite
quaternion algebra.</p>
<p>OUTPUT:</p>
<p>An integer equal to <span class="math notranslate nohighlight">\(N^-\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">Nminus</span><span class="p">()</span>
<span class="go">7</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.Nplus">
<span class="sig-name descname"><span class="pre">Nplus</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.Nplus" title="Link to this definition">#</a></dt>
<dd><p>Return the tame level <span class="math notranslate nohighlight">\(N^+\)</span>.</p>
<p>OUTPUT:</p>
<p>An integer equal to <span class="math notranslate nohighlight">\(N^+\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">Nplus</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.dimension_harmonic_cocycles">
<span class="sig-name descname"><span class="pre">dimension_harmonic_cocycles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nplus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">character</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.dimension_harmonic_cocycles" title="Link to this definition">#</a></dt>
<dd><p>Compute the dimension of the space of harmonic cocycles
of weight <span class="math notranslate nohighlight">\(k\)</span> on <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<p>An integer equal to the dimension</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">X</span><span class="o">.</span><span class="n">dimension_harmonic_cocycles</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">2</span><span class="p">)]</span>
<span class="go">[1, 4, 4, 8, 8, 12, 12, 16, 16]</span>

<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># optional - magma</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">X</span><span class="o">.</span><span class="n">dimension_harmonic_cocycles</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">2</span><span class="p">)]</span> <span class="c1"># optional - magma</span>
<span class="go">[0, 1, 3, 1, 3, 5, 3, 5, 7, 5, 7, 9, 7, 9, 11, 9, 11, 13, 11]</span>

<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">dimension_harmonic_cocycles</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">11</span> <span class="o">*</span> <span class="mi">13</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">dimension_harmonic_cocycles</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">481</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">dimension_harmonic_cocycles</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">1440</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.e3">
<span class="sig-name descname"><span class="pre">e3</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.e3" title="Link to this definition">#</a></dt>
<dd><p>Compute the <span class="math notranslate nohighlight">\(e_3\)</span> invariant defined by the formula</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[e_k =\prod_{\ell\mid pN^-}\left(1-\left(\frac{-3}{\ell}\right)\right)\prod_{\ell \| N^+}\left(1+\left(\frac{-3}{\ell}\right)\right)\prod_{\ell^2\mid N^+} \nu_\ell(3)\]</div>
</div>
<p>OUTPUT:</p>
<p>an integer</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">e3</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.e4">
<span class="sig-name descname"><span class="pre">e4</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.e4" title="Link to this definition">#</a></dt>
<dd><p>Compute the <span class="math notranslate nohighlight">\(e_4\)</span> invariant defined by the formula</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[e_k =\prod_{\ell\mid pN^-}\left(1-\left(\frac{-k}{\ell}\right)\right)\prod_{\ell \| N^+}\left(1+\left(\frac{-k}{\ell}\right)\right)\prod_{\ell^2\mid N^+} \nu_\ell(k)\]</div>
</div>
<p>OUTPUT:</p>
<p>an integer</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">e4</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.embed">
<span class="sig-name descname"><span class="pre">embed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.embed" title="Link to this definition">#</a></dt>
<dd><p>Embed the quaternion element <code class="docutils literal notranslate"><span class="pre">g</span></code> into a matrix algebra.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">g</span></code> a row vector of size <span class="math notranslate nohighlight">\(4\)</span> whose entries represent a
quaternion in our basis.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">exact</span></code> boolean (default: False) - If True, tries to embed
<code class="docutils literal notranslate"><span class="pre">g</span></code> into a matrix algebra over a number field. If False,
the target is the matrix algebra over <span class="math notranslate nohighlight">\(\QQ_p\)</span>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A 2x2 matrix with coefficients in <span class="math notranslate nohighlight">\(\QQ_p\)</span> if <code class="docutils literal notranslate"><span class="pre">exact</span></code> is
False, or a number field if <code class="docutils literal notranslate"><span class="pre">exact</span></code> is True.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">l</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">get_units_of_order</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># random</span>
<span class="go">[-1]</span>
<span class="go">[ 0]</span>
<span class="go">[ 1]</span>
<span class="go">[ 1]</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">embed_quaternion</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span> <span class="n">u</span> <span class="c1"># random</span>
<span class="go">[    O(7) 3 + O(7)]</span>
<span class="go">[2 + O(7) 6 + O(7)]</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">_increase_precision</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">embed_quaternion</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span> <span class="n">v</span> <span class="c1"># random</span>
<span class="go">[                7 + 3*7^2 + 7^3 + 4*7^4 + O(7^6)             3 + 7 + 3*7^2 + 7^3 + 4*7^4 + O(7^6)]</span>
<span class="go">[            2 + 7 + 3*7^2 + 7^3 + 4*7^4 + O(7^6) 6 + 5*7 + 3*7^2 + 5*7^3 + 2*7^4 + 6*7^5 + O(7^6)]</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">==</span> <span class="n">v</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.embed_quaternion">
<span class="sig-name descname"><span class="pre">embed_quaternion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.embed_quaternion" title="Link to this definition">#</a></dt>
<dd><p>Embed the quaternion element <code class="docutils literal notranslate"><span class="pre">g</span></code> into a matrix algebra.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">g</span></code> a row vector of size <span class="math notranslate nohighlight">\(4\)</span> whose entries represent a
quaternion in our basis.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">exact</span></code> boolean (default: False) - If True, tries to embed
<code class="docutils literal notranslate"><span class="pre">g</span></code> into a matrix algebra over a number field. If False,
the target is the matrix algebra over <span class="math notranslate nohighlight">\(\QQ_p\)</span>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A 2x2 matrix with coefficients in <span class="math notranslate nohighlight">\(\QQ_p\)</span> if <code class="docutils literal notranslate"><span class="pre">exact</span></code> is
False, or a number field if <code class="docutils literal notranslate"><span class="pre">exact</span></code> is True.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">l</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">get_units_of_order</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># random</span>
<span class="go">[-1]</span>
<span class="go">[ 0]</span>
<span class="go">[ 1]</span>
<span class="go">[ 1]</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">embed_quaternion</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span> <span class="n">u</span> <span class="c1"># random</span>
<span class="go">[    O(7) 3 + O(7)]</span>
<span class="go">[2 + O(7) 6 + O(7)]</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">_increase_precision</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">embed_quaternion</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span> <span class="n">v</span> <span class="c1"># random</span>
<span class="go">[                7 + 3*7^2 + 7^3 + 4*7^4 + O(7^6)             3 + 7 + 3*7^2 + 7^3 + 4*7^4 + O(7^6)]</span>
<span class="go">[            2 + 7 + 3*7^2 + 7^3 + 4*7^4 + O(7^6) 6 + 5*7 + 3*7^2 + 5*7^3 + 2*7^4 + 6*7^5 + O(7^6)]</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">==</span> <span class="n">v</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.fundom_rep">
<span class="sig-name descname"><span class="pre">fundom_rep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.fundom_rep" title="Link to this definition">#</a></dt>
<dd><p>Find an equivalent vertex in the fundamental domain.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">v1</span></code> - a 2x2 matrix representing a normalized vertex.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A <code class="docutils literal notranslate"><span class="pre">Vertex</span></code> equivalent to <code class="docutils literal notranslate"><span class="pre">v1</span></code>, in the fundamental domain.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">set_immutable</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">fundom_rep</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">Vertex of Bruhat-Tits tree for p = 3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.genus">
<span class="sig-name descname"><span class="pre">genus</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.genus" title="Link to this definition">#</a></dt>
<dd><p>Compute the genus of the quotient graph using a formula
This should agree with self.genus_no_formula().</p>
<p>Compute the genus of the Shimura curve
corresponding to this quotient via Cerednik-Drinfeld. It is
computed via a formula and not in terms of the quotient graph.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p>level: Integer (default: None) a level. By default, use that
of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p></li>
<li><p>Nplus: Integer (default: None) a conductor. By default, use
that of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>An integer equal to the genus</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="mi">31</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">genus</span><span class="p">()</span>
<span class="go">21</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">genus</span><span class="p">()</span> <span class="o">==</span> <span class="n">X</span><span class="o">.</span><span class="n">genus_no_formula</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.genus_no_formula">
<span class="sig-name descname"><span class="pre">genus_no_formula</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.genus_no_formula" title="Link to this definition">#</a></dt>
<dd><p>Compute the genus of the quotient from the data of the
quotient graph. This should agree with self.genus().</p>
<p>OUTPUT:</p>
<p>An integer</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="mi">29</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">genus_no_formula</span><span class="p">()</span>
<span class="go">17</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">genus_no_formula</span><span class="p">()</span> <span class="o">==</span> <span class="n">X</span><span class="o">.</span><span class="n">genus</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_edge_list">
<span class="sig-name descname"><span class="pre">get_edge_list</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_edge_list" title="Link to this definition">#</a></dt>
<dd><p>Return a list of <code class="docutils literal notranslate"><span class="pre">Edge</span></code> which represent a fundamental
domain inside the Bruhat-Tits tree for the quotient.</p>
<p>OUTPUT:</p>
<p>A list of <code class="docutils literal notranslate"><span class="pre">Edge</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">get_edge_list</span><span class="p">())</span>
<span class="go">8</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_edge_stabilizers">
<span class="sig-name descname"><span class="pre">get_edge_stabilizers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_edge_stabilizers" title="Link to this definition">#</a></dt>
<dd><p>Compute the stabilizers in the arithmetic group of all
edges in the Bruhat-Tits tree within a fundamental domain for
the quotient graph. The stabilizers of an edge and its
opposite are equal, and so we only store half the data.</p>
<p>OUTPUT:</p>
<p>A list of lists encoding edge stabilizers. It contains one
entry for each edge. Each entry is a list of data
corresponding to the group elements in the stabilizer of the
edge. The data consists of: (0) a column matrix representing
a quaternion, (1) the power of <span class="math notranslate nohighlight">\(p\)</span> that one needs to divide
by in order to obtain a quaternion of norm 1, and hence an
element of the arithmetic group <span class="math notranslate nohighlight">\(\Gamma\)</span>, (2) a boolean that
is only used to compute spaces of modular forms.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">get_edge_stabilizers</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="n">X</span><span class="o">.</span><span class="n">get_num_ordered_edges</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_eichler_order">
<span class="sig-name descname"><span class="pre">get_eichler_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">magma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_computation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_eichler_order" title="Link to this definition">#</a></dt>
<dd><p>Return the underlying Eichler order of level <span class="math notranslate nohighlight">\(N^+\)</span>.</p>
<p>OUTPUT:</p>
<p>An Eichler order.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_eichler_order</span><span class="p">()</span>
<span class="go">Order of Quaternion Algebra (-1, -7) with base ring Rational Field with basis (1/2 + 1/2*j, 1/2*i + 1/2*k, j, k)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_eichler_order_basis">
<span class="sig-name descname"><span class="pre">get_eichler_order_basis</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_eichler_order_basis" title="Link to this definition">#</a></dt>
<dd><p>Return a basis for the global Eichler order.</p>
<p>OUTPUT:</p>
<p>Basis for the underlying Eichler order of level Nplus.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_eichler_order_basis</span><span class="p">()</span>
<span class="go">[1/2 + 1/2*j, 1/2*i + 1/2*k, j, k]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_eichler_order_quadform">
<span class="sig-name descname"><span class="pre">get_eichler_order_quadform</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_eichler_order_quadform" title="Link to this definition">#</a></dt>
<dd><p>This function return the norm form for the underlying
Eichler order of level <code class="docutils literal notranslate"><span class="pre">Nplus</span></code>. Required for finding elements in
the arithmetic subgroup Gamma.</p>
<p>OUTPUT:</p>
<p>The norm form of the underlying Eichler order</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_eichler_order_quadform</span><span class="p">()</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 3 0 11 0 ]</span>
<span class="go">[ * 3 0 11 ]</span>
<span class="go">[ * * 11 0 ]</span>
<span class="go">[ * * * 11 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_eichler_order_quadmatrix">
<span class="sig-name descname"><span class="pre">get_eichler_order_quadmatrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_eichler_order_quadmatrix" title="Link to this definition">#</a></dt>
<dd><p>This function returns the matrix of the quadratic form of
the underlying Eichler order in the fixed basis.</p>
<p>OUTPUT:</p>
<p>A 4x4 integral matrix describing the norm form.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_eichler_order_quadmatrix</span><span class="p">()</span>
<span class="go">[ 6  0 11  0]</span>
<span class="go">[ 0  6  0 11]</span>
<span class="go">[11  0 22  0]</span>
<span class="go">[ 0 11  0 22]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_embedding">
<span class="sig-name descname"><span class="pre">get_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_embedding" title="Link to this definition">#</a></dt>
<dd><p>Return a function which embeds quaternions into a matrix
algebra.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">get_embedding</span><span class="p">(</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">[2 + 3*5 + 2*5^2 + 4*5^3 + O(5^4)       3 + 2*5^2 + 4*5^3 + O(5^4)]</span>
<span class="go">[        5 + 5^2 + 3*5^3 + O(5^4)           4 + 5 + 2*5^2 + O(5^4)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_embedding_matrix">
<span class="sig-name descname"><span class="pre">get_embedding_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_embedding_matrix" title="Link to this definition">#</a></dt>
<dd><p>Return the matrix of the embedding.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">exact</span></code> boolean (Default: <code class="docutils literal notranslate"><span class="pre">False</span></code>). If <code class="docutils literal notranslate"><span class="pre">True</span></code>, return an
embedding into a matrix algebra with coefficients in a
number field. Otherwise, embed into matrices over <span class="math notranslate nohighlight">\(p\)</span>-adic
numbers.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> Integer (Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>). If specified, return the
matrix with precision <code class="docutils literal notranslate"><span class="pre">prec</span></code>. Otherwise, return the
cached matrix (with the current working precision).</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>A 4x4 matrix representing the embedding.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_embedding_matrix</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">[                      1 + O(7^4)         5 + 2*7 + 3*7^3 + O(7^4) 4 + 5*7 + 6*7^2 + 6*7^3 + O(7^4)       6 + 3*7^2 + 4*7^3 + O(7^4)]</span>
<span class="go">[                          O(7^4)                           O(7^4)                   3 + 7 + O(7^4) 1 + 6*7 + 3*7^2 + 2*7^3 + O(7^4)]</span>
<span class="go">[                          O(7^4)         2 + 5*7 + 6*7^3 + O(7^4) 3 + 5*7 + 6*7^2 + 6*7^3 + O(7^4)         3 + 3*7 + 3*7^2 + O(7^4)]</span>
<span class="go">[                      1 + O(7^4) 3 + 4*7 + 6*7^2 + 3*7^3 + O(7^4)                   3 + 7 + O(7^4) 1 + 6*7 + 3*7^2 + 2*7^3 + O(7^4)]</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_embedding_matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[                      1 + O(7^4)         5 + 2*7 + 3*7^3 + O(7^4) 4 + 5*7 + 6*7^2 + 6*7^3 + O(7^4)       6 + 3*7^2 + 4*7^3 + O(7^4)]</span>
<span class="go">[                          O(7^4)                           O(7^4)                   3 + 7 + O(7^4) 1 + 6*7 + 3*7^2 + 2*7^3 + O(7^4)]</span>
<span class="go">[                          O(7^4)         2 + 5*7 + 6*7^3 + O(7^4) 3 + 5*7 + 6*7^2 + 6*7^3 + O(7^4)         3 + 3*7 + 3*7^2 + O(7^4)]</span>
<span class="go">[                      1 + O(7^4) 3 + 4*7 + 6*7^2 + 3*7^3 + O(7^4)                   3 + 7 + O(7^4) 1 + 6*7 + 3*7^2 + 2*7^3 + O(7^4)]</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_embedding_matrix</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[                              1 + O(7^5)         5 + 2*7 + 3*7^3 + 6*7^4 + O(7^5) 4 + 5*7 + 6*7^2 + 6*7^3 + 6*7^4 + O(7^5)       6 + 3*7^2 + 4*7^3 + 5*7^4 + O(7^5)]</span>
<span class="go">[                                  O(7^5)                                   O(7^5)                           3 + 7 + O(7^5)   1 + 6*7 + 3*7^2 + 2*7^3 + 7^4 + O(7^5)]</span>
<span class="go">[                                  O(7^5)         2 + 5*7 + 6*7^3 + 5*7^4 + O(7^5) 3 + 5*7 + 6*7^2 + 6*7^3 + 6*7^4 + O(7^5)         3 + 3*7 + 3*7^2 + 5*7^4 + O(7^5)]</span>
<span class="go">[                              1 + O(7^5)         3 + 4*7 + 6*7^2 + 3*7^3 + O(7^5)                           3 + 7 + O(7^5)   1 + 6*7 + 3*7^2 + 2*7^3 + 7^4 + O(7^5)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_extra_embedding_matrices">
<span class="sig-name descname"><span class="pre">get_extra_embedding_matrices</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_extra_embedding_matrices" title="Link to this definition">#</a></dt>
<dd><p>Return a list of  matrices representing the different embeddings.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The precision is very low (currently set to 5 digits),
since these embeddings are only used to apply a character.</p>
</div>
<p>EXAMPLES:</p>
<p>This portion of the code is only relevant when working with a
nontrivial Dirichlet character. If there is no such character
then the code returns an empty list. Even if the character is
not trivial it might return an empty list:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">DirichletGroup</span><span class="p">(</span><span class="mi">6</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="mi">7</span><span class="p">,</span><span class="n">character</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_extra_embedding_matrices</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">DirichletGroup</span><span class="p">(</span><span class="mi">6</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">character</span> <span class="o">=</span> <span class="n">f</span><span class="p">,</span> <span class="n">use_magma</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># optional - magma</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_extra_embedding_matrices</span><span class="p">()</span> <span class="c1"># optional - magma</span>
<span class="go">[</span>
<span class="go">[1 0 2 0]</span>
<span class="go">[0 0 2 0]</span>
<span class="go">[0 0 0 0]</span>
<span class="go">[1 0 2 2]</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_fundom_graph">
<span class="sig-name descname"><span class="pre">get_fundom_graph</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_fundom_graph" title="Link to this definition">#</a></dt>
<dd><p>Return the fundamental domain (and computes it if needed).</p>
<p>OUTPUT:</p>
<p>A fundamental domain for the action of <span class="math notranslate nohighlight">\(\Gamma\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_fundom_graph</span><span class="p">()</span>
<span class="go">Graph on 24 vertices</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_generators">
<span class="sig-name descname"><span class="pre">get_generators</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_generators" title="Link to this definition">#</a></dt>
<dd><p>Use a fundamental domain in the Bruhat-Tits tree, and
certain gluing data for boundary vertices, in order to compute
a collection of generators for the arithmetic quaternionic
group that one is quotienting by. This is analogous to using a
polygonal rep. of a compact real surface to present its
fundamental domain.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>A generating list of elements of an arithmetic
quaternionic group.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">get_generators</span><span class="p">())</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_graph">
<span class="sig-name descname"><span class="pre">get_graph</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_graph" title="Link to this definition">#</a></dt>
<dd><p>Return the quotient graph (and compute it if needed).</p>
<p>OUTPUT:</p>
<p>A graph representing the quotient of the Bruhat-Tits tree.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_graph</span><span class="p">()</span>
<span class="go">Multi-graph on 2 vertices</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_list">
<span class="sig-name descname"><span class="pre">get_list</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_list" title="Link to this definition">#</a></dt>
<dd><p>Return a list of <code class="docutils literal notranslate"><span class="pre">Edge</span></code> which represent a fundamental
domain inside the Bruhat-Tits tree for the quotient,
together with a list of the opposite edges. This is used
to work with automorphic forms.</p>
<p>OUTPUT:</p>
<p>A list of <code class="docutils literal notranslate"><span class="pre">Edge</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">get_list</span><span class="p">())</span>
<span class="go">16</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_maximal_order">
<span class="sig-name descname"><span class="pre">get_maximal_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">magma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_computation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_maximal_order" title="Link to this definition">#</a></dt>
<dd><p>Return the underlying maximal order containing the
Eichler order.</p>
<p>OUTPUT:</p>
<p>A maximal order.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_maximal_order</span><span class="p">()</span>
<span class="go">Order of Quaternion Algebra (-1, -7) with base ring Rational Field with basis (1/2 + 1/2*j, 1/2*i + 1/2*k, j, k)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_nontorsion_generators">
<span class="sig-name descname"><span class="pre">get_nontorsion_generators</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_nontorsion_generators" title="Link to this definition">#</a></dt>
<dd><p>Use a fundamental domain in the Bruhat-Tits tree, and
certain gluing data for boundary vertices, in order to compute
a collection of generators for the nontorsion part
of the arithmetic quaternionic group that one is quotienting by.
This is analogous to using a polygonal rep. of a compact real
surface to present its fundamental domain.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>A generating list of elements of an arithmetic
quaternionic group.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">get_nontorsion_generators</span><span class="p">())</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_num_ordered_edges">
<span class="sig-name descname"><span class="pre">get_num_ordered_edges</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_num_ordered_edges" title="Link to this definition">#</a></dt>
<dd><p>Return the number of ordered edges <span class="math notranslate nohighlight">\(E\)</span> in the quotient using
the formula relating the genus <span class="math notranslate nohighlight">\(g\)</span> with the number of vertices <span class="math notranslate nohighlight">\(V\)</span>
and that of unordered edges <span class="math notranslate nohighlight">\(E/2\)</span>: <span class="math notranslate nohighlight">\(E = 2(g + V - 1)\)</span>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>An integer</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_num_ordered_edges</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_num_verts">
<span class="sig-name descname"><span class="pre">get_num_verts</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_num_verts" title="Link to this definition">#</a></dt>
<dd><p>Return the number of vertices in the quotient using the formula
<span class="math notranslate nohighlight">\(V = 2(\mu/12 + e_3/3 + e_4/4)\)</span>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>An integer (the number of vertices)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">29</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_num_verts</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_quaternion_algebra">
<span class="sig-name descname"><span class="pre">get_quaternion_algebra</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_quaternion_algebra" title="Link to this definition">#</a></dt>
<dd><p>Return the underlying quaternion algebra.</p>
<p>OUTPUT:</p>
<p>The underlying definite quaternion algebra</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_quaternion_algebra</span><span class="p">()</span>
<span class="go">Quaternion Algebra (-1, -7) with base ring Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_splitting_field">
<span class="sig-name descname"><span class="pre">get_splitting_field</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_splitting_field" title="Link to this definition">#</a></dt>
<dd><p>Return a quadratic field that splits the quaternion
algebra attached to <code class="docutils literal notranslate"><span class="pre">self</span></code>. Currently requires Magma.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_splitting_field</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError: Sage does not know yet how to work with the kind of orders that you are trying to use. Try installing Magma first and set it up so that Sage can use it.</span>
</pre></div>
</div>
<p>If we do have Magma installed, then it works:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="n">use_magma</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># optional - magma</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_splitting_field</span><span class="p">()</span> <span class="c1"># optional - magma</span>
<span class="go">Number Field in a with defining polynomial X1^2 + 11</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_stabilizers">
<span class="sig-name descname"><span class="pre">get_stabilizers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_stabilizers" title="Link to this definition">#</a></dt>
<dd><p>Compute the stabilizers in the arithmetic group of all
edges in the Bruhat-Tits tree within a fundamental domain for
the quotient graph. This is similar to get_edge_stabilizers, except
that here we also store the stabilizers of the opposites.</p>
<p>OUTPUT:</p>
<p>A list of lists encoding edge stabilizers. It contains one
entry for each edge. Each entry is a list of data
corresponding to the group elements in the stabilizer of the
edge. The data consists of: (0) a column matrix representing
a quaternion, (1) the power of <span class="math notranslate nohighlight">\(p\)</span> that one needs to divide
by in order to obtain a quaternion of norm 1, and hence an
element of the arithmetic group <span class="math notranslate nohighlight">\(\Gamma\)</span>, (2) a boolean that
is only used to compute spaces of modular forms.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">get_stabilizers</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="n">X</span><span class="o">.</span><span class="n">get_num_ordered_edges</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">gamma</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">embed_quaternion</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">get_edge_list</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rep</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">_BT</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">gamma</span><span class="o">*</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="n">v</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_units_of_order">
<span class="sig-name descname"><span class="pre">get_units_of_order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_units_of_order" title="Link to this definition">#</a></dt>
<dd><p>Return the units of the underlying Eichler
<span class="math notranslate nohighlight">\(\ZZ\)</span>-order. This is a finite group since the order lives in a
definite quaternion algebra over <span class="math notranslate nohighlight">\(\QQ\)</span>.</p>
<p>OUTPUT:</p>
<p>A list of elements of the global Eichler <span class="math notranslate nohighlight">\(\ZZ\)</span>-order of
level <span class="math notranslate nohighlight">\(N^+\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_units_of_order</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">[ 0]  [-2]</span>
<span class="go">[-2]  [ 0]</span>
<span class="go">[ 0]  [ 1]</span>
<span class="go">[ 1], [ 0]</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_vertex_dict">
<span class="sig-name descname"><span class="pre">get_vertex_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_vertex_dict" title="Link to this definition">#</a></dt>
<dd><p>This function returns the vertices of the quotient viewed as
a dict.</p>
<p>OUTPUT:</p>
<p>A python dict with the vertices of the quotient.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_vertex_dict</span><span class="p">()</span>
<span class="go">{[1 0]</span>
<span class="go">[0 1]: Vertex of Bruhat-Tits tree for p = 37, [ 1  0]</span>
<span class="go">[ 0 37]: Vertex of Bruhat-Tits tree for p = 37}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_vertex_list">
<span class="sig-name descname"><span class="pre">get_vertex_list</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_vertex_list" title="Link to this definition">#</a></dt>
<dd><p>Return a list of the vertices of the quotient.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>A list with the vertices of the quotient.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_vertex_list</span><span class="p">()</span>
<span class="go">[Vertex of Bruhat-Tits tree for p = 37, Vertex of Bruhat-Tits tree for p = 37]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_vertex_stabs">
<span class="sig-name descname"><span class="pre">get_vertex_stabs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_vertex_stabs" title="Link to this definition">#</a></dt>
<dd><p>This function computes the stabilizers in the arithmetic
group of all vertices in the Bruhat-Tits tree within a
fundamental domain for the quotient graph.</p>
<p>OUTPUT:</p>
<p>A list of vertex stabilizers. Each vertex stabilizer is a
finite cyclic subgroup, so we return generators for these
subgroups.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">get_vertex_stabs</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">gamma</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">embed_quaternion</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">get_vertex_list</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rep</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">_BT</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span><span class="n">gamma</span><span class="o">*</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="n">v</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.harmonic_cocycle_from_elliptic_curve">
<span class="sig-name descname"><span class="pre">harmonic_cocycle_from_elliptic_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.harmonic_cocycle_from_elliptic_curve" title="Link to this definition">#</a></dt>
<dd><p>Return a harmonic cocycle with the same Hecke eigenvalues as <code class="docutils literal notranslate"><span class="pre">E</span></code>.</p>
<p>Given an elliptic curve <span class="math notranslate nohighlight">\(E\)</span> having a conductor <span class="math notranslate nohighlight">\(N\)</span> of the form <span class="math notranslate nohighlight">\(pN^-N^+\)</span>,
return the harmonic cocycle over <code class="docutils literal notranslate"><span class="pre">self</span></code> which is attached to <code class="docutils literal notranslate"><span class="pre">E</span></code> via
modularity. The result is only well-defined up to scaling.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">E</span></code> – an elliptic curve over the rational numbers</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> – (default: None) If specified, the harmonic cocycle will take values
in <span class="math notranslate nohighlight">\(\QQ_p\)</span> with precision <code class="docutils literal notranslate"><span class="pre">prec</span></code>. Otherwise it will take values in <span class="math notranslate nohighlight">\(\ZZ\)</span>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A harmonic cocycle attached via modularity to the given elliptic curve.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;21a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">harmonic_cocycle_from_elliptic_curve</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T29</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">hecke_operator</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T29</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">==</span> <span class="n">E</span><span class="o">.</span><span class="n">ap</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span> <span class="o">*</span> <span class="n">f</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;51a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">17</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">harmonic_cocycle_from_elliptic_curve</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T31</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">hecke_operator</span><span class="p">(</span><span class="mi">31</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T31</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">==</span> <span class="n">E</span><span class="o">.</span><span class="n">ap</span><span class="p">(</span><span class="mi">31</span><span class="p">)</span> <span class="o">*</span> <span class="n">f</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.harmonic_cocycles">
<span class="sig-name descname"><span class="pre">harmonic_cocycles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.harmonic_cocycles" title="Link to this definition">#</a></dt>
<dd><p>Compute the space of harmonic cocycles of a given even weight <code class="docutils literal notranslate"><span class="pre">k</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">k</span></code> - integer - The weight. It must be even.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> - integer (default: None). If specified, the
precision for the coefficient module</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">basis_matrix</span></code> - a matrix (default: None).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">base_field</span></code> - a ring (default: None)</p></li>
</ul>
<p>OUTPUT: A space of harmonic cocycles</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">harmonic_cocycles</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">prec</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span>
<span class="go">Space of harmonic cocycles of weight 2 on Quotient of the Bruhat Tits tree of GL_2(QQ_31) with discriminant 7 and level 1</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">basis</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Harmonic cocycle with values in Sym^0 Q_31^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.is_admissible">
<span class="sig-name descname"><span class="pre">is_admissible</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.is_admissible" title="Link to this definition">#</a></dt>
<dd><p>Test whether the imaginary quadratic field of
discriminant <span class="math notranslate nohighlight">\(D\)</span> embeds in the quaternion algebra. It
furthermore tests the Heegner hypothesis in this setting
(e.g., is <span class="math notranslate nohighlight">\(p\)</span> inert in the field, etc).</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">D</span></code> - an integer whose squarefree part will define the
quadratic field</p></li>
</ul>
<p>OUTPUT:</p>
<p>A boolean describing whether the quadratic field is admissible</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">X</span><span class="o">.</span><span class="n">is_admissible</span><span class="p">(</span><span class="n">D</span><span class="p">)</span> <span class="k">for</span> <span class="n">D</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
<span class="go">[False, True, False, False, False, False, False, True, False, False, False, False, False, False, False, False, False, True, False]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.level">
<span class="sig-name descname"><span class="pre">level</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.level" title="Link to this definition">#</a></dt>
<dd><p>Return <span class="math notranslate nohighlight">\(p N^-\)</span>, which is the discriminant of the
indefinite quaternion algebra that is uniformed by
Cerednik-Drinfeld.</p>
<p>OUTPUT:</p>
<p>An integer equal to <span class="math notranslate nohighlight">\(p N^-\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">level</span><span class="p">()</span>
<span class="go">35</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.mu">
<span class="sig-name descname"><span class="pre">mu</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.mu" title="Link to this definition">#</a></dt>
<dd><p>Compute the mu invariant of self.</p>
<p>OUTPUT:</p>
<p>An integer.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">29</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">mu</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.padic_automorphic_forms">
<span class="sig-name descname"><span class="pre">padic_automorphic_forms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">U</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overconvergent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.padic_automorphic_forms" title="Link to this definition">#</a></dt>
<dd><p>The module of (quaternionic) <span class="math notranslate nohighlight">\(p\)</span>-adic automorphic forms over <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">U</span></code> – A distributions module or an integer. If <code class="docutils literal notranslate"><span class="pre">U</span></code> is a
distributions module then this creates the relevant space of
automorphic forms. If <code class="docutils literal notranslate"><span class="pre">U</span></code> is an integer then the coefficients
are the (<span class="math notranslate nohighlight">\(U-2\)</span>)nd power of the symmetric representation of
<span class="math notranslate nohighlight">\(GL_2(\QQ_p)\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> – A precision (default : None). If not None should
be a positive integer.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">t</span></code> – (default : None). The number of additional moments to store. If None, determine
it automatically from <code class="docutils literal notranslate"><span class="pre">prec</span></code>, <code class="docutils literal notranslate"><span class="pre">U</span></code> and the <code class="docutils literal notranslate"><span class="pre">overconvergent</span></code> flag.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">R</span></code> – (default : None). If specified, coefficient field of the automorphic forms.
If not specified it defaults to the base ring of the distributions <code class="docutils literal notranslate"><span class="pre">U</span></code>, or to <span class="math notranslate nohighlight">\(\QQ_p\)</span>
with the working precision <code class="docutils literal notranslate"><span class="pre">prec</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">overconvergent</span></code> – Boolean (default = False). If True, will construct overconvergent
<span class="math notranslate nohighlight">\(p\)</span>-adic automorphic forms. Otherwise it constructs the finite dimensional space of
<span class="math notranslate nohighlight">\(p\)</span>-adic automorphic forms which is isomorphic to the space of harmonic cocycles.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">padic_automorphic_forms</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">prec</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">Space of automorphic forms on Quotient of the Bruhat Tits tree of GL_2(QQ_11) with discriminant 5 and level 1 with values in Sym^0 Q_11^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.plot" title="Link to this definition">#</a></dt>
<dd><p>Plot the quotient graph.</p>
<p>OUTPUT:</p>
<p>A plot of the quotient graph</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>                                                              <span class="c1"># needs sage.plot</span>
<span class="go">Graphics object consisting of 17 graphics primitives</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.plot_fundom">
<span class="sig-name descname"><span class="pre">plot_fundom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.plot_fundom" title="Link to this definition">#</a></dt>
<dd><p>Plot a fundamental domain.</p>
<p>OUTPUT:</p>
<p>A plot of the fundamental domain.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">plot_fundom</span><span class="p">()</span>                                                       <span class="c1"># needs sage.plot</span>
<span class="go">Graphics object consisting of 88 graphics primitives</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.prime">
<span class="sig-name descname"><span class="pre">prime</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.prime" title="Link to this definition">#</a></dt>
<dd><p>Return the prime one is working with.</p>
<p>OUTPUT:</p>
<p>An integer equal to the fixed prime <span class="math notranslate nohighlight">\(p\)</span></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">prime</span><span class="p">()</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsTree">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.modular.btquotients.btquotient.</span></span><span class="sig-name descname"><span class="pre">BruhatTitsTree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Parents and Elements v10.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SageObject</span></code></a>, <a class="reference external" href="../../../../structure/sage/structure/unique_representation.html#sage.structure.unique_representation.UniqueRepresentation" title="(in Parents and Elements v10.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniqueRepresentation</span></code></a></p>
<p>An implementation of the Bruhat-Tits tree for <span class="math notranslate nohighlight">\(GL_2(\QQ_p)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> - a prime number. The corresponding tree is then <span class="math notranslate nohighlight">\(p+1\)</span> regular</p></li>
</ul>
<p>EXAMPLES:</p>
<p>We create the tree for <span class="math notranslate nohighlight">\(GL_2(\QQ_5)\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="n">p</span><span class="o">**</span><span class="mi">5</span><span class="p">,</span><span class="n">p</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="n">p</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="n">p</span><span class="o">+</span><span class="n">p</span><span class="o">*</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">m</span><span class="p">);</span> <span class="n">e</span>
<span class="go">[  0  25]</span>
<span class="go">[625  21]</span>
<span class="gp">sage: </span><span class="n">v0</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">origin</span><span class="p">(</span><span class="n">e</span><span class="p">);</span> <span class="n">v0</span>
<span class="go">[ 25   0]</span>
<span class="go">[ 21 125]</span>
<span class="gp">sage: </span><span class="n">v1</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">target</span><span class="p">(</span><span class="n">e</span><span class="p">);</span> <span class="n">v1</span>
<span class="go">[ 25   0]</span>
<span class="go">[ 21 625]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">origin</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">opposite</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="o">==</span> <span class="n">v1</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">target</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">opposite</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="o">==</span> <span class="n">v0</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A value error is raised if a prime is not passed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: input (4) must be prime</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Marc Masdeu (2012-02-20)</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsTree.edge">
<span class="sig-name descname"><span class="pre">edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.edge" title="Link to this definition">#</a></dt>
<dd><p>Normalize a matrix to the correct normalized edge
representative.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">M</span></code> - a 2x2 integer matrix</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">newM</span></code> - a 2x2 integer matrix</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
<span class="go">[0 1]</span>
<span class="go">[3 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsTree.edge_between_vertices">
<span class="sig-name descname"><span class="pre">edge_between_vertices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.edge_between_vertices" title="Link to this definition">#</a></dt>
<dd><p>Compute the normalized matrix rep. for the edge
passing between two vertices.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">v1</span></code> - 2x2 integer matrix</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">v2</span></code> - 2x2 integer matrix</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">normalized</span></code> - boolean (default: False), whether the
vertices are normalized.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>2x2 integer matrix, representing the edge from <code class="docutils literal notranslate"><span class="pre">v1</span></code> to
<code class="docutils literal notranslate"><span class="pre">v2</span></code>.  If <code class="docutils literal notranslate"><span class="pre">v1</span></code> and <code class="docutils literal notranslate"><span class="pre">v2</span></code> are not at distance <span class="math notranslate nohighlight">\(1\)</span>, raise
a <a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ValueError</span></code></a>.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v1</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="n">p</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]));</span> <span class="n">v1</span>
<span class="go">[7 0]</span>
<span class="go">[0 1]</span>
<span class="gp">sage: </span><span class="n">v2</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="n">p</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]));</span> <span class="n">v2</span>
<span class="go">[1 0]</span>
<span class="go">[1 7]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">edge_between_vertices</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Vertices are not adjacent.</span>

<span class="gp">sage: </span><span class="n">v3</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]));</span> <span class="n">v3</span>
<span class="go">[1 0]</span>
<span class="go">[0 1]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">edge_between_vertices</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">v3</span><span class="p">)</span>
<span class="go">[0 1]</span>
<span class="go">[1 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsTree.edges_leaving_origin">
<span class="sig-name descname"><span class="pre">edges_leaving_origin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.edges_leaving_origin" title="Link to this definition">#</a></dt>
<dd><p>Find normalized representatives for the <span class="math notranslate nohighlight">\(p+1\)</span> edges
leaving the origin vertex corresponding to the homothety class
of <span class="math notranslate nohighlight">\(\ZZ_p^2\)</span>. These are cached.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>A list of size <span class="math notranslate nohighlight">\(p+1\)</span> of 2x2 integer matrices</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">edges_leaving_origin</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">[0 1]  [3 0]  [0 1]  [0 1]</span>
<span class="go">[3 0], [0 1], [3 1], [3 2]</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsTree.entering_edges">
<span class="sig-name descname"><span class="pre">entering_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.entering_edges" title="Link to this definition">#</a></dt>
<dd><p>This function returns the edges entering a given vertex.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code> - 2x2 integer matrix</p></li>
</ul>
<p>OUTPUT:</p>
<p>A list of size <span class="math notranslate nohighlight">\(p+1\)</span> of 2x2 integer matrices</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">entering_edges</span><span class="p">(</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">[</span>
<span class="go">[1 0]  [0 1]  [1 0]  [1 0]  [1 0]  [1 0]  [1 0]  [1 0]</span>
<span class="go">[0 1], [1 0], [1 1], [4 1], [5 1], [2 1], [3 1], [6 1]</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsTree.find_containing_affinoid">
<span class="sig-name descname"><span class="pre">find_containing_affinoid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.find_containing_affinoid" title="Link to this definition">#</a></dt>
<dd><p>Return the vertex corresponding to the affinoid in the
<span class="math notranslate nohighlight">\(p\)</span>-adic upper half plane that a given (unramified!) point
reduces to.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">z</span></code> - an element of an unramified extension of <span class="math notranslate nohighlight">\(\QQ_p\)</span>
that is not contained in <span class="math notranslate nohighlight">\(\QQ_p\)</span>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A 2x2 integer matrix representing a vertex of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.rings.padics</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Qq</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">find_containing_affinoid</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">[1 0]</span>
<span class="go">[0 1]</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">find_containing_affinoid</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">inverse</span><span class="p">();</span> <span class="n">v</span>
<span class="go">[   1    0]</span>
<span class="go">[-2/5  1/5]</span>
</pre></div>
</div>
<p>Note that the translate of <code class="docutils literal notranslate"><span class="pre">z</span></code> belongs to the standard
affinoid. That is, it is a <span class="math notranslate nohighlight">\(p\)</span>-adic unit and its reduction
modulo <span class="math notranslate nohighlight">\(p\)</span> is not in <span class="math notranslate nohighlight">\(\GF{p}\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">gz</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">z</span><span class="o">+</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">z</span><span class="o">+</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span> <span class="n">gz</span>                          <span class="c1"># needs sage.rings.padics</span>
<span class="go">(a + 1) + O(5^19)</span>
<span class="gp">sage: </span><span class="n">gz</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>                                                   <span class="c1"># needs sage.rings.padics</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsTree.find_covering">
<span class="sig-name descname"><span class="pre">find_covering</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.find_covering" title="Link to this definition">#</a></dt>
<dd><p>Compute a covering of <span class="math notranslate nohighlight">\(P^1(\QQ_p)\)</span> adapted to a certain
geodesic in self.</p>
<p>More precisely, the <span class="math notranslate nohighlight">\(p\)</span>-adic upper half plane points <code class="docutils literal notranslate"><span class="pre">z1</span></code>
and <code class="docutils literal notranslate"><span class="pre">z2</span></code> reduce to vertices <span class="math notranslate nohighlight">\(v_1\)</span>, <span class="math notranslate nohighlight">\(v_2\)</span>.
The returned covering consists of all the edges leaving the
geodesic from <span class="math notranslate nohighlight">\(v_1\)</span> to <span class="math notranslate nohighlight">\(v_2\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">z1</span></code>, <code class="docutils literal notranslate"><span class="pre">z2</span></code> - unramified algebraic points of h_p</p></li>
</ul>
<p>OUTPUT:</p>
<p>a list of 2x2 integer matrices representing edges of self</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.rings.padics</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Qq</span><span class="p">(</span><span class="n">p</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z1</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">p</span>
<span class="gp">sage: </span><span class="n">z2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">p</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">p</span><span class="o">^</span><span class="mi">6</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">find_covering</span><span class="p">(</span><span class="n">z1</span><span class="p">,</span><span class="n">z2</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">[0 1]  [3 0]  [0 1]  [0 1]  [0 1]  [0 1]</span>
<span class="go">[3 0], [0 1], [3 2], [9 1], [9 4], [9 7]</span>
<span class="go">]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is used to compute certain Coleman integrals
on <span class="math notranslate nohighlight">\(P^1\)</span>. That’s why the input consists of two points of
the <span class="math notranslate nohighlight">\(p\)</span>-adic upper half plane, but decomposes
<span class="math notranslate nohighlight">\(P^1(\QQ_p)\)</span>. This decomposition is what allows us to
represent the relevant integrand as a locally analytic
function. The <code class="docutils literal notranslate"><span class="pre">z1</span></code> and <code class="docutils literal notranslate"><span class="pre">z2</span></code> appear in the integrand.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsTree.find_geodesic">
<span class="sig-name descname"><span class="pre">find_geodesic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.find_geodesic" title="Link to this definition">#</a></dt>
<dd><p>This function computes the geodesic between two vertices</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">v1</span></code> - 2x2 integer matrix representing a vertex</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">v2</span></code> - 2x2 integer matrix representing a vertex</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">normalized</span></code> - boolean (default: True)</p></li>
</ul>
<p>OUTPUT:</p>
<p>An ordered list of 2x2 integer matrices representing the vertices
of the paths joining <code class="docutils literal notranslate"><span class="pre">v1</span></code> and <code class="docutils literal notranslate"><span class="pre">v2</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v1</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="n">p</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="o">^</span><span class="mi">1</span><span class="p">])</span> <span class="p">);</span> <span class="n">v1</span>
<span class="go">[27  0]</span>
<span class="go">[ 1  3]</span>
<span class="gp">sage: </span><span class="n">v2</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">p</span><span class="p">])</span> <span class="p">);</span> <span class="n">v2</span>
<span class="go">[1 0]</span>
<span class="go">[6 9]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">find_geodesic</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">[27  0]  [27  0]  [9 0]  [3 0]  [1 0]  [1 0]  [1 0]</span>
<span class="go">[ 1  3], [ 0  1], [0 1], [0 1], [0 1], [0 3], [6 9]</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsTree.find_path">
<span class="sig-name descname"><span class="pre">find_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.find_path" title="Link to this definition">#</a></dt>
<dd><p>Compute a path from a vertex to a given set of so-called
boundary vertices, whose interior must contain the origin
vertex.  In the case that the boundary is not specified, it
computes the geodesic between the given vertex and the origin.
In the case that the boundary contains more than one vertex,
it computes the geodesic to some point of the boundary.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code> - a 2x2 matrix representing a vertex <code class="docutils literal notranslate"><span class="pre">boundary</span></code></p></li>
<li><p>a list of matrices (default: None). If omitted, finds the
geodesic from <code class="docutils literal notranslate"><span class="pre">v</span></code> to the central vertex.</p></li>
</ul>
<p>OUTPUT:</p>
<p>An ordered list of vertices describing the geodesic from
<code class="docutils literal notranslate"><span class="pre">v</span></code> to <code class="docutils literal notranslate"><span class="pre">boundary</span></code>, followed by the vertex in the boundary
that is closest to <code class="docutils literal notranslate"><span class="pre">v</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">find_path</span><span class="p">(</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="n">p</span><span class="o">^</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
<span class="go">(</span>
<span class="go">[[81  0]</span>
<span class="go">[ 0  1], [27  0]</span>
<span class="go">[ 0  1], [9 0]</span>
<span class="go">[0 1], [3 0]      [1 0]</span>
<span class="go">[0 1]]          , [0 1]</span>
<span class="go">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">find_path</span><span class="p">(</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="n">p</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">134</span><span class="p">,</span><span class="n">p</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span> <span class="p">)</span>
<span class="go">(</span>
<span class="go">[[27  0]</span>
<span class="go">[ 8  9], [27  0]</span>
<span class="go">[ 2  3], [27  0]</span>
<span class="go">[ 0  1], [9 0]</span>
<span class="go">[0 1], [3 0]      [1 0]</span>
<span class="go">[0 1]]          , [0 1]</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsTree.get_balls">
<span class="sig-name descname"><span class="pre">get_balls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.get_balls" title="Link to this definition">#</a></dt>
<dd><p>Return a decomposition of <span class="math notranslate nohighlight">\(P^1(\QQ_p)\)</span> into compact
open balls.</p>
<p>Each vertex in the Bruhat-Tits tree gives a decomposition of
<span class="math notranslate nohighlight">\(P^1(\QQ_p)\)</span> into <span class="math notranslate nohighlight">\(p+1\)</span> open balls. Each of these balls may
be further subdivided, to get a finer decomposition.</p>
<p>This function returns the decomposition of <span class="math notranslate nohighlight">\(P^1(\QQ_p)\)</span>
corresponding to <code class="docutils literal notranslate"><span class="pre">center</span></code> into <span class="math notranslate nohighlight">\((p+1)p^{\mbox{level}}\)</span> balls.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">get_balls</span><span class="p">(</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="n">p</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">[0 1]  [0 1]  [8 0]  [0 4]  [0 2]  [0 2]</span>
<span class="go">[2 0], [2 1], [0 1], [2 1], [4 1], [4 3]</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsTree.leaving_edges">
<span class="sig-name descname"><span class="pre">leaving_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.leaving_edges" title="Link to this definition">#</a></dt>
<dd><p>Return edges leaving a vertex</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">M</span></code> - 2x2 integer matrix</p></li>
</ul>
<p>OUTPUT:</p>
<p>List of size <span class="math notranslate nohighlight">\(p+1\)</span> of 2x2 integer matrices</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">leaving_edges</span><span class="p">(</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">[</span>
<span class="go">[0 1]  [7 0]  [0 1]  [0 1]  [0 1]  [0 1]  [0 1]  [0 1]</span>
<span class="go">[7 0], [0 1], [7 1], [7 4], [7 5], [7 2], [7 3], [7 6]</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsTree.opposite">
<span class="sig-name descname"><span class="pre">opposite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.opposite" title="Link to this definition">#</a></dt>
<dd><p>This function returns the edge oriented oppositely to a
given edge.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">e</span></code> - 2x2 integer matrix</p></li>
</ul>
<p>OUTPUT:</p>
<p>2x2 integer matrix</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">opposite</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="go">[0 1]</span>
<span class="go">[7 0]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">opposite</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">opposite</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="o">==</span> <span class="n">e</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsTree.origin">
<span class="sig-name descname"><span class="pre">origin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.origin" title="Link to this definition">#</a></dt>
<dd><p>Return the origin vertex of the edge represented by the
input matrix e.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">e</span></code> - a 2x2 matrix with integer entries</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">normalized</span></code> - boolean (default: false). If True
then the input matrix M is assumed to be normalized</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">e</span></code> - A 2x2 integer matrix</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">origin</span><span class="p">(</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]))</span>
<span class="go">[1 0]</span>
<span class="go">[1 7]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsTree.subdivide">
<span class="sig-name descname"><span class="pre">subdivide</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edgelist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.subdivide" title="Link to this definition">#</a></dt>
<dd><p>(Ordered) edges of self may be regarded as open balls in
<span class="math notranslate nohighlight">\(P^1(\QQ_p)\)</span>.  Given a list of edges, this function return a list
of edges corresponding to the level-th subdivision of the
corresponding opens.  That is, each open ball of the input is
broken up into <span class="math notranslate nohighlight">\(p^{\mbox{level}}\)</span> subballs of equal radius.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">edgelist</span></code> - a list of edges</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">level</span></code> - an integer</p></li>
</ul>
<p>OUTPUT:</p>
<p>A list of 2x2 integer matrices</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">subdivide</span><span class="p">([</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="n">p</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])],</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">[27  0]  [0 9]  [0 9]  [0 3]  [0 3]  [0 3]  [0 3]  [0 3]  [0 3]</span>
<span class="go">[ 0  1], [3 1], [3 2], [9 1], [9 4], [9 7], [9 2], [9 5], [9 8]</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsTree.target">
<span class="sig-name descname"><span class="pre">target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalized</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.target" title="Link to this definition">#</a></dt>
<dd><p>Return the target vertex of the edge represented by the
input matrix e.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">e</span></code> - a 2x2 matrix with integer entries</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">normalized</span></code> - boolean (default: false). If True</dt><dd><p>then the input matrix is assumed to be normalized.</p>
</dd>
</dl>
</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">e</span></code> - 2x2 integer matrix representing the target of
the input edge</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">target</span><span class="p">(</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]))</span>
<span class="go">[1 0]</span>
<span class="go">[0 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.BruhatTitsTree.vertex">
<span class="sig-name descname"><span class="pre">vertex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.vertex" title="Link to this definition">#</a></dt>
<dd><p>Normalize a matrix to the corresponding normalized
vertex representative</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">M</span></code> - 2x2 integer matrix</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a 2x2 integer matrix</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.rings.padics</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="n">p</span><span class="o">**</span><span class="mi">5</span><span class="p">,</span><span class="n">p</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="n">p</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="n">p</span><span class="o">+</span><span class="n">p</span><span class="o">*</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span><span class="o">*</span><span class="n">e</span>
<span class="gp">sage: </span><span class="n">scaling</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mi">20</span><span class="p">)(</span><span class="n">t</span><span class="o">.</span><span class="n">determinant</span><span class="p">())</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">scaling</span> <span class="o">*</span> <span class="n">t</span>
<span class="gp">sage: </span><span class="nb">min</span><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span><span class="n">jj</span><span class="p">]</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)])</span> <span class="o">&gt;=</span> <span class="mi">0</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.DoubleCosetReduction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.modular.btquotients.btquotient.</span></span><span class="sig-name descname"><span class="pre">DoubleCosetReduction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extrapow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.DoubleCosetReduction" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Parents and Elements v10.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SageObject</span></code></a></p>
<p>Edges in the Bruhat-Tits tree are represented by cosets of
matrices in <span class="math notranslate nohighlight">\(GL_2\)</span>. Given a matrix <span class="math notranslate nohighlight">\(x\)</span> in <span class="math notranslate nohighlight">\(GL_2\)</span>, this
class computes and stores the data corresponding to the
double coset representation of <span class="math notranslate nohighlight">\(x\)</span> in terms of a fundamental
domain of edges for the action of the arithmetic group <span class="math notranslate nohighlight">\(\Gamma\)</span>.</p>
<p>More precisely:</p>
<p>Initialized with an element <span class="math notranslate nohighlight">\(x\)</span> of <span class="math notranslate nohighlight">\(GL_2(\ZZ)\)</span>, finds elements
<span class="math notranslate nohighlight">\(\gamma\)</span> in <span class="math notranslate nohighlight">\(\Gamma\)</span>, <span class="math notranslate nohighlight">\(t\)</span> and an edge <span class="math notranslate nohighlight">\(e\)</span> such that <span class="math notranslate nohighlight">\(get=x\)</span>. It
stores these values as members <code class="docutils literal notranslate"><span class="pre">gamma</span></code>, <code class="docutils literal notranslate"><span class="pre">label</span></code> and functions
<code class="docutils literal notranslate"><span class="pre">self.sign()</span></code>,  <code class="docutils literal notranslate"><span class="pre">self.t()</span></code> and <code class="docutils literal notranslate"><span class="pre">self.igamma()</span></code>, satisfying:</p>
<ul class="simple">
<li><p>if <code class="docutils literal notranslate"><span class="pre">self.sign()</span> <span class="pre">==</span> <span class="pre">+1</span></code>:
<code class="docutils literal notranslate"><span class="pre">igamma()</span> <span class="pre">*</span> <span class="pre">edge_list[label].rep</span> <span class="pre">*</span> <span class="pre">t()</span> <span class="pre">==</span> <span class="pre">x</span></code></p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">self.sign()</span> <span class="pre">==</span> <span class="pre">-1</span></code>:
<code class="docutils literal notranslate"><span class="pre">igamma()</span> <span class="pre">*</span> <span class="pre">edge_list[label].opposite.rep</span> <span class="pre">*</span> <span class="pre">t()</span> <span class="pre">==</span> <span class="pre">x</span></code></p></li>
</ul>
<p>It also stores a member called power so that:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">p**(2*power)</span> <span class="pre">=</span> <span class="pre">gamma.reduced_norm()</span></code></p>
</div></blockquote>
<p>The usual decomposition <span class="math notranslate nohighlight">\(get=x\)</span> would be:</p>
<ul class="simple">
<li><p>g = gamma / (p ** power)</p></li>
<li><p>e = edge_list[label]</p></li>
<li><p>t’ = t * p ** power</p></li>
</ul>
<p>Here usual denotes that we have rescaled gamma to have unit
determinant, and so that the result is honestly an element
of the arithmetic quaternion group under consideration. In
practice we store integral multiples and keep track of the
powers of <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Y</span></code> -  BruhatTitsQuotient object in which to work</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">x</span></code> -  Something coercible into a matrix in <span class="math notranslate nohighlight">\(GL_2(\ZZ)\)</span>. In</dt><dd><p>principle we should allow elements in <span class="math notranslate nohighlight">\(GL_2(\QQ_p)\)</span>, but it is
enough to work with integral entries</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">extrapow</span></code> - gets added to the power attribute, and it is</dt><dd><p>used for the Hecke action.</p>
</dd>
</dl>
</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">DoubleCosetReduction</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">123</span><span class="p">,</span><span class="mi">153</span><span class="p">,</span><span class="mi">1231</span><span class="p">,</span><span class="mi">1231</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">DoubleCosetReduction</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">sign</span><span class="p">()</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">igamma</span><span class="p">()</span><span class="o">*</span><span class="n">Y</span><span class="o">.</span><span class="n">_edge_list</span><span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">label</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">get_edge_list</span><span class="p">())]</span><span class="o">.</span><span class="n">opposite</span><span class="o">.</span><span class="n">rep</span><span class="o">*</span><span class="n">d</span><span class="o">.</span><span class="n">t</span><span class="p">()</span> <span class="o">==</span> <span class="n">x</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1423</span><span class="p">,</span><span class="mi">113553</span><span class="p">,</span><span class="mi">11231</span><span class="p">,</span><span class="mi">12313</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">DoubleCosetReduction</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">sign</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">igamma</span><span class="p">()</span><span class="o">*</span><span class="n">Y</span><span class="o">.</span><span class="n">_edge_list</span><span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">rep</span><span class="o">*</span><span class="n">d</span><span class="o">.</span><span class="n">t</span><span class="p">()</span> <span class="o">==</span> <span class="n">x</span>
<span class="go">True</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Cameron Franc (2012-02-20)</p></li>
<li><p>Marc Masdeu</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.DoubleCosetReduction.igamma">
<span class="sig-name descname"><span class="pre">igamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.DoubleCosetReduction.igamma" title="Link to this definition">#</a></dt>
<dd><p>Image under gamma.</p>
<p>Elements of the arithmetic group can be regarded as elements
of the global quaternion order, and hence may be represented
exactly. This function computes the image of such an element
under the local splitting and returns the corresponding <span class="math notranslate nohighlight">\(p\)</span>-adic
approximation.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">embedding</span></code> - an integer, or a function (default:
none). If <code class="docutils literal notranslate"><span class="pre">embedding</span></code> is None, then the image of
<code class="docutils literal notranslate"><span class="pre">self.gamma</span></code> under the local splitting associated to
<code class="docutils literal notranslate"><span class="pre">self.Y</span></code> is used. If <code class="docutils literal notranslate"><span class="pre">embedding</span></code> is an integer, then
the precision of the local splitting of self.Y is raised
(if necessary) to be larger than this integer, and this
new local splitting is used. If a function is passed, then
map <code class="docutils literal notranslate"><span class="pre">self.gamma</span></code> under <code class="docutils literal notranslate"><span class="pre">embedding</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scale</span></code> – (default: 1) scaling factor applied to the output</p></li>
</ul>
<p>OUTPUT:</p>
<p>a 2x2 matrix with <span class="math notranslate nohighlight">\(p\)</span>-adic entries encoding the image of <code class="docutils literal notranslate"><span class="pre">self</span></code>
under the local splitting</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">DoubleCosetReduction</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">DoubleCosetReduction</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">123</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">88</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">igamma</span><span class="p">()</span>
<span class="go">[6 + 6*7 + 6*7^2 + 6*7^3 + 6*7^4 + O(7^5)                                   O(7^5)]</span>
<span class="go">[                                  O(7^5) 6 + 6*7 + 6*7^2 + 6*7^3 + 6*7^4 + O(7^5)]</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">igamma</span><span class="p">(</span><span class="n">embedding</span> <span class="o">=</span> <span class="mi">7</span><span class="p">)</span>
<span class="go">[6 + 6*7 + 6*7^2 + 6*7^3 + 6*7^4 + 6*7^5 + 6*7^6 + O(7^7)                                                   O(7^7)]</span>
<span class="go">[                                                  O(7^7) 6 + 6*7 + 6*7^2 + 6*7^3 + 6*7^4 + 6*7^5 + 6*7^6 + O(7^7)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.DoubleCosetReduction.sign">
<span class="sig-name descname"><span class="pre">sign</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.DoubleCosetReduction.sign" title="Link to this definition">#</a></dt>
<dd><p>Return the direction of the edge.</p>
<p>The Bruhat-Tits quotients are directed graphs but we only store
half the edges (we treat them more like unordered graphs).
The sign tells whether the matrix self.x is equivalent to the
representative in the quotient (sign = +1), or to the
opposite of one of the representatives (sign = -1).</p>
<p>OUTPUT:</p>
<p>an int that is +1 or -1 according to the sign of <code class="docutils literal notranslate"><span class="pre">self</span></code></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">DoubleCosetReduction</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">123</span><span class="p">,</span><span class="mi">153</span><span class="p">,</span><span class="mi">1231</span><span class="p">,</span><span class="mi">1231</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">DoubleCosetReduction</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">sign</span><span class="p">()</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">igamma</span><span class="p">()</span><span class="o">*</span><span class="n">Y</span><span class="o">.</span><span class="n">_edge_list</span><span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">label</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">get_edge_list</span><span class="p">())]</span><span class="o">.</span><span class="n">opposite</span><span class="o">.</span><span class="n">rep</span><span class="o">*</span><span class="n">d</span><span class="o">.</span><span class="n">t</span><span class="p">()</span> <span class="o">==</span> <span class="n">x</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1423</span><span class="p">,</span><span class="mi">113553</span><span class="p">,</span><span class="mi">11231</span><span class="p">,</span><span class="mi">12313</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">DoubleCosetReduction</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">sign</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">igamma</span><span class="p">()</span><span class="o">*</span><span class="n">Y</span><span class="o">.</span><span class="n">_edge_list</span><span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">rep</span><span class="o">*</span><span class="n">d</span><span class="o">.</span><span class="n">t</span><span class="p">()</span> <span class="o">==</span> <span class="n">x</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.DoubleCosetReduction.t">
<span class="sig-name descname"><span class="pre">t</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.DoubleCosetReduction.t" title="Link to this definition">#</a></dt>
<dd><p>Return the ‘t part’ of the decomposition using the rest of the data.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> - a <span class="math notranslate nohighlight">\(p\)</span>-adic precision that t will be computed
to. Defaults to the default working precision of self.</p></li>
</ul>
<p>OUTPUT:</p>
<p>a 2x2 <span class="math notranslate nohighlight">\(p\)</span>-adic matrix with entries of
precision <code class="docutils literal notranslate"><span class="pre">prec</span></code> that is the ‘t-part’ of the decomposition of
self</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">DoubleCosetReduction</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">123</span><span class="p">,</span><span class="mi">153</span><span class="p">,</span><span class="mi">1231</span><span class="p">,</span><span class="mi">1232</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">DoubleCosetReduction</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">t</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.Edge">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.modular.btquotients.btquotient.</span></span><span class="sig-name descname"><span class="pre">Edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">links</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opposite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">determinant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valuation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.Edge" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Parents and Elements v10.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SageObject</span></code></a></p>
<p>This is a structure to represent edges of quotients of the
Bruhat-Tits tree. It is useful to enrich the representation of an
edge as a matrix with extra data.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> - a prime integer.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">label</span></code> - An integer which uniquely identifies this edge.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rep</span></code> - A 2x2 matrix in reduced form representing this edge.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">origin</span></code> - The origin vertex of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">target</span></code> - The target vertex of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">links</span></code> - (Default: empty list) A list of elements of
<span class="math notranslate nohighlight">\(\Gamma\)</span> which identify different edges in the Bruhat-Tits tree
which are equivalent to <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">opposite</span></code> - (Default: None) The edge opposite to <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">determinant</span></code> - (Default: None) The determinant of <code class="docutils literal notranslate"><span class="pre">rep</span></code>,
if known.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">valuation</span></code> - (Default: None) The valuation of the
determinant of <code class="docutils literal notranslate"><span class="pre">rep</span></code>, if known.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">Edge</span><span class="p">,</span> <span class="n">Vertex</span>
<span class="gp">sage: </span><span class="n">v1</span> <span class="o">=</span> <span class="n">Vertex</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">18</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">v2</span> <span class="o">=</span> <span class="n">Vertex</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">18</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">e1</span> <span class="o">=</span> <span class="n">Edge</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">18</span><span class="p">]),</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e1</span><span class="o">.</span><span class="n">rep</span>
<span class="go">[ 1  2]</span>
<span class="go">[ 3 18]</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Marc Masdeu (2012-02-20)</p></li>
</ul>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.modular.btquotients.btquotient.Vertex">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.modular.btquotients.btquotient.</span></span><span class="sig-name descname"><span class="pre">Vertex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leaving_edges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entering_edges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">determinant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valuation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.Vertex" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Parents and Elements v10.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SageObject</span></code></a></p>
<p>This is a structure to represent vertices of quotients of the
Bruhat-Tits tree.  It is useful to enrich the representation of
the vertex as a matrix with extra data.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> - a prime integer.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">label</span></code> - An integer which uniquely identifies this vertex.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rep</span></code> - A 2x2 matrix in reduced form representing this
vertex.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">leaving_edges</span></code> - (default: empty list) A list of edges
leaving this vertex.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">entering_edges</span></code> - (default: empty list) A list of edges
entering this vertex.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">determinant</span></code> - (default: None) The determinant of <code class="docutils literal notranslate"><span class="pre">rep</span></code>,
if known.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">valuation</span></code> - (default: None) The valuation of the
determinant of <code class="docutils literal notranslate"><span class="pre">rep</span></code>, if known.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">Vertex</span>
<span class="gp">sage: </span><span class="n">v1</span> <span class="o">=</span> <span class="n">Vertex</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">18</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">v1</span><span class="o">.</span><span class="n">rep</span>
<span class="go">[ 1  2]</span>
<span class="go">[ 3 18]</span>
<span class="gp">sage: </span><span class="n">v1</span><span class="o">.</span><span class="n">entering_edges</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Marc Masdeu (2012-02-20)</p></li>
</ul>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="pautomorphicform.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Spaces of <span class="math notranslate nohighlight">\(p\)</span>-adic automorphic forms</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../pollack_stevens/modsym.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Element class for Pollack-Stevens’ modular symbols</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2024, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Quotients of the Bruhat-Tits tree</a><ul>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient"><code class="docutils literal notranslate"><span class="pre">BruhatTitsQuotient</span></code></a><ul>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.B_one"><code class="docutils literal notranslate"><span class="pre">B_one()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.Nminus"><code class="docutils literal notranslate"><span class="pre">Nminus()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.Nplus"><code class="docutils literal notranslate"><span class="pre">Nplus()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.dimension_harmonic_cocycles"><code class="docutils literal notranslate"><span class="pre">dimension_harmonic_cocycles()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.e3"><code class="docutils literal notranslate"><span class="pre">e3()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.e4"><code class="docutils literal notranslate"><span class="pre">e4()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.embed"><code class="docutils literal notranslate"><span class="pre">embed()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.embed_quaternion"><code class="docutils literal notranslate"><span class="pre">embed_quaternion()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.fundom_rep"><code class="docutils literal notranslate"><span class="pre">fundom_rep()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.genus"><code class="docutils literal notranslate"><span class="pre">genus()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.genus_no_formula"><code class="docutils literal notranslate"><span class="pre">genus_no_formula()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_edge_list"><code class="docutils literal notranslate"><span class="pre">get_edge_list()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_edge_stabilizers"><code class="docutils literal notranslate"><span class="pre">get_edge_stabilizers()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_eichler_order"><code class="docutils literal notranslate"><span class="pre">get_eichler_order()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_eichler_order_basis"><code class="docutils literal notranslate"><span class="pre">get_eichler_order_basis()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_eichler_order_quadform"><code class="docutils literal notranslate"><span class="pre">get_eichler_order_quadform()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_eichler_order_quadmatrix"><code class="docutils literal notranslate"><span class="pre">get_eichler_order_quadmatrix()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_embedding"><code class="docutils literal notranslate"><span class="pre">get_embedding()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_embedding_matrix"><code class="docutils literal notranslate"><span class="pre">get_embedding_matrix()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_extra_embedding_matrices"><code class="docutils literal notranslate"><span class="pre">get_extra_embedding_matrices()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_fundom_graph"><code class="docutils literal notranslate"><span class="pre">get_fundom_graph()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_generators"><code class="docutils literal notranslate"><span class="pre">get_generators()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_graph"><code class="docutils literal notranslate"><span class="pre">get_graph()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_list"><code class="docutils literal notranslate"><span class="pre">get_list()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_maximal_order"><code class="docutils literal notranslate"><span class="pre">get_maximal_order()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_nontorsion_generators"><code class="docutils literal notranslate"><span class="pre">get_nontorsion_generators()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_num_ordered_edges"><code class="docutils literal notranslate"><span class="pre">get_num_ordered_edges()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_num_verts"><code class="docutils literal notranslate"><span class="pre">get_num_verts()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_quaternion_algebra"><code class="docutils literal notranslate"><span class="pre">get_quaternion_algebra()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_splitting_field"><code class="docutils literal notranslate"><span class="pre">get_splitting_field()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_stabilizers"><code class="docutils literal notranslate"><span class="pre">get_stabilizers()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_units_of_order"><code class="docutils literal notranslate"><span class="pre">get_units_of_order()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_vertex_dict"><code class="docutils literal notranslate"><span class="pre">get_vertex_dict()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_vertex_list"><code class="docutils literal notranslate"><span class="pre">get_vertex_list()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_vertex_stabs"><code class="docutils literal notranslate"><span class="pre">get_vertex_stabs()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.harmonic_cocycle_from_elliptic_curve"><code class="docutils literal notranslate"><span class="pre">harmonic_cocycle_from_elliptic_curve()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.harmonic_cocycles"><code class="docutils literal notranslate"><span class="pre">harmonic_cocycles()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.is_admissible"><code class="docutils literal notranslate"><span class="pre">is_admissible()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.level"><code class="docutils literal notranslate"><span class="pre">level()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.mu"><code class="docutils literal notranslate"><span class="pre">mu()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.padic_automorphic_forms"><code class="docutils literal notranslate"><span class="pre">padic_automorphic_forms()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.plot"><code class="docutils literal notranslate"><span class="pre">plot()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.plot_fundom"><code class="docutils literal notranslate"><span class="pre">plot_fundom()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.prime"><code class="docutils literal notranslate"><span class="pre">prime()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsTree"><code class="docutils literal notranslate"><span class="pre">BruhatTitsTree</span></code></a><ul>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.edge"><code class="docutils literal notranslate"><span class="pre">edge()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.edge_between_vertices"><code class="docutils literal notranslate"><span class="pre">edge_between_vertices()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.edges_leaving_origin"><code class="docutils literal notranslate"><span class="pre">edges_leaving_origin()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.entering_edges"><code class="docutils literal notranslate"><span class="pre">entering_edges()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.find_containing_affinoid"><code class="docutils literal notranslate"><span class="pre">find_containing_affinoid()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.find_covering"><code class="docutils literal notranslate"><span class="pre">find_covering()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.find_geodesic"><code class="docutils literal notranslate"><span class="pre">find_geodesic()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.find_path"><code class="docutils literal notranslate"><span class="pre">find_path()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.get_balls"><code class="docutils literal notranslate"><span class="pre">get_balls()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.leaving_edges"><code class="docutils literal notranslate"><span class="pre">leaving_edges()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.opposite"><code class="docutils literal notranslate"><span class="pre">opposite()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.origin"><code class="docutils literal notranslate"><span class="pre">origin()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.subdivide"><code class="docutils literal notranslate"><span class="pre">subdivide()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.target"><code class="docutils literal notranslate"><span class="pre">target()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.vertex"><code class="docutils literal notranslate"><span class="pre">vertex()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.DoubleCosetReduction"><code class="docutils literal notranslate"><span class="pre">DoubleCosetReduction</span></code></a><ul>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.DoubleCosetReduction.igamma"><code class="docutils literal notranslate"><span class="pre">igamma()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.DoubleCosetReduction.sign"><code class="docutils literal notranslate"><span class="pre">sign()</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.DoubleCosetReduction.t"><code class="docutils literal notranslate"><span class="pre">t()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.Edge"><code class="docutils literal notranslate"><span class="pre">Edge</span></code></a></li>
<li><a class="reference internal" href="#sage.modular.btquotients.btquotient.Vertex"><code class="docutils literal notranslate"><span class="pre">Vertex</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/scripts/furo.js"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script src="../../../../_static/tabs.js"></script>
    <script src="../../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "lcm": "\\mathop{\\operatorname{lcm}}", "dist": "\\mathrm{dist}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <script src="../../../../_static/jupyter-sphinx-furo.js"></script>
    </body>
</html>