<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>p-Adic Generic Element &mdash; Sage Reference Manual v7.3: p-Adics</title>
    
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '7.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v7.3: p-Adics" href="../../../index.html" />
    <link rel="next" title="\(p\)-Adic Capped Relative Elements" href="padic_capped_relative_element.html" />
    <link rel="prev" title="Local Generic Element" href="local_generic_element.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="padic_capped_relative_element.html" title="\(p\)-Adic Capped Relative Elements"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="local_generic_element.html" title="Local Generic Element"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">p-Adics</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="p-adic-generic-element">
<span id="sage-rings-padics-padic-generic-element"></span><h1>p-Adic Generic Element<a class="headerlink" href="#p-adic-generic-element" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.rings.padics.padic_generic_element"></span><p>Elements of <span class="math">\(p\)</span>-Adic Rings and Fields</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>David Roe</li>
<li>Genya Zaytman: documentation</li>
<li>David Harvey: doctests</li>
<li>Julian Rueth: fixes for exp() and log(), implemented gcd, xgcd</li>
</ul>
<dl class="class">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement">
<em class="property">class </em><code class="descclassname">sage.rings.padics.padic_generic_element.</code><code class="descname">pAdicGenericElement</code><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="local_generic_element.html#sage.rings.padics.local_generic_element.LocalGenericElement" title="sage.rings.padics.local_generic_element.LocalGenericElement"><code class="xref py py-class docutils literal"><span class="pre">sage.rings.padics.local_generic_element.LocalGenericElement</span></code></a></p>
<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.abs">
<code class="descname">abs</code><span class="sig-paren">(</span><em>prec=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.abs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <span class="math">\(p\)</span>-adic absolute value of <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>This is normalized so that the absolute value of <span class="math">\(p\)</span> is <span class="math">\(1/p\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">prec</span></code> &#8211; Integer.  The precision of the real field in which
the answer is returned.  If <code class="docutils literal"><span class="pre">None</span></code>, returns a rational for
absolutely unramified fields, or a real with 53 bits of
precision for ramified fields.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">15</span><span class="p">);</span> <span class="n">a</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="go">1/5</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mi">53</span><span class="p">)</span>
<span class="go">0.200000000000000</span>
<span class="gp">sage: </span><span class="n">Qp</span><span class="p">(</span><span class="mi">7</span><span class="p">)(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Qp</span><span class="p">(</span><span class="mi">7</span><span class="p">)(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="go">0.00000</span>
</pre></div>
</div>
<p>An unramified extension:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Z25</span><span class="o">.&lt;</span><span class="n">u</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ext</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">u</span><span class="o">^</span><span class="mi">24</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="go">1/5</span>
</pre></div>
</div>
<p>A ramified extension:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ext</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">75</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">15</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">125</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="go">0.724779663677696</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="go">0.000000000000000</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.additive_order">
<code class="descname">additive_order</code><span class="sig-paren">(</span><em>prec</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.additive_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the additive order of self, where self is considered
to be zero if it is zero modulo <span class="math">\(p^{\mbox{prec}}\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">self</span></code> &#8211; a p-adic element</li>
<li><code class="docutils literal"><span class="pre">prec</span></code> &#8211; an integer</li>
</ul>
<p>OUTPUT:</p>
<p>integer &#8211; the additive order of self</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;capped-rel&#39;</span><span class="p">,</span> <span class="s1">&#39;series&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="o">^</span><span class="mi">3</span><span class="p">);</span> <span class="n">a</span><span class="o">.</span><span class="n">additive_order</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">additive_order</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;fixed-mod&#39;</span><span class="p">,</span> <span class="s1">&#39;series&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="o">^</span><span class="mi">5</span><span class="p">);</span> <span class="n">a</span><span class="o">.</span><span class="n">additive_order</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.algdep">
<code class="descname">algdep</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.algdep" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a polynomial of degree at most <span class="math">\(n\)</span> which is approximately
satisfied by this number. Note that the returned polynomial need not be
irreducible, and indeed usually won&#8217;t be if this number is a good
approximation to an algebraic number of degree less than <span class="math">\(n\)</span>.</p>
<p>ALGORITHM: Uses the PARI C-library <code class="docutils literal"><span class="pre">algdep</span></code> command.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">self</span></code> &#8211; a p-adic element</li>
<li><code class="docutils literal"><span class="pre">n</span></code> &#8211; an integer</li>
</ul>
<p>OUTPUT:</p>
<p>polynomial &#8211; degree n polynomial approximately satisfied by self</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">,</span><span class="s1">&#39;series&#39;</span><span class="p">);</span> <span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">,</span><span class="s1">&#39;series&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">19</span><span class="p">);</span> <span class="n">a</span>
<span class="go">1 + 2*3 + 3^2 + 3^3 + 2*3^4 + 2*3^5 + 3^8 + 2*3^9 + 3^11 + 3^12 + 2*3^15 + 2*3^16 + 3^17 + 2*3^19 + O(3^20)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">algdep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">19*x - 7</span>
<span class="gp">sage: </span><span class="n">K2</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">K2</span><span class="o">.</span><span class="n">zeta</span><span class="p">();</span> <span class="n">b</span><span class="o">.</span><span class="n">algdep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x^2 - x + 1</span>
<span class="gp">sage: </span><span class="n">K2</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">K2</span><span class="o">.</span><span class="n">zeta</span><span class="p">();</span> <span class="n">b</span><span class="o">.</span><span class="n">algdep</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">x^4 - x^3 + x^2 - x + 1</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">19</span><span class="p">);</span> <span class="n">a</span>
<span class="go">1 + 2*3 + 3^2 + 3^3 + 2*3^4 + 2*3^5 + 3^8 + 2*3^9 + 3^11 + 3^12 + 2*3^15 + 2*3^16 + 3^17 + 2*3^19 + O(3^20)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">algdep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">19*x - 7</span>
<span class="gp">sage: </span><span class="n">R2</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">R2</span><span class="o">.</span><span class="n">zeta</span><span class="p">();</span> <span class="n">b</span><span class="o">.</span><span class="n">algdep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x^2 - x + 1</span>
<span class="gp">sage: </span><span class="n">R2</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">R2</span><span class="o">.</span><span class="n">zeta</span><span class="p">();</span> <span class="n">b</span><span class="o">.</span><span class="n">algdep</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">x^4 - x^3 + x^2 - x + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.algebraic_dependency">
<code class="descname">algebraic_dependency</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.algebraic_dependency" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a polynomial of degree at most <span class="math">\(n\)</span> which is approximately
satisfied by this number.  Note that the returned polynomial need not
be irreducible, and indeed usually won&#8217;t be if this number is a good
approximation to an algebraic number of degree less than <span class="math">\(n\)</span>.</p>
<p>ALGORITHM: Uses the PARI C-library algdep command.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">self</span></code> &#8211; a p-adic element</li>
<li><code class="docutils literal"><span class="pre">n</span></code> &#8211; an integer</li>
</ul>
<p>OUTPUT:</p>
<p>polynomial &#8211; degree n polynomial approximately satisfied by self</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">,</span><span class="s1">&#39;series&#39;</span><span class="p">);</span> <span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">,</span><span class="s1">&#39;series&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">19</span><span class="p">);</span> <span class="n">a</span>
<span class="go">1 + 2*3 + 3^2 + 3^3 + 2*3^4 + 2*3^5 + 3^8 + 2*3^9 + 3^11 + 3^12 + 2*3^15 + 2*3^16 + 3^17 + 2*3^19 + O(3^20)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">algebraic_dependency</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">19*x - 7</span>
<span class="gp">sage: </span><span class="n">K2</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">K2</span><span class="o">.</span><span class="n">zeta</span><span class="p">();</span> <span class="n">b</span><span class="o">.</span><span class="n">algebraic_dependency</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x^2 - x + 1</span>
<span class="gp">sage: </span><span class="n">K2</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">K2</span><span class="o">.</span><span class="n">zeta</span><span class="p">();</span> <span class="n">b</span><span class="o">.</span><span class="n">algebraic_dependency</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">x^4 - x^3 + x^2 - x + 1</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">19</span><span class="p">);</span> <span class="n">a</span>
<span class="go">1 + 2*3 + 3^2 + 3^3 + 2*3^4 + 2*3^5 + 3^8 + 2*3^9 + 3^11 + 3^12 + 2*3^15 + 2*3^16 + 3^17 + 2*3^19 + O(3^20)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">algebraic_dependency</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">19*x - 7</span>
<span class="gp">sage: </span><span class="n">R2</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">R2</span><span class="o">.</span><span class="n">zeta</span><span class="p">();</span> <span class="n">b</span><span class="o">.</span><span class="n">algebraic_dependency</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x^2 - x + 1</span>
<span class="gp">sage: </span><span class="n">R2</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">R2</span><span class="o">.</span><span class="n">zeta</span><span class="p">();</span> <span class="n">b</span><span class="o">.</span><span class="n">algebraic_dependency</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">x^4 - x^3 + x^2 - x + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.dwork_expansion">
<code class="descname">dwork_expansion</code><span class="sig-paren">(</span><em>bd=20</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.dwork_expansion" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value of a function defined by Dwork.</p>
<p>Used to compute the <span class="math">\(p\)</span>-adic Gamma function, see <a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.gamma" title="sage.rings.padics.padic_generic_element.pAdicGenericElement.gamma"><code class="xref py py-meth docutils literal"><span class="pre">gamma()</span></code></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">bd</span></code> &#8211; integer. Is a bound for precision, defaults to 20</li>
</ul>
<p>OUTPUT:</p>
<p>A <code class="docutils literal"><span class="pre">p</span></code>&#8211; adic integer.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is based on GP code written by Fernando Rodriguez
Villegas (<a class="reference external" href="http://www.ma.utexas.edu/cnt/cnt-frames.html">http://www.ma.utexas.edu/cnt/cnt-frames.html</a>).
William Stein sped it up for GP
(<a class="reference external" href="http://sage.math.washington.edu/home/wstein/www/home/wbhart/pari-2.4.2.alpha/src/basemath/trans2.c">http://sage.math.washington.edu/home/wstein/www/home/wbhart/pari-2.4.2.alpha/src/basemath/trans2.c</a>).
The output is a <span class="math">\(p\)</span>-adic integer from Dwork&#8217;s expansion,
used to compute the <span class="math">\(p\)</span>-adic gamma function as in <a class="reference internal" href="#rv" id="id1">[RV]</a>
section 6.2.</p>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="rv" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[RV]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id2">2</a>)</em> Rodriguez Villegas, Fernando. Experimental Number Theory.
Oxford Graduate Texts in Mathematics 13, 2007.</td></tr>
</tbody>
</table>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="mi">17</span><span class="o">+</span><span class="mi">13</span><span class="o">*</span><span class="mi">17</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">6</span><span class="o">*</span><span class="mi">17</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">12</span><span class="o">*</span><span class="mi">17</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">10</span><span class="o">*</span><span class="mi">17</span><span class="o">^</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span><span class="o">+</span><span class="mi">5</span><span class="o">*</span><span class="mi">17</span><span class="o">^</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span><span class="o">+</span><span class="n">O</span><span class="p">(</span><span class="mi">17</span><span class="o">^</span><span class="p">(</span><span class="mi">19</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">dwork_expansion</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<span class="go">16 + 7*17 + 11*17^2 + 4*17^3 + 8*17^4 + 10*17^5 + 11*17^6 + 6*17^7 </span>
<span class="go">+ 17^8 + 8*17^10 + 13*17^11 + 9*17^12 + 15*17^13  + 2*17^14 + 6*17^15 </span>
<span class="go">+ 7*17^16 + 6*17^17 + O(17^18)</span>

<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="mi">5</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="mi">5</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="o">*</span><span class="mi">5</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="mi">5</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="o">*</span><span class="mi">5</span><span class="o">^</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="n">O</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="p">(</span><span class="mi">20</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">dwork_expansion</span><span class="p">()</span>
<span class="go">4 + 4*5 + 4*5^2 + 4*5^3 + 2*5^4 + 4*5^5 + 5^7 + 3*5^9 + 4*5^10 + 3*5^11 </span>
<span class="go">+ 5^13 + 4*5^14 + 2*5^15 + 2*5^16 + 2*5^17 + 3*5^18 + O(5^20)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.exp">
<code class="descname">exp</code><span class="sig-paren">(</span><em>aprec=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.exp" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the <span class="math">\(p\)</span>-adic exponential of this element if the exponential
series converges.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">aprec</span></code> &#8211; an integer or <code class="docutils literal"><span class="pre">None</span></code> (default: <code class="docutils literal"><span class="pre">None</span></code>); if
specified, computes only up to the indicated precision.</li>
</ul>
<p>ALGORITHM: If self has a <code class="docutils literal"><span class="pre">lift</span></code> method (which should happen for
elements of <span class="math">\(\QQ_p\)</span> and <span class="math">\(\ZZ_p\)</span>), then one uses the rule:
<span class="math">\(\exp(x)=\exp(p)^{x/p}\)</span> modulo the precision. The value of <span class="math">\(\exp(p)\)</span> is
precomputed. Otherwise, use the power series expansion of <span class="math">\(\exp\)</span>,
evaluating a certain number of terms which does about <span class="math">\(O(\mbox{prec})\)</span>
multiplications.</p>
<p>EXAMPLES:</p>
<p><a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.log" title="sage.rings.padics.padic_generic_element.pAdicGenericElement.log"><code class="xref py py-meth docutils literal"><span class="pre">log()</span></code></a> and <a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.exp" title="sage.rings.padics.padic_generic_element.pAdicGenericElement.exp"><code class="xref py py-meth docutils literal"><span class="pre">exp()</span></code></a> are inverse to each other:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Z13</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Z13</span><span class="p">(</span><span class="mi">14</span><span class="p">);</span> <span class="n">a</span>
<span class="go">1 + 13 + O(13^10)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">log</span><span class="p">()</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">1 + 13 + O(13^10)</span>
</pre></div>
</div>
<p>An error occurs if this is called with an element for which the
exponential series does not converge:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Z13</span><span class="o">.</span><span class="n">one</span><span class="p">()</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Exponential does not converge for that input.</span>
</pre></div>
</div>
<p>The next few examples illustrate precision when computing <span class="math">\(p\)</span>-adic
exponentials:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">5</span><span class="o">**</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">7</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">8</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">add_bigoh</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span> <span class="n">e</span>
<span class="go">2*5 + 2*5^2 + 4*5^3 + 3*5^4 + 5^5 + 3*5^7 + 2*5^8 + 4*5^9 + O(5^10)</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span><span class="o">*</span><span class="n">R</span><span class="o">.</span><span class="n">teichmuller</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">4 + 2*5 + 3*5^3 + O(5^10)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">K</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">5</span><span class="o">**</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">7</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">8</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">add_bigoh</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span> <span class="n">e</span>
<span class="go">2*5 + 2*5^2 + 4*5^3 + 3*5^4 + 5^5 + 3*5^7 + 2*5^8 + 4*5^9 + O(5^10)</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span><span class="o">*</span><span class="n">K</span><span class="o">.</span><span class="n">teichmuller</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">4 + 2*5 + 3*5^3 + O(5^10)</span>
</pre></div>
</div>
<p>Logarithms and exponentials in extension fields. First, in an
Eisenstein extension:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">15</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">625</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">W</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ext</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">w</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">w</span><span class="o">^</span><span class="mi">7</span><span class="p">;</span> <span class="n">z</span>
<span class="go">1 + w^2 + 4*w^7 + O(w^20)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">log</span><span class="p">()</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">1 + w^2 + 4*w^7 + O(w^20)</span>
</pre></div>
</div>
<p>Now an unramified example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ext</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">);</span> <span class="n">b</span>
<span class="go">1 + (a^2 + 1)*5 + (2*a + 3)*5^3 + O(5^5)</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">log</span><span class="p">()</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">1 + (a^2 + 1)*5 + (2*a + 3)*5^3 + O(5^5)</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Check that results are consistent over a range of precision:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">max_prec</span> <span class="o">=</span> <span class="mi">40</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">max_prec</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">full_exp</span> <span class="o">=</span> <span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="n">p</span><span class="p">))</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">prec</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">max_prec</span><span class="p">):</span>
<span class="gp">... </span>      <span class="n">ll</span> <span class="o">=</span> <span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">add_bigoh</span><span class="p">(</span><span class="n">prec</span><span class="p">))</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="gp">... </span>      <span class="k">assert</span> <span class="n">ll</span> <span class="o">==</span> <span class="n">full_exp</span>
<span class="gp">... </span>      <span class="k">assert</span> <span class="n">ll</span><span class="o">.</span><span class="n">precision_absolute</span><span class="p">()</span> <span class="o">==</span> <span class="n">prec</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">max_prec</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">full_exp</span> <span class="o">=</span> <span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="n">p</span><span class="p">))</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">prec</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">max_prec</span><span class="p">):</span>
<span class="gp">... </span>      <span class="n">ll</span> <span class="o">=</span> <span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">add_bigoh</span><span class="p">(</span><span class="n">prec</span><span class="p">))</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="gp">... </span>      <span class="k">assert</span> <span class="n">ll</span> <span class="o">==</span> <span class="n">full_exp</span>
<span class="gp">... </span>      <span class="k">assert</span> <span class="n">ll</span><span class="o">.</span><span class="n">precision_absolute</span><span class="p">()</span> <span class="o">==</span> <span class="n">prec</span>
</pre></div>
</div>
<p>Check that this also works for capped-absolute implementations:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Z13</span> <span class="o">=</span> <span class="n">ZpCA</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Z13</span><span class="p">(</span><span class="mi">14</span><span class="p">);</span> <span class="n">a</span>
<span class="go">1 + 13 + O(13^10)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">log</span><span class="p">()</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">1 + 13 + O(13^10)</span>

<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">ZpCA</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">15</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">625</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">W</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ext</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">w</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">w</span><span class="o">^</span><span class="mi">7</span><span class="p">;</span> <span class="n">z</span>
<span class="go">1 + w^2 + 4*w^7 + O(w^16)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">log</span><span class="p">()</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">1 + w^2 + 4*w^7 + O(w^16)</span>
</pre></div>
</div>
<p>Check that this also works for fixed-mod implementations:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Z13</span> <span class="o">=</span> <span class="n">ZpFM</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Z13</span><span class="p">(</span><span class="mi">14</span><span class="p">);</span> <span class="n">a</span>
<span class="go">1 + 13 + O(13^10)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">log</span><span class="p">()</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">1 + 13 + O(13^10)</span>

<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">ZpFM</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">15</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">625</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">W</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ext</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">w</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">w</span><span class="o">^</span><span class="mi">7</span><span class="p">;</span> <span class="n">z</span>
<span class="go">1 + w^2 + 4*w^7 + O(w^20)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">log</span><span class="p">()</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">1 + w^2 + 4*w^7 + O(w^20)</span>
</pre></div>
</div>
<p>Some corner cases:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Z2</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Z2</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Exponential does not converge for that input.</span>

<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Z2</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">W</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Z2</span><span class="o">.</span><span class="n">ext</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">w</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Exponential does not converge for that input.</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">w</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Exponential does not converge for that input.</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">w</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">1 + w^4 + w^5 + w^7 + w^9 + w^10 + w^14 + O(w^15)</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Genya Zaytman (2007-02-15)</li>
<li>Amnon Besser, Marc Masdeu (2012-02-23): Complete rewrite</li>
<li>Julian Rueth (2013-02-14): Added doctests, fixed some corner cases</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.gamma">
<code class="descname">gamma</code><span class="sig-paren">(</span><em>algorithm='pari'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.gamma" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value of the <span class="math">\(p\)</span>-adic Gamma function.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">algorithm</span></code> &#8211; string. Can be set to <code class="docutils literal"><span class="pre">'pari'</span></code> to call
the pari function, or <code class="docutils literal"><span class="pre">'sage'</span></code> to call the function
implemented in sage.  set to <code class="docutils literal"><span class="pre">'pari'</span></code> by default, since
pari is about 10 times faster than sage.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a <span class="math">\(p\)</span>-adic integer</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is based on GP code written by Fernando Rodriguez
Villegas (<a class="reference external" href="http://www.ma.utexas.edu/cnt/cnt-frames.html">http://www.ma.utexas.edu/cnt/cnt-frames.html</a>).
William Stein sped it up for GP
(<a class="reference external" href="http://sage.math.washington.edu/home/wstein/www/home/wbhart/pari-2.4.2.alpha/src/basemath/trans2.c">http://sage.math.washington.edu/home/wstein/www/home/wbhart/pari-2.4.2.alpha/src/basemath/trans2.c</a>).
The &#8216;sage&#8217; version uses dwork_expansion() to compute the
<span class="math">\(p\)</span>-adic gamma function of self as in <a class="reference internal" href="#rv" id="id2">[RV]</a> section 6.2.</p>
</div>
<p>EXAMPLES:</p>
<p>This example illustrates <code class="docutils literal"><span class="pre">x.gamma()</span></code> for <span class="math">\(x\)</span> a <span class="math">\(p\)</span>-adic unit:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="mi">7</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="mi">7</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">O</span><span class="p">(</span><span class="mi">7</span><span class="o">^</span><span class="mi">20</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span>
<span class="go">1 + 2*7^2 + 4*7^3 + 5*7^4 + 3*7^5 + 7^8 + 7^9 + 4*7^10 + 3*7^12 </span>
<span class="go">+ 7^13 + 5*7^14 + 3*7^15 + 2*7^16 + 2*7^17 + 5*7^18 + 4*7^19 + O(7^20)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="s1">&#39;sage&#39;</span><span class="p">)</span>
<span class="go">1 + 2*7^2 + 4*7^3 + 5*7^4 + 3*7^5 + 7^8 + 7^9 + 4*7^10 + 3*7^12 </span>
<span class="go">+ 7^13 + 5*7^14 + 3*7^15 + 2*7^16 + 2*7^17 + 5*7^18 + 4*7^19 + O(7^20)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">x</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="s1">&#39;sage&#39;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Now <code class="docutils literal"><span class="pre">x.gamma()</span></code> for <span class="math">\(x\)</span> a <span class="math">\(p\)</span>-adic integer but not a unit:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">17</span><span class="o">+</span><span class="mi">17</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="mi">17</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">12</span><span class="o">*</span><span class="mi">17</span><span class="o">^</span><span class="mi">8</span><span class="o">+</span><span class="n">O</span><span class="p">(</span><span class="mi">17</span><span class="o">^</span><span class="mi">13</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span>
<span class="go">1 + 12*17 + 13*17^2 + 13*17^3 + 10*17^4 + 7*17^5 + 16*17^7 </span>
<span class="go">+ 13*17^9 + 4*17^10 + 9*17^11 + 17^12 + O(17^13)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="s1">&#39;sage&#39;</span><span class="p">)</span>
<span class="go">1 + 12*17 + 13*17^2 + 13*17^3 + 10*17^4 + 7*17^5 + 16*17^7 </span>
<span class="go">+ 13*17^9 + 4*17^10 + 9*17^11 + 17^12 + O(17^13)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">x</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="s1">&#39;sage&#39;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Finally, this function is not defined if <span class="math">\(x\)</span> is not a <span class="math">\(p\)</span>-adic integer:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">K</span><span class="p">(</span><span class="mi">7</span><span class="o">^-</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">7</span><span class="o">^-</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="mi">7</span><span class="o">^-</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">7</span><span class="o">^-</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="mi">7</span><span class="o">^-</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="mi">7</span> 
<span class="go">....:       + 7^3 + 4*7^4 + 5*7^5 + 6*7^8 + 3*7^9 + 6*7^10 + 5*7^11 + 6*7^12 </span>
<span class="go">....:       + 3*7^13 + 5*7^14 + O(7^15))</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">gamma</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The p-adic gamma function only works on elements of Zp</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.gcd">
<code class="descname">gcd</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.gcd" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a greatest common divisor of <code class="docutils literal"><span class="pre">self</span></code> and <code class="docutils literal"><span class="pre">other</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">other</span></code> &#8211; an element in the same ring as <code class="docutils literal"><span class="pre">self</span></code></li>
</ul>
<p>AUTHORS:</p>
<ul class="simple">
<li>Julian Rueth (2012-10-19): initial version</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Since the elements are only given with finite precision,
their greatest common divisor is in general not unique (not even up
to units). For example <span class="math">\(O(3)\)</span> is a representative for the elements
0 and 3 in the 3-adic ring <span class="math">\(\ZZ_3\)</span>. The greatest common
divisior of <span class="math">\(O(3)\)</span> and <span class="math">\(O(3)\)</span> could be (among others) 3 or 0 which
have different valuation. The algorithm implemented here, will
return an element of&nbsp;minimal valuation among the possible greatest
common divisors.</p>
</div>
<p>EXAMPLES:</p>
<p>The greatest common divisor is either zero or a power of the
uniformizing parameter:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">zero</span><span class="p">())</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="go">3 + O(3^21)</span>
</pre></div>
</div>
<p>A non-zero result is always lifted to the maximal precision possible in
the ring:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span> <span class="n">a</span>
<span class="go">3 + O(3^2)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> <span class="n">b</span>
<span class="go">3^2 + O(3^3)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">3 + O(3^21)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">3 + O(3^21)</span>
</pre></div>
</div>
<p>If both elements are zero, then the result is zero with the precision
set to the smallest of their precisions:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">zero</span><span class="p">();</span> <span class="n">a</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span> <span class="n">b</span>
<span class="go">O(3^2)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">O(3^2)</span>
</pre></div>
</div>
<p>One could argue that it is mathematically correct to return <span class="math">\(9 +
O(3^{22})\)</span> instead. However, this would lead to some confusing
behaviour:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">alternative_gcd</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">22</span><span class="p">);</span> <span class="n">alternative_gcd</span>
<span class="go">3^2 + O(3^22)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">alternative_gcd</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>If exactly one element is zero, then the result depends on the
valuation of the other element:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span>
<span class="go">O(3^3)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span>
<span class="go">O(3^4)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span>
<span class="go">3^4 + O(3^24)</span>
</pre></div>
</div>
<p>Over a field, the greatest common divisor is either zero (possibly with
finite precision) or one:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">1 + O(3^20)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="go">O(3^2)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">1 + O(3^20)</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>The implementation also works over extensions:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1 + O(a^60)</span>

<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">a + O(a^61)</span>

<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1 + O(3^20)</span>

<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1 + O(3^20)</span>
</pre></div>
</div>
<p>For elements with a fixed modulus:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">ZpFM</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="go">3 + O(3^20)</span>
</pre></div>
</div>
<p>And elements with a capped absolute precision:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">ZpCA</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="go">3 + O(3^20)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.is_square">
<code class="descname">is_square</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.is_square" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns whether self is a square</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">self</span></code> &#8211; a p-adic element</li>
</ul>
<p>OUTPUT:</p>
<p>boolean &#8211; whether self is a square</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">R2</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R2</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R2</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">R2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">R2</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R2</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">R2</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">R2</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">R2</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">R2</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">K2</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K2</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K2</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">K2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">K2</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K2</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">K2</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">K2</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">K2</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">K2</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K2</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">K2</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.log">
<code class="descname">log</code><span class="sig-paren">(</span><em>p_branch=None</em>, <em>pi_branch=None</em>, <em>aprec=None</em>, <em>change_frac=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.log" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the <span class="math">\(p\)</span>-adic logarithm of this element.</p>
<p>The usual power series for the logarithm with values in the additive
group of a <span class="math">\(p\)</span>-adic ring only converges for 1-units (units congruent to
1 modulo <span class="math">\(p\)</span>).  However, there is a unique extension of the logarithm
to a homomorphism defined on all the units: If <span class="math">\(u = a \cdot v\)</span> is a
unit with <span class="math">\(v \equiv 1 \pmod{p}\)</span> and <span class="math">\(a\)</span> a Teichmuller representative,
then we define <span class="math">\(log(u) = log(v)\)</span>.  This is the correct extension
because the units <span class="math">\(U\)</span> split as a product <span class="math">\(U = V \times \langle w
\rangle\)</span>, where <span class="math">\(V\)</span> is the subgroup of 1-units and <span class="math">\(w\)</span> is a fundamental
root of unity.  The <span class="math">\(\langle w \rangle\)</span> factor is torsion, so must go
to 0 under any homomorphism to the fraction field, which is a torsion
free group.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">p_branch</span></code> &#8211; an element in the base ring or its fraction
field; the implementation will choose the branch of the
logarithm which sends <span class="math">\(p\)</span> to <code class="docutils literal"><span class="pre">branch</span></code>.</li>
<li><code class="docutils literal"><span class="pre">pi_branch</span></code> &#8211; an element in the base ring or its fraction
field; the implementation will choose the branch of the
logarithm which sends the uniformizer to <code class="docutils literal"><span class="pre">branch</span></code>.  You
may specify at most one of <code class="docutils literal"><span class="pre">p_branch</span></code> and <code class="docutils literal"><span class="pre">pi_branch</span></code>,
and must specify one of them if this element is not a unit.</li>
<li><code class="docutils literal"><span class="pre">aprec</span></code> &#8211; an integer or <code class="docutils literal"><span class="pre">None</span></code> (default: <code class="docutils literal"><span class="pre">None</span></code>) if not
<code class="docutils literal"><span class="pre">None</span></code>, then the result will only be correct to precision
<code class="docutils literal"><span class="pre">aprec</span></code>.</li>
<li><code class="docutils literal"><span class="pre">change_frac</span></code> &#8211; In general the codomain of the logarithm should be
in the <span class="math">\(p\)</span>-adic field, however, for most neighborhoods of 1, it lies
in the ring of integers. This flag decides if the codomain should be
the same as the input (default) or if it should change to the
fraction field of the input.</li>
</ul>
<p>NOTES:</p>
<p>What some other systems do:</p>
<ul class="simple">
<li>PARI: Seems to define the logarithm for units not congruent
to 1 as we do.</li>
<li>MAGMA: Only implements logarithm for 1-units (as of version 2.19-2)</li>
</ul>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">There is a soft-linear time algorithm for logarithm described
by Dan Berstein at
<a class="reference external" href="http://cr.yp.to/lineartime/multapps-20041007.pdf">http://cr.yp.to/lineartime/multapps-20041007.pdf</a></p>
</div>
<p>ALGORITHM:</p>
<ol class="arabic simple">
<li>Take the unit part <span class="math">\(u\)</span> of the input.</li>
</ol>
<p>2. Raise <span class="math">\(u\)</span> to <span class="math">\(q-1\)</span> where <span class="math">\(q\)</span> is the inertia degree of the ring
extension, to obtain a 1-unit.</p>
<ol class="arabic simple" start="3">
<li>Use the series expansion</li>
</ol>
<div class="math">
\[\log(1-x) = -x - 1/2 x^2 - 1/3 x^3 - 1/4 x^4 - 1/5 x^5 - \cdots\]</div>
<p>to compute the logarithm <span class="math">\(\log(u)\)</span>.</p>
<ol class="arabic simple" start="4">
<li>Divide the result by <code class="docutils literal"><span class="pre">q-1</span></code> and multiply by <code class="docutils literal"><span class="pre">self.valuation()*log(pi)</span></code></li>
</ol>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Z13</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Z13</span><span class="p">(</span><span class="mi">14</span><span class="p">);</span> <span class="n">a</span>
<span class="go">1 + 13 + O(13^10)</span>
</pre></div>
</div>
<p>Note that the relative precision decreases when we take log &#8211; it is
the absolute precision that is preserved:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">13 + 6*13^2 + 2*13^3 + 5*13^4 + 10*13^6 + 13^7 + 11*13^8 + 8*13^9 + O(13^10)</span>
<span class="gp">sage: </span><span class="n">Q13</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Q13</span><span class="p">(</span><span class="mi">14</span><span class="p">);</span> <span class="n">a</span>
<span class="go">1 + 13 + O(13^10)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">13 + 6*13^2 + 2*13^3 + 5*13^4 + 10*13^6 + 13^7 + 11*13^8 + 8*13^9 + O(13^10)</span>
</pre></div>
</div>
<p>The next few examples illustrate precision when computing <span class="math">\(p\)</span>-adic
logarithms:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">389</span><span class="p">);</span> <span class="n">e</span>
<span class="go">4 + 2*5 + 3*5^3 + O(5^10)</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">2*5 + 2*5^2 + 4*5^3 + 3*5^4 + 5^5 + 3*5^7 + 2*5^8 + 4*5^9 + O(5^10)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">K</span><span class="p">(</span><span class="mi">389</span><span class="p">);</span> <span class="n">e</span>
<span class="go">4 + 2*5 + 3*5^3 + O(5^10)</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">2*5 + 2*5^2 + 4*5^3 + 3*5^4 + 5^5 + 3*5^7 + 2*5^8 + 4*5^9 + O(5^10)</span>
</pre></div>
</div>
<p>The logarithm is not only defined for 1-units:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">2*5 + 3*5^2 + 2*5^3 + 4*5^4 + 2*5^6 + 2*5^7 + 4*5^8 + 2*5^9 + O(5^10)</span>
</pre></div>
</div>
<p>If you want to take the logarithm of a non-unit you must specify either
<code class="docutils literal"><span class="pre">p_branch</span></code> or <code class="docutils literal"><span class="pre">pi_branch</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">You must specify a branch of the logarithm for non-units</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="go">4 + O(5^10)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="go">4 + 2*5 + 3*5^2 + 2*5^3 + 4*5^4 + 2*5^6 + 2*5^7 + 4*5^8 + 2*5^9 + O(5^10)</span>
</pre></div>
</div>
<p>The branch parameters are only relevant for elements of non-zero
valuation:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">2*5 + 3*5^2 + 2*5^3 + 4*5^4 + 2*5^6 + 2*5^7 + 4*5^8 + 2*5^9 + O(5^10)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">2*5 + 3*5^2 + 2*5^3 + 4*5^4 + 2*5^6 + 2*5^7 + 4*5^8 + 2*5^9 + O(5^10)</span>
</pre></div>
</div>
<p>Logarithms can also be computed in extension fields. First, in an
Eisenstein extension:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">15</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">625</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">W</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ext</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">w</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">w</span><span class="o">^</span><span class="mi">7</span><span class="p">;</span> <span class="n">z</span>
<span class="go">1 + w^2 + 4*w^7 + O(w^20)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">w^2 + 2*w^4 + 3*w^6 + 4*w^7 + w^9 + 4*w^10 + 4*w^11 + 4*w^12 + 3*w^14 + w^15 + w^17 + 3*w^18 + 3*w^19 + O(w^20)</span>
</pre></div>
</div>
<p>In an extension, there will usually be a difference between
specifying <code class="docutils literal"><span class="pre">p_branch</span></code> and <code class="docutils literal"><span class="pre">pi_branch</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">You must specify a branch of the logarithm for non-units</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">O(w^20)</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="n">w</span><span class="p">)</span>
<span class="go">w + O(w^20)</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">pi_branch</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">3*w^2 + 2*w^4 + 2*w^6 + 3*w^8 + 4*w^10 + w^13 + w^14 + 2*w^15 + 2*w^16 + w^18 + 4*w^19 + O(w^20)</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">unit_part</span><span class="p">()</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">3*w^2 + 2*w^4 + 2*w^6 + 3*w^8 + 4*w^10 + w^13 + w^14 + 2*w^15 + 2*w^16 + w^18 + 4*w^19 + O(w^20)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">w</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">4</span><span class="o">*</span><span class="n">w</span><span class="o">^</span><span class="mi">7</span><span class="p">;</span> <span class="n">y</span>
<span class="go">4*w^9 + O(w^29)</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">2*w^2 + 2*w^4 + 2*w^6 + 2*w^8 + w^10 + w^12 + 4*w^13 + 4*w^14 + 3*w^15 + 4*w^16 + 4*w^17 + w^18 + 4*w^19 + O(w^20)</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="n">w</span><span class="p">)</span>
<span class="go">w + 2*w^2 + 2*w^4 + 4*w^5 + 2*w^6 + 2*w^7 + 2*w^8 + 4*w^9 + w^10 + 3*w^11 + w^12 + 4*w^14 + 4*w^16 + 2*w^17 + w^19 + O(w^20)</span>
</pre></div>
</div>
<p>Check that log is multiplicative:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">z</span><span class="o">.</span><span class="n">log</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">O(w^20)</span>
</pre></div>
</div>
<p>Now an unramified example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ext</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">(a^2 + 1)*5 + (3*a^2 + 4*a + 2)*5^2 + (3*a^2 + 2*a)*5^3 + (3*a^2 + 2*a + 2)*5^4 + O(5^5)</span>
</pre></div>
</div>
<p>Check that log is multiplicative:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">5</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">log</span><span class="p">()</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">log</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">O(5^5)</span>
</pre></div>
</div>
<p>We illustrate the effect of the precision argument:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">ZpCA</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">41152263</span><span class="p">);</span> <span class="n">x</span>
<span class="go">5 + 3*7^2 + 4*7^3 + 3*7^4 + 5*7^5 + 6*7^6 + 7^9 + O(7^10)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">aprec</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">7 + 3*7^2 + 4*7^3 + 3*7^4 + O(7^5)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">aprec</span> <span class="o">=</span> <span class="mi">7</span><span class="p">)</span>
<span class="go">7 + 3*7^2 + 4*7^3 + 3*7^4 + 7^5 + 3*7^6 + O(7^7)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">7 + 3*7^2 + 4*7^3 + 3*7^4 + 7^5 + 3*7^6 + 7^7 + 3*7^8 + 4*7^9 + O(7^10)</span>
</pre></div>
</div>
<p>The logarithm is not defined for zero:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">logarithm is not defined at zero</span>
</pre></div>
</div>
<p>For elements in a <span class="math">\(p\)</span>-adic ring, the logarithm will be returned in the
same ring:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">log</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">7-adic Ring with capped absolute precision 10</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">7-adic Ring with capped absolute precision 10</span>
</pre></div>
</div>
<p>This is not possible if the logarithm has negative valuation:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">ZpCA</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">W</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ext</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">logarithm is not integral, use change_frac=True to obtain a result in the fraction field</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">change_frac</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">2*w^-3 + O(w^21)</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Check that results are consistent over a range of precision:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">max_prec</span> <span class="o">=</span> <span class="mi">40</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">max_prec</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">full_log</span> <span class="o">=</span> <span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">p</span><span class="p">))</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">prec</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">max_prec</span><span class="p">):</span>
<span class="gp">... </span>      <span class="n">ll1</span> <span class="o">=</span> <span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">add_bigoh</span><span class="p">(</span><span class="n">prec</span><span class="p">))</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="gp">... </span>      <span class="n">ll2</span> <span class="o">=</span> <span class="n">K</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span>
<span class="gp">... </span>      <span class="k">assert</span> <span class="n">ll1</span> <span class="o">==</span> <span class="n">full_log</span>
<span class="gp">... </span>      <span class="k">assert</span> <span class="n">ll2</span> <span class="o">==</span> <span class="n">full_log</span>
<span class="gp">... </span>      <span class="k">assert</span> <span class="n">ll1</span><span class="o">.</span><span class="n">precision_absolute</span><span class="p">()</span> <span class="o">==</span> <span class="n">prec</span>
</pre></div>
</div>
<p>Check that <code class="docutils literal"><span class="pre">aprec</span></code> works for fixed-mod elements:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">ZpFM</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">41152263</span><span class="p">);</span> <span class="n">x</span>
<span class="go">5 + 3*7^2 + 4*7^3 + 3*7^4 + 5*7^5 + 6*7^6 + 7^9 + O(7^10)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">aprec</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">7 + 3*7^2 + 4*7^3 + 3*7^4 + O(7^10)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">aprec</span> <span class="o">=</span> <span class="mi">7</span><span class="p">)</span>
<span class="go">7 + 3*7^2 + 4*7^3 + 3*7^4 + 7^5 + 3*7^6 + O(7^10)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">7 + 3*7^2 + 4*7^3 + 3*7^4 + 7^5 + 3*7^6 + 7^7 + 3*7^8 + 4*7^9 + O(7^10)</span>
</pre></div>
</div>
<p>Check that precision is computed correctly in highly ramified
extensions:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">625</span> <span class="o">-</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">W</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">w</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">w</span><span class="o">^</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">z</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">log</span><span class="p">()</span><span class="o">.</span><span class="n">precision_absolute</span><span class="p">()</span>
<span class="go">-975</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">precision_absolute</span><span class="p">()</span>
<span class="go">-570</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">25</span><span class="o">/</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">precision_absolute</span><span class="p">()</span>
<span class="go">-975</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">125</span><span class="o">/</span><span class="mi">125</span><span class="p">)</span><span class="o">.</span><span class="n">precision_absolute</span><span class="p">()</span>
<span class="go">-775</span>

<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">w</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">w</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">z</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">log</span><span class="p">()</span><span class="o">.</span><span class="n">precision_absolute</span><span class="p">()</span>
<span class="go">-1625</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">precision_absolute</span><span class="p">()</span>
<span class="go">-615</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">25</span><span class="o">/</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">precision_absolute</span><span class="p">()</span>
<span class="go">-1200</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">125</span><span class="o">/</span><span class="mi">125</span><span class="p">)</span><span class="o">.</span><span class="n">precision_absolute</span><span class="p">()</span>
<span class="go">-1625</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">625</span><span class="o">/</span><span class="mi">625</span><span class="p">)</span><span class="o">.</span><span class="n">precision_absolute</span><span class="p">()</span>
<span class="go">-1250</span>

<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">log</span><span class="p">()</span><span class="o">.</span><span class="n">precision_relative</span><span class="p">()</span>
<span class="go">250</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>William Stein: initial version</li>
<li>David Harvey (2006-09-13): corrected subtle precision bug (need to
take denominators into account! &#8211; see <a class="reference external" href="https://trac.sagemath.org/53">trac ticket #53</a>)</li>
<li>Genya Zaytman (2007-02-14): adapted to new <span class="math">\(p\)</span>-adic class</li>
<li>Amnon Besser, Marc Masdeu (2012-02-21): complete rewrite, valid for
generic <span class="math">\(p\)</span>-adic rings.</li>
<li>Soroosh Yazdani (2013-02-1): Fixed a precision issue in
<code class="xref py py-meth docutils literal"><span class="pre">_shifted_log()</span></code>.  This should really fix the issue with
divisions.</li>
<li>Julian Rueth (2013-02-14): Added doctests, some changes for
capped-absolute implementations.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.minimal_polynomial">
<code class="descname">minimal_polynomial</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.minimal_polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a minimal polynomial of this <span class="math">\(p\)</span>-adic element, i.e., <code class="docutils literal"><span class="pre">x</span> <span class="pre">-</span> <span class="pre">self</span></code></p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">self</span></code> &#8211; a <span class="math">\(p\)</span>-adic element</li>
<li><code class="docutils literal"><span class="pre">name</span></code> &#8211; string: the name of the variable</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">minimal_polynomial</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="go">(1 + O(5^5))*x + (3 + 5 + 3*5^2 + 5^3 + 3*5^4 + O(5^5))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.multiplicative_order">
<code class="descname">multiplicative_order</code><span class="sig-paren">(</span><em>prec=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.multiplicative_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the multiplicative order of self, where self is
considered to be one if it is one modulo <span class="math">\(p^{\mbox{prec}}\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">self</span></code> &#8211; a p-adic element</li>
<li><code class="docutils literal"><span class="pre">prec</span></code> &#8211; an integer</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>integer &#8211; the multiplicative order of self</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zeta</span><span class="p">()</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">4</span>

<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">zeta</span><span class="p">()</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.norm">
<code class="descname">norm</code><span class="sig-paren">(</span><em>ground=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the norm of this <span class="math">\(p\)</span>-adic element over the ground ring.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This is not the <span class="math">\(p\)</span>-adic absolute value.  This is a field
theoretic norm down to a ground ring.  If you want the
<span class="math">\(p\)</span>-adic absolute value, use the <code class="docutils literal"><span class="pre">abs()</span></code> function
instead.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">ground</span></code> &#8211; a subring of the parent (default: base ring)</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">5 + O(5^21)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.ordp">
<code class="descname">ordp</code><span class="sig-paren">(</span><em>p=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.ordp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the valuation of self, normalized so that the valuation of <span class="math">\(p\)</span> is 1</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">self</span></code> &#8211; a p-adic element</li>
<li><code class="docutils literal"><span class="pre">p</span></code> &#8211; a prime (default: <code class="docutils literal"><span class="pre">None</span></code>). If specified, will make sure that <code class="docutils literal"><span class="pre">p</span> <span class="pre">==</span> <span class="pre">self.parent().prime()</span></code></li>
</ul>
<p>NOTE: The optional argument p is used for consistency with the valuation methods on integer and rational.</p>
<p>OUTPUT:</p>
<p>integer &#8211; the valuation of self, normalized so that the valuation of <span class="math">\(p\)</span> is 1</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">ordp</span><span class="p">()</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ordp</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">ordp</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ordp</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">ordp</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">ordp</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">ordp</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">ordp</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.rational_reconstruction">
<code class="descname">rational_reconstruction</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.rational_reconstruction" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a rational approximation to this p-adic number</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">self</span></code> &#8211; a p-adic element</li>
</ul>
<p>OUTPUT:</p>
<p>rational &#8211; an approximation to self</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">):</span>
<span class="gp">... </span>      <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
<span class="gp">... </span>          <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
<span class="gp">... </span>              <span class="k">continue</span>
<span class="gp">... </span>          <span class="k">assert</span> <span class="n">i</span><span class="o">/</span><span class="n">j</span> <span class="o">==</span> <span class="n">R</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="n">j</span><span class="p">)</span><span class="o">.</span><span class="n">rational_reconstruction</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.square_root">
<code class="descname">square_root</code><span class="sig-paren">(</span><em>extend=True</em>, <em>all=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.square_root" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the square root of this p-adic number</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">self</span></code> &#8211; a p-adic element</li>
<li><code class="docutils literal"><span class="pre">extend</span></code> &#8211; bool (default: True); if True, return a square root in
an extension if necessary; if False and no root exists in the given
ring or field, raise a ValueError</li>
<li><code class="docutils literal"><span class="pre">all</span></code> &#8211; bool (default: False); if True, return a list of all
square roots</li>
</ul>
<p>OUTPUT:</p>
<p>p-adic element &#8211; the square root of this p-adic number</p>
<p>If <code class="docutils literal"><span class="pre">all=False</span></code>, the square root chosen is the one whose
reduction mod <span class="math">\(p\)</span> is in the range <span class="math">\([0, p/2)\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">,</span> <span class="s1">&#39;val-unit&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">1 + O(3^20)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">(</span><span class="n">extend</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">element is not a square</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span> <span class="o">==</span> <span class="n">R</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">3 * 1 + O(3^21)</span>
</pre></div>
</div>
<p>When p = 2, the precision of the square root is one less
than the input:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R2</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R2</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">R2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">1 + O(2^19)</span>
<span class="gp">sage: </span><span class="n">R2</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">2 + O(2^20)</span>

<span class="gp">sage: </span><span class="n">R2</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span> <span class="o">==</span> <span class="n">R2</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span> <span class="ow">or</span> <span class="n">R2</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span> <span class="o">==</span> <span class="n">R2</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">R2</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">1 + 2^3 + 2^5 + 2^6 + 2^7 + 2^9 + 2^10 + 2^13 + 2^16 + 2^17 + O(2^19)</span>

<span class="gp">sage: </span><span class="n">R3</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R3</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">R3</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">1 + O(5^20)</span>
<span class="gp">sage: </span><span class="n">R3</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span> <span class="o">==</span> <span class="n">R3</span><span class="o">.</span><span class="n">teichmuller</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="ow">or</span> <span class="n">R3</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span> <span class="o">==</span> <span class="n">R3</span><span class="o">.</span><span class="n">teichmuller</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">1 + O(3^20)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span> <span class="o">==</span> <span class="n">R</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">3 + O(3^21)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">3^-1 + O(3^19)</span>

<span class="gp">sage: </span><span class="n">R2</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R2</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">R2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">1 + O(2^19)</span>
<span class="gp">sage: </span><span class="n">R2</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">2 + O(2^20)</span>
<span class="gp">sage: </span><span class="n">R2</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span> <span class="o">==</span> <span class="n">R2</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">19</span><span class="p">)</span> <span class="ow">or</span> <span class="n">R2</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span> <span class="o">==</span> <span class="n">R2</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">19</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R2</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">1 + 2^3 + 2^5 + 2^6 + 2^7 + 2^9 + 2^10 + 2^13 + 2^16 + 2^17 + O(2^19)</span>

<span class="gp">sage: </span><span class="n">R3</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R3</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">R3</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">1 + O(5^20)</span>
<span class="gp">sage: </span><span class="n">R3</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span> <span class="o">==</span> <span class="n">R3</span><span class="o">.</span><span class="n">teichmuller</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="ow">or</span> <span class="n">R3</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span> <span class="o">==</span> <span class="n">R3</span><span class="o">.</span><span class="n">teichmuller</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-abs&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">1 + O(3^20)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span> <span class="o">==</span> <span class="n">R</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">3 + O(3^19)</span>
<span class="gp">sage: </span><span class="n">R2</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-abs&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">1 + O(2^19)</span>
<span class="gp">sage: </span><span class="n">R2</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">2 + O(2^18)</span>
<span class="gp">sage: </span><span class="n">R2</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span> <span class="o">==</span> <span class="n">R2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="ow">or</span> <span class="n">R2</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span> <span class="o">==</span> <span class="n">R2</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R2</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">1 + 2^3 + 2^5 + 2^6 + 2^7 + 2^9 + 2^10 + 2^13 + 2^16 + 2^17 + O(2^19)</span>
<span class="gp">sage: </span><span class="n">R3</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-abs&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R3</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">1 + O(5^20)</span>
<span class="gp">sage: </span><span class="n">R3</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span> <span class="o">==</span> <span class="n">R3</span><span class="o">.</span><span class="n">teichmuller</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="ow">or</span> <span class="n">R3</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span> <span class="o">==</span> <span class="n">R3</span><span class="o">.</span><span class="n">teichmuller</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.str">
<code class="descname">str</code><span class="sig-paren">(</span><em>mode=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.str" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a string representation of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">print_mode</span><span class="o">=</span><span class="s1">&#39;bars&#39;</span><span class="p">)(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">()[</span><span class="mi">3</span><span class="p">:]</span>
<span class="go">&#39;1|3|1|3|2&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.trace">
<code class="descname">trace</code><span class="sig-paren">(</span><em>ground=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the trace of this <span class="math">\(p\)</span>-adic element over the ground ring</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">ground</span></code> &#8211; a subring of the ground ring (default: base
ring)</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">element</span></code> &#8211; the trace of this <span class="math">\(p\)</span>-adic element over the
ground ring</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span>
<span class="go">5 + O(5^6)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.val_unit">
<code class="descname">val_unit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.val_unit" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal"><span class="pre">(self.valuation(),</span> <span class="pre">self.unit_part())</span></code>. To be overridden in
derived classes.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">val_unit</span><span class="p">()</span>
<span class="go">(1, 1 + O(5^5))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.valuation">
<code class="descname">valuation</code><span class="sig-paren">(</span><em>p=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.valuation" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the valuation of this element.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">self</span></code> &#8211; a p-adic element</li>
<li><code class="docutils literal"><span class="pre">p</span></code> &#8211; a prime (default: None). If specified, will make sure that p==self.parent().prime()</li>
</ul>
<p>NOTE: The optional argument p is used for consistency with the valuation methods on integer and rational.</p>
<p>OUTPUT:</p>
<p>integer &#8211; the valuation of self</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">17</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">17</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">-2</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">-2</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Qq</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">+Infinity</span>

<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">-2</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Ring (5-adic Field with capped relative precision 4) residue field of the wrong characteristic.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.xgcd">
<code class="descname">xgcd</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.xgcd" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the extended gcd of this element and <code class="docutils literal"><span class="pre">other</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">other</span></code> &#8211; an element in the same ring</li>
</ul>
<p>OUTPUT:</p>
<p>A tuple <code class="docutils literal"><span class="pre">r</span></code>, <code class="docutils literal"><span class="pre">s</span></code>, <code class="docutils literal"><span class="pre">t</span></code> such that <code class="docutils literal"><span class="pre">r</span></code> is a greatest common
divisor of this element and <code class="docutils literal"><span class="pre">other</span></code> and <code class="docutils literal"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">s*self</span> <span class="pre">+</span> <span class="pre">t*other</span></code>.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>Julian Rueth (2012-10-19): initial version</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Since the elements are only given with finite precision, their
greatest common divisor is in general not unique (not even up to
units). For example <span class="math">\(O(3)\)</span> is a representative for the elements 0
and 3 in the 3-adic ring <span class="math">\(\ZZ_3\)</span>. The greatest common
divisior of <span class="math">\(O(3)\)</span> and <span class="math">\(O(3)\)</span> could be (among others) 3 or 0 which
have different valuation. The algorithm implemented here, will
return an element of minimal valuation among the possible greatest
common divisors.</p>
</div>
<p>EXAMPLES:</p>
<p>The greatest common divisor is either zero or a power of the
uniformizing paramter:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">zero</span><span class="p">())</span>
<span class="go">(0, 1 + O(3^20), 0)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="go">(3 + O(3^21), 1 + O(3^20), 0)</span>
</pre></div>
</div>
<p>Unlike for <a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.gcd" title="sage.rings.padics.padic_generic_element.pAdicGenericElement.gcd"><code class="xref py py-meth docutils literal"><span class="pre">gcd()</span></code></a>, the result is not lifted to the maximal
precision possible in the ring; it is such that <code class="docutils literal"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">s*self</span> <span class="pre">+</span>
<span class="pre">t*other</span></code> holds true:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span> <span class="n">a</span>
<span class="go">3 + O(3^2)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> <span class="n">b</span>
<span class="go">3^2 + O(3^3)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">(3 + O(3^2), 1 + O(3), 0)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(3 + O(3^2), 1 + O(3), 0)</span>
</pre></div>
</div>
<p>If both elements are zero, then the result is zero with
the precision set to the smallest of their precisions:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">zero</span><span class="p">();</span> <span class="n">a</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span> <span class="n">b</span>
<span class="go">O(3^2)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">(O(3^2), 0, 1 + O(3^20))</span>
</pre></div>
</div>
<p>If only one element is zero, then the result depends on its precision:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="go">(O(3), 0, 1 + O(3^20))</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="go">(O(3^2), 0, 1 + O(3^20))</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="go">(3^2 + O(3^22), 1 + O(3^20), 0)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="go">(3^2 + O(3^22), 1 + O(3^20), 0)</span>
</pre></div>
</div>
<p>Over a field, the greatest common divisor is either zero (possibly with
finite precision) or one:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(1 + O(3^20), 3^-1 + O(3^19), 0)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(0, 1 + O(3^20), 0)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="go">(O(3^2), 0, 1 + O(3^20))</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">(1 + O(3^20), 3^-1 + O(3^19), 0)</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>The implementation also works over extensions:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(1 + O(a^60),</span>
<span class="go"> a^-1 + 2*a + a^3 + 2*a^4 + 2*a^5 + 2*a^8 + 2*a^9</span>
<span class="go">  + 2*a^12 + 2*a^13 + 2*a^16 + 2*a^17 + 2*a^20 + 2*a^21 + 2*a^24</span>
<span class="go">  + 2*a^25 + 2*a^28 + 2*a^29 + 2*a^32 + 2*a^33 + 2*a^36 + 2*a^37</span>
<span class="go">  + 2*a^40 + 2*a^41 + 2*a^44 + 2*a^45 + 2*a^48 + 2*a^49 + 2*a^52</span>
<span class="go">  + 2*a^53 + 2*a^56 + 2*a^57 + O(a^59),</span>
<span class="go"> 0)</span>

<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(a + O(a^61),</span>
<span class="go"> 1 + 2*a^2 + a^4 + 2*a^5 + 2*a^6 + 2*a^9 + 2*a^10</span>
<span class="go">  + 2*a^13 + 2*a^14 + 2*a^17 + 2*a^18 + 2*a^21 + 2*a^22 + 2*a^25</span>
<span class="go">  + 2*a^26 + 2*a^29 + 2*a^30 + 2*a^33 + 2*a^34 + 2*a^37 + 2*a^38</span>
<span class="go">  + 2*a^41 + 2*a^42 + 2*a^45 + 2*a^46 + 2*a^49 + 2*a^50 + 2*a^53</span>
<span class="go">  + 2*a^54 + 2*a^57 + 2*a^58 + O(a^60),</span>
<span class="go"> 0)</span>

<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(1 + O(3^20),</span>
<span class="go"> 2*a + (a + 1)*3 + (2*a + 1)*3^2 + (a + 2)*3^4 + 3^5</span>
<span class="go">  + (2*a + 2)*3^6 + a*3^7 + (2*a + 1)*3^8 + (a + 2)*3^10 + 3^11</span>
<span class="go">  + (2*a + 2)*3^12 + a*3^13 + (2*a + 1)*3^14 + (a + 2)*3^16</span>
<span class="go">  + 3^17 + (2*a + 2)*3^18 + a*3^19 + O(3^20),</span>
<span class="go"> 0)</span>

<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(1 + O(3^20),</span>
<span class="go"> 2*a + (a + 1)*3 + (2*a + 1)*3^2 + (a + 2)*3^4 + 3^5</span>
<span class="go">  + (2*a + 2)*3^6 + a*3^7 + (2*a + 1)*3^8 + (a + 2)*3^10 + 3^11</span>
<span class="go">  + (2*a + 2)*3^12 + a*3^13 + (2*a + 1)*3^14 + (a + 2)*3^16 + 3^17</span>
<span class="go">  + (2*a + 2)*3^18 + a*3^19 + O(3^20),</span>
<span class="go"> 0)</span>
</pre></div>
</div>
<p>For elements with a fixed modulus:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">ZpFM</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="go">(3 + O(3^20), 1 + O(3^20), O(3^20))</span>
</pre></div>
</div>
<p>And elements with a capped absolute precision:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">ZpCA</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="go">(3 + O(3^20), 1 + O(3^19), O(3^20))</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="local_generic_element.html"
                                  title="previous chapter">Local Generic Element</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="padic_capped_relative_element.html"
                                  title="next chapter"><span class="math">\(p\)</span>-Adic Capped Relative Elements</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../_sources/sage/rings/padics/padic_generic_element.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="padic_capped_relative_element.html" title="\(p\)-Adic Capped Relative Elements"
             >next</a> |</li>
        <li class="right" >
          <a href="local_generic_element.html" title="Local Generic Element"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">p-Adics</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &copy; Copyright 2005--2016, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.4.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>