<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="\(p\)-adic Capped Relative Elements" href="padic_capped_relative_element.html" /><link rel="prev" title="Local Generic Element" href="local_generic_element.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>\(p\)-adic Generic Element - $p$-adics</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-furo.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-codemirror-monokai.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">$p$-adics</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 10.2 Reference Manual</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../../index.html">Home - $p$-adics</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Introduction to the <span class="math notranslate nohighlight">\(p\)</span>-adics</a></li>
<li class="toctree-l1"><a class="reference internal" href="factory.html">Factory</a></li>
<li class="toctree-l1"><a class="reference internal" href="local_generic.html">Local Generic</a></li>
<li class="toctree-l1"><a class="reference internal" href="padic_generic.html"><span class="math notranslate nohighlight">\(p\)</span>-adic Generic</a></li>
<li class="toctree-l1"><a class="reference internal" href="generic_nodes.html"><span class="math notranslate nohighlight">\(p\)</span>-adic Generic Nodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="padic_base_generic.html"><span class="math notranslate nohighlight">\(p\)</span>-adic Base Generic</a></li>
<li class="toctree-l1"><a class="reference internal" href="padic_extension_generic.html"><span class="math notranslate nohighlight">\(p\)</span>-adic Extension Generic</a></li>
<li class="toctree-l1"><a class="reference internal" href="eisenstein_extension_generic.html">Eisenstein Extension Generic</a></li>
<li class="toctree-l1"><a class="reference internal" href="unramified_extension_generic.html">Unramified Extension Generic</a></li>
<li class="toctree-l1"><a class="reference internal" href="padic_base_leaves.html"><span class="math notranslate nohighlight">\(p\)</span>-adic Base Leaves</a></li>
<li class="toctree-l1"><a class="reference internal" href="padic_extension_leaves.html"><span class="math notranslate nohighlight">\(p\)</span>-adic Extension Leaves</a></li>
<li class="toctree-l1"><a class="reference internal" href="local_generic_element.html">Local Generic Element</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#"><span class="math notranslate nohighlight">\(p\)</span>-adic Generic Element</a></li>
<li class="toctree-l1"><a class="reference internal" href="padic_capped_relative_element.html"><span class="math notranslate nohighlight">\(p\)</span>-adic Capped Relative Elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="padic_capped_absolute_element.html"><span class="math notranslate nohighlight">\(p\)</span>-adic Capped Absolute Elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="padic_fixed_mod_element.html"><span class="math notranslate nohighlight">\(p\)</span>-adic Fixed-Mod Element</a></li>
<li class="toctree-l1"><a class="reference internal" href="padic_ext_element.html"><span class="math notranslate nohighlight">\(p\)</span>-adic Extension Element</a></li>
<li class="toctree-l1"><a class="reference internal" href="padic_ZZ_pX_element.html"><span class="math notranslate nohighlight">\(p\)</span>-adic <code class="docutils literal notranslate"><span class="pre">ZZ_pX</span> <span class="pre">Element</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="padic_ZZ_pX_CR_element.html"><span class="math notranslate nohighlight">\(p\)</span>-adic <code class="docutils literal notranslate"><span class="pre">ZZ_pX</span></code> CR Element</a></li>
<li class="toctree-l1"><a class="reference internal" href="padic_ZZ_pX_CA_element.html"><span class="math notranslate nohighlight">\(p\)</span>-adic <code class="docutils literal notranslate"><span class="pre">ZZ_pX</span></code> CA Element</a></li>
<li class="toctree-l1"><a class="reference internal" href="padic_ZZ_pX_FM_element.html"><span class="math notranslate nohighlight">\(p\)</span>-adic <code class="docutils literal notranslate"><span class="pre">ZZ_pX</span></code> FM Element</a></li>
<li class="toctree-l1"><a class="reference internal" href="pow_computer.html">PowComputer</a></li>
<li class="toctree-l1"><a class="reference internal" href="pow_computer_ext.html">PowComputer_ext</a></li>
<li class="toctree-l1"><a class="reference internal" href="padic_printing.html"><span class="math notranslate nohighlight">\(p\)</span>-adic Printing</a></li>
<li class="toctree-l1"><a class="reference internal" href="precision_error.html">Precision Error</a></li>
<li class="toctree-l1"><a class="reference internal" href="misc.html">Miscellaneous Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="common_conversion.html">The functions in this file are used in creating new p-adic elements.</a></li>
<li class="toctree-l1"><a class="reference internal" href="morphism.html">Frobenius endomorphisms on p-adic fields</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="p-adic-generic-element">
<span id="sage-rings-padics-padic-generic-element"></span><h1><span class="math notranslate nohighlight">\(p\)</span>-adic Generic Element<a class="headerlink" href="#p-adic-generic-element" title="Permalink to this heading">#</a></h1>
<span class="target" id="module-sage.rings.padics.padic_generic_element"></span><p>Elements of <span class="math notranslate nohighlight">\(p\)</span>-adic Rings and Fields</p>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>David Roe</p></li>
<li><p>Genya Zaytman: documentation</p></li>
<li><p>David Harvey: doctests</p></li>
<li><p>Julian Rueth: fixes for exp() and log(), implemented gcd, xgcd</p></li>
</ul>
<dl class="py function">
<dt class="sig sig-object py" id="sage.rings.padics.padic_generic_element.dwork_mahler_coeffs">
<span class="sig-prename descclassname"><span class="pre">sage.rings.padics.padic_generic_element.</span></span><span class="sig-name descname"><span class="pre">dwork_mahler_coeffs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.dwork_mahler_coeffs" title="Permalink to this definition">#</a></dt>
<dd><p>Compute Dwork’s formula for Mahler coefficients of <span class="math notranslate nohighlight">\(p\)</span>-adic Gamma.</p>
<p>This is called internally when one computes Gamma for a <span class="math notranslate nohighlight">\(p\)</span>-adic
integer. Normally there is no need to call it directly.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">R</span></code> – <span class="math notranslate nohighlight">\(p\)</span>-adic ring in which to compute</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bd</span></code> – integer. Number of terms in the expansion to use</p></li>
</ul>
<p>OUTPUT:</p>
<p>A list of <span class="math notranslate nohighlight">\(p\)</span>-adic integers.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.padics.padic_generic_element</span> <span class="kn">import</span> <span class="n">dwork_mahler_coeffs</span><span class="p">,</span> <span class="n">evaluate_dwork_mahler</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">dwork_mahler_coeffs</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">evaluate_dwork_mahler</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">2 + 2*3 + 3^2 + 3^3 + 3^4 + 3^5 + 2*3^6 + 2*3^7 + 2*3^8 + 2*3^9 + 2*3^11</span>
<span class="go"> + 2*3^12 + 3^13 + 3^14 + 2*3^16 + 3^17 + 3^19 + O(3^20)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">dwork_expansion</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Same result</span>
<span class="go">2 + 2*3 + 3^2 + 3^3 + 3^4 + 3^5 + 2*3^6 + 2*3^7 + 2*3^8 + 2*3^9 + 2*3^11</span>
<span class="go"> + 2*3^12 + 3^13 + 3^14 + 2*3^16 + 3^17 + 3^19 + O(3^20)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.rings.padics.padic_generic_element.evaluate_dwork_mahler">
<span class="sig-prename descclassname"><span class="pre">sage.rings.padics.padic_generic_element.</span></span><span class="sig-name descname"><span class="pre">evaluate_dwork_mahler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.evaluate_dwork_mahler" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate Dwork’s Mahler series for <span class="math notranslate nohighlight">\(p\)</span>-adic Gamma.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.padics.padic_generic_element</span> <span class="kn">import</span> <span class="n">dwork_mahler_coeffs</span><span class="p">,</span> <span class="n">evaluate_dwork_mahler</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">dwork_mahler_coeffs</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">evaluate_dwork_mahler</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">2 + 2*3 + 3^2 + 3^3 + 3^4 + 3^5 + 2*3^6 + 2*3^7 + 2*3^8 + 2*3^9 + 2*3^11</span>
<span class="go"> + 2*3^12 + 3^13 + 3^14 + 2*3^16 + 3^17 + 3^19 + O(3^20)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">dwork_expansion</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Same result</span>
<span class="go">2 + 2*3 + 3^2 + 3^3 + 3^4 + 3^5 + 2*3^6 + 2*3^7 + 2*3^8 + 2*3^9 + 2*3^11</span>
<span class="go"> + 2*3^12 + 3^13 + 3^14 + 2*3^16 + 3^17 + 3^19 + O(3^20)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.rings.padics.padic_generic_element.gauss_table">
<span class="sig-prename descclassname"><span class="pre">sage.rings.padics.padic_generic_element.</span></span><span class="sig-name descname"><span class="pre">gauss_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_longs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.gauss_table" title="Permalink to this definition">#</a></dt>
<dd><p>Compute a table of Gauss sums using the Gross-Koblitz formula.</p>
<p>This is used in the computation of L-functions of hypergeometric motives.
The Gross-Koblitz formula is used as in <span class="math notranslate nohighlight">\(sage.rings.padics.misc.gauss_sum\)</span>,
but further unpacked for efficiency.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> - prime</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code>, <code class="docutils literal notranslate"><span class="pre">prec</span></code> - positive integers</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">use_longs</span></code> - boolean; if <code class="docutils literal notranslate"><span class="pre">True</span></code>, computations are done in C <code class="docutils literal notranslate"><span class="pre">long</span> <span class="pre">long</span></code></dt><dd><p>integers rather than Sage <span class="math notranslate nohighlight">\(p\)</span>-adics, and the results are returned
as a Python array rather than a list.</p>
</dd>
</dl>
</li>
</ul>
<p>OUTPUT:</p>
<p>A list of length <span class="math notranslate nohighlight">\(q-1=p^f-1\)</span>. The entries are <span class="math notranslate nohighlight">\(p\)</span>-adic units created with
absolute precision <code class="docutils literal notranslate"><span class="pre">prec</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.padics.padic_generic_element</span> <span class="kn">import</span> <span class="n">gauss_table</span>
<span class="gp">sage: </span><span class="n">gauss_table</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[1 + 2 + 2^2 + 2^3, 1 + 2 + 2^2 + 2^3, 1 + 2 + 2^2 + 2^3]</span>
<span class="gp">sage: </span><span class="n">gauss_table</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="kc">False</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span>
<span class="go">2 + 3 + 2*3^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.rings.padics.padic_generic_element.pAdicGenericElement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.rings.padics.padic_generic_element.</span></span><span class="sig-name descname"><span class="pre">pAdicGenericElement</span></span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="local_generic_element.html#sage.rings.padics.local_generic_element.LocalGenericElement" title="sage.rings.padics.local_generic_element.LocalGenericElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocalGenericElement</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.padics.padic_generic_element.pAdicGenericElement.abs">
<span class="sig-name descname"><span class="pre">abs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.abs" title="Permalink to this definition">#</a></dt>
<dd><p>Return the <span class="math notranslate nohighlight">\(p\)</span>-adic absolute value of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>This is normalized so that the absolute value of <span class="math notranslate nohighlight">\(p\)</span> is <span class="math notranslate nohighlight">\(1/p\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> – Integer.  The precision of the real field in which
the answer is returned.  If <code class="docutils literal notranslate"><span class="pre">None</span></code>, returns a rational for
absolutely unramified fields, or a real with 53 bits of
precision for ramified fields.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">15</span><span class="p">);</span> <span class="n">a</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="go">1/5</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mi">53</span><span class="p">)</span>                                                             <span class="c1"># needs sage.rings.real_mpfr</span>
<span class="go">0.200000000000000</span>
<span class="gp">sage: </span><span class="n">Qp</span><span class="p">(</span><span class="mi">7</span><span class="p">)(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Qp</span><span class="p">(</span><span class="mi">7</span><span class="p">)(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>                                                 <span class="c1"># needs sage.rings.real_mpfr</span>
<span class="go">0.00000</span>
</pre></div>
</div>
<p>An unramified extension:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.libs.ntl</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Z25</span><span class="o">.&lt;</span><span class="n">u</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ext</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">u</span><span class="o">^</span><span class="mi">24</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="go">1/5</span>
</pre></div>
</div>
<p>A ramified extension:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.libs.ntl</span>
<span class="gp">sage: </span><span class="n">W</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ext</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">75</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">15</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">125</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="go">0.724779663677696</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="go">0.000000000000000</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.padics.padic_generic_element.pAdicGenericElement.additive_order">
<span class="sig-name descname"><span class="pre">additive_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.additive_order" title="Permalink to this definition">#</a></dt>
<dd><p>Return the additive order of this element truncated
at precision <code class="docutils literal notranslate"><span class="pre">prec</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> – an integer or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
<p>OUTPUT:</p>
<p>The additive order of this element</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;capped-rel&#39;</span><span class="p">,</span> <span class="s1">&#39;series&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="o">^</span><span class="mi">3</span><span class="p">);</span> <span class="n">a</span><span class="o">.</span><span class="n">additive_order</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">additive_order</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;fixed-mod&#39;</span><span class="p">,</span> <span class="s1">&#39;series&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="o">^</span><span class="mi">5</span><span class="p">);</span> <span class="n">a</span><span class="o">.</span><span class="n">additive_order</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.padics.padic_generic_element.pAdicGenericElement.algdep">
<span class="sig-name descname"><span class="pre">algdep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.algdep" title="Permalink to this definition">#</a></dt>
<dd><p>Returns a polynomial of degree at most <span class="math notranslate nohighlight">\(n\)</span> which is approximately
satisfied by this number. Note that the returned polynomial need not be
irreducible, and indeed usually won’t be if this number is a good
approximation to an algebraic number of degree less than <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>ALGORITHM: Uses the PARI C-library <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/algdep">pari:algdep</a> command.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – a <span class="math notranslate nohighlight">\(p\)</span>-adic element</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – an integer</p></li>
</ul>
<p>OUTPUT:</p>
<p>polynomial – degree <span class="math notranslate nohighlight">\(n\)</span> polynomial approximately satisfied by <code class="docutils literal notranslate"><span class="pre">self</span></code></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">,</span><span class="s1">&#39;series&#39;</span><span class="p">);</span> <span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">,</span><span class="s1">&#39;series&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">19</span><span class="p">);</span> <span class="n">a</span>
<span class="go">1 + 2*3 + 3^2 + 3^3 + 2*3^4 + 2*3^5 + 3^8 + 2*3^9 + 3^11 + 3^12</span>
<span class="go">  + 2*3^15 + 2*3^16 + 3^17 + 2*3^19 + O(3^20)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">algdep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">19*x - 7</span>
<span class="gp">sage: </span><span class="n">K2</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">K2</span><span class="o">.</span><span class="n">zeta</span><span class="p">();</span> <span class="n">b</span><span class="o">.</span><span class="n">algdep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x^2 - x + 1</span>
<span class="gp">sage: </span><span class="n">K2</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">K2</span><span class="o">.</span><span class="n">zeta</span><span class="p">();</span> <span class="n">b</span><span class="o">.</span><span class="n">algdep</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">x^4 - x^3 + x^2 - x + 1</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">19</span><span class="p">);</span> <span class="n">a</span>
<span class="go">1 + 2*3 + 3^2 + 3^3 + 2*3^4 + 2*3^5 + 3^8 + 2*3^9 + 3^11 + 3^12</span>
<span class="go">  + 2*3^15 + 2*3^16 + 3^17 + 2*3^19 + O(3^20)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">algdep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">19*x - 7</span>
<span class="gp">sage: </span><span class="n">R2</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">R2</span><span class="o">.</span><span class="n">zeta</span><span class="p">();</span> <span class="n">b</span><span class="o">.</span><span class="n">algdep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x^2 - x + 1</span>
<span class="gp">sage: </span><span class="n">R2</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">R2</span><span class="o">.</span><span class="n">zeta</span><span class="p">();</span> <span class="n">b</span><span class="o">.</span><span class="n">algdep</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">x^4 - x^3 + x^2 - x + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.padics.padic_generic_element.pAdicGenericElement.algebraic_dependency">
<span class="sig-name descname"><span class="pre">algebraic_dependency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.algebraic_dependency" title="Permalink to this definition">#</a></dt>
<dd><p>Returns a polynomial of degree at most <span class="math notranslate nohighlight">\(n\)</span> which is approximately
satisfied by this number.  Note that the returned polynomial need not
be irreducible, and indeed usually won’t be if this number is a good
approximation to an algebraic number of degree less than <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>ALGORITHM: Uses the PARI C-library <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/algdep">pari:algdep</a> command.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – a p-adic element</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – an integer</p></li>
</ul>
<p>OUTPUT:</p>
<p>polynomial – degree <span class="math notranslate nohighlight">\(n\)</span> polynomial approximately satisfied by <code class="docutils literal notranslate"><span class="pre">self</span></code></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">,</span><span class="s1">&#39;series&#39;</span><span class="p">);</span> <span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">,</span><span class="s1">&#39;series&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">19</span><span class="p">);</span> <span class="n">a</span>
<span class="go">1 + 2*3 + 3^2 + 3^3 + 2*3^4 + 2*3^5 + 3^8 + 2*3^9 + 3^11 + 3^12</span>
<span class="go">  + 2*3^15 + 2*3^16 + 3^17 + 2*3^19 + O(3^20)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">algebraic_dependency</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">19*x - 7</span>
<span class="gp">sage: </span><span class="n">K2</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">K2</span><span class="o">.</span><span class="n">zeta</span><span class="p">();</span> <span class="n">b</span><span class="o">.</span><span class="n">algebraic_dependency</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x^2 - x + 1</span>
<span class="gp">sage: </span><span class="n">K2</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">K2</span><span class="o">.</span><span class="n">zeta</span><span class="p">();</span> <span class="n">b</span><span class="o">.</span><span class="n">algebraic_dependency</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">x^4 - x^3 + x^2 - x + 1</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">19</span><span class="p">);</span> <span class="n">a</span>
<span class="go">1 + 2*3 + 3^2 + 3^3 + 2*3^4 + 2*3^5 + 3^8 + 2*3^9 + 3^11 + 3^12</span>
<span class="go">  + 2*3^15 + 2*3^16 + 3^17 + 2*3^19 + O(3^20)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">algebraic_dependency</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">19*x - 7</span>
<span class="gp">sage: </span><span class="n">R2</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">R2</span><span class="o">.</span><span class="n">zeta</span><span class="p">();</span> <span class="n">b</span><span class="o">.</span><span class="n">algebraic_dependency</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x^2 - x + 1</span>
<span class="gp">sage: </span><span class="n">R2</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">R2</span><span class="o">.</span><span class="n">zeta</span><span class="p">();</span> <span class="n">b</span><span class="o">.</span><span class="n">algebraic_dependency</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">x^4 - x^3 + x^2 - x + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.padics.padic_generic_element.pAdicGenericElement.artin_hasse_exp">
<span class="sig-name descname"><span class="pre">artin_hasse_exp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.artin_hasse_exp" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Artin-Hasse exponential of this element.</p>
<p>INPUT:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> – an integer or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)
the desired precision on the result; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, the
precision is derived from the precision on the input</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – <code class="docutils literal notranslate"><span class="pre">'direct'</span></code>, <code class="docutils literal notranslate"><span class="pre">'series'</span></code>, <code class="docutils literal notranslate"><span class="pre">'newton'</span></code> or
<code class="docutils literal notranslate"><span class="pre">None</span></code> (default)</p>
<p>The direct algorithm computes the Artin-Hasse exponential
of <span class="math notranslate nohighlight">\(x\)</span>, namely <code class="docutils literal notranslate"><span class="pre">AH(x)</span></code> as</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[AH(x) = \exp(x + \frac{x^p}{p} + \frac{x^{p^2}}{p^2} + \dots\]</div>
</div>
<p>It runs roughly as fast as the computation of the exponential
(since the computation of the argument is not that costly).</p>
<p>The series algorithm computes the series defining the
Artin-Hasse exponential and evaluates it.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">'newton'</span></code> algorithm solves the equation</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\log(AH(x)) = x + \frac{x^p}{p} + \frac{x^{p^2}}{p^2} + \dots\]</div>
</div>
<p>using a Newton scheme. It runs roughly as fast as the computation
of the logarithm.</p>
<p>By default, we use the <code class="docutils literal notranslate"><span class="pre">'direct'</span></code> algorithm if a fast algorithm for
computing the exponential is available.
If not, we use the <code class="docutils literal notranslate"><span class="pre">'newton'</span></code> algorithm if a fast algorithm for
computing the logarithm is available.
Otherwise we switch to the <code class="docutils literal notranslate"><span class="pre">'series'</span></code> algorithm.</p>
</li>
</ul>
<p>OUTPUT:</p>
<p>The Artin-Hasse exponential of this element.</p>
<p>See <a class="reference external" href="https://en.wikipedia.org/wiki/Artin-Hasse_exponential">Wikipedia article Artin-Hasse_exponential</a> for more information.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">45</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">artin_hasse_exp</span><span class="p">();</span> <span class="n">y</span>
<span class="go">1 + 2*5 + 4*5^2 + 3*5^3 + 5^7 + 2*5^8 + 3*5^10 + 2*5^11 + 2*5^12 +</span>
<span class="go">2*5^13 + 5^14 + 3*5^17 + 2*5^18 + 2*5^19 + O(5^20)</span>

<span class="gp">sage: </span><span class="n">y</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">artin_hasse_exp</span><span class="p">()</span>
<span class="go">1 + O(5^20)</span>
</pre></div>
</div>
<p>The function respects your precision:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">30</span><span class="p">)(</span><span class="mi">45</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">artin_hasse_exp</span><span class="p">()</span>
<span class="go">1 + 2*3^2 + 3^4 + 2*3^5 + 3^6 + 2*3^7 + 2*3^8 + 3^9 + 2*3^10 + 3^11 +</span>
<span class="go">3^13 + 2*3^15 + 2*3^16 + 2*3^17 + 3^19 + 3^20 + 2*3^21 + 3^23 + 3^24 +</span>
<span class="go">3^26 + 3^27 + 2*3^28 + O(3^30)</span>
</pre></div>
</div>
<p>Unless you tell it not to:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">30</span><span class="p">)(</span><span class="mi">45</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">artin_hasse_exp</span><span class="p">()</span>
<span class="go">1 + 2*3^2 + 3^4 + 2*3^5 + 3^6 + 2*3^7 + 2*3^8 + 3^9 + 2*3^10 + 3^11 +</span>
<span class="go">3^13 + 2*3^15 + 2*3^16 + 2*3^17 + 3^19 + 3^20 + 2*3^21 + 3^23 + 3^24 +</span>
<span class="go">3^26 + 3^27 + 2*3^28 + O(3^30)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">artin_hasse_exp</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">1 + 2*3^2 + 3^4 + 2*3^5 + 3^6 + 2*3^7 + 2*3^8 + 3^9 + O(3^10)</span>
</pre></div>
</div>
<p>For precision 1 the function just returns 1 since the
exponential is always a 1-unit:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">while</span> <span class="n">x</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
<span class="gp">....: </span>    <span class="n">x</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">artin_hasse_exp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1 + O(3)</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Mitchell Owen, Sebastian Pancrantz (2012-02): initial version.</p></li>
<li><p>Xavier Caruso (2018-08): extend to any p-adic rings and fields
and implement several algorithms.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.padics.padic_generic_element.pAdicGenericElement.dwork_expansion">
<span class="sig-name descname"><span class="pre">dwork_expansion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.dwork_expansion" title="Permalink to this definition">#</a></dt>
<dd><p>Return the value of a function defined by Dwork.</p>
<p>Used to compute the <span class="math notranslate nohighlight">\(p\)</span>-adic Gamma function, see <a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.gamma" title="sage.rings.padics.padic_generic_element.pAdicGenericElement.gamma"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gamma()</span></code></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bd</span></code> – integer. Precision bound, defaults to 20</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code>  – integer. Offset parameter, defaults to 0</p></li>
</ul>
<p>OUTPUT:</p>
<p>A <span class="math notranslate nohighlight">\(p\)</span>-adic integer.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is based on GP code written by Fernando Rodriguez
Villegas (<a class="reference external" href="http://www.ma.utexas.edu/cnt/cnt-frames.html">http://www.ma.utexas.edu/cnt/cnt-frames.html</a>).
William Stein sped it up for GP
(<a class="reference external" href="http://sage.math.washington.edu/home/wstein/www/home/wbhart/pari-2.4.2.alpha/src/basemath/trans2.c">http://sage.math.washington.edu/home/wstein/www/home/wbhart/pari-2.4.2.alpha/src/basemath/trans2.c</a>).
The output is a <span class="math notranslate nohighlight">\(p\)</span>-adic integer from Dwork’s expansion,
used to compute the <span class="math notranslate nohighlight">\(p\)</span>-adic gamma function as in <a class="reference internal" href="../../../../references/index.html#rv2007" id="id1"><span>[RV2007]</span></a>
section 6.2.
The coefficients of the expansion are now cached to speed up
multiple evaluation, as in the trace formula for hypergeometric
motives.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="mi">17</span><span class="o">+</span><span class="mi">13</span><span class="o">*</span><span class="mi">17</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">6</span><span class="o">*</span><span class="mi">17</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">12</span><span class="o">*</span><span class="mi">17</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">10</span><span class="o">*</span><span class="mi">17</span><span class="o">^</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span><span class="o">+</span><span class="mi">5</span><span class="o">*</span><span class="mi">17</span><span class="o">^</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span><span class="o">+</span><span class="n">O</span><span class="p">(</span><span class="mi">17</span><span class="o">^</span><span class="p">(</span><span class="mi">19</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">dwork_expansion</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<span class="go">16 + 7*17 + 11*17^2 + 4*17^3 + 8*17^4 + 10*17^5 + 11*17^6 + 6*17^7</span>
<span class="go">+ 17^8 + 8*17^10 + 13*17^11 + 9*17^12 + 15*17^13  + 2*17^14 + 6*17^15</span>
<span class="go">+ 7*17^16 + 6*17^17 + O(17^18)</span>

<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="mi">5</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="mi">5</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="o">*</span><span class="mi">5</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="mi">5</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="o">*</span><span class="mi">5</span><span class="o">^</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="n">O</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="p">(</span><span class="mi">20</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">dwork_expansion</span><span class="p">()</span>
<span class="go">4 + 4*5 + 4*5^2 + 4*5^3 + 2*5^4 + 4*5^5 + 5^7 + 3*5^9 + 4*5^10 + 3*5^11</span>
<span class="go">+ 5^13 + 4*5^14 + 2*5^15 + 2*5^16 + 2*5^17 + 3*5^18 + O(5^20)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.padics.padic_generic_element.pAdicGenericElement.exp">
<span class="sig-name descname"><span class="pre">exp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.exp" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the <span class="math notranslate nohighlight">\(p\)</span>-adic exponential of this element if the exponential
series converges.</p>
<p>INPUT:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">aprec</span></code> – an integer or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); if
specified, computes only up to the indicated precision</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – <code class="docutils literal notranslate"><span class="pre">'generic'</span></code>, <code class="docutils literal notranslate"><span class="pre">'binary_splitting'</span></code>, <code class="docutils literal notranslate"><span class="pre">'newton'</span></code>
or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">'generic'</span></code> algorithm evaluates naively the series defining the
exponential, namely</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\exp(x) = 1 + x + x^2/2 + x^3/6 + x^4/24 + \cdots.\]</div>
</div>
<p>Its binary complexity is quadratic with respect to the precision.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">'binary_splitting'</span></code> algorithm is faster, it has a quasi-linear
complexity.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">'newton'</span></code> algorithms solve the equation <span class="math notranslate nohighlight">\(\log(x) =\)</span> <code class="docutils literal notranslate"><span class="pre">self</span></code>
using a Newton scheme. It runs roughly as fast as the computation
of the logarithm.</p>
<p>By default, we use the <code class="docutils literal notranslate"><span class="pre">'binary_splitting'</span></code> if it is available.
If it is not, we use the <code class="docutils literal notranslate"><span class="pre">'newton'</span></code> algorithm if a fast algorithm for
computing the logarithm is available.
Otherwise we switch to the <code class="docutils literal notranslate"><span class="pre">'generic'</span></code> algorithm.</p>
</li>
</ul>
<p>EXAMPLES:</p>
<p><a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.log" title="sage.rings.padics.padic_generic_element.pAdicGenericElement.log"><code class="xref py py-meth docutils literal notranslate"><span class="pre">log()</span></code></a> and <a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.exp" title="sage.rings.padics.padic_generic_element.pAdicGenericElement.exp"><code class="xref py py-meth docutils literal notranslate"><span class="pre">exp()</span></code></a> are inverse to each other:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Z13</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Z13</span><span class="p">(</span><span class="mi">14</span><span class="p">);</span> <span class="n">a</span>
<span class="go">1 + 13 + O(13^10)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">log</span><span class="p">()</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">1 + 13 + O(13^10)</span>
</pre></div>
</div>
<p>An error occurs if this is called with an element for which the
exponential series does not converge:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Z13</span><span class="o">.</span><span class="n">one</span><span class="p">()</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Exponential does not converge for that input.</span>
</pre></div>
</div>
<p>The next few examples illustrate precision when computing <span class="math notranslate nohighlight">\(p\)</span>-adic
exponentials:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">4</span>
<span class="gp">....: </span>       <span class="o">+</span> <span class="mi">5</span><span class="o">**</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">7</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">8</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">add_bigoh</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span> <span class="n">e</span>
<span class="go">2*5 + 2*5^2 + 4*5^3 + 3*5^4 + 5^5 + 3*5^7 + 2*5^8 + 4*5^9 + O(5^10)</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span><span class="o">*</span><span class="n">R</span><span class="o">.</span><span class="n">teichmuller</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">4 + 2*5 + 3*5^3 + O(5^10)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">K</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">4</span>
<span class="gp">....: </span>       <span class="o">+</span> <span class="mi">5</span><span class="o">**</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">7</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">8</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">add_bigoh</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span> <span class="n">e</span>
<span class="go">2*5 + 2*5^2 + 4*5^3 + 3*5^4 + 5^5 + 3*5^7 + 2*5^8 + 4*5^9 + O(5^10)</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span><span class="o">*</span><span class="n">K</span><span class="o">.</span><span class="n">teichmuller</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">4 + 2*5 + 3*5^3 + O(5^10)</span>
</pre></div>
</div>
<p>Logarithms and exponentials in extension fields. First, in an
Eisenstein extension:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.libs.ntl</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">15</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">625</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">W</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ext</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">w</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">w</span><span class="o">^</span><span class="mi">7</span><span class="p">;</span> <span class="n">z</span>
<span class="go">1 + w^2 + 4*w^7 + O(w^20)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">log</span><span class="p">()</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">1 + w^2 + 4*w^7 + O(w^20)</span>
</pre></div>
</div>
<p>Now an unramified example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.libs.ntl</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ext</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">);</span> <span class="n">b</span>
<span class="go">1 + (a^2 + 1)*5 + (2*a + 3)*5^3 + O(5^5)</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">log</span><span class="p">()</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">1 + (a^2 + 1)*5 + (2*a + 3)*5^3 + O(5^5)</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Genya Zaytman (2007-02-15)</p></li>
<li><p>Amnon Besser, Marc Masdeu (2012-02-23): Complete rewrite</p></li>
<li><p>Julian Rueth (2013-02-14): Added doctests, fixed some corner cases</p></li>
<li><p>Xavier Caruso (2017-06): Added binary splitting and Newton algorithms</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.padics.padic_generic_element.pAdicGenericElement.gamma">
<span class="sig-name descname"><span class="pre">gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pari'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.gamma" title="Permalink to this definition">#</a></dt>
<dd><p>Return the value of the <span class="math notranslate nohighlight">\(p\)</span>-adic Gamma function.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – string. Can be set to <code class="docutils literal notranslate"><span class="pre">'pari'</span></code> to call
the PARI function, or <code class="docutils literal notranslate"><span class="pre">'sage'</span></code> to call the function
implemented in Sage. The default is <code class="docutils literal notranslate"><span class="pre">'pari'</span></code> since
PARI is about 10 times faster than Sage.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a <span class="math notranslate nohighlight">\(p\)</span>-adic integer</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is based on GP code written by Fernando Rodriguez
Villegas (<a class="reference external" href="http://www.ma.utexas.edu/cnt/cnt-frames.html">http://www.ma.utexas.edu/cnt/cnt-frames.html</a>).
William Stein sped it up for GP
(<a class="reference external" href="http://sage.math.washington.edu/home/wstein/www/home/wbhart/pari-2.4.2.alpha/src/basemath/trans2.c">http://sage.math.washington.edu/home/wstein/www/home/wbhart/pari-2.4.2.alpha/src/basemath/trans2.c</a>).
The <code class="docutils literal notranslate"><span class="pre">'sage'</span></code> version uses dwork_expansion() to compute the
<span class="math notranslate nohighlight">\(p\)</span>-adic gamma function of self as in <a class="reference internal" href="../../../../references/index.html#rv2007" id="id2"><span>[RV2007]</span></a> section 6.2.</p>
</div>
<p>EXAMPLES:</p>
<p>This example illustrates <code class="docutils literal notranslate"><span class="pre">x.gamma()</span></code> for <span class="math notranslate nohighlight">\(x\)</span> a <span class="math notranslate nohighlight">\(p\)</span>-adic unit:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="mi">7</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="mi">7</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">O</span><span class="p">(</span><span class="mi">7</span><span class="o">^</span><span class="mi">20</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span>
<span class="go">1 + 2*7^2 + 4*7^3 + 5*7^4 + 3*7^5 + 7^8 + 7^9 + 4*7^10 + 3*7^12</span>
<span class="go">+ 7^13 + 5*7^14 + 3*7^15 + 2*7^16 + 2*7^17 + 5*7^18 + 4*7^19 + O(7^20)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="s1">&#39;sage&#39;</span><span class="p">)</span>
<span class="go">1 + 2*7^2 + 4*7^3 + 5*7^4 + 3*7^5 + 7^8 + 7^9 + 4*7^10 + 3*7^12</span>
<span class="go">+ 7^13 + 5*7^14 + 3*7^15 + 2*7^16 + 2*7^17 + 5*7^18 + 4*7^19 + O(7^20)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">x</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="s1">&#39;sage&#39;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Now <code class="docutils literal notranslate"><span class="pre">x.gamma()</span></code> for <span class="math notranslate nohighlight">\(x\)</span> a <span class="math notranslate nohighlight">\(p\)</span>-adic integer but not a unit:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">17</span><span class="o">+</span><span class="mi">17</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="mi">17</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">12</span><span class="o">*</span><span class="mi">17</span><span class="o">^</span><span class="mi">8</span><span class="o">+</span><span class="n">O</span><span class="p">(</span><span class="mi">17</span><span class="o">^</span><span class="mi">13</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span>
<span class="go">1 + 12*17 + 13*17^2 + 13*17^3 + 10*17^4 + 7*17^5 + 16*17^7</span>
<span class="go">+ 13*17^9 + 4*17^10 + 9*17^11 + 17^12 + O(17^13)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="s1">&#39;sage&#39;</span><span class="p">)</span>
<span class="go">1 + 12*17 + 13*17^2 + 13*17^3 + 10*17^4 + 7*17^5 + 16*17^7</span>
<span class="go">+ 13*17^9 + 4*17^10 + 9*17^11 + 17^12 + O(17^13)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">x</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="s1">&#39;sage&#39;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Finally, this function is not defined if <span class="math notranslate nohighlight">\(x\)</span> is not a <span class="math notranslate nohighlight">\(p\)</span>-adic integer:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">K</span><span class="p">(</span><span class="mi">7</span><span class="o">^-</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">7</span><span class="o">^-</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="mi">7</span><span class="o">^-</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">7</span><span class="o">^-</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="mi">7</span><span class="o">^-</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="mi">7</span>
<span class="gp">....: </span>      <span class="o">+</span> <span class="mi">7</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="mi">7</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="mi">7</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="mi">7</span><span class="o">^</span><span class="mi">8</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="mi">7</span><span class="o">^</span><span class="mi">9</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="mi">7</span><span class="o">^</span><span class="mi">10</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="mi">7</span><span class="o">^</span><span class="mi">11</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="mi">7</span><span class="o">^</span><span class="mi">12</span>
<span class="gp">....: </span>      <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="mi">7</span><span class="o">^</span><span class="mi">13</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="mi">7</span><span class="o">^</span><span class="mi">14</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="mi">7</span><span class="o">^</span><span class="mi">15</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">gamma</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: The p-adic gamma function only works on elements of Zp</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.padics.padic_generic_element.pAdicGenericElement.gcd">
<span class="sig-name descname"><span class="pre">gcd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.gcd" title="Permalink to this definition">#</a></dt>
<dd><p>Return a greatest common divisor of <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">other</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> – an element in the same ring as <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
</ul>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Julian Rueth (2012-10-19): initial version</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since the elements are only given with finite precision,
their greatest common divisor is in general not unique (not even up
to units). For example <span class="math notranslate nohighlight">\(O(3)\)</span> is a representative for the elements
0 and 3 in the 3-adic ring <span class="math notranslate nohighlight">\(\ZZ_3\)</span>. The greatest common
divisor of <span class="math notranslate nohighlight">\(O(3)\)</span> and <span class="math notranslate nohighlight">\(O(3)\)</span> could be (among others) 3 or 0 which
have different valuation. The algorithm implemented here, will
return an element of minimal valuation among the possible greatest
common divisors.</p>
</div>
<p>EXAMPLES:</p>
<p>The greatest common divisor is either zero or a power of the
uniformizing parameter:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">zero</span><span class="p">())</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="go">3 + O(3^21)</span>
</pre></div>
</div>
<p>A non-zero result is always lifted to the maximal precision possible in
the ring:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span> <span class="n">a</span>
<span class="go">3 + O(3^2)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> <span class="n">b</span>
<span class="go">3^2 + O(3^3)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">3 + O(3^21)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">3 + O(3^21)</span>
</pre></div>
</div>
<p>If both elements are zero, then the result is zero with the precision
set to the smallest of their precisions:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">zero</span><span class="p">();</span> <span class="n">a</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span> <span class="n">b</span>
<span class="go">O(3^2)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">O(3^2)</span>
</pre></div>
</div>
<p>One could argue that it is mathematically correct to return <span class="math notranslate nohighlight">\(9 +
O(3^{22})\)</span> instead. However, this would lead to some confusing
behaviour:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">alternative_gcd</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">22</span><span class="p">);</span> <span class="n">alternative_gcd</span>
<span class="go">3^2 + O(3^22)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">alternative_gcd</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>If exactly one element is zero, then the result depends on the
valuation of the other element:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span>
<span class="go">O(3^3)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span>
<span class="go">O(3^4)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span>
<span class="go">3^4 + O(3^24)</span>
</pre></div>
</div>
<p>Over a field, the greatest common divisor is either zero (possibly with
finite precision) or one:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">1 + O(3^20)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="go">O(3^2)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">1 + O(3^20)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.padics.padic_generic_element.pAdicGenericElement.is_prime">
<span class="sig-name descname"><span class="pre">is_prime</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.is_prime" title="Permalink to this definition">#</a></dt>
<dd><p>Return whether this element is prime in its parent.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.libs.ntl</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">pi</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pi</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>                                                         <span class="c1"># needs sage.symbolic</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">B</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.padics.padic_generic_element.pAdicGenericElement.is_square">
<span class="sig-name descname"><span class="pre">is_square</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.is_square" title="Permalink to this definition">#</a></dt>
<dd><p>Returns whether this element is a square</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – a <span class="math notranslate nohighlight">\(p\)</span>-adic element</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.padics.padic_generic_element.pAdicGenericElement.is_squarefree">
<span class="sig-name descname"><span class="pre">is_squarefree</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.is_squarefree" title="Permalink to this definition">#</a></dt>
<dd><p>Return whether this element is squarefree, i.e., whether there exists
no non-unit <span class="math notranslate nohighlight">\(g\)</span> such that <span class="math notranslate nohighlight">\(g^2\)</span> divides this element.</p>
<p>EXAMPLES:</p>
<p>The zero element is never squarefree:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span><span class="o">.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>In <span class="math notranslate nohighlight">\(p\)</span>-adic rings, only elements of valuation at most 1 are
squarefree:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>This works only if the precision is known sufficiently well:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">PrecisionError: element not known to sufficient precision to decide squarefreeness</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>For fields we are not so strict about the precision and treat inexact
zeros as the zero element:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">K(0,0).is_squarefree()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.padics.padic_generic_element.pAdicGenericElement.log">
<span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p_branch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi_branch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aprec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">change_frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.log" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the <span class="math notranslate nohighlight">\(p\)</span>-adic logarithm of this element.</p>
<p>The usual power series for the logarithm with values in the additive
group of a <span class="math notranslate nohighlight">\(p\)</span>-adic ring only converges for 1-units (units congruent to
1 modulo <span class="math notranslate nohighlight">\(p\)</span>).  However, there is a unique extension of the logarithm
to a homomorphism defined on all the units: If <span class="math notranslate nohighlight">\(u = a \cdot v\)</span> is a
unit with <span class="math notranslate nohighlight">\(v \equiv 1 \pmod{p}\)</span> and <span class="math notranslate nohighlight">\(a\)</span> a Teichmuller representative,
then we define <span class="math notranslate nohighlight">\(log(u) = log(v)\)</span>.  This is the correct extension
because the units <span class="math notranslate nohighlight">\(U\)</span> split as a product <span class="math notranslate nohighlight">\(U = V \times \langle w
\rangle\)</span>, where <span class="math notranslate nohighlight">\(V\)</span> is the subgroup of 1-units and <span class="math notranslate nohighlight">\(w\)</span> is a fundamental
root of unity.  The <span class="math notranslate nohighlight">\(\langle w \rangle\)</span> factor is torsion, so must go
to 0 under any homomorphism to the fraction field, which is a torsion
free group.</p>
<p>INPUT:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">p_branch</span></code> – an element in the base ring or its fraction
field; the implementation will choose the branch of the
logarithm which sends <span class="math notranslate nohighlight">\(p\)</span> to <code class="docutils literal notranslate"><span class="pre">branch</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pi_branch</span></code> – an element in the base ring or its fraction
field; the implementation will choose the branch of the
logarithm which sends the uniformizer to <code class="docutils literal notranslate"><span class="pre">branch</span></code>; you
may specify at most one of <code class="docutils literal notranslate"><span class="pre">p_branch</span></code> and <code class="docutils literal notranslate"><span class="pre">pi_branch</span></code>,
and must specify one of them if this element is not a unit</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aprec</span></code> – an integer or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); if not
<code class="docutils literal notranslate"><span class="pre">None</span></code>, then the result will only be correct to precision
<code class="docutils literal notranslate"><span class="pre">aprec</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">change_frac</span></code> – In general the codomain of the logarithm should be
in the <span class="math notranslate nohighlight">\(p\)</span>-adic field, however, for most neighborhoods of 1, it lies
in the ring of integers. This flag decides if the codomain should be
the same as the input (default) or if it should change to the
fraction field of the input.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – <code class="docutils literal notranslate"><span class="pre">'generic'</span></code>, <code class="docutils literal notranslate"><span class="pre">'binary_splitting'</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default)
The generic algorithm evaluates naively the series defining the log,
namely</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\log(1-x) = -x - 1/2 x^2 - 1/3 x^3 - 1/4 x^4 - 1/5 x^5 - \cdots.\]</div>
</div>
<p>Its binary complexity is quadratic with respect to the precision.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">'binary_splitting'</span></code> algorithm is faster, it has a quasi-linear
complexity.
By default, we use <code class="docutils literal notranslate"><span class="pre">'binary_splitting'</span></code> if it is available. Otherwise
we switch to the <code class="docutils literal notranslate"><span class="pre">'generic'</span></code> algorithm.</p>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>What some other systems do:</p>
<ul class="simple">
<li><p>PARI: Seems to define the logarithm for units not congruent
to 1 as we do.</p></li>
<li><p>MAGMA: Only implements logarithm for 1-units (version 2.19-2)</p></li>
</ul>
</div>
<div class="admonition-todo admonition" id="id3">
<p class="admonition-title">Todo</p>
<p>There is a soft-linear time algorithm for logarithm described
by Dan Bernstein at
<a class="reference external" href="http://cr.yp.to/lineartime/multapps-20041007.pdf">http://cr.yp.to/lineartime/multapps-20041007.pdf</a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Z13</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Z13</span><span class="p">(</span><span class="mi">14</span><span class="p">);</span> <span class="n">a</span>
<span class="go">1 + 13 + O(13^10)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">13 + 6*13^2 + 2*13^3 + 5*13^4 + 10*13^6 + 13^7 + 11*13^8 + 8*13^9 + O(13^10)</span>

<span class="gp">sage: </span><span class="n">Q13</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Q13</span><span class="p">(</span><span class="mi">14</span><span class="p">);</span> <span class="n">a</span>
<span class="go">1 + 13 + O(13^10)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">13 + 6*13^2 + 2*13^3 + 5*13^4 + 10*13^6 + 13^7 + 11*13^8 + 8*13^9 + O(13^10)</span>
</pre></div>
</div>
<p>Note that the relative precision decreases when we take log.
Precisely the absolute precision on <code class="docutils literal notranslate"><span class="pre">log(a)</span></code> agrees with the relative
precision on <code class="docutils literal notranslate"><span class="pre">a</span></code> thanks to the relation <span class="math notranslate nohighlight">\(d\log(a) = da/a\)</span>.</p>
<p>The call <code class="docutils literal notranslate"><span class="pre">log(a)</span></code> works as well:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">13 + 6*13^2 + 2*13^3 + 5*13^4 + 10*13^6 + 13^7 + 11*13^8 + 8*13^9 + O(13^10)</span>
<span class="gp">sage: </span><span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="n">a</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The logarithm is not only defined for 1-units:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">2*5 + 3*5^2 + 2*5^3 + 4*5^4 + 2*5^6 + 2*5^7 + 4*5^8 + 2*5^9 + O(5^10)</span>
</pre></div>
</div>
<p>If you want to take the logarithm of a non-unit you must specify either
<code class="docutils literal notranslate"><span class="pre">p_branch</span></code> or <code class="docutils literal notranslate"><span class="pre">pi_branch</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: you must specify a branch of the logarithm for non-units</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="go">4 + O(5^10)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="go">4 + 2*5 + 3*5^2 + 2*5^3 + 4*5^4 + 2*5^6 + 2*5^7 + 4*5^8 + 2*5^9 + O(5^10)</span>
</pre></div>
</div>
<p>The branch parameters are only relevant for elements of non-zero
valuation:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">2*5 + 3*5^2 + 2*5^3 + 4*5^4 + 2*5^6 + 2*5^7 + 4*5^8 + 2*5^9 + O(5^10)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">2*5 + 3*5^2 + 2*5^3 + 4*5^4 + 2*5^6 + 2*5^7 + 4*5^8 + 2*5^9 + O(5^10)</span>
</pre></div>
</div>
<p>Logarithms can also be computed in extension fields. First, in an
Eisenstein extension:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">15</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">625</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">W</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ext</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>                                                      <span class="c1"># needs sage.libs.ntl</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">w</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">w</span><span class="o">^</span><span class="mi">7</span><span class="p">;</span> <span class="n">z</span>                                                <span class="c1"># needs sage.libs.ntl</span>
<span class="go">1 + w^2 + 4*w^7 + O(w^20)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>                                                               <span class="c1"># needs sage.libs.ntl</span>
<span class="go">w^2 + 2*w^4 + 3*w^6 + 4*w^7 + w^9 + 4*w^10 + 4*w^11 + 4*w^12</span>
<span class="go"> + 3*w^14 + w^15 + w^17 + 3*w^18 + 3*w^19 + O(w^20)</span>
</pre></div>
</div>
<p>In an extension, there will usually be a difference between
specifying <code class="docutils literal notranslate"><span class="pre">p_branch</span></code> and <code class="docutils literal notranslate"><span class="pre">pi_branch</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.libs.ntl</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: you must specify a branch of the logarithm for non-units</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">O(w^20)</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="n">w</span><span class="p">)</span>
<span class="go">w + O(w^20)</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">pi_branch</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">3*w^2 + 2*w^4 + 2*w^6 + 3*w^8 + 4*w^10 + w^13 + w^14 + 2*w^15</span>
<span class="go"> + 2*w^16 + w^18 + 4*w^19 + O(w^20)</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">unit_part</span><span class="p">()</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">3*w^2 + 2*w^4 + 2*w^6 + 3*w^8 + 4*w^10 + w^13 + w^14 + 2*w^15</span>
<span class="go"> + 2*w^16 + w^18 + 4*w^19 + O(w^20)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">w</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">4</span><span class="o">*</span><span class="n">w</span><span class="o">^</span><span class="mi">7</span><span class="p">;</span> <span class="n">y</span>
<span class="go">4*w^9 + O(w^29)</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">2*w^2 + 2*w^4 + 2*w^6 + 2*w^8 + w^10 + w^12 + 4*w^13 + 4*w^14 + 3*w^15</span>
<span class="go"> + 4*w^16 + 4*w^17 + w^18 + 4*w^19 + O(w^20)</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="n">w</span><span class="p">)</span>
<span class="go">w + 2*w^2 + 2*w^4 + 4*w^5 + 2*w^6 + 2*w^7 + 2*w^8 + 4*w^9 + w^10</span>
<span class="go"> + 3*w^11 + w^12 + 4*w^14 + 4*w^16 + 2*w^17 + w^19 + O(w^20)</span>
</pre></div>
</div>
<p>Check that log is multiplicative:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">z</span><span class="o">.</span><span class="n">log</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>                   <span class="c1"># needs sage.libs.ntl</span>
<span class="go">O(w^20)</span>
</pre></div>
</div>
<p>Now an unramified example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.libs.ntl</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ext</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">(a^2 + 1)*5 + (3*a^2 + 4*a + 2)*5^2 + (3*a^2 + 2*a)*5^3</span>
<span class="go"> + (3*a^2 + 2*a + 2)*5^4 + O(5^5)</span>
</pre></div>
</div>
<p>Check that log is multiplicative:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.libs.ntl</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">5</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">log</span><span class="p">()</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">log</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">O(5^5)</span>
</pre></div>
</div>
<p>We illustrate the effect of the <code class="docutils literal notranslate"><span class="pre">precision</span></code> argument:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">ZpCA</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">41152263</span><span class="p">);</span> <span class="n">x</span>
<span class="go">5 + 3*7^2 + 4*7^3 + 3*7^4 + 5*7^5 + 6*7^6 + 7^9 + O(7^10)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">aprec</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">7 + 3*7^2 + 4*7^3 + 3*7^4 + O(7^5)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">aprec</span> <span class="o">=</span> <span class="mi">7</span><span class="p">)</span>
<span class="go">7 + 3*7^2 + 4*7^3 + 3*7^4 + 7^5 + 3*7^6 + O(7^7)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">7 + 3*7^2 + 4*7^3 + 3*7^4 + 7^5 + 3*7^6 + 7^7 + 3*7^8 + 4*7^9 + O(7^10)</span>
</pre></div>
</div>
<p>The logarithm is not defined for zero:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: logarithm is not defined at zero</span>
</pre></div>
</div>
<p>For elements in a <span class="math notranslate nohighlight">\(p\)</span>-adic ring, the logarithm will be returned in the
same ring:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">log</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">7-adic Ring with capped absolute precision 10</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">7-adic Ring with capped absolute precision 10</span>
</pre></div>
</div>
<p>This is not possible if the logarithm has negative valuation:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">ZpCA</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">W</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ext</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>                                                      <span class="c1"># needs sage.libs.ntl sage.rings.padics</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>                                                     <span class="c1"># needs sage.libs.ntl sage.rings.padics</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: logarithm is not integral, use change_frac=True</span>
<span class="go">to obtain a result in the fraction field</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">change_frac</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                                   <span class="c1"># needs sage.libs.ntl sage.rings.padics</span>
<span class="go">2*w^-3 + O(w^24)</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>William Stein: initial version</p></li>
<li><p>David Harvey (2006-09-13): corrected subtle precision bug (need to
take denominators into account! – see <a class="reference external" href="https://github.com/sagemath/sage/issues/53">github issue #53</a>)</p></li>
<li><p>Genya Zaytman (2007-02-14): adapted to new <span class="math notranslate nohighlight">\(p\)</span>-adic class</p></li>
<li><p>Amnon Besser, Marc Masdeu (2012-02-21): complete rewrite, valid for
generic <span class="math notranslate nohighlight">\(p\)</span>-adic rings.</p></li>
<li><p>Soroosh Yazdani (2013-02-1): Fixed a precision issue in
<code class="xref py py-meth docutils literal notranslate"><span class="pre">_log_generic()</span></code>.  This should really fix the issue with
divisions.</p></li>
<li><p>Julian Rueth (2013-02-14): Added doctests, some changes for
capped-absolute implementations.</p></li>
<li><p>Xavier Caruso (2017-06): Added binary splitting type algorithms
over Qp</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.padics.padic_generic_element.pAdicGenericElement.minimal_polynomial">
<span class="sig-name descname"><span class="pre">minimal_polynomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.minimal_polynomial" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the minimal polynomial of this element over <code class="docutils literal notranslate"><span class="pre">base</span></code></p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> – string (default: <code class="docutils literal notranslate"><span class="pre">'x'</span></code>): the name of the variable</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">base</span></code> – a ring (default: the base ring of the parent):
the base ring over which the minimal polynomial is computed</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">minimal_polynomial</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>                                  <span class="c1"># needs sage.libs.ntl</span>
<span class="go">(1 + O(5^5))*x + 3 + 5 + 3*5^2 + 5^3 + 3*5^4 + O(5^5)</span>

<span class="gp">sage: </span><span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">minimal_polynomial</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>                                <span class="c1"># needs sage.libs.ntl</span>
<span class="go">(1 + O(5^5))*foo + 3 + 5 + 3*5^2 + 5^3 + 3*5^4 + O(5^5)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.libs.ntl</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QqCR</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">pi</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pi</span><span class="o">.</span><span class="n">minimal_polynomial</span><span class="p">()</span>                                               <span class="c1"># needs sage.symbolic</span>
<span class="go">(1 + O(2^5))*x^4 + a*2 + a*2^2 + a*2^3 + a*2^4 + a*2^5 + O(2^6)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">pi</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">minimal_polynomial</span><span class="p">()</span>                                           <span class="c1"># needs sage.symbolic</span>
<span class="go">(1 + O(2^5))*x^2 + a*2 + a*2^2 + a*2^3 + a*2^4 + a*2^5 + O(2^6)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span><span class="o">.</span><span class="n">minimal_polynomial</span><span class="p">()</span>                                           <span class="c1"># needs sage.symbolic</span>
<span class="go">(1 + O(2^5))*x^4 + (a^2 + 1)*2^-1 + O(2^4)</span>
<span class="gp">sage: </span><span class="n">elt</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">elt</span><span class="o">.</span><span class="n">minimal_polynomial</span><span class="p">()</span>  <span class="c1"># not tested, known bug (see :trac:`32111`)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">(</span><span class="n">elt</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>  <span class="c1"># not tested</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.padics.padic_generic_element.pAdicGenericElement.multiplicative_order">
<span class="sig-name descname"><span class="pre">multiplicative_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.multiplicative_order" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the multiplicative order of <code class="docutils literal notranslate"><span class="pre">self</span></code>, where <code class="docutils literal notranslate"><span class="pre">self</span></code> is
considered to be one if it is one modulo <span class="math notranslate nohighlight">\(p^{\mbox{prec}}\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – a <span class="math notranslate nohighlight">\(p\)</span>-adic element</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> – an integer</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>integer – the multiplicative order of <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zeta</span><span class="p">()</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
<p>Over unramified extensions:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.libs.ntl</span>
<span class="gp">sage: </span><span class="n">L1</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Qq</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">L1</span><span class="o">.</span><span class="n">teichmuller</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">()</span>
<span class="go">124</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">^</span><span class="mi">124</span>
<span class="go">1 + O(5^20)</span>
</pre></div>
</div>
<p>Over totally ramified extensions:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.libs.ntl</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L2</span><span class="o">.&lt;</span><span class="n">pi</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">pi</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">L2</span><span class="o">.</span><span class="n">teichmuller</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">()</span>
<span class="go">20</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.padics.padic_generic_element.pAdicGenericElement.norm">
<span class="sig-name descname"><span class="pre">norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.norm" title="Permalink to this definition">#</a></dt>
<dd><p>Return the norm of this <span class="math notranslate nohighlight">\(p\)</span>-adic element over <code class="docutils literal notranslate"><span class="pre">base</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is not the <span class="math notranslate nohighlight">\(p\)</span>-adic absolute value.  This is a field
theoretic norm down to a base ring.  If you want the
<span class="math notranslate nohighlight">\(p\)</span>-adic absolute value, use the method <a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.abs" title="sage.rings.padics.padic_generic_element.pAdicGenericElement.abs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">abs()</span></code></a>
instead.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">base</span></code> – a subring of the parent (default: base ring)</p></li>
</ul>
<p>OUTPUT:</p>
<p>The norm of this <span class="math notranslate nohighlight">\(p\)</span>-adic element over the given base.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>                                                       <span class="c1"># needs sage.libs.ntl</span>
<span class="go">5 + O(5^21)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.libs.ntl</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QqCR</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">pi</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pi</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>  <span class="c1"># norm over K                                              # needs sage.symbolic</span>
<span class="go">a*2 + a*2^2 + a*2^3 + a*2^4 + a*2^5 + O(2^6)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">pi</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>                                                         <span class="c1"># needs sage.symbolic</span>
<span class="go">a^2*2^2 + O(2^7)</span>
<span class="gp">sage: </span><span class="n">pi</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span><span class="o">^</span><span class="mi">2</span>                                                           <span class="c1"># needs sage.symbolic</span>
<span class="go">a^2*2^2 + O(2^7)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.padics.padic_generic_element.pAdicGenericElement.nth_root">
<span class="sig-name descname"><span class="pre">nth_root</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.nth_root" title="Permalink to this definition">#</a></dt>
<dd><p>Return the <span class="math notranslate nohighlight">\(n\)</span>-th root of this element.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – an integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">all</span></code> – a boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>): if <code class="docutils literal notranslate"><span class="pre">True</span></code>,
return all <span class="math notranslate nohighlight">\(n\)</span>-th roots of this element, instead of just one.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">61376</span><span class="p">);</span> <span class="n">x</span>
<span class="go">1 + 5^3 + 3*5^4 + 4*5^5 + 3*5^6 + O(5^10)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span> <span class="n">y</span>
<span class="go">2 + 5 + 2*5^2 + 4*5^3 + 3*5^4 + 5^6 + O(5^10)</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">^</span><span class="mi">4</span> <span class="o">==</span> <span class="n">x</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="nb">all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[2 + 5 + 2*5^2 + 4*5^3 + 3*5^4 + 5^6 + O(5^10),</span>
<span class="go"> 4 + 4*5 + 4*5^2 + 4*5^4 + 3*5^5 + 5^6 + 3*5^7 + 5^8 + 5^9 + O(5^10),</span>
<span class="go"> 3 + 3*5 + 2*5^2 + 5^4 + 4*5^5 + 3*5^6 + 4*5^7 + 4*5^8 + 4*5^9 + O(5^10),</span>
<span class="go"> 1 + 4*5^3 + 5^5 + 3*5^6 + 5^7 + 3*5^8 + 3*5^9 + O(5^10)]</span>
</pre></div>
</div>
<p>When <span class="math notranslate nohighlight">\(n\)</span> is divisible by the underlying prime <span class="math notranslate nohighlight">\(p\)</span>, we
are losing precision (which is consistent with the fact
that raising to the <span class="math notranslate nohighlight">\(p\)</span>-th power increases precision):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span> <span class="n">z</span>
<span class="go">1 + 5^2 + 3*5^3 + 2*5^4 + 5^5 + 3*5^7 + 2*5^8 + O(5^9)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">^</span><span class="mi">5</span>
<span class="go">1 + 5^3 + 3*5^4 + 4*5^5 + 3*5^6 + O(5^10)</span>
</pre></div>
</div>
<p>Everything works over extensions as well:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.libs.ntl</span>
<span class="gp">sage: </span><span class="n">W</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Zq</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">W</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">pi</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">W</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">7</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">pi + O(pi^141)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="nb">all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[pi + O(pi^141)]</span>
</pre></div>
</div>
<p>An error is raised if the given element is not an <span class="math notranslate nohighlight">\(n\)</span>-th power
in the ring:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>                                                     <span class="c1"># needs sage.libs.ntl</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: this element is not a nth power</span>
</pre></div>
</div>
<p>Similarly, when precision on the input is too small, an error
is raised:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.libs.ntl</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">);</span> <span class="n">x</span>
<span class="go">1 + O(pi^6)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">PrecisionError: not enough precision to be sure that this element is a nth power</span>
</pre></div>
</div>
<p>Check that <a class="reference external" href="https://github.com/sagemath/sage/issues/30314">github issue #30314</a> is fixed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.libs.ntl</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">29</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">2 + O(a^40)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.padics.padic_generic_element.pAdicGenericElement.ordp">
<span class="sig-name descname"><span class="pre">ordp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.ordp" title="Permalink to this definition">#</a></dt>
<dd><p>Return the valuation of <code class="docutils literal notranslate"><span class="pre">self</span></code>, normalized so that the valuation of <span class="math notranslate nohighlight">\(p\)</span> is 1.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – a <span class="math notranslate nohighlight">\(p\)</span>-adic element</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>). If specified, will make sure that <code class="docutils literal notranslate"><span class="pre">p</span> <span class="pre">==</span> <span class="pre">self.parent().prime()</span></code></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The optional argument <span class="math notranslate nohighlight">\(p\)</span> is used for consistency with the valuation
methods on integers and rationals.</p>
</div>
<p>OUTPUT:</p>
<p>integer – the valuation of <code class="docutils literal notranslate"><span class="pre">self</span></code>, normalized so that the valuation of <span class="math notranslate nohighlight">\(p\)</span> is 1</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">ordp</span><span class="p">()</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ordp</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">ordp</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ordp</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">ordp</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">ordp</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">ordp</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">ordp</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.padics.padic_generic_element.pAdicGenericElement.polylog">
<span class="sig-name descname"><span class="pre">polylog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_branch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.polylog" title="Permalink to this definition">#</a></dt>
<dd><p>Return <span class="math notranslate nohighlight">\(Li_n(\mathrm{self})\)</span>, the <span class="math notranslate nohighlight">\(n\)</span>-th <span class="math notranslate nohighlight">\(p\)</span>-adic polylogarithm
of this element.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – a non-negative integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p_branch</span></code> – an element in the base ring or its fraction
field; the implementation will choose the branch of the
logarithm which sends <span class="math notranslate nohighlight">\(p\)</span> to <code class="docutils literal notranslate"><span class="pre">p_branch</span></code></p></li>
</ul>
<p>EXAMPLES:</p>
<p>The <span class="math notranslate nohighlight">\(n\)</span>-th polylogarithm of <span class="math notranslate nohighlight">\(-1\)</span> is <span class="math notranslate nohighlight">\(0\)</span> for even <span class="math notranslate nohighlight">\(n\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Qp</span><span class="p">(</span><span class="mi">13</span><span class="p">)(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">polylog</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>                                            <span class="c1"># needs sage.rings.real_mpfr sage.symbolic</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We can check some identities, for example those mentioned in <a class="reference internal" href="../../../../references/index.html#dcw2016" id="id4"><span>[DCW2016]</span></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">30</span><span class="p">)(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">polylog</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="n">x</span><span class="o">.</span><span class="n">polylog</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">polylog</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>            <span class="c1"># needs sage.symbolic</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">30</span><span class="p">)(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">polylog</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">polylog</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span>                  <span class="c1"># needs sage.symbolic</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">30</span><span class="p">)(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">polylog</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">polylog</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>       <span class="c1"># needs sage.symbolic</span>
<span class="go">True</span>
</pre></div>
</div>
<p><span class="math notranslate nohighlight">\(Li_1(z) = -\log(1-z)\)</span> for <span class="math notranslate nohighlight">\(|z| &lt; 1\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">polylog</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">1</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The dilogarithm of 1 is zero:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">polylog</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>                                                   <span class="c1"># needs sage.rings.real_mpfr sage.symbolic</span>
<span class="go">O(5^20)</span>
</pre></div>
</div>
<p>The cubing relation holds for the trilogarithm at 1:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">zeta</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="o">-</span><span class="mi">8</span><span class="o">*</span><span class="n">K</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">polylog</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="mi">9</span><span class="o">*</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">polylog</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">K</span><span class="p">(</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">polylog</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>         <span class="c1"># needs sage.rings.padics sage.rings.real_mpfr sage.symbolic</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The polylogarithm of 0 is 0:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Qp</span><span class="p">(</span><span class="mi">11</span><span class="p">)(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">polylog</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Only polylogarithms for positive <span class="math notranslate nohighlight">\(n\)</span> are defined:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Qp</span><span class="p">(</span><span class="mi">11</span><span class="p">)(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">polylog</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: polylogarithm only implemented for n at least 0</span>
</pre></div>
</div>
<p>Check that <a class="reference external" href="https://github.com/sagemath/sage/issues/29222">github issue #29222</a> is fixed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">print</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">7</span><span class="o">^</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">polylog</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>                                         <span class="c1"># needs sage.symbolic</span>
<span class="go">6*7^14 + 3*7^15 + 7^16 + 7^17 + O(7^18)</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>The algorithm of Besser-de Jeu, as described in <a class="reference internal" href="../../../../references/index.html#bdj2008" id="id5"><span>[BdJ2008]</span></a> is used.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Jennifer Balakrishnan - Initial implementation</p></li>
<li><p>Alex J. Best (2017-07-21) - Extended to other residue disks</p></li>
</ul>
<div class="admonition-todo admonition" id="id6">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Implement for extensions.</p></li>
<li><p>Use the change method to create K from <code class="docutils literal notranslate"><span class="pre">self.parent()</span></code>.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.padics.padic_generic_element.pAdicGenericElement.rational_reconstruction">
<span class="sig-name descname"><span class="pre">rational_reconstruction</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.rational_reconstruction" title="Permalink to this definition">#</a></dt>
<dd><p>Returns a rational approximation to this <span class="math notranslate nohighlight">\(p\)</span>-adic number.</p>
<p>This will raise an <a class="reference external" href="https://docs.python.org/library/exceptions.html#ArithmeticError" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArithmeticError</span></code></a> if there are no valid
approximations to the unit part with numerator and
denominator bounded by <code class="docutils literal notranslate"><span class="pre">sqrt(p^absprec</span> <span class="pre">/</span> <span class="pre">2)</span></code>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">_rational_()</span></code></p>
</div>
<p>OUTPUT:</p>
<p>rational – an approximation to <code class="docutils literal notranslate"><span class="pre">self</span></code></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
<span class="gp">....: </span>        <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
<span class="gp">....: </span>            <span class="k">continue</span>
<span class="gp">....: </span>        <span class="k">assert</span> <span class="n">i</span><span class="o">/</span><span class="n">j</span> <span class="o">==</span> <span class="n">R</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="n">j</span><span class="p">)</span><span class="o">.</span><span class="n">rational_reconstruction</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.padics.padic_generic_element.pAdicGenericElement.square_root">
<span class="sig-name descname"><span class="pre">square_root</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.square_root" title="Permalink to this definition">#</a></dt>
<dd><p>Return the square root of this <span class="math notranslate nohighlight">\(p\)</span>-adic number.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – a <span class="math notranslate nohighlight">\(p\)</span>-adic element.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">extend</span></code> – a boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); if <code class="docutils literal notranslate"><span class="pre">True</span></code>, return a
square root in an extension if necessary; if <code class="docutils literal notranslate"><span class="pre">False</span></code> and no root
exists in the given ring or field, raise a <a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ValueError</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">all</span></code> – a boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); if <code class="docutils literal notranslate"><span class="pre">True</span></code>, return a
list of all square roots.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – <code class="docutils literal notranslate"><span class="pre">&quot;pari&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;sage&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>); Sage provides an implementation for any extension of
<span class="math notranslate nohighlight">\(\QQ_p\)</span>, whereas only square roots over <span class="math notranslate nohighlight">\(\QQ_p\)</span> are implemented in PARI;
the default is <code class="docutils literal notranslate"><span class="pre">&quot;pari&quot;</span></code> if the ground field is <span class="math notranslate nohighlight">\(\QQ_p\)</span>, <code class="docutils literal notranslate"><span class="pre">&quot;sage&quot;</span></code>
otherwise.</p></li>
</ul>
<p>OUTPUT:</p>
<p>The square root or the list of all square roots of this <span class="math notranslate nohighlight">\(p\)</span>-adic
number.</p>
<p>NOTE:</p>
<p>The square root is chosen (resp. the square roots are ordered) in
a deterministic way.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">0</span>

<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">1 + O(3^20)</span>

<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">(</span><span class="n">extend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: element is not a square</span>

<span class="gp">sage: </span><span class="o">-</span><span class="n">R</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">2 + O(3^20)</span>

<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">3 + O(3^21)</span>
</pre></div>
</div>
<p>When <span class="math notranslate nohighlight">\(p = 2\)</span>, the precision of the square root is less
than the input:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R2</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">1 + O(2^19)</span>
<span class="gp">sage: </span><span class="n">R2</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">2 + O(2^20)</span>

<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Zq</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>                                                  <span class="c1"># needs sage.libs.ntl</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">8</span><span class="o">*</span><span class="n">t</span>                                                           <span class="c1"># needs sage.libs.ntl</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>                                                       <span class="c1"># needs sage.libs.ntl</span>
<span class="go">1 + t*2^2 + t^2*2^3 + t^2*2^4 + (t^4 + t^3 + t^2)*2^5 + (t^4 + t^2)*2^6</span>
<span class="go"> + (t^5 + t^2)*2^7 + (t^6 + t^5 + t^4 + t^2)*2^8 + O(2^9)</span>

<span class="gp">sage: </span><span class="c1"># needs sage.libs.ntl</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">a</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="n">a</span><span class="o">^</span><span class="mi">7</span> <span class="o">+</span> <span class="n">a</span><span class="o">^</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span> <span class="n">u</span>
<span class="go">1 + a^4 + a^5 + a^7 + a^8 + O(a^10)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">square_root</span><span class="p">();</span> <span class="n">v</span>
<span class="go">1 + a^2 + a^4 + a^6 + O(a^7)</span>
</pre></div>
</div>
<p>However, observe that the precision increases to its original value
when we recompute the square of the square root:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span><span class="o">^</span><span class="mi">2</span>                                                                   <span class="c1"># needs sage.libs.ntl</span>
<span class="go">1 + a^4 + a^5 + a^7 + a^8 + O(a^10)</span>
</pre></div>
</div>
<p>If the input does not have enough precision in order to determine if
the given element has a square root in the ground field, an error is
raised:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.libs.ntl</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">PrecisionError: not enough precision to be sure that this element has a square root</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">1 + O(a^4)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="o">^</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">(</span><span class="n">extend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: element is not a square</span>
</pre></div>
</div>
<p>In particular, an error is raised when we try to compute the square
root of an inexact zero.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.padics.padic_generic_element.pAdicGenericElement.str">
<span class="sig-name descname"><span class="pre">str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.str" title="Permalink to this definition">#</a></dt>
<dd><p>Return a string representation of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">print_mode</span><span class="o">=</span><span class="s1">&#39;bars&#39;</span><span class="p">)(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">()[</span><span class="mi">3</span><span class="p">:]</span>
<span class="go">&#39;1|3|1|3|2&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.padics.padic_generic_element.pAdicGenericElement.trace">
<span class="sig-name descname"><span class="pre">trace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.trace" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the trace of this <span class="math notranslate nohighlight">\(p\)</span>-adic element over the base ring</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">base</span></code> – a subring of the parent (default: base ring)</p></li>
</ul>
<p>OUTPUT:</p>
<p>The trace of this <span class="math notranslate nohighlight">\(p\)</span>-adic element over the given base.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span>                                                    <span class="c1"># needs sage.libs.ntl</span>
<span class="go">5 + O(5^6)</span>

<span class="gp">sage: </span><span class="c1"># needs sage.libs.ntl</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QqCR</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">pi</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pi</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span>  <span class="c1"># trace over K                                            # needs sage.symbolic</span>
<span class="go">a*2^2 + O(2^8)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">pi</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span>                                                        <span class="c1"># needs sage.symbolic</span>
<span class="go">(a + 1)*2^2 + O(2^7)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.padics.padic_generic_element.pAdicGenericElement.val_unit">
<span class="sig-name descname"><span class="pre">val_unit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.val_unit" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">(self.valuation(),</span> <span class="pre">self.unit_part())</span></code>. To be overridden in
derived classes.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">val_unit</span><span class="p">()</span>
<span class="go">(1, 1 + O(5^5))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.padics.padic_generic_element.pAdicGenericElement.valuation">
<span class="sig-name descname"><span class="pre">valuation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.valuation" title="Permalink to this definition">#</a></dt>
<dd><p>Return the valuation of this element.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – a <span class="math notranslate nohighlight">\(p\)</span>-adic element</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>). If specified, will make sure that <code class="docutils literal notranslate"><span class="pre">p</span> <span class="pre">==</span> <span class="pre">self.parent().prime()</span></code></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The optional argument <span class="math notranslate nohighlight">\(p\)</span> is used for consistency with the valuation
methods on integers and rationals.</p>
</div>
<p>OUTPUT:</p>
<p>integer – the valuation of <code class="docutils literal notranslate"><span class="pre">self</span></code></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">17</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.padics.padic_generic_element.pAdicGenericElement.xgcd">
<span class="sig-name descname"><span class="pre">xgcd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.xgcd" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the extended gcd of this element and <code class="docutils literal notranslate"><span class="pre">other</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> – an element in the same ring</p></li>
</ul>
<p>OUTPUT:</p>
<p>A tuple <code class="docutils literal notranslate"><span class="pre">r</span></code>, <code class="docutils literal notranslate"><span class="pre">s</span></code>, <code class="docutils literal notranslate"><span class="pre">t</span></code> such that <code class="docutils literal notranslate"><span class="pre">r</span></code> is a greatest common
divisor of this element and <code class="docutils literal notranslate"><span class="pre">other</span></code> and <code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">s*self</span> <span class="pre">+</span> <span class="pre">t*other</span></code>.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Julian Rueth (2012-10-19): initial version</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since the elements are only given with finite precision, their
greatest common divisor is in general not unique (not even up to
units). For example <span class="math notranslate nohighlight">\(O(3)\)</span> is a representative for the elements 0
and 3 in the 3-adic ring <span class="math notranslate nohighlight">\(\ZZ_3\)</span>. The greatest common
divisor of <span class="math notranslate nohighlight">\(O(3)\)</span> and <span class="math notranslate nohighlight">\(O(3)\)</span> could be (among others) 3 or 0 which
have different valuation. The algorithm implemented here, will
return an element of minimal valuation among the possible greatest
common divisors.</p>
</div>
<p>EXAMPLES:</p>
<p>The greatest common divisor is either zero or a power of the
uniformizing parameter:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">zero</span><span class="p">())</span>
<span class="go">(0, 1 + O(3^20), 0)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="go">(3 + O(3^21), 1 + O(3^20), 0)</span>
</pre></div>
</div>
<p>Unlike for <a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.gcd" title="sage.rings.padics.padic_generic_element.pAdicGenericElement.gcd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gcd()</span></code></a>, the result is not lifted to the maximal
precision possible in the ring; it is such that <code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">s*self</span> <span class="pre">+</span>
<span class="pre">t*other</span></code> holds true:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span> <span class="n">a</span>
<span class="go">3 + O(3^2)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> <span class="n">b</span>
<span class="go">3^2 + O(3^3)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">(3 + O(3^2), 1 + O(3), 0)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(3 + O(3^2), 1 + O(3), 0)</span>
</pre></div>
</div>
<p>If both elements are zero, then the result is zero with
the precision set to the smallest of their precisions:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">zero</span><span class="p">();</span> <span class="n">a</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span> <span class="n">b</span>
<span class="go">O(3^2)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">(O(3^2), 0, 1 + O(3^20))</span>
</pre></div>
</div>
<p>If only one element is zero, then the result depends on its precision:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.rings.padics</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="go">(O(3), 0, 1 + O(3^20))</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="go">(O(3^2), 0, 1 + O(3^20))</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="go">(3^2 + O(3^22), 1 + O(3^20), 0)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="go">(3^2 + O(3^22), 1 + O(3^20), 0)</span>
</pre></div>
</div>
<p>Over a field, the greatest common divisor is either zero (possibly with
finite precision) or one:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(1 + O(3^20), 3^-1 + O(3^19), 0)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(0, 1 + O(3^20), 0)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="go">(O(3^2), 0, 1 + O(3^20))</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">(1 + O(3^20), 3^-1 + O(3^19), 0)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="padic_capped_relative_element.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title"><span class="math notranslate nohighlight">\(p\)</span>-adic Capped Relative Elements</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="local_generic_element.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Local Generic Element</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2023, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#"><span class="math notranslate nohighlight">\(p\)</span>-adic Generic Element</a><ul>
<li><a class="reference internal" href="#sage.rings.padics.padic_generic_element.dwork_mahler_coeffs"><code class="docutils literal notranslate"><span class="pre">dwork_mahler_coeffs()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.padics.padic_generic_element.evaluate_dwork_mahler"><code class="docutils literal notranslate"><span class="pre">evaluate_dwork_mahler()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.padics.padic_generic_element.gauss_table"><code class="docutils literal notranslate"><span class="pre">gauss_table()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement"><code class="docutils literal notranslate"><span class="pre">pAdicGenericElement</span></code></a><ul>
<li><a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.abs"><code class="docutils literal notranslate"><span class="pre">abs()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.additive_order"><code class="docutils literal notranslate"><span class="pre">additive_order()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.algdep"><code class="docutils literal notranslate"><span class="pre">algdep()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.algebraic_dependency"><code class="docutils literal notranslate"><span class="pre">algebraic_dependency()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.artin_hasse_exp"><code class="docutils literal notranslate"><span class="pre">artin_hasse_exp()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.dwork_expansion"><code class="docutils literal notranslate"><span class="pre">dwork_expansion()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.exp"><code class="docutils literal notranslate"><span class="pre">exp()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.gamma"><code class="docutils literal notranslate"><span class="pre">gamma()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.gcd"><code class="docutils literal notranslate"><span class="pre">gcd()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.is_prime"><code class="docutils literal notranslate"><span class="pre">is_prime()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.is_square"><code class="docutils literal notranslate"><span class="pre">is_square()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.is_squarefree"><code class="docutils literal notranslate"><span class="pre">is_squarefree()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.log"><code class="docutils literal notranslate"><span class="pre">log()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.minimal_polynomial"><code class="docutils literal notranslate"><span class="pre">minimal_polynomial()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.multiplicative_order"><code class="docutils literal notranslate"><span class="pre">multiplicative_order()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.norm"><code class="docutils literal notranslate"><span class="pre">norm()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.nth_root"><code class="docutils literal notranslate"><span class="pre">nth_root()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.ordp"><code class="docutils literal notranslate"><span class="pre">ordp()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.polylog"><code class="docutils literal notranslate"><span class="pre">polylog()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.rational_reconstruction"><code class="docutils literal notranslate"><span class="pre">rational_reconstruction()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.square_root"><code class="docutils literal notranslate"><span class="pre">square_root()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.str"><code class="docutils literal notranslate"><span class="pre">str()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.trace"><code class="docutils literal notranslate"><span class="pre">trace()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.val_unit"><code class="docutils literal notranslate"><span class="pre">val_unit()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.valuation"><code class="docutils literal notranslate"><span class="pre">valuation()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.xgcd"><code class="docutils literal notranslate"><span class="pre">xgcd()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/scripts/furo.js"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script src="../../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "lcm": "\\mathop{\\operatorname{lcm}}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <script src="../../../../_static/jupyter-sphinx-furo.js"></script>
    </body>
</html>