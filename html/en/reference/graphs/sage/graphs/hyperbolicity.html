<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="Tutte polynomial" href="tutte_polynomial.html" /><link rel="prev" title="Functions for reading/building graphs/digraphs" href="graph_input.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>Hyperbolicity - Graph Theory</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom-furo.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom-jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom-codemirror-monokai.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Graph Theory</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 10.2 Reference Manual</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../index.html">Home - Graph Theory</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="generic_graph.html">Generic graphs (common to directed/undirected)</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph.html">Undirected graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="digraph.html">Directed graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="bipartite_graph.html">Bipartite graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="views.html">View classes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="graph_generators.html">Common graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="digraph_generators.html">Common digraphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_generators_pyx.html">Common graphs and digraphs generators (Cython)</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_database.html">Graph database</a></li>
<li class="toctree-l1"><a class="reference internal" href="strongly_regular_db.html">Database of strongly regular graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="generators/distance_regular.html">Database of distance regular graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="generators/classical_geometries.html">Families of graphs derived from classical geometries over finite fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="generators/families.html">Various families of graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="generators/basic.html">Basic graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="generators/chessboard.html">Chessboard graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="generators/intersection.html">Intersection graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="generators/platonic_solids.html">1-skeletons of Platonic solids</a></li>
<li class="toctree-l1"><a class="reference internal" href="generators/random.html">Random graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="generators/smallgraphs.html">Various small graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="generators/world_map.html">Graphs from the World Map</a></li>
<li class="toctree-l1"><a class="reference internal" href="isgci.html">ISGCI: Information System on Graph Classes and their Inclusions</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="base/overview.html">Overview of (di)graph data structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="base/c_graph.html">Fast compiled graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="base/sparse_graph.html">Fast sparse graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="base/dense_graph.html">Fast dense graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="base/static_dense_graph.html">Static dense graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="base/static_sparse_graph.html">Static sparse graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="base/static_sparse_backend.html">Static sparse graph backend</a></li>
<li class="toctree-l1"><a class="reference internal" href="base/graph_backends.html">Backends for Sage (di)graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="base/boost_graph.html">Interface to run Boost algorithms</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="hypergraph_generators.html">Hypergraph generators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../combinat/designs/incidence_structures.html">Incidence structures (i.e. hypergraphs, i.e. set systems)</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="graph_coloring.html">Graph coloring</a></li>
<li class="toctree-l1"><a class="reference internal" href="cliquer.html">Interface with Cliquer (clique-related problems)</a></li>
<li class="toctree-l1"><a class="reference internal" href="centrality.html">Centrality</a></li>
<li class="toctree-l1"><a class="reference internal" href="asteroidal_triples.html">Asteroidal triples</a></li>
<li class="toctree-l1"><a class="reference internal" href="independent_sets.html">Independent sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="comparability.html">Comparability and permutation graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="line_graph.html">Line graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="spanning_tree.html">Spanning trees</a></li>
<li class="toctree-l1"><a class="reference internal" href="pq_trees.html">PQ-Trees</a></li>
<li class="toctree-l1"><a class="reference internal" href="trees.html">Generation of trees</a></li>
<li class="toctree-l1"><a class="reference internal" href="matchpoly.html">Matching polynomial</a></li>
<li class="toctree-l1"><a class="reference internal" href="genus.html">Genus</a></li>
<li class="toctree-l1"><a class="reference internal" href="lovasz_theta.html">Lovász theta-function of graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="schnyder.html">Schnyder’s algorithm for straight-line planar embeddings</a></li>
<li class="toctree-l1"><a class="reference internal" href="planarity.html">Wrapper for Boyer’s (C) planarity algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="traversals.html">Graph traversals</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_plot.html">Graph plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_plot_js.html">Graph plotting in Javascript with d3.js</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_decompositions/tree_decomposition.html">Tree decompositions</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_decompositions/vertex_separation.html">Vertex separation</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_decompositions/rankwidth.html">Rank Decompositions of graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_decompositions/bandwidth.html">Bandwidth of undirected graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_decompositions/cutwidth.html">Cutwidth</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_decompositions/graph_products.html">Products of graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_decompositions/modular_decomposition.html">Modular Decomposition</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_decompositions/clique_separators.html">Decomposition by clique minimal separators</a></li>
<li class="toctree-l1"><a class="reference internal" href="convexity_properties.html">Convexity properties of graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="weakly_chordal.html">Weakly chordal graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="distances_all_pairs.html">Distances/shortest paths between all pairs of vertices</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_latex.html">LaTeX options for graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_editor.html">Graph editor widget</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_list.html">Lists of graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_input.html">Functions for reading/building graphs/digraphs</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Hyperbolicity</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutte_polynomial.html">Tutte polynomial</a></li>
<li class="toctree-l1"><a class="reference internal" href="partial_cube.html">Partial cubes</a></li>
<li class="toctree-l1"><a class="reference internal" href="path_enumeration.html">Path enumeration</a></li>
<li class="toctree-l1"><a class="reference internal" href="generic_graph_pyx.html">GenericGraph Cython functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="orientations.html">Orientations</a></li>
<li class="toctree-l1"><a class="reference internal" href="connectivity.html">Connectivity related functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="edge_connectivity.html">Edge connectivity</a></li>
<li class="toctree-l1"><a class="reference internal" href="domination.html">Domination</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="hyperbolicity">
<span id="sage-graphs-hyperbolicity"></span><h1>Hyperbolicity<a class="headerlink" href="#hyperbolicity" title="Permalink to this heading">#</a></h1>
<span class="target" id="module-sage.graphs.hyperbolicity"></span><p><strong>Definition</strong> :</p>
<blockquote>
<div><p>The hyperbolicity <span class="math notranslate nohighlight">\(\delta\)</span> of a graph <span class="math notranslate nohighlight">\(G\)</span> has been defined by Gromov
<a class="reference internal" href="../../../references/index.html#gro1987" id="id1"><span>[Gro1987]</span></a> as follows (we give here the so-called 4-points condition):</p>
<blockquote>
<div><p>Let <span class="math notranslate nohighlight">\(a, b, c, d\)</span> be vertices of the graph, let <span class="math notranslate nohighlight">\(S_1\)</span>, <span class="math notranslate nohighlight">\(S_2\)</span> and <span class="math notranslate nohighlight">\(S_3\)</span> be
defined by</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}S_1 = dist(a, b) + dist(d, c)\\
S_2 = dist(a, c) + dist(b, d)\\
S_3 = dist(a, d) + dist(b, c)\\\end{split}\]</div>
</div>
<p>and let <span class="math notranslate nohighlight">\(M_1\)</span> and <span class="math notranslate nohighlight">\(M_2\)</span> be the two largest values among <span class="math notranslate nohighlight">\(S_1\)</span>, <span class="math notranslate nohighlight">\(S_2\)</span>, and
<span class="math notranslate nohighlight">\(S_3\)</span>. We define <span class="math notranslate nohighlight">\(hyp(a, b, c, d) = M_1 - M_2\)</span>, and the hyperbolicity
<span class="math notranslate nohighlight">\(\delta(G)\)</span> of the graph is the maximum of <span class="math notranslate nohighlight">\(hyp\)</span> over all possible
4-tuples <span class="math notranslate nohighlight">\((a, b, c, d)\)</span> divided by 2. That is, the graph is said
<span class="math notranslate nohighlight">\(\delta\)</span>-hyperbolic when</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\delta(G) = \frac{1}{2}\max_{a,b,c,d\in V(G)}hyp(a, b, c, d)\]</div>
</div>
<p>(note that <span class="math notranslate nohighlight">\(hyp(a, b, c, d)=0\)</span> whenever two elements among <span class="math notranslate nohighlight">\(a,b,c,d\)</span> are
equal)</p>
</div></blockquote>
</div></blockquote>
<p><strong>Some known results</strong> :</p>
<blockquote>
<div><ul class="simple">
<li><p>Trees and cliques are <span class="math notranslate nohighlight">\(0\)</span>-hyperbolic</p></li>
<li><p><span class="math notranslate nohighlight">\(n\times n\)</span> grids are <span class="math notranslate nohighlight">\(n-1\)</span>-hyperbolic</p></li>
<li><p>Cycles are approximately <span class="math notranslate nohighlight">\(n/4\)</span>-hyperbolic</p></li>
<li><p>Chordal graphs are <span class="math notranslate nohighlight">\(\leq 1\)</span>-hyperbolic</p></li>
</ul>
<p>Besides, the hyperbolicity of a graph is the maximum over all its
biconnected components.</p>
</div></blockquote>
<p><strong>Algorithms and complexity</strong> :</p>
<blockquote>
<div><p>The time complexity of the naive implementation (i.e. testing all 4-tuples)
is <span class="math notranslate nohighlight">\(O( n^4 )\)</span>, and an algorithm with time complexity <span class="math notranslate nohighlight">\(O(n^{3.69})\)</span> has been
proposed in <a class="reference internal" href="../../../references/index.html#fiv2012" id="id2"><span>[FIV2012]</span></a>.  This remains very long for large-scale graphs, and
much harder to implement.</p>
<p>Several improvements over the naive algorithm have been proposed and are
implemented in the current module.</p>
<ul>
<li><p>Another upper bound on <span class="math notranslate nohighlight">\(hyp(a, b, c, d)\)</span> has been proved in <a class="reference internal" href="../../../references/index.html#ccl2015" id="id3"><span>[CCL2015]</span></a>. It
is used to design an algorithm with worse case time complexity in
<span class="math notranslate nohighlight">\(O(n^4)\)</span> but that behaves much better in practice.</p>
<p>Assume that <span class="math notranslate nohighlight">\(S_1 = dist(a, b) + dist(c, d)\)</span> is the largest sum among
<span class="math notranslate nohighlight">\(S_1,S_2,S_3\)</span>. We have</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}S_2 + S_3 =&amp; dist(a, c) + dist(b, d) + dist(a, d) + dist(b, c)\\
=&amp; [ dist(a, c) + dist(b, c) ] + [ dist(a, d) + dist(b, d)]\\
\geq &amp;dist(a,b) + dist(a,b)\\
\geq &amp;2dist(a,b)\\\end{split}\]</div>
</div>
<p>Now, since <span class="math notranslate nohighlight">\(S_1\)</span> is the largest sum, we have</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}hyp(a, b, c, d) =&amp; S_1 - \max\{S_2, S_3\}\\
\leq&amp; S_1 - \frac{S_2+ S_3}{2}\\
\leq&amp; S_1 - dist(a, b)\\
=&amp; dist(c, d)\\\end{split}\]</div>
</div>
<p>We obtain similarly that <span class="math notranslate nohighlight">\(hyp(a, b, c, d) \leq dist(a, b)\)</span>. Consequently,
in the implementation of the ‘CCL’ algorithm, we ensure that <span class="math notranslate nohighlight">\(S_1\)</span> is
larger than <span class="math notranslate nohighlight">\(S_2\)</span> and <span class="math notranslate nohighlight">\(S_3\)</span> using an ordering of the pairs by decreasing
lengths. Then, we use the best value <span class="math notranslate nohighlight">\(h\)</span> found so far to stop exploration
as soon as <span class="math notranslate nohighlight">\(dist(a, b) \leq h\)</span>.</p>
<p>The worst case time complexity of this algorithm is <span class="math notranslate nohighlight">\(O(n^4)\)</span>, but it
performs very well in practice since it cuts the search space. This
algorithm can be turned into an approximation algorithm since at any step
of its execution we maintain an upper and a lower bound. We can thus stop
execution as soon as a multiplicative approximation factor or an additive
one is proven.</p>
</li>
<li><p>The notion of ‘’far-apart pairs’’ has been introduced in <a class="reference internal" href="../../../references/index.html#sot2011" id="id4"><span>[Sot2011]</span></a> to
further reduce the number of 4-tuples to consider. We say that the pair
<span class="math notranslate nohighlight">\((a,b)\)</span> is far-apart if for every <span class="math notranslate nohighlight">\(w\)</span> in <span class="math notranslate nohighlight">\(V\setminus\{a,b\}\)</span> we have</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[dist(w,a)+dist(a,b) &gt; dist(w,b) \text{ and }dist(w,b)+dist(a,b) &gt; dist(w,a)\]</div>
</div>
<p>Determining the set of far-apart pairs can be done in time <span class="math notranslate nohighlight">\(O(nm)\)</span> using
BFS. Now, it is proved in <a class="reference internal" href="../../../references/index.html#sot2011" id="id5"><span>[Sot2011]</span></a> that there exists two far-apart pairs
<span class="math notranslate nohighlight">\((a,b)\)</span> and <span class="math notranslate nohighlight">\((c,d)\)</span> satisfying <span class="math notranslate nohighlight">\(\delta(G) = hyp(a, b, c, d)/2\)</span>. For
instance, the <span class="math notranslate nohighlight">\(n\times m\)</span>-grid has only two far-apart pairs, and so
computing its hyperbolicity is immediate once the far-apart pairs are
found. The ‘CCL+FA’ or ‘CCL+’ algorithm improves the ‘CCL’ algorithm
since it uses far-apart pairs.</p>
</li>
<li><p>This algorithm was further improved in <a class="reference internal" href="../../../references/index.html#bccm2015" id="id6"><span>[BCCM2015]</span></a>: instead of iterating
twice over all pairs of vertices, in the “inner” loop, we cut several
pairs by exploiting properties of the underlying graph.</p></li>
</ul>
</div></blockquote>
<div class="admonition-todo admonition" id="id7">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Add exact methods for the hyperbolicity of chordal graphs</p></li>
<li><p>Add method for partitioning the graph with clique separators</p></li>
</ul>
</div>
<p><strong>This module contains the following functions</strong></p>
<p>At Python level :</p>
<div class="table-wrapper colwidths-given contentstable docutils container">
<table class="contentstable docutils align-default">
<colgroup>
<col style="width: 30.0%" />
<col style="width: 70.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#sage.graphs.hyperbolicity.hyperbolicity" title="sage.graphs.hyperbolicity.hyperbolicity"><code class="xref py py-meth docutils literal notranslate"><span class="pre">hyperbolicity()</span></code></a></p></td>
<td><p>Return the hyperbolicity of the graph or an approximation of this value.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sage.graphs.hyperbolicity.hyperbolicity_distribution" title="sage.graphs.hyperbolicity.hyperbolicity_distribution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">hyperbolicity_distribution()</span></code></a></p></td>
<td><p>Return the hyperbolicity distribution of the graph or a sampling of it.</p></td>
</tr>
</tbody>
</table>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>David Coudert (2012): initial version, exact and approximate algorithm,
distribution, sampling</p></li>
<li><p>David Coudert (2014): improved exact algorithm using far-apart pairs</p></li>
<li><p>Michele Borassi (2015): cleaned the code and implemented the new algorithm</p></li>
<li><p>Karan Desai (2016): fixed  minor typo in documentation</p></li>
</ul>
<section id="methods">
<h2>Methods<a class="headerlink" href="#methods" title="Permalink to this heading">#</a></h2>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="sage.graphs.hyperbolicity.hyperbolicity">
<span class="sig-prename descclassname"><span class="pre">sage.graphs.hyperbolicity.</span></span><span class="sig-name descname"><span class="pre">hyperbolicity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BCCM'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approximation_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">additive_gap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.hyperbolicity.hyperbolicity" title="Permalink to this definition">#</a></dt>
<dd><p>Return the hyperbolicity of the graph or an approximation of this value.</p>
<p>The hyperbolicity of a graph has been defined by Gromov <a class="reference internal" href="../../../references/index.html#gro1987" id="id8"><span>[Gro1987]</span></a> as
follows: Let <span class="math notranslate nohighlight">\(a, b, c, d\)</span> be vertices of the graph, let <span class="math notranslate nohighlight">\(S_1 = dist(a, b) +
dist(b, c)\)</span>, <span class="math notranslate nohighlight">\(S_2 = dist(a, c) + dist(b, d)\)</span>, and <span class="math notranslate nohighlight">\(S_3 = dist(a, d) +
dist(b, c)\)</span>, and let <span class="math notranslate nohighlight">\(M_1\)</span> and <span class="math notranslate nohighlight">\(M_2\)</span> be the two largest values among <span class="math notranslate nohighlight">\(S_1\)</span>,
<span class="math notranslate nohighlight">\(S_2\)</span>, and <span class="math notranslate nohighlight">\(S_3\)</span>. We have <span class="math notranslate nohighlight">\(hyp(a, b, c, d) = |M_1 - M_2|\)</span>, and the
hyperbolicity of the graph is the maximum over all possible 4-tuples <span class="math notranslate nohighlight">\((a,b,
c,d)\)</span> divided by 2. The worst case time complexity is in <span class="math notranslate nohighlight">\(O( n^4 )\)</span>.</p>
<p>See the documentation of <a class="reference internal" href="#module-sage.graphs.hyperbolicity" title="sage.graphs.hyperbolicity"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.graphs.hyperbolicity</span></code></a> for more
information.</p>
<p>INPUT:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">G</span></code> – a connected Graph</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">'BCCM'</span></code>); specifies the algorithm to use
among:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'basic'</span></code> is an exhaustive algorithm considering all possible
4-tuples and so have time complexity in <span class="math notranslate nohighlight">\(O(n^4)\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'CCL'</span></code> is an exact algorithm proposed in <a class="reference internal" href="../../../references/index.html#ccl2015" id="id9"><span>[CCL2015]</span></a>. It considers
the 4-tuples in an ordering allowing to cut the search space as soon
as a new lower bound is found (see the module’s documentation). This
algorithm can be turned into a approximation algorithm.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'CCL+FA'</span></code> or <code class="docutils literal notranslate"><span class="pre">'CCL+'</span></code> uses the notion of far-apart pairs as
proposed in <a class="reference internal" href="../../../references/index.html#sot2011" id="id10"><span>[Sot2011]</span></a> to significantly reduce the overall
computation time of the <code class="docutils literal notranslate"><span class="pre">'CCL'</span></code> algorithm.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'BCCM'</span></code> is an exact algorithm proposed in <a class="reference internal" href="../../../references/index.html#bccm2015" id="id11"><span>[BCCM2015]</span></a>. It
improves <code class="docutils literal notranslate"><span class="pre">'CCL+FA'</span></code> by cutting several 4-tuples (for more
information, see the module’s documentation).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'dom'</span></code> is an approximation with additive constant four. It
computes the hyperbolicity of the vertices of a dominating set of
the graph. This is sometimes slower than <code class="docutils literal notranslate"><span class="pre">'CCL'</span></code> and sometimes
faster. Try it to know if it is interesting for you.
The <code class="docutils literal notranslate"><span class="pre">additive_gap</span></code> and <code class="docutils literal notranslate"><span class="pre">approximation_factor</span></code> parameters cannot
be used in combination with this method and so are ignored.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">approximation_factor</span></code> – (default: None) When the approximation factor
is set to some value (larger than 1.0), the function stop computations as
soon as the ratio between the upper bound and the best found solution is
less than the approximation factor. When the approximation factor is 1.0,
the problem is solved optimally. This parameter is used only when the
chosen algorithm is <code class="docutils literal notranslate"><span class="pre">'CCL'</span></code>, <code class="docutils literal notranslate"><span class="pre">'CCL+FA'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'BCCM'</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">additive_gap</span></code> – (default: None) When sets to a positive number, the
function stop computations as soon as the difference between the upper
bound and the best found solution is less than additive gap. When the gap
is 0.0, the problem is solved optimally. This parameter is used only when
the chosen algorithm is <code class="docutils literal notranslate"><span class="pre">'CCL'</span></code> or <code class="docutils literal notranslate"><span class="pre">'CCL+FA'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'BCCM'</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) is a boolean set to True to display
some information during execution: new upper and lower bounds, etc.</p></li>
</ul>
<p>OUTPUT:</p>
<p>This function returns the tuple ( delta, certificate, delta_UB ), where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">delta</span></code> – the hyperbolicity of the graph (half-integer value).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">certificate</span></code> – is the list of the 4 vertices for which the maximum
value has been computed, and so the hyperbolicity of the graph.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">delta_UB</span></code> – is an upper bound for <code class="docutils literal notranslate"><span class="pre">delta</span></code>. When <code class="docutils literal notranslate"><span class="pre">delta</span> <span class="pre">==</span>
<span class="pre">delta_UB</span></code>, the returned solution is optimal. Otherwise, the approximation
factor if <code class="docutils literal notranslate"><span class="pre">delta_UB/delta</span></code>.</p></li>
</ul>
<p>EXAMPLES:</p>
<p>Hyperbolicity of a <span class="math notranslate nohighlight">\(3\times 3\)</span> grid:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.hyperbolicity</span> <span class="kn">import</span> <span class="n">hyperbolicity</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">Grid2dGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">U</span> <span class="o">=</span> <span class="n">hyperbolicity</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;BCCM&#39;</span><span class="p">);</span> <span class="n">L</span><span class="p">,</span><span class="nb">sorted</span><span class="p">(</span><span class="n">C</span><span class="p">),</span><span class="n">U</span>
<span class="go">(2, [(0, 0), (0, 2), (2, 0), (2, 2)], 2)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">U</span> <span class="o">=</span> <span class="n">hyperbolicity</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;CCL&#39;</span><span class="p">);</span> <span class="n">L</span><span class="p">,</span><span class="nb">sorted</span><span class="p">(</span><span class="n">C</span><span class="p">),</span><span class="n">U</span>
<span class="go">(2, [(0, 0), (0, 2), (2, 0), (2, 2)], 2)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">U</span> <span class="o">=</span> <span class="n">hyperbolicity</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;basic&#39;</span><span class="p">);</span> <span class="n">L</span><span class="p">,</span><span class="nb">sorted</span><span class="p">(</span><span class="n">C</span><span class="p">),</span><span class="n">U</span>
<span class="go">(2, [(0, 0), (0, 2), (2, 0), (2, 2)], 2)</span>
</pre></div>
</div>
<p>Hyperbolicity of a PetersenGraph:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.hyperbolicity</span> <span class="kn">import</span> <span class="n">hyperbolicity</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">U</span> <span class="o">=</span> <span class="n">hyperbolicity</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;BCCM&#39;</span><span class="p">);</span> <span class="n">L</span><span class="p">,</span><span class="nb">sorted</span><span class="p">(</span><span class="n">C</span><span class="p">),</span><span class="n">U</span>
<span class="go">(1/2, [6, 7, 8, 9], 1/2)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">U</span> <span class="o">=</span> <span class="n">hyperbolicity</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;CCL&#39;</span><span class="p">);</span> <span class="n">L</span><span class="p">,</span><span class="nb">sorted</span><span class="p">(</span><span class="n">C</span><span class="p">),</span><span class="n">U</span>
<span class="go">(1/2, [0, 1, 2, 3], 1/2)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">U</span> <span class="o">=</span> <span class="n">hyperbolicity</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;CCL+&#39;</span><span class="p">);</span> <span class="n">L</span><span class="p">,</span><span class="nb">sorted</span><span class="p">(</span><span class="n">C</span><span class="p">),</span><span class="n">U</span>
<span class="go">(1/2, [0, 1, 2, 3], 1/2)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">U</span> <span class="o">=</span> <span class="n">hyperbolicity</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;CCL+FA&#39;</span><span class="p">);</span> <span class="n">L</span><span class="p">,</span><span class="nb">sorted</span><span class="p">(</span><span class="n">C</span><span class="p">),</span><span class="n">U</span>
<span class="go">(1/2, [0, 1, 2, 3], 1/2)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">U</span> <span class="o">=</span> <span class="n">hyperbolicity</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;basic&#39;</span><span class="p">);</span> <span class="n">L</span><span class="p">,</span><span class="nb">sorted</span><span class="p">(</span><span class="n">C</span><span class="p">),</span><span class="n">U</span>
<span class="go">(1/2, [0, 1, 2, 3], 1/2)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">U</span> <span class="o">=</span> <span class="n">hyperbolicity</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;dom&#39;</span><span class="p">);</span> <span class="n">L</span><span class="p">,</span><span class="n">U</span>
<span class="go">(0, 1)</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>  <span class="c1"># random</span>
<span class="go">[0, 1, 2, 6]</span>
</pre></div>
</div>
<p>Asking for an approximation in a grid graph:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.hyperbolicity</span> <span class="kn">import</span> <span class="n">hyperbolicity</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">Grid2dGraph</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">U</span> <span class="o">=</span> <span class="n">hyperbolicity</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;CCL&#39;</span><span class="p">,</span> <span class="n">approximation_factor</span><span class="o">=</span><span class="mf">1.5</span><span class="p">);</span> <span class="n">L</span><span class="p">,</span><span class="n">U</span>
<span class="go">(1, 3/2)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">U</span> <span class="o">=</span> <span class="n">hyperbolicity</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;CCL+&#39;</span><span class="p">,</span> <span class="n">approximation_factor</span><span class="o">=</span><span class="mf">1.5</span><span class="p">);</span> <span class="n">L</span><span class="p">,</span><span class="n">U</span>
<span class="go">(1, 1)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">U</span> <span class="o">=</span> <span class="n">hyperbolicity</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;CCL&#39;</span><span class="p">,</span> <span class="n">approximation_factor</span><span class="o">=</span><span class="mi">4</span><span class="p">);</span> <span class="n">L</span><span class="p">,</span><span class="n">U</span>
<span class="go">(1, 4)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">U</span> <span class="o">=</span> <span class="n">hyperbolicity</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;CCL&#39;</span><span class="p">,</span> <span class="n">additive_gap</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span> <span class="n">L</span><span class="p">,</span><span class="n">U</span>
<span class="go">(1, 3)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">U</span> <span class="o">=</span> <span class="n">hyperbolicity</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;dom&#39;</span><span class="p">);</span> <span class="n">L</span><span class="p">,</span><span class="n">U</span>
<span class="go">(1, 5)</span>
</pre></div>
</div>
<p>Asking for an approximation in a cycle graph:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.hyperbolicity</span> <span class="kn">import</span> <span class="n">hyperbolicity</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">U</span> <span class="o">=</span> <span class="n">hyperbolicity</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;CCL&#39;</span><span class="p">,</span> <span class="n">approximation_factor</span><span class="o">=</span><span class="mf">1.5</span><span class="p">);</span> <span class="n">L</span><span class="p">,</span><span class="n">U</span>
<span class="go">(2, 5/2)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">U</span> <span class="o">=</span> <span class="n">hyperbolicity</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;CCL+FA&#39;</span><span class="p">,</span> <span class="n">approximation_factor</span><span class="o">=</span><span class="mf">1.5</span><span class="p">);</span> <span class="n">L</span><span class="p">,</span><span class="n">U</span>
<span class="go">(2, 5/2)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">U</span> <span class="o">=</span> <span class="n">hyperbolicity</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;CCL+FA&#39;</span><span class="p">,</span> <span class="n">additive_gap</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span> <span class="n">L</span><span class="p">,</span><span class="n">U</span>
<span class="go">(2, 5/2)</span>
</pre></div>
</div>
<p>Comparison of results:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.hyperbolicity</span> <span class="kn">import</span> <span class="n">hyperbolicity</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>               <span class="c1"># long time                             # needs networkx</span>
<span class="gp">....: </span>    <span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomBarabasiAlbert</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="n">d1</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">hyperbolicity</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;basic&#39;</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="n">d2</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">hyperbolicity</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;CCL&#39;</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="n">d3</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">hyperbolicity</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;CCL+&#39;</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="n">d4</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">hyperbolicity</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;CCL+FA&#39;</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="n">d5</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">hyperbolicity</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;BCCM&#39;</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="n">l3</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">u3</span> <span class="o">=</span> <span class="n">hyperbolicity</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">approximation_factor</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">d1</span><span class="o">==</span><span class="n">d2</span><span class="o">==</span><span class="n">d3</span><span class="o">==</span><span class="n">d4</span><span class="o">==</span><span class="n">d5</span><span class="p">)</span> <span class="ow">or</span> <span class="n">l3</span><span class="o">&gt;</span><span class="n">d1</span> <span class="ow">or</span> <span class="n">u3</span><span class="o">&lt;</span><span class="n">d1</span><span class="p">:</span>
<span class="gp">....: </span>       <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;That&#39;s not good!&quot;</span><span class="p">)</span>

<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.hyperbolicity</span> <span class="kn">import</span> <span class="n">hyperbolicity</span>
<span class="gp">sage: </span><span class="kn">import</span> <span class="nn">random</span>
<span class="gp">sage: </span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>               <span class="c1"># long time                             # needs networkx</span>
<span class="gp">....: </span>    <span class="n">n</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="n">m</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomGNM</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">connected_components_subgraphs</span><span class="p">():</span>
<span class="gp">....: </span>        <span class="n">d1</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">hyperbolicity</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;basic&#39;</span><span class="p">)</span>
<span class="gp">....: </span>        <span class="n">d2</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">hyperbolicity</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;CCL&#39;</span><span class="p">)</span>
<span class="gp">....: </span>        <span class="n">d3</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">hyperbolicity</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;CCL+&#39;</span><span class="p">)</span>
<span class="gp">....: </span>        <span class="n">d4</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">hyperbolicity</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;CCL+FA&#39;</span><span class="p">)</span>
<span class="gp">....: </span>        <span class="n">d5</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">hyperbolicity</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;BCCM&#39;</span><span class="p">)</span>
<span class="gp">....: </span>        <span class="n">l3</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">u3</span> <span class="o">=</span> <span class="n">hyperbolicity</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span> <span class="n">approximation_factor</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">....: </span>        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">d1</span><span class="o">==</span><span class="n">d2</span><span class="o">==</span><span class="n">d3</span><span class="o">==</span><span class="n">d4</span><span class="o">==</span><span class="n">d5</span><span class="p">)</span> <span class="ow">or</span> <span class="n">l3</span><span class="o">&gt;</span><span class="n">d1</span> <span class="ow">or</span> <span class="n">u3</span><span class="o">&lt;</span><span class="n">d1</span><span class="p">:</span>
<span class="gp">....: </span>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error in graph &quot;</span><span class="p">,</span> <span class="n">cc</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
<p>The hyperbolicity of a graph is the maximum value over all its biconnected
components:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.hyperbolicity</span> <span class="kn">import</span> <span class="n">hyperbolicity</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span> <span class="o">*</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">U</span> <span class="o">=</span> <span class="n">hyperbolicity</span><span class="p">(</span><span class="n">G</span><span class="p">);</span> <span class="n">L</span><span class="p">,</span><span class="nb">sorted</span><span class="p">(</span><span class="n">C</span><span class="p">),</span><span class="n">U</span>
<span class="go">(1/2, [6, 7, 8, 9], 1/2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.graphs.hyperbolicity.hyperbolicity_distribution">
<span class="sig-prename descclassname"><span class="pre">sage.graphs.hyperbolicity.</span></span><span class="sig-name descname"><span class="pre">hyperbolicity_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sampling'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.hyperbolicity.hyperbolicity_distribution" title="Permalink to this definition">#</a></dt>
<dd><p>Return the hyperbolicity distribution of the graph or a sampling of it.</p>
<p>The hyperbolicity of a graph has been defined by Gromov <a class="reference internal" href="../../../references/index.html#gro1987" id="id12"><span>[Gro1987]</span></a> as
follows: Let <span class="math notranslate nohighlight">\(a, b, c, d\)</span> be vertices of the graph, let <span class="math notranslate nohighlight">\(S_1 = dist(a, b) +
dist(b, c)\)</span>, <span class="math notranslate nohighlight">\(S_2 = dist(a, c) + dist(b, d)\)</span>, and <span class="math notranslate nohighlight">\(S_3 = dist(a, d) +
dist(b, c)\)</span>, and let <span class="math notranslate nohighlight">\(M_1\)</span> and <span class="math notranslate nohighlight">\(M_2\)</span> be the two largest values among <span class="math notranslate nohighlight">\(S_1\)</span>,
<span class="math notranslate nohighlight">\(S_2\)</span>, and <span class="math notranslate nohighlight">\(S_3\)</span>. We have <span class="math notranslate nohighlight">\(hyp(a, b, c, d) = |M_1 - M_2|\)</span>, and the
hyperbolicity of the graph is the maximum over all possible 4-tuples <span class="math notranslate nohighlight">\((a, b,
c, d)\)</span> divided by 2.</p>
<p>The computation of the hyperbolicity of each 4-tuple, and so the
hyperbolicity distribution, takes time in <span class="math notranslate nohighlight">\(O( n^4 )\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">G</span></code> – a Graph.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – (default: ‘sampling’) When algorithm is ‘sampling’, it
returns the distribution of the hyperbolicity over a sample of
<code class="docutils literal notranslate"><span class="pre">sampling_size</span></code> 4-tuples. When algorithm is ‘exact’, it computes the
distribution of the hyperbolicity over all 4-tuples. Be aware that the
computation time can be HUGE.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sampling_size</span></code> – (default: <span class="math notranslate nohighlight">\(10^6\)</span>) number of 4-tuples considered in
the sampling. Used only when <code class="docutils literal notranslate"><span class="pre">algorithm</span> <span class="pre">==</span> <span class="pre">'sampling'</span></code>.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">hdict</span></code> – A dictionary such that hdict[i] is the number of 4-tuples of
hyperbolicity i.</p></li>
</ul>
<p>EXAMPLES:</p>
<p>Exact hyperbolicity distribution of the Petersen Graph:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.hyperbolicity</span> <span class="kn">import</span> <span class="n">hyperbolicity_distribution</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">hyperbolicity_distribution</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;exact&#39;</span><span class="p">)</span>
<span class="go">{0: 3/7, 1/2: 4/7}</span>
</pre></div>
</div>
<p>Exact hyperbolicity distribution of a <span class="math notranslate nohighlight">\(3\times 3\)</span> grid:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.hyperbolicity</span> <span class="kn">import</span> <span class="n">hyperbolicity_distribution</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">GridGraph</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">hyperbolicity_distribution</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;exact&#39;</span><span class="p">)</span>
<span class="go">{0: 11/18, 1: 8/21, 2: 1/126}</span>
</pre></div>
</div>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="tutte_polynomial.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Tutte polynomial</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="graph_input.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Functions for reading/building graphs/digraphs</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2023, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Hyperbolicity</a><ul>
<li><a class="reference internal" href="#methods">Methods</a></li>
<li><a class="reference internal" href="#sage.graphs.hyperbolicity.hyperbolicity"><code class="docutils literal notranslate"><span class="pre">hyperbolicity()</span></code></a></li>
<li><a class="reference internal" href="#sage.graphs.hyperbolicity.hyperbolicity_distribution"><code class="docutils literal notranslate"><span class="pre">hyperbolicity_distribution()</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/scripts/furo.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "lcm": "\\mathop{\\operatorname{lcm}}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <script src="../../../_static/jupyter-sphinx-furo.js"></script>
    </body>
</html>