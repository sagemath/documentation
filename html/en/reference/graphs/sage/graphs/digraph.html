<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Directed graphs &mdash; Sage Reference Manual v7.0: Graph Theory</title>
    
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '7.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v7.0: Graph Theory" href="../../index.html" />
    <link rel="next" title="Bipartite graphs" href="bipartite_graph.html" />
    <link rel="prev" title="Undirected graphs" href="graph.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="bipartite_graph.html" title="Bipartite graphs"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="graph.html" title="Undirected graphs"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../index.html">Graph Theory</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="directed-graphs">
<span id="sage-graphs-digraph"></span><h1>Directed graphs<a class="headerlink" href="#directed-graphs" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.graphs.digraph"></span><p>This module implements functions and operations involving directed
graphs. Here is what they can do</p>
<p><strong>Graph basic operations:</strong></p>
<table border="1" class="contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.layout_acyclic_dummy" title="sage.graphs.digraph.DiGraph.layout_acyclic_dummy"><tt class="xref py py-meth docutils literal"><span class="pre">layout_acyclic_dummy()</span></tt></a></td>
<td>Computes a (dummy) ranked layout so that all edges point upward.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.layout_acyclic" title="sage.graphs.digraph.DiGraph.layout_acyclic"><tt class="xref py py-meth docutils literal"><span class="pre">layout_acyclic()</span></tt></a></td>
<td>Computes a ranked layout so that all edges point upward.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.reverse" title="sage.graphs.digraph.DiGraph.reverse"><tt class="xref py py-meth docutils literal"><span class="pre">reverse()</span></tt></a></td>
<td>Returns a copy of digraph with edges reversed in direction.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.reverse_edge" title="sage.graphs.digraph.DiGraph.reverse_edge"><tt class="xref py py-meth docutils literal"><span class="pre">reverse_edge()</span></tt></a></td>
<td>Reverses an edge.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.reverse_edges" title="sage.graphs.digraph.DiGraph.reverse_edges"><tt class="xref py py-meth docutils literal"><span class="pre">reverse_edges()</span></tt></a></td>
<td>Reverses a list of edges.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.out_degree_sequence" title="sage.graphs.digraph.DiGraph.out_degree_sequence"><tt class="xref py py-meth docutils literal"><span class="pre">out_degree_sequence()</span></tt></a></td>
<td>Return the outdegree sequence.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.out_degree_iterator" title="sage.graphs.digraph.DiGraph.out_degree_iterator"><tt class="xref py py-meth docutils literal"><span class="pre">out_degree_iterator()</span></tt></a></td>
<td>Same as degree_iterator, but for out degree.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.out_degree" title="sage.graphs.digraph.DiGraph.out_degree"><tt class="xref py py-meth docutils literal"><span class="pre">out_degree()</span></tt></a></td>
<td>Same as degree, but for out degree.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.in_degree_sequence" title="sage.graphs.digraph.DiGraph.in_degree_sequence"><tt class="xref py py-meth docutils literal"><span class="pre">in_degree_sequence()</span></tt></a></td>
<td>Return the indegree sequence of this digraph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.in_degree_iterator" title="sage.graphs.digraph.DiGraph.in_degree_iterator"><tt class="xref py py-meth docutils literal"><span class="pre">in_degree_iterator()</span></tt></a></td>
<td>Same as degree_iterator, but for in degree.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.in_degree" title="sage.graphs.digraph.DiGraph.in_degree"><tt class="xref py py-meth docutils literal"><span class="pre">in_degree()</span></tt></a></td>
<td>Same as degree, but for in-degree.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.neighbors_out" title="sage.graphs.digraph.DiGraph.neighbors_out"><tt class="xref py py-meth docutils literal"><span class="pre">neighbors_out()</span></tt></a></td>
<td>Returns the list of the out-neighbors of a given vertex.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.neighbor_out_iterator" title="sage.graphs.digraph.DiGraph.neighbor_out_iterator"><tt class="xref py py-meth docutils literal"><span class="pre">neighbor_out_iterator()</span></tt></a></td>
<td>Returns an iterator over the out-neighbors of a given vertex.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.neighbors_in" title="sage.graphs.digraph.DiGraph.neighbors_in"><tt class="xref py py-meth docutils literal"><span class="pre">neighbors_in()</span></tt></a></td>
<td>Returns the list of the in-neighbors of a given vertex.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.neighbor_in_iterator" title="sage.graphs.digraph.DiGraph.neighbor_in_iterator"><tt class="xref py py-meth docutils literal"><span class="pre">neighbor_in_iterator()</span></tt></a></td>
<td>Returns an iterator over the in-neighbors of vertex.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.outgoing_edges" title="sage.graphs.digraph.DiGraph.outgoing_edges"><tt class="xref py py-meth docutils literal"><span class="pre">outgoing_edges()</span></tt></a></td>
<td>Returns a list of edges departing from vertices.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.outgoing_edge_iterator" title="sage.graphs.digraph.DiGraph.outgoing_edge_iterator"><tt class="xref py py-meth docutils literal"><span class="pre">outgoing_edge_iterator()</span></tt></a></td>
<td>Return an iterator over all departing edges from vertices</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.incoming_edges" title="sage.graphs.digraph.DiGraph.incoming_edges"><tt class="xref py py-meth docutils literal"><span class="pre">incoming_edges()</span></tt></a></td>
<td>Returns a list of edges arriving at vertices.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.incoming_edge_iterator" title="sage.graphs.digraph.DiGraph.incoming_edge_iterator"><tt class="xref py py-meth docutils literal"><span class="pre">incoming_edge_iterator()</span></tt></a></td>
<td>Return an iterator over all arriving edges from vertices</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.sources" title="sage.graphs.digraph.DiGraph.sources"><tt class="xref py py-meth docutils literal"><span class="pre">sources()</span></tt></a></td>
<td>Returns the list of all sources (vertices without incoming edges) of this digraph.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.sinks" title="sage.graphs.digraph.DiGraph.sinks"><tt class="xref py py-meth docutils literal"><span class="pre">sinks()</span></tt></a></td>
<td>Returns the list of all sinks (vertices without outgoing edges) of this digraph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.to_undirected" title="sage.graphs.digraph.DiGraph.to_undirected"><tt class="xref py py-meth docutils literal"><span class="pre">to_undirected()</span></tt></a></td>
<td>Returns an undirected version of the graph.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.to_directed" title="sage.graphs.digraph.DiGraph.to_directed"><tt class="xref py py-meth docutils literal"><span class="pre">to_directed()</span></tt></a></td>
<td>Since the graph is already directed, simply returns a copy of itself.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.is_directed" title="sage.graphs.digraph.DiGraph.is_directed"><tt class="xref py py-meth docutils literal"><span class="pre">is_directed()</span></tt></a></td>
<td>Since digraph is directed, returns True.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.dig6_string" title="sage.graphs.digraph.DiGraph.dig6_string"><tt class="xref py py-meth docutils literal"><span class="pre">dig6_string()</span></tt></a></td>
<td>Returns the dig6 representation of the digraph as an ASCII string.</td>
</tr>
</tbody>
</table>
<p><strong>Paths and cycles:</strong></p>
<table border="1" class="contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.all_paths_iterator" title="sage.graphs.digraph.DiGraph.all_paths_iterator"><tt class="xref py py-meth docutils literal"><span class="pre">all_paths_iterator()</span></tt></a></td>
<td>Returns an iterator over the paths of self. The paths are</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.all_simple_paths" title="sage.graphs.digraph.DiGraph.all_simple_paths"><tt class="xref py py-meth docutils literal"><span class="pre">all_simple_paths()</span></tt></a></td>
<td>Returns a list of all the simple paths of self starting</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.all_cycles_iterator" title="sage.graphs.digraph.DiGraph.all_cycles_iterator"><tt class="xref py py-meth docutils literal"><span class="pre">all_cycles_iterator()</span></tt></a></td>
<td>Returns an iterator over all the cycles of self starting</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.all_simple_cycles" title="sage.graphs.digraph.DiGraph.all_simple_cycles"><tt class="xref py py-meth docutils literal"><span class="pre">all_simple_cycles()</span></tt></a></td>
<td>Returns a list of all simple cycles of self.</td>
</tr>
</tbody>
</table>
<p><strong>Representation theory:</strong></p>
<table border="1" class="contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.path_semigroup" title="sage.graphs.digraph.DiGraph.path_semigroup"><tt class="xref py py-meth docutils literal"><span class="pre">path_semigroup()</span></tt></a></td>
<td>Returns the (partial) semigroup formed by the paths of the digraph.</td>
</tr>
</tbody>
</table>
<p><strong>Connectivity:</strong></p>
<table border="1" class="contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.is_strongly_connected" title="sage.graphs.digraph.DiGraph.is_strongly_connected"><tt class="xref py py-meth docutils literal"><span class="pre">is_strongly_connected()</span></tt></a></td>
<td>Returns whether the current <tt class="docutils literal"><span class="pre">DiGraph</span></tt> is strongly connected.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.strongly_connected_components_digraph" title="sage.graphs.digraph.DiGraph.strongly_connected_components_digraph"><tt class="xref py py-meth docutils literal"><span class="pre">strongly_connected_components_digraph()</span></tt></a></td>
<td>Returns the digraph of the strongly connected components</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.strongly_connected_components_subgraphs" title="sage.graphs.digraph.DiGraph.strongly_connected_components_subgraphs"><tt class="xref py py-meth docutils literal"><span class="pre">strongly_connected_components_subgraphs()</span></tt></a></td>
<td>Returns the strongly connected components as a list of subgraphs.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.strongly_connected_component_containing_vertex" title="sage.graphs.digraph.DiGraph.strongly_connected_component_containing_vertex"><tt class="xref py py-meth docutils literal"><span class="pre">strongly_connected_component_containing_vertex()</span></tt></a></td>
<td>Returns the strongly connected component containing a given vertex</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.strongly_connected_components" title="sage.graphs.digraph.DiGraph.strongly_connected_components"><tt class="xref py py-meth docutils literal"><span class="pre">strongly_connected_components()</span></tt></a></td>
<td>Returns the list of strongly connected components.</td>
</tr>
</tbody>
</table>
<p><strong>Acyclicity:</strong></p>
<table border="1" class="contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.is_directed_acyclic" title="sage.graphs.digraph.DiGraph.is_directed_acyclic"><tt class="xref py py-meth docutils literal"><span class="pre">is_directed_acyclic()</span></tt></a></td>
<td>Returns whether the digraph is acyclic or not.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.is_transitive" title="sage.graphs.digraph.DiGraph.is_transitive"><tt class="xref py py-meth docutils literal"><span class="pre">is_transitive()</span></tt></a></td>
<td>Returns whether the digraph is transitive or not.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.is_aperiodic" title="sage.graphs.digraph.DiGraph.is_aperiodic"><tt class="xref py py-meth docutils literal"><span class="pre">is_aperiodic()</span></tt></a></td>
<td>Returns whether the digraph is aperiodic or not.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.period" title="sage.graphs.digraph.DiGraph.period"><tt class="xref py py-meth docutils literal"><span class="pre">period()</span></tt></a></td>
<td>Returns the period of the digraph.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.level_sets" title="sage.graphs.digraph.DiGraph.level_sets"><tt class="xref py py-meth docutils literal"><span class="pre">level_sets()</span></tt></a></td>
<td>Returns the level set decomposition of the digraph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.topological_sort_generator" title="sage.graphs.digraph.DiGraph.topological_sort_generator"><tt class="xref py py-meth docutils literal"><span class="pre">topological_sort_generator()</span></tt></a></td>
<td>Returns a list of all topological sorts of the digraph if it is acyclic</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.topological_sort" title="sage.graphs.digraph.DiGraph.topological_sort"><tt class="xref py py-meth docutils literal"><span class="pre">topological_sort()</span></tt></a></td>
<td>Returns a topological sort of the digraph if it is acyclic</td>
</tr>
</tbody>
</table>
<p><strong>Hard stuff:</strong></p>
<table border="1" class="contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.feedback_edge_set" title="sage.graphs.digraph.DiGraph.feedback_edge_set"><tt class="xref py py-meth docutils literal"><span class="pre">feedback_edge_set()</span></tt></a></td>
<td>Computes the minimum feedback edge (arc) set of a digraph</td>
</tr>
</tbody>
</table>
<p><strong>Miscellanous:</strong></p>
<table border="1" class="contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.flow_polytope" title="sage.graphs.digraph.DiGraph.flow_polytope"><tt class="xref py py-meth docutils literal"><span class="pre">flow_polytope()</span></tt></a></td>
<td>Computes the flow polytope of a digraph</td>
</tr>
</tbody>
</table>
<div class="section" id="methods">
<h2>Methods<a class="headerlink" href="#methods" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="sage.graphs.digraph.DiGraph">
<em class="property">class </em><tt class="descclassname">sage.graphs.digraph.</tt><tt class="descname">DiGraph</tt><big>(</big><em>data=None</em>, <em>pos=None</em>, <em>loops=None</em>, <em>format=None</em>, <em>weighted=None</em>, <em>implementation='c_graph'</em>, <em>data_structure='sparse'</em>, <em>vertex_labels=True</em>, <em>name=None</em>, <em>multiedges=None</em>, <em>convert_empty_dict_labels_to_None=None</em>, <em>sparse=True</em>, <em>immutable=False</em><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph" title="sage.graphs.generic_graph.GenericGraph"><tt class="xref py py-class docutils literal"><span class="pre">sage.graphs.generic_graph.GenericGraph</span></tt></a></p>
<p>Directed graph.</p>
<p>A digraph or directed graph is a set of vertices connected by oriented
edges. See also the <a class="reference external" href="https://en.wikipedia.org/wiki/Directed_graph">Wikipedia article Directed_graph</a>. For a collection of
pre-defined digraphs, see the <a class="reference internal" href="digraph_generators.html#module-sage.graphs.digraph_generators" title="sage.graphs.digraph_generators"><tt class="xref py py-mod docutils literal"><span class="pre">digraph_generators</span></tt></a> module.</p>
<p>A <a class="reference internal" href="#sage.graphs.digraph.DiGraph" title="sage.graphs.digraph.DiGraph"><tt class="xref py py-class docutils literal"><span class="pre">DiGraph</span></tt></a> object has many methods whose list can be obtained by
typing <tt class="docutils literal"><span class="pre">g.&lt;tab&gt;</span></tt> (i.e. hit the &#8216;tab&#8217; key) or by reading the documentation
of <a class="reference internal" href="#module-sage.graphs.digraph" title="sage.graphs.digraph"><tt class="xref py py-mod docutils literal"><span class="pre">digraph</span></tt></a>, <a class="reference internal" href="generic_graph.html#module-sage.graphs.generic_graph" title="sage.graphs.generic_graph"><tt class="xref py py-mod docutils literal"><span class="pre">generic_graph</span></tt></a>, and
<a class="reference internal" href="graph.html#module-sage.graphs.graph" title="sage.graphs.graph"><tt class="xref py py-mod docutils literal"><span class="pre">graph</span></tt></a>.</p>
<p>INPUT:</p>
<p>By default, a <a class="reference internal" href="#sage.graphs.digraph.DiGraph" title="sage.graphs.digraph.DiGraph"><tt class="xref py py-class docutils literal"><span class="pre">DiGraph</span></tt></a> object is simple (i.e. no <em>loops</em> nor
<em>multiple edges</em>) and unweighted. This can be easily tuned with the
appropriate flags (see below).</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">data</span></tt> &#8211; can be any of the following (see the <tt class="docutils literal"><span class="pre">format</span></tt> argument):</li>
</ul>
<blockquote>
<div><ol class="arabic">
<li><p class="first"><tt class="docutils literal"><span class="pre">DiGraph()</span></tt> &#8211; build a digraph on 0 vertices.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">DiGraph(5)</span></tt> &#8211; return an edgeless digraph on the 5 vertices 0,...,4.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">DiGraph([list_of_vertices,list_of_edges])</span></tt> &#8211; returns a digraph with
given vertices/edges.</p>
<p>To bypass auto-detection, prefer the more explicit
<tt class="docutils literal"><span class="pre">DiGraph([V,E],format='vertices_and_edges')</span></tt>.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">DiGraph(list_of_edges)</span></tt> &#8211; return a digraph with a given list of
edges (see documentation of
<a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.add_edges" title="sage.graphs.generic_graph.GenericGraph.add_edges"><tt class="xref py py-meth docutils literal"><span class="pre">add_edges()</span></tt></a>).</p>
<p>To bypass auto-detection, prefer the more explicit <tt class="docutils literal"><span class="pre">DiGraph(L,</span>
<span class="pre">format='list_of_edges')</span></tt>.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">DiGraph({1:[2,3,4],3:[4]})</span></tt> &#8211; return a digraph by associating to
each vertex the list of its out-neighbors.</p>
<p>To bypass auto-detection, prefer the more explicit <tt class="docutils literal"><span class="pre">DiGraph(D,</span>
<span class="pre">format='dict_of_lists')</span></tt>.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">DiGraph({1:</span> <span class="pre">{2:</span> <span class="pre">'a',</span> <span class="pre">3:'b'}</span> <span class="pre">,3:{2:'c'}})</span></tt> &#8211; return a digraph by
associating a list of out-neighbors to each vertex and providing its
edge label.</p>
<p>To bypass auto-detection, prefer the more explicit <tt class="docutils literal"><span class="pre">DiGraph(D,</span>
<span class="pre">format='dict_of_dicts')</span></tt>.</p>
<p>For digraphs with multiple edges, you can provide a list of labels
instead, e.g.: <tt class="docutils literal"><span class="pre">DiGraph({1:</span> <span class="pre">{2:</span> <span class="pre">['a1',</span> <span class="pre">'a2'],</span> <span class="pre">3:['b']}</span>
<span class="pre">,3:{2:['c']}})</span></tt>.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">DiGraph(a_matrix)</span></tt> &#8211; return a digraph with given (weighted) adjacency
matrix (see documentation of
<a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.adjacency_matrix" title="sage.graphs.generic_graph.GenericGraph.adjacency_matrix"><tt class="xref py py-meth docutils literal"><span class="pre">adjacency_matrix()</span></tt></a>).</p>
<p>To bypass auto-detection, prefer the more explicit <tt class="docutils literal"><span class="pre">DiGraph(M,</span>
<span class="pre">format='adjacency_matrix')</span></tt>. To take weights into account, use
<tt class="docutils literal"><span class="pre">format='weighted_adjacency_matrix'</span></tt> instead.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">DiGraph(a_nonsquare_matrix)</span></tt> &#8211; return a digraph with given
incidence matrix (see documentation of
<a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.incidence_matrix" title="sage.graphs.generic_graph.GenericGraph.incidence_matrix"><tt class="xref py py-meth docutils literal"><span class="pre">incidence_matrix()</span></tt></a>).</p>
<p>To bypass auto-detection, prefer the more explicit <tt class="docutils literal"><span class="pre">DiGraph(M,</span>
<span class="pre">format='incidence_matrix')</span></tt>.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">DiGraph([V,</span> <span class="pre">f])</span></tt> &#8211; return a digraph with a vertex set <tt class="docutils literal"><span class="pre">V</span></tt> and an
edge <span class="math">\(u,v\)</span> whenever <tt class="docutils literal"><span class="pre">f(u,v)</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt>. Example: <tt class="docutils literal"><span class="pre">DiGraph([</span>
<span class="pre">[1..10],</span> <span class="pre">lambda</span> <span class="pre">x,y:</span> <span class="pre">abs(x-y).is_square()])</span></tt></p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">DiGraph('FOC&#64;?OC&#64;_?')</span></tt> &#8211; return a digraph from a dig6 string (see
documentation of <a class="reference internal" href="#sage.graphs.digraph.DiGraph.dig6_string" title="sage.graphs.digraph.DiGraph.dig6_string"><tt class="xref py py-meth docutils literal"><span class="pre">dig6_string()</span></tt></a>).</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">DiGraph(another_digraph)</span></tt> &#8211; return a digraph from a Sage (di)graph,
<a class="reference external" href="https://pygraphviz.github.io/">pygraphviz</a> digraph, <a class="reference external" href="https://networkx.github.io/">NetworkX</a> digraph, or <a class="reference external" href="http://igraph.org/python/">igraph</a> digraph.</p>
</li>
</ol>
</div></blockquote>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">pos</span></tt> - a positioning dictionary: for example, the
spring layout from NetworkX for the 5-cycle is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.91679746</span><span class="p">,</span> <span class="mf">0.88169588</span><span class="p">],</span>
 <span class="mi">1</span><span class="p">:</span> <span class="p">[</span> <span class="mf">0.47294849</span><span class="p">,</span> <span class="mf">1.125</span>     <span class="p">],</span>
 <span class="mi">2</span><span class="p">:</span> <span class="p">[</span> <span class="mf">1.125</span>     <span class="p">,</span><span class="o">-</span><span class="mf">0.12867615</span><span class="p">],</span>
 <span class="mi">3</span><span class="p">:</span> <span class="p">[</span> <span class="mf">0.12743933</span><span class="p">,</span><span class="o">-</span><span class="mf">1.125</span>     <span class="p">],</span>
 <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.125</span>     <span class="p">,</span><span class="o">-</span><span class="mf">0.50118505</span><span class="p">]}</span>
</pre></div>
</div>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">name</span></tt> - (must be an explicitly named parameter,
i.e., name=&#8221;complete&#8221;) gives the graph a name</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">loops</span></tt> - boolean, whether to allow loops (ignored
if data is an instance of the DiGraph class)</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">multiedges</span></tt> - boolean, whether to allow multiple
edges (ignored if data is an instance of the DiGraph class)</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">weighted</span></tt> - whether digraph thinks of itself as
weighted or not. See self.weighted()</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">format</span></tt> - if set to <tt class="docutils literal"><span class="pre">None</span></tt> (default), <a class="reference internal" href="#sage.graphs.digraph.DiGraph" title="sage.graphs.digraph.DiGraph"><tt class="xref py py-class docutils literal"><span class="pre">DiGraph</span></tt></a> tries to guess
input&#8217;s format. To avoid this possibly time-consuming step, one of the
following values can be specified (see description above): <tt class="docutils literal"><span class="pre">&quot;int&quot;</span></tt>,
<tt class="docutils literal"><span class="pre">&quot;dig6&quot;</span></tt>, <tt class="docutils literal"><span class="pre">&quot;rule&quot;</span></tt>, <tt class="docutils literal"><span class="pre">&quot;list_of_edges&quot;</span></tt>, <tt class="docutils literal"><span class="pre">&quot;dict_of_lists&quot;</span></tt>,
<tt class="docutils literal"><span class="pre">&quot;dict_of_dicts&quot;</span></tt>, <tt class="docutils literal"><span class="pre">&quot;adjacency_matrix&quot;</span></tt>,
<tt class="docutils literal"><span class="pre">&quot;weighted_adjacency_matrix&quot;</span></tt>, <tt class="docutils literal"><span class="pre">&quot;incidence_matrix&quot;</span></tt>, <tt class="docutils literal"><span class="pre">&quot;NX&quot;</span></tt>,
<tt class="docutils literal"><span class="pre">&quot;igraph&quot;</span></tt>.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">sparse</span></tt> (boolean) &#8211; <tt class="docutils literal"><span class="pre">sparse=True</span></tt> is an alias for
<tt class="docutils literal"><span class="pre">data_structure=&quot;sparse&quot;</span></tt>, and <tt class="docutils literal"><span class="pre">sparse=False</span></tt> is an alias for
<tt class="docutils literal"><span class="pre">data_structure=&quot;dense&quot;</span></tt>.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">data_structure</span></tt> &#8211; one of the following (for more information, see
<a class="reference internal" href="base/overview.html#module-sage.graphs.base.overview" title="sage.graphs.base.overview"><tt class="xref py py-mod docutils literal"><span class="pre">overview</span></tt></a>):</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">&quot;dense&quot;</span></tt> &#8211; selects the <a class="reference internal" href="base/dense_graph.html#module-sage.graphs.base.dense_graph" title="sage.graphs.base.dense_graph"><tt class="xref py py-mod docutils literal"><span class="pre">dense_graph</span></tt></a>
backend.</li>
<li><tt class="docutils literal"><span class="pre">&quot;sparse&quot;</span></tt> &#8211; selects the <a class="reference internal" href="base/sparse_graph.html#module-sage.graphs.base.sparse_graph" title="sage.graphs.base.sparse_graph"><tt class="xref py py-mod docutils literal"><span class="pre">sparse_graph</span></tt></a>
backend.</li>
<li><tt class="docutils literal"><span class="pre">&quot;static_sparse&quot;</span></tt> &#8211; selects the
<a class="reference internal" href="base/static_sparse_backend.html#module-sage.graphs.base.static_sparse_backend" title="sage.graphs.base.static_sparse_backend"><tt class="xref py py-mod docutils literal"><span class="pre">static_sparse_backend</span></tt></a> (this backend is faster
than the sparse backend and smaller in memory, and it is immutable, so
that the resulting graphs can be used as dictionary keys).</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">immutable</span></tt> (boolean) &#8211; whether to create a immutable digraph. Note
that <tt class="docutils literal"><span class="pre">immutable=True</span></tt> is actually a shortcut for
<tt class="docutils literal"><span class="pre">data_structure='static_sparse'</span></tt>.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">vertex_labels</span></tt> - Whether to allow any object as a vertex (slower), or
only the integers <span class="math">\(0,...,n-1\)</span>, where <span class="math">\(n\)</span> is the number of vertices.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">convert_empty_dict_labels_to_None</span></tt> - this arguments sets
the default edge labels used by NetworkX (empty dictionaries)
to be replaced by None, the default Sage edge label. It is
set to <tt class="docutils literal"><span class="pre">True</span></tt> iff a NetworkX graph is on the input.</p>
</li>
</ul>
<p>EXAMPLES:</p>
<ol class="arabic">
<li><p class="first">A dictionary of dictionaries:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="s">&#39;x&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="s">&#39;z&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="s">&#39;a&#39;</span><span class="p">},</span> <span class="mi">2</span><span class="p">:{</span><span class="mi">5</span><span class="p">:</span><span class="s">&#39;out&#39;</span><span class="p">}});</span> <span class="n">g</span>
<span class="go">Digraph on 5 vertices</span>
</pre></div>
</div>
<p>The labels (&#8216;x&#8217;, &#8216;z&#8217;, &#8216;a&#8217;, &#8216;out&#8217;) are labels for edges. For
example, &#8216;out&#8217; is the label for the edge from 2 to 5. Labels can be
used as weights, if all the labels share some common parent.</p>
</li>
<li><p class="first">A dictionary of lists (or iterables):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">4</span><span class="p">]});</span> <span class="n">g</span>
<span class="go">Digraph on 5 vertices</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">:(</span><span class="mi">4</span><span class="p">,)});</span> <span class="n">g</span>
<span class="go">Digraph on 5 vertices</span>
</pre></div>
</div>
</li>
<li><p class="first">A list of vertices and a function describing adjacencies. Note
that the list of vertices and the function must be enclosed in a
list (i.e., [list of vertices, function]).</p>
<p>We construct a graph on the integers 1 through 12 such that there
is a directed edge from i to j if and only if i divides j.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">=</span><span class="n">DiGraph</span><span class="p">([[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">12</span><span class="p">],</span><span class="k">lambda</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">:</span> <span class="n">i</span><span class="o">!=</span><span class="n">j</span> <span class="ow">and</span> <span class="n">i</span><span class="o">.</span><span class="n">divides</span><span class="p">(</span><span class="n">j</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">()</span>
<span class="go">[0 1 1 1 1 1 1 1 1 1 1 1]</span>
<span class="go">[0 0 0 1 0 1 0 1 0 1 0 1]</span>
<span class="go">[0 0 0 0 0 1 0 0 1 0 0 1]</span>
<span class="go">[0 0 0 0 0 0 0 1 0 0 0 1]</span>
<span class="go">[0 0 0 0 0 0 0 0 0 1 0 0]</span>
<span class="go">[0 0 0 0 0 0 0 0 0 0 0 1]</span>
<span class="go">[0 0 0 0 0 0 0 0 0 0 0 0]</span>
<span class="go">[0 0 0 0 0 0 0 0 0 0 0 0]</span>
<span class="go">[0 0 0 0 0 0 0 0 0 0 0 0]</span>
<span class="go">[0 0 0 0 0 0 0 0 0 0 0 0]</span>
<span class="go">[0 0 0 0 0 0 0 0 0 0 0 0]</span>
<span class="go">[0 0 0 0 0 0 0 0 0 0 0 0]</span>
</pre></div>
</div>
</li>
<li><p class="first">A Sage matrix: Note: If format is not specified, then Sage
assumes a square matrix is an adjacency matrix, and a nonsquare
matrix is an incidence matrix.</p>
<ul>
<li><p class="first">an adjacency matrix:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]);</span> <span class="n">M</span>
<span class="go">[0 1 1 1 0]</span>
<span class="go">[0 0 0 0 0]</span>
<span class="go">[0 0 0 0 1]</span>
<span class="go">[0 0 0 0 0]</span>
<span class="go">[0 0 0 0 0]</span>
<span class="gp">sage: </span><span class="n">DiGraph</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">Digraph on 5 vertices</span>

<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]]);</span> <span class="n">M</span>
<span class="go">[   0    1   -1]</span>
<span class="go">[  -1    0 -1/2]</span>
<span class="go">[   1  1/2    0]</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">weighted</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Digraph on 3 vertices</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">weighted</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</li>
<li><p class="first">an incidence matrix:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span> <span class="n">M</span>
<span class="go">[-1  0  0  0  1]</span>
<span class="go">[ 1 -1  0  0  0]</span>
<span class="go">[ 0  1 -1  0  0]</span>
<span class="go">[ 0  0  1 -1  0]</span>
<span class="go">[ 0  0  0  1 -1]</span>
<span class="go">[ 0  0  0  0  0]</span>
<span class="gp">sage: </span><span class="n">DiGraph</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">Digraph on 6 vertices</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p class="first">A dig6 string: Sage automatically recognizes whether a string is
in dig6 format, which is a directed version of graph6:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="s">&#39;IRAaDCIIOWEOKcPWAo&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span>
<span class="go">Digraph on 10 vertices</span>

<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="s">&#39;IRAaDCIIOEOKcPWAo&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">The string (IRAaDCIIOEOKcPWAo) seems corrupt: for n = 10, the string is too short.</span>

<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="s">&quot;IRAaDCI&#39;OWEOKcPWAo&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">The string seems corrupt: valid characters are</span>
<span class="go">?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz{|}~</span>
</pre></div>
</div>
</li>
<li><p class="first">A NetworkX XDiGraph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">import</span> <span class="nn">networkx</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">networkx</span><span class="o">.</span><span class="n">MultiDiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">4</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">DiGraph</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">Digraph on 5 vertices</span>
</pre></div>
</div>
</li>
<li><p class="first">A NetworkX digraph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">import</span> <span class="nn">networkx</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">networkx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">4</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">DiGraph</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">Digraph on 5 vertices</span>
</pre></div>
</div>
</li>
<li><p class="first">An igraph directed Graph (see also
<a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.igraph_graph" title="sage.graphs.generic_graph.GenericGraph.igraph_graph"><tt class="xref py py-meth docutils literal"><span class="pre">igraph_graph()</span></tt></a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">import</span> <span class="nn">igraph</span>                                  <span class="c"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">igraph</span><span class="o">.</span><span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span> <span class="n">directed</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">DiGraph</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>                                     <span class="c"># optional - python_igraph</span>
<span class="go">Digraph on 3 vertices</span>
</pre></div>
</div>
<p>If <tt class="docutils literal"><span class="pre">vertex_labels</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt>, the names of the vertices are given by
the vertex attribute <tt class="docutils literal"><span class="pre">'name'</span></tt>, if available:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">igraph</span><span class="o">.</span><span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span> <span class="n">directed</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">vertex_attrs</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">]})</span>  <span class="c"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">DiGraph</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>                                                                <span class="c"># optional - python_igraph</span>
<span class="go">[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">igraph</span><span class="o">.</span><span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span> <span class="n">directed</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">vertex_attrs</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;label&#39;</span><span class="p">:[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">]})</span> <span class="c"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">DiGraph</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>                                                                <span class="c"># optional - python_igraph</span>
<span class="go">[0, 1, 2]</span>
</pre></div>
</div>
<p>If the igraph Graph has edge attributes, they are used as edge labels:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">igraph</span><span class="o">.</span><span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span> <span class="n">directed</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">edge_attrs</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">],</span> <span class="s">&#39;weight&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]})</span> <span class="c"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">DiGraph</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>                                                                            <span class="c"># optional - python_igraph</span>
<span class="go">[(0, 1, {&#39;name&#39;: &#39;a&#39;, &#39;weight&#39;: 1}), (0, 2, {&#39;name&#39;: &#39;b&#39;, &#39;weight&#39;: 3})]</span>
</pre></div>
</div>
</li>
</ol>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">4</span><span class="p">]})</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, None), (0, 2, None), (0, 3, None), (2, 4, None)]</span>
<span class="gp">sage: </span><span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">:(</span><span class="mi">4</span><span class="p">,)})</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, None), (0, 2, None), (0, 3, None), (2, 4, None)]</span>
<span class="gp">sage: </span><span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span><span class="n">Set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="mi">2</span><span class="p">:</span><span class="n">Set</span><span class="p">([</span><span class="mi">4</span><span class="p">])})</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, None), (0, 2, None), (0, 3, None), (2, 4, None)]</span>
</pre></div>
</div>
<p>Demonstrate that digraphs using the static backend are equal to mutable
graphs but can be used as dictionary keys:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">import</span> <span class="nn">networkx</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">networkx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">4</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G_imm</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">data_structure</span><span class="o">=</span><span class="s">&quot;static_sparse&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H_imm</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">data_structure</span><span class="o">=</span><span class="s">&quot;static_sparse&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H_imm</span> <span class="ow">is</span> <span class="n">G_imm</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">H_imm</span> <span class="o">==</span> <span class="n">G_imm</span> <span class="o">==</span> <span class="n">G</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">{</span><span class="n">G_imm</span><span class="p">:</span><span class="mi">1</span><span class="p">}[</span><span class="n">H_imm</span><span class="p">]</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">{</span><span class="n">G_imm</span><span class="p">:</span><span class="mi">1</span><span class="p">}[</span><span class="n">G</span><span class="p">]</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">This graph is mutable, and thus not hashable. Create an</span>
<span class="go">immutable copy by `g.copy(immutable=True)`</span>
</pre></div>
</div>
<p>The error message states that one can also create immutable graphs by
specifying the <tt class="docutils literal"><span class="pre">immutable</span></tt> optional argument (not only by
<tt class="docutils literal"><span class="pre">data_structure='static_sparse'</span></tt> as above):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">J_imm</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">immutable</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J_imm</span> <span class="o">==</span> <span class="n">G_imm</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">J_imm</span><span class="o">.</span><span class="n">_backend</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="n">G_imm</span><span class="o">.</span><span class="n">_backend</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>From a a list of vertices and a list of edges:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)]]);</span> <span class="n">G</span>
<span class="go">Digraph on 3 vertices</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(1, 2, None)]</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.all_cycles_iterator">
<tt class="descname">all_cycles_iterator</tt><big>(</big><em>starting_vertices=None</em>, <em>simple=False</em>, <em>rooted=False</em>, <em>max_length=None</em>, <em>trivial=False</em><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.all_cycles_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an iterator over all the cycles of self starting
with one of the given vertices. The cycles are enumerated
in increasing length order.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">starting_vertices</span></tt> - iterable (default: None) on vertices
from which the cycles must start. If None, then all
vertices of the graph can be starting points.</li>
<li><tt class="docutils literal"><span class="pre">simple</span></tt> - boolean (default: False). If set to True,
then only simple cycles are considered. A cycle is simple
if the only vertex occuring twice in it is the starting
and ending one.</li>
<li><tt class="docutils literal"><span class="pre">rooted</span></tt> - boolean (default: False). If set to False,
then cycles differing only by their starting vertex are
considered the same  (e.g. <tt class="docutils literal"><span class="pre">['a',</span> <span class="pre">'b',</span> <span class="pre">'c',</span> <span class="pre">'a']</span></tt> and
<tt class="docutils literal"><span class="pre">['b',</span> <span class="pre">'c',</span> <span class="pre">'a',</span> <span class="pre">'b']</span></tt>). Otherwise, all cycles are enumerated.</li>
<li><tt class="docutils literal"><span class="pre">max_length</span></tt> - non negative integer (default: None).
The maximum length of the enumerated cycles. If set to None,
then all lengths are allowed.</li>
<li><tt class="docutils literal"><span class="pre">trivial</span></tt> - boolean (default: False). If set to True,
then the empty cycles are also enumerated.</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div>iterator</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">See also <a class="reference internal" href="#sage.graphs.digraph.DiGraph.all_simple_cycles" title="sage.graphs.digraph.DiGraph.all_simple_cycles"><tt class="xref py py-meth docutils literal"><span class="pre">all_simple_cycles()</span></tt></a>.</p>
</div>
<p>AUTHOR:</p>
<blockquote>
<div>Alexandre Blondin Masse</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="s">&#39;a&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">],</span> <span class="s">&#39;b&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s">&#39;c&#39;</span><span class="p">],</span> <span class="s">&#39;c&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s">&#39;d&#39;</span><span class="p">],</span> <span class="s">&#39;d&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s">&#39;c&#39;</span><span class="p">]},</span> <span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">it</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">all_cycles_iterator</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span> <span class="k">print</span> <span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<span class="go">[&#39;a&#39;, &#39;a&#39;]</span>
<span class="go">[&#39;a&#39;, &#39;a&#39;, &#39;a&#39;]</span>
<span class="go">[&#39;c&#39;, &#39;d&#39;, &#39;c&#39;]</span>
<span class="go">[&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;]</span>
<span class="go">[&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;]</span>
<span class="go">[&#39;c&#39;, &#39;d&#39;, &#39;c&#39;, &#39;d&#39;, &#39;c&#39;]</span>
<span class="go">[&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;]</span>
</pre></div>
</div>
<p>There are no cycles in the empty graph and in acyclic graphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">it</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">all_cycles_iterator</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">it</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">all_cycles_iterator</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>It is possible to restrict the starting vertices of the cycles:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="s">&#39;a&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">],</span> <span class="s">&#39;b&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s">&#39;c&#39;</span><span class="p">],</span> <span class="s">&#39;c&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s">&#39;d&#39;</span><span class="p">],</span> <span class="s">&#39;d&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s">&#39;c&#39;</span><span class="p">]},</span> <span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">it</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">all_cycles_iterator</span><span class="p">(</span><span class="n">starting_vertices</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">])</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span> <span class="k">print</span> <span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<span class="go">[&#39;c&#39;, &#39;d&#39;, &#39;c&#39;]</span>
<span class="go">[&#39;c&#39;, &#39;d&#39;, &#39;c&#39;, &#39;d&#39;, &#39;c&#39;]</span>
<span class="go">[&#39;c&#39;, &#39;d&#39;, &#39;c&#39;, &#39;d&#39;, &#39;c&#39;, &#39;d&#39;, &#39;c&#39;]</span>
</pre></div>
</div>
<p>Also, one can bound the length of the cycles:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">it</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">all_cycles_iterator</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<span class="go">[[&#39;a&#39;, &#39;a&#39;], [&#39;a&#39;, &#39;a&#39;, &#39;a&#39;], [&#39;c&#39;, &#39;d&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;]]</span>
</pre></div>
</div>
<p>By default, cycles differing only by their starting point are not all
enumerated, but this may be parametrized:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">it</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">all_cycles_iterator</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">rooted</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<span class="go">[[&#39;a&#39;, &#39;a&#39;], [&#39;a&#39;, &#39;a&#39;, &#39;a&#39;], [&#39;c&#39;, &#39;d&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;]]</span>
<span class="gp">sage: </span><span class="n">it</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">all_cycles_iterator</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">rooted</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<span class="go">[[&#39;a&#39;, &#39;a&#39;], [&#39;a&#39;, &#39;a&#39;, &#39;a&#39;], [&#39;c&#39;, &#39;d&#39;, &#39;c&#39;], [&#39;d&#39;, &#39;c&#39;, &#39;d&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;]]</span>
</pre></div>
</div>
<p>One may prefer to enumerate simple cycles, i.e. cycles such that the only
vertex occuring twice in it is the starting and ending one (see also
<a class="reference internal" href="#sage.graphs.digraph.DiGraph.all_simple_cycles" title="sage.graphs.digraph.DiGraph.all_simple_cycles"><tt class="xref py py-meth docutils literal"><span class="pre">all_simple_cycles()</span></tt></a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">it</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">all_cycles_iterator</span><span class="p">(</span><span class="n">simple</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<span class="go">[[&#39;a&#39;, &#39;a&#39;], [&#39;c&#39;, &#39;d&#39;, &#39;c&#39;]]</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">Circuit</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">all_cycles_iterator</span><span class="p">(</span><span class="n">simple</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="go">[[0, 1, 2, 3, 0]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.all_paths_iterator">
<tt class="descname">all_paths_iterator</tt><big>(</big><em>starting_vertices=None</em>, <em>ending_vertices=None</em>, <em>simple=False</em>, <em>max_length=None</em>, <em>trivial=False</em><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.all_paths_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an iterator over the paths of self. The paths are
enumerated in increasing length order.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">starting_vertices</span></tt> - iterable (default: None) on the
vertices from which the paths must start. If None, then all
vertices of the graph can be starting points.</li>
<li><tt class="docutils literal"><span class="pre">ending_vertices</span></tt> - iterable (default: None) on
the allowed ending vertices of the paths. If None,
then all vertices are allowed.</li>
<li><tt class="docutils literal"><span class="pre">simple</span></tt> - boolean (default: False). If set to True,
then only simple paths are considered. These are paths in
which no two arcs share a head or share a tail, i.e. every
vertex in the path is entered at most once and exited at most
once.</li>
<li><tt class="docutils literal"><span class="pre">max_length</span></tt> - non negative integer (default: None).
The maximum length of the enumerated paths. If set to None,
then all lengths are allowed.</li>
<li><tt class="docutils literal"><span class="pre">trivial</span></tt> - boolean (default: False). If set to True,
then the empty paths are also enumerated.</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div>iterator</div></blockquote>
<p>AUTHOR:</p>
<blockquote>
<div>Alexandre Blondin Masse</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="s">&#39;a&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">],</span> <span class="s">&#39;b&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s">&#39;c&#39;</span><span class="p">],</span> <span class="s">&#39;c&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s">&#39;d&#39;</span><span class="p">],</span> <span class="s">&#39;d&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s">&#39;c&#39;</span><span class="p">]},</span> <span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pi</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">all_paths_iterator</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span> <span class="k">print</span> <span class="nb">next</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
<span class="go">[&#39;a&#39;, &#39;a&#39;]</span>
<span class="go">[&#39;a&#39;, &#39;b&#39;]</span>
<span class="go">[&#39;b&#39;, &#39;c&#39;]</span>
<span class="go">[&#39;c&#39;, &#39;d&#39;]</span>
<span class="go">[&#39;d&#39;, &#39;c&#39;]</span>
<span class="go">[&#39;a&#39;, &#39;a&#39;, &#39;a&#39;]</span>
<span class="go">[&#39;a&#39;, &#39;a&#39;, &#39;b&#39;]</span>
</pre></div>
</div>
<p>It is possible to precise the allowed starting and/or ending vertices:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">pi</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">all_paths_iterator</span><span class="p">(</span><span class="n">starting_vertices</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">])</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span> <span class="k">print</span> <span class="nb">next</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
<span class="go">[&#39;a&#39;, &#39;a&#39;]</span>
<span class="go">[&#39;a&#39;, &#39;b&#39;]</span>
<span class="go">[&#39;a&#39;, &#39;a&#39;, &#39;a&#39;]</span>
<span class="go">[&#39;a&#39;, &#39;a&#39;, &#39;b&#39;]</span>
<span class="go">[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]</span>
<span class="gp">sage: </span><span class="n">pi</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">all_paths_iterator</span><span class="p">(</span><span class="n">starting_vertices</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">],</span> <span class="n">ending_vertices</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;b&#39;</span><span class="p">])</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span> <span class="k">print</span> <span class="nb">next</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
<span class="go">[&#39;a&#39;, &#39;b&#39;]</span>
<span class="go">[&#39;a&#39;, &#39;a&#39;, &#39;b&#39;]</span>
<span class="go">[&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;b&#39;]</span>
<span class="go">[&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;b&#39;]</span>
<span class="go">[&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;b&#39;]</span>
</pre></div>
</div>
<p>One may prefer to enumerate only simple paths (see
<a class="reference internal" href="#sage.graphs.digraph.DiGraph.all_simple_paths" title="sage.graphs.digraph.DiGraph.all_simple_paths"><tt class="xref py py-meth docutils literal"><span class="pre">all_simple_paths()</span></tt></a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">pi</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">all_paths_iterator</span><span class="p">(</span><span class="n">simple</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
<span class="go">[[&#39;a&#39;, &#39;a&#39;], [&#39;a&#39;, &#39;b&#39;], [&#39;b&#39;, &#39;c&#39;], [&#39;c&#39;, &#39;d&#39;], [&#39;d&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], [&#39;b&#39;, &#39;c&#39;, &#39;d&#39;], [&#39;c&#39;, &#39;d&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;d&#39;, &#39;c&#39;, &#39;d&#39;], [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;]]</span>
</pre></div>
</div>
<p>Or simply bound the length of the enumerated paths:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">pi</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">all_paths_iterator</span><span class="p">(</span><span class="n">starting_vertices</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">],</span> <span class="n">ending_vertices</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">],</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
<span class="go">[[&#39;a&#39;, &#39;b&#39;], [&#39;a&#39;, &#39;a&#39;, &#39;b&#39;], [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;b&#39;], [&#39;a&#39;, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;b&#39;], [&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;c&#39;], [&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;b&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;], [&#39;a&#39;, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;b&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;c&#39;, &#39;d&#39;, &#39;c&#39;]]</span>
</pre></div>
</div>
<p>By default, empty paths are not enumerated, but it may be
parametrized:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">pi</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">all_paths_iterator</span><span class="p">(</span><span class="n">simple</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">trivial</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
<span class="go">[[&#39;a&#39;], [&#39;b&#39;], [&#39;c&#39;], [&#39;d&#39;], [&#39;a&#39;, &#39;a&#39;], [&#39;a&#39;, &#39;b&#39;], [&#39;b&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;c&#39;, &#39;d&#39;], [&#39;d&#39;, &#39;c&#39;], [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], [&#39;b&#39;, &#39;c&#39;, &#39;d&#39;],</span>
<span class="go"> [&#39;c&#39;, &#39;d&#39;, &#39;c&#39;], [&#39;d&#39;, &#39;c&#39;, &#39;d&#39;], [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;]]</span>
<span class="gp">sage: </span><span class="n">pi</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">all_paths_iterator</span><span class="p">(</span><span class="n">simple</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">trivial</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
<span class="go">[[&#39;a&#39;, &#39;a&#39;], [&#39;a&#39;, &#39;b&#39;], [&#39;b&#39;, &#39;c&#39;], [&#39;c&#39;, &#39;d&#39;], [&#39;d&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], [&#39;b&#39;, &#39;c&#39;, &#39;d&#39;], [&#39;c&#39;, &#39;d&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;d&#39;, &#39;c&#39;, &#39;d&#39;], [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.all_simple_cycles">
<tt class="descname">all_simple_cycles</tt><big>(</big><em>starting_vertices=None</em>, <em>rooted=False</em>, <em>max_length=None</em>, <em>trivial=False</em><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.all_simple_cycles" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of all simple cycles of self.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">starting_vertices</span></tt> - iterable (default: None) on vertices
from which the cycles must start. If None, then all
vertices of the graph can be starting points.</li>
<li><tt class="docutils literal"><span class="pre">rooted</span></tt> - boolean (default: False). If set to False,
then equivalent cycles are merged into one single cycle
(the one starting with minimum vertex).
Two cycles are called equivalent if they differ only from
their starting vertex (e.g. <tt class="docutils literal"><span class="pre">['a',</span> <span class="pre">'b',</span> <span class="pre">'c',</span> <span class="pre">'a']</span></tt> and
<tt class="docutils literal"><span class="pre">['b',</span> <span class="pre">'c',</span> <span class="pre">'a',</span> <span class="pre">'b']</span></tt>). Otherwise, all cycles are enumerated.</li>
<li><tt class="docutils literal"><span class="pre">max_length</span></tt> - non negative integer (default: None).
The maximum length of the enumerated cycles. If set to None,
then all lengths are allowed.</li>
<li><tt class="docutils literal"><span class="pre">trivial</span></tt> - boolean (default: False). If set to True,
then the empty cycles are also enumerated.</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div>list</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Although the number of simple cycles of a finite graph is
always finite, computing all its cycles may take a very long
time.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="s">&#39;a&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">],</span> <span class="s">&#39;b&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s">&#39;c&#39;</span><span class="p">],</span> <span class="s">&#39;c&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s">&#39;d&#39;</span><span class="p">],</span> <span class="s">&#39;d&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s">&#39;c&#39;</span><span class="p">]},</span> <span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">all_simple_cycles</span><span class="p">()</span>
<span class="go">[[&#39;a&#39;, &#39;a&#39;], [&#39;c&#39;, &#39;d&#39;, &#39;c&#39;]]</span>
</pre></div>
</div>
<p>The directed version of the Petersen graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">all_simple_cycles</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="go">[[0, 1, 0], [0, 4, 0], [0, 5, 0], [1, 2, 1], [1, 6, 1], [2, 3, 2],</span>
<span class="go"> [2, 7, 2], [3, 8, 3], [3, 4, 3], [4, 9, 4], [5, 8, 5], [5, 7, 5],</span>
<span class="go"> [6, 8, 6], [6, 9, 6], [7, 9, 7]]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">all_simple_cycles</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="go">[[0, 1, 0], [0, 4, 0], [0, 5, 0], [1, 2, 1], [1, 6, 1], [2, 3, 2],</span>
<span class="go"> [2, 7, 2], [3, 8, 3], [3, 4, 3], [4, 9, 4], [5, 8, 5], [5, 7, 5],</span>
<span class="go"> [6, 8, 6], [6, 9, 6], [7, 9, 7], [0, 1, 2, 3, 4, 0],</span>
<span class="go"> [0, 1, 2, 7, 5, 0], [0, 1, 6, 8, 5, 0], [0, 1, 6, 9, 4, 0],</span>
<span class="go"> [0, 4, 9, 6, 1, 0], [0, 4, 9, 7, 5, 0], [0, 4, 3, 8, 5, 0],</span>
<span class="go"> [0, 4, 3, 2, 1, 0], [0, 5, 8, 3, 4, 0], [0, 5, 8, 6, 1, 0],</span>
<span class="go"> [0, 5, 7, 9, 4, 0], [0, 5, 7, 2, 1, 0], [1, 2, 3, 8, 6, 1],</span>
<span class="go"> [1, 2, 7, 9, 6, 1], [1, 6, 8, 3, 2, 1], [1, 6, 9, 7, 2, 1],</span>
<span class="go"> [2, 3, 8, 5, 7, 2], [2, 3, 4, 9, 7, 2], [2, 7, 9, 4, 3, 2],</span>
<span class="go"> [2, 7, 5, 8, 3, 2], [3, 8, 6, 9, 4, 3], [3, 4, 9, 6, 8, 3],</span>
<span class="go"> [5, 8, 6, 9, 7, 5], [5, 7, 9, 6, 8, 5], [0, 1, 2, 3, 8, 5, 0],</span>
<span class="go"> [0, 1, 2, 7, 9, 4, 0], [0, 1, 6, 8, 3, 4, 0],</span>
<span class="go"> [0, 1, 6, 9, 7, 5, 0], [0, 4, 9, 6, 8, 5, 0],</span>
<span class="go"> [0, 4, 9, 7, 2, 1, 0], [0, 4, 3, 8, 6, 1, 0],</span>
<span class="go"> [0, 4, 3, 2, 7, 5, 0], [0, 5, 8, 3, 2, 1, 0],</span>
<span class="go"> [0, 5, 8, 6, 9, 4, 0], [0, 5, 7, 9, 6, 1, 0],</span>
<span class="go"> [0, 5, 7, 2, 3, 4, 0], [1, 2, 3, 4, 9, 6, 1],</span>
<span class="go"> [1, 2, 7, 5, 8, 6, 1], [1, 6, 8, 5, 7, 2, 1],</span>
<span class="go"> [1, 6, 9, 4, 3, 2, 1], [2, 3, 8, 6, 9, 7, 2],</span>
<span class="go"> [2, 7, 9, 6, 8, 3, 2], [3, 8, 5, 7, 9, 4, 3],</span>
<span class="go"> [3, 4, 9, 7, 5, 8, 3]]</span>
</pre></div>
</div>
<p>The complete graph (without loops) on <span class="math">\(4\)</span> vertices:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">all_simple_cycles</span><span class="p">()</span>
<span class="go">[[0, 1, 0], [0, 2, 0], [0, 3, 0], [1, 2, 1], [1, 3, 1], [2, 3, 2],</span>
<span class="go"> [0, 1, 2, 0], [0, 1, 3, 0], [0, 2, 1, 0], [0, 2, 3, 0],</span>
<span class="go"> [0, 3, 1, 0], [0, 3, 2, 0], [1, 2, 3, 1], [1, 3, 2, 1],</span>
<span class="go"> [0, 1, 2, 3, 0], [0, 1, 3, 2, 0], [0, 2, 1, 3, 0],</span>
<span class="go"> [0, 2, 3, 1, 0], [0, 3, 1, 2, 0], [0, 3, 2, 1, 0]]</span>
</pre></div>
</div>
<p>If the graph contains a large number of cycles, one can bound
the length of the cycles, or simply restrict the possible
starting vertices of the cycles:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">all_simple_cycles</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[[0, 1, 0], [0, 2, 0], [0, 3, 0], [0, 4, 0], [0, 5, 0], [0, 6, 0],</span>
<span class="go"> [0, 7, 0], [0, 8, 0], [0, 9, 0], [0, 10, 0], [0, 11, 0],</span>
<span class="go"> [0, 12, 0], [0, 13, 0], [0, 14, 0], [0, 15, 0], [0, 16, 0],</span>
<span class="go"> [0, 17, 0], [0, 18, 0], [0, 19, 0], [1, 2, 1], [1, 3, 1],</span>
<span class="go"> [1, 4, 1], [1, 5, 1], [1, 6, 1], [1, 7, 1], [1, 8, 1], [1, 9, 1],</span>
<span class="go"> [1, 10, 1], [1, 11, 1], [1, 12, 1], [1, 13, 1], [1, 14, 1],</span>
<span class="go"> [1, 15, 1], [1, 16, 1], [1, 17, 1], [1, 18, 1], [1, 19, 1],</span>
<span class="go"> [2, 3, 2], [2, 4, 2], [2, 5, 2], [2, 6, 2], [2, 7, 2], [2, 8, 2],</span>
<span class="go"> [2, 9, 2], [2, 10, 2], [2, 11, 2], [2, 12, 2], [2, 13, 2],</span>
<span class="go"> [2, 14, 2], [2, 15, 2], [2, 16, 2], [2, 17, 2], [2, 18, 2],</span>
<span class="go"> [2, 19, 2], [3, 4, 3], [3, 5, 3], [3, 6, 3], [3, 7, 3], [3, 8, 3],</span>
<span class="go"> [3, 9, 3], [3, 10, 3], [3, 11, 3], [3, 12, 3], [3, 13, 3],</span>
<span class="go"> [3, 14, 3], [3, 15, 3], [3, 16, 3], [3, 17, 3], [3, 18, 3],</span>
<span class="go"> [3, 19, 3], [4, 5, 4], [4, 6, 4], [4, 7, 4], [4, 8, 4], [4, 9, 4],</span>
<span class="go"> [4, 10, 4], [4, 11, 4], [4, 12, 4], [4, 13, 4], [4, 14, 4],</span>
<span class="go"> [4, 15, 4], [4, 16, 4], [4, 17, 4], [4, 18, 4], [4, 19, 4],</span>
<span class="go"> [5, 6, 5], [5, 7, 5], [5, 8, 5], [5, 9, 5], [5, 10, 5],</span>
<span class="go"> [5, 11, 5], [5, 12, 5], [5, 13, 5], [5, 14, 5], [5, 15, 5],</span>
<span class="go"> [5, 16, 5], [5, 17, 5], [5, 18, 5], [5, 19, 5], [6, 7, 6],</span>
<span class="go"> [6, 8, 6], [6, 9, 6], [6, 10, 6], [6, 11, 6], [6, 12, 6],</span>
<span class="go"> [6, 13, 6], [6, 14, 6], [6, 15, 6], [6, 16, 6], [6, 17, 6],</span>
<span class="go"> [6, 18, 6], [6, 19, 6], [7, 8, 7], [7, 9, 7], [7, 10, 7],</span>
<span class="go"> [7, 11, 7], [7, 12, 7], [7, 13, 7], [7, 14, 7], [7, 15, 7],</span>
<span class="go"> [7, 16, 7], [7, 17, 7], [7, 18, 7], [7, 19, 7], [8, 9, 8],</span>
<span class="go"> [8, 10, 8], [8, 11, 8], [8, 12, 8], [8, 13, 8], [8, 14, 8],</span>
<span class="go"> [8, 15, 8], [8, 16, 8], [8, 17, 8], [8, 18, 8], [8, 19, 8],</span>
<span class="go"> [9, 10, 9], [9, 11, 9], [9, 12, 9], [9, 13, 9], [9, 14, 9],</span>
<span class="go"> [9, 15, 9], [9, 16, 9], [9, 17, 9], [9, 18, 9], [9, 19, 9],</span>
<span class="go"> [10, 11, 10], [10, 12, 10], [10, 13, 10], [10, 14, 10],</span>
<span class="go"> [10, 15, 10], [10, 16, 10], [10, 17, 10], [10, 18, 10],</span>
<span class="go"> [10, 19, 10], [11, 12, 11], [11, 13, 11], [11, 14, 11],</span>
<span class="go"> [11, 15, 11], [11, 16, 11], [11, 17, 11], [11, 18, 11],</span>
<span class="go"> [11, 19, 11], [12, 13, 12], [12, 14, 12], [12, 15, 12],</span>
<span class="go"> [12, 16, 12], [12, 17, 12], [12, 18, 12], [12, 19, 12],</span>
<span class="go"> [13, 14, 13], [13, 15, 13], [13, 16, 13], [13, 17, 13],</span>
<span class="go"> [13, 18, 13], [13, 19, 13], [14, 15, 14], [14, 16, 14],</span>
<span class="go"> [14, 17, 14], [14, 18, 14], [14, 19, 14], [15, 16, 15],</span>
<span class="go"> [15, 17, 15], [15, 18, 15], [15, 19, 15], [16, 17, 16],</span>
<span class="go"> [16, 18, 16], [16, 19, 16], [17, 18, 17], [17, 19, 17],</span>
<span class="go"> [18, 19, 18]]</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">all_simple_cycles</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">starting_vertices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">[[0, 1, 0], [0, 2, 0], [0, 3, 0], [0, 4, 0], [0, 5, 0], [0, 6, 0],</span>
<span class="go"> [0, 7, 0], [0, 8, 0], [0, 9, 0], [0, 10, 0], [0, 11, 0],</span>
<span class="go"> [0, 12, 0], [0, 13, 0], [0, 14, 0], [0, 15, 0], [0, 16, 0],</span>
<span class="go"> [0, 17, 0], [0, 18, 0], [0, 19, 0]]</span>
</pre></div>
</div>
<p>One may prefer to distinguish equivalent cycles having distinct
starting vertices (compare the following examples):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">all_simple_cycles</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">rooted</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[[0, 1, 0], [0, 2, 0], [0, 3, 0], [1, 2, 1], [1, 3, 1], [2, 3, 2]]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">all_simple_cycles</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">rooted</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[[0, 1, 0], [0, 2, 0], [0, 3, 0], [1, 0, 1], [1, 2, 1], [1, 3, 1],</span>
<span class="go"> [2, 0, 2], [2, 1, 2], [2, 3, 2], [3, 0, 3], [3, 1, 3], [3, 2, 3]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.all_simple_paths">
<tt class="descname">all_simple_paths</tt><big>(</big><em>starting_vertices=None</em>, <em>ending_vertices=None</em>, <em>max_length=None</em>, <em>trivial=False</em><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.all_simple_paths" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of all the simple paths of self starting
with one of the given vertices. Simple paths are paths in which
no two arcs share a head or share a tail, i.e. every vertex in
the path is entered at most once and exited at most once.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">starting_vertices</span></tt> - list (default: None) of vertices
from which the paths must start. If None, then all
vertices of the graph can be starting points.</li>
<li><tt class="docutils literal"><span class="pre">ending_vertices</span></tt> - iterable (default: None) on
the allowed ending vertices of the paths. If None,
then all vertices are allowed.</li>
<li><tt class="docutils literal"><span class="pre">max_length</span></tt> - non negative integer (default: None).
The maximum length of the enumerated paths. If set to None,
then all lengths are allowed.</li>
<li><tt class="docutils literal"><span class="pre">trivial</span></tt> - boolean (default: False). If set to True,
then the empty paths are also enumerated.</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div>list</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Although the number of simple paths of a finite graph
is always finite, computing all its paths may take a very
long time.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="s">&#39;a&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">],</span> <span class="s">&#39;b&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s">&#39;c&#39;</span><span class="p">],</span> <span class="s">&#39;c&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s">&#39;d&#39;</span><span class="p">],</span> <span class="s">&#39;d&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s">&#39;c&#39;</span><span class="p">]},</span> <span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">all_simple_paths</span><span class="p">()</span>
<span class="go">[[&#39;a&#39;, &#39;a&#39;], [&#39;a&#39;, &#39;b&#39;], [&#39;b&#39;, &#39;c&#39;], [&#39;c&#39;, &#39;d&#39;], [&#39;d&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], [&#39;b&#39;, &#39;c&#39;, &#39;d&#39;], [&#39;c&#39;, &#39;d&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;d&#39;, &#39;c&#39;, &#39;d&#39;], [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;]]</span>
</pre></div>
</div>
<p>One may compute all paths having specific starting and/or
ending vertices:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">all_simple_paths</span><span class="p">(</span><span class="n">starting_vertices</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">])</span>
<span class="go">[[&#39;a&#39;, &#39;a&#39;], [&#39;a&#39;, &#39;b&#39;], [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;]]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">all_simple_paths</span><span class="p">(</span><span class="n">starting_vertices</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">],</span> <span class="n">ending_vertices</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;c&#39;</span><span class="p">])</span>
<span class="go">[[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">all_simple_paths</span><span class="p">(</span><span class="n">starting_vertices</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">],</span> <span class="n">ending_vertices</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">])</span>
<span class="go">[[&#39;a&#39;, &#39;b&#39;], [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]]</span>
</pre></div>
</div>
<p>It is also possible to bound the length of the paths:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">all_simple_paths</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[[&#39;a&#39;, &#39;a&#39;], [&#39;a&#39;, &#39;b&#39;], [&#39;b&#39;, &#39;c&#39;], [&#39;c&#39;, &#39;d&#39;], [&#39;d&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], [&#39;b&#39;, &#39;c&#39;, &#39;d&#39;], [&#39;c&#39;, &#39;d&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;d&#39;, &#39;c&#39;, &#39;d&#39;]]</span>
</pre></div>
</div>
<p>By default, empty paths are not enumerated, but this can
be parametrized:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">all_simple_paths</span><span class="p">(</span><span class="n">starting_vertices</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">],</span> <span class="n">trivial</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[[&#39;a&#39;], [&#39;a&#39;, &#39;a&#39;], [&#39;a&#39;, &#39;b&#39;], [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;]]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">all_simple_paths</span><span class="p">(</span><span class="n">starting_vertices</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">],</span> <span class="n">trivial</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[[&#39;a&#39;, &#39;a&#39;], [&#39;a&#39;, &#39;b&#39;], [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.dig6_string">
<tt class="descname">dig6_string</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.dig6_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the dig6 representation of the digraph as an ASCII string.
Valid for single (no multiple edges) digraphs on 0 to 262143
vertices.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">dig6_string</span><span class="p">()</span>
<span class="go">&#39;?&#39;</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">dig6_string</span><span class="p">()</span>
<span class="go">&#39;AO&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.feedback_edge_set">
<tt class="descname">feedback_edge_set</tt><big>(</big><em>constraint_generation=True</em>, <em>value_only=False</em>, <em>solver=None</em>, <em>verbose=0</em><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.feedback_edge_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the minimum feedback edge set of a digraph (also called
feedback arc set).</p>
<p>The minimum feedback edge set of a digraph is a set of edges that
intersect all the circuits of the digraph.  Equivalently, a minimum
feedback arc set of a DiGraph is a set <span class="math">\(S\)</span> of arcs such that the digraph
<span class="math">\(G-S\)</span> is acyclic. For more information, see the <a class="reference external" href="http://en.wikipedia.org/wiki/Feedback_arc_set">Wikipedia article on
feedback arc sets</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">value_only</span></tt> &#8211; boolean (default: <tt class="docutils literal"><span class="pre">False</span></tt>)<ul>
<li>When set to <tt class="docutils literal"><span class="pre">True</span></tt>, only the minimum cardinal of a minimum edge
set is returned.</li>
<li>When set to <tt class="docutils literal"><span class="pre">False</span></tt>, the <tt class="docutils literal"><span class="pre">Set</span></tt> of edges of a minimal edge set is
returned.</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">constraint_generation</span></tt> (boolean) &#8211; whether to use constraint
generation when solving the Mixed Integer Linear Program (default:
<tt class="docutils literal"><span class="pre">True</span></tt>).</li>
<li><tt class="docutils literal"><span class="pre">solver</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">None</span></tt>) Specify a Linear Program (LP)
solver to be used. If set to <tt class="docutils literal"><span class="pre">None</span></tt>, the default one is used. For
more information on LP solvers and which default solver is used, see
the method
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram.solve" title="(in Sage Reference Manual: Numerical Optimization v7.0)"><tt class="xref py py-meth docutils literal"><span class="pre">solve</span></tt></a>
of the class
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram" title="(in Sage Reference Manual: Numerical Optimization v7.0)"><tt class="xref py py-class docutils literal"><span class="pre">MixedIntegerLinearProgram</span></tt></a>.</li>
<li><tt class="docutils literal"><span class="pre">verbose</span></tt> &#8211; integer (default: <tt class="docutils literal"><span class="pre">0</span></tt>). Sets the level of
verbosity. Set to 0 by default, which means quiet.</li>
</ul>
<p>ALGORITHM:</p>
<p>This problem is solved using Linear Programming, in two different
ways. The first one is to solve the following formulation:</p>
<div class="math">
\[\begin{split}\mbox{Minimize : }&amp;\sum_{(u,v)\in G} b_{(u,v)}\\
\mbox{Such that : }&amp;\\
&amp;\forall (u,v)\in G, d_u-d_v+ n \cdot b_{(u,v)}\geq 0\\
&amp;\forall u\in G, 0\leq d_u\leq |G|\\\end{split}\]</div>
<p>An explanation:</p>
<p>An acyclic digraph can be seen as a poset, and every poset has a linear
extension. This means that in any acyclic digraph the vertices can be
ordered with a total order <span class="math">\(&lt;\)</span> in such a way that if <span class="math">\((u,v)\in G\)</span>, then
<span class="math">\(u&lt;v\)</span>.</p>
<p>Thus, this linear program is built in order to assign to each vertex <span class="math">\(v\)</span>
a number <span class="math">\(d_v\in [0,\dots,n-1]\)</span> such that if there exists an edge
<span class="math">\((u,v)\in G\)</span> such that <span class="math">\(d_v&lt;d_u\)</span>, then the edge <span class="math">\((u,v)\)</span> is removed.</p>
<p>The number of edges removed is then minimized, which is the objective.</p>
<p>(Constraint Generation)</p>
<p>If the parameter <tt class="docutils literal"><span class="pre">constraint_generation</span></tt> is enabled, a more efficient
formulation is used :</p>
<div class="math">
\[\begin{split}\mbox{Minimize : }&amp;\sum_{(u,v)\in G} b_{(u,v)}\\
\mbox{Such that : }&amp;\\
&amp;\forall C\text{ circuits }\subseteq G, \sum_{uv\in C}b_{(u,v)}\geq 1\\\end{split}\]</div>
<p>As the number of circuits contained in a graph is exponential, this LP
is solved through constraint generation. This means that the solver is
sequentially asked to solved the problem, knowing only a portion of the
circuits contained in <span class="math">\(G\)</span>, each time adding to the list of its
constraints the circuit which its last answer had left intact.</p>
<p>EXAMPLES:</p>
<p>If the digraph is created from a graph, and hence is symmetric (if <span class="math">\(uv\)</span>
is an edge, then <span class="math">\(vu\)</span> is an edge too), then obviously the cardinality of
its feedback arc set is the number of edges in the first graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">cycle</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">dcycle</span><span class="o">=</span><span class="n">DiGraph</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cycle</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">dcycle</span><span class="o">.</span><span class="n">feedback_edge_set</span><span class="p">(</span><span class="n">value_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">5</span>
</pre></div>
</div>
<p>And in this situation, for any edge <span class="math">\(uv\)</span> of the first graph, <span class="math">\(uv\)</span> of
<span class="math">\(vu\)</span> is in the returned feedback arc set:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomGNP</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="o">.</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">dg</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">feedback</span> <span class="o">=</span> <span class="n">dg</span><span class="o">.</span><span class="n">feedback_edge_set</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">l</span><span class="p">)</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">edge_iterator</span><span class="p">())</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">feedback</span> <span class="ow">or</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">u</span><span class="p">)</span> <span class="ow">in</span> <span class="n">feedback</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Comparing with/without constraint generation. Also double-checks ticket <a class="reference external" href="http://trac.sagemath.org/12833">trac ticket #12833</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
<span class="gp">... </span>     <span class="n">g</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">RandomDirectedGNP</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="o">.</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">... </span>     <span class="n">x</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">feedback_edge_set</span><span class="p">(</span><span class="n">value_only</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">... </span>     <span class="n">y</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">feedback_edge_set</span><span class="p">(</span><span class="n">value_only</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">constraint_generation</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
<span class="gp">... </span>     <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">y</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">print</span> <span class="s">&quot;Oh my, oh my !&quot;</span>
<span class="gp">... </span>        <span class="k">break</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.flow_polytope">
<tt class="descname">flow_polytope</tt><big>(</big><em>edges=None</em>, <em>ends=None</em><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.flow_polytope" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the flow polytope of a digraph.</p>
<p>The flow polytope of a directed graph is the polytope
consisting of all nonnegative flows on the graph with
a given set <span class="math">\(S\)</span> of sources and a given set <span class="math">\(T\)</span> of sinks.</p>
<p>A <em>flow</em> on a directed graph <span class="math">\(G\)</span> with a given set <span class="math">\(S\)</span> of
sources and a given set <span class="math">\(T\)</span> of sinks means an assignment
of a nonnegative real to each edge of <span class="math">\(G\)</span> such that the
flow is conserved in each vertex outside of <span class="math">\(S\)</span> and <span class="math">\(T\)</span>,
and there is a unit of flow entering each vertex in <span class="math">\(S\)</span>
and a unit of flow leaving each vertex in <span class="math">\(T\)</span>. These
flows clearly form a polytope in the space of all
assignments of reals to the edges of <span class="math">\(G\)</span>.</p>
<p>The polytope is empty unless the sets <span class="math">\(S\)</span> and <span class="math">\(T\)</span> are
equinumerous.</p>
<p>By default, <span class="math">\(S\)</span> is taken to be the set of all sources
(i.e., vertices of indegree <span class="math">\(0\)</span>) of <span class="math">\(G\)</span>, and <span class="math">\(T\)</span> is taken
to be the set of all sinks (i.e., vertices of outdegree
<span class="math">\(0\)</span>) of <span class="math">\(G\)</span>. If a different choice of <span class="math">\(S\)</span> and <span class="math">\(T\)</span> is
desired, it can be specified using the optional <tt class="docutils literal"><span class="pre">ends</span></tt> parameter.</p>
<p>The polytope is returned as a polytope in <span class="math">\(\RR^m\)</span>, where
<span class="math">\(m\)</span> is the number of edges of the digraph <tt class="docutils literal"><span class="pre">self</span></tt>. The
<span class="math">\(k\)</span>-th coordinate of a point in the polytope is the real
assigned to the <span class="math">\(k\)</span>-th edge of <tt class="docutils literal"><span class="pre">self</span></tt>. The order of the
edges is the one returned by <tt class="docutils literal"><span class="pre">self.edges()</span></tt>. If a
different order is desired, it can be specified using the
optional <tt class="docutils literal"><span class="pre">edges</span></tt> parameter.</p>
<p>The faces and volume of these polytopes are of interest. Examples of
these polytopes are the Chan-Robbins-Yuen polytope and the
Pitman-Stanley polytope <a class="reference internal" href="#pitsta" id="id1">[PitSta]</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">edges</span></tt> &#8211; (optional, default: <tt class="docutils literal"><span class="pre">self.edges()</span></tt>) a list or tuple
of all edges of <tt class="docutils literal"><span class="pre">self</span></tt> (each only once). This
determines which coordinate of a point in the polytope will
correspond to which edge of <tt class="docutils literal"><span class="pre">self</span></tt>. It is also possible
to specify a list which contains not all edges of <tt class="docutils literal"><span class="pre">self</span></tt>;
this results in a polytope corresponding to the flows which
are <span class="math">\(0\)</span> on all remaining edges. Notice that the edges
entered here must be in the precisely same format as
outputted by <tt class="docutils literal"><span class="pre">self.edges()</span></tt>; so, if <tt class="docutils literal"><span class="pre">self.edges()</span></tt>
outputs an edge in the form <tt class="docutils literal"><span class="pre">(1,</span> <span class="pre">3,</span> <span class="pre">None)</span></tt>, then
<tt class="docutils literal"><span class="pre">(1,</span> <span class="pre">3)</span></tt> will not do!</li>
<li><tt class="docutils literal"><span class="pre">ends</span></tt> &#8211; (optional, default: <tt class="docutils literal"><span class="pre">(self.sources(),</span> <span class="pre">self.sinks())</span></tt>)
a pair <span class="math">\((S, T)\)</span> of an iterable <span class="math">\(S\)</span> and an iterable <span class="math">\(T\)</span>.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Flow polytopes can also be built through the <tt class="docutils literal"><span class="pre">polytopes.&lt;tab&gt;</span></tt>
object:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">polytopes</span><span class="o">.</span><span class="n">flow_polytope</span><span class="p">(</span><span class="n">digraphs</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">A 0-dimensional polyhedron in QQ^4 defined as the convex hull of 1 vertex</span>
</pre></div>
</div>
</div>
<p>EXAMPLES:</p>
<p>A commutative square:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">fl</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">flow_polytope</span><span class="p">();</span> <span class="n">fl</span>
<span class="go">A 1-dimensional polyhedron in QQ^4 defined as the convex hull</span>
<span class="go">of 2 vertices</span>
<span class="gp">sage: </span><span class="n">fl</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">(A vertex at (0, 1, 0, 1), A vertex at (1, 0, 1, 0))</span>
</pre></div>
</div>
<p>Using a different order for the edges of the graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">fl</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">flow_polytope</span><span class="p">(</span><span class="n">edges</span><span class="o">=</span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span> <span class="n">fl</span>
<span class="go">A 1-dimensional polyhedron in QQ^4 defined as the convex hull</span>
<span class="go">of 2 vertices</span>
<span class="gp">sage: </span><span class="n">fl</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">(A vertex at (0, 1, 1, 0), A vertex at (1, 0, 0, 1))</span>
</pre></div>
</div>
<p>A tournament on 4 vertices:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">TransitiveTournament</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fl</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">flow_polytope</span><span class="p">();</span> <span class="n">fl</span>
<span class="go">A 3-dimensional polyhedron in QQ^6 defined as the convex hull</span>
<span class="go">of 4 vertices</span>
<span class="gp">sage: </span><span class="n">fl</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">(A vertex at (0, 0, 1, 0, 0, 0),</span>
<span class="go"> A vertex at (0, 1, 0, 0, 0, 1),</span>
<span class="go"> A vertex at (1, 0, 0, 0, 1, 0),</span>
<span class="go"> A vertex at (1, 0, 0, 1, 0, 1))</span>
</pre></div>
</div>
<p>Restricting to a subset of the edges:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">fl</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">flow_polytope</span><span class="p">(</span><span class="n">edges</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
<span class="go">....:                             (2, 3, None), (0, 3, None)])</span>
<span class="gp">sage: </span><span class="n">fl</span>
<span class="go">A 1-dimensional polyhedron in QQ^4 defined as the convex hull</span>
<span class="go">of 2 vertices</span>
<span class="gp">sage: </span><span class="n">fl</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">(A vertex at (0, 0, 0, 1), A vertex at (1, 1, 1, 0))</span>
</pre></div>
</div>
<p>Using a different choice of sources and sinks:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">fl</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">flow_polytope</span><span class="p">(</span><span class="n">ends</span><span class="o">=</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">]));</span> <span class="n">fl</span>
<span class="go">A 1-dimensional polyhedron in QQ^6 defined as the convex hull</span>
<span class="go">of 2 vertices</span>
<span class="gp">sage: </span><span class="n">fl</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">(A vertex at (0, 0, 0, 1, 0, 1), A vertex at (0, 0, 0, 0, 1, 0))</span>
<span class="gp">sage: </span><span class="n">fl</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">flow_polytope</span><span class="p">(</span><span class="n">ends</span><span class="o">=</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">]));</span> <span class="n">fl</span>
<span class="go">The empty polyhedron in QQ^6</span>
<span class="gp">sage: </span><span class="n">fl</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">flow_polytope</span><span class="p">(</span><span class="n">ends</span><span class="o">=</span><span class="p">([</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]));</span> <span class="n">fl</span>
<span class="go">The empty polyhedron in QQ^6</span>
<span class="gp">sage: </span><span class="n">fl</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">flow_polytope</span><span class="p">(</span><span class="n">ends</span><span class="o">=</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]));</span> <span class="n">fl</span>
<span class="go">A 3-dimensional polyhedron in QQ^6 defined as the convex hull</span>
<span class="go">of 5 vertices</span>
<span class="gp">sage: </span><span class="n">fl</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">(A vertex at (0, 0, 1, 1, 0, 0),</span>
<span class="go"> A vertex at (0, 1, 0, 0, 1, 0),</span>
<span class="go"> A vertex at (1, 0, 0, 2, 0, 1),</span>
<span class="go"> A vertex at (1, 0, 0, 1, 1, 0),</span>
<span class="go"> A vertex at (0, 1, 0, 1, 0, 1))</span>
<span class="gp">sage: </span><span class="n">fl</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">flow_polytope</span><span class="p">(</span><span class="n">edges</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
<span class="go">....:                             (2, 3, None), (0, 2, None),</span>
<span class="go">....:                             (1, 3, None)],</span>
<span class="go">....:                      ends=([0, 1], [2, 3])); fl</span>
<span class="go">A 2-dimensional polyhedron in QQ^5 defined as the convex hull</span>
<span class="go">of 4 vertices</span>
<span class="gp">sage: </span><span class="n">fl</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">(A vertex at (0, 0, 0, 1, 1),</span>
<span class="go"> A vertex at (1, 2, 1, 0, 0),</span>
<span class="go"> A vertex at (1, 1, 0, 0, 1),</span>
<span class="go"> A vertex at (0, 1, 1, 1, 0))</span>
</pre></div>
</div>
<p>A digraph with one source and two sinks:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="o">.</span><span class="n">flow_polytope</span><span class="p">()</span>
<span class="go">The empty polyhedron in QQ^3</span>
</pre></div>
</div>
<p>A digraph with one vertex and no edge:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Z</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="p">[]})</span>
<span class="gp">sage: </span><span class="n">Z</span><span class="o">.</span><span class="n">flow_polytope</span><span class="p">()</span>
<span class="go">A 0-dimensional polyhedron in QQ^0 defined as the convex hull</span>
<span class="go">of 1 vertex</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="pitsta" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[PitSta]</a></td><td>Jim Pitman, Richard Stanley, &#8220;A polytope related to
empirical distributions, plane trees, parking functions, and
the associahedron&#8221;, <a class="reference external" href="http://arxiv.org/abs/math/9908029">Arxiv math/9908029</a></td></tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.in_degree">
<tt class="descname">in_degree</tt><big>(</big><em>vertices=None</em>, <em>labels=False</em><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.in_degree" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as degree, but for in degree.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">in_degree</span><span class="p">(</span><span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">{0: 2, 1: 2, 2: 2}</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">in_degree</span><span class="p">()</span>
<span class="go">[2, 2, 2, 2, 1, 1]</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">in_degree</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.in_degree_iterator">
<tt class="descname">in_degree_iterator</tt><big>(</big><em>vertices=None</em>, <em>labels=False</em><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.in_degree_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as degree_iterator, but for in degree.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">Grid2dGraph</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">in_degree_iterator</span><span class="p">():</span>
<span class="gp">... </span>   <span class="k">print</span> <span class="n">i</span>
<span class="go">3</span>
<span class="go">3</span>
<span class="go">2</span>
<span class="go">2</span>
<span class="go">3</span>
<span class="go">2</span>
<span class="go">2</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">in_degree_iterator</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
<span class="gp">... </span>   <span class="k">print</span> <span class="n">i</span>
<span class="go">((0, 1), 3)</span>
<span class="go">((1, 2), 3)</span>
<span class="go">((0, 0), 2)</span>
<span class="go">((0, 3), 2)</span>
<span class="go">((1, 1), 3)</span>
<span class="go">((1, 3), 2)</span>
<span class="go">((1, 0), 2)</span>
<span class="go">((0, 2), 3)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.in_degree_sequence">
<tt class="descname">in_degree_sequence</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.in_degree_sequence" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the indegree sequence.</p>
<p>EXAMPLES:</p>
<p>The indegree sequences of two digraphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">in_degree_sequence</span><span class="p">()</span>
<span class="go">[5, 2, 1, 1, 1, 0]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="p">[[],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">11</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">E</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">in_degree_sequence</span><span class="p">()</span>
<span class="go">[2, 2, 2, 2, 1, 0, 0, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.incoming_edge_iterator">
<tt class="descname">incoming_edge_iterator</tt><big>(</big><em>vertices</em>, <em>labels=True</em><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.incoming_edge_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an iterator over all arriving edges from vertices.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">vertices</span></tt> &#8211; a vertex or a list of vertices</li>
<li><tt class="docutils literal"><span class="pre">labels</span></tt> (boolean) &#8211; whether to return edges as pairs of vertices,
or as triples containing the labels.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">incoming_edge_iterator</span><span class="p">([</span><span class="mi">0</span><span class="p">]):</span>
<span class="gp">... </span>   <span class="k">print</span> <span class="n">a</span>
<span class="go">(1, 0, None)</span>
<span class="go">(4, 0, None)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.incoming_edges">
<tt class="descname">incoming_edges</tt><big>(</big><em>vertices</em>, <em>labels=True</em><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.incoming_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of edges arriving at vertices.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">vertices</span></tt> &#8211; a vertex or a list of vertices</li>
<li><tt class="docutils literal"><span class="pre">labels</span></tt> (boolean) &#8211; whether to return edges as pairs of vertices,
or as triples containing the labels.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">incoming_edges</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
<span class="go">[(1, 0, None), (4, 0, None)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.is_aperiodic">
<tt class="descname">is_aperiodic</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.is_aperiodic" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether the current <tt class="docutils literal"><span class="pre">DiGraph</span></tt> is aperiodic.</p>
<p>A directed graph is aperiodic if there is no integer <tt class="docutils literal"><span class="pre">k</span> <span class="pre">&gt;</span> <span class="pre">1</span></tt>
that divides the length of every cycle in the graph, cf.
<a class="reference external" href="https://en.wikipedia.org/wiki/Aperiodic_graph">Wikipedia article Aperiodic_graph</a>.</p>
<p>EXAMPLES:</p>
<p>The following graph has period <tt class="docutils literal"><span class="pre">2</span></tt>, so it is not aperiodic:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">})</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_aperiodic</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>The following graph has a cycle of length 2 and a cycle of length 3,
so it is aperiodic:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_aperiodic</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.graphs.digraph.DiGraph.period" title="sage.graphs.digraph.DiGraph.period"><tt class="xref py py-meth docutils literal"><span class="pre">period()</span></tt></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.is_directed">
<tt class="descname">is_directed</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.is_directed" title="Permalink to this definition">¶</a></dt>
<dd><p>Since digraph is directed, returns True.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">DiGraph</span><span class="p">()</span><span class="o">.</span><span class="n">is_directed</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.is_directed_acyclic">
<tt class="descname">is_directed_acyclic</tt><big>(</big><em>certificate=False</em><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.is_directed_acyclic" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns whether the digraph is acyclic or not.</p>
<p>A directed graph is acyclic if for any vertex <span class="math">\(v\)</span>, there is no directed
path that starts and ends at <span class="math">\(v\)</span>. Every directed acyclic graph (DAG)
corresponds to a partial ordering of its vertices, however multiple dags
may lead to the same partial ordering.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">certificate</span></tt> &#8211; whether to return a certificate (<tt class="docutils literal"><span class="pre">False</span></tt> by
default).</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>When <tt class="docutils literal"><span class="pre">certificate=False</span></tt>, returns a boolean value.</li>
<li>When <tt class="docutils literal"><span class="pre">certificate=True</span></tt>:<ul>
<li>If the graph is acyclic, returns a pair <tt class="docutils literal"><span class="pre">(True,</span> <span class="pre">ordering)</span></tt>
where <tt class="docutils literal"><span class="pre">ordering</span></tt> is a list of the vertices such that <tt class="docutils literal"><span class="pre">u</span></tt>
appears before <tt class="docutils literal"><span class="pre">v</span></tt> in <tt class="docutils literal"><span class="pre">ordering</span></tt> if <tt class="docutils literal"><span class="pre">u,</span> <span class="pre">v</span></tt> is an edge.</li>
<li>Else, returns a pair <tt class="docutils literal"><span class="pre">(False,</span> <span class="pre">cycle)</span></tt> where <tt class="docutils literal"><span class="pre">cycle</span></tt> is a
list of vertices representing a circuit in the graph.</li>
</ul>
</li>
</ul>
<p>EXAMPLES:</p>
<p>At first, the following graph is acyclic:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span> <span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">4</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">8</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">7</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">7</span><span class="p">],</span> <span class="mi">5</span><span class="p">:[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="mi">7</span><span class="p">:[</span><span class="mi">8</span><span class="p">],</span> <span class="mi">6</span><span class="p">:[</span><span class="mi">9</span><span class="p">],</span> <span class="mi">8</span><span class="p">:[</span><span class="mi">10</span><span class="p">],</span> <span class="mi">9</span><span class="p">:[</span><span class="mi">10</span><span class="p">]</span> <span class="p">})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="s">&#39;circular&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_directed_acyclic</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Adding an edge from <span class="math">\(9\)</span> to <span class="math">\(7\)</span> does not change it:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_directed_acyclic</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We can obtain as a proof an ordering of the vertices such that <span class="math">\(u\)</span>
appears before <span class="math">\(v\)</span> if <span class="math">\(uv\)</span> is an edge of the graph:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_directed_acyclic</span><span class="p">(</span><span class="n">certificate</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">(True, [4, 5, 6, 9, 0, 1, 2, 3, 7, 8, 10])</span>
</pre></div>
</div>
<p>Adding an edge from 7 to 4, though, makes a difference:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_directed_acyclic</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Indeed, it creates a circuit <span class="math">\(7, 4, 5\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_directed_acyclic</span><span class="p">(</span><span class="n">certificate</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">(False, [7, 4, 5])</span>
</pre></div>
</div>
<p>Checking acyclic graphs are indeed acyclic</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">def</span> <span class="nf">random_acyclic</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="gp">... </span>   <span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomGNP</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="gp">... </span>   <span class="n">h</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">()</span>
<span class="gp">... </span>   <span class="n">h</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([</span> <span class="p">((</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="k">if</span> <span class="n">u</span><span class="o">&lt;</span><span class="n">v</span> <span class="k">else</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">u</span><span class="p">))</span> <span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span> <span class="p">])</span>
<span class="gp">... </span>   <span class="k">return</span> <span class="n">h</span>
<span class="gp">...</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span> <span class="n">random_acyclic</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="o">.</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_directed_acyclic</span><span class="p">()</span>    <span class="c"># long time</span>
<span class="gp">... </span>       <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span>                              <span class="c"># long time</span>
<span class="go">True</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>What about loops?</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">ButterflyGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">allow_loops</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_directed_acyclic</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_directed_acyclic</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.is_strongly_connected">
<tt class="descname">is_strongly_connected</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.is_strongly_connected" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns whether the current <tt class="docutils literal"><span class="pre">DiGraph</span></tt> is strongly connected.</p>
<p>EXAMPLE:</p>
<p>The circuit is obviously strongly connected</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">Circuit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_strongly_connected</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>But a transitive triangle is not:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span> <span class="mi">0</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">1</span> <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_strongly_connected</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.is_transitive">
<tt class="descname">is_transitive</tt><big>(</big><em>g</em>, <em>certificate=False</em><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.is_transitive" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests whether the digraph is transitive.</p>
<p>A digraph is transitive if for any pair of vertices <span class="math">\(u,v\in G\)</span> linked by a
<span class="math">\(uv\)</span>-path the edge <span class="math">\(uv\)</span> belongs to <span class="math">\(G\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">certificate</span></tt> &#8211; whether to return a certificate for negative answers.<ul>
<li>If <tt class="docutils literal"><span class="pre">certificate</span> <span class="pre">=</span> <span class="pre">False</span></tt> (default), this method returns <tt class="docutils literal"><span class="pre">True</span></tt> or
<tt class="docutils literal"><span class="pre">False</span></tt> according to the graph.</li>
<li>If <tt class="docutils literal"><span class="pre">certificate</span> <span class="pre">=</span> <span class="pre">True</span></tt>, this method either returns <tt class="docutils literal"><span class="pre">True</span></tt> answers
or yield a pair of vertices <span class="math">\(uv\)</span> such that there exists a <span class="math">\(uv\)</span>-path in
<span class="math">\(G\)</span> but <span class="math">\(uv\not\in G\)</span>.</li>
</ul>
</li>
</ul>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">digraphs</span><span class="o">.</span><span class="n">Circuit</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">is_transitive</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">digraphs</span><span class="o">.</span><span class="n">Circuit</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">is_transitive</span><span class="p">(</span><span class="n">certificate</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">(0, 2)</span>
<span class="gp">sage: </span><span class="n">digraphs</span><span class="o">.</span><span class="n">RandomDirectedGNP</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="o">.</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_transitive</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">digraphs</span><span class="o">.</span><span class="n">DeBruijn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_transitive</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">digraphs</span><span class="o">.</span><span class="n">DeBruijn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_transitive</span><span class="p">(</span><span class="n">certificate</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">(&#39;00&#39;, &#39;10&#39;)</span>
<span class="gp">sage: </span><span class="n">digraphs</span><span class="o">.</span><span class="n">RandomDirectedGNP</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="o">.</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">transitive_closure</span><span class="p">()</span><span class="o">.</span><span class="n">is_transitive</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.layout_acyclic">
<tt class="descname">layout_acyclic</tt><big>(</big><em>rankdir='up'</em>, <em>**options</em><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.layout_acyclic" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a ranked layout so that all edges point upward.</p>
<p>To this end, the heights of the vertices are set according to the level
set decomposition of the graph (see <a class="reference internal" href="#sage.graphs.digraph.DiGraph.level_sets" title="sage.graphs.digraph.DiGraph.level_sets"><tt class="xref py py-meth docutils literal"><span class="pre">level_sets()</span></tt></a>).</p>
<p>This is achieved by calling <tt class="docutils literal"><span class="pre">graphviz</span></tt> and <tt class="docutils literal"><span class="pre">dot2tex</span></tt> if
available (see <a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.layout_graphviz" title="sage.graphs.generic_graph.GenericGraph.layout_graphviz"><tt class="xref py py-meth docutils literal"><span class="pre">layout_graphviz()</span></tt></a>), and using a spring
layout with fixed vertical placement of the vertices otherwise
(see <a class="reference internal" href="#sage.graphs.digraph.DiGraph.layout_acyclic_dummy" title="sage.graphs.digraph.DiGraph.layout_acyclic_dummy"><tt class="xref py py-meth docutils literal"><span class="pre">layout_acyclic_dummy()</span></tt></a> and
<a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.layout_ranked" title="sage.graphs.generic_graph.GenericGraph.layout_ranked"><tt class="xref py py-meth docutils literal"><span class="pre">layout_ranked()</span></tt></a>).</p>
<p>Non acyclic graphs are partially supported by <tt class="docutils literal"><span class="pre">graphviz</span></tt>, which then
chooses some edges to point down.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">rankdir</span></tt> &#8211; &#8216;up&#8217;, &#8216;down&#8217;, &#8216;left&#8217;, or &#8216;right&#8217; (default: &#8216;up&#8217;):
which direction the edges should point toward</li>
<li><tt class="docutils literal"><span class="pre">**options</span></tt> &#8211; passed down to
<a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.layout_ranked" title="sage.graphs.generic_graph.GenericGraph.layout_ranked"><tt class="xref py py-meth docutils literal"><span class="pre">layout_ranked()</span></tt></a> or
<a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.layout_graphviz" title="sage.graphs.generic_graph.GenericGraph.layout_graphviz"><tt class="xref py py-meth docutils literal"><span class="pre">layout_graphviz()</span></tt></a></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">3</span><span class="p">],</span><span class="mi">2</span><span class="p">:[</span><span class="mi">3</span><span class="p">],</span><span class="mi">3</span><span class="p">:[],</span><span class="mi">5</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span><span class="mi">6</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]})</span>
</pre></div>
</div>
<p>The actual layout computed depends on whether dot2tex and
graphviz are installed, so we don&#8217;t test its relative values:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">layout_acyclic</span><span class="p">()</span>
<span class="go">{0: [..., ...], 1: [..., ...], 2: [..., ...], 3: [..., ...], 5: [..., ...], 6: [..., ...]}</span>

<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">pos</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">layout_acyclic</span><span class="p">(</span><span class="n">rankdir</span><span class="o">=</span><span class="s">&#39;up&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="o">.</span><span class="mi">5</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">pos</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">layout_acyclic</span><span class="p">(</span><span class="n">rankdir</span><span class="o">=</span><span class="s">&#39;down&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">pos</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">layout_acyclic</span><span class="p">(</span><span class="n">rankdir</span><span class="o">=</span><span class="s">&#39;right&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="o">.</span><span class="mi">5</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">pos</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">layout_acyclic</span><span class="p">(</span><span class="n">rankdir</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.layout_acyclic_dummy">
<tt class="descname">layout_acyclic_dummy</tt><big>(</big><em>heights=None</em>, <em>rankdir='up'</em>, <em>**options</em><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.layout_acyclic_dummy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a ranked layout so that all edges point upward.</p>
<p>To this end, the heights of the vertices are set according to
the level set decomposition of the graph (see
<a class="reference internal" href="#sage.graphs.digraph.DiGraph.level_sets" title="sage.graphs.digraph.DiGraph.level_sets"><tt class="xref py py-meth docutils literal"><span class="pre">level_sets()</span></tt></a>). This is achieved by a spring layout with
fixed vertical placement of the vertices otherwise (see
<a class="reference internal" href="#sage.graphs.digraph.DiGraph.layout_acyclic_dummy" title="sage.graphs.digraph.DiGraph.layout_acyclic_dummy"><tt class="xref py py-meth docutils literal"><span class="pre">layout_acyclic_dummy()</span></tt></a> and
<a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.layout_ranked" title="sage.graphs.generic_graph.GenericGraph.layout_ranked"><tt class="xref py py-meth docutils literal"><span class="pre">layout_ranked()</span></tt></a>).</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">rankdir</span></tt> &#8211; &#8216;up&#8217;, &#8216;down&#8217;, &#8216;left&#8217;, or &#8216;right&#8217; (default: &#8216;up&#8217;):
which direction the edges should point toward</li>
<li><tt class="docutils literal"><span class="pre">**options</span></tt> &#8211; passed down to
<a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.layout_ranked" title="sage.graphs.generic_graph.GenericGraph.layout_ranked"><tt class="xref py py-meth docutils literal"><span class="pre">layout_ranked()</span></tt></a></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">3</span><span class="p">],</span><span class="mi">2</span><span class="p">:[</span><span class="mi">3</span><span class="p">],</span><span class="mi">3</span><span class="p">:[],</span><span class="mi">5</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span><span class="mi">6</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">layout_acyclic_dummy</span><span class="p">()</span>
<span class="go">{0: [1.00..., 0], 1: [1.00..., 1], 2: [1.51..., 2], 3: [1.50..., 3], 5: [2.01..., 0], 6: [2.00..., 1]}</span>

<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">layout_acyclic_dummy</span><span class="p">(</span><span class="n">rankdir</span><span class="o">=</span><span class="s">&#39;up&#39;</span><span class="p">)</span>
<span class="go">{0: [0.5..., 0], 1: [0.5..., 1]}</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">layout_acyclic_dummy</span><span class="p">(</span><span class="n">rankdir</span><span class="o">=</span><span class="s">&#39;down&#39;</span><span class="p">)</span>
<span class="go">{0: [0.5..., 1], 1: [0.5..., 0]}</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">layout_acyclic_dummy</span><span class="p">(</span><span class="n">rankdir</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">)</span>
<span class="go">{0: [1, 0.5...], 1: [0, 0.5...]}</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">layout_acyclic_dummy</span><span class="p">(</span><span class="n">rankdir</span><span class="o">=</span><span class="s">&#39;right&#39;</span><span class="p">)</span>
<span class="go">{0: [0, 0.5...], 1: [1, 0.5...]}</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">3</span><span class="p">],</span><span class="mi">2</span><span class="p">:[</span><span class="mi">3</span><span class="p">],</span><span class="mi">3</span><span class="p">:[</span><span class="mi">1</span><span class="p">],</span><span class="mi">5</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span><span class="mi">6</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">layout_acyclic_dummy</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">`self` should be an acyclic graph</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.level_sets">
<tt class="descname">level_sets</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.level_sets" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the level set decomposition of the digraph.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>a list of non empty lists of vertices of this graph</li>
</ul>
<p>The level set decomposition of the digraph is a list <span class="math">\(l\)</span> such that the
level <span class="math">\(l[i]\)</span> contains all the vertices having all their predecessors in
the levels <span class="math">\(l[j]\)</span> for <span class="math">\(j&lt;i\)</span>, and at least one in level <span class="math">\(l[i-1]\)</span> (unless
<span class="math">\(i=0\)</span>).</p>
<p>The level decomposition contains exactly the vertices not occuring in
any cycle of the graph. In particular, the graph is acyclic if and only
if the decomposition forms a set partition of its vertices, and we
recover the usual level set decomposition of the corresponding poset.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">3</span><span class="p">],</span><span class="mi">2</span><span class="p">:[</span><span class="mi">3</span><span class="p">],</span><span class="mi">3</span><span class="p">:[],</span><span class="mi">5</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span><span class="mi">6</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">level_sets</span><span class="p">()</span>
<span class="go">[[0, 5], [1, 6], [2], [3]]</span>

<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">3</span><span class="p">],</span><span class="mi">2</span><span class="p">:[</span><span class="mi">3</span><span class="p">],</span><span class="mi">3</span><span class="p">:[</span><span class="mi">1</span><span class="p">],</span><span class="mi">5</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span><span class="mi">6</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">level_sets</span><span class="p">()</span>
<span class="go">[[0, 5], [6], [2]]</span>
</pre></div>
</div>
<p>This routine is mostly used for Hasse diagrams of posets:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.posets.hasse_diagram</span> <span class="kn">import</span> <span class="n">HasseDiagram</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">HasseDiagram</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">3</span><span class="p">],</span><span class="mi">2</span><span class="p">:[</span><span class="mi">3</span><span class="p">],</span><span class="mi">3</span><span class="p">:[]})</span>
<span class="gp">sage: </span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">H</span><span class="o">.</span><span class="n">level_sets</span><span class="p">()]</span>
<span class="go">[1, 2, 1]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.posets.hasse_diagram</span> <span class="kn">import</span> <span class="n">HasseDiagram</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">HasseDiagram</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">4</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">H</span><span class="o">.</span><span class="n">level_sets</span><span class="p">()]</span>
<span class="go">[1, 2, 1, 1]</span>
</pre></div>
</div>
<p>Complexity: <span class="math">\(O(n+m)\)</span> in time and <span class="math">\(O(n)\)</span> in memory (besides the
storage of the graph itself), where <span class="math">\(n\)</span> and <span class="math">\(m\)</span> are
respectively the number of vertices and edges (assuming that
appending to a list is constant time, which it is not quite).</p>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.neighbor_in_iterator">
<tt class="descname">neighbor_in_iterator</tt><big>(</big><em>vertex</em><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.neighbor_in_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an iterator over the in-neighbors of vertex.</p>
<p>An vertex <span class="math">\(u\)</span> is an in-neighbor of a vertex <span class="math">\(v\)</span> if <span class="math">\(uv\)</span> in an edge.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">neighbor_in_iterator</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>
<span class="gp">... </span>   <span class="k">print</span> <span class="n">a</span>
<span class="go">1</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.neighbor_out_iterator">
<tt class="descname">neighbor_out_iterator</tt><big>(</big><em>vertex</em><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.neighbor_out_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an iterator over the out-neighbors of a given vertex.</p>
<p>An vertex <span class="math">\(u\)</span> is an out-neighbor of a vertex <span class="math">\(v\)</span> if <span class="math">\(vu\)</span> in an edge.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">neighbor_out_iterator</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>
<span class="gp">... </span>   <span class="k">print</span> <span class="n">a</span>
<span class="go">1</span>
<span class="go">2</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.neighbors_in">
<tt class="descname">neighbors_in</tt><big>(</big><em>vertex</em><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.neighbors_in" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of the in-neighbors of a given vertex.</p>
<p>An vertex <span class="math">\(u\)</span> is an in-neighbor of a vertex <span class="math">\(v\)</span> if <span class="math">\(uv\)</span> in an edge.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">neighbors_in</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[1, 4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.neighbors_out">
<tt class="descname">neighbors_out</tt><big>(</big><em>vertex</em><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.neighbors_out" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of the out-neighbors of a given vertex.</p>
<p>An vertex <span class="math">\(u\)</span> is an out-neighbor of a vertex <span class="math">\(v\)</span> if <span class="math">\(vu\)</span> in an edge.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">neighbors_out</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[1, 2, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.out_degree">
<tt class="descname">out_degree</tt><big>(</big><em>vertices=None</em>, <em>labels=False</em><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.out_degree" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as degree, but for out degree.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">out_degree</span><span class="p">(</span><span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">{0: 3, 1: 2, 2: 1}</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">out_degree</span><span class="p">()</span>
<span class="go">[3, 2, 1, 1, 2, 1]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">out_degree</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.out_degree_iterator">
<tt class="descname">out_degree_iterator</tt><big>(</big><em>vertices=None</em>, <em>labels=False</em><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.out_degree_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as degree_iterator, but for out degree.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">Grid2dGraph</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">out_degree_iterator</span><span class="p">():</span>
<span class="gp">... </span>   <span class="k">print</span> <span class="n">i</span>
<span class="go">3</span>
<span class="go">3</span>
<span class="go">2</span>
<span class="go">2</span>
<span class="go">3</span>
<span class="go">2</span>
<span class="go">2</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">out_degree_iterator</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
<span class="gp">... </span>   <span class="k">print</span> <span class="n">i</span>
<span class="go">((0, 1), 3)</span>
<span class="go">((1, 2), 3)</span>
<span class="go">((0, 0), 2)</span>
<span class="go">((0, 3), 2)</span>
<span class="go">((1, 1), 3)</span>
<span class="go">((1, 3), 2)</span>
<span class="go">((1, 0), 2)</span>
<span class="go">((0, 2), 3)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.out_degree_sequence">
<tt class="descname">out_degree_sequence</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.out_degree_sequence" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the outdegree sequence of this digraph.</p>
<p>EXAMPLES:</p>
<p>The outdegree sequences of two digraphs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">out_degree_sequence</span><span class="p">()</span>
<span class="go">[3, 2, 2, 2, 1, 0]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="p">[[],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">11</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">E</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">out_degree_sequence</span><span class="p">()</span>
<span class="go">[3, 2, 2, 1, 1, 0, 0, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.outgoing_edge_iterator">
<tt class="descname">outgoing_edge_iterator</tt><big>(</big><em>vertices</em>, <em>labels=True</em><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.outgoing_edge_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an iterator over all departing edges from vertices.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">vertices</span></tt> &#8211; a vertex or a list of vertices</li>
<li><tt class="docutils literal"><span class="pre">labels</span></tt> (boolean) &#8211; whether to return edges as pairs of vertices,
or as triples containing the labels.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">outgoing_edge_iterator</span><span class="p">([</span><span class="mi">0</span><span class="p">]):</span>
<span class="gp">... </span>   <span class="k">print</span> <span class="n">a</span>
<span class="go">(0, 1, None)</span>
<span class="go">(0, 2, None)</span>
<span class="go">(0, 3, None)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.outgoing_edges">
<tt class="descname">outgoing_edges</tt><big>(</big><em>vertices</em>, <em>labels=True</em><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.outgoing_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of edges departing from vertices.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">vertices</span></tt> &#8211; a vertex or a list of vertices</li>
<li><tt class="docutils literal"><span class="pre">labels</span></tt> (boolean) &#8211; whether to return edges as pairs of vertices,
or as triples containing the labels.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">outgoing_edges</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
<span class="go">[(0, 1, None), (0, 2, None), (0, 3, None)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.path_semigroup">
<tt class="descname">path_semigroup</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.path_semigroup" title="Permalink to this definition">¶</a></dt>
<dd><p>The partial semigroup formed by the paths of this quiver.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">1</span><span class="p">:{</span><span class="mi">2</span><span class="p">:[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">]},</span> <span class="mi">2</span><span class="p">:{</span><span class="mi">3</span><span class="p">:[</span><span class="s">&#39;b&#39;</span><span class="p">]}})</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">path_semigroup</span><span class="p">();</span> <span class="n">F</span>
<span class="go">Partial semigroup formed by the directed paths of Multi-digraph on 3 vertices</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="go">[e_1, e_2, e_3, a, c, b, a*b, c*b]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.period">
<tt class="descname">period</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.period" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the period of the current <tt class="docutils literal"><span class="pre">DiGraph</span></tt>.</p>
<p>The period of a directed graph is the largest integer that
divides the length of every cycle in the graph, cf.
<a class="reference external" href="https://en.wikipedia.org/wiki/Aperiodic_graph">Wikipedia article Aperiodic_graph</a>.</p>
<p>EXAMPLES:</p>
<p>The following graph has period <tt class="docutils literal"><span class="pre">2</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">period</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p>The following graph has a cycle of length 2 and a cycle of length 3,
so it has period <tt class="docutils literal"><span class="pre">1</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">period</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Here is an example of computing the period of a digraph which is
not strongly connected. By definition, it is the <a class="reference external" href="../../../rings_standard/sage/arith/misc.html#sage.arith.misc.gcd" title="(in Sage Reference Manual: Standard Commutative Rings v7.0)"><tt class="xref py py-func docutils literal"><span class="pre">gcd()</span></tt></a> of
the periods of its strongly connected components:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="go">....:     1: [2], 2: [1]})</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">period</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">period</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span>
<span class="go">....:         in g.strongly_connected_components_subgraphs()])</span>
<span class="go">[2, 3]</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>See the networkX implementation of <tt class="docutils literal"><span class="pre">is_aperiodic</span></tt>, that is based
on breadth first search.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.graphs.digraph.DiGraph.is_aperiodic" title="sage.graphs.digraph.DiGraph.is_aperiodic"><tt class="xref py py-meth docutils literal"><span class="pre">is_aperiodic()</span></tt></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.reverse">
<tt class="descname">reverse</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.reverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of digraph with edges reversed in direction.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
<span class="go">Reverse of (): Digraph on 6 vertices</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.reverse_edge">
<tt class="descname">reverse_edge</tt><big>(</big><em>u</em>, <em>v=None</em>, <em>label=None</em>, <em>inplace=True</em>, <em>multiedges=None</em><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.reverse_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>Reverses the edge from u to v.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">inplace</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">True</span></tt>) if <tt class="docutils literal"><span class="pre">False</span></tt>, a new
digraph is created and returned as output, otherwise
<tt class="docutils literal"><span class="pre">self</span></tt> is modified.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">multiedges</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">None</span></tt>) how to decide what
should be done in case of doubt (for instance when edge
<span class="math">\((1,2)\)</span> is to be reversed in a graph while <span class="math">\((2,1)\)</span> already
exists):</p>
<ul class="simple">
<li>If set to <tt class="docutils literal"><span class="pre">True</span></tt>, input graph will be forced to allow
parallel edges if necessary and edge <span class="math">\((1,2)\)</span> will appear
twice in the graph.</li>
<li>If set to <tt class="docutils literal"><span class="pre">False</span></tt>, only one edge <span class="math">\((1,2)\)</span> will remain
in the graph after <span class="math">\((2,1)\)</span> is reversed. Besides, the
label of edge <span class="math">\((1,2)\)</span> will be overwritten with the label
of edge <span class="math">\((2,1)\)</span>.</li>
</ul>
<p>The default behaviour (<tt class="docutils literal"><span class="pre">multiedges</span> <span class="pre">=</span> <span class="pre">None</span></tt>) will raise an exception
each time a subjective decision (setting <tt class="docutils literal"><span class="pre">multiedges</span></tt> to <tt class="docutils literal"><span class="pre">True</span></tt>
or <tt class="docutils literal"><span class="pre">False</span></tt>) is necessary to perform the operation.</p>
</li>
</ul>
<p>The following forms are all accepted:</p>
<ul class="simple">
<li>D.reverse_edge( 1, 2 )</li>
<li>D.reverse_edge( (1, 2) )</li>
<li>D.reverse_edge( [1, 2] )</li>
<li>D.reverse_edge( 1, 2, &#8216;label&#8217; )</li>
<li>D.reverse_edge( ( 1, 2, &#8216;label&#8217;) )</li>
<li>D.reverse_edge( [1, 2, &#8216;label&#8217;] )</li>
<li>D.reverse_edge( ( 1, 2), label=&#8217;label&#8217;) )</li>
</ul>
<p>EXAMPLES:</p>
<p>If <tt class="docutils literal"><span class="pre">inplace</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt> (default value), <tt class="docutils literal"><span class="pre">self</span></tt> is modified:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(1, 0, 2)]</span>
</pre></div>
</div>
<p>If <tt class="docutils literal"><span class="pre">inplace</span></tt> is <tt class="docutils literal"><span class="pre">False</span></tt>, <tt class="docutils literal"><span class="pre">self</span></tt> is not modified
and a new digraph is returned:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">re</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">reverse_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">re</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(1, 0, 2)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, 2)]</span>
</pre></div>
</div>
<p>If <tt class="docutils literal"><span class="pre">multiedges</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt>, <tt class="docutils literal"><span class="pre">self</span></tt> will be forced to allow parallel
edges when and only when it is necessary:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;A&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;A&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edge</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(2, 1, &#39;A&#39;), (2, 1, &#39;A&#39;), (2, 3, None)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">allows_multiple_edges</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Even if <tt class="docutils literal"><span class="pre">multiedges</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt>, <tt class="docutils literal"><span class="pre">self</span></tt> will not be forced to allow
parallel edges when it is not necessary:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;A&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;A&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edge</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(1, 2, &#39;A&#39;), (2, 1, &#39;A&#39;), (3, 2, None)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">allows_multiple_edges</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>If user specifies <tt class="docutils literal"><span class="pre">multiedges</span> <span class="pre">=</span> <span class="pre">False</span></tt>, <tt class="docutils literal"><span class="pre">self</span></tt> will not be forced to
allow parallel edges and a parallel edge will get deleted:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;A&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="s">&#39;A&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(1, 2, &#39;A&#39;), (2, 1, &#39;A&#39;), (2, 3, None)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edge</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(2, 1, &#39;A&#39;), (2, 3, None)]</span>
</pre></div>
</div>
<p>Note that in the following graph, specifying <tt class="docutils literal"><span class="pre">multiedges</span> <span class="pre">=</span> <span class="pre">False</span></tt> will
result in overwriting the label of <span class="math">\((1,2)\)</span> with the label of <span class="math">\((2,1)\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="s">&#39;A&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(1, 2, &#39;B&#39;), (2, 1, &#39;A&#39;), (2, 3, None)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edge</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(1, 2, &#39;A&#39;), (2, 3, None)]</span>
</pre></div>
</div>
<p>If input edge in digraph has weight/label, then the weight/label should
be preserved in the output digraph.  User does not need to specify the
weight/label when calling function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span> <span class="n">weighted</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(1, 0, 2), (1, 2, 1)]</span>
<span class="gp">sage: </span><span class="n">re</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">reverse_edge</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">inplace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">re</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(1, 0, 2), (2, 1, 1)]</span>
</pre></div>
</div>
<p>If <tt class="docutils literal"><span class="pre">self</span></tt> has multiple copies (parallel edges) of the input edge, only
1 of the parallel edges is reversed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;01&#39;</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;01&#39;</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;cat&#39;</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;12&#39;</span><span class="p">)],</span> <span class="n">weighted</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">multiedges</span> <span class="o">=</span> <span class="n">true</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">re</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">reverse_edge</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;01&#39;</span><span class="p">],</span><span class="n">inplace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">re</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, &#39;01&#39;), (0, 1, &#39;cat&#39;), (1, 0, &#39;01&#39;), (1, 2, &#39;12&#39;)]</span>
</pre></div>
</div>
<p>If <tt class="docutils literal"><span class="pre">self</span></tt> has multiple copies (parallel edges) of the input edge but
with distinct labels and no input label is specified, only 1 of the
parallel edges is reversed (the edge that is labeled by the first label
on the list returned by <a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.edge_label" title="sage.graphs.generic_graph.GenericGraph.edge_label"><tt class="xref py py-meth docutils literal"><span class="pre">edge_label()</span></tt></a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;A&#39;</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;B&#39;</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;mouse&#39;</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;cat&#39;</span><span class="p">)],</span> <span class="n">multiedges</span> <span class="o">=</span> <span class="n">true</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edge_label</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[&#39;cat&#39;, &#39;mouse&#39;, &#39;B&#39;, &#39;A&#39;]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, &#39;A&#39;), (0, 1, &#39;B&#39;), (0, 1, &#39;mouse&#39;), (1, 0, &#39;cat&#39;)]</span>
</pre></div>
</div>
<p>Finally, an exception is raised when Sage does not know how to chose
between allowing multiple edges and losing some data:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;A&#39;</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&#39;B&#39;</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Reversing the given edge is about to create two parallel</span>
<span class="go">edges but input digraph doesn&#39;t allow them - User needs to specify</span>
<span class="go">multiedges is True or False.</span>
</pre></div>
</div>
<p>The following syntax is supported, but note that you must use
the <tt class="docutils literal"><span class="pre">label</span></tt> keyword:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;label&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(1, 2, &#39;label&#39;)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edge</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">label</span> <span class="o">=</span><span class="s">&#39;label&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(2, 1, &#39;label&#39;)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="s">&#39;label&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(2, 1, &#39;label&#39;), ((1, 2), &#39;label&#39;, None)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edge</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s">&#39;label&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(2, 1, &#39;label&#39;), (&#39;label&#39;, (1, 2), None)]</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="bp">None</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;mylabel&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Input edge must exist in the digraph.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.reverse_edges">
<tt class="descname">reverse_edges</tt><big>(</big><em>edges</em>, <em>inplace=True</em>, <em>multiedges=None</em><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.reverse_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Reverses a list of edges.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">edges</span></tt> &#8211; a list of edges in the DiGraph.</li>
<li><tt class="docutils literal"><span class="pre">inplace</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">True</span></tt>) if <tt class="docutils literal"><span class="pre">False</span></tt>, a new
digraph is created and returned as output, otherwise
<tt class="docutils literal"><span class="pre">self</span></tt> is modified.</li>
<li><tt class="docutils literal"><span class="pre">multiedges</span></tt> &#8211; (default: <tt class="docutils literal"><span class="pre">None</span></tt>) if <tt class="docutils literal"><span class="pre">True</span></tt>, input
graph will be forced to allow parallel edges when necessary
(for more information see the documentation of
<a class="reference internal" href="#sage.graphs.digraph.DiGraph.reverse_edge" title="sage.graphs.digraph.DiGraph.reverse_edge"><tt class="xref py py-meth docutils literal"><span class="pre">reverse_edge()</span></tt></a>)</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.graphs.digraph.DiGraph.reverse_edge" title="sage.graphs.digraph.DiGraph.reverse_edge"><tt class="xref py py-meth docutils literal"><span class="pre">reverse_edge()</span></tt></a> - Reverses a single edge.</p>
</div>
<p>EXAMPLES:</p>
<p>If <tt class="docutils literal"><span class="pre">inplace</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt> (default value), <tt class="docutils literal"><span class="pre">self</span></tt> is modified:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">]},</span> <span class="n">multiedges</span> <span class="o">=</span> <span class="n">true</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edges</span><span class="p">(</span> <span class="p">[</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edges</span><span class="p">(</span> <span class="p">[</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, None), (1, 0, None), (2, 3, None), (3, 0, None),</span>
<span class="go"> (3, 2, None), (4, 1, None), (5, 4, None)]</span>
</pre></div>
</div>
<p>If <tt class="docutils literal"><span class="pre">inplace</span></tt> is <tt class="docutils literal"><span class="pre">False</span></tt>, <tt class="docutils literal"><span class="pre">self</span></tt> is not modified and a new digraph
is returned:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span> <span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;A&#39;</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&#39;B&#39;</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s">&#39;C&#39;</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">re</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">reverse_edges</span><span class="p">(</span> <span class="p">[</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="p">],</span>
<span class="gp">... </span>                        <span class="n">inplace</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="n">multiedges</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">re</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(1, 0, &#39;A&#39;), (1, 0, &#39;B&#39;), (2, 1, &#39;C&#39;)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, &#39;A&#39;), (1, 0, &#39;B&#39;), (1, 2, &#39;C&#39;)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">allows_multiple_edges</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">re</span><span class="o">.</span><span class="n">allows_multiple_edges</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If <tt class="docutils literal"><span class="pre">multiedges</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt>, <tt class="docutils literal"><span class="pre">self</span></tt> will be forced to allow parallel
edges when and only when it is necessary:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;A&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;A&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edges</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)],</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(2, 1, &#39;A&#39;), (2, 1, &#39;A&#39;), (3, 2, None)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">allows_multiple_edges</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Even if <tt class="docutils literal"><span class="pre">multiedges</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt>, <tt class="docutils literal"><span class="pre">self</span></tt> will not be forced to allow
parallel edges when it is not necessary:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;A&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;A&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edges</span><span class="p">([(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)],</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(1, 2, &#39;A&#39;), (2, 1, &#39;A&#39;), (3, 2, None)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">allows_multiple_edges</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>If <tt class="docutils literal"><span class="pre">multiedges</span></tt> is <tt class="docutils literal"><span class="pre">False</span></tt>, <tt class="docutils literal"><span class="pre">self</span></tt> will not be forced to allow
parallel edges and an edge will get deleted:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(1, 2, None), (2, 1, None)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edges</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(2, 1, None)]</span>
</pre></div>
</div>
<p>If input edge in digraph has weight/label, then the weight/label should
be preserved in the output digraph.  User does not need to specify the
weight/label when calling function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;01&#39;</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="s">&#39;23&#39;</span><span class="p">)],</span> <span class="n">weighted</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;01&#39;</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(1, 0, &#39;01&#39;), (2, 1, 1), (3, 2, &#39;23&#39;)]</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">Circuit</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edges</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">(),</span><span class="n">inplace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 5, None), (1, 0, None), (2, 1, None),</span>
<span class="go"> (3, 2, None), (4, 3, None), (5, 4, None)]</span>

<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">Kautz</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Dr</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">reverse_edges</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">(),</span><span class="n">inplace</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Dr</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span> <span class="o">==</span> <span class="n">D</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.sinks">
<tt class="descname">sinks</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.sinks" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of sinks of the digraph.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>list, the vertices of the digraph that have no edges beginning at them</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">1</span><span class="p">:{</span><span class="mi">3</span><span class="p">:[</span><span class="s">&#39;a&#39;</span><span class="p">]},</span> <span class="mi">2</span><span class="p">:{</span><span class="mi">3</span><span class="p">:[</span><span class="s">&#39;b&#39;</span><span class="p">]}})</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">sinks</span><span class="p">()</span>
<span class="go">[3]</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">1</span><span class="p">:{}})</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">sinks</span><span class="p">()</span>
<span class="go">[1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.sources">
<tt class="descname">sources</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.sources" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of sources of the digraph.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>list, the vertices of the digraph that have no edges going into them</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">1</span><span class="p">:{</span><span class="mi">3</span><span class="p">:[</span><span class="s">&#39;a&#39;</span><span class="p">]},</span> <span class="mi">2</span><span class="p">:{</span><span class="mi">3</span><span class="p">:[</span><span class="s">&#39;b&#39;</span><span class="p">]}})</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">sources</span><span class="p">()</span>
<span class="go">[1, 2]</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">1</span><span class="p">:{}})</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">sources</span><span class="p">()</span>
<span class="go">[1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.strongly_connected_component_containing_vertex">
<tt class="descname">strongly_connected_component_containing_vertex</tt><big>(</big><em>v</em><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.strongly_connected_component_containing_vertex" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the strongly connected component containing a given vertex</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">v</span></tt> &#8211; a vertex</li>
</ul>
<p>EXAMPLE:</p>
<p>In the symmetric digraph of a graph, the strongly connected components are the connected
components:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">strongly_connected_component_containing_vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.strongly_connected_components">
<tt class="descname">strongly_connected_components</tt><big>(</big><em>G</em><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.strongly_connected_components" title="Permalink to this definition">¶</a></dt>
<dd><p>The Tarjan algorithm to compute strongly connected components (SCCs).</p>
<p>This routine returns a pair <tt class="docutils literal"><span class="pre">[nscc,</span> <span class="pre">scc]</span></tt>, where <tt class="docutils literal"><span class="pre">nscc</span></tt> is the number of
SCCs and <tt class="docutils literal"><span class="pre">scc</span></tt> is a dictionary associating to each vertex <tt class="docutils literal"><span class="pre">v</span></tt> an
integer between <tt class="docutils literal"><span class="pre">0</span></tt> and <tt class="docutils literal"><span class="pre">nscc-1</span></tt>, corresponding to the SCC containing
<tt class="docutils literal"><span class="pre">v</span></tt>. SCCs
are numbered in reverse topological order, that is, if <tt class="docutils literal"><span class="pre">(v,w)</span></tt> is an edge
in the graph, <tt class="docutils literal"><span class="pre">scc[v]</span> <span class="pre">&lt;=</span> <span class="pre">scc[w]</span></tt>.</p>
<p>The basic idea of the algorithm is this: a depth-first search (DFS) begins
from an arbitrary start node (and subsequent DFSes are
conducted on any nodes that have not yet been found). As usual with DFSes,
the search visits every node of the graph exactly once, declining to revisit
any node that has already been explored. Thus, the collection of search
trees is a spanning forest of the graph. The strongly connected components
correspond to the subtrees of this spanning forest that have no edge
directed outside the subtree.</p>
<p>To recover these components, during the DFS, we keep the index of a node,
that is, the position in the DFS tree, and the lowlink: as soon as the
subtree rooted at <span class="math">\(v\)</span> has been fully explored, the lowlink of <span class="math">\(v\)</span> is the
smallest index reachable from <span class="math">\(v\)</span> passing from descendants of <span class="math">\(v\)</span>. If the
subtree rooted at <span class="math">\(v\)</span> has been fully explored, and the index of <span class="math">\(v\)</span> equals
the lowlink of <span class="math">\(v\)</span>, that whole subtree is a new SCC.</p>
<p>For more information, see the
<a class="reference external" href="https://en.wikipedia.org/wiki/Tarjan's_strongly_connected_components_algorithm">Wikipedia article on Tarjan&#8217;s algorithm</a>.</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.base.static_sparse_graph</span> <span class="kn">import</span> <span class="n">tarjan_strongly_connected_components</span>
<span class="gp">sage: </span><span class="n">tarjan_strongly_connected_components</span><span class="p">(</span><span class="n">digraphs</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">[[2], [1], [0]]</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">1</span> <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span> <span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">4</span> <span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">5</span> <span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">connected_components</span><span class="p">()</span>
<span class="go">[[0, 1, 2, 3], [4, 5, 6]]</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">1</span> <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span> <span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">4</span> <span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">5</span> <span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">strongly_connected_components</span><span class="p">()</span>
<span class="go">[[3], [2], [1], [0], [6], [5], [4]]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edge</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">strongly_connected_components</span><span class="p">()</span>
<span class="go">[[3], [0, 1, 2], [6], [5], [4]]</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="s">&#39;d&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="s">&#39;e&#39;</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">strongly_connected_components</span><span class="p">()</span>
<span class="go">[[&#39;e&#39;], [&#39;b&#39;, &#39;c&#39;, &#39;d&#39;], [&#39;a&#39;]]</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Checking that the result is correct:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.base.static_sparse_graph</span> <span class="kn">import</span> <span class="n">tarjan_strongly_connected_components</span>
<span class="gp">sage: </span><span class="kn">import</span> <span class="nn">random</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>                                     <span class="c"># long</span>
<span class="go">....:     n = random.randint(2,20)</span>
<span class="go">....:     m = random.randint(1, n*(n-1))</span>
<span class="go">....:     g = digraphs.RandomDirectedGNM(n,m)</span>
<span class="go">....:     sccs = tarjan_strongly_connected_components(g)</span>
<span class="go">....:     for scc in sccs:</span>
<span class="go">....:         scc_check = g.strongly_connected_component_containing_vertex(scc[0])</span>
<span class="go">....:         assert(sorted(scc) == sorted(scc_check))</span>
</pre></div>
</div>
<p>Checking against NetworkX:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">import</span> <span class="nn">networkx</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>                                     <span class="c"># long</span>
<span class="go">....:      g = digraphs.RandomDirectedGNP(100,.05)</span>
<span class="go">....:      h = g.networkx_graph()</span>
<span class="go">....:      scc1 = g.strongly_connected_components()</span>
<span class="go">....:      scc2 = networkx.strongly_connected_components(h)</span>
<span class="go">....:      s1 = Set(map(Set,scc1))</span>
<span class="go">....:      s2 = Set(map(Set,scc2))</span>
<span class="go">....:      if s1 != s2:</span>
<span class="go">....:          print &quot;Ooch !&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.strongly_connected_components_digraph">
<tt class="descname">strongly_connected_components_digraph</tt><big>(</big><em>keep_labels=False</em><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.strongly_connected_components_digraph" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the digraph of the strongly connected components</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">keep_labels</span></tt> &#8211; boolean (default: False)</li>
</ul>
</div></blockquote>
<p>The digraph of the strongly connected components of a graph <span class="math">\(G\)</span> has
a vertex per strongly connected component included in <span class="math">\(G\)</span>. There
is an edge from a component <span class="math">\(C_1\)</span> to a component <span class="math">\(C_2\)</span> if there is
an edge from one to the other in <span class="math">\(G\)</span>.</p>
<p>EXAMPLE:</p>
<p>Such a digraph is always acyclic</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">RandomDirectedGNP</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">scc_digraph</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">strongly_connected_components_digraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">scc_digraph</span><span class="o">.</span><span class="n">is_directed_acyclic</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The vertices of the digraph of strongly connected components are
exactly the strongly connected components:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">ButterflyGraph</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">scc_digraph</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">strongly_connected_components_digraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_directed_acyclic</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">([</span> <span class="n">Set</span><span class="p">(</span><span class="n">scc</span><span class="p">)</span> <span class="ow">in</span> <span class="n">scc_digraph</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span> <span class="k">for</span> <span class="n">scc</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">strongly_connected_components</span><span class="p">()])</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The following digraph has three strongly connected components,
and the digraph of those is a chain:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="s">&quot;01&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s">&quot;02&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mo">03</span><span class="p">},</span> <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="s">&quot;12&quot;</span><span class="p">},</span> <span class="mi">2</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span> <span class="s">&quot;21&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s">&quot;23&quot;</span><span class="p">}})</span>
<span class="gp">sage: </span><span class="n">scc_digraph</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">strongly_connected_components_digraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">scc_digraph</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[{0}, {3}, {1, 2}]</span>
<span class="gp">sage: </span><span class="n">scc_digraph</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[({0}, {1, 2}, None), ({0}, {3}, None), ({1, 2}, {3}, None)]</span>
</pre></div>
</div>
<p>By default, the labels are discarded, and the result has no
loops nor multiple edges. If <tt class="docutils literal"><span class="pre">keep_labels</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt>, then
the labels are kept, and the result is a multi digraph,
possibly with multiple edges and loops. However, edges in the
result with same source, target, and label are not duplicated
(see the edges from 0 to the strongly connected component
<span class="math">\(\{1,2\}\)</span> below):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="s">&quot;0-12&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s">&quot;0-12&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s">&quot;0-3&quot;</span><span class="p">},</span> <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="s">&quot;1-2&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s">&quot;1-3&quot;</span><span class="p">},</span> <span class="mi">2</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span> <span class="s">&quot;2-1&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s">&quot;2-3&quot;</span><span class="p">}})</span>
<span class="gp">sage: </span><span class="n">scc_digraph</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">strongly_connected_components_digraph</span><span class="p">(</span><span class="n">keep_labels</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">scc_digraph</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[{0}, {3}, {1, 2}]</span>
<span class="gp">sage: </span><span class="n">scc_digraph</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[({0}, {1, 2}, &#39;0-12&#39;),</span>
<span class="go"> ({0}, {3}, &#39;0-3&#39;),</span>
<span class="go"> ({1, 2}, {1, 2}, &#39;1-2&#39;),</span>
<span class="go"> ({1, 2}, {1, 2}, &#39;2-1&#39;),</span>
<span class="go"> ({1, 2}, {3}, &#39;1-3&#39;),</span>
<span class="go"> ({1, 2}, {3}, &#39;2-3&#39;)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.strongly_connected_components_subgraphs">
<tt class="descname">strongly_connected_components_subgraphs</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.strongly_connected_components_subgraphs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the strongly connected components as a list of subgraphs.</p>
<p>EXAMPLE:</p>
<p>In the symmetric digraph of a graph, the strongly connected components are the connected
components:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">strongly_connected_components_subgraphs</span><span class="p">()</span>
<span class="go">[Subgraph of (Petersen graph): Digraph on 10 vertices]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.to_directed">
<tt class="descname">to_directed</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.to_directed" title="Permalink to this definition">¶</a></dt>
<dd><p>Since the graph is already directed, simply returns a copy of
itself.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="mi">4</span><span class="p">:[</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">]})</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="go">Digraph on 6 vertices</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.to_undirected">
<tt class="descname">to_undirected</tt><big>(</big><em>implementation='c_graph'</em>, <em>data_structure=None</em>, <em>sparse=None</em><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.to_undirected" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an undirected version of the graph. Every directed edge
becomes an edge.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">data_structure</span></tt> &#8211; one of <tt class="docutils literal"><span class="pre">&quot;sparse&quot;</span></tt>, <tt class="docutils literal"><span class="pre">&quot;static_sparse&quot;</span></tt>, or
<tt class="docutils literal"><span class="pre">&quot;dense&quot;</span></tt>. See the documentation of <a class="reference internal" href="graph.html#sage.graphs.graph.Graph" title="sage.graphs.graph.Graph"><tt class="xref py py-class docutils literal"><span class="pre">Graph</span></tt></a> or
<a class="reference internal" href="#sage.graphs.digraph.DiGraph" title="sage.graphs.digraph.DiGraph"><tt class="xref py py-class docutils literal"><span class="pre">DiGraph</span></tt></a>.</li>
<li><tt class="docutils literal"><span class="pre">sparse</span></tt> (boolean) &#8211; <tt class="docutils literal"><span class="pre">sparse=True</span></tt> is an alias for
<tt class="docutils literal"><span class="pre">data_structure=&quot;sparse&quot;</span></tt>, and <tt class="docutils literal"><span class="pre">sparse=False</span></tt> is an alias for
<tt class="docutils literal"><span class="pre">data_structure=&quot;dense&quot;</span></tt>.</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">to_undirected</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(0, 1), (0, 2), (1, 0)]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(0, 1), (0, 2)]</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Immutable graphs yield immutable graphs (<a class="reference external" href="http://trac.sagemath.org/17005">trac ticket #17005</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">DiGraph</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span> <span class="n">immutable</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">to_undirected</span><span class="p">()</span><span class="o">.</span><span class="n">_backend</span>
<span class="go">&lt;type &#39;sage.graphs.base.static_sparse_backend.StaticSparseBackend&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.topological_sort">
<tt class="descname">topological_sort</tt><big>(</big><em>implementation='default'</em><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.topological_sort" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a topological sort of the digraph if it is acyclic, and
raises a TypeError if the digraph contains a directed cycle. As
topological sorts are not necessarily unique, different
implementations may yield different results.</p>
<p>A topological sort is an ordering of the vertices of the digraph
such that each vertex comes before all of its successors. That
is, if <span class="math">\(u\)</span> comes before <span class="math">\(v\)</span> in the sort, then there may be
a directed path from <span class="math">\(u\)</span> to <span class="math">\(v\)</span>, but there will be no directed
path from <span class="math">\(v\)</span> to <span class="math">\(u\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">implementation</span></tt> &#8211; Use the default Cython implementation
(<tt class="docutils literal"><span class="pre">implementation</span> <span class="pre">=</span> <span class="pre">default</span></tt>), the default NetworkX library
(<tt class="docutils literal"><span class="pre">implementation</span> <span class="pre">=</span> <span class="pre">&quot;NetworkX&quot;</span></tt>) or the recursive NetworkX
implementation (<tt class="docutils literal"><span class="pre">implementation</span> <span class="pre">=</span> <span class="pre">&quot;recursive&quot;</span></tt>)</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.graphs.digraph.DiGraph.is_directed_acyclic" title="sage.graphs.digraph.DiGraph.is_directed_acyclic"><tt class="xref py py-meth docutils literal"><span class="pre">is_directed_acyclic()</span></tt></a> &#8211; Tests whether a directed
graph is acyclic (can also join a certificate &#8211;
a topological sort or a circuit in the graph1).</li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span> <span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">4</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">8</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">7</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">7</span><span class="p">],</span>
<span class="gp">... </span>    <span class="mi">5</span><span class="p">:[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="mi">7</span><span class="p">:[</span><span class="mi">8</span><span class="p">],</span> <span class="mi">6</span><span class="p">:[</span><span class="mi">9</span><span class="p">],</span> <span class="mi">8</span><span class="p">:[</span><span class="mi">10</span><span class="p">],</span> <span class="mi">9</span><span class="p">:[</span><span class="mi">10</span><span class="p">]</span> <span class="p">})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="s">&#39;circular&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">topological_sort</span><span class="p">()</span>
<span class="go">[4, 5, 6, 9, 0, 1, 2, 3, 7, 8, 10]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">topological_sort</span><span class="p">()</span>
<span class="go">[4, 5, 6, 9, 0, 1, 2, 3, 7, 8, 10]</span>
</pre></div>
</div>
<p>Using the NetworkX implementation</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">topological_sort</span><span class="p">(</span><span class="n">implementation</span> <span class="o">=</span> <span class="s">&quot;NetworkX&quot;</span><span class="p">)</span>
<span class="go">[4, 5, 6, 9, 0, 1, 2, 3, 7, 8, 10]</span>
</pre></div>
</div>
<p>Using the NetworkX recursive implementation</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">topological_sort</span><span class="p">(</span><span class="n">implementation</span> <span class="o">=</span> <span class="s">&quot;recursive&quot;</span><span class="p">)</span>
<span class="go">[4, 5, 6, 9, 0, 3, 2, 7, 1, 8, 10]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">topological_sort</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Digraph is not acyclic; there is no topological</span>
<span class="go">sort.</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>There is a recursive version of this in NetworkX, it used to
have problems in earlier versions but they have since been
fixed:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">import</span> <span class="nn">networkx</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span> <span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">4</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">8</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">7</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">7</span><span class="p">],</span>
<span class="gp">... </span>    <span class="mi">5</span><span class="p">:[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="mi">7</span><span class="p">:[</span><span class="mi">8</span><span class="p">],</span> <span class="mi">6</span><span class="p">:[</span><span class="mi">9</span><span class="p">],</span> <span class="mi">8</span><span class="p">:[</span><span class="mi">10</span><span class="p">],</span> <span class="mi">9</span><span class="p">:[</span><span class="mi">10</span><span class="p">]</span> <span class="p">})</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">networkx_graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">networkx</span><span class="o">.</span><span class="n">topological_sort</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="go">[4, 5, 6, 9, 0, 1, 2, 3, 7, 8, 10]</span>
<span class="gp">sage: </span><span class="n">networkx</span><span class="o">.</span><span class="n">topological_sort_recursive</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="go">[4, 5, 6, 9, 0, 3, 2, 7, 1, 8, 10]</span>
</pre></div>
</div>
</div>
<p>TESTS:</p>
<p>A wrong value for the <tt class="docutils literal"><span class="pre">implementation</span></tt> keyword:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">topological_sort</span><span class="p">(</span><span class="n">implementation</span> <span class="o">=</span> <span class="s">&quot;cloud-reading&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">implementation must be set to one of &quot;default&quot;</span>
<span class="go">or &quot;NetworkX&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.topological_sort_generator">
<tt class="descname">topological_sort_generator</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.graphs.digraph.DiGraph.topological_sort_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of all topological sorts of the digraph if it is
acyclic, and raises a TypeError if the digraph contains a directed
cycle.</p>
<p>A topological sort is an ordering of the vertices of the digraph
such that each vertex comes before all of its successors. That is,
if u comes before v in the sort, then there may be a directed path
from u to v, but there will be no directed path from v to u. See
also Graph.topological_sort().</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>Mike Hansen - original implementation</li>
<li>Robert L. Miller: wrapping, documentation</li>
</ul>
<p>REFERENCE:</p>
<ul class="simple">
<li>[1] Pruesse, Gara and Ruskey, Frank. Generating Linear
Extensions Fast. SIAM J. Comput., Vol. 23 (1994), no. 2, pp.
373-386.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span> <span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="p">})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="s">&#39;circular&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">topological_sort_generator</span><span class="p">()</span>
<span class="go">[[0, 1, 2, 3, 4], [0, 1, 2, 4, 3], [0, 2, 1, 3, 4], [0, 2, 1, 4, 3], [0, 2, 4, 1, 3]]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">for</span> <span class="n">sort</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">topological_sort_generator</span><span class="p">():</span>
<span class="gp">... </span>      <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">edge_iterator</span><span class="p">():</span>
<span class="gp">... </span>          <span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">l</span> <span class="o">=</span> <span class="n">edge</span>
<span class="gp">... </span>          <span class="k">if</span> <span class="n">sort</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">sort</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
<span class="gp">... </span>              <span class="k">print</span> <span class="s">&quot;This should never happen.&quot;</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="../../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">Directed graphs</a><ul>
<li><a class="reference internal" href="#methods">Methods</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="graph.html"
                                  title="previous chapter">Undirected graphs</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="bipartite_graph.html"
                                  title="next chapter">Bipartite graphs</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../_sources/sage/graphs/digraph.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="bipartite_graph.html" title="Bipartite graphs"
             >next</a> |</li>
        <li class="right" >
          <a href="graph.html" title="Undirected graphs"
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../index.html">Graph Theory</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer">
        &copy; Copyright 2005--2016, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>