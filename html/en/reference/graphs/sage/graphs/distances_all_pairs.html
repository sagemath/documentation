<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="LaTeX options for graphs" href="graph_latex.html" /><link rel="prev" title="Weakly chordal graphs" href="weakly_chordal.html" />

    <meta name="generator" content="sphinx-4.4.0, furo 2022.06.21"/>
        <title>Distances/shortest paths between all pairs of vertices - Graph Theory</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?digest=40978830699223671f4072448e654b5958f38b89" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom-furo.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZGD13B5572"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-ZGD13B5572');
</script></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Graph Theory</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 9.7 Reference Manual</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../index.html">Home - Graph Theory</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="generic_graph.html">Generic graphs (common to directed/undirected)</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph.html">Undirected graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="digraph.html">Directed graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="bipartite_graph.html">Bipartite graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="views.html">View classes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="graph_generators.html">Common graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="digraph_generators.html">Common digraphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_generators_pyx.html">Common graphs and digraphs generators (Cython)</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_database.html">Graph database</a></li>
<li class="toctree-l1"><a class="reference internal" href="strongly_regular_db.html">Database of strongly regular graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="generators/distance_regular.html">Database of distance regular graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="generators/classical_geometries.html">Families of graphs derived from classical geometries over finite fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="generators/families.html">Various families of graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="generators/basic.html">Basic graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="generators/chessboard.html">Chessboard graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="generators/intersection.html">Intersection graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="generators/platonic_solids.html">1-skeletons of Platonic solids</a></li>
<li class="toctree-l1"><a class="reference internal" href="generators/random.html">Random graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="generators/smallgraphs.html">Various small graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="generators/world_map.html">Graphs from the World Map</a></li>
<li class="toctree-l1"><a class="reference internal" href="isgci.html">ISGCI: Information System on Graph Classes and their Inclusions</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="base/overview.html">Overview of (di)graph data structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="base/c_graph.html">Fast compiled graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="base/sparse_graph.html">Fast sparse graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="base/dense_graph.html">Fast dense graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="base/static_dense_graph.html">Static dense graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="base/static_sparse_graph.html">Static Sparse Graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="base/static_sparse_backend.html">Static sparse graph backend</a></li>
<li class="toctree-l1"><a class="reference internal" href="base/graph_backends.html">Backends for Sage (di)graphs.</a></li>
<li class="toctree-l1"><a class="reference internal" href="base/boost_graph.html">Interface to run Boost algorithms</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="hypergraph_generators.html">Hypergraph generators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../combinat/designs/incidence_structures.html">Incidence structures (i.e. hypergraphs, i.e. set systems)</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="graph_coloring.html">Graph coloring</a></li>
<li class="toctree-l1"><a class="reference internal" href="cliquer.html">Interface with Cliquer (clique-related problems)</a></li>
<li class="toctree-l1"><a class="reference internal" href="centrality.html">Centrality</a></li>
<li class="toctree-l1"><a class="reference internal" href="asteroidal_triples.html">Asteroidal triples</a></li>
<li class="toctree-l1"><a class="reference internal" href="independent_sets.html">Independent sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="comparability.html">Comparability and permutation graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="line_graph.html">Line graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="spanning_tree.html">Spanning trees</a></li>
<li class="toctree-l1"><a class="reference internal" href="pq_trees.html">PQ-Trees</a></li>
<li class="toctree-l1"><a class="reference internal" href="trees.html">Generation of trees</a></li>
<li class="toctree-l1"><a class="reference internal" href="matchpoly.html">Matching Polynomial</a></li>
<li class="toctree-l1"><a class="reference internal" href="genus.html">Genus</a></li>
<li class="toctree-l1"><a class="reference internal" href="lovasz_theta.html">Lovász theta-function of graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="schnyder.html">Schnyder’s Algorithm for straight-line planar embeddings</a></li>
<li class="toctree-l1"><a class="reference internal" href="planarity.html">Wrapper for Boyer’s (C) planarity algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="traversals.html">Graph traversals.</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_plot.html">Graph Plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_plot_js.html">Graph plotting in Javascript with d3.js</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_decompositions/tree_decomposition.html">Tree decompositions</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_decompositions/vertex_separation.html">Vertex separation</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_decompositions/rankwidth.html">Rank Decompositions of graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_decompositions/bandwidth.html">Bandwidth of undirected graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_decompositions/cutwidth.html">Cutwidth</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_decompositions/graph_products.html">Products of graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_decompositions/modular_decomposition.html">Modular Decomposition</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_decompositions/clique_separators.html">Decomposition by clique minimal separators</a></li>
<li class="toctree-l1"><a class="reference internal" href="convexity_properties.html">Convexity properties of graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="weakly_chordal.html">Weakly chordal graphs</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Distances/shortest paths between all pairs of vertices</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_latex.html">LaTeX options for graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_editor.html">Graph editor widget</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_list.html">Lists of graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_input.html">Functions for reading/building graphs/digraphs.</a></li>
<li class="toctree-l1"><a class="reference internal" href="hyperbolicity.html">Hyperbolicity</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutte_polynomial.html">Tutte polynomial</a></li>
<li class="toctree-l1"><a class="reference internal" href="partial_cube.html">Partial cubes</a></li>
<li class="toctree-l1"><a class="reference internal" href="path_enumeration.html">Path Enumeration</a></li>
<li class="toctree-l1"><a class="reference internal" href="generic_graph_pyx.html">GenericGraph Cython functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="orientations.html">Orientations</a></li>
<li class="toctree-l1"><a class="reference internal" href="connectivity.html">Connectivity related functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="edge_connectivity.html">Edge connectivity</a></li>
<li class="toctree-l1"><a class="reference internal" href="domination.html">Domination</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="distances-shortest-paths-between-all-pairs-of-vertices">
<span id="sage-graphs-distances-all-pairs"></span><h1>Distances/shortest paths between all pairs of vertices<a class="headerlink" href="#distances-shortest-paths-between-all-pairs-of-vertices" title="Permalink to this headline">#</a></h1>
<span class="target" id="module-sage.graphs.distances_all_pairs"></span><p>This module implements a few functions that deal with the computation of
distances or shortest paths between all pairs of vertices.</p>
<p><strong>Efficiency</strong> : Because these functions involve listing many times the
(out)-neighborhoods of (di)-graphs, it is useful in terms of efficiency to build
a temporary copy of the graph in a data structure that makes it easy to compute
quickly. These functions also work on large volume of data, typically dense
matrices of size <span class="math notranslate nohighlight">\(n^2\)</span>, and are expected to return corresponding dictionaries of
size <span class="math notranslate nohighlight">\(n^2\)</span>, where the integers corresponding to the vertices have first been
converted to the vertices’ labels. Sadly, this last translating operation turns
out to be the most time-consuming, and for this reason it is also nice to have a
Cython module, and version of these functions that return C arrays, in order to
avoid these operations when they are not necessary.</p>
<p><strong>Memory cost</strong> : The methods implemented in the current module sometimes need
large amounts of memory to return their result. Storing the distances between
all pairs of vertices in a graph on <span class="math notranslate nohighlight">\(1500\)</span> vertices as a dictionary of
dictionaries takes around 200MB, while storing the same information as a C array
requires 4MB.</p>
<section id="the-module-s-main-function">
<h2>The module’s main function<a class="headerlink" href="#the-module-s-main-function" title="Permalink to this headline">#</a></h2>
<p>The C function <code class="docutils literal notranslate"><span class="pre">all_pairs_shortest_path_BFS</span></code> actually does all the
computations, and all the others (except for <code class="docutils literal notranslate"><span class="pre">Floyd_Warshall</span></code>) are just
wrapping it. This function begins with copying the graph in a data structure
that makes it fast to query the out-neighbors of a vertex, then starts one
Breadth First Search per vertex of the (di)graph.</p>
<p><strong>What can this function compute ?</strong></p>
<ul>
<li><p>The matrix of predecessors.</p>
<p>This matrix <span class="math notranslate nohighlight">\(P\)</span> has size <span class="math notranslate nohighlight">\(n^2\)</span>, and is such that vertex <span class="math notranslate nohighlight">\(P[u,v]\)</span> is a
predecessor of <span class="math notranslate nohighlight">\(v\)</span> on a shortest <span class="math notranslate nohighlight">\(uv\)</span>-path. Hence, this matrix efficiently
encodes the information of a shortest <span class="math notranslate nohighlight">\(uv\)</span>-path for any <span class="math notranslate nohighlight">\(u,v\in G\)</span> : indeed,
to go from <span class="math notranslate nohighlight">\(u\)</span> to <span class="math notranslate nohighlight">\(v\)</span> you should first find a shortest <span class="math notranslate nohighlight">\(uP[u,v]\)</span>-path, then
jump from <span class="math notranslate nohighlight">\(P[u,v]\)</span> to <span class="math notranslate nohighlight">\(v\)</span> as it is one of its outneighbors. Apply recursively
and find out what the whole path is !.</p>
</li>
<li><p>The matrix of distances.</p>
<p>This matrix has size <span class="math notranslate nohighlight">\(n^2\)</span> and associates to any <span class="math notranslate nohighlight">\(uv\)</span> the distance
from <span class="math notranslate nohighlight">\(u\)</span> to <span class="math notranslate nohighlight">\(v\)</span>.</p>
</li>
<li><p>The vector of eccentricities.</p>
<p>This vector of size <span class="math notranslate nohighlight">\(n\)</span> encodes for each vertex <span class="math notranslate nohighlight">\(v\)</span> the distance to vertex
which is furthest from <span class="math notranslate nohighlight">\(v\)</span> in the graph. In particular, the diameter of the
graph is the maximum of these values.</p>
</li>
</ul>
<p><strong>What does it take as input ?</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gg</span></code> a (Di)Graph.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">short</span> <span class="pre">*</span> <span class="pre">predecessors</span></code> – a pointer toward an array of size
<span class="math notranslate nohighlight">\(n^2\cdot\text{sizeof(unsigned short)}\)</span>. Set to <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if you do not want to
compute the predecessors.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">short</span> <span class="pre">*</span> <span class="pre">distances</span></code> – a pointer toward an array of size
<span class="math notranslate nohighlight">\(n^2\cdot\text{sizeof(unsigned short)}\)</span>. The computation of the distances is
necessary for the algorithm, so this value can <strong>not</strong> be set to <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">*</span> <span class="pre">eccentricity</span></code> – a pointer toward an array of size
<span class="math notranslate nohighlight">\(n\cdot\text{sizeof(int)}\)</span>. Set to <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if you do not want to compute the
eccentricity.</p></li>
</ul>
<p><strong>Technical details</strong></p>
<ul class="simple">
<li><p>The vertices are encoded as <span class="math notranslate nohighlight">\(1, ..., n\)</span> as they appear in the ordering of
<code class="docutils literal notranslate"><span class="pre">G.vertices(sort=True)</span></code>, unless another ordering is specified by the user.</p></li>
<li><p>Because this function works on matrices whose size is quadratic compared to
the number of vertices when computing all distances or predecessors, it uses
short variables to store the vertices’ names instead of long ones to divide by
2 the size in memory. This means that only the diameter/eccentricities can be
computed on a graph of more than 65536 nodes. For information, the current
version of the algorithm on a graph with <span class="math notranslate nohighlight">\(65536=2^{16}\)</span> nodes creates in
memory <span class="math notranslate nohighlight">\(2\)</span> tables on <span class="math notranslate nohighlight">\(2^{32}\)</span> short elements (2bytes each), for a total of
<span class="math notranslate nohighlight">\(2^{33}\)</span> bytes or <span class="math notranslate nohighlight">\(8\)</span> gigabytes. In order to support larger sizes, we would
have to replace shorts by 32-bits int or 64-bits int, which would then require
respectively 16GB or 32GB.</p></li>
<li><p>In the C version of these functions, infinite distances are represented with
<code class="docutils literal notranslate"><span class="pre">&lt;unsigned</span> <span class="pre">short&gt;</span> <span class="pre">-1</span> <span class="pre">=</span> <span class="pre">65535</span></code> for <code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">short</span></code> variables, and by
<code class="docutils literal notranslate"><span class="pre">INT32_MAX</span></code> otherwise. These case happens when the input is a disconnected
graph, or a non-strongly-connected digraph.</p></li>
<li><p>A memory error is raised when data structures allocation failed. This could
happen with large graphs on computers with low memory space.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The function <code class="docutils literal notranslate"><span class="pre">all_pairs_shortest_path_BFS</span></code> has <strong>no reason</strong> to be called
by the user, even though he would be writing his code in Cython and look for
efficiency. This module contains wrappers for this function that feed it
with the good parameters. As the function is inlined, using those wrappers
actually saves time as it should avoid testing the parameters again and
again in the main function’s body.</p>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li><p>Nathann Cohen (2011)</p></li>
<li><p>David Coudert (2014) – 2sweep, multi-sweep and iFUB for diameter computation</p></li>
</ul>
</section>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="sage.graphs.distances_all_pairs.antipodal_graph">
<span class="sig-prename descclassname"><span class="pre">sage.graphs.distances_all_pairs.</span></span><span class="sig-name descname"><span class="pre">antipodal_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.distances_all_pairs.antipodal_graph" title="Permalink to this definition">#</a></dt>
<dd><p>Return the antipodal graph of <span class="math notranslate nohighlight">\(G\)</span>.</p>
<p>The antipodal graph of a graph <span class="math notranslate nohighlight">\(G\)</span> has the same vertex set of <span class="math notranslate nohighlight">\(G\)</span> and
two vertices are adjacent if their distance in <span class="math notranslate nohighlight">\(G\)</span> is equal to the
diameter of <span class="math notranslate nohighlight">\(G\)</span>.</p>
<p>This method first computes the eccentricity of all vertices and determines
the diameter of the graph. Then, it for each vertex <span class="math notranslate nohighlight">\(u\)</span> with eccentricity
the diameter, it computes BFS distances from <span class="math notranslate nohighlight">\(u\)</span> and add an edge in the
antipodal graph for each vertex <span class="math notranslate nohighlight">\(v\)</span> at diamter distance from <span class="math notranslate nohighlight">\(u\)</span> (i.e., for
each antipodal vertex).</p>
<p>The drawback of this method is that some BFS distances may be computed
twice, one time to determine the eccentricities and another time is the
vertex has eccentricity equal to the diameter. However, in practive, this is
much more efficient. See the documentation of method
<code class="xref py py-meth docutils literal notranslate"><span class="pre">c_eccentricity_DHV()</span></code>.</p>
<p>EXAMPLES:</p>
<p>The antipodal graph of a grid graph has only 2 edges:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.distances_all_pairs</span> <span class="kn">import</span> <span class="n">antipodal_graph</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">Grid2dGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">antipodal_graph</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">order</span><span class="p">(),</span> <span class="n">A</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">(25, 2)</span>
</pre></div>
</div>
<p>The antipodal graph of a disjoint union of cliques is its complement:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.distances_all_pairs</span> <span class="kn">import</span> <span class="n">antipodal_graph</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">antipodal_graph</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">complement</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The antipodal graph can also be constructed as the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.graphs.generic_graph.distance_graph()</span></code> for diameter distance:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.distances_all_pairs</span> <span class="kn">import</span> <span class="n">antipodal_graph</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomGNP</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">.2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">antipodal_graph</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">distance_graph</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">diameter</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.graphs.distances_all_pairs.diameter">
<span class="sig-prename descclassname"><span class="pre">sage.graphs.distances_all_pairs.</span></span><span class="sig-name descname"><span class="pre">diameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.distances_all_pairs.diameter" title="Permalink to this definition">#</a></dt>
<dd><p>Return the diameter of <span class="math notranslate nohighlight">\(G\)</span>.</p>
<p>This method returns Infinity if the (di)graph is not connected. It can
also quickly return a lower bound on the diameter using the <code class="docutils literal notranslate"><span class="pre">2sweep</span></code>,
<code class="docutils literal notranslate"><span class="pre">2Dsweep</span></code> and <code class="docutils literal notranslate"><span class="pre">multi-sweep</span></code> schemes.</p>
<p>INPUT:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – string (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); specifies the algorithm to
use among:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'standard'</span></code> – Computes the diameter of the input (di)graph as the
largest eccentricity of its vertices. This is the classical algorithm
with time complexity in <span class="math notranslate nohighlight">\(O(nm)\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'2sweep'</span></code> – Computes a lower bound on the diameter of an
unweighted undirected graph using 2 BFS, as proposed in <a class="reference internal" href="../../../references/index.html#mlh2008" id="id1"><span>[MLH2008]</span></a>.  It
first selects a vertex <span class="math notranslate nohighlight">\(v\)</span> that is at largest distance from an initial
vertex source using BFS. Then it performs a second BFS from <span class="math notranslate nohighlight">\(v\)</span>. The
largest distance from <span class="math notranslate nohighlight">\(v\)</span> is returned as a lower bound on the diameter
of <span class="math notranslate nohighlight">\(G\)</span>.  The time complexity of this algorithm is linear in the size of
<span class="math notranslate nohighlight">\(G\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'2Dsweep'</span></code> – Computes lower bound on the diameter of an unweighted
directed graph using directed version of <code class="docutils literal notranslate"><span class="pre">2sweep</span></code> as proposed in
<a class="reference internal" href="../../../references/index.html#broder2000" id="id2"><span>[Broder2000]</span></a>. If the digraph is not strongly connected, the returned
value is infinity.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'DHV'</span></code> – Computes diameter of unweighted undirected graph using the
algorithm proposed in <a class="reference internal" href="../../../references/index.html#dragan2018" id="id3"><span>[Dragan2018]</span></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'multi-sweep'</span></code> – Computes a lower bound on the diameter of an
unweighted undirected graph using several iterations of the <code class="docutils literal notranslate"><span class="pre">2sweep</span></code>
algorithms <a class="reference internal" href="../../../references/index.html#cghlm2013" id="id4"><span>[CGHLM2013]</span></a>. Roughly, it first uses <code class="docutils literal notranslate"><span class="pre">2sweep</span></code> to identify
two vertices <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(v\)</span> that are far apart. Then it selects a vertex
<span class="math notranslate nohighlight">\(w\)</span> that is at same distance from <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(v\)</span>.  This vertex <span class="math notranslate nohighlight">\(w\)</span> will
serve as the new source for another iteration of the <code class="docutils literal notranslate"><span class="pre">2sweep</span></code>
algorithm that may improve the current lower bound on the diameter.
This process is repeated as long as the lower bound on the diameter
is improved.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'iFUB'</span></code> – The iFUB (iterative Fringe Upper Bound) algorithm,
proposed in <a class="reference internal" href="../../../references/index.html#cgilm2010" id="id5"><span>[CGILM2010]</span></a>, computes the exact value of the diameter of an
unweighted undirected graph. It is based on the following observation:</p>
<blockquote>
<div><p>The diameter of the graph is equal to the maximum eccentricity of
a vertex. Let <span class="math notranslate nohighlight">\(v\)</span> be any vertex, and let <span class="math notranslate nohighlight">\(V\)</span> be partitionned into
<span class="math notranslate nohighlight">\(A\cup B\)</span> where:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}d(v,a) \leq i, \forall a \in A\\
d(v,b) \geq i, \forall b \in B\end{split}\]</div>
</div>
<p>As all vertices from <span class="math notranslate nohighlight">\(A\)</span> are at distance <span class="math notranslate nohighlight">\(\leq 2i\)</span> from each
other, a vertex <span class="math notranslate nohighlight">\(a\in A\)</span> with eccentricity <span class="math notranslate nohighlight">\(ecc(a)&gt;2i\)</span> is at
distance <span class="math notranslate nohighlight">\(ecc(a)\)</span> from some vertex <span class="math notranslate nohighlight">\(b\in B\)</span>.</p>
<p>Consequently, if we have already computed the maximum eccentricity
<span class="math notranslate nohighlight">\(m\)</span> of all vertices in <span class="math notranslate nohighlight">\(B\)</span> and if <span class="math notranslate nohighlight">\(m&gt;2i\)</span>, then we do not need to
compute the eccentricity of the vertices in <span class="math notranslate nohighlight">\(A\)</span>.</p>
</div></blockquote>
<p>Starting from a vertex <span class="math notranslate nohighlight">\(v\)</span> obtained through a multi-sweep computation
(which refines the 4sweep algorithm used in <a class="reference internal" href="../../../references/index.html#cghlm2013" id="id6"><span>[CGHLM2013]</span></a>), we compute
the diameter by computing the eccentricity of all vertices sorted
decreasingly according to their distance to <span class="math notranslate nohighlight">\(v\)</span>, and stop as allowed
by the remark above. The worst case time complexity of the iFUB
algorithm is <span class="math notranslate nohighlight">\(O(nm)\)</span>, but it can be very fast in practice.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">'DiFUB'</span></code> – The directed version of iFUB (iterative Fringe Upper
Bound) algorithm. See the code’s documentation and <a class="reference internal" href="../../../references/index.html#cglm2012" id="id7"><span>[CGLM2012]</span></a> for more
details. If the digraph is not strongly connected, the returned value is
infinity.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">source</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) vertex from which to start the first BFS.
If <code class="docutils literal notranslate"><span class="pre">source==None</span></code>, an arbitrary vertex of the graph is chosen. Raise an
error if the initial vertex is not in <span class="math notranslate nohighlight">\(G\)</span>.  This parameter is not used
when <code class="docutils literal notranslate"><span class="pre">algorithm=='standard'</span></code>.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.distances_all_pairs</span> <span class="kn">import</span> <span class="n">diameter</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">diameter</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;iFUB&#39;</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">diameter</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;iFUB&#39;</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">Circuit</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">diameter</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;2Dsweep&#39;</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">diameter</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;DiFUB&#39;</span><span class="p">)</span>
<span class="go">6</span>
</pre></div>
</div>
<p>Although max( ) is usually defined as -Infinity, since the diameter will
never be negative, we define it to be zero:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">EmptyGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">diameter</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;iFUB&#39;</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Comparison of exact algorithms for graphs:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomBarabasiAlbert</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d1</span> <span class="o">=</span> <span class="n">diameter</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;standard&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d2</span> <span class="o">=</span> <span class="n">diameter</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;iFUB&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d3</span> <span class="o">=</span> <span class="n">diameter</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;iFUB&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">G</span><span class="o">.</span><span class="n">random_vertex</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">d4</span> <span class="o">=</span> <span class="n">diameter</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;DHV&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">if</span> <span class="n">d1</span> <span class="o">!=</span> <span class="n">d2</span> <span class="ow">or</span> <span class="n">d1</span> <span class="o">!=</span> <span class="n">d3</span> <span class="ow">or</span> <span class="n">d1</span> <span class="o">!=</span> <span class="n">d4</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Something goes wrong!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Comparison of lower bound algorithms:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">lb2</span> <span class="o">=</span> <span class="n">diameter</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;2sweep&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">lbm</span> <span class="o">=</span> <span class="n">diameter</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;multi-sweep&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">lb2</span> <span class="o">&lt;=</span> <span class="n">lbm</span> <span class="ow">and</span> <span class="n">lbm</span> <span class="o">&lt;=</span> <span class="n">d3</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Something goes wrong!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Comparison of exact algorithms for digraphs:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">RandomBarabasiAlbert</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">d1</span> <span class="o">=</span> <span class="n">diameter</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;standard&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d2</span> <span class="o">=</span> <span class="n">diameter</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;DiFUB&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d3</span> <span class="o">=</span> <span class="n">diameter</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;DiFUB&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">D</span><span class="o">.</span><span class="n">random_vertex</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">d1</span> <span class="o">==</span> <span class="n">d2</span> <span class="ow">and</span> <span class="n">d1</span> <span class="o">==</span> <span class="n">d3</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.graphs.distances_all_pairs.distances_all_pairs">
<span class="sig-prename descclassname"><span class="pre">sage.graphs.distances_all_pairs.</span></span><span class="sig-name descname"><span class="pre">distances_all_pairs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.distances_all_pairs.distances_all_pairs" title="Permalink to this definition">#</a></dt>
<dd><p>Return the matrix of distances in G.</p>
<p>This function returns a double dictionary <code class="docutils literal notranslate"><span class="pre">D</span></code> of vertices, in which the
distance between vertices <code class="docutils literal notranslate"><span class="pre">u</span></code> and <code class="docutils literal notranslate"><span class="pre">v</span></code> is <code class="docutils literal notranslate"><span class="pre">D[u][v]</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.distances_all_pairs</span> <span class="kn">import</span> <span class="n">distances_all_pairs</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">distances_all_pairs</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">{0: {0: 0, 1: 1, 2: 2, 3: 2, 4: 1, 5: 1, 6: 2, 7: 2, 8: 2, 9: 2},</span>
<span class="go">1: {0: 1, 1: 0, 2: 1, 3: 2, 4: 2, 5: 2, 6: 1, 7: 2, 8: 2, 9: 2},</span>
<span class="go">2: {0: 2, 1: 1, 2: 0, 3: 1, 4: 2, 5: 2, 6: 2, 7: 1, 8: 2, 9: 2},</span>
<span class="go">3: {0: 2, 1: 2, 2: 1, 3: 0, 4: 1, 5: 2, 6: 2, 7: 2, 8: 1, 9: 2},</span>
<span class="go">4: {0: 1, 1: 2, 2: 2, 3: 1, 4: 0, 5: 2, 6: 2, 7: 2, 8: 2, 9: 1},</span>
<span class="go">5: {0: 1, 1: 2, 2: 2, 3: 2, 4: 2, 5: 0, 6: 2, 7: 1, 8: 1, 9: 2},</span>
<span class="go">6: {0: 2, 1: 1, 2: 2, 3: 2, 4: 2, 5: 2, 6: 0, 7: 2, 8: 1, 9: 1},</span>
<span class="go">7: {0: 2, 1: 2, 2: 1, 3: 2, 4: 2, 5: 1, 6: 2, 7: 0, 8: 2, 9: 1},</span>
<span class="go">8: {0: 2, 1: 2, 2: 2, 3: 1, 4: 2, 5: 1, 6: 1, 7: 2, 8: 0, 9: 2},</span>
<span class="go">9: {0: 2, 1: 2, 2: 2, 3: 2, 4: 1, 5: 2, 6: 1, 7: 1, 8: 2, 9: 0}}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.graphs.distances_all_pairs.distances_and_predecessors_all_pairs">
<span class="sig-prename descclassname"><span class="pre">sage.graphs.distances_all_pairs.</span></span><span class="sig-name descname"><span class="pre">distances_and_predecessors_all_pairs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.distances_all_pairs.distances_and_predecessors_all_pairs" title="Permalink to this definition">#</a></dt>
<dd><p>Return the matrix of distances in G and the matrix of predecessors.</p>
<p>Distances : the matrix <span class="math notranslate nohighlight">\(M\)</span> returned is of length <span class="math notranslate nohighlight">\(n^2\)</span>, and the distance
between vertices <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(v\)</span> is <span class="math notranslate nohighlight">\(M[u,v]\)</span>. The integer corresponding to a
vertex is its index in the list <code class="docutils literal notranslate"><span class="pre">G.vertices(sort=True)</span></code>.</p>
<p>Predecessors : the matrix <span class="math notranslate nohighlight">\(P\)</span> returned has size <span class="math notranslate nohighlight">\(n^2\)</span>, and is such that
vertex <span class="math notranslate nohighlight">\(P[u,v]\)</span> is a predecessor of <span class="math notranslate nohighlight">\(v\)</span> on a shortest <span class="math notranslate nohighlight">\(uv\)</span>-path. Hence, this
matrix efficiently encodes the information of a shortest <span class="math notranslate nohighlight">\(uv\)</span>-path for any
<span class="math notranslate nohighlight">\(u,v\in G\)</span> : indeed, to go from <span class="math notranslate nohighlight">\(u\)</span> to <span class="math notranslate nohighlight">\(v\)</span> you should first find a shortest
<span class="math notranslate nohighlight">\(uP[u,v]\)</span>-path, then jump from <span class="math notranslate nohighlight">\(P[u,v]\)</span> to <span class="math notranslate nohighlight">\(v\)</span> as it is one of its
outneighbors.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.distances_all_pairs</span> <span class="kn">import</span> <span class="n">distances_and_predecessors_all_pairs</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">distances_and_predecessors_all_pairs</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">({0: {0: 0, 1: 1, 2: 2, 3: 2, 4: 1, 5: 1, 6: 2, 7: 2, 8: 2, 9: 2},</span>
<span class="go">  1: {0: 1, 1: 0, 2: 1, 3: 2, 4: 2, 5: 2, 6: 1, 7: 2, 8: 2, 9: 2},</span>
<span class="go">  2: {0: 2, 1: 1, 2: 0, 3: 1, 4: 2, 5: 2, 6: 2, 7: 1, 8: 2, 9: 2},</span>
<span class="go">  3: {0: 2, 1: 2, 2: 1, 3: 0, 4: 1, 5: 2, 6: 2, 7: 2, 8: 1, 9: 2},</span>
<span class="go">  4: {0: 1, 1: 2, 2: 2, 3: 1, 4: 0, 5: 2, 6: 2, 7: 2, 8: 2, 9: 1},</span>
<span class="go">  5: {0: 1, 1: 2, 2: 2, 3: 2, 4: 2, 5: 0, 6: 2, 7: 1, 8: 1, 9: 2},</span>
<span class="go">  6: {0: 2, 1: 1, 2: 2, 3: 2, 4: 2, 5: 2, 6: 0, 7: 2, 8: 1, 9: 1},</span>
<span class="go">  7: {0: 2, 1: 2, 2: 1, 3: 2, 4: 2, 5: 1, 6: 2, 7: 0, 8: 2, 9: 1},</span>
<span class="go">  8: {0: 2, 1: 2, 2: 2, 3: 1, 4: 2, 5: 1, 6: 1, 7: 2, 8: 0, 9: 2},</span>
<span class="go">  9: {0: 2, 1: 2, 2: 2, 3: 2, 4: 1, 5: 2, 6: 1, 7: 1, 8: 2, 9: 0}},</span>
<span class="go"> {0: {0: None, 1: 0, 2: 1, 3: 4, 4: 0, 5: 0, 6: 1, 7: 5, 8: 5, 9: 4},</span>
<span class="go">  1: {0: 1, 1: None, 2: 1, 3: 2, 4: 0, 5: 0, 6: 1, 7: 2, 8: 6, 9: 6},</span>
<span class="go">  2: {0: 1, 1: 2, 2: None, 3: 2, 4: 3, 5: 7, 6: 1, 7: 2, 8: 3, 9: 7},</span>
<span class="go">  3: {0: 4, 1: 2, 2: 3, 3: None, 4: 3, 5: 8, 6: 8, 7: 2, 8: 3, 9: 4},</span>
<span class="go">  4: {0: 4, 1: 0, 2: 3, 3: 4, 4: None, 5: 0, 6: 9, 7: 9, 8: 3, 9: 4},</span>
<span class="go">  5: {0: 5, 1: 0, 2: 7, 3: 8, 4: 0, 5: None, 6: 8, 7: 5, 8: 5, 9: 7},</span>
<span class="go">  6: {0: 1, 1: 6, 2: 1, 3: 8, 4: 9, 5: 8, 6: None, 7: 9, 8: 6, 9: 6},</span>
<span class="go">  7: {0: 5, 1: 2, 2: 7, 3: 2, 4: 9, 5: 7, 6: 9, 7: None, 8: 5, 9: 7},</span>
<span class="go">  8: {0: 5, 1: 6, 2: 3, 3: 8, 4: 3, 5: 8, 6: 8, 7: 5, 8: None, 9: 6},</span>
<span class="go">  9: {0: 4, 1: 6, 2: 7, 3: 4, 4: 9, 5: 7, 6: 9, 7: 9, 8: 6, 9: None}})</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.graphs.distances_all_pairs.distances_distribution">
<span class="sig-prename descclassname"><span class="pre">sage.graphs.distances_all_pairs.</span></span><span class="sig-name descname"><span class="pre">distances_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.distances_all_pairs.distances_distribution" title="Permalink to this definition">#</a></dt>
<dd><p>Return the distances distribution of the (di)graph in a dictionary.</p>
<p>This method <em>ignores all edge labels</em>, so that the distance considered is
the topological distance.</p>
<p>OUTPUT:</p>
<blockquote>
<div><p>A dictionary <code class="docutils literal notranslate"><span class="pre">d</span></code> such that the number of pairs of vertices at distance
<code class="docutils literal notranslate"><span class="pre">k</span></code> (if any) is equal to <span class="math notranslate nohighlight">\(d[k] \cdot |V(G)| \cdot (|V(G)|-1)\)</span>.</p>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We consider that two vertices that do not belong to the same connected
component are at infinite distance, and we do not take the trivial pairs
of vertices <span class="math notranslate nohighlight">\((v, v)\)</span> at distance <span class="math notranslate nohighlight">\(0\)</span> into account. Empty (di)graphs and
(di)graphs of order 1 have no paths and so we return the empty
dictionary <code class="docutils literal notranslate"><span class="pre">{}</span></code>.</p>
</div>
<p>EXAMPLES:</p>
<p>An empty Graph:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">distances_distribution</span><span class="p">()</span>
<span class="go">{}</span>
</pre></div>
</div>
<p>A Graph of order 1:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">distances_distribution</span><span class="p">()</span>
<span class="go">{}</span>
</pre></div>
</div>
<p>A Graph of order 2 without edge:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_vertices</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">distances_distribution</span><span class="p">()</span>
<span class="go">{+Infinity: 1}</span>
</pre></div>
</div>
<p>The Petersen Graph:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">distances_distribution</span><span class="p">()</span>
<span class="go">{1: 1/3, 2: 2/3}</span>
</pre></div>
</div>
<p>A graph with multiple disconnected components:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s1">&#39;good&#39;</span><span class="p">,</span><span class="s1">&#39;wine&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">distances_distribution</span><span class="p">()</span>
<span class="go">{1: 8/33, 2: 5/11, +Infinity: 10/33}</span>
</pre></div>
</div>
<p>The de Bruijn digraph dB(2,3):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">DeBruijn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">distances_distribution</span><span class="p">()</span>
<span class="go">{1: 1/4, 2: 11/28, 3: 5/14}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.graphs.distances_all_pairs.eccentricity">
<span class="sig-prename descclassname"><span class="pre">sage.graphs.distances_all_pairs.</span></span><span class="sig-name descname"><span class="pre">eccentricity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'standard'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertex_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.distances_all_pairs.eccentricity" title="Permalink to this definition">#</a></dt>
<dd><p>Return the vector of eccentricities in G.</p>
<p>The array returned is of length <span class="math notranslate nohighlight">\(n\)</span>, and its <span class="math notranslate nohighlight">\(i\)</span>-th component is the
eccentricity of the ith vertex in <code class="docutils literal notranslate"><span class="pre">G.vertices(sort=True)</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">G</span></code> – a Graph or a DiGraph.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – string (default: <code class="docutils literal notranslate"><span class="pre">'standard'</span></code>); name of the method used
to compute the eccentricity of the vertices.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'standard'</span></code> – Computes eccentricity by performing a BFS from each
vertex.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'bounds'</span></code> – Computes eccentricity using the fast algorithm proposed
in <a class="reference internal" href="../../../references/index.html#tk2013" id="id8"><span>[TK2013]</span></a> for undirected graphs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'DHV'</span></code> – Computes all eccentricities of undirected graph using the
algorithm proposed in <a class="reference internal" href="../../../references/index.html#dragan2018" id="id9"><span>[Dragan2018]</span></a>.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">vertex_list</span></code> – list (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); a list of <span class="math notranslate nohighlight">\(n\)</span> vertices
specifying a mapping from <span class="math notranslate nohighlight">\((0, \ldots, n-1)\)</span> to vertex labels in <span class="math notranslate nohighlight">\(G\)</span>. When
set, <code class="docutils literal notranslate"><span class="pre">ecc[i]</span></code> is the eccentricity of vertex <code class="docutils literal notranslate"><span class="pre">vertex_list[i]</span></code>. When
<code class="docutils literal notranslate"><span class="pre">vertex_list</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">ecc[i]</span></code> is the eccentricity of vertex
<code class="docutils literal notranslate"><span class="pre">G.vertices(sort=True)[i]</span></code>.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.distances_all_pairs</span> <span class="kn">import</span> <span class="n">eccentricity</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">eccentricity</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">[2, 2, 2, 2, 2, 2, 2, 2, 2, 2]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">add_vertex</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">eccentricity</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">vertex_list</span><span class="o">=</span><span class="n">V</span><span class="p">)</span>
<span class="go">[2, 2, 3, 3, 2, 2, 3, 3, 3, 3, 3]</span>
<span class="gp">sage: </span><span class="n">eccentricity</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">vertex_list</span><span class="o">=</span><span class="n">V</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="go">[3, 3, 3, 3, 3, 2, 2, 3, 3, 2, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.graphs.distances_all_pairs.floyd_warshall">
<span class="sig-prename descclassname"><span class="pre">sage.graphs.distances_all_pairs.</span></span><span class="sig-name descname"><span class="pre">floyd_warshall</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">paths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distances</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.distances_all_pairs.floyd_warshall" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the shortest path/distances between all pairs of vertices.</p>
<p>For more information on the Floyd-Warshall algorithm, see
the <a class="reference external" href="https://en.wikipedia.org/wiki/Floyd-Warshall_algorithm">Wikipedia article Floyd-Warshall_algorithm</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gg</span></code> – the graph on which to work.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">paths</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); whether to return the dictionary
of shortest paths</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">distances</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); whether to return the
dictionary of distances</p></li>
</ul>
<p>OUTPUT:</p>
<p>Depending on the input, this function return the dictionary of paths, the
dictionary of distances, or a pair of dictionaries <code class="docutils literal notranslate"><span class="pre">(distances,</span> <span class="pre">paths)</span></code>
where <code class="docutils literal notranslate"><span class="pre">distance[u][v]</span></code> denotes the distance of a shortest path from <span class="math notranslate nohighlight">\(u\)</span> to
<span class="math notranslate nohighlight">\(v\)</span> and <code class="docutils literal notranslate"><span class="pre">paths[u][v]</span></code> denotes an inneighbor <span class="math notranslate nohighlight">\(w\)</span> of <span class="math notranslate nohighlight">\(v\)</span> such that
<span class="math notranslate nohighlight">\(dist(u,v) = 1 + dist(u,w)\)</span>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Because this function works on matrices whose size is quadratic compared
to the number of vertices, it uses short variables instead of long ones
to divide by 2 the size in memory. This means that the current
implementation does not run on a graph of more than 65536 nodes (this
can be easily changed if necessary, but would require much more
memory. It may be worth writing two versions). For information, the
current version of the algorithm on a graph with <span class="math notranslate nohighlight">\(65536 = 2^{16}\)</span> nodes
creates in memory <span class="math notranslate nohighlight">\(2\)</span> tables on <span class="math notranslate nohighlight">\(2^{32}\)</span> short elements (2bytes each),
for a total of <span class="math notranslate nohighlight">\(2^{34}\)</span> bytes or <span class="math notranslate nohighlight">\(16\)</span> gigabytes. Let us also remember
that if the memory size is quadratic, the algorithm runs in cubic time.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When <code class="docutils literal notranslate"><span class="pre">paths</span> <span class="pre">=</span> <span class="pre">False</span></code> the algorithm saves roughly half of the memory as
it does not have to maintain the matrix of predecessors. However,
setting <code class="docutils literal notranslate"><span class="pre">distances=False</span></code> produces no such effect as the algorithm can
not run without computing them. They will not be returned, but they will
be stored while the method is running.</p>
</div>
<p>EXAMPLES:</p>
<p>Shortest paths in a small grid</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">Grid2dGraph</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.distances_all_pairs</span> <span class="kn">import</span> <span class="n">floyd_warshall</span>
<span class="gp">sage: </span><span class="nb">print</span><span class="p">(</span><span class="n">floyd_warshall</span><span class="p">(</span><span class="n">g</span><span class="p">))</span>
<span class="go">{(0, 0): {(0, 0): None, (0, 1): (0, 0), (1, 0): (0, 0), (1, 1): (0, 1)},</span>
<span class="go"> (0, 1): {(0, 1): None, (0, 0): (0, 1), (1, 0): (0, 0), (1, 1): (0, 1)},</span>
<span class="go"> (1, 0): {(1, 0): None, (0, 0): (1, 0), (0, 1): (0, 0), (1, 1): (1, 0)},</span>
<span class="go"> (1, 1): {(1, 1): None, (0, 0): (0, 1), (0, 1): (1, 1), (1, 0): (1, 1)}}</span>
</pre></div>
</div>
<p>Checking the distances are correct</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">Grid2dGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">dist</span><span class="p">,</span><span class="n">path</span> <span class="o">=</span> <span class="n">floyd_warshall</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">distances</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">dist</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="o">==</span> <span class="n">g</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">g</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Checking a random path is valid</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">random_vertex</span><span class="p">(),</span> <span class="n">g</span><span class="o">.</span><span class="n">random_vertex</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">]</span>
<span class="gp">sage: </span><span class="k">while</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">....: </span>  <span class="n">p</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">path</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="n">dist</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Distances for all pairs of vertices in a diamond:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">DiamondGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">floyd_warshall</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">paths</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">distances</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">{0: {0: 0, 1: 1, 2: 1, 3: 2},</span>
<span class="go"> 1: {0: 1, 1: 0, 2: 1, 3: 1},</span>
<span class="go"> 2: {0: 1, 1: 1, 2: 0, 3: 1},</span>
<span class="go"> 3: {0: 2, 1: 1, 2: 1, 3: 0}}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.graphs.distances_all_pairs.is_distance_regular">
<span class="sig-prename descclassname"><span class="pre">sage.graphs.distances_all_pairs.</span></span><span class="sig-name descname"><span class="pre">is_distance_regular</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.distances_all_pairs.is_distance_regular" title="Permalink to this definition">#</a></dt>
<dd><p>Test if the graph is distance-regular</p>
<p>A graph <span class="math notranslate nohighlight">\(G\)</span> is distance-regular if for any integers <span class="math notranslate nohighlight">\(j,k\)</span> the value of
<span class="math notranslate nohighlight">\(|\{x:d_G(x,u)=j,x\in V(G)\} \cap \{y:d_G(y,v)=j,y\in V(G)\}|\)</span> is constant
for any two vertices <span class="math notranslate nohighlight">\(u,v\in V(G)\)</span> at distance <span class="math notranslate nohighlight">\(i\)</span> from each other. In
particular <span class="math notranslate nohighlight">\(G\)</span> is regular, of degree <span class="math notranslate nohighlight">\(b_0\)</span> (see below), as one can take
<span class="math notranslate nohighlight">\(u=v\)</span>.</p>
<p>Equivalently a graph is distance-regular if there exist integers <span class="math notranslate nohighlight">\(b_i,c_i\)</span>
such that for any two vertices <span class="math notranslate nohighlight">\(u,v\)</span> at distance <span class="math notranslate nohighlight">\(i\)</span> we have</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(b_i = |\{x:d_G(x,u)=i+1,x\in V(G)\}\cap N_G(v)\}|, \ 0\leq i\leq d-1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(c_i = |\{x:d_G(x,u)=i-1,x\in V(G)\}\cap N_G(v)\}|, \ 1\leq i\leq d,\)</span></p></li>
</ul>
<p>where <span class="math notranslate nohighlight">\(d\)</span> is the diameter of the graph.  For more information on
distance-regular graphs, see the <a class="reference external" href="https://en.wikipedia.org/wiki/Distance-regular_graph">Wikipedia article Distance-regular_graph</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">parameters</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); if set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the
function returns the pair <code class="docutils literal notranslate"><span class="pre">(b,</span> <span class="pre">c)</span></code> of lists of integers instead of
a boolean answer (see the definition above)</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.is_regular" title="sage.graphs.generic_graph.GenericGraph.is_regular"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_regular()</span></code></a></p></li>
<li><p><a class="reference internal" href="graph.html#sage.graphs.graph.Graph.is_strongly_regular" title="sage.graphs.graph.Graph.is_strongly_regular"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_strongly_regular()</span></code></a></p></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_distance_regular</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_distance_regular</span><span class="p">(</span><span class="n">parameters</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">([3, 2, None], [None, 1, 1])</span>
</pre></div>
</div>
<p>Cube graphs, which are not strongly regular, are a bit more interesting:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">is_distance_regular</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">graphs</span><span class="o">.</span><span class="n">OddGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">is_distance_regular</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Disconnected graph:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">.</span><span class="n">is_distance_regular</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.graphs.distances_all_pairs.radius_DHV">
<span class="sig-prename descclassname"><span class="pre">sage.graphs.distances_all_pairs.</span></span><span class="sig-name descname"><span class="pre">radius_DHV</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.distances_all_pairs.radius_DHV" title="Permalink to this definition">#</a></dt>
<dd><p>Return the radius of unweighted graph <span class="math notranslate nohighlight">\(G\)</span>.</p>
<p>This method computes the radius of unweighted undirected graph using the
algorithm given in <a class="reference internal" href="../../../references/index.html#dragan2018" id="id10"><span>[Dragan2018]</span></a>.</p>
<p>This method returns Infinity if graph is not connected.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.distances_all_pairs</span> <span class="kn">import</span> <span class="n">radius_DHV</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">radius_DHV</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomGNP</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mf">0.3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.distances_all_pairs</span> <span class="kn">import</span> <span class="n">eccentricity</span>
<span class="gp">sage: </span><span class="n">radius_DHV</span><span class="p">(</span><span class="n">G</span><span class="p">)</span> <span class="o">==</span> <span class="nb">min</span><span class="p">(</span><span class="n">eccentricity</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;bounds&#39;</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.graphs.distances_all_pairs.shortest_path_all_pairs">
<span class="sig-prename descclassname"><span class="pre">sage.graphs.distances_all_pairs.</span></span><span class="sig-name descname"><span class="pre">shortest_path_all_pairs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.distances_all_pairs.shortest_path_all_pairs" title="Permalink to this definition">#</a></dt>
<dd><p>Return the matrix of predecessors in G.</p>
<p>The matrix <span class="math notranslate nohighlight">\(P\)</span> returned has size <span class="math notranslate nohighlight">\(n^2\)</span>, and is such that vertex <span class="math notranslate nohighlight">\(P[u,v]\)</span> is
a predecessor of <span class="math notranslate nohighlight">\(v\)</span> on a shortest <span class="math notranslate nohighlight">\(uv\)</span>-path. Hence, this matrix efficiently
encodes the information of a shortest <span class="math notranslate nohighlight">\(uv\)</span>-path for any <span class="math notranslate nohighlight">\(u,v\in G\)</span> : indeed,
to go from <span class="math notranslate nohighlight">\(u\)</span> to <span class="math notranslate nohighlight">\(v\)</span> you should first find a shortest <span class="math notranslate nohighlight">\(uP[u,v]\)</span>-path, then
jump from <span class="math notranslate nohighlight">\(P[u,v]\)</span> to <span class="math notranslate nohighlight">\(v\)</span> as it is one of its outneighbors.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.distances_all_pairs</span> <span class="kn">import</span> <span class="n">shortest_path_all_pairs</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">shortest_path_all_pairs</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">{0: {0: None, 1: 0, 2: 1, 3: 4, 4: 0, 5: 0, 6: 1, 7: 5, 8: 5, 9: 4},</span>
<span class="go"> 1: {0: 1, 1: None, 2: 1, 3: 2, 4: 0, 5: 0, 6: 1, 7: 2, 8: 6, 9: 6},</span>
<span class="go"> 2: {0: 1, 1: 2, 2: None, 3: 2, 4: 3, 5: 7, 6: 1, 7: 2, 8: 3, 9: 7},</span>
<span class="go"> 3: {0: 4, 1: 2, 2: 3, 3: None, 4: 3, 5: 8, 6: 8, 7: 2, 8: 3, 9: 4},</span>
<span class="go"> 4: {0: 4, 1: 0, 2: 3, 3: 4, 4: None, 5: 0, 6: 9, 7: 9, 8: 3, 9: 4},</span>
<span class="go"> 5: {0: 5, 1: 0, 2: 7, 3: 8, 4: 0, 5: None, 6: 8, 7: 5, 8: 5, 9: 7},</span>
<span class="go"> 6: {0: 1, 1: 6, 2: 1, 3: 8, 4: 9, 5: 8, 6: None, 7: 9, 8: 6, 9: 6},</span>
<span class="go"> 7: {0: 5, 1: 2, 2: 7, 3: 2, 4: 9, 5: 7, 6: 9, 7: None, 8: 5, 9: 7},</span>
<span class="go"> 8: {0: 5, 1: 6, 2: 3, 3: 8, 4: 3, 5: 8, 6: 8, 7: 5, 8: None, 9: 6},</span>
<span class="go"> 9: {0: 4, 1: 6, 2: 7, 3: 4, 4: 9, 5: 7, 6: 9, 7: 9, 8: 6, 9: None}}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.graphs.distances_all_pairs.szeged_index">
<span class="sig-prename descclassname"><span class="pre">sage.graphs.distances_all_pairs.</span></span><span class="sig-name descname"><span class="pre">szeged_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.distances_all_pairs.szeged_index" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Szeged index of the graph <span class="math notranslate nohighlight">\(G\)</span>.</p>
<p>Let <span class="math notranslate nohighlight">\(G = (V, E)\)</span> be a connected graph, and for any <span class="math notranslate nohighlight">\(uv\in E\)</span>, let <span class="math notranslate nohighlight">\(N_u(uv) =
\{w\in V:d(u,w)&lt;d(v,w)\}\)</span> and <span class="math notranslate nohighlight">\(n_u(uv)=|N_u(uv)|\)</span>. The Szeged index of <span class="math notranslate nohighlight">\(G\)</span>
is then defined as <a class="reference internal" href="../../../references/index.html#krg1996" id="id11"><span>[KRG1996]</span></a></p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[`\sum_{uv \in E(G)}n_u(uv)\times n_v(uv)`\]</div>
</div>
<p>See the <a class="reference external" href="https://en.wikipedia.org/wiki/Szeged_index">Wikipedia article Szeged_index</a> for more details.</p>
<p>INPUT:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">G</span></code> – a Sage graph</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – string (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); algorithm to use among:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;low&quot;</span></code> – algorithm with time complexity in <span class="math notranslate nohighlight">\(O(nm)\)</span> and space
complexity in <span class="math notranslate nohighlight">\(O(m)\)</span>. This implementation is currently valid only for
simple (without loops or multiple edges) connected graphs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;high&quot;</span></code> – algorithm with time complexity in <span class="math notranslate nohighlight">\(O(nm)\)</span> and space
complexity in <span class="math notranslate nohighlight">\(O(n^2)\)</span>. It cannot be used on graphs with more than
<span class="math notranslate nohighlight">\(65536 = 2^{16}\)</span> vertices.</p></li>
</ul>
<p>By default (<code class="docutils literal notranslate"><span class="pre">None</span></code>), the <code class="docutils literal notranslate"><span class="pre">&quot;low&quot;</span></code> algorithm is used for graphs and the
<code class="docutils literal notranslate"><span class="pre">&quot;high&quot;</span></code> algorithm for digraphs.</p>
</li>
</ul>
<p>EXAMPLES:</p>
<p>True for any connected graph <a class="reference internal" href="../../../references/index.html#krg1996" id="id12"><span>[KRG1996]</span></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.distances_all_pairs</span> <span class="kn">import</span> <span class="n">szeged_index</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">wiener_index</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">szeged_index</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>True for all trees <a class="reference internal" href="../../../references/index.html#krg1996" id="id13"><span>[KRG1996]</span></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CubeGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">min_spanning_tree</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">wiener_index</span><span class="p">()</span> <span class="o">==</span> <span class="n">szeged_index</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Check that both algorithms return same value:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomBarabasiAlbert</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">szeged_index</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;low&#39;</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">szeged_index</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;high&#39;</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">==</span> <span class="n">b</span>  <span class="c1"># long time</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The Szeged index of a directed circuit of order <span class="math notranslate nohighlight">\(n\)</span> is <span class="math notranslate nohighlight">\((n-1)^2\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">digraphs</span><span class="o">.</span><span class="n">Circuit</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">szeged_index</span><span class="p">()</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)]</span>
<span class="go">[0, 1, 4, 9, 16, 25, 36]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.graphs.distances_all_pairs.wiener_index">
<span class="sig-prename descclassname"><span class="pre">sage.graphs.distances_all_pairs.</span></span><span class="sig-name descname"><span class="pre">wiener_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.distances_all_pairs.wiener_index" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Wiener index of the graph.</p>
<p>The Wiener index of an undirected graph <span class="math notranslate nohighlight">\(G\)</span> is defined as
<span class="math notranslate nohighlight">\(W(G) = \frac{1}{2} \sum_{u,v\in G} d(u,v)\)</span> where <span class="math notranslate nohighlight">\(d(u,v)\)</span> denotes the
distance between vertices <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(v\)</span> (see <a class="reference internal" href="../../../references/index.html#krg1996" id="id14"><span>[KRG1996]</span></a>).</p>
<p>The Wiener index of a directed graph <span class="math notranslate nohighlight">\(G\)</span> is defined as the sum of the
distances between each pairs of vertices, <span class="math notranslate nohighlight">\(W(G) = \sum_{u,v\in G} d(u,v)\)</span>.</p>
<p>EXAMPLES:</p>
<p>From <a class="reference internal" href="../../../references/index.html#gyll1993" id="id15"><span>[GYLL1993]</span></a>, cited in <a class="reference internal" href="../../../references/index.html#krg1996" id="id16"><span>[KRG1996]</span></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">wiener_index</span><span class="p">()</span><span class="o">==</span><span class="n">w</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Wiener index of complete (di)graphs:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">wiener_index</span><span class="p">()</span> <span class="o">==</span> <span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">wiener_index</span><span class="p">()</span> <span class="o">==</span> <span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Wiener index of a graph of order 1:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Graph</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">wiener_index</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<p>The Wiener index is not defined on the empty graph:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Graph</span><span class="p">()</span><span class="o">.</span><span class="n">wiener_index</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Wiener index is not defined for the empty graph</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="graph_latex.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">LaTeX options for graphs</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="weakly_chordal.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Weakly chordal graphs</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2022, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Distances/shortest paths between all pairs of vertices</a><ul>
<li><a class="reference internal" href="#the-module-s-main-function">The module’s main function</a></li>
<li><a class="reference internal" href="#functions">Functions</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/scripts/furo.js"></script>
    <script src="../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="../../../_static/mathjax/tex-chtml.js"></script>
    </body>
</html>