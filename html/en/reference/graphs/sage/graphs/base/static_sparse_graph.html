<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="Static sparse graph backend" href="static_sparse_backend.html" /><link rel="prev" title="Static dense graphs" href="static_dense_graph.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>Static sparse graphs - Graph Theory</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-furo.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Graph Theory</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 10.1 Reference Manual</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../../index.html">Home - Graph Theory</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../generic_graph.html">Generic graphs (common to directed/undirected)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graph.html">Undirected graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../digraph.html">Directed graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bipartite_graph.html">Bipartite graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../views.html">View classes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../graph_generators.html">Common graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../digraph_generators.html">Common digraphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graph_generators_pyx.html">Common graphs and digraphs generators (Cython)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graph_database.html">Graph database</a></li>
<li class="toctree-l1"><a class="reference internal" href="../strongly_regular_db.html">Database of strongly regular graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generators/distance_regular.html">Database of distance regular graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generators/classical_geometries.html">Families of graphs derived from classical geometries over finite fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generators/families.html">Various families of graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generators/basic.html">Basic graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generators/chessboard.html">Chessboard graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generators/intersection.html">Intersection graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generators/platonic_solids.html">1-skeletons of Platonic solids</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generators/random.html">Random graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generators/smallgraphs.html">Various small graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generators/world_map.html">Graphs from the World Map</a></li>
<li class="toctree-l1"><a class="reference internal" href="../isgci.html">ISGCI: Information System on Graph Classes and their Inclusions</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview of (di)graph data structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="c_graph.html">Fast compiled graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="sparse_graph.html">Fast sparse graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="dense_graph.html">Fast dense graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="static_dense_graph.html">Static dense graphs</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Static sparse graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="static_sparse_backend.html">Static sparse graph backend</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_backends.html">Backends for Sage (di)graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="boost_graph.html">Interface to run Boost algorithms</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../hypergraph_generators.html">Hypergraph generators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../combinat/designs/incidence_structures.html">Incidence structures (i.e. hypergraphs, i.e. set systems)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../graph_coloring.html">Graph coloring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cliquer.html">Interface with Cliquer (clique-related problems)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../centrality.html">Centrality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../asteroidal_triples.html">Asteroidal triples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../independent_sets.html">Independent sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../comparability.html">Comparability and permutation graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../line_graph.html">Line graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spanning_tree.html">Spanning trees</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pq_trees.html">PQ-Trees</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trees.html">Generation of trees</a></li>
<li class="toctree-l1"><a class="reference internal" href="../matchpoly.html">Matching polynomial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genus.html">Genus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lovasz_theta.html">Lovász theta-function of graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../schnyder.html">Schnyder’s algorithm for straight-line planar embeddings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../planarity.html">Wrapper for Boyer’s (C) planarity algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../traversals.html">Graph traversals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graph_plot.html">Graph plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graph_plot_js.html">Graph plotting in Javascript with d3.js</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graph_decompositions/tree_decomposition.html">Tree decompositions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graph_decompositions/vertex_separation.html">Vertex separation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graph_decompositions/rankwidth.html">Rank Decompositions of graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graph_decompositions/bandwidth.html">Bandwidth of undirected graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graph_decompositions/cutwidth.html">Cutwidth</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graph_decompositions/graph_products.html">Products of graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graph_decompositions/modular_decomposition.html">Modular Decomposition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graph_decompositions/clique_separators.html">Decomposition by clique minimal separators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../convexity_properties.html">Convexity properties of graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../weakly_chordal.html">Weakly chordal graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../distances_all_pairs.html">Distances/shortest paths between all pairs of vertices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graph_latex.html">LaTeX options for graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graph_editor.html">Graph editor widget</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graph_list.html">Lists of graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graph_input.html">Functions for reading/building graphs/digraphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperbolicity.html">Hyperbolicity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutte_polynomial.html">Tutte polynomial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../partial_cube.html">Partial cubes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../path_enumeration.html">Path enumeration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generic_graph_pyx.html">GenericGraph Cython functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../orientations.html">Orientations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../connectivity.html">Connectivity related functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../edge_connectivity.html">Edge connectivity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../domination.html">Domination</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="static-sparse-graphs">
<span id="sage-graphs-base-static-sparse-graph"></span><h1>Static sparse graphs<a class="headerlink" href="#static-sparse-graphs" title="Permalink to this heading">#</a></h1>
<span class="target" id="module-sage.graphs.base.static_sparse_graph"></span><section id="what-is-the-point">
<h2>What is the point ?<a class="headerlink" href="#what-is-the-point" title="Permalink to this heading">#</a></h2>
<p>This class implements a Cython (di)graph structure made for efficiency. The
graphs are <em>static</em>, i.e. no add/remove vertex/edges methods are available, nor
can they easily or efficiently be implemented within this data structure.</p>
<p>The data structure, however, is made to save the maximum amount of computations
for graph algorithms whose main operation is to <em>list the out-neighbours of a
vertex</em> (which is precisely what BFS, DFS, distance computations and the
flow-related stuff waste their life on).</p>
<p>The code contained in this module is written C-style. The purpose is efficiency
and simplicity.</p>
<p>For an overview of graph data structures in sage, see
<a class="reference internal" href="overview.html#module-sage.graphs.base.overview" title="sage.graphs.base.overview"><code class="xref py py-mod docutils literal notranslate"><span class="pre">overview</span></code></a>.</p>
<p>Author:</p>
<ul class="simple">
<li><p>Nathann Cohen (2011)</p></li>
</ul>
</section>
<section id="data-structure">
<h2>Data structure<a class="headerlink" href="#data-structure" title="Permalink to this heading">#</a></h2>
<img alt="../../../_images/structure.png" src="../../../_images/structure.png" />
<p>The data structure is actually pretty simple and compact. <code class="docutils literal notranslate"><span class="pre">short_digraph</span></code> has
five fields</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> (<code class="docutils literal notranslate"><span class="pre">int</span></code>); the number of vertices in the graph</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> (<code class="docutils literal notranslate"><span class="pre">int</span></code>); the number of edges in the graph</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">edges</span></code> (<code class="docutils literal notranslate"><span class="pre">uint32_t</span> <span class="pre">*</span></code>); array whose length is the number of edges of the
graph</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">neighbors</span></code> (<code class="docutils literal notranslate"><span class="pre">uint32_t</span> <span class="pre">**</span></code>); this array has size <span class="math notranslate nohighlight">\(n+1\)</span>, and describes how
the data of <code class="docutils literal notranslate"><span class="pre">edges</span></code> should be read : the neighbors of vertex <span class="math notranslate nohighlight">\(i\)</span> are the
elements of <code class="docutils literal notranslate"><span class="pre">edges</span></code> addressed by <code class="docutils literal notranslate"><span class="pre">neighbors[i]...neighbors[i+1]-1</span></code>. The
element <code class="docutils literal notranslate"><span class="pre">neighbors[n]</span></code>, which corresponds to no vertex (they are numbered
from <span class="math notranslate nohighlight">\(0\)</span> to <span class="math notranslate nohighlight">\(n-1\)</span>) is present so that it remains easy to enumerate the
neighbors of vertex <span class="math notranslate nohighlight">\(n-1\)</span> : the last of them is the element addressed by
<code class="docutils literal notranslate"><span class="pre">neighbors[n]-1</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">edge_labels</span></code> (<code class="docutils literal notranslate"><span class="pre">list</span></code>); this cython list associates a label to each edge
of the graph. If a given edge is represented by <code class="docutils literal notranslate"><span class="pre">edges[i]</span></code>, this its
associated label can be found at <code class="docutils literal notranslate"><span class="pre">edge_labels[i]</span></code>. This object is usually
NULL, unless the call to <code class="docutils literal notranslate"><span class="pre">init_short_digraph</span></code> explicitly requires the labels
to be stored in the data structure.</p></li>
</ul>
<p>In the example given above, vertex 0 has 2,3,5,7,8 and 9 as out-neighbors, but
not 4, which is an out-neighbour of vertex 1. Vertex <span class="math notranslate nohighlight">\(n-1\)</span> has 2, 5, 8 and 9 as
out-neighbors. <code class="docutils literal notranslate"><span class="pre">neighbors[n]</span></code> points toward the cell immediately <em>after</em> the
end of <code class="docutils literal notranslate"><span class="pre">edges</span></code>, hence <em>outside of the allocated memory</em>. It is used to
indicate the end of the outneighbors of vertex <span class="math notranslate nohighlight">\(n-1\)</span></p>
<p><strong>Iterating over the edges</strong></p>
<p>This is <em>the one thing</em> to have in mind when working with this data structure:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">cdef list_edges(short_digraph g):</span>
<span class="go">    cdef int i, j</span>
<span class="go">    for i in range(g.n):</span>
<span class="go">        for j in range(g.neighbors[i+1]-g.neighbors[i]):</span>
<span class="go">            print(&quot;There is an edge from {} to {}&quot;.format(i, g.neighbors[i][j]))</span>
</pre></div>
</div>
<p><strong>Advantages</strong></p>
<p>Two great points :</p>
<ul class="simple">
<li><p>The neighbors of a vertex are C types, and are contiguous in memory.</p></li>
<li><p>Storing such graphs is incredibly cheaper than storing Python structures.</p></li>
</ul>
<p>Well, I think it would be hard to have anything more efficient than that to
enumerate out-neighbors in sparse graphs ! :-)</p>
</section>
<section id="technical-details">
<h2>Technical details<a class="headerlink" href="#technical-details" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>When creating a <code class="docutils literal notranslate"><span class="pre">short_digraph</span></code> from a <code class="docutils literal notranslate"><span class="pre">Graph</span></code> or <code class="docutils literal notranslate"><span class="pre">DiGraph</span></code> named <code class="docutils literal notranslate"><span class="pre">G</span></code>,
the <span class="math notranslate nohighlight">\(i^{\text{th}}\)</span> vertex corresponds <em>by default</em> to <code class="docutils literal notranslate"><span class="pre">G.vertices(sort=True)[i]</span></code>.
Using optional parameter <code class="docutils literal notranslate"><span class="pre">vertex_list</span></code>, you can specify the order of the
vertices. Then <span class="math notranslate nohighlight">\(i^{\text{th}}\)</span> vertex will corresponds to <code class="docutils literal notranslate"><span class="pre">vertex_list[i]</span></code>.</p></li>
<li><p>Some methods return <code class="docutils literal notranslate"><span class="pre">bitset_t</span></code> objects when lists could be expected. There
is a very useful <code class="docutils literal notranslate"><span class="pre">bitset_list</span></code> function for this kind of problems :-)</p></li>
<li><p>When the edges are labelled, most of the space taken by this graph is taken by
edge labels. If no edge is labelled then this space is not allocated, but if
<em>any</em> edge has a label then a (possibly empty) label is stored for each edge,
which can double the memory needs.</p></li>
<li><p>The data structure stores the number of edges, even though it appears that
this number can be reconstructed with <code class="docutils literal notranslate"><span class="pre">g.neighbors[n]-g.neighbors[0]</span></code>. The
trick is that not all elements of the <code class="docutils literal notranslate"><span class="pre">g.edges</span></code> array are necessarily used :
when an undirected graph contains loops, only one entry of the array of size
<span class="math notranslate nohighlight">\(2m\)</span> is used to store it, instead of the expected two. Storing the number of
edges is the only way to avoid an uselessly costly computation to obtain the
number of edges of an undirected, looped, AND labelled graph (think of several
loops on the same vertex with different labels).</p></li>
<li><p>The codes of this module are well documented, and many answers can be found
directly in the code.</p></li>
</ul>
</section>
<section id="cython-functions">
<h2>Cython functions<a class="headerlink" href="#cython-functions" title="Permalink to this heading">#</a></h2>
<div class="table-wrapper colwidths-given contentstable docutils container">
<table class="contentstable docutils align-default">
<colgroup>
<col style="width: 30.0%" />
<col style="width: 70.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">init_short_digraph(short_digraph</span> <span class="pre">g,</span> <span class="pre">G)</span></code></p></td>
<td><p>Initialize <code class="docutils literal notranslate"><span class="pre">short_digraph</span> <span class="pre">g</span></code> from a Sage (Di)Graph.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">n_edges(short_digraph</span> <span class="pre">g)</span></code></p></td>
<td><p>Return the number of edges in <code class="docutils literal notranslate"><span class="pre">g</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">out_degree(short_digraph</span> <span class="pre">g,</span> <span class="pre">int</span> <span class="pre">i)</span></code></p></td>
<td><p>Return the out-degree of vertex <span class="math notranslate nohighlight">\(i\)</span> in <code class="docutils literal notranslate"><span class="pre">g</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">has_edge(short_digraph</span> <span class="pre">g,</span> <span class="pre">int</span> <span class="pre">u,</span> <span class="pre">int</span> <span class="pre">v)</span></code></p></td>
<td><p>Test the existence of an edge.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">edge_label(short_digraph</span> <span class="pre">g,</span> <span class="pre">int</span> <span class="pre">*</span> <span class="pre">edge)</span></code></p></td>
<td><p>Return the label associated with a given edge</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">init_empty_copy(short_digraph</span> <span class="pre">dst,</span> <span class="pre">short_digraph</span> <span class="pre">src)</span></code></p></td>
<td><p>Allocate <code class="docutils literal notranslate"><span class="pre">dst</span></code> so that it can contain as many vertices and edges as <code class="docutils literal notranslate"><span class="pre">src</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">init_reverse(short_digraph</span> <span class="pre">dst,</span> <span class="pre">short_digraph</span> <span class="pre">src)</span></code></p></td>
<td><p>Initialize <code class="docutils literal notranslate"><span class="pre">dst</span></code> to a copy of <code class="docutils literal notranslate"><span class="pre">src</span></code> with all edges in the opposite direction.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">free_short_digraph(short_digraph</span> <span class="pre">g)</span></code></p></td>
<td><p>Free the resources used by <code class="docutils literal notranslate"><span class="pre">g</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Connectivity</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">can_be_reached_from(short_digraph</span> <span class="pre">g,</span> <span class="pre">int</span> <span class="pre">src,</span> <span class="pre">bitset_t</span> <span class="pre">reached)</span></code></p>
<blockquote>
<div><p>Assuming <code class="docutils literal notranslate"><span class="pre">bitset_t</span> <span class="pre">reached</span></code> has size at least <code class="docutils literal notranslate"><span class="pre">g.n</span></code>, this method updates
<code class="docutils literal notranslate"><span class="pre">reached</span></code> so that it represents the set of vertices that can be reached
from <code class="docutils literal notranslate"><span class="pre">src</span></code> in <code class="docutils literal notranslate"><span class="pre">g</span></code>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">strongly_connected_component_containing_vertex(short_digraph</span> <span class="pre">g,</span> <span class="pre">short_digraph</span> <span class="pre">g_reversed,</span> <span class="pre">int</span> <span class="pre">v,</span> <span class="pre">bitset_t</span> <span class="pre">scc)</span></code></p>
<blockquote>
<div><p>Assuming <code class="docutils literal notranslate"><span class="pre">bitset_t</span> <span class="pre">reached</span></code> has size at least <code class="docutils literal notranslate"><span class="pre">g.n</span></code>, this method updates
<code class="docutils literal notranslate"><span class="pre">scc</span></code> so that it represents the vertices of the strongly connected
component containing <code class="docutils literal notranslate"><span class="pre">v</span></code> in <code class="docutils literal notranslate"><span class="pre">g</span></code>. The variable <code class="docutils literal notranslate"><span class="pre">g_reversed</span></code> is assumed
to represent the reverse of <code class="docutils literal notranslate"><span class="pre">g</span></code>.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">tarjan_strongly_connected_components_C(short_digraph</span> <span class="pre">g,</span> <span class="pre">int</span> <span class="pre">*scc)</span></code></p>
<blockquote>
<div><p>Assuming <code class="docutils literal notranslate"><span class="pre">scc</span></code> is already allocated and has size at least <code class="docutils literal notranslate"><span class="pre">g.n</span></code>, this
method computes the strongly connected components of <code class="docutils literal notranslate"><span class="pre">g</span></code>, and outputs in
<code class="docutils literal notranslate"><span class="pre">scc[v]</span></code> the number of the strongly connected component containing <code class="docutils literal notranslate"><span class="pre">v</span></code>.
It returns the number of strongly connected components.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">strongly_connected_components_digraph_C(short_digraph</span> <span class="pre">g,</span> <span class="pre">int</span> <span class="pre">nscc,</span> <span class="pre">int</span> <span class="pre">*scc,</span> <span class="pre">short_digraph</span> <span class="pre">output):</span></code></p>
<blockquote>
<div><p>Assuming <code class="docutils literal notranslate"><span class="pre">nscc</span></code> and <code class="docutils literal notranslate"><span class="pre">scc</span></code> are the outputs of
<code class="docutils literal notranslate"><span class="pre">tarjan_strongly_connected_components_C</span></code> on <code class="docutils literal notranslate"><span class="pre">g</span></code>, this routine
sets <code class="docutils literal notranslate"><span class="pre">output</span></code> to the
strongly connected component digraph of <code class="docutils literal notranslate"><span class="pre">g</span></code>, that is, the vertices of
<code class="docutils literal notranslate"><span class="pre">output</span></code> are the strongly connected components of <code class="docutils literal notranslate"><span class="pre">g</span></code> (numbers are
provided by <code class="docutils literal notranslate"><span class="pre">scc</span></code>), and <code class="docutils literal notranslate"><span class="pre">output</span></code> contains an arc <code class="docutils literal notranslate"><span class="pre">(C1,C2)</span></code> if <code class="docutils literal notranslate"><span class="pre">g</span></code>
has an arc from a vertex in <code class="docutils literal notranslate"><span class="pre">C1</span></code> to a vertex in <code class="docutils literal notranslate"><span class="pre">C2</span></code>.</p>
</div></blockquote>
</section>
<section id="what-is-this-module-used-for">
<h2>What is this module used for ?<a class="headerlink" href="#what-is-this-module-used-for" title="Permalink to this heading">#</a></h2>
<p>It is for instance used in the <a class="reference internal" href="../distances_all_pairs.html#module-sage.graphs.distances_all_pairs" title="sage.graphs.distances_all_pairs"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.graphs.distances_all_pairs</span></code></a> module,
and in the <a class="reference internal" href="../digraph.html#sage.graphs.digraph.DiGraph.strongly_connected_components" title="sage.graphs.digraph.DiGraph.strongly_connected_components"><code class="xref py py-meth docutils literal notranslate"><span class="pre">strongly_connected_components()</span></code></a>
method.</p>
</section>
<section id="python-functions">
<h2>Python functions<a class="headerlink" href="#python-functions" title="Permalink to this heading">#</a></h2>
<p>These functions are available so that Python modules from Sage can call the
Cython routines this module implements (as they cannot directly call methods
with C arguments).</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="sage.graphs.base.static_sparse_graph.spectral_radius">
<span class="sig-prename descclassname"><span class="pre">sage.graphs.base.static_sparse_graph.</span></span><span class="sig-name descname"><span class="pre">spectral_radius</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.base.static_sparse_graph.spectral_radius" title="Permalink to this definition">#</a></dt>
<dd><p>Return an interval of floating point number that encloses the spectral
radius of this graph</p>
<p>The input graph <code class="docutils literal notranslate"><span class="pre">G</span></code> must be <em>strongly connected</em>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> – (default <code class="docutils literal notranslate"><span class="pre">1e-10</span></code>) an upper bound for the relative precision
of the interval</p></li>
</ul>
<p>The algorithm is iterative and uses an inequality valid for non-negative
matrices. Namely, if <span class="math notranslate nohighlight">\(A\)</span> is a non-negative square matrix with
Perron-Frobenius eigenvalue <span class="math notranslate nohighlight">\(\lambda\)</span> then the following inequality is valid
for any vector <span class="math notranslate nohighlight">\(x\)</span></p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\min_i  \frac{(Ax)_i}{x_i} \leq \lambda \leq \max_i \frac{(Ax)_i}{x_i}\]</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The speed of convergence of the algorithm is governed by the spectral
gap (the distance to the second largest modulus of other eigenvalues).
If this gap is small, then this function might not be appropriate.</p>
<p>The algorithm is not smart and not parallel! It uses basic interval
arithmetic and native floating point arithmetic.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.base.static_sparse_graph</span> <span class="kn">import</span> <span class="n">spectral_radius</span>

<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span> <span class="n">loops</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">RR</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span> <span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">phi</span>  <span class="c1"># abs tol 1e-14</span>
<span class="go">1.618033988749895</span>
<span class="gp">sage: </span><span class="n">e_min</span><span class="p">,</span> <span class="n">e_max</span> <span class="o">=</span> <span class="n">spectral_radius</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="mf">1e-14</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e_min</span><span class="p">,</span> <span class="n">e_max</span>     <span class="c1"># abs tol 1e-14</span>
<span class="go">(1.618033988749894, 1.618033988749896)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">e_max</span> <span class="o">-</span> <span class="n">e_min</span><span class="p">)</span>  <span class="c1"># abs tol 1e-14</span>
<span class="go">1e-14</span>
<span class="gp">sage: </span><span class="n">e_min</span> <span class="o">&lt;</span> <span class="n">phi</span> <span class="o">&lt;</span> <span class="n">e_max</span>
<span class="go">True</span>
</pre></div>
</div>
<p>This function also works for graphs:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">e_min</span><span class="p">,</span> <span class="n">e_max</span> <span class="o">=</span> <span class="n">spectral_radius</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="mf">1e-14</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">AA</span><span class="p">,</span> <span class="n">multiplicities</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>  <span class="c1"># needs sage.modules</span>
<span class="gp">sage: </span><span class="n">e_min</span> <span class="o">&lt;</span> <span class="n">e</span> <span class="o">&lt;</span> <span class="n">e_max</span>                                                         <span class="c1"># needs sage.modules</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">spectral_radius</span><span class="p">()</span>  <span class="c1"># abs tol 1e-9</span>
<span class="go">(2.48119430408, 2.4811943041)</span>
</pre></div>
</div>
<p>A larger example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="c1"># needs sage.modules</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edges</span><span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e_min</span><span class="p">,</span> <span class="n">e_max</span> <span class="o">=</span> <span class="n">spectral_radius</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="mf">0.00001</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span>
<span class="go">x^201 - x^199 - 1</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">AA</span><span class="p">,</span> <span class="n">multiplicities</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">e_min</span> <span class="o">&lt;</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="n">e_max</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A much larger example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100000</span><span class="p">))</span>
<span class="gp">sage: </span><span class="k">while</span> <span class="ow">not</span> <span class="n">G</span><span class="o">.</span><span class="n">is_strongly_connected</span><span class="p">():</span>
<span class="gp">....: </span>    <span class="n">shuffle</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="n">G</span><span class="o">.</span><span class="n">add_edges</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">r</span><span class="p">),</span> <span class="n">loops</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">spectral_radius</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">)</span>  <span class="c1"># random</span>
<span class="go">(1.9997956006500042, 1.9998043797692782)</span>
</pre></div>
</div>
<p>The algorithm takes care of multiple edges:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">loops</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">multiedges</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">spectral_radius</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="mf">1e-14</span><span class="p">)</span>  <span class="c1"># abs tol 1e-14</span>
<span class="go">(2.414213562373094, 2.414213562373095)</span>
<span class="gp">sage: </span><span class="nb">max</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">AA</span><span class="p">))</span>                                 <span class="c1"># needs sage.modules</span>
<span class="go">2.414213562373095?</span>
</pre></div>
</div>
<p>Some bipartite graphs:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">spectral_radius</span><span class="p">()</span>  <span class="c1"># abs tol 1e-10</span>
<span class="go">(1.6180339887253428, 1.6180339887592732)</span>

<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">spectral_radius</span><span class="p">()</span> <span class="c1"># abs tol 1e-10</span>
<span class="go">(1.5537739740270458, 1.553773974033029)</span>

<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteBipartiteGraph</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">spectral_radius</span><span class="p">()</span>  <span class="c1"># abs tol 1e-10</span>
<span class="go">(1.7320508075688772, 1.7320508075688774)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.graphs.base.static_sparse_graph.strongly_connected_components_digraph">
<span class="sig-prename descclassname"><span class="pre">sage.graphs.base.static_sparse_graph.</span></span><span class="sig-name descname"><span class="pre">strongly_connected_components_digraph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.base.static_sparse_graph.strongly_connected_components_digraph" title="Permalink to this definition">#</a></dt>
<dd><p>Return the digraph of the strongly connected components (SCCs).</p>
<p>This routine is used to test <code class="docutils literal notranslate"><span class="pre">strongly_connected_components_digraph_C</span></code>,
but it is not used by the Sage digraph. It outputs a pair <code class="docutils literal notranslate"><span class="pre">[g_scc,scc]</span></code>,
where <code class="docutils literal notranslate"><span class="pre">g_scc</span></code> is the SCC digraph of g, <code class="docutils literal notranslate"><span class="pre">scc</span></code> is a dictionary associating
to each vertex <code class="docutils literal notranslate"><span class="pre">v</span></code> the number of the SCC of <code class="docutils literal notranslate"><span class="pre">v</span></code>, as it appears in
<code class="docutils literal notranslate"><span class="pre">g_scc</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.base.static_sparse_graph</span> <span class="kn">import</span> <span class="n">strongly_connected_components_digraph</span>
<span class="gp">sage: </span><span class="n">strongly_connected_components_digraph</span><span class="p">(</span><span class="n">digraphs</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">(Digraph on 3 vertices, {0: 2, 1: 1, 2: 0})</span>
<span class="gp">sage: </span><span class="n">strongly_connected_components_digraph</span><span class="p">(</span><span class="n">DiGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="go">(Digraph on 4 vertices, {0: 0, 1: 1, 2: 2, 3: 3})</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.graphs.base.static_sparse_graph.tarjan_strongly_connected_components">
<span class="sig-prename descclassname"><span class="pre">sage.graphs.base.static_sparse_graph.</span></span><span class="sig-name descname"><span class="pre">tarjan_strongly_connected_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.base.static_sparse_graph.tarjan_strongly_connected_components" title="Permalink to this definition">#</a></dt>
<dd><p>Return the lists of vertices in each strongly connected components (SCCs).</p>
<p>This method implements the Tarjan algorithm to compute the strongly
connected components of the digraph. It returns a list of lists of vertices,
each list of vertices representing a strongly connected component.</p>
<p>The basic idea of the algorithm is this: a depth-first search (DFS) begins
from an arbitrary start node (and subsequent DFSes are
conducted on any nodes that have not yet been found). As usual with DFSes,
the search visits every node of the graph exactly once, declining to revisit
any node that has already been explored. Thus, the collection of search
trees is a spanning forest of the graph. The strongly connected components
correspond to the subtrees of this spanning forest that have no edge
directed outside the subtree.</p>
<p>To recover these components, during the DFS, we keep the index of a node,
that is, the position in the DFS tree, and the lowlink: as soon as the
subtree rooted at <span class="math notranslate nohighlight">\(v\)</span> has been fully explored, the lowlink of <span class="math notranslate nohighlight">\(v\)</span> is the
smallest index reachable from <span class="math notranslate nohighlight">\(v\)</span> passing from descendants of <span class="math notranslate nohighlight">\(v\)</span>. If the
subtree rooted at <span class="math notranslate nohighlight">\(v\)</span> has been fully explored, and the index of <span class="math notranslate nohighlight">\(v\)</span> equals
the lowlink of <span class="math notranslate nohighlight">\(v\)</span>, that whole subtree is a new SCC.</p>
<p>For more information, see the
<a class="reference external" href="https://en.wikipedia.org/wiki/Tarjan%27s_strongly_connected_components_algorithm">Wikipedia article Tarjan%27s_strongly_connected_components_algorithm</a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.base.static_sparse_graph</span> <span class="kn">import</span> <span class="n">tarjan_strongly_connected_components</span>
<span class="gp">sage: </span><span class="n">tarjan_strongly_connected_components</span><span class="p">(</span><span class="n">digraphs</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">[[2], [1], [0]]</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">1</span> <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span> <span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">4</span> <span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">5</span> <span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">connected_components</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[[0, 1, 2, 3], [4, 5, 6]]</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">1</span> <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span> <span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">4</span> <span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">5</span> <span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">strongly_connected_components</span><span class="p">()</span>
<span class="go">[[3], [2], [1], [0], [6], [5], [4]]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edge</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">strongly_connected_components</span><span class="p">()</span>
<span class="go">[[3], [0, 1, 2], [6], [5], [4]]</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="nb">sorted</span><span class="p">(</span><span class="n">scc</span><span class="p">)</span> <span class="k">for</span> <span class="n">scc</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">strongly_connected_components</span><span class="p">()]</span>
<span class="go">[[&#39;e&#39;], [&#39;b&#39;, &#39;c&#39;, &#39;d&#39;], [&#39;a&#39;]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.graphs.base.static_sparse_graph.triangles_count">
<span class="sig-prename descclassname"><span class="pre">sage.graphs.base.static_sparse_graph.</span></span><span class="sig-name descname"><span class="pre">triangles_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.base.static_sparse_graph.triangles_count" title="Permalink to this definition">#</a></dt>
<dd><p>Return the number of triangles containing <span class="math notranslate nohighlight">\(v\)</span>, for every <span class="math notranslate nohighlight">\(v\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(G\)</span>– a graph</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.base.static_sparse_graph</span> <span class="kn">import</span> <span class="n">triangles_count</span>
<span class="gp">sage: </span><span class="n">triangles_count</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">())</span>
<span class="go">{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="n">triangles_count</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">==</span> <span class="mi">3</span><span class="o">*</span><span class="n">binomial</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="static_sparse_backend.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Static sparse graph backend</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="static_dense_graph.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Static dense graphs</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2023, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Static sparse graphs</a><ul>
<li><a class="reference internal" href="#what-is-the-point">What is the point ?</a></li>
<li><a class="reference internal" href="#data-structure">Data structure</a></li>
<li><a class="reference internal" href="#technical-details">Technical details</a></li>
<li><a class="reference internal" href="#cython-functions">Cython functions</a></li>
<li><a class="reference internal" href="#what-is-this-module-used-for">What is this module used for ?</a></li>
<li><a class="reference internal" href="#python-functions">Python functions</a></li>
<li><a class="reference internal" href="#sage.graphs.base.static_sparse_graph.spectral_radius"><code class="docutils literal notranslate"><span class="pre">spectral_radius()</span></code></a></li>
<li><a class="reference internal" href="#sage.graphs.base.static_sparse_graph.strongly_connected_components_digraph"><code class="docutils literal notranslate"><span class="pre">strongly_connected_components_digraph()</span></code></a></li>
<li><a class="reference internal" href="#sage.graphs.base.static_sparse_graph.tarjan_strongly_connected_components"><code class="docutils literal notranslate"><span class="pre">tarjan_strongly_connected_components()</span></code></a></li>
<li><a class="reference internal" href="#sage.graphs.base.static_sparse_graph.triangles_count"><code class="docutils literal notranslate"><span class="pre">triangles_count()</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/scripts/furo.js"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script src="../../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "lcm": "\\mathop{\\operatorname{lcm}}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="../../../../_static/mathjax/tex-chtml.js"></script>
    </body>
</html>