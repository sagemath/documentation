<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="Field \(\QQ\) of Rational Numbers" href="../rings/rational_field.html" /><link rel="prev" title="Utility classes for multi-modular algorithms" href="multi_modular.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>Miscellaneous arithmetic functions - Standard Commutative Rings</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom-furo.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Standard Commutative Rings</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 10.0 Reference Manual</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../index.html">Home - Standard Commutative Rings</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../rings/integer_ring.html">Ring <span class="math notranslate nohighlight">\(\ZZ\)</span> of Integers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rings/integer.html">Elements of the ring <span class="math notranslate nohighlight">\(\ZZ\)</span> of integers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rings/bernmm.html">Cython wrapper for bernmm library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rings/bernoulli_mod_p.html">Bernoulli numbers modulo p</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rings/factorint.html">Integer factorization functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rings/fast_arith.html">Basic arithmetic with C integers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rings/sum_of_squares.html">Fast decomposition of small integers into sums of squares</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions.html">Fast Arithmetic Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="power.html">Generic implementation of powering</a></li>
<li class="toctree-l1"><a class="reference internal" href="multi_modular.html">Utility classes for multi-modular algorithms</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Miscellaneous arithmetic functions</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../rings/rational_field.html">Field <span class="math notranslate nohighlight">\(\QQ\)</span> of Rational Numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rings/rational.html">Rational Numbers</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="miscellaneous-arithmetic-functions">
<span id="sage-arith-misc"></span><h1>Miscellaneous arithmetic functions<a class="headerlink" href="#miscellaneous-arithmetic-functions" title="Permalink to this heading">#</a></h1>
<span class="target" id="module-sage.arith.misc"></span><p>AUTHORS:</p>
<ul class="simple">
<li><p>Kevin Stueve (2010-01-17): in <code class="docutils literal notranslate"><span class="pre">is_prime(n)</span></code>, delegated calculation to <code class="docutils literal notranslate"><span class="pre">n.is_prime()</span></code></p></li>
</ul>
<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.CRT">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">CRT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.CRT" title="Permalink to this definition">#</a></dt>
<dd><p>Return a solution to a Chinese Remainder Theorem problem.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code> - two residues (elements of some ring for which
extended gcd is available), or two lists, one of residues and
one of moduli.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code>, <code class="docutils literal notranslate"><span class="pre">n</span></code> - (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) two moduli, or <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>If <code class="docutils literal notranslate"><span class="pre">m</span></code>, <code class="docutils literal notranslate"><span class="pre">n</span></code> are not <code class="docutils literal notranslate"><span class="pre">None</span></code>, returns a solution <span class="math notranslate nohighlight">\(x\)</span> to the
simultaneous congruences <span class="math notranslate nohighlight">\(x\equiv a \bmod m\)</span> and <span class="math notranslate nohighlight">\(x\equiv b \bmod
n\)</span>, if one exists. By the Chinese Remainder Theorem, a solution to the
simultaneous congruences exists if and only if
<span class="math notranslate nohighlight">\(a\equiv b\pmod{\gcd(m,n)}\)</span>. The solution <span class="math notranslate nohighlight">\(x\)</span> is only well-defined modulo
<span class="math notranslate nohighlight">\(\text{lcm}(m,n)\)</span>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> are lists, returns a simultaneous solution to
the congruences <span class="math notranslate nohighlight">\(x\equiv a_i\pmod{b_i}\)</span>, if one exists.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="#sage.arith.misc.CRT_list" title="sage.arith.misc.CRT_list"><code class="xref py py-func docutils literal notranslate"><span class="pre">CRT_list()</span></code></a></p></li>
</ul>
</div>
<p>EXAMPLES:</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">crt</span></code> by giving it pairs of residues and moduli:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">11</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">301</span><span class="p">)</span>
<span class="go">28013</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="go">11</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">([</span><span class="mi">13</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">301</span><span class="p">])</span>
<span class="go">28013</span>
</pre></div>
</div>
<p>You can also use upper case:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">CRT</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span> <span class="n">c</span>
<span class="go">8</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">2</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">3</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Note that this also works for polynomial rings:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">CRT</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">)</span>
<span class="go">-3/26*y^4 + 5/26*y^3 + 15/26*y + 53/26</span>
<span class="gp">sage: </span><span class="n">CRT</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">)</span>
<span class="go">(-3/52*a + 3/52)*y^4 + (5/52*a - 5/52)*y^3 + (15/52*a - 15/52)*y + 27/52*a + 25/52</span>
</pre></div>
</div>
<p>You can also do this for any number of moduli:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">CRT</span><span class="p">([],</span> <span class="p">[])</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">CRT</span><span class="p">([</span><span class="n">a</span><span class="p">],</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span>
<span class="go">a</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">9</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">CRT</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span><span class="p">]);</span> <span class="n">k</span>
<span class="go">(127/26988*a - 5807/386828)*x^9 + (45/8996*a - 33677/1160484)*x^8 + (2/173*a - 6/173)*x^7 + (133/6747*a - 5373/96707)*x^6 + (-6/2249*a + 18584/290121)*x^5 + (-277/8996*a + 38847/386828)*x^4 + (-135/4498*a + 42673/193414)*x^3 + (-1005/8996*a + 470245/1160484)*x^2 + (-1215/8996*a + 141165/386828)*x + 621/8996*a + 836445/386828</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">a</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>If the moduli are not coprime, a solution may not exist:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<span class="go">20</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: no solution to crt problem since gcd(8,12) does not divide 4-6</span>

<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="go">-1/2*x + 5/2</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="go">-1/2*x^3 + x^2 + 1/2*x + 1</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: no solution to crt problem since gcd(x^2 - 1,x^3 - 1) does not divide 2-x</span>

<span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<span class="go">58</span>
</pre></div>
</div>
<p>crt also work with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">int8</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">int8</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">int8</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">int8</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<span class="go">58</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">mpz</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">mpz</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">mpz</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<span class="go">58</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="n">mpz</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">int8</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<span class="go">58</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.CRT_basis">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">CRT_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">moduli</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.CRT_basis" title="Permalink to this definition">#</a></dt>
<dd><p>Return a CRT basis for the given moduli.</p>
<p>INPUT:</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">moduli</span></code> - list of pairwise coprime moduli <span class="math notranslate nohighlight">\(m\)</span> which admit an</dt><dd><p>extended Euclidean algorithm</p>
</dd>
</dl>
</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a list of elements <span class="math notranslate nohighlight">\(a_i\)</span> of the same length as <span class="math notranslate nohighlight">\(m\)</span> such that
<span class="math notranslate nohighlight">\(a_i\)</span> is congruent to 1 modulo <span class="math notranslate nohighlight">\(m_i\)</span> and to 0 modulo <span class="math notranslate nohighlight">\(m_j\)</span> for
<span class="math notranslate nohighlight">\(j\not=i\)</span>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The pairwise coprimality of the input is not checked.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a1</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">(</span><span class="n">mod</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">a2</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">(</span><span class="n">mod</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span><span class="mi">13</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">c1</span><span class="p">,</span><span class="n">c2</span> <span class="o">=</span> <span class="n">CRT_basis</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">13</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">mod</span><span class="p">(</span><span class="n">a1</span><span class="o">*</span><span class="n">c1</span><span class="o">+</span><span class="n">a2</span><span class="o">*</span><span class="n">c2</span><span class="p">,</span><span class="mi">5</span><span class="o">*</span><span class="mi">13</span><span class="p">)</span>
<span class="go">42</span>
</pre></div>
</div>
<p>A polynomial example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="o">=</span><span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">mods</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">CRT_basis</span><span class="p">(</span><span class="n">mods</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span>
<span class="go">[-2/3*x^3 + x^2 - 2/3*x + 1, 6/13*x^3 - x^2 + 6/13*x, 8/39*x^3 + 8/39*x]</span>
<span class="gp">sage: </span><span class="p">[[</span><span class="n">bi</span> <span class="o">%</span> <span class="n">mj</span> <span class="k">for</span> <span class="n">mj</span> <span class="ow">in</span> <span class="n">mods</span><span class="p">]</span> <span class="k">for</span> <span class="n">bi</span> <span class="ow">in</span> <span class="n">b</span><span class="p">]</span>
<span class="go">[[1, 0, 0], [0, 1, 0], [0, 0, 1]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.CRT_list">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">CRT_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moduli</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.CRT_list" title="Permalink to this definition">#</a></dt>
<dd><p>Given a list <code class="docutils literal notranslate"><span class="pre">values</span></code> of elements and a list of corresponding
<code class="docutils literal notranslate"><span class="pre">moduli</span></code>, find a single element that reduces to each element of
<code class="docutils literal notranslate"><span class="pre">values</span></code> modulo the corresponding moduli.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="#sage.arith.misc.crt" title="sage.arith.misc.crt"><code class="xref py py-func docutils literal notranslate"><span class="pre">crt()</span></code></a></p></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CRT_list</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="go">23</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">CRT_list</span><span class="p">([</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="n">x</span><span class="p">]);</span> <span class="n">c</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Univariate Polynomial Ring in x over Rational Field</span>
</pre></div>
</div>
<p>It also works if the moduli are not coprime:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CRT_list</span><span class="p">([</span><span class="mi">32</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">60</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">150</span><span class="p">])</span>
<span class="go">452</span>
</pre></div>
</div>
<p>But with non coprime moduli there is not always a solution:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CRT_list</span><span class="p">([</span><span class="mi">32</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">60</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">150</span><span class="p">])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: no solution to crt problem since gcd(180,150) does not divide 92-1</span>
</pre></div>
</div>
<p>The arguments must be lists:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CRT_list</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="s2">&quot;not a list&quot;</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: arguments to CRT_list should be lists</span>
<span class="gp">sage: </span><span class="n">CRT_list</span><span class="p">(</span><span class="s2">&quot;not a list&quot;</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: arguments to CRT_list should be lists</span>
</pre></div>
</div>
<p>The list of moduli must have the same length as the list of elements:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CRT_list</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="go">23</span>
<span class="gp">sage: </span><span class="n">CRT_list</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: arguments to CRT_list should be lists of the same length</span>
<span class="gp">sage: </span><span class="n">CRT_list</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: arguments to CRT_list should be lists of the same length</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.CRT_vectors">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">CRT_vectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moduli</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.CRT_vectors" title="Permalink to this definition">#</a></dt>
<dd><p>Vector form of the Chinese Remainder Theorem: given a list of integer
vectors <span class="math notranslate nohighlight">\(v_i\)</span> and a list of coprime moduli <span class="math notranslate nohighlight">\(m_i\)</span>, find a vector <span class="math notranslate nohighlight">\(w\)</span> such
that <span class="math notranslate nohighlight">\(w = v_i \pmod m_i\)</span> for all <span class="math notranslate nohighlight">\(i\)</span>. This is more efficient than applying
<a class="reference internal" href="#sage.arith.misc.CRT" title="sage.arith.misc.CRT"><code class="xref py py-func docutils literal notranslate"><span class="pre">CRT()</span></code></a> to each entry.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">X</span></code> - list or tuple, consisting of lists/tuples/vectors/etc of
integers of the same length</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">moduli</span></code> - list of len(X) moduli</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">list</span></code> - application of CRT componentwise.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CRT_vectors</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">11</span><span class="p">]],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">[3, 5, 5]</span>

<span class="gp">sage: </span><span class="n">CRT_vectors</span><span class="p">([</span><span class="n">vector</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">Sequence</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span><span class="n">ZZ</span><span class="p">)],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="go">[10, 43, 17]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.arith.misc.Euler_Phi">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">Euler_Phi</span></span><a class="headerlink" href="#sage.arith.misc.Euler_Phi" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Return the value of the Euler phi function on the integer n. We
defined this to be the number of positive integers &lt;= n that are
relatively prime to n. Thus if n&lt;=0 then
<code class="docutils literal notranslate"><span class="pre">euler_phi(n)</span></code> is defined and equals 0.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> - an integer</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">euler_phi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">euler_phi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">euler_phi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">euler_phi</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">euler_phi</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="go">36</span>
</pre></div>
</div>
<p>Notice that euler_phi is defined to be 0 on negative numbers and
0.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">euler_phi</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">euler_phi</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">euler_phi</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">&lt;class &#39;sage.rings.integer.Integer&#39;&gt;</span>
</pre></div>
</div>
<p>We verify directly that the phi function is correct for 21.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">euler_phi</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span> <span class="k">if</span> <span class="n">gcd</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
<span class="go">[1, 2, 4, 5, 8, 10, 11, 13, 16, 17, 19, 20]</span>
</pre></div>
</div>
<p>The length of the list of integers ‘i’ in range(n) such that the
gcd(i,n) == 1 equals euler_phi(n).</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">len</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span> <span class="k">if</span> <span class="n">gcd</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="n">euler_phi</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The phi function also has a special plotting method.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">euler_phi</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">71</span><span class="p">)</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int8</span>
<span class="gp">sage: </span><span class="n">euler_phi</span><span class="p">(</span><span class="n">int8</span><span class="p">(</span><span class="mi">37</span><span class="p">))</span>
<span class="go">36</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">euler_phi</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">37</span><span class="p">))</span>
<span class="go">36</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>William Stein</p></li>
<li><p>Alex Clemesha (2006-01-10): some examples</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="sage.arith.misc.Euler_Phi.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pointsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rgbcolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">join</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.Euler_Phi.plot" title="Permalink to this definition">#</a></dt>
<dd><p>Plot the Euler phi function.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">xmin</span></code> - default: 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">xmax</span></code> - default: 50</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pointsize</span></code> - default: 30</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rgbcolor</span></code> - default: (0,0,1)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">join</span></code> - default: True; whether to join the
points.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**kwds</span></code> - passed on</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.arith.misc</span> <span class="kn">import</span> <span class="n">Euler_Phi</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">Euler_Phi</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">ymax</span><span class="p">()</span>
<span class="go">46.0</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.GCD">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">GCD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.GCD" title="Permalink to this definition">#</a></dt>
<dd><p>Return the greatest common divisor of <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">a</span></code> is a list and <code class="docutils literal notranslate"><span class="pre">b</span></code> is omitted, return instead the
greatest common divisor of all elements of <code class="docutils literal notranslate"><span class="pre">a</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a,b</span></code> – two elements of a ring with gcd or</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code> – a list or tuple of elements of a ring with gcd</p></li>
</ul>
<p>Additional keyword arguments are passed to the respectively called
methods.</p>
<p>OUTPUT:</p>
<p>The given elements are first coerced into a common parent. Then,
their greatest common divisor <em>in that common parent</em> is returned.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">GCD</span><span class="p">(</span><span class="mi">97</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">GCD</span><span class="p">(</span><span class="mi">97</span><span class="o">*</span><span class="mi">10</span><span class="o">^</span><span class="mi">15</span><span class="p">,</span> <span class="mi">19</span><span class="o">^</span><span class="mi">20</span><span class="o">*</span><span class="mi">97</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">97</span>
<span class="gp">sage: </span><span class="n">GCD</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
<span class="go">2/15</span>
<span class="gp">sage: </span><span class="n">GCD</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">GCD</span><span class="p">(</span><span class="n">srange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10000</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>  <span class="c1"># fast  !!</span>
<span class="go">10</span>
</pre></div>
</div>
<p>Note that to take the gcd of <span class="math notranslate nohighlight">\(n\)</span> elements for <span class="math notranslate nohighlight">\(n \not= 2\)</span> you must
put the elements into a list by enclosing them in <code class="docutils literal notranslate"><span class="pre">[..]</span></code>.  Before
<a class="reference external" href="https://github.com/sagemath/sage/issues/4988">github issue #4988</a> the following wrongly returned 3 since the third parameter
was just ignored:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">gcd</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: ...gcd() takes ...</span>
<span class="gp">sage: </span><span class="n">gcd</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Similarly, giving just one element (which is not a list) gives an error:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">gcd</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: &#39;sage.rings.integer.Integer&#39; object is not iterable</span>
</pre></div>
</div>
<p>By convention, the gcd of the empty list is (the integer) 0:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">gcd</span><span class="p">([])</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">gcd</span><span class="p">([]))</span>
<span class="go">&lt;class &#39;sage.rings.integer.Integer&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.arith.misc.Moebius">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">Moebius</span></span><a class="headerlink" href="#sage.arith.misc.Moebius" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Return the value of the Möbius function of abs(n), where n is an
integer.</p>
<p>DEFINITION: <span class="math notranslate nohighlight">\(\mu(n)\)</span> is 0 if <span class="math notranslate nohighlight">\(n\)</span> is not square
free, and otherwise equals <span class="math notranslate nohighlight">\((-1)^r\)</span>, where <span class="math notranslate nohighlight">\(n\)</span> has
<span class="math notranslate nohighlight">\(r\)</span> distinct prime factors.</p>
<p>For simplicity, if <span class="math notranslate nohighlight">\(n=0\)</span> we define <span class="math notranslate nohighlight">\(\mu(n) = 0\)</span>.</p>
<p>IMPLEMENTATION: Factors or - for integers - uses the PARI C
library.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> - anything that can be factored.</p></li>
</ul>
<p>OUTPUT: 0, 1, or -1</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">moebius</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">moebius</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">moebius</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">moebius</span><span class="p">(</span><span class="o">-</span><span class="mi">35</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">moebius</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">moebius</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">-1</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">moebius</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>   <span class="c1"># potentially nonstandard!</span>
<span class="go">0</span>
</pre></div>
</div>
<p>The moebius function even makes sense for non-integer inputs.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">)[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="mf">.0</span>
<span class="gp">sage: </span><span class="n">moebius</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-1</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int8</span>
<span class="gp">sage: </span><span class="n">moebius</span><span class="p">(</span><span class="n">int8</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">))</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">moebius</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">))</span>
<span class="go">-1</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.arith.misc.Moebius.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pointsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rgbcolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">join</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.Moebius.plot" title="Permalink to this definition">#</a></dt>
<dd><p>Plot the Möbius function.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">xmin</span></code> - default: 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">xmax</span></code> - default: 50</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pointsize</span></code> - default: 30</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rgbcolor</span></code> - default: (0,0,1)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">join</span></code> - default: True; whether to join the points
(very helpful in seeing their order).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**kwds</span></code> - passed on</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.arith.misc</span> <span class="kn">import</span> <span class="n">Moebius</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">Moebius</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">ymax</span><span class="p">()</span>
<span class="go">1.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.arith.misc.Moebius.range">
<span class="sig-name descname"><span class="pre">range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.Moebius.range" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Möbius function evaluated at the given range of values,
i.e., the image of the list range(start, stop, step) under the
Möbius function.</p>
<p>This is much faster than directly computing all these values with a
list comprehension.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">moebius</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span> <span class="n">v</span>
<span class="go">[1, 0, 0, -1, 1, -1, 0, -1, -1, 1, 0, 1, -1, -1, 0, -1, 1, -1, 0, 0]</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">==</span> <span class="p">[</span><span class="n">moebius</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)]</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">moebius</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">==</span> <span class="p">[</span><span class="n">moebius</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">4</span><span class="p">)]</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.arith.misc.Sigma">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">Sigma</span></span><a class="headerlink" href="#sage.arith.misc.Sigma" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Return the sum of the k-th powers of the divisors of n.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> - integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">k</span></code> - integer (default: 1)</p></li>
</ul>
<p>OUTPUT: integer</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sigma</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">sigma</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">26</span>
</pre></div>
</div>
<p>The sigma function also has a special plotting method.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<p>This method also works with k-th powers.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>William Stein: original implementation</p></li>
<li><p>Craig Citro (2007-06-01): rewrote for huge speedup</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="sage.arith.misc.Sigma.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pointsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rgbcolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">join</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.Sigma.plot" title="Permalink to this definition">#</a></dt>
<dd><p>Plot the sigma (sum of k-th powers of divisors) function.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">xmin</span></code> - default: 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">xmax</span></code> - default: 50</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">k</span></code> - default: 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pointsize</span></code> - default: 30</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rgbcolor</span></code> - default: (0,0,1)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">join</span></code> - default: True; whether to join the
points.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**kwds</span></code> - passed on</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.arith.misc</span> <span class="kn">import</span> <span class="n">Sigma</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">Sigma</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">ymax</span><span class="p">()</span>
<span class="go">124.0</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.XGCD">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">XGCD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.XGCD" title="Permalink to this definition">#</a></dt>
<dd><p>Return a triple <code class="docutils literal notranslate"><span class="pre">(g,s,t)</span></code> such that <span class="math notranslate nohighlight">\(g = s\cdot a+t\cdot b = \gcd(a,b)\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>One exception is if <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are not in a principal ideal domain (see
<a class="reference external" href="https://en.wikipedia.org/wiki/Principal_ideal_domain">Wikipedia article Principal_ideal_domain</a>), e.g., they are both polynomials
over the integers. Then this function can’t in general return <code class="docutils literal notranslate"><span class="pre">(g,s,t)</span></code>
as above, since they need not exist.  Instead, over the integers, we
first multiply <span class="math notranslate nohighlight">\(g\)</span> by a divisor of the resultant of <span class="math notranslate nohighlight">\(a/g\)</span> and <span class="math notranslate nohighlight">\(b/g\)</span>, up
to sign.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a,</span> <span class="pre">b</span></code> - integers or more generally, element of a ring for which the
xgcd make sense (e.g. a field or univariate polynomials).</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">g,</span> <span class="pre">s,</span> <span class="pre">t</span></code> - such that <span class="math notranslate nohighlight">\(g = s\cdot a + t\cdot b\)</span></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is no guarantee that the returned cofactors (s and t) are
minimal.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">xgcd</span><span class="p">(</span><span class="mi">56</span><span class="p">,</span> <span class="mi">44</span><span class="p">)</span>
<span class="go">(4, 4, -5)</span>
<span class="gp">sage: </span><span class="mi">4</span><span class="o">*</span><span class="mi">56</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="mi">44</span>
<span class="go">4</span>

<span class="gp">sage: </span><span class="n">g</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">xgcd</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="o">/</span><span class="mi">1</span><span class="p">);</span> <span class="n">g</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span>
<span class="go">(1, 3, -2)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">g</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">xgcd</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">(x - 1, 1, -x)</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">g</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="n">g</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(1, 1/3*g, 0)</span>

<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()[]</span>
<span class="gp">sage: </span><span class="n">xgcd</span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>
<span class="go">(1, a^2/b^2, ((-a)/b^2)*y + 1/b)</span>
<span class="gp">sage: </span><span class="n">xgcd</span><span class="p">((</span><span class="n">b</span><span class="o">+</span><span class="n">g</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">g</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>
<span class="go">(1, (a^2 + (2*g)*a + 3)/(b^3 + g*b^2), ((-a + (-g))/b^2)*y + 1/b)</span>
</pre></div>
</div>
<p>Here is an example of a xgcd for two polynomials over the integers, where the linear
combination is not the gcd but the gcd multiplied by the resultant:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">gcd</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x</span>
<span class="gp">sage: </span><span class="n">xgcd</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(2*x, -1, 2)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">resultant</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 types:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int8</span>
<span class="gp">sage: </span><span class="n">xgcd</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">int8</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="go">(4, 1, 0)</span>
<span class="gp">sage: </span><span class="n">xgcd</span><span class="p">(</span><span class="n">int8</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">int8</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="go">(4, 1, 0)</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">xgcd</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">mpz</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="go">(4, 1, 0)</span>
<span class="gp">sage: </span><span class="n">xgcd</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">mpz</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="go">(4, 1, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.algdep">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">algdep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">known_bits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">known_digits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_digits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.algdep" title="Permalink to this definition">#</a></dt>
<dd><p>Return an irreducible polynomial of degree at most <span class="math notranslate nohighlight">\(degree\)</span> which
is approximately satisfied by the number <span class="math notranslate nohighlight">\(z\)</span>.</p>
<p>You can specify the number of known bits or digits of <span class="math notranslate nohighlight">\(z\)</span> with
<code class="docutils literal notranslate"><span class="pre">known_bits=k</span></code> or <code class="docutils literal notranslate"><span class="pre">known_digits=k</span></code>. PARI is then told to
compute the result using <span class="math notranslate nohighlight">\(0.8k\)</span> of these bits/digits. Or, you can
specify the precision to use directly with <code class="docutils literal notranslate"><span class="pre">use_bits=k</span></code> or
<code class="docutils literal notranslate"><span class="pre">use_digits=k</span></code>. If none of these are specified, then the precision
is taken from the input value.</p>
<p>A height bound may be specified to indicate the maximum coefficient
size of the returned polynomial; if a sufficiently small polynomial
is not found, then <code class="docutils literal notranslate"><span class="pre">None</span></code> will be returned. If <code class="docutils literal notranslate"><span class="pre">proof=True</span></code> then
the result is returned only if it can be proved correct (i.e. the
only possible minimal polynomial satisfying the height bound, or no
such polynomial exists). Otherwise a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> is raised
indicating that higher precision is required.</p>
<p>ALGORITHM: Uses LLL for real/complex inputs, PARI C-library
<code class="docutils literal notranslate"><span class="pre">algdep</span></code> command otherwise.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">algebraic_dependency</span></code> is a synonym for <code class="docutils literal notranslate"><span class="pre">algdep</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">z</span></code> - real, complex, or <span class="math notranslate nohighlight">\(p\)</span>-adic number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">degree</span></code> - an integer</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">height_bound</span></code> - an integer (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) specifying the maximum</dt><dd><p>coefficient size for the returned polynomial</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> - a boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>), requires height_bound to be set</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="mf">1.888888888888888</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">9*x - 17</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="mf">0.12121212121212</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">33*x - 4</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x^2 - 2</span>
</pre></div>
</div>
<p>This example involves a complex number:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">RDF</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">*</span><span class="n">CC</span><span class="mf">.0</span><span class="p">);</span> <span class="n">z</span>
<span class="go">0.500000000000000 + 0.866025403784439*I</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="go">x^2 - x + 1</span>
</pre></div>
</div>
<p>This example involves a <span class="math notranslate nohighlight">\(p\)</span>-adic number:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">print_mode</span> <span class="o">=</span> <span class="s1">&#39;series&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">19</span><span class="p">);</span> <span class="n">a</span>
<span class="go">1 + 2*3 + 3^2 + 3^3 + 2*3^4 + 2*3^5 + 3^8 + 2*3^9 + 3^11 + 3^12 + 2*3^15 + 2*3^16 + 3^17 + 2*3^19 + O(3^20)</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">19*x - 7</span>
</pre></div>
</div>
<p>These examples show the importance of proper precision control. We
compute a 200-bit approximation to <span class="math notranslate nohighlight">\(sqrt(2)\)</span> which is wrong in the
33’rd bit:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">RealField</span><span class="p">(</span><span class="mi">200</span><span class="p">)(</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">33</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">algdep</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span> <span class="n">p</span>
<span class="go">227004321085*x^4 - 216947902586*x^3 - 99411220986*x^2 + 82234881648*x - 211871195088</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">227004321085*x^4 - 216947902586*x^3 - 99411220986*x^2 + 82234881648*x - 211871195088</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">known_bits</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<span class="go">x^2 - 2</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">known_digits</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">x^2 - 2</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">use_bits</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="go">x^2 - 2</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">use_digits</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="go">x^2 - 2</span>
</pre></div>
</div>
<p>Using the <code class="docutils literal notranslate"><span class="pre">height_bound</span></code> and <code class="docutils literal notranslate"><span class="pre">proof</span></code> parameters, we can see that
<span class="math notranslate nohighlight">\(pi\)</span> is not the root of an integer polynomial of degree at most 5
and coefficients bounded above by 10:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">(),</span> <span class="mi">5</span><span class="p">,</span> <span class="n">height_bound</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
<p>For stronger results, we need more precision:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">(),</span> <span class="mi">5</span><span class="p">,</span> <span class="n">height_bound</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: insufficient precision for non-existence proof</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">200</span><span class="p">),</span> <span class="mi">5</span><span class="p">,</span> <span class="n">height_bound</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">(),</span> <span class="mi">10</span><span class="p">,</span> <span class="n">height_bound</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: insufficient precision for non-existence proof</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">200</span><span class="p">),</span> <span class="mi">10</span><span class="p">,</span> <span class="n">height_bound</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We can also use <code class="docutils literal notranslate"><span class="pre">proof=True</span></code> to get positive results:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">n</span><span class="p">(),</span> <span class="mi">8</span><span class="p">,</span> <span class="n">height_bound</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: insufficient precision for uniqueness proof</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">algdep</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span> <span class="mi">8</span><span class="p">,</span> <span class="n">height_bound</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span> <span class="n">f</span>
<span class="go">x^8 - 40*x^6 + 352*x^4 - 960*x^2 + 576</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.algebraic_dependency">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">algebraic_dependency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">known_bits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">known_digits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_digits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.algebraic_dependency" title="Permalink to this definition">#</a></dt>
<dd><p>Return an irreducible polynomial of degree at most <span class="math notranslate nohighlight">\(degree\)</span> which
is approximately satisfied by the number <span class="math notranslate nohighlight">\(z\)</span>.</p>
<p>You can specify the number of known bits or digits of <span class="math notranslate nohighlight">\(z\)</span> with
<code class="docutils literal notranslate"><span class="pre">known_bits=k</span></code> or <code class="docutils literal notranslate"><span class="pre">known_digits=k</span></code>. PARI is then told to
compute the result using <span class="math notranslate nohighlight">\(0.8k\)</span> of these bits/digits. Or, you can
specify the precision to use directly with <code class="docutils literal notranslate"><span class="pre">use_bits=k</span></code> or
<code class="docutils literal notranslate"><span class="pre">use_digits=k</span></code>. If none of these are specified, then the precision
is taken from the input value.</p>
<p>A height bound may be specified to indicate the maximum coefficient
size of the returned polynomial; if a sufficiently small polynomial
is not found, then <code class="docutils literal notranslate"><span class="pre">None</span></code> will be returned. If <code class="docutils literal notranslate"><span class="pre">proof=True</span></code> then
the result is returned only if it can be proved correct (i.e. the
only possible minimal polynomial satisfying the height bound, or no
such polynomial exists). Otherwise a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> is raised
indicating that higher precision is required.</p>
<p>ALGORITHM: Uses LLL for real/complex inputs, PARI C-library
<code class="docutils literal notranslate"><span class="pre">algdep</span></code> command otherwise.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">algebraic_dependency</span></code> is a synonym for <code class="docutils literal notranslate"><span class="pre">algdep</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">z</span></code> - real, complex, or <span class="math notranslate nohighlight">\(p\)</span>-adic number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">degree</span></code> - an integer</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">height_bound</span></code> - an integer (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) specifying the maximum</dt><dd><p>coefficient size for the returned polynomial</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> - a boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>), requires height_bound to be set</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="mf">1.888888888888888</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">9*x - 17</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="mf">0.12121212121212</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">33*x - 4</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x^2 - 2</span>
</pre></div>
</div>
<p>This example involves a complex number:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">RDF</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">*</span><span class="n">CC</span><span class="mf">.0</span><span class="p">);</span> <span class="n">z</span>
<span class="go">0.500000000000000 + 0.866025403784439*I</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="go">x^2 - x + 1</span>
</pre></div>
</div>
<p>This example involves a <span class="math notranslate nohighlight">\(p\)</span>-adic number:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">print_mode</span> <span class="o">=</span> <span class="s1">&#39;series&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">19</span><span class="p">);</span> <span class="n">a</span>
<span class="go">1 + 2*3 + 3^2 + 3^3 + 2*3^4 + 2*3^5 + 3^8 + 2*3^9 + 3^11 + 3^12 + 2*3^15 + 2*3^16 + 3^17 + 2*3^19 + O(3^20)</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">19*x - 7</span>
</pre></div>
</div>
<p>These examples show the importance of proper precision control. We
compute a 200-bit approximation to <span class="math notranslate nohighlight">\(sqrt(2)\)</span> which is wrong in the
33’rd bit:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">RealField</span><span class="p">(</span><span class="mi">200</span><span class="p">)(</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">33</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">algdep</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span> <span class="n">p</span>
<span class="go">227004321085*x^4 - 216947902586*x^3 - 99411220986*x^2 + 82234881648*x - 211871195088</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">227004321085*x^4 - 216947902586*x^3 - 99411220986*x^2 + 82234881648*x - 211871195088</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">known_bits</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<span class="go">x^2 - 2</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">known_digits</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">x^2 - 2</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">use_bits</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="go">x^2 - 2</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">use_digits</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="go">x^2 - 2</span>
</pre></div>
</div>
<p>Using the <code class="docutils literal notranslate"><span class="pre">height_bound</span></code> and <code class="docutils literal notranslate"><span class="pre">proof</span></code> parameters, we can see that
<span class="math notranslate nohighlight">\(pi\)</span> is not the root of an integer polynomial of degree at most 5
and coefficients bounded above by 10:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">(),</span> <span class="mi">5</span><span class="p">,</span> <span class="n">height_bound</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
<p>For stronger results, we need more precision:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">(),</span> <span class="mi">5</span><span class="p">,</span> <span class="n">height_bound</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: insufficient precision for non-existence proof</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">200</span><span class="p">),</span> <span class="mi">5</span><span class="p">,</span> <span class="n">height_bound</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">(),</span> <span class="mi">10</span><span class="p">,</span> <span class="n">height_bound</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: insufficient precision for non-existence proof</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">200</span><span class="p">),</span> <span class="mi">10</span><span class="p">,</span> <span class="n">height_bound</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We can also use <code class="docutils literal notranslate"><span class="pre">proof=True</span></code> to get positive results:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">algdep</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">n</span><span class="p">(),</span> <span class="mi">8</span><span class="p">,</span> <span class="n">height_bound</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: insufficient precision for uniqueness proof</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">algdep</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span> <span class="mi">8</span><span class="p">,</span> <span class="n">height_bound</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span> <span class="n">f</span>
<span class="go">x^8 - 40*x^6 + 352*x^4 - 960*x^2 + 576</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.bernoulli">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">bernoulli</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_threads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.bernoulli" title="Permalink to this definition">#</a></dt>
<dd><p>Return the n-th Bernoulli number, as a rational number.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> - an integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'default'</span></code> – use ‘flint’ for n &lt;= 20000, then ‘arb’ for n &lt;= 300000
and ‘bernmm’ for larger values (this is just a heuristic, and not guaranteed
to be optimal on all hardware)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'arb'</span></code> – use the arb library</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'flint'</span></code> – use the FLINT library</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pari'</span></code> – use the PARI C library</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'gap'</span></code> – use GAP</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'gp'</span></code> – use PARI/GP interpreter</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'magma'</span></code> – use MAGMA (optional)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'bernmm'</span></code> – use bernmm package (a multimodular algorithm)</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_threads</span></code> - positive integer, number of
threads to use (only used for bernmm algorithm)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">bernoulli</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="go">-691/2730</span>
<span class="gp">sage: </span><span class="n">bernoulli</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="go">495057205241079648212477525/66</span>
</pre></div>
</div>
<p>We demonstrate each of the alternative algorithms:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">bernoulli</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;arb&#39;</span><span class="p">)</span>
<span class="go">-691/2730</span>
<span class="gp">sage: </span><span class="n">bernoulli</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;flint&#39;</span><span class="p">)</span>
<span class="go">-691/2730</span>
<span class="gp">sage: </span><span class="n">bernoulli</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;gap&#39;</span><span class="p">)</span>
<span class="go">-691/2730</span>
<span class="gp">sage: </span><span class="n">bernoulli</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;gp&#39;</span><span class="p">)</span>
<span class="go">-691/2730</span>
<span class="gp">sage: </span><span class="n">bernoulli</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">)</span>           <span class="c1"># optional - magma</span>
<span class="go">-691/2730</span>
<span class="gp">sage: </span><span class="n">bernoulli</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span>
<span class="go">-691/2730</span>
<span class="gp">sage: </span><span class="n">bernoulli</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;bernmm&#39;</span><span class="p">)</span>
<span class="go">-691/2730</span>
<span class="gp">sage: </span><span class="n">bernoulli</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;bernmm&#39;</span><span class="p">,</span> <span class="n">num_threads</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="go">-691/2730</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li><p>David Joyner and William Stein</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.binomial">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">binomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.binomial" title="Permalink to this definition">#</a></dt>
<dd><p>Return the binomial coefficient</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\binom{x}{m} = x (x-1) \cdots (x-m+1) / m!\]</div>
</div>
<p>which is defined for <span class="math notranslate nohighlight">\(m \in \ZZ\)</span> and any
<span class="math notranslate nohighlight">\(x\)</span>. We extend this definition to include cases when
<span class="math notranslate nohighlight">\(x-m\)</span> is an integer but <span class="math notranslate nohighlight">\(m\)</span> is not by</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\binom{x}{m} = \binom{x}{x-m}\]</div>
</div>
<p>If <span class="math notranslate nohighlight">\(m &lt; 0\)</span>, return <span class="math notranslate nohighlight">\(0\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">m</span></code> - numbers or symbolic expressions. Either <code class="docutils literal notranslate"><span class="pre">m</span></code>
or <code class="docutils literal notranslate"><span class="pre">x-m</span></code> must be an integer.</p></li>
</ul>
<p>OUTPUT: number or symbolic expression (if input is symbolic)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.arith.misc</span> <span class="kn">import</span> <span class="n">binomial</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="go">184756</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">-6</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="n">RealField</span><span class="p">()(</span><span class="s1">&#39;2.5&#39;</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">1.87500000000000</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">);</span> <span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1/2*(n - 1)*n</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">);</span> <span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">);</span> <span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">n</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="o">^</span><span class="mi">100</span><span class="p">)</span>
<span class="go">1</span>

<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">1/6*x^3 - 1/2*x^2 + 1/3*x</span>
<span class="gp">sage: </span><span class="n">binomial</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1/6*x^3 - 1/2*x^2 + 1/3*x</span>
</pre></div>
</div>
<p>If <span class="math notranslate nohighlight">\(x \in \ZZ\)</span>, there is an optional ‘algorithm’ parameter, which
can be ‘gmp’ (faster for small values; alias: ‘mpir’) or
‘pari’ (faster for large values):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">binomial</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;gmp&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">binomial</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">==</span> <span class="n">b</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.binomial_coefficients">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">binomial_coefficients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.binomial_coefficients" title="Permalink to this definition">#</a></dt>
<dd><p>Return a dictionary containing pairs
<span class="math notranslate nohighlight">\(\{(k_1,k_2) : C_{k,n}\}\)</span> where <span class="math notranslate nohighlight">\(C_{k_n}\)</span> are
binomial coefficients and <span class="math notranslate nohighlight">\(n = k_1 + k_2\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> - an integer</p></li>
</ul>
<p>OUTPUT: dict</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">binomial_coefficients</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="go">[((0, 3), 1), ((1, 2), 3), ((2, 1), 3), ((3, 0), 1)]</span>
</pre></div>
</div>
<p>Notice the coefficients above are the same as below:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span>
<span class="go">x^3 + 3*x^2*y + 3*x*y^2 + y^3</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int8</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">binomial_coefficients</span><span class="p">(</span><span class="n">int8</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="go">[((0, 3), 1), ((1, 2), 3), ((2, 1), 3), ((3, 0), 1)]</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">binomial_coefficients</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="go">[((0, 3), 1), ((1, 2), 3), ((2, 1), 3), ((3, 0), 1)]</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Fredrik Johansson</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.carmichael_lambda">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">carmichael_lambda</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.carmichael_lambda" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Carmichael function of a positive integer <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p>
<p>The Carmichael function of <span class="math notranslate nohighlight">\(n\)</span>, denoted <span class="math notranslate nohighlight">\(\lambda(n)\)</span>, is the smallest
positive integer <span class="math notranslate nohighlight">\(k\)</span> such that <span class="math notranslate nohighlight">\(a^k \equiv 1 \pmod{n}\)</span> for all
<span class="math notranslate nohighlight">\(a \in \ZZ/n\ZZ\)</span> satisfying <span class="math notranslate nohighlight">\(\gcd(a, n) = 1\)</span>. Thus, <span class="math notranslate nohighlight">\(\lambda(n) = k\)</span>
is the exponent of the multiplicative group <span class="math notranslate nohighlight">\((\ZZ/n\ZZ)^{\ast}\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – a positive integer.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>The Carmichael function of <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p></li>
</ul>
<p>ALGORITHM:</p>
<p>If <span class="math notranslate nohighlight">\(n = 2, 4\)</span> then <span class="math notranslate nohighlight">\(\lambda(n) = \varphi(n)\)</span>. Let <span class="math notranslate nohighlight">\(p \geq 3\)</span> be an odd
prime and let <span class="math notranslate nohighlight">\(k\)</span> be a positive integer. Then
<span class="math notranslate nohighlight">\(\lambda(p^k) = p^{k - 1}(p - 1) = \varphi(p^k)\)</span>. If <span class="math notranslate nohighlight">\(k \geq 3\)</span>, then
<span class="math notranslate nohighlight">\(\lambda(2^k) = 2^{k - 2}\)</span>. Now consider the case where <span class="math notranslate nohighlight">\(n &gt; 3\)</span> is
composite and let <span class="math notranslate nohighlight">\(n = p_1^{k_1} p_2^{k_2} \cdots p_t^{k_t}\)</span> be the
prime factorization of <span class="math notranslate nohighlight">\(n\)</span>. Then</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\lambda(n)
= \lambda(p_1^{k_1} p_2^{k_2} \cdots p_t^{k_t})
= \text{lcm}(\lambda(p_1^{k_1}), \lambda(p_2^{k_2}), \dots, \lambda(p_t^{k_t}))\]</div>
</div>
<p>EXAMPLES:</p>
<p>The Carmichael function of all positive integers up to and including 10:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.arith.misc</span> <span class="kn">import</span> <span class="n">carmichael_lambda</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">carmichael_lambda</span><span class="p">,</span> <span class="p">[</span><span class="mf">1..10</span><span class="p">]))</span>
<span class="go">[1, 1, 2, 2, 4, 2, 6, 2, 6, 4]</span>
</pre></div>
</div>
<p>The Carmichael function of the first ten primes:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">carmichael_lambda</span><span class="p">,</span> <span class="n">primes_first_n</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
<span class="go">[1, 2, 4, 6, 10, 12, 16, 18, 22, 28]</span>
</pre></div>
</div>
<p>Cases where the Carmichael function is equivalent to the Euler phi
function:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">carmichael_lambda</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="n">euler_phi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">carmichael_lambda</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="n">euler_phi</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">random_prime</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">lbound</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">carmichael_lambda</span><span class="p">(</span><span class="n">p</span><span class="o">^</span><span class="n">k</span><span class="p">)</span> <span class="o">==</span> <span class="n">euler_phi</span><span class="p">(</span><span class="n">p</span><span class="o">^</span><span class="n">k</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A case where <span class="math notranslate nohighlight">\(\lambda(n) \neq \varphi(n)\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">carmichael_lambda</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="n">k</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">carmichael_lambda</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="n">k</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="n">euler_phi</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="n">k</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Verifying the current implementation of the Carmichael function using
another implementation. The other implementation that we use for
verification is an exhaustive search for the exponent of the
multiplicative group <span class="math notranslate nohighlight">\((\ZZ/n\ZZ)^{\ast}\)</span>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.arith.misc</span> <span class="kn">import</span> <span class="n">carmichael_lambda</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">carmichael_lambda</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">def</span> <span class="nf">coprime</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="k">return</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">if</span> <span class="n">gcd</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="k">def</span> <span class="nf">znpower</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="n">L</span> <span class="o">=</span> <span class="n">coprime</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">power_mod</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">),</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="k">def</span> <span class="nf">my_carmichael</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span class="gp">....: </span>        <span class="k">return</span> <span class="mi">1</span>
<span class="gp">....: </span>    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="gp">....: </span>        <span class="n">L</span> <span class="o">=</span> <span class="n">znpower</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="gp">....: </span>        <span class="n">ones</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="gp">....: </span>        <span class="n">T</span> <span class="o">=</span> <span class="p">[</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">ones</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">))]</span>
<span class="gp">....: </span>        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
<span class="gp">....: </span>            <span class="k">return</span> <span class="n">k</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">==</span> <span class="n">my_carmichael</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Carmichael’s theorem states that <span class="math notranslate nohighlight">\(a^{\lambda(n)} \equiv 1 \pmod{n}\)</span>
for all elements <span class="math notranslate nohighlight">\(a\)</span> of the multiplicative group <span class="math notranslate nohighlight">\((\ZZ/n\ZZ)^{\ast}\)</span>.
Here, we verify Carmichael’s theorem.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.arith.misc</span> <span class="kn">import</span> <span class="n">carmichael_lambda</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">carmichael_lambda</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ZnZ</span> <span class="o">=</span> <span class="n">IntegerModRing</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">ZnZ</span><span class="o">.</span><span class="n">list_of_elements_of_multiplicative_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">ones</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="p">[</span><span class="n">power_mod</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">M</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">==</span> <span class="n">ones</span>
<span class="go">True</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Carmichael_function">Wikipedia article Carmichael_function</a></p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.continuant">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">continuant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.continuant" title="Permalink to this definition">#</a></dt>
<dd><p>Function returns the continuant of the sequence <span class="math notranslate nohighlight">\(v\)</span> (list
or tuple).</p>
<p>Definition: see Graham, Knuth and Patashnik, <em>Concrete Mathematics</em>,
section 6.7: Continuants. The continuant is defined by</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(K_0() = 1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(K_1(x_1) = x_1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(K_n(x_1, \cdots, x_n) = K_{n-1}(x_n, \cdots x_{n-1})x_n + K_{n-2}(x_1,  \cdots, x_{n-2})\)</span></p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">=</span> <span class="pre">None</span></code> or <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">&gt;</span> <span class="pre">len(v)</span></code> the default
<code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">=</span> <span class="pre">len(v)</span></code> is used.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code> - list or tuple of elements of a ring</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> - optional integer</p></li>
</ul>
<p>OUTPUT: element of ring (integer, polynomial, etcetera).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">continuant</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">continuant</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="n">continuant</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">/</span><span class="n">q</span>
<span class="go">517656/190435</span>
<span class="gp">sage: </span><span class="n">continued_fraction</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span><span class="o">.</span><span class="n">convergent</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<span class="go">517656/190435</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">RationalField</span><span class="p">(),</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">continuant</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">x0*x1*x2*x3*x4 + x0*x1*x2 + x0*x1*x4 + x0*x3*x4 + x2*x3*x4 + x0 + x2 + x4</span>
<span class="gp">sage: </span><span class="n">continuant</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">x0*x1*x2 + x0 + x2</span>
<span class="gp">sage: </span><span class="n">continuant</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x0*x1 + 1</span>
</pre></div>
</div>
<p>We verify the identity</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[K_n(z,z,\cdots,z) = \sum_{k=0}^n \binom{n-k}{k} z^{n-2k}\]</div>
</div>
<p>for <span class="math notranslate nohighlight">\(n = 6\)</span> using polynomial arithmetic:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span><span class="mf">.0</span>
<span class="gp">sage: </span><span class="n">continuant</span><span class="p">((</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">),</span><span class="mi">6</span><span class="p">)</span>
<span class="go">z^6 + 5*z^4 + 6*z^2 + 1</span>

<span class="gp">sage: </span><span class="n">continuant</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: object of type &#39;sage.rings.integer.Integer&#39; has no len()</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int8</span>
<span class="gp">sage: </span><span class="n">continuant</span><span class="p">([</span><span class="n">int8</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">int8</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">int8</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">continuant</span><span class="p">([</span><span class="n">mpz</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">mpz</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">mpz</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
<span class="go">mpz(10)</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Jaap Spies (2007-02-06)</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.crt">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">crt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.crt" title="Permalink to this definition">#</a></dt>
<dd><p>Return a solution to a Chinese Remainder Theorem problem.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code> - two residues (elements of some ring for which
extended gcd is available), or two lists, one of residues and
one of moduli.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code>, <code class="docutils literal notranslate"><span class="pre">n</span></code> - (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) two moduli, or <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>If <code class="docutils literal notranslate"><span class="pre">m</span></code>, <code class="docutils literal notranslate"><span class="pre">n</span></code> are not <code class="docutils literal notranslate"><span class="pre">None</span></code>, returns a solution <span class="math notranslate nohighlight">\(x\)</span> to the
simultaneous congruences <span class="math notranslate nohighlight">\(x\equiv a \bmod m\)</span> and <span class="math notranslate nohighlight">\(x\equiv b \bmod
n\)</span>, if one exists. By the Chinese Remainder Theorem, a solution to the
simultaneous congruences exists if and only if
<span class="math notranslate nohighlight">\(a\equiv b\pmod{\gcd(m,n)}\)</span>. The solution <span class="math notranslate nohighlight">\(x\)</span> is only well-defined modulo
<span class="math notranslate nohighlight">\(\text{lcm}(m,n)\)</span>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> are lists, returns a simultaneous solution to
the congruences <span class="math notranslate nohighlight">\(x\equiv a_i\pmod{b_i}\)</span>, if one exists.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="#sage.arith.misc.CRT_list" title="sage.arith.misc.CRT_list"><code class="xref py py-func docutils literal notranslate"><span class="pre">CRT_list()</span></code></a></p></li>
</ul>
</div>
<p>EXAMPLES:</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">crt</span></code> by giving it pairs of residues and moduli:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">11</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">301</span><span class="p">)</span>
<span class="go">28013</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="go">11</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">([</span><span class="mi">13</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">301</span><span class="p">])</span>
<span class="go">28013</span>
</pre></div>
</div>
<p>You can also use upper case:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">CRT</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span> <span class="n">c</span>
<span class="go">8</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">2</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">3</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Note that this also works for polynomial rings:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">CRT</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">)</span>
<span class="go">-3/26*y^4 + 5/26*y^3 + 15/26*y + 53/26</span>
<span class="gp">sage: </span><span class="n">CRT</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">)</span>
<span class="go">(-3/52*a + 3/52)*y^4 + (5/52*a - 5/52)*y^3 + (15/52*a - 15/52)*y + 27/52*a + 25/52</span>
</pre></div>
</div>
<p>You can also do this for any number of moduli:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">CRT</span><span class="p">([],</span> <span class="p">[])</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">CRT</span><span class="p">([</span><span class="n">a</span><span class="p">],</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span>
<span class="go">a</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">9</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">CRT</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span><span class="p">]);</span> <span class="n">k</span>
<span class="go">(127/26988*a - 5807/386828)*x^9 + (45/8996*a - 33677/1160484)*x^8 + (2/173*a - 6/173)*x^7 + (133/6747*a - 5373/96707)*x^6 + (-6/2249*a + 18584/290121)*x^5 + (-277/8996*a + 38847/386828)*x^4 + (-135/4498*a + 42673/193414)*x^3 + (-1005/8996*a + 470245/1160484)*x^2 + (-1215/8996*a + 141165/386828)*x + 621/8996*a + 836445/386828</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">a</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>If the moduli are not coprime, a solution may not exist:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<span class="go">20</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: no solution to crt problem since gcd(8,12) does not divide 4-6</span>

<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="go">-1/2*x + 5/2</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="go">-1/2*x^3 + x^2 + 1/2*x + 1</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: no solution to crt problem since gcd(x^2 - 1,x^3 - 1) does not divide 2-x</span>

<span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<span class="go">58</span>
</pre></div>
</div>
<p>crt also work with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">int8</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">int8</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">int8</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">int8</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<span class="go">58</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">mpz</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">mpz</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">mpz</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<span class="go">58</span>
<span class="gp">sage: </span><span class="n">crt</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="n">mpz</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">int8</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<span class="go">58</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.dedekind_psi">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">dedekind_psi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.dedekind_psi" title="Permalink to this definition">#</a></dt>
<dd><p>Return the value of the Dedekind psi function at <code class="docutils literal notranslate"><span class="pre">N</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">N</span></code> – a positive integer</p></li>
</ul>
<p>OUTPUT:</p>
<p>an integer</p>
<p>The Dedekind psi function is the multiplicative function defined by</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\psi(n) = n \prod_{p|n, p prime} (1 + 1/p).\]</div>
</div>
<p>See <a class="reference external" href="https://en.wikipedia.org/wiki/Dedekind_psi_function">Wikipedia article Dedekind_psi_function</a> and <a class="reference external" href="https://oeis.org/A001615">OEIS sequence A001615</a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.arith.misc</span> <span class="kn">import</span> <span class="n">dedekind_psi</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">dedekind_psi</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">)]</span>
<span class="go">[1, 3, 4, 6, 6, 12, 8, 12, 12, 18, 12]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.dedekind_sum">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">dedekind_sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.dedekind_sum" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Dedekind sum <span class="math notranslate nohighlight">\(s(p,q)\)</span> defined for integers <span class="math notranslate nohighlight">\(p\)</span>, <span class="math notranslate nohighlight">\(q\)</span> as</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[s(p,q) = \sum_{i=0}^{q-1} \left(\!\left(\frac{i}{q}\right)\!\right)
                          \left(\!\left(\frac{pi}{q}\right)\!\right)\]</div>
</div>
<p>where</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}((x))=\begin{cases}
    x-\lfloor x \rfloor - \frac{1}{2} &amp;\mbox{if }
        x \in \QQ \setminus \ZZ \\
    0 &amp; \mbox{if } x \in \ZZ.
    \end{cases}\end{split}\]</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Caution is required as the Dedekind sum sometimes depends on the
algorithm or is left undefined when <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span> are not coprime.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code>, <code class="docutils literal notranslate"><span class="pre">q</span></code> – integers</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – must be one of the following</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'default'</span></code> - (default) use FLINT</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'flint'</span></code> - use FLINT</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pari'</span></code> - use PARI (gives different results if <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span>
are not coprime)</p></li>
</ul>
</li>
</ul>
<p>OUTPUT: a rational number</p>
<p>EXAMPLES:</p>
<p>Several small values:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span> <span class="nb">print</span><span class="p">([</span><span class="n">dedekind_sum</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>
<span class="go">[0]</span>
<span class="go">[0, 0]</span>
<span class="go">[0, 0, 0]</span>
<span class="go">[0, 1/18, -1/18, 0]</span>
<span class="go">[0, 1/8, 0, -1/8, 0]</span>
<span class="go">[0, 1/5, 0, 0, -1/5, 0]</span>
<span class="go">[0, 5/18, 1/18, 0, -1/18, -5/18, 0]</span>
<span class="go">[0, 5/14, 1/14, -1/14, 1/14, -1/14, -5/14, 0]</span>
<span class="go">[0, 7/16, 1/8, 1/16, 0, -1/16, -1/8, -7/16, 0]</span>
<span class="go">[0, 14/27, 4/27, 1/18, -4/27, 4/27, -1/18, -4/27, -14/27, 0]</span>
</pre></div>
</div>
<p>Check relations for restricted arguments:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="mi">23</span><span class="p">;</span> <span class="n">dedekind_sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">);</span> <span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">12</span><span class="o">*</span><span class="n">q</span><span class="p">)</span>
<span class="go">77/46</span>
<span class="go">77/46</span>
<span class="gp">sage: </span><span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">723</span>    <span class="c1"># must be coprime</span>
<span class="gp">sage: </span><span class="n">dedekind_sum</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="o">+</span> <span class="n">dedekind_sum</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="go">31583/86760</span>
<span class="gp">sage: </span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span> <span class="p">(</span><span class="n">p</span><span class="o">/</span><span class="n">q</span> <span class="o">+</span> <span class="n">q</span><span class="o">/</span><span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="p">))</span><span class="o">/</span><span class="mi">12</span>
<span class="go">31583/86760</span>
</pre></div>
</div>
<p>We check that evaluation works with large input:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">dedekind_sum</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">54</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">^</span><span class="mi">93</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">459340694971839990630374299870/29710560942849126597578981379</span>
<span class="gp">sage: </span><span class="n">dedekind_sum</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">54</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">^</span><span class="mi">93</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span>
<span class="go">459340694971839990630374299870/29710560942849126597578981379</span>
</pre></div>
</div>
<p>We check consistency of the results:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">dedekind_sum</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>
<span class="go">-1/14</span>
<span class="gp">sage: </span><span class="n">dedekind_sum</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;flint&#39;</span><span class="p">)</span>
<span class="go">-1/14</span>
<span class="gp">sage: </span><span class="n">dedekind_sum</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span>
<span class="go">-1/14</span>
<span class="gp">sage: </span><span class="n">dedekind_sum</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>
<span class="go">-1/8</span>
<span class="gp">sage: </span><span class="n">dedekind_sum</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;flint&#39;</span><span class="p">)</span>
<span class="go">-1/8</span>
<span class="gp">sage: </span><span class="n">dedekind_sum</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span>
<span class="go">-1/8</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int8</span>
<span class="gp">sage: </span><span class="n">dedekind_sum</span><span class="p">(</span><span class="n">int8</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">int8</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>
<span class="go">-1/14</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">dedekind_sum</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">mpz</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>
<span class="go">-1/14</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../../references/index.html#ap1997" id="id1"><span>[Ap1997]</span></a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Dedekind_sum">Wikipedia article Dedekind_sum</a></p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.differences">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">differences</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.differences" title="Permalink to this definition">#</a></dt>
<dd><p>Return the <span class="math notranslate nohighlight">\(n\)</span> successive differences of the elements in <code class="docutils literal notranslate"><span class="pre">lis</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">differences</span><span class="p">(</span><span class="n">prime_range</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span>
<span class="go">[1, 2, 2, 4, 2, 4, 2, 4, 6, 2, 6, 4, 2, 4]</span>
<span class="gp">sage: </span><span class="n">differences</span><span class="p">([</span><span class="n">i</span><span class="o">^</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">)])</span>
<span class="go">[3, 5, 7, 9, 11, 13, 15, 17, 19]</span>
<span class="gp">sage: </span><span class="n">differences</span><span class="p">([</span><span class="n">i</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">21</span><span class="p">)])</span>
<span class="go">[10, 22, 40, 64, 94, 130, 172, 220, 274, 334, 400, 472, 550, 634, 724, 820, 922, 1030, 1144]</span>
<span class="gp">sage: </span><span class="n">differences</span><span class="p">([</span><span class="n">i</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">i</span><span class="o">^</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">21</span><span class="p">)],</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">[10, 16, 22, 28, 34, 40, 46, 52, 58, 64, 70, 76, 82, 88, 94, 100, 106, 112]</span>
<span class="gp">sage: </span><span class="n">differences</span><span class="p">([</span><span class="n">p</span> <span class="o">-</span> <span class="n">i</span><span class="o">^</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">prime_range</span><span class="p">(</span><span class="mi">50</span><span class="p">))],</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">[-1, 2, -4, 4, -4, 4, 0, -6, 8, -6, 0, 4]</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int8</span>
<span class="gp">sage: </span><span class="n">differences</span><span class="p">([</span><span class="n">int8</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">int8</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">int8</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">int8</span><span class="p">(</span><span class="mi">19</span><span class="p">)])</span>
<span class="go">[3, 2, 13]</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">differences</span><span class="p">([</span><span class="n">mpz</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">mpz</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">mpz</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">mpz</span><span class="p">(</span><span class="mi">19</span><span class="p">)])</span>
<span class="go">[mpz(3), mpz(2), mpz(13)]</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Timothy Clemans (2008-03-09)</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.divisors">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">divisors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.divisors" title="Permalink to this definition">#</a></dt>
<dd><p>Return the list of all divisors (up to units) of this element
of a unique factorization domain.</p>
<p>For an integer, the list of all positive integer divisors
of this integer, sorted in increasing order, is returned.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> - the element</p></li>
</ul>
<p>EXAMPLES:</p>
<p>Divisors of integers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">divisors</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[1, 3]</span>
<span class="gp">sage: </span><span class="n">divisors</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="go">[1, 2, 3, 6]</span>
<span class="gp">sage: </span><span class="n">divisors</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span>
<span class="go">[1, 2, 4, 7, 14, 28]</span>
<span class="gp">sage: </span><span class="n">divisors</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[1, 2, 4, 8, 16, 32]</span>
<span class="gp">sage: </span><span class="n">divisors</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">[1, 2, 4, 5, 10, 20, 25, 50, 100]</span>
<span class="gp">sage: </span><span class="n">divisors</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[1]</span>
<span class="gp">sage: </span><span class="n">divisors</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: n must be nonzero</span>
<span class="gp">sage: </span><span class="n">divisors</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">3</span> <span class="o">*</span> <span class="mi">3</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">17</span><span class="p">)</span>
<span class="go">[1, 2, 3, 4, 6, 8, 9, 12, 17, 18, 24, 34, 36, 51, 68, 72,</span>
<span class="go">102, 136, 153, 204, 306, 408, 612, 1224]</span>
</pre></div>
</div>
<p>This function works whenever one has unique factorization:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">divisors</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="go">[Fractional ideal (1), Fractional ideal (a), Fractional ideal (7)]</span>
<span class="gp">sage: </span><span class="n">divisors</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">[Fractional ideal (1), Fractional ideal (3),</span>
<span class="go">Fractional ideal (a - 2), Fractional ideal (a + 2)]</span>
<span class="gp">sage: </span><span class="n">divisors</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">35</span><span class="p">))</span>
<span class="go">[Fractional ideal (1), Fractional ideal (5), Fractional ideal (a),</span>
<span class="go">Fractional ideal (7), Fractional ideal (5*a), Fractional ideal (35)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.eratosthenes">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">eratosthenes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.eratosthenes" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list of the primes <span class="math notranslate nohighlight">\(\leq n\)</span>.</p>
<p>This is extremely slow and is for educational purposes only.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> - a positive integer</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a list of primes less than or equal to n.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">eratosthenes</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[2, 3]</span>
<span class="gp">sage: </span><span class="n">eratosthenes</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="go">[2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">eratosthenes</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="go">25</span>
<span class="gp">sage: </span><span class="n">eratosthenes</span><span class="p">(</span><span class="mi">213</span><span class="p">)</span> <span class="o">==</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">213</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.factor">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pari'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.factor" title="Permalink to this definition">#</a></dt>
<dd><p>Return the factorization of <code class="docutils literal notranslate"><span class="pre">n</span></code>.  The result depends on the
type of <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">n</span></code> is an integer, returns the factorization as an object
of type <code class="docutils literal notranslate"><span class="pre">Factorization</span></code>.</p>
<p>If n is not an integer, <code class="docutils literal notranslate"><span class="pre">n.factor(proof=proof,</span> <span class="pre">**kwds)</span></code> gets called.
See <code class="docutils literal notranslate"><span class="pre">n.factor??</span></code> for more documentation in this case.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This means that applying <code class="docutils literal notranslate"><span class="pre">factor</span></code> to an integer result of
a symbolic computation will not factor the integer, because it is
considered as an element of a larger symbolic ring.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">=</span><span class="n">n</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">is_prime</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">9</span>
</pre></div>
</div>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> - an nonzero integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> - bool or None (default: None)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int_</span></code> - bool (default: False) whether to return
answers as Python ints</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> - string</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'pari'</span></code> - (default) use the PARI c library</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'flint'</span></code> - use the FLINT library</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'kash'</span></code> - use KASH computer algebra system (requires that
kash be installed)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'magma'</span></code> - use Magma (requires magma be installed)</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> - integer (default: 0); PARI’s debug
variable is set to this; e.g., set to 4 or 8 to see lots of output
during factorization.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>factorization of n</p></li>
</ul>
<p>The qsieve and ecm commands give access to highly optimized
implementations of algorithms for doing certain integer
factorization problems. These implementations are not used by the
generic factor command, which currently just calls PARI (note that
PARI also implements sieve and ecm algorithms, but they are not as
optimized). Thus you might consider using them instead for certain
numbers.</p>
<p>The factorization returned is an element of the class
<a class="reference external" href="../../../structure/sage/structure/factorization.html#sage.structure.factorization.Factorization" title="(in Parents and Elements v10.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Factorization</span></code></a>; see Factorization??
for more details, and examples below for usage. A Factorization contains
both the unit factor (+1 or -1) and a sorted list of (prime, exponent)
pairs.</p>
<p>The factorization displays in pretty-print format but it is easy to
obtain access to the (prime,exponent) pairs and the unit, to
recover the number from its factorization, and even to multiply two
factorizations. See examples below.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
<span class="go">2^2 * 5^3</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">)</span>
<span class="go">-1 * 2^2 * 5</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">=</span><span class="n">factor</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">[(2, 2), (5, 1)]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">unit</span><span class="p">()</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="go">-20</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span> <span class="o">-</span><span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">7</span><span class="p">)</span> <span class="p">)</span>
<span class="go">-1 * 101 * 10000019</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="mi">293292629867846432923017396246429</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;flint&#39;</span><span class="p">)</span>
<span class="go">3 * 4852301647696687 * 20148007492971089</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;kash&#39;</span><span class="p">)</span>      <span class="c1"># optional - kash</span>
<span class="go">-1 * 2^2 * 5^3</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">)</span>     <span class="c1"># optional - magma</span>
<span class="go">-1 * 2^2 * 5^3</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ArithmeticError: factorization of 0 is not defined</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">7</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="go">59649589127497217 * 5704689200685129054721</span>
</pre></div>
</div>
<p>Sage calls PARI’s factor, which has proof False by default.
Sage has a global proof flag, set to True by default (see
<a class="reference external" href="../../../structure/sage/structure/proof/proof.html#module-sage.structure.proof.proof" title="(in Parents and Elements v10.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.structure.proof.proof</span></code></a>, or proof.[tab]). To override
the default, call this function with proof=False.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">89</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">2 * 179 * 1611479891519807 * 5042939439565996049162197</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">197</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># long time (2s)</span>
<span class="go">3 * 197002597249 * 1348959352853811313 * 251951573867253012259144010843</span>
</pre></div>
</div>
<p>Any object which has a factor method can be factored like this:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="mi">122</span> <span class="o">-</span> <span class="mi">454</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<span class="go">(-i) * (-i - 2)^3 * (i + 1)^3 * (-2*i + 3) * (i + 4)</span>
</pre></div>
</div>
<p>To access the data in a factorization:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="mi">420</span><span class="p">);</span> <span class="n">f</span>
<span class="go">2^2 * 3 * 5 * 7</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">f</span><span class="p">]</span>
<span class="go">[(2, 2), (3, 1), (5, 1), (7, 1)]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="n">f</span><span class="p">]</span>
<span class="go">[2, 3, 5, 7]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="n">f</span><span class="p">]</span>
<span class="go">[2, 1, 1, 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">p</span><span class="o">^</span><span class="n">e</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="n">f</span><span class="p">]</span>
<span class="go">[4, 3, 5, 7]</span>
</pre></div>
</div>
<p>We can factor Python, numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="go">3.141592653589793</span>
<span class="gp">sage: </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">int8</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>
<span class="go">2 * 3 * 5</span>
<span class="gp">sage: </span><span class="kn">import</span> <span class="nn">gmpy2</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">gmpy2</span><span class="o">.</span><span class="n">mpz</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>
<span class="go">2 * 3 * 5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.factorial">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">factorial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gmp'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.factorial" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the factorial of <span class="math notranslate nohighlight">\(n\)</span>, which is the product
<span class="math notranslate nohighlight">\(1\cdot 2\cdot 3 \cdots (n-1)\cdot n\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> - an integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> - string (default: ‘gmp’):</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'gmp'</span></code> - use the GMP C-library factorial function</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pari'</span></code> - use PARI’s factorial function</p></li>
</ul>
</li>
</ul>
<p>OUTPUT: an integer</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.arith.misc</span> <span class="kn">import</span> <span class="n">factorial</span>
<span class="gp">sage: </span><span class="n">factorial</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">factorial</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">24</span>
<span class="gp">sage: </span><span class="n">factorial</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">3628800</span>
<span class="gp">sage: </span><span class="n">factorial</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">factorial</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">factorial</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="mi">2</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">factorial</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">factorial</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">factorial</span><span class="p">(</span><span class="mi">71</span><span class="p">)</span> <span class="o">==</span> <span class="mi">71</span><span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="mi">70</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">factorial</span><span class="p">(</span><span class="o">-</span><span class="mi">32</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: factorial -- must be nonnegative</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int8</span>
<span class="gp">sage: </span><span class="n">factorial</span><span class="p">(</span><span class="n">int8</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="go">24</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">factorial</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="go">24</span>
</pre></div>
</div>
<p>PERFORMANCE: This discussion is valid as of April 2006. All timings
below are on a Pentium Core Duo 2Ghz MacBook Pro running Linux with
a 2.6.16.1 kernel.</p>
<ul class="simple">
<li><p>It takes less than a minute to compute the factorial of
<span class="math notranslate nohighlight">\(10^7\)</span> using the GMP algorithm, and the factorial of
<span class="math notranslate nohighlight">\(10^6\)</span> takes less than 4 seconds.</p></li>
<li><p>The GMP algorithm is faster and more memory efficient than the
PARI algorithm. E.g., PARI computes <span class="math notranslate nohighlight">\(10^7\)</span> factorial in 100
seconds on the core duo 2Ghz.</p></li>
<li><p>For comparison, computation in Magma <span class="math notranslate nohighlight">\(\leq\)</span> 2.12-10 of
<span class="math notranslate nohighlight">\(n!\)</span> is best done using <code class="docutils literal notranslate"><span class="pre">*[1..n]</span></code>. It takes
113 seconds to compute the factorial of <span class="math notranslate nohighlight">\(10^7\)</span> and 6
seconds to compute the factorial of <span class="math notranslate nohighlight">\(10^6\)</span>. Mathematica
V5.2 compute the factorial of <span class="math notranslate nohighlight">\(10^7\)</span> in 136 seconds and the
factorial of <span class="math notranslate nohighlight">\(10^6\)</span> in 7 seconds. (Mathematica is notably
very efficient at memory usage when doing factorial
calculations.)</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.falling_factorial">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">falling_factorial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.falling_factorial" title="Permalink to this definition">#</a></dt>
<dd><p>Return the falling factorial <span class="math notranslate nohighlight">\((x)_a\)</span>.</p>
<p>The notation in the literature is a mess: often <span class="math notranslate nohighlight">\((x)_a\)</span>,
but there are many other notations: GKP: Concrete Mathematics uses
<span class="math notranslate nohighlight">\(x^{\underline{a}}\)</span>.</p>
<p>Definition: for integer <span class="math notranslate nohighlight">\(a \ge 0\)</span> we have
<span class="math notranslate nohighlight">\(x(x-1) \cdots (x-a+1)\)</span>. In all other cases we use the
GAMMA-function: <span class="math notranslate nohighlight">\(\frac {\Gamma(x+1)} {\Gamma(x-a+1)}\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> – element of a ring</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code> – a non-negative integer or</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">and</span> <span class="pre">a</span></code> – any numbers</p></li>
</ul>
<p>OUTPUT: the falling factorial</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.arith.misc.rising_factorial" title="sage.arith.misc.rising_factorial"><code class="xref py py-func docutils literal notranslate"><span class="pre">rising_factorial()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">falling_factorial</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">720</span>
<span class="gp">sage: </span><span class="n">falling_factorial</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">RR</span><span class="p">(</span><span class="s1">&#39;3.0&#39;</span><span class="p">))</span>
<span class="go">720.000000000000</span>
<span class="gp">sage: </span><span class="n">falling_factorial</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">RR</span><span class="p">(</span><span class="s1">&#39;3.3&#39;</span><span class="p">))</span>
<span class="go">1310.11633396601</span>
<span class="gp">sage: </span><span class="n">falling_factorial</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">3628800</span>
<span class="gp">sage: </span><span class="n">factorial</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">3628800</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">falling_factorial</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="p">,</span> <span class="n">I</span><span class="p">);</span> <span class="n">a</span>
<span class="go">gamma(I + 2)</span>
<span class="gp">sage: </span><span class="n">CC</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">0.652965496420167 + 0.343065839816545*I</span>
<span class="gp">sage: </span><span class="n">falling_factorial</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">4*I + 2</span>
<span class="gp">sage: </span><span class="n">falling_factorial</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">-10</span>

<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">M</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">falling_factorial</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># A(A - I)</span>
<span class="go">[  1   0  10  10]</span>
<span class="go">[  1   0  10  10]</span>
<span class="go">[ 20   0 101 100]</span>
<span class="go">[  2   0  11  10]</span>

<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="mf">.0</span>
<span class="gp">sage: </span><span class="n">falling_factorial</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">x^4 - 6*x^3 + 11*x^2 - 6*x</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Jaap Spies (2006-03-05)</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.four_squares">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">four_squares</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.four_squares" title="Permalink to this definition">#</a></dt>
<dd><p>Write the integer <span class="math notranslate nohighlight">\(n\)</span> as a sum of four integer squares.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – an integer</p></li>
</ul>
<p>OUTPUT: a tuple <span class="math notranslate nohighlight">\((a,b,c,d)\)</span> of non-negative integers such that
<span class="math notranslate nohighlight">\(n = a^2 + b^2 + c^2 + d^2\)</span> with <span class="math notranslate nohighlight">\(a &lt;= b &lt;= c &lt;= d\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">four_squares</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(0, 1, 1, 1)</span>
<span class="gp">sage: </span><span class="n">four_squares</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="go">(0, 0, 2, 3)</span>
<span class="gp">sage: </span><span class="n">four_squares</span><span class="p">(</span><span class="mi">130</span><span class="p">)</span>
<span class="go">(0, 0, 3, 11)</span>
<span class="gp">sage: </span><span class="n">four_squares</span><span class="p">(</span><span class="mi">1101011011004</span><span class="p">)</span>
<span class="go">(90, 102, 1220, 1049290)</span>
<span class="gp">sage: </span><span class="n">four_squares</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">100</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(155024616290, 2612183768627, 14142135623730950488016887, 99999999999999999999999999999999999999999999999999)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">129</span><span class="p">,</span> <span class="mi">2</span><span class="o">^</span><span class="mi">129</span><span class="o">+</span><span class="mi">10000</span><span class="p">):</span>  <span class="c1"># long time</span>
<span class="gp">....: </span>    <span class="n">S</span> <span class="o">=</span> <span class="n">four_squares</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="k">assert</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">S</span><span class="p">)</span> <span class="o">==</span> <span class="n">i</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.fundamental_discriminant">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">fundamental_discriminant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.fundamental_discriminant" title="Permalink to this definition">#</a></dt>
<dd><p>Return the discriminant of the quadratic extension
<span class="math notranslate nohighlight">\(K=Q(\sqrt{D})\)</span>, i.e. an integer d congruent to either 0 or
1, mod 4, and such that, at most, the only square dividing it is
4.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">D</span></code> - an integer</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>an integer, the fundamental discriminant</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fundamental_discriminant</span><span class="p">(</span><span class="mi">102</span><span class="p">)</span>
<span class="go">408</span>
<span class="gp">sage: </span><span class="n">fundamental_discriminant</span><span class="p">(</span><span class="mi">720</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">fundamental_discriminant</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">8</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int8</span>
<span class="gp">sage: </span><span class="n">fundamental_discriminant</span><span class="p">(</span><span class="n">int8</span><span class="p">(</span><span class="mi">102</span><span class="p">))</span>
<span class="go">408</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">fundamental_discriminant</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">102</span><span class="p">))</span>
<span class="go">408</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.gauss_sum">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">gauss_sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">char_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">finite_field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.gauss_sum" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Gauss sums for a general finite field.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">char_value</span></code> – choice of multiplicative character, given by
its value on the <code class="docutils literal notranslate"><span class="pre">finite_field.multiplicative_generator()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">finite_field</span></code> – a finite field</p></li>
</ul>
<p>OUTPUT:</p>
<p>an element of the parent ring of <code class="docutils literal notranslate"><span class="pre">char_value</span></code>, that can be any
field containing enough roots of unity, for example the
<code class="docutils literal notranslate"><span class="pre">UniversalCyclotomicField</span></code>, <code class="docutils literal notranslate"><span class="pre">QQbar</span></code> or <code class="docutils literal notranslate"><span class="pre">ComplexField</span></code></p>
<p>For a finite field <span class="math notranslate nohighlight">\(F\)</span> of characteristic <span class="math notranslate nohighlight">\(p\)</span>, the Gauss sum
associated to a multiplicative character <span class="math notranslate nohighlight">\(\chi\)</span> (with values in a
ring <span class="math notranslate nohighlight">\(K\)</span>) is defined as</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\sum_{x \in F^{\times}} \chi(x) \zeta_p^{\operatorname{Tr} x},\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(\zeta_p \in K\)</span> is a primitive root of unity of order <span class="math notranslate nohighlight">\(p\)</span> and
Tr is the trace map from <span class="math notranslate nohighlight">\(F\)</span> to its prime field <span class="math notranslate nohighlight">\(\GF{p}\)</span>.</p>
<p>For more info on Gauss sums, see <a class="reference external" href="https://en.wikipedia.org/wiki/Gauss_sum">Wikipedia article Gauss_sum</a>.</p>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p>Implement general Gauss sums for an arbitrary pair
<code class="docutils literal notranslate"><span class="pre">(multiplicative_character,</span> <span class="pre">additive_character)</span></code></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.arith.misc</span> <span class="kn">import</span> <span class="n">gauss_sum</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">zq</span> <span class="o">=</span> <span class="n">UniversalCyclotomicField</span><span class="p">()</span><span class="o">.</span><span class="n">zeta</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="n">gauss_sum</span><span class="p">(</span><span class="n">zq</span><span class="o">**</span><span class="n">i</span><span class="p">,</span><span class="n">F</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)];</span> <span class="n">L</span>
<span class="go">[-1,</span>
<span class="go"> E(20)^4 + E(20)^13 - E(20)^16 - E(20)^17,</span>
<span class="go"> E(5) - E(5)^2 - E(5)^3 + E(5)^4,</span>
<span class="go"> E(20)^4 - E(20)^13 - E(20)^16 + E(20)^17,</span>
<span class="go"> -1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">g</span><span class="o">*</span><span class="n">g</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">L</span><span class="p">]</span>
<span class="go">[1, 5, 5, 5, 1]</span>

<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="o">**</span><span class="mi">2</span><span class="p">);</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">11</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">zq</span> <span class="o">=</span> <span class="n">UniversalCyclotomicField</span><span class="p">()</span><span class="o">.</span><span class="n">zeta</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">gauss_sum</span><span class="p">(</span><span class="n">zq</span><span class="o">**</span><span class="mi">4</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">*</span><span class="n">g</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span>
<span class="go">121</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="../../../padics/sage/rings/padics/misc.html#sage.rings.padics.misc.gauss_sum" title="(in $p$-adics v10.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sage.rings.padics.misc.gauss_sum()</span></code></a> for a <span class="math notranslate nohighlight">\(p\)</span>-adic version</p></li>
<li><p><a class="reference external" href="../../../modfrm/sage/modular/dirichlet.html#sage.modular.dirichlet.DirichletCharacter.gauss_sum" title="(in Modular Forms v10.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.modular.dirichlet.DirichletCharacter.gauss_sum()</span></code></a>
for prime finite fields</p></li>
<li><p><a class="reference external" href="../../../modfrm/sage/modular/dirichlet.html#sage.modular.dirichlet.DirichletCharacter.gauss_sum_numerical" title="(in Modular Forms v10.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.modular.dirichlet.DirichletCharacter.gauss_sum_numerical()</span></code></a>
for prime finite fields</p></li>
</ul>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.gcd">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">gcd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.gcd" title="Permalink to this definition">#</a></dt>
<dd><p>Return the greatest common divisor of <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">a</span></code> is a list and <code class="docutils literal notranslate"><span class="pre">b</span></code> is omitted, return instead the
greatest common divisor of all elements of <code class="docutils literal notranslate"><span class="pre">a</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a,b</span></code> – two elements of a ring with gcd or</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code> – a list or tuple of elements of a ring with gcd</p></li>
</ul>
<p>Additional keyword arguments are passed to the respectively called
methods.</p>
<p>OUTPUT:</p>
<p>The given elements are first coerced into a common parent. Then,
their greatest common divisor <em>in that common parent</em> is returned.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">GCD</span><span class="p">(</span><span class="mi">97</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">GCD</span><span class="p">(</span><span class="mi">97</span><span class="o">*</span><span class="mi">10</span><span class="o">^</span><span class="mi">15</span><span class="p">,</span> <span class="mi">19</span><span class="o">^</span><span class="mi">20</span><span class="o">*</span><span class="mi">97</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">97</span>
<span class="gp">sage: </span><span class="n">GCD</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
<span class="go">2/15</span>
<span class="gp">sage: </span><span class="n">GCD</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">GCD</span><span class="p">(</span><span class="n">srange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10000</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>  <span class="c1"># fast  !!</span>
<span class="go">10</span>
</pre></div>
</div>
<p>Note that to take the gcd of <span class="math notranslate nohighlight">\(n\)</span> elements for <span class="math notranslate nohighlight">\(n \not= 2\)</span> you must
put the elements into a list by enclosing them in <code class="docutils literal notranslate"><span class="pre">[..]</span></code>.  Before
<a class="reference external" href="https://github.com/sagemath/sage/issues/4988">github issue #4988</a> the following wrongly returned 3 since the third parameter
was just ignored:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">gcd</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: ...gcd() takes ...</span>
<span class="gp">sage: </span><span class="n">gcd</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Similarly, giving just one element (which is not a list) gives an error:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">gcd</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: &#39;sage.rings.integer.Integer&#39; object is not iterable</span>
</pre></div>
</div>
<p>By convention, the gcd of the empty list is (the integer) 0:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">gcd</span><span class="p">([])</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">gcd</span><span class="p">([]))</span>
<span class="go">&lt;class &#39;sage.rings.integer.Integer&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.get_gcd">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">get_gcd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.get_gcd" title="Permalink to this definition">#</a></dt>
<dd><p>Return the fastest gcd function for integers of size no larger than
order.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">arith</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">get_gcd</span><span class="p">(</span><span class="mi">4000</span><span class="p">)</span>
<span class="go">&lt;built-in method gcd_int of sage.rings.fast_arith.arith_int object at ...&gt;</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">arith</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">get_gcd</span><span class="p">(</span><span class="mi">400000</span><span class="p">)</span>
<span class="go">&lt;built-in method gcd_longlong of sage.rings.fast_arith.arith_llong object at ...&gt;</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">arith</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">get_gcd</span><span class="p">(</span><span class="mi">4000000000</span><span class="p">)</span>
<span class="go">&lt;function gcd at ...&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.get_inverse_mod">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">get_inverse_mod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.get_inverse_mod" title="Permalink to this definition">#</a></dt>
<dd><p>Return the fastest inverse_mod function for integers of size no
larger than order.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">arith</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">get_inverse_mod</span><span class="p">(</span><span class="mi">6000</span><span class="p">)</span>
<span class="go">&lt;built-in method inverse_mod_int of sage.rings.fast_arith.arith_int object at ...&gt;</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">arith</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">get_inverse_mod</span><span class="p">(</span><span class="mi">600000</span><span class="p">)</span>
<span class="go">&lt;built-in method inverse_mod_longlong of sage.rings.fast_arith.arith_llong object at ...&gt;</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">arith</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">get_inverse_mod</span><span class="p">(</span><span class="mi">6000000000</span><span class="p">)</span>
<span class="go">&lt;function inverse_mod at ...&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.hilbert_conductor">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">hilbert_conductor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.hilbert_conductor" title="Permalink to this definition">#</a></dt>
<dd><p>Return the product of all (finite) primes where the Hilbert symbol is -1.</p>
<p>This is the (reduced) discriminant of the quaternion algebra <span class="math notranslate nohighlight">\((a,b)\)</span>
over <span class="math notranslate nohighlight">\(\QQ\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code> – integers</p></li>
</ul>
<p>OUTPUT:</p>
<p>squarefree positive integer</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">hilbert_conductor</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">hilbert_conductor</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">)</span>
<span class="go">11</span>
<span class="gp">sage: </span><span class="n">hilbert_conductor</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">hilbert_conductor</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">17</span><span class="p">)</span>
<span class="go">17</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int8</span>
<span class="gp">sage: </span><span class="n">hilbert_conductor</span><span class="p">(</span><span class="n">int8</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">),</span> <span class="n">int8</span><span class="p">(</span><span class="o">-</span><span class="mi">17</span><span class="p">))</span>
<span class="go">17</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">hilbert_conductor</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">),</span> <span class="n">mpz</span><span class="p">(</span><span class="o">-</span><span class="mi">17</span><span class="p">))</span>
<span class="go">17</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li><p>Gonzalo Tornaria (2009-03-02)</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.hilbert_conductor_inverse">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">hilbert_conductor_inverse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.hilbert_conductor_inverse" title="Permalink to this definition">#</a></dt>
<dd><p>Finds a pair of integers <span class="math notranslate nohighlight">\((a,b)\)</span> such that <code class="docutils literal notranslate"><span class="pre">hilbert_conductor(a,b)</span> <span class="pre">==</span> <span class="pre">d</span></code>.</p>
<p>The quaternion algebra <span class="math notranslate nohighlight">\((a,b)\)</span> over <span class="math notranslate nohighlight">\(\QQ\)</span> will then have (reduced)
discriminant <span class="math notranslate nohighlight">\(d\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">d</span></code> – square-free positive integer</p></li>
</ul>
<p>OUTPUT: pair of integers</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">hilbert_conductor_inverse</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(-1, -1)</span>
<span class="gp">sage: </span><span class="n">hilbert_conductor_inverse</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(-1, -3)</span>
<span class="gp">sage: </span><span class="n">hilbert_conductor_inverse</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="go">(-1, 3)</span>
<span class="gp">sage: </span><span class="n">hilbert_conductor_inverse</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="go">(-3, -10)</span>
<span class="gp">sage: </span><span class="n">hilbert_conductor_inverse</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: d needs to be squarefree</span>
<span class="gp">sage: </span><span class="n">hilbert_conductor_inverse</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: d needs to be positive</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li><p>Gonzalo Tornaria (2009-03-02)</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.hilbert_symbol">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">hilbert_symbol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pari'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.hilbert_symbol" title="Permalink to this definition">#</a></dt>
<dd><p>Return 1 if <span class="math notranslate nohighlight">\(ax^2 + by^2\)</span> <span class="math notranslate nohighlight">\(p\)</span>-adically represents
a nonzero square, otherwise returns <span class="math notranslate nohighlight">\(-1\)</span>. If either a or b
is 0, returns 0.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a,</span> <span class="pre">b</span></code> - integers</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> - integer; either prime or -1 (which
represents the archimedean place)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> - string</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'pari'</span></code> - (default) use the PARI C library</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'direct'</span></code> - use a Python implementation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'all'</span></code> - use both PARI and direct and check that
the results agree, then return the common answer</p></li>
</ul>
</li>
</ul>
<p>OUTPUT: integer (0, -1, or 1)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">hilbert_symbol</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">hilbert_symbol</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">hilbert_symbol</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">hilbert_symbol</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">hilbert_symbol</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">hilbert_symbol</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">hilbert_symbol</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="go">-1</span>

<span class="gp">sage: </span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">QQ</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">QQ</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">QQ</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">QQ</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int8</span>
<span class="gp">sage: </span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">int8</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">int8</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">int8</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">mpz</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">mpz</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>William Stein and David Kohel (2006-01-05)</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.integer_ceil">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">integer_ceil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.integer_ceil" title="Permalink to this definition">#</a></dt>
<dd><p>Return the ceiling of x.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">integer_ceil</span><span class="p">(</span><span class="mf">5.4</span><span class="p">)</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">integer_ceil</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError: computation of ceil of x not implemented</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">float32</span>
<span class="gp">sage: </span><span class="n">integer_ceil</span><span class="p">(</span><span class="n">float32</span><span class="p">(</span><span class="mf">5.4</span><span class="p">))</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpfr</span>
<span class="gp">sage: </span><span class="n">integer_ceil</span><span class="p">(</span><span class="n">mpfr</span><span class="p">(</span><span class="mf">5.4</span><span class="p">))</span>
<span class="go">6</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.integer_floor">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">integer_floor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.integer_floor" title="Permalink to this definition">#</a></dt>
<dd><p>Return the largest integer <span class="math notranslate nohighlight">\(\leq x\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> - an object that has a floor method or is
coercible to int</p></li>
</ul>
<p>OUTPUT: an Integer</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">integer_floor</span><span class="p">(</span><span class="mf">5.4</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">integer_floor</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="mf">5.4</span><span class="p">))</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">integer_floor</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-3</span>
<span class="gp">sage: </span><span class="n">integer_floor</span><span class="p">(</span><span class="n">RDF</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="go">-3</span>

<span class="gp">sage: </span><span class="n">integer_floor</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError: computation of floor of x not implemented</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">float32</span>
<span class="gp">sage: </span><span class="n">integer_floor</span><span class="p">(</span><span class="n">float32</span><span class="p">(</span><span class="mf">5.4</span><span class="p">))</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpfr</span>
<span class="gp">sage: </span><span class="n">integer_floor</span><span class="p">(</span><span class="n">mpfr</span><span class="p">(</span><span class="mf">5.4</span><span class="p">))</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.integer_trunc">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">integer_trunc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.integer_trunc" title="Permalink to this definition">#</a></dt>
<dd><p>Truncate to the integer closer to zero</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.arith.misc</span> <span class="kn">import</span> <span class="n">integer_trunc</span> <span class="k">as</span> <span class="n">trunc</span>
<span class="gp">sage: </span><span class="n">trunc</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">trunc</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">trunc</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">trunc</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">trunc</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">trunc</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">trunc</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(-1, -1, 0, 0, 0, 1, 1)</span>
<span class="gp">sage: </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">trunc</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">Integer</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.inverse_mod">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">inverse_mod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.inverse_mod" title="Permalink to this definition">#</a></dt>
<dd><p>The inverse of the ring element a modulo m.</p>
<p>If no special inverse_mod is defined for the elements, it tries to
coerce them into integers and perform the inversion there</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">inverse_mod</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">inverse_mod</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">inverse_mod</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Tests with numpy and mpz numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int8</span>
<span class="gp">sage: </span><span class="n">inverse_mod</span><span class="p">(</span><span class="n">int8</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">int8</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">inverse_mod</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">mpz</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.is_power_of_two">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">is_power_of_two</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.is_power_of_two" title="Permalink to this definition">#</a></dt>
<dd><p>Return whether <code class="docutils literal notranslate"><span class="pre">n</span></code> is a power of 2.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – integer</p></li>
</ul>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">is_power_of_two</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_power_of_two</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_power_of_two</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_power_of_two</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_power_of_two</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int8</span>
<span class="gp">sage: </span><span class="n">is_power_of_two</span><span class="p">(</span><span class="n">int8</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_power_of_two</span><span class="p">(</span><span class="n">int8</span><span class="p">(</span><span class="mi">24</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">is_power_of_two</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_power_of_two</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">24</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.is_prime">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">is_prime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.is_prime" title="Permalink to this definition">#</a></dt>
<dd><p>Determine whether <span class="math notranslate nohighlight">\(n\)</span> is a prime element of its parent ring.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – the object for which to determine primality</p></li>
</ul>
<p>Exceptional special cases:</p>
<ul class="simple">
<li><p>For integers, determine whether <span class="math notranslate nohighlight">\(n\)</span> is a <em>positive</em> prime.</p></li>
<li><p>For number fields except <span class="math notranslate nohighlight">\(\QQ\)</span>, determine whether <span class="math notranslate nohighlight">\(n\)</span>
is a prime element <em>of the maximal order</em>.</p></li>
</ul>
<p>ALGORITHM:</p>
<p>For integers, this function uses a provable primality test
or a strong pseudo-primality test depending on the global
<a class="reference external" href="../../../structure/sage/structure/proof/proof.html#module-sage.structure.proof.proof" title="(in Parents and Elements v10.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">arithmetic</span> <span class="pre">proof</span> <span class="pre">flag</span></code></a>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="#sage.arith.misc.is_pseudoprime" title="sage.arith.misc.is_pseudoprime"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_pseudoprime()</span></code></a></p></li>
<li><p><a class="reference internal" href="../rings/integer.html#sage.rings.integer.Integer.is_prime" title="sage.rings.integer.Integer.is_prime"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.rings.integer.Integer.is_prime()</span></code></a></p></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">is_prime</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_prime</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_prime</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_prime</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_prime</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_prime</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">2048</span> <span class="o">+</span> <span class="mi">981</span>
<span class="gp">sage: </span><span class="n">is_prime</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>    <span class="c1"># not tested - takes ~ 1min</span>
<span class="gp">sage: </span><span class="n">proof</span><span class="o">.</span><span class="n">arithmetic</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_prime</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>    <span class="c1"># instantaneous!</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">proof</span><span class="o">.</span><span class="n">arithmetic</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.is_prime_power">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">is_prime_power</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.is_prime_power" title="Permalink to this definition">#</a></dt>
<dd><p>Test whether <code class="docutils literal notranslate"><span class="pre">n</span></code> is a positive power of a prime number</p>
<p>This function simply calls the method <a class="reference internal" href="../rings/integer.html#sage.rings.integer.Integer.is_prime_power" title="sage.rings.integer.Integer.is_prime_power"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Integer.is_prime_power()</span></code></a> of Integers.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – an integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_data</span></code> – if set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, return a pair <code class="docutils literal notranslate"><span class="pre">(p,k)</span></code> such that
this integer equals <code class="docutils literal notranslate"><span class="pre">p^k</span></code> instead of <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">(self,0)</span></code> instead of
<code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">is_prime_power</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_prime_power</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_prime_power</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_prime_power</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_prime_power</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="n">get_data</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(2, 10)</span>
</pre></div>
</div>
<p>The same results can be obtained with:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="mf">389.</span><span class="n">is_prime_power</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="mf">2000.</span><span class="n">is_prime_power</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="mf">2.</span><span class="n">is_prime_power</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="mf">1024.</span><span class="n">is_prime_power</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="mf">1024.</span><span class="n">is_prime_power</span><span class="p">(</span><span class="n">get_data</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(2, 10)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.is_pseudoprime">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">is_pseudoprime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.is_pseudoprime" title="Permalink to this definition">#</a></dt>
<dd><p>Test whether <code class="docutils literal notranslate"><span class="pre">n</span></code> is a pseudo-prime</p>
<p>The result is <em>NOT</em> proven correct - <em>this is a pseudo-primality test!</em>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – an integer</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We do not consider negatives of prime numbers as prime.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">is_pseudoprime</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_pseudoprime</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_pseudoprime</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_pseudoprime</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span>
<span class="go">-1 * 2 * 3</span>
<span class="gp">sage: </span><span class="n">is_pseudoprime</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_pseudoprime</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.is_pseudoprime_power">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">is_pseudoprime_power</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.is_pseudoprime_power" title="Permalink to this definition">#</a></dt>
<dd><p>Test if <code class="docutils literal notranslate"><span class="pre">n</span></code> is a power of a pseudoprime.</p>
<p>The result is <em>NOT</em> proven correct - <em>this IS a pseudo-primality test!</em>.
Note that a prime power is a positive power of a prime number so that 1 is
not a prime power.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> - an integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_data</span></code> - (boolean) instead of a boolean return a pair <span class="math notranslate nohighlight">\((p,k)\)</span> so
that <code class="docutils literal notranslate"><span class="pre">n</span></code> equals <span class="math notranslate nohighlight">\(p^k\)</span> and <span class="math notranslate nohighlight">\(p\)</span> is a pseudoprime or <span class="math notranslate nohighlight">\((n,0)\)</span> otherwise.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">is_pseudoprime_power</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_pseudoprime_power</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_pseudoprime_power</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_pseudoprime_power</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_pseudoprime_power</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_pseudoprime_power</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_pseudoprime_power</span><span class="p">(</span><span class="mi">997</span><span class="o">^</span><span class="mi">100</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Use of the get_data keyword:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">is_pseudoprime_power</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">1024</span><span class="p">,</span> <span class="n">get_data</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(3, 1024)</span>
<span class="gp">sage: </span><span class="n">is_pseudoprime_power</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">256</span><span class="p">,</span> <span class="n">get_data</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(2, 256)</span>
<span class="gp">sage: </span><span class="n">is_pseudoprime_power</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="n">get_data</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(31, 1)</span>
<span class="gp">sage: </span><span class="n">is_pseudoprime_power</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">get_data</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(15, 0)</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int16</span>
<span class="gp">sage: </span><span class="n">is_pseudoprime_power</span><span class="p">(</span><span class="n">int16</span><span class="p">(</span><span class="mi">1024</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">is_pseudoprime_power</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">1024</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.is_square">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">is_square</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.is_square" title="Permalink to this definition">#</a></dt>
<dd><p>Return whether or not <code class="docutils literal notranslate"><span class="pre">n</span></code> is square.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">n</span></code> is a square also return the square root.
If <code class="docutils literal notranslate"><span class="pre">n</span></code> is not square, also return <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – an integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">root</span></code> – whether or not to also return a square
root (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bool</span></code> – whether or not a square</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">object</span></code> – (optional) an actual square if found,
and <code class="docutils literal notranslate"><span class="pre">None</span></code> otherwise.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">is_square</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_square</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_square</span><span class="p">(</span><span class="mf">2.2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_square</span><span class="p">(</span><span class="o">-</span><span class="mf">2.2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_square</span><span class="p">(</span><span class="n">CDF</span><span class="p">(</span><span class="o">-</span><span class="mf">2.2</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_square</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError: is_square() not implemented for</span>
<span class="go">non-constant or relational elements of Symbolic Ring</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">is_square</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">(True, 2)</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int8</span>
<span class="gp">sage: </span><span class="n">is_square</span><span class="p">(</span><span class="n">int8</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">is_square</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Tests with Polynomial:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">LaurentPolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">IwahoriHeckeAlgebra</span><span class="p">(</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span> <span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">c</span><span class="o">*</span><span class="n">d</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">d</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">is_square</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.is_squarefree">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">is_squarefree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.is_squarefree" title="Permalink to this definition">#</a></dt>
<dd><p>Test whether <code class="docutils literal notranslate"><span class="pre">n</span></code> is square free.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">is_squarefree</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_squarefree</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">is_squarefree</span><span class="p">((</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_squarefree</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">3</span><span class="p">))</span>
<span class="go">False</span>

<span class="gp">sage: </span><span class="n">O</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">O</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_squarefree</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_squarefree</span><span class="p">(</span><span class="n">O</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">O</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(-I) * (I + 1)^2</span>
</pre></div>
</div>
<p>This method fails on domains which are not Unique Factorization Domains:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">O</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">O</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_squarefree</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ArithmeticError: non-principal ideal in factorization</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int8</span>
<span class="gp">sage: </span><span class="n">is_squarefree</span><span class="p">(</span><span class="n">int8</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_squarefree</span><span class="p">(</span><span class="n">int8</span><span class="p">(</span><span class="mi">101</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">is_squarefree</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_squarefree</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">101</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.jacobi_symbol">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">jacobi_symbol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.jacobi_symbol" title="Permalink to this definition">#</a></dt>
<dd><p>The Jacobi symbol of integers a and b, where b is odd.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference internal" href="#sage.arith.misc.kronecker_symbol" title="sage.arith.misc.kronecker_symbol"><code class="xref py py-func docutils literal notranslate"><span class="pre">kronecker_symbol()</span></code></a> command extends the Jacobi
symbol to all integers b.</p>
</div>
<p>If</p>
<p><span class="math notranslate nohighlight">\(b = p_1^{e_1} * ... * p_r^{e_r}\)</span></p>
<p>then</p>
<p><span class="math notranslate nohighlight">\((a|b) = (a|p_1)^{e_1} ... (a|p_r)^{e_r}\)</span></p>
<p>where <span class="math notranslate nohighlight">\((a|p_j)\)</span> are Legendre Symbols.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code> - an integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code> - an odd integer</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">jacobi_symbol</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">777</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">jacobi_symbol</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">jacobi_symbol</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: second input must be odd, 2 is not odd</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int16</span>
<span class="gp">sage: </span><span class="n">jacobi_symbol</span><span class="p">(</span><span class="n">int16</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">int16</span><span class="p">(</span><span class="mi">777</span><span class="p">))</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">jacobi_symbol</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">mpz</span><span class="p">(</span><span class="mi">777</span><span class="p">))</span>
<span class="go">-1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.kronecker">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">kronecker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.kronecker" title="Permalink to this definition">#</a></dt>
<dd><p>The Kronecker symbol <span class="math notranslate nohighlight">\((x|y)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> – integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code> – integer</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>an integer</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">kronecker_symbol</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">21</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">kronecker_symbol</span><span class="p">(</span><span class="mi">101</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>This is also available as <a class="reference internal" href="#sage.arith.misc.kronecker" title="sage.arith.misc.kronecker"><code class="xref py py-func docutils literal notranslate"><span class="pre">kronecker()</span></code></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">kronecker</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">kronecker</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">kronecker</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">kronecker</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">kronecker</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int8</span>
<span class="gp">sage: </span><span class="n">kronecker_symbol</span><span class="p">(</span><span class="n">int8</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span><span class="n">int8</span><span class="p">(</span><span class="mi">21</span><span class="p">))</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">kronecker_symbol</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span><span class="n">mpz</span><span class="p">(</span><span class="mi">21</span><span class="p">))</span>
<span class="go">-1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.kronecker_symbol">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">kronecker_symbol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.kronecker_symbol" title="Permalink to this definition">#</a></dt>
<dd><p>The Kronecker symbol <span class="math notranslate nohighlight">\((x|y)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> – integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code> – integer</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>an integer</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">kronecker_symbol</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">21</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">kronecker_symbol</span><span class="p">(</span><span class="mi">101</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>This is also available as <a class="reference internal" href="#sage.arith.misc.kronecker" title="sage.arith.misc.kronecker"><code class="xref py py-func docutils literal notranslate"><span class="pre">kronecker()</span></code></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">kronecker</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">kronecker</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">kronecker</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">kronecker</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">kronecker</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int8</span>
<span class="gp">sage: </span><span class="n">kronecker_symbol</span><span class="p">(</span><span class="n">int8</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span><span class="n">int8</span><span class="p">(</span><span class="mi">21</span><span class="p">))</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">kronecker_symbol</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span><span class="n">mpz</span><span class="p">(</span><span class="mi">21</span><span class="p">))</span>
<span class="go">-1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.legendre_symbol">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">legendre_symbol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.legendre_symbol" title="Permalink to this definition">#</a></dt>
<dd><p>The Legendre symbol <span class="math notranslate nohighlight">\((x|p)\)</span>, for <span class="math notranslate nohighlight">\(p\)</span> prime.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference internal" href="#sage.arith.misc.kronecker_symbol" title="sage.arith.misc.kronecker_symbol"><code class="xref py py-func docutils literal notranslate"><span class="pre">kronecker_symbol()</span></code></a> command extends the Legendre
symbol to composite moduli and <span class="math notranslate nohighlight">\(p=2\)</span>.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> - integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> - an odd prime number</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">legendre_symbol</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">legendre_symbol</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">legendre_symbol</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: p must be odd</span>
<span class="gp">sage: </span><span class="n">legendre_symbol</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: p must be a prime</span>
<span class="gp">sage: </span><span class="n">kronecker_symbol</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">legendre_symbol</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="go">-1</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int8</span>
<span class="gp">sage: </span><span class="n">legendre_symbol</span><span class="p">(</span><span class="n">int8</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">int8</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">legendre_symbol</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">mpz</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">-1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.mqrr_rational_reconstruction">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">mqrr_rational_reconstruction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.mqrr_rational_reconstruction" title="Permalink to this definition">#</a></dt>
<dd><p>Maximal Quotient Rational Reconstruction.</p>
<p>For research purposes only - this is pure Python, so slow.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">u,</span> <span class="pre">m,</span> <span class="pre">T</span></code> -  integers such that <span class="math notranslate nohighlight">\(m &gt; u \ge 0\)</span>, <span class="math notranslate nohighlight">\(T &gt; 0\)</span>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>Either integers <span class="math notranslate nohighlight">\(n,d\)</span> such that <span class="math notranslate nohighlight">\(d&gt;0\)</span>, <span class="math notranslate nohighlight">\(\mathop{\mathrm{gcd}}(n,d)=1\)</span>, <span class="math notranslate nohighlight">\(n/d=u \bmod m\)</span>, and
<span class="math notranslate nohighlight">\(T \cdot d \cdot |n| &lt; m\)</span>, or <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>Reference: Monagan, Maximal Quotient Rational Reconstruction: An
Almost Optimal Algorithm for Rational Reconstruction (page 11)</p>
<p>This algorithm is probabilistic.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">mqrr_rational_reconstruction</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span><span class="mi">3100</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span>
<span class="go">(21, 1)</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int16</span>
<span class="gp">sage: </span><span class="n">mqrr_rational_reconstruction</span><span class="p">(</span><span class="n">int16</span><span class="p">(</span><span class="mi">21</span><span class="p">),</span><span class="n">int16</span><span class="p">(</span><span class="mi">3100</span><span class="p">),</span><span class="n">int16</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span>
<span class="go">(21, 1)</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">mqrr_rational_reconstruction</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">21</span><span class="p">),</span><span class="n">mpz</span><span class="p">(</span><span class="mi">3100</span><span class="p">),</span><span class="n">mpz</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span>
<span class="go">(21, 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.multinomial">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">multinomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">ks</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.multinomial" title="Permalink to this definition">#</a></dt>
<dd><p>Return the multinomial coefficient.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p>either an arbitrary number of integer arguments <span class="math notranslate nohighlight">\(k_1,\dots,k_n\)</span></p></li>
<li><p>or an iterable (e.g. a list) of integers <span class="math notranslate nohighlight">\([k_1,\dots,k_n]\)</span></p></li>
</ul>
<p>OUTPUT:</p>
<p>Return the integer:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\binom{k_1 + \cdots + k_n}{k_1, \cdots, k_n}
=\frac{\left(\sum_{i=1}^n k_i\right)!}{\prod_{i=1}^n k_i!}
= \prod_{i=1}^n \binom{\sum_{j=1}^i k_j}{k_i}\]</div>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">multinomial</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">multinomial</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">multinomial</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">multinomial</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">30</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">618970023101454657175683075</span>
<span class="gp">sage: </span><span class="n">multinomial</span><span class="p">([</span><span class="mi">2</span><span class="o">^</span><span class="mi">30</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="go">618970023101454657175683075</span>
<span class="gp">sage: </span><span class="n">multinomial</span><span class="p">(</span><span class="n">Composition</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">multinomial</span><span class="p">(</span><span class="n">Partition</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span>
<span class="go">15</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Gabriel Ebner</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.multinomial_coefficients">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">multinomial_coefficients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.multinomial_coefficients" title="Permalink to this definition">#</a></dt>
<dd><p>Return a dictionary containing pairs
<span class="math notranslate nohighlight">\(\{(k_1, k_2, ..., k_m) : C_{k, n}\}\)</span> where
<span class="math notranslate nohighlight">\(C_{k, n}\)</span> are multinomial coefficients such that
<span class="math notranslate nohighlight">\(n = k_1 + k_2 + ...+ k_m\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> - integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> - integer</p></li>
</ul>
<p>OUTPUT: dict</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">multinomial_coefficients</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="go">[((0, 5), 1), ((1, 4), 5), ((2, 3), 10), ((3, 2), 10), ((4, 1), 5), ((5, 0), 1)]</span>
</pre></div>
</div>
<p>Notice that these are the coefficients of <span class="math notranslate nohighlight">\((x+y)^5\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span><span class="o">^</span><span class="mi">5</span>
<span class="go">x^5 + 5*x^4*y + 10*x^3*y^2 + 10*x^2*y^3 + 5*x*y^4 + y^5</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">multinomial_coefficients</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="go">[((0, 0, 2), 1), ((0, 1, 1), 2), ((0, 2, 0), 1), ((1, 0, 1), 2), ((1, 1, 0), 2), ((2, 0, 0), 1)]</span>
</pre></div>
</div>
<p>ALGORITHM: The algorithm we implement for computing the multinomial
coefficients is based on the following result:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\binom{n}{k_1, \cdots, k_m} =
\frac{k_1+1}{n-k_1}\sum_{i=2}^m \binom{n}{k_1+1, \cdots, k_i-1, \cdots}\]</div>
</div>
<p>e.g.:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># random value</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)):</span>
<span class="gp">....: </span>    <span class="n">ki</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="n">ki</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="gp">....: </span>    <span class="n">ki</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
<span class="gp">....: </span>    <span class="n">s</span> <span class="o">+=</span> <span class="n">multinomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="o">*</span><span class="n">ki</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">multinomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="o">*</span><span class="n">k</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">s</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.next_prime">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">next_prime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.next_prime" title="Permalink to this definition">#</a></dt>
<dd><p>The next prime greater than the integer n. If n is prime, then this
function does not return n, but the next prime after n. If the
optional argument proof is False, this function only returns a
pseudo-prime, as defined by the PARI nextprime function. If it is
None, uses the global default (see <a class="reference external" href="../../../structure/sage/structure/proof/proof.html#module-sage.structure.proof.proof" title="(in Parents and Elements v10.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.structure.proof.proof</span></code></a>)</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> - integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> - bool or None (default: None)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">next_prime</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">next_prime</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">next_prime</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">next_prime</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">next_prime</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">5</span>
</pre></div>
</div>
<p>Notice that the next_prime(5) is not 5 but 7.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">next_prime</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">next_prime</span><span class="p">(</span><span class="mi">2004</span><span class="p">)</span>
<span class="go">2011</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.next_prime_power">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">next_prime_power</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.next_prime_power" title="Permalink to this definition">#</a></dt>
<dd><p>Return the smallest prime power greater than <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p>
<p>Note that if <code class="docutils literal notranslate"><span class="pre">n</span></code> is a prime power, then this function does not return
<code class="docutils literal notranslate"><span class="pre">n</span></code>, but the next prime power after <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p>
<p>This function just calls the method
<a class="reference internal" href="../rings/integer.html#sage.rings.integer.Integer.next_prime_power" title="sage.rings.integer.Integer.next_prime_power"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Integer.next_prime_power()</span></code></a>
of Integers.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="#sage.arith.misc.is_prime_power" title="sage.arith.misc.is_prime_power"><code class="xref py py-func docutils literal notranslate"><span class="pre">is_prime_power()</span></code></a> (and
<a class="reference internal" href="../rings/integer.html#sage.rings.integer.Integer.is_prime_power" title="sage.rings.integer.Integer.is_prime_power"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Integer.is_prime_power()</span></code></a>)</p></li>
<li><p><a class="reference internal" href="#sage.arith.misc.previous_prime_power" title="sage.arith.misc.previous_prime_power"><code class="xref py py-func docutils literal notranslate"><span class="pre">previous_prime_power()</span></code></a> (and
<a class="reference internal" href="../rings/integer.html#sage.rings.integer.Integer.next_prime_power" title="sage.rings.integer.Integer.next_prime_power"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Integer.previous_prime_power()</span></code></a>)</p></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">next_prime_power</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">next_prime_power</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">next_prime_power</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">11</span>
<span class="gp">sage: </span><span class="n">next_prime_power</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">8</span>
<span class="gp">sage: </span><span class="n">next_prime_power</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>
<span class="go">101</span>
</pre></div>
</div>
<p>The same results can be obtained with:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="mf">1.</span><span class="n">next_prime_power</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="mf">2.</span><span class="n">next_prime_power</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="mf">10.</span><span class="n">next_prime_power</span><span class="p">()</span>
<span class="go">11</span>
</pre></div>
</div>
<p>Note that <span class="math notranslate nohighlight">\(2\)</span> is the smallest prime power:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">next_prime_power</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">next_prime_power</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.next_probable_prime">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">next_probable_prime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.next_probable_prime" title="Permalink to this definition">#</a></dt>
<dd><p>Return the next probable prime after self, as determined by PARI.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> - an integer</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">next_probable_prime</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">next_probable_prime</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<span class="go">23</span>
<span class="gp">sage: </span><span class="n">next_probable_prime</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">999999999</span><span class="p">))</span>
<span class="go">1000000007</span>
<span class="gp">sage: </span><span class="n">next_probable_prime</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">768</span><span class="p">)</span>
<span class="go">1552518092300708935148979488462502555256886017116696611139052038026050952686376886330878408828646477950487730697131073206171580044114814391444287275041181139204454976020849905550265285631598444825262999193716468750892846853816058039</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.nth_prime">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">nth_prime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.nth_prime" title="Permalink to this definition">#</a></dt>
<dd><p>Return the n-th prime number (1-indexed, so that 2 is the 1st prime.)</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – a positive integer</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>the n-th prime number</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">nth_prime</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">nth_prime</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">29</span>
<span class="gp">sage: </span><span class="n">nth_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">7</span><span class="p">)</span>
<span class="go">179424673</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">nth_prime</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: nth prime meaningless for non-positive n (=0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.number_of_divisors">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">number_of_divisors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.number_of_divisors" title="Permalink to this definition">#</a></dt>
<dd><p>Return the number of divisors of the integer n.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> - a nonzero integer</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>an integer, the number of divisors of n</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">number_of_divisors</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">9</span>
<span class="gp">sage: </span><span class="n">number_of_divisors</span><span class="p">(</span><span class="o">-</span><span class="mi">720</span><span class="p">)</span>
<span class="go">30</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int8</span>
<span class="gp">sage: </span><span class="n">number_of_divisors</span><span class="p">(</span><span class="n">int8</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="go">9</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">number_of_divisors</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="go">9</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.odd_part">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">odd_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.odd_part" title="Permalink to this definition">#</a></dt>
<dd><p>The odd part of the integer <span class="math notranslate nohighlight">\(n\)</span>. This is <span class="math notranslate nohighlight">\(n / 2^v\)</span>,
where <span class="math notranslate nohighlight">\(v = \mathrm{valuation}(n,2)\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">odd_part</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">odd_part</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">odd_part</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="mi">31</span><span class="p">))</span>
<span class="go">122529844256906551386796875</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int8</span>
<span class="gp">sage: </span><span class="n">odd_part</span><span class="p">(</span><span class="n">int8</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">odd_part</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.power_mod">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">power_mod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.power_mod" title="Permalink to this definition">#</a></dt>
<dd><p>Return the <span class="math notranslate nohighlight">\(n\)</span>-th power of <span class="math notranslate nohighlight">\(a\)</span> modulo <span class="math notranslate nohighlight">\(m\)</span>, where <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(m\)</span>
are elements of a ring that implements the modulo operator <code class="docutils literal notranslate"><span class="pre">%</span></code>.</p>
<p>ALGORITHM: square-and-multiply</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">power_mod</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">388</span><span class="p">,</span><span class="mi">389</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">power_mod</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">390</span><span class="p">,</span><span class="mi">391</span><span class="p">)</span>
<span class="go">285</span>
<span class="gp">sage: </span><span class="n">power_mod</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">power_mod</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
<p>This function works for fairly general rings:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">power_mod</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="go">4*x^10</span>
<span class="gp">sage: </span><span class="n">power_mod</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="go">x^14 + x^8 + x^6 + x^3 + 962509*x^2 - 791910*x - 698281</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.previous_prime">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">previous_prime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.previous_prime" title="Permalink to this definition">#</a></dt>
<dd><p>The largest prime &lt; n. The result is provably correct. If n &lt;= 1,
this function raises a ValueError.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">previous_prime</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">previous_prime</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">previous_prime</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">previous_prime</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">previous_prime</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">previous_prime</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">previous_prime</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: no previous prime</span>
<span class="gp">sage: </span><span class="n">previous_prime</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: no previous prime</span>
<span class="gp">sage: </span><span class="n">previous_prime</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: no previous prime</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.previous_prime_power">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">previous_prime_power</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.previous_prime_power" title="Permalink to this definition">#</a></dt>
<dd><p>Return the largest prime power smaller than <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p>
<p>The result is provably correct. If <code class="docutils literal notranslate"><span class="pre">n</span></code> is smaller or equal than <code class="docutils literal notranslate"><span class="pre">2</span></code> this
function raises an error.</p>
<p>This function simply call the method
<a class="reference internal" href="../rings/integer.html#sage.rings.integer.Integer.previous_prime_power" title="sage.rings.integer.Integer.previous_prime_power"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Integer.previous_prime_power()</span></code></a>
of Integers.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="#sage.arith.misc.is_prime_power" title="sage.arith.misc.is_prime_power"><code class="xref py py-func docutils literal notranslate"><span class="pre">is_prime_power()</span></code></a> (and <a class="reference internal" href="../rings/integer.html#sage.rings.integer.Integer.is_prime_power" title="sage.rings.integer.Integer.is_prime_power"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Integer.is_prime_power()</span></code></a>)</p></li>
<li><p><a class="reference internal" href="#sage.arith.misc.next_prime_power" title="sage.arith.misc.next_prime_power"><code class="xref py py-func docutils literal notranslate"><span class="pre">next_prime_power()</span></code></a> (and <a class="reference internal" href="../rings/integer.html#sage.rings.integer.Integer.next_prime_power" title="sage.rings.integer.Integer.next_prime_power"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Integer.next_prime_power()</span></code></a>)</p></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">previous_prime_power</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">previous_prime_power</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">9</span>
<span class="gp">sage: </span><span class="n">previous_prime_power</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">previous_prime_power</span><span class="p">(</span><span class="mi">127</span><span class="p">)</span>
<span class="go">125</span>
</pre></div>
</div>
<p>The same results can be obtained with:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="mf">3.</span><span class="n">previous_prime_power</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="mf">10.</span><span class="n">previous_prime_power</span><span class="p">()</span>
<span class="go">9</span>
<span class="gp">sage: </span><span class="mf">7.</span><span class="n">previous_prime_power</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="mf">127.</span><span class="n">previous_prime_power</span><span class="p">()</span>
<span class="go">125</span>
</pre></div>
</div>
<p>Input less than or equal to <span class="math notranslate nohighlight">\(2\)</span> raises errors:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">previous_prime_power</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: no prime power less than 2</span>
<span class="gp">sage: </span><span class="n">previous_prime_power</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: no prime power less than 2</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">previous_prime_power</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">16</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">while</span> <span class="n">is_prime</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="n">n</span> <span class="o">=</span> <span class="n">previous_prime_power</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="go">251^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.prime_divisors">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">prime_divisors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.prime_divisors" title="Permalink to this definition">#</a></dt>
<dd><p>Return the list of prime divisors (up to units) of this element
of a unique factorization domain.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – any object which can be decomposed into prime factors</p></li>
</ul>
<p>OUTPUT:</p>
<p>A list of prime factors of <code class="docutils literal notranslate"><span class="pre">n</span></code>. For integers, this list is sorted
in increasing order.</p>
<p>EXAMPLES:</p>
<p>Prime divisors of positive integers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">prime_divisors</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">prime_divisors</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">[2, 5]</span>
<span class="gp">sage: </span><span class="n">prime_divisors</span><span class="p">(</span><span class="mi">2004</span><span class="p">)</span>
<span class="go">[2, 3, 167]</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">n</span></code> is negative, we do <em>not</em> include -1 among the prime
divisors, since -1 is not a prime number:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">prime_divisors</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">)</span>
<span class="go">[2, 5]</span>
</pre></div>
</div>
<p>For polynomials we get all irreducible factors:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">prime_divisors</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">12</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">[x - 1, x + 1, x^2 - x + 1, x^2 + 1, x^2 + x + 1, x^4 - x^2 + 1]</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int8</span>
<span class="gp">sage: </span><span class="n">prime_divisors</span><span class="p">(</span><span class="n">int8</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">))</span>
<span class="go">[2, 5]</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">prime_divisors</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">))</span>
<span class="go">[2, 5]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.prime_factors">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">prime_factors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.prime_factors" title="Permalink to this definition">#</a></dt>
<dd><p>Return the list of prime divisors (up to units) of this element
of a unique factorization domain.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – any object which can be decomposed into prime factors</p></li>
</ul>
<p>OUTPUT:</p>
<p>A list of prime factors of <code class="docutils literal notranslate"><span class="pre">n</span></code>. For integers, this list is sorted
in increasing order.</p>
<p>EXAMPLES:</p>
<p>Prime divisors of positive integers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">prime_divisors</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">prime_divisors</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">[2, 5]</span>
<span class="gp">sage: </span><span class="n">prime_divisors</span><span class="p">(</span><span class="mi">2004</span><span class="p">)</span>
<span class="go">[2, 3, 167]</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">n</span></code> is negative, we do <em>not</em> include -1 among the prime
divisors, since -1 is not a prime number:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">prime_divisors</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">)</span>
<span class="go">[2, 5]</span>
</pre></div>
</div>
<p>For polynomials we get all irreducible factors:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">prime_divisors</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">12</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">[x - 1, x + 1, x^2 - x + 1, x^2 + 1, x^2 + x + 1, x^4 - x^2 + 1]</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int8</span>
<span class="gp">sage: </span><span class="n">prime_divisors</span><span class="p">(</span><span class="n">int8</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">))</span>
<span class="go">[2, 5]</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">prime_divisors</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">))</span>
<span class="go">[2, 5]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.prime_powers">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">prime_powers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.prime_powers" title="Permalink to this definition">#</a></dt>
<dd><p>List of all positive primes powers between <code class="docutils literal notranslate"><span class="pre">start</span></code> and
<code class="docutils literal notranslate"><span class="pre">stop</span></code>-1, inclusive. If the second argument is omitted, returns
the prime powers up to the first argument.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">start</span></code> - an integer. If two inputs are given, a lower bound
for the returned set of prime powers. If this is the only input,
then it is an upper bound.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stop</span></code> - an integer (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>). An upper bound for the
returned set of prime powers.</p></li>
</ul>
<p>OUTPUT:</p>
<p>The set of all prime powers between <code class="docutils literal notranslate"><span class="pre">start</span></code> and <code class="docutils literal notranslate"><span class="pre">stop</span></code> or, if
only one argument is passed, the set of all prime powers between 1
and <code class="docutils literal notranslate"><span class="pre">start</span></code>. The number <span class="math notranslate nohighlight">\(n\)</span> is a prime power if <span class="math notranslate nohighlight">\(n=p^k\)</span>, where
<span class="math notranslate nohighlight">\(p\)</span> is a prime number and <span class="math notranslate nohighlight">\(k\)</span> is a positive integer. Thus, <span class="math notranslate nohighlight">\(1\)</span> is
not a prime power.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">prime_powers</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">[2, 3, 4, 5, 7, 8, 9, 11, 13, 16, 17, 19]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">prime_powers</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<span class="go">193</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">prime_range</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<span class="go">168</span>

<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">z</span> <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">95</span><span class="p">,</span><span class="mi">1234</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_prime_power</span><span class="p">(</span><span class="n">z</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">prime_powers</span><span class="p">(</span><span class="mi">95</span><span class="p">,</span><span class="mi">1234</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">194</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">194</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
<span class="go">[97, 101, 103, 107, 109, 113, 121, 125, 127, 128]</span>
<span class="gp">sage: </span><span class="n">b</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
<span class="go">[97, 101, 103, 107, 109, 113, 121, 125, 127, 128]</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">==</span> <span class="n">b</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">prime_powers</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_prime_power</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">prime_powers</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">prime_powers</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">prime_powers</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.prime_to_m_part">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">prime_to_m_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.prime_to_m_part" title="Permalink to this definition">#</a></dt>
<dd><p>Return the prime-to-<code class="docutils literal notranslate"><span class="pre">m</span></code> part of <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p>
<p>This is the largest divisor of <code class="docutils literal notranslate"><span class="pre">n</span></code> that is coprime to <code class="docutils literal notranslate"><span class="pre">m</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – Integer (nonzero)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> – Integer</p></li>
</ul>
<p>OUTPUT: Integer</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">prime_to_m_part</span><span class="p">(</span><span class="mi">240</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">15</span>
<span class="gp">sage: </span><span class="n">prime_to_m_part</span><span class="p">(</span><span class="mi">240</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">80</span>
<span class="gp">sage: </span><span class="n">prime_to_m_part</span><span class="p">(</span><span class="mi">240</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">48</span>
<span class="gp">sage: </span><span class="n">prime_to_m_part</span><span class="p">(</span><span class="mi">43434</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="go">21717</span>
</pre></div>
</div>
<p>Note that integers also have a method with the same name:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="mf">240.</span><span class="n">prime_to_m_part</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">15</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int16</span>
<span class="gp">sage: </span><span class="n">prime_to_m_part</span><span class="p">(</span><span class="n">int16</span><span class="p">(</span><span class="mi">240</span><span class="p">),</span> <span class="n">int16</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">15</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">prime_to_m_part</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">240</span><span class="p">),</span> <span class="n">mpz</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">15</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.primes">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">primes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.primes" title="Permalink to this definition">#</a></dt>
<dd><p>Return an iterator over all primes between start and stop-1,
inclusive. This is much slower than <code class="docutils literal notranslate"><span class="pre">prime_range</span></code>, but
potentially uses less memory.  As with <a class="reference internal" href="#sage.arith.misc.next_prime" title="sage.arith.misc.next_prime"><code class="xref py py-func docutils literal notranslate"><span class="pre">next_prime()</span></code></a>, the optional
argument proof controls whether the numbers returned are
guaranteed to be prime or not.</p>
<p>This command is like the Python 3 <code class="docutils literal notranslate"><span class="pre">range</span></code> command, except it only iterates
over primes. In some cases it is better to use primes than
<code class="docutils literal notranslate"><span class="pre">prime_range</span></code>, because primes does not build a list of all primes in
the range in memory all at once. However, it is potentially much
slower since it simply calls the <a class="reference internal" href="#sage.arith.misc.next_prime" title="sage.arith.misc.next_prime"><code class="xref py py-func docutils literal notranslate"><span class="pre">next_prime()</span></code></a> function
repeatedly, and <a class="reference internal" href="#sage.arith.misc.next_prime" title="sage.arith.misc.next_prime"><code class="xref py py-func docutils literal notranslate"><span class="pre">next_prime()</span></code></a> is slow.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">start</span></code> - an integer (default: 2) optional argument -
giving lower bound for the primes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stop</span></code> - an integer (or infinity) - giving upper (open) bound for the
primes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> - bool or None (default: None)  If True, the function
yields only proven primes.  If False, the function uses a
pseudo-primality test, which is much faster for really big
numbers but does not provide a proof of primality. If None,
uses the global default (see <a class="reference external" href="../../../structure/sage/structure/proof/proof.html#module-sage.structure.proof.proof" title="(in Parents and Elements v10.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.structure.proof.proof</span></code></a>)</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>an iterator over primes from start to stop-1, inclusive</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">primes</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">5</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">primes</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span>
<span class="go">[2, 3, 5, 7, 11]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">primes</span><span class="p">(</span><span class="mi">10000000000</span><span class="p">,</span> <span class="mi">10000000100</span><span class="p">))</span>
<span class="go">[10000000019, 10000000033, 10000000061, 10000000069, 10000000097]</span>
<span class="gp">sage: </span><span class="nb">max</span><span class="p">(</span><span class="n">primes</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="o">^</span><span class="mi">100</span><span class="o">+</span><span class="mi">10</span><span class="o">^</span><span class="mi">4</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="go">10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009631</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">primes</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">20</span><span class="p">,</span> <span class="n">infinity</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_prime</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="go">100000000000000001243</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.primes_first_n">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">primes_first_n</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leave_pari</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.primes_first_n" title="Permalink to this definition">#</a></dt>
<dd><p>Return the first <span class="math notranslate nohighlight">\(n\)</span> primes.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(n\)</span> - a nonnegative integer</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a list of the first <span class="math notranslate nohighlight">\(n\)</span> prime numbers.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">primes_first_n</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[2, 3, 5, 7, 11, 13, 17, 19, 23, 29]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">primes_first_n</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<span class="go">1000</span>
<span class="gp">sage: </span><span class="n">primes_first_n</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.primitive_root">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">primitive_root</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.primitive_root" title="Permalink to this definition">#</a></dt>
<dd><p>Return a positive integer that generates the multiplicative group
of integers modulo <span class="math notranslate nohighlight">\(n\)</span>, if one exists; otherwise, raise a
<code class="docutils literal notranslate"><span class="pre">ValueError</span></code>.</p>
<p>A primitive root exists if <span class="math notranslate nohighlight">\(n=4\)</span> or <span class="math notranslate nohighlight">\(n=p^k\)</span> or <span class="math notranslate nohighlight">\(n=2p^k\)</span>, where <span class="math notranslate nohighlight">\(p\)</span>
is an odd prime and <span class="math notranslate nohighlight">\(k\)</span> is a nonnegative number.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – a non-zero integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> – bool (default: True); if False, then <span class="math notranslate nohighlight">\(n\)</span> is assumed
to be a positive integer possessing a primitive root, and behavior
is undefined otherwise.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A primitive root of <span class="math notranslate nohighlight">\(n\)</span>. If <span class="math notranslate nohighlight">\(n\)</span> is prime, this is the smallest
primitive root.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">primitive_root</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">primitive_root</span><span class="p">(</span><span class="o">-</span><span class="mi">46</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">primitive_root</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="nb">print</span><span class="p">([</span><span class="n">primitive_root</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">primes</span><span class="p">(</span><span class="mi">100</span><span class="p">)])</span>
<span class="go">[1, 2, 2, 3, 2, 2, 3, 2, 5, 2, 3, 2, 6, 3, 5, 2, 2, 2, 2, 7, 5, 3, 2, 3, 5]</span>
<span class="gp">sage: </span><span class="n">primitive_root</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: no primitive root</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It takes extra work to check if <span class="math notranslate nohighlight">\(n\)</span> has a primitive root; to
avoid this, use <code class="docutils literal notranslate"><span class="pre">check=False</span></code>, which may slightly speed things
up (but could also result in undefined behavior).  For example,
the second call below is an order of magnitude faster than the
first:</p>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">10</span><span class="o">^</span><span class="mi">50</span> <span class="o">+</span> <span class="mi">151</span>   <span class="c1"># a prime</span>
<span class="gp">sage: </span><span class="n">primitive_root</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="go">11</span>
<span class="gp">sage: </span><span class="n">primitive_root</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">11</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.quadratic_residues">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">quadratic_residues</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.quadratic_residues" title="Permalink to this definition">#</a></dt>
<dd><p>Return a sorted list of all squares modulo the integer <span class="math notranslate nohighlight">\(n\)</span>
in the range <span class="math notranslate nohighlight">\(0\leq x &lt; |n|\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">quadratic_residues</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">[0, 1, 3, 4, 5, 9]</span>
<span class="gp">sage: </span><span class="n">quadratic_residues</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="n">quadratic_residues</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[0, 1]</span>
<span class="gp">sage: </span><span class="n">quadratic_residues</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="go">[0, 1, 4]</span>
<span class="gp">sage: </span><span class="n">quadratic_residues</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[0, 1, 4, 5, 6, 9]</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">quadratic_residues</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">159</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int8</span>
<span class="gp">sage: </span><span class="n">quadratic_residues</span><span class="p">(</span><span class="n">int8</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<span class="go">[0, 1, 3, 4, 5, 9]</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">quadratic_residues</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<span class="go">[0, 1, 3, 4, 5, 9]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.radical">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">radical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.radical" title="Permalink to this definition">#</a></dt>
<dd><p>Return the product of the prime divisors of n.</p>
<p>This calls <code class="docutils literal notranslate"><span class="pre">n.radical(*args,</span> <span class="pre">**kwds)</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">radical</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">3</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">5</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span>
<span class="go">30</span>
<span class="gp">sage: </span><span class="n">radical</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ArithmeticError: radical of 0 is not defined</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">radical</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">i + 1</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int8</span>
<span class="gp">sage: </span><span class="n">radical</span><span class="p">(</span><span class="n">int8</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">radical</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span>
<span class="go">10</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.random_prime">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">random_prime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lbound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.random_prime" title="Permalink to this definition">#</a></dt>
<dd><p>Return a random prime <span class="math notranslate nohighlight">\(p\)</span> between <code class="docutils literal notranslate"><span class="pre">lbound</span></code> and <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>The returned prime <span class="math notranslate nohighlight">\(p\)</span> satisfies <code class="docutils literal notranslate"><span class="pre">lbound</span></code> <span class="math notranslate nohighlight">\(\leq p \leq n\)</span>.</p>
<p>The returned prime <span class="math notranslate nohighlight">\(p\)</span> is chosen uniformly at random from the set
of prime numbers less than or equal to <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> - an integer &gt;= 2.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> - bool or None (default: None) If False, the function uses a
pseudo-primality test, which is much faster for really big numbers but
does not provide a proof of primality. If None, uses the global default
(see <a class="reference external" href="../../../structure/sage/structure/proof/proof.html#module-sage.structure.proof.proof" title="(in Parents and Elements v10.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.structure.proof.proof</span></code></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lbound</span></code> - an integer &gt;= 2, lower bound for the chosen primes</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">random_prime</span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">&lt;=</span> <span class="mi">100000</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">random_prime</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Here we generate a random prime between 100 and 200:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">random_prime</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="n">lbound</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="mi">100</span> <span class="o">&lt;=</span> <span class="n">p</span> <span class="o">&lt;=</span> <span class="mi">200</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If all we care about is finding a pseudo prime, then we can pass
in <code class="docutils literal notranslate"><span class="pre">proof=False</span></code></p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">random_prime</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">lbound</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">is_pseudoprime</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="mi">100</span> <span class="o">&lt;=</span> <span class="n">p</span> <span class="o">&lt;=</span> <span class="mi">200</span>
<span class="go">True</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Jon Hanke (2006-08-08): with standard Stein cleanup</p></li>
<li><p>Jonathan Bober (2007-03-17)</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.rational_reconstruction">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">rational_reconstruction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fast'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.rational_reconstruction" title="Permalink to this definition">#</a></dt>
<dd><p>This function tries to compute <span class="math notranslate nohighlight">\(x/y\)</span>, where <span class="math notranslate nohighlight">\(x/y\)</span> is a rational number in
lowest terms such that the reduction of <span class="math notranslate nohighlight">\(x/y\)</span> modulo <span class="math notranslate nohighlight">\(m\)</span> is equal to <span class="math notranslate nohighlight">\(a\)</span> and
the absolute values of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> are both <span class="math notranslate nohighlight">\(\le \sqrt{m/2}\)</span>. If such <span class="math notranslate nohighlight">\(x/y\)</span>
exists, that pair is unique and this function returns it. If no
such pair exists, this function raises ZeroDivisionError.</p>
<p>An efficient algorithm for computing rational reconstruction is
very similar to the extended Euclidean algorithm. For more details,
see Knuth, Vol 2, 3rd ed, pages 656-657.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code> – an integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> – a modulus</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – (default: ‘fast’)</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'fast'</span></code> - a fast implementation using direct GMP library calls
in Cython.</p></li>
</ul>
</li>
</ul>
<p>OUTPUT:</p>
<p>Numerator and denominator <span class="math notranslate nohighlight">\(n\)</span>, <span class="math notranslate nohighlight">\(d\)</span> of the unique rational number
<span class="math notranslate nohighlight">\(r=n/d\)</span>, if it exists, with <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(|d| \le \sqrt{N/2}\)</span>. Return
<span class="math notranslate nohighlight">\((0,0)\)</span> if no such number exists.</p>
<p>The algorithm for rational reconstruction is described (with a
complete nontrivial proof) on pages 656-657 of Knuth, Vol 2, 3rd
ed. as the solution to exercise 51 on page 379. See in particular
the conclusion paragraph right in the middle of page 657, which
describes the algorithm thus:</p>
<blockquote>
<div><p>This discussion proves that the problem can be solved
efficiently by applying Algorithm 4.5.2X with <span class="math notranslate nohighlight">\(u=m\)</span> and <span class="math notranslate nohighlight">\(v=a\)</span>,
but with the following replacement for step X2: If
<span class="math notranslate nohighlight">\(v3 \le \sqrt{m/2}\)</span>, the algorithm terminates. The pair
<span class="math notranslate nohighlight">\((x,y)=(|v2|,v3*\mathrm{sign}(v2))\)</span> is then the unique
solution, provided that <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> are coprime and
<span class="math notranslate nohighlight">\(x \le \sqrt{m/2}\)</span>; otherwise there is no solution. (Alg 4.5.2X is
the extended Euclidean algorithm.)</p>
</div></blockquote>
<p>Knuth remarks that this algorithm is due to Wang, Kornerup, and
Gregory from around 1983.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">119</span><span class="o">*</span><span class="n">inverse_mod</span><span class="p">(</span><span class="mi">53</span><span class="p">,</span><span class="n">m</span><span class="p">))</span><span class="o">%</span><span class="k">m</span>
<span class="go">11323</span>
<span class="gp">sage: </span><span class="n">rational_reconstruction</span><span class="p">(</span><span class="mi">11323</span><span class="p">,</span><span class="n">m</span><span class="p">)</span>
<span class="go">119/53</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">rational_reconstruction</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ArithmeticError: rational reconstruction of 400 (mod 1000) does not exist</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">rational_reconstruction</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">292393</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Integers</span><span class="p">(</span><span class="mi">292393</span><span class="p">)(</span><span class="mi">45</span><span class="o">/</span><span class="mi">97</span><span class="p">);</span> <span class="n">a</span>
<span class="go">204977</span>
<span class="gp">sage: </span><span class="n">rational_reconstruction</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">292393</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;fast&#39;</span><span class="p">)</span>
<span class="go">45/97</span>
<span class="gp">sage: </span><span class="n">rational_reconstruction</span><span class="p">(</span><span class="mi">293048</span><span class="p">,</span> <span class="mi">292393</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ArithmeticError: rational reconstruction of 655 (mod 292393) does not exist</span>
<span class="gp">sage: </span><span class="n">rational_reconstruction</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ZeroDivisionError: rational reconstruction with zero modulus</span>
<span class="gp">sage: </span><span class="n">rational_reconstruction</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;foobar&quot;</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: unknown algorithm &#39;foobar&#39;</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int32</span>
<span class="gp">sage: </span><span class="n">rational_reconstruction</span><span class="p">(</span><span class="n">int32</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">int32</span><span class="p">(</span><span class="mi">292393</span><span class="p">))</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">rational_reconstruction</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">mpz</span><span class="p">(</span><span class="mi">292393</span><span class="p">))</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.rising_factorial">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">rising_factorial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.rising_factorial" title="Permalink to this definition">#</a></dt>
<dd><p>Return the rising factorial <span class="math notranslate nohighlight">\((x)^a\)</span>.</p>
<p>The notation in the literature is a mess: often <span class="math notranslate nohighlight">\((x)^a\)</span>,
but there are many other notations: GKP: Concrete Mathematics uses
<span class="math notranslate nohighlight">\(x^{\overline{a}}\)</span>.</p>
<p>The rising factorial is also known as the Pochhammer symbol, see
Maple and Mathematica.</p>
<p>Definition: for integer <span class="math notranslate nohighlight">\(a \ge 0\)</span> we have
<span class="math notranslate nohighlight">\(x(x+1) \cdots (x+a-1)\)</span>. In all other cases we use the
GAMMA-function: <span class="math notranslate nohighlight">\(\frac {\Gamma(x+a)} {\Gamma(x)}\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> – element of a ring</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code> – a non-negative integer or</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">and</span> <span class="pre">a</span></code> – any numbers</p></li>
</ul>
<p>OUTPUT: the rising factorial</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.arith.misc.falling_factorial" title="sage.arith.misc.falling_factorial"><code class="xref py py-func docutils literal notranslate"><span class="pre">falling_factorial()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">rising_factorial</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1320</span>

<span class="gp">sage: </span><span class="n">rising_factorial</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">RR</span><span class="p">(</span><span class="s1">&#39;3.0&#39;</span><span class="p">))</span>
<span class="go">1320.00000000000</span>

<span class="gp">sage: </span><span class="n">rising_factorial</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">RR</span><span class="p">(</span><span class="s1">&#39;3.3&#39;</span><span class="p">))</span>
<span class="go">2826.38895824964</span>

<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">rising_factorial</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="p">,</span> <span class="n">I</span><span class="p">);</span> <span class="n">a</span>
<span class="go">gamma(2*I + 1)/gamma(I + 1)</span>
<span class="gp">sage: </span><span class="n">CC</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">0.266816390637832 + 0.122783354006372*I</span>

<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">rising_factorial</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span> <span class="n">a</span>
<span class="go">-10</span>

<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">rising_factorial</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">x^4 + 6*x^3 + 11*x^2 + 6*x</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Jaap Spies (2006-03-05)</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.sort_complex_numbers_for_display">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">sort_complex_numbers_for_display</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nums</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.sort_complex_numbers_for_display" title="Permalink to this definition">#</a></dt>
<dd><p>Given a list of complex numbers (or a list of tuples, where the
first element of each tuple is a complex number), we sort the list
in a “pretty” order.</p>
<p>Real numbers (with a zero imaginary part) come before complex numbers,
and are sorted. Complex numbers are sorted by their real part
unless their real parts are quite close, in which case they are
sorted by their imaginary part.</p>
<p>This is not a useful function mathematically (not least because
there is no principled way to determine whether the real components
should be treated as equal or not).  It is called by various
polynomial root-finders; its purpose is to make doctest printing
more reproducible.</p>
<p>We deliberately choose a cumbersome name for this function to
discourage use, since it is mathematically meaningless.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">import</span> <span class="nn">sage.arith.misc</span>
<span class="gp">sage: </span><span class="n">sort_c</span> <span class="o">=</span> <span class="n">sort_complex_numbers_for_display</span>
<span class="gp">sage: </span><span class="n">nums</span> <span class="o">=</span> <span class="p">[</span><span class="n">CDF</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="n">nums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CDF</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">RDF</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="o">-</span><span class="mf">3e-11</span><span class="p">,</span> <span class="mf">3e-11</span><span class="p">),</span>
<span class="gp">....: </span>                    <span class="n">RDF</span><span class="o">.</span><span class="n">random_element</span><span class="p">()))</span>
<span class="gp">....: </span>    <span class="n">nums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CDF</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">RDF</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="o">-</span><span class="mf">3e-11</span><span class="p">,</span> <span class="mf">3e-11</span><span class="p">),</span>
<span class="gp">....: </span>                    <span class="n">RDF</span><span class="o">.</span><span class="n">random_element</span><span class="p">()))</span>
<span class="gp">sage: </span><span class="n">shuffle</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">nums</span> <span class="o">=</span> <span class="n">sort_c</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)):</span>
<span class="gp">....: </span>    <span class="k">if</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span><span class="p">():</span>
<span class="gp">....: </span>        <span class="n">first_non_real</span> <span class="o">=</span> <span class="n">i</span>
<span class="gp">....: </span>        <span class="k">break</span>
<span class="gp">....: </span><span class="k">else</span><span class="p">:</span>
<span class="gp">....: </span>    <span class="n">first_non_real</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">assert</span> <span class="n">first_non_real</span> <span class="o">&gt;=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_non_real</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="k">assert</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">()</span>

<span class="gp">sage: </span><span class="k">def</span> <span class="nf">truncate</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">real</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">1e-10</span><span class="p">:</span>
<span class="gp">....: </span>        <span class="k">return</span> <span class="mi">0</span>
<span class="gp">....: </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">....: </span>        <span class="k">return</span> <span class="n">n</span><span class="o">.</span><span class="n">real</span><span class="p">()</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_non_real</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="k">assert</span> <span class="n">truncate</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">truncate</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">....: </span>    <span class="k">if</span> <span class="n">truncate</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="n">truncate</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]):</span>
<span class="gp">....: </span>        <span class="k">assert</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.squarefree_divisors">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">squarefree_divisors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.squarefree_divisors" title="Permalink to this definition">#</a></dt>
<dd><p>Return an iterator over the squarefree divisors (up to units)
of this ring element.</p>
<p>Depends on the output of the prime_divisors function.</p>
<p>Squarefree divisors of an integer are not necessarily
yielded in increasing order.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p>x – an element of any ring for which the prime_divisors
function works.</p></li>
</ul>
<p>EXAMPLES:</p>
<p>Integers with few prime divisors:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">squarefree_divisors</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="go">[1, 7]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">squarefree_divisors</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="go">[1, 2, 3, 6]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">squarefree_divisors</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
<span class="go">[1, 2, 3, 6]</span>
</pre></div>
</div>
<p>Squarefree divisors are not yielded in increasing order:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">squarefree_divisors</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>
<span class="go">[1, 2, 3, 6, 5, 10, 15, 30]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.subfactorial">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">subfactorial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.subfactorial" title="Permalink to this definition">#</a></dt>
<dd><p>Subfactorial or rencontres numbers, or derangements: number of
permutations of <span class="math notranslate nohighlight">\(n\)</span> elements with no fixed points.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> - non negative integer</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">integer</span></code> - function value</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">subfactorial</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">subfactorial</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">subfactorial</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="go">14833</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int8</span>
<span class="gp">sage: </span><span class="n">subfactorial</span><span class="p">(</span><span class="n">int8</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="go">14833</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">subfactorial</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="go">14833</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Jaap Spies (2007-01-23)</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.sum_of_k_squares">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">sum_of_k_squares</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.sum_of_k_squares" title="Permalink to this definition">#</a></dt>
<dd><p>Write the integer <span class="math notranslate nohighlight">\(n\)</span> as a sum of <span class="math notranslate nohighlight">\(k\)</span> integer squares if possible;
otherwise raise a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">k</span></code> – a non-negative integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – an integer</p></li>
</ul>
<p>OUTPUT: a tuple <span class="math notranslate nohighlight">\((x_1, ..., x_k)\)</span> of non-negative integers such that
their squares sum to <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sum_of_k_squares</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9634</span><span class="p">)</span>
<span class="go">(15, 97)</span>
<span class="gp">sage: </span><span class="n">sum_of_k_squares</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9634</span><span class="p">)</span>
<span class="go">(0, 15, 97)</span>
<span class="gp">sage: </span><span class="n">sum_of_k_squares</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9634</span><span class="p">)</span>
<span class="go">(1, 2, 5, 98)</span>
<span class="gp">sage: </span><span class="n">sum_of_k_squares</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">9634</span><span class="p">)</span>
<span class="go">(0, 1, 2, 5, 98)</span>
<span class="gp">sage: </span><span class="n">sum_of_k_squares</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">11</span><span class="o">^</span><span class="mi">1111</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(19215400822645944253860920437586326284, 37204645194585992174252915693267578306, 3473654819477394665857484221256136567800161086815834297092488779216863122, 5860191799617673633547572610351797996721850737768032876360978911074629287841061578270832330322236796556721252602860754789786937515870682024273948, 20457423294558182494001919812379023992538802203730791019728543439765347851316366537094696896669915675685581905102118246887673397020172285247862426612188418787649371716686651256443143210952163970564228423098202682066311189439731080552623884051737264415984619097656479060977602722566383385989, 311628095411678159849237738619458396497534696043580912225334269371611836910345930320700816649653412141574887113710604828156159177769285115652741014638785285820578943010943846225597311231847997461959204894255074229895666356909071243390280307709880906261008237873840245959883405303580405277298513108957483306488193844321589356441983980532251051786704380984788999660195252373574924026139168936921591652831237741973242604363696352878914129671292072201700073286987126265965322808664802662993006926302359371379531571194266134916767573373504566621665949840469229781956838744551367172353)</span>
<span class="gp">sage: </span><span class="n">sum_of_k_squares</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">(0, 0, 0, 0, 0, 0, 0)</span>
<span class="gp">sage: </span><span class="n">sum_of_k_squares</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">999999</span><span class="p">)</span>
<span class="go">(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 3, 7, 44, 999)</span>
<span class="gp">sage: </span><span class="n">sum_of_k_squares</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="go">(3,)</span>
<span class="gp">sage: </span><span class="n">sum_of_k_squares</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: 10 is not a sum of 1 square</span>
<span class="gp">sage: </span><span class="n">sum_of_k_squares</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: -10 is not a sum of 1 square</span>
<span class="gp">sage: </span><span class="n">sum_of_k_squares</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: 9 is not a sum of 0 squares</span>
<span class="gp">sage: </span><span class="n">sum_of_k_squares</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">()</span>
<span class="gp">sage: </span><span class="n">sum_of_k_squares</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: -1 is not a sum of 7 squares</span>
<span class="gp">sage: </span><span class="n">sum_of_k_squares</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: k = -1 must be non-negative</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int16</span>
<span class="gp">sage: </span><span class="n">sum_of_k_squares</span><span class="p">(</span><span class="n">int16</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">int16</span><span class="p">(</span><span class="mi">9634</span><span class="p">))</span>
<span class="go">(15, 97)</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">sum_of_k_squares</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">mpz</span><span class="p">(</span><span class="mi">9634</span><span class="p">))</span>
<span class="go">(15, 97)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.three_squares">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">three_squares</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.three_squares" title="Permalink to this definition">#</a></dt>
<dd><p>Write the integer <span class="math notranslate nohighlight">\(n\)</span> as a sum of three integer squares if possible;
otherwise raise a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – an integer</p></li>
</ul>
<p>OUTPUT: a tuple <span class="math notranslate nohighlight">\((a,b,c)\)</span> of non-negative integers such that
<span class="math notranslate nohighlight">\(n = a^2 + b^2 + c^2\)</span> with <span class="math notranslate nohighlight">\(a &lt;= b &lt;= c\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">three_squares</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span>
<span class="go">(1, 8, 18)</span>
<span class="gp">sage: </span><span class="n">three_squares</span><span class="p">(</span><span class="mi">946</span><span class="p">)</span>
<span class="go">(9, 9, 28)</span>
<span class="gp">sage: </span><span class="n">three_squares</span><span class="p">(</span><span class="mi">2986</span><span class="p">)</span>
<span class="go">(3, 24, 49)</span>
<span class="gp">sage: </span><span class="n">three_squares</span><span class="p">(</span><span class="mi">7</span><span class="o">^</span><span class="mi">100</span><span class="p">)</span>
<span class="go">(0, 0, 1798465042647412146620280340569649349251249)</span>
<span class="gp">sage: </span><span class="n">three_squares</span><span class="p">(</span><span class="mi">11</span><span class="o">^</span><span class="mi">111</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(616274160655975340150706442680, 901582938385735143295060746161, 6270382387635744140394001363065311967964099981788593947233)</span>
<span class="gp">sage: </span><span class="n">three_squares</span><span class="p">(</span><span class="mi">7</span> <span class="o">*</span> <span class="mi">2</span><span class="o">^</span><span class="mi">41</span><span class="p">)</span>
<span class="go">(1048576, 2097152, 3145728)</span>
<span class="gp">sage: </span><span class="n">three_squares</span><span class="p">(</span><span class="mi">7</span> <span class="o">*</span> <span class="mi">2</span><span class="o">^</span><span class="mi">42</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: 30786325577728 is not a sum of 3 squares</span>
<span class="gp">sage: </span><span class="n">three_squares</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(0, 0, 0)</span>
<span class="gp">sage: </span><span class="n">three_squares</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: -1 is not a sum of 3 squares</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>See <a class="reference external" href="https://schorn.ch/lagrange.html">https://schorn.ch/lagrange.html</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.trial_division">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">trial_division</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.trial_division" title="Permalink to this definition">#</a></dt>
<dd><p>Return the smallest prime divisor &lt;= bound of the positive integer
n, or n if there is no such prime. If the optional argument bound
is omitted, then bound &lt;= n.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> - a positive integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bound</span></code> - (optional) a positive integer</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">int</span></code> - a prime p=bound that divides n, or n if
there is no such prime.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">trial_division</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">trial_division</span><span class="p">(</span><span class="mi">91</span><span class="p">)</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">trial_division</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">11</span>
<span class="gp">sage: </span><span class="n">trial_division</span><span class="p">(</span><span class="mi">387833</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="go">387833</span>
<span class="gp">sage: </span><span class="c1"># 300 is not big enough to split off a</span>
<span class="gp">sage: </span><span class="c1"># factor, but 400 is.</span>
<span class="gp">sage: </span><span class="n">trial_division</span><span class="p">(</span><span class="mi">387833</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
<span class="go">389</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int8</span>
<span class="gp">sage: </span><span class="n">trial_division</span><span class="p">(</span><span class="n">int8</span><span class="p">(</span><span class="mi">91</span><span class="p">))</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">trial_division</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">91</span><span class="p">))</span>
<span class="go">7</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.two_squares">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">two_squares</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.two_squares" title="Permalink to this definition">#</a></dt>
<dd><p>Write the integer <span class="math notranslate nohighlight">\(n\)</span> as a sum of two integer squares if possible;
otherwise raise a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – an integer</p></li>
</ul>
<p>OUTPUT: a tuple <span class="math notranslate nohighlight">\((a,b)\)</span> of non-negative integers such that
<span class="math notranslate nohighlight">\(n = a^2 + b^2\)</span> with <span class="math notranslate nohighlight">\(a &lt;= b\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">two_squares</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span>
<span class="go">(10, 17)</span>
<span class="gp">sage: </span><span class="n">two_squares</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: 21 is not a sum of 2 squares</span>
<span class="gp">sage: </span><span class="n">two_squares</span><span class="p">(</span><span class="mi">21</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(0, 21)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">two_squares</span><span class="p">(</span><span class="mi">100000000000000000129</span><span class="p">);</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span>
<span class="go">(4418521500, 8970878873)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span>
<span class="go">100000000000000000129</span>
<span class="gp">sage: </span><span class="n">two_squares</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">222</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(253801659504708621991421712450521, 2583712713213354898490304645018692)</span>
<span class="gp">sage: </span><span class="n">two_squares</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(0, 0)</span>
<span class="gp">sage: </span><span class="n">two_squares</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: -1 is not a sum of 2 squares</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>See <a class="reference external" href="https://schorn.ch/lagrange.html">https://schorn.ch/lagrange.html</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.valuation">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">valuation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.valuation" title="Permalink to this definition">#</a></dt>
<dd><p>Return the valuation of <code class="docutils literal notranslate"><span class="pre">m</span></code>.</p>
<p>This function simply calls the m.valuation() method.
See the documentation of m.valuation() for a more precise description.</p>
<p>Note that the use of this functions is discouraged as it is better to use
m.valuation() directly.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is not always a valuation in the mathematical sense.
For more information see:
sage.rings.finite_rings.integer_mod.IntegerMod_int.valuation</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">valuation</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">9</span>
<span class="gp">sage: </span><span class="n">valuation</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">valuation</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">-2</span>
</pre></div>
</div>
<p>Valuation of 0 is defined, but valuation with respect to 0 is not:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">valuation</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">valuation</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: You can only compute the valuation with respect to a integer larger than 1.</span>
</pre></div>
</div>
<p>Here are some other examples:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">valuation</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">valuation</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">valuation</span><span class="p">(</span><span class="mi">243</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">valuation</span><span class="p">(</span><span class="mi">243</span><span class="o">*</span><span class="mi">10007</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">valuation</span><span class="p">(</span><span class="mi">243</span><span class="o">*</span><span class="mi">10007</span><span class="p">,</span><span class="mi">10007</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">valuation</span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[[</span><span class="s1">&#39;x&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">valuation</span><span class="p">((</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">4</span><span class="p">))</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">valuation</span><span class="p">(</span><span class="mi">4</span><span class="n">r</span><span class="p">,</span><span class="mi">2</span><span class="n">r</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">valuation</span><span class="p">(</span><span class="mi">1</span><span class="n">r</span><span class="p">,</span><span class="mi">1</span><span class="n">r</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: You can only compute the valuation with respect to a integer larger than 1.</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int16</span>
<span class="gp">sage: </span><span class="n">valuation</span><span class="p">(</span><span class="n">int16</span><span class="p">(</span><span class="mi">512</span><span class="p">),</span> <span class="n">int16</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">9</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">valuation</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">512</span><span class="p">),</span> <span class="n">mpz</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">9</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.xgcd">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">xgcd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.xgcd" title="Permalink to this definition">#</a></dt>
<dd><p>Return a triple <code class="docutils literal notranslate"><span class="pre">(g,s,t)</span></code> such that <span class="math notranslate nohighlight">\(g = s\cdot a+t\cdot b = \gcd(a,b)\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>One exception is if <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are not in a principal ideal domain (see
<a class="reference external" href="https://en.wikipedia.org/wiki/Principal_ideal_domain">Wikipedia article Principal_ideal_domain</a>), e.g., they are both polynomials
over the integers. Then this function can’t in general return <code class="docutils literal notranslate"><span class="pre">(g,s,t)</span></code>
as above, since they need not exist.  Instead, over the integers, we
first multiply <span class="math notranslate nohighlight">\(g\)</span> by a divisor of the resultant of <span class="math notranslate nohighlight">\(a/g\)</span> and <span class="math notranslate nohighlight">\(b/g\)</span>, up
to sign.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a,</span> <span class="pre">b</span></code> - integers or more generally, element of a ring for which the
xgcd make sense (e.g. a field or univariate polynomials).</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">g,</span> <span class="pre">s,</span> <span class="pre">t</span></code> - such that <span class="math notranslate nohighlight">\(g = s\cdot a + t\cdot b\)</span></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is no guarantee that the returned cofactors (s and t) are
minimal.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">xgcd</span><span class="p">(</span><span class="mi">56</span><span class="p">,</span> <span class="mi">44</span><span class="p">)</span>
<span class="go">(4, 4, -5)</span>
<span class="gp">sage: </span><span class="mi">4</span><span class="o">*</span><span class="mi">56</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="mi">44</span>
<span class="go">4</span>

<span class="gp">sage: </span><span class="n">g</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">xgcd</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="o">/</span><span class="mi">1</span><span class="p">);</span> <span class="n">g</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span>
<span class="go">(1, 3, -2)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">g</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">xgcd</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">(x - 1, 1, -x)</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">g</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="n">g</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(1, 1/3*g, 0)</span>

<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()[]</span>
<span class="gp">sage: </span><span class="n">xgcd</span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>
<span class="go">(1, a^2/b^2, ((-a)/b^2)*y + 1/b)</span>
<span class="gp">sage: </span><span class="n">xgcd</span><span class="p">((</span><span class="n">b</span><span class="o">+</span><span class="n">g</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">g</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>
<span class="go">(1, (a^2 + (2*g)*a + 3)/(b^3 + g*b^2), ((-a + (-g))/b^2)*y + 1/b)</span>
</pre></div>
</div>
<p>Here is an example of a xgcd for two polynomials over the integers, where the linear
combination is not the gcd but the gcd multiplied by the resultant:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">gcd</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x</span>
<span class="gp">sage: </span><span class="n">xgcd</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(2*x, -1, 2)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">resultant</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Tests with numpy and gmpy2 types:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">int8</span>
<span class="gp">sage: </span><span class="n">xgcd</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">int8</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="go">(4, 1, 0)</span>
<span class="gp">sage: </span><span class="n">xgcd</span><span class="p">(</span><span class="n">int8</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">int8</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="go">(4, 1, 0)</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">gmpy2</span> <span class="kn">import</span> <span class="n">mpz</span>
<span class="gp">sage: </span><span class="n">xgcd</span><span class="p">(</span><span class="n">mpz</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">mpz</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="go">(4, 1, 0)</span>
<span class="gp">sage: </span><span class="n">xgcd</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">mpz</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="go">(4, 1, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.xkcd">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">xkcd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.xkcd" title="Permalink to this definition">#</a></dt>
<dd><p>This function is similar to the xgcd function, but behaves
in a completely different way.</p>
<p>See <a class="reference external" href="https://xkcd.com/json.html">https://xkcd.com/json.html</a> for more details.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – an integer (optional)</p></li>
</ul>
<p>OUTPUT: a fragment of HTML</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">xkcd</span><span class="p">(</span><span class="mi">353</span><span class="p">)</span>  <span class="c1"># optional - internet</span>
<span class="go">&lt;h1&gt;Python&lt;/h1&gt;&lt;img src=&quot;https://imgs.xkcd.com/comics/python.png&quot; title=&quot;I wrote 20 short programs in Python yesterday.  It was wonderful.  Perl, I&#39;m leaving you.&quot;&gt;&lt;div&gt;Source: &lt;a href=&quot;http://xkcd.com/353&quot; target=&quot;_blank&quot;&gt;http://xkcd.com/353&lt;/a&gt;&lt;/div&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.arith.misc.xlcm">
<span class="sig-prename descclassname"><span class="pre">sage.arith.misc.</span></span><span class="sig-name descname"><span class="pre">xlcm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.arith.misc.xlcm" title="Permalink to this definition">#</a></dt>
<dd><p>Extended lcm function: given two positive integers <span class="math notranslate nohighlight">\(m,n\)</span>, returns
a triple <span class="math notranslate nohighlight">\((l,m_1,n_1)\)</span> such that <span class="math notranslate nohighlight">\(l=\mathop{\mathrm{lcm}}(m,n)=m_1
\cdot n_1\)</span> where <span class="math notranslate nohighlight">\(m_1|m\)</span>, <span class="math notranslate nohighlight">\(n_1|n\)</span> and <span class="math notranslate nohighlight">\(\gcd(m_1,n_1)=1\)</span>, all with no
factorization.</p>
<p>Used to construct an element of order <span class="math notranslate nohighlight">\(l\)</span> from elements of orders <span class="math notranslate nohighlight">\(m,n\)</span>
in any group: see sage/groups/generic.py for examples.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">xlcm</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span><span class="mi">36</span><span class="p">)</span>
<span class="go">(360, 40, 9)</span>
</pre></div>
</div>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../rings/rational_field.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Field <span class="math notranslate nohighlight">\(\QQ\)</span> of Rational Numbers</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="multi_modular.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Utility classes for multi-modular algorithms</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2023, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Miscellaneous arithmetic functions</a><ul>
<li><a class="reference internal" href="#sage.arith.misc.CRT"><code class="docutils literal notranslate"><span class="pre">CRT()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.CRT_basis"><code class="docutils literal notranslate"><span class="pre">CRT_basis()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.CRT_list"><code class="docutils literal notranslate"><span class="pre">CRT_list()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.CRT_vectors"><code class="docutils literal notranslate"><span class="pre">CRT_vectors()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.Euler_Phi"><code class="docutils literal notranslate"><span class="pre">Euler_Phi</span></code></a><ul>
<li><a class="reference internal" href="#sage.arith.misc.Euler_Phi.plot"><code class="docutils literal notranslate"><span class="pre">plot()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.arith.misc.GCD"><code class="docutils literal notranslate"><span class="pre">GCD()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.Moebius"><code class="docutils literal notranslate"><span class="pre">Moebius</span></code></a><ul>
<li><a class="reference internal" href="#sage.arith.misc.Moebius.plot"><code class="docutils literal notranslate"><span class="pre">plot()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.Moebius.range"><code class="docutils literal notranslate"><span class="pre">range()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.arith.misc.Sigma"><code class="docutils literal notranslate"><span class="pre">Sigma</span></code></a><ul>
<li><a class="reference internal" href="#sage.arith.misc.Sigma.plot"><code class="docutils literal notranslate"><span class="pre">plot()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.arith.misc.XGCD"><code class="docutils literal notranslate"><span class="pre">XGCD()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.algdep"><code class="docutils literal notranslate"><span class="pre">algdep()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.algebraic_dependency"><code class="docutils literal notranslate"><span class="pre">algebraic_dependency()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.bernoulli"><code class="docutils literal notranslate"><span class="pre">bernoulli()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.binomial"><code class="docutils literal notranslate"><span class="pre">binomial()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.binomial_coefficients"><code class="docutils literal notranslate"><span class="pre">binomial_coefficients()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.carmichael_lambda"><code class="docutils literal notranslate"><span class="pre">carmichael_lambda()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.continuant"><code class="docutils literal notranslate"><span class="pre">continuant()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.crt"><code class="docutils literal notranslate"><span class="pre">crt()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.dedekind_psi"><code class="docutils literal notranslate"><span class="pre">dedekind_psi()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.dedekind_sum"><code class="docutils literal notranslate"><span class="pre">dedekind_sum()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.differences"><code class="docutils literal notranslate"><span class="pre">differences()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.divisors"><code class="docutils literal notranslate"><span class="pre">divisors()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.eratosthenes"><code class="docutils literal notranslate"><span class="pre">eratosthenes()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.factor"><code class="docutils literal notranslate"><span class="pre">factor()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.factorial"><code class="docutils literal notranslate"><span class="pre">factorial()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.falling_factorial"><code class="docutils literal notranslate"><span class="pre">falling_factorial()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.four_squares"><code class="docutils literal notranslate"><span class="pre">four_squares()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.fundamental_discriminant"><code class="docutils literal notranslate"><span class="pre">fundamental_discriminant()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.gauss_sum"><code class="docutils literal notranslate"><span class="pre">gauss_sum()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.gcd"><code class="docutils literal notranslate"><span class="pre">gcd()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.get_gcd"><code class="docutils literal notranslate"><span class="pre">get_gcd()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.get_inverse_mod"><code class="docutils literal notranslate"><span class="pre">get_inverse_mod()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.hilbert_conductor"><code class="docutils literal notranslate"><span class="pre">hilbert_conductor()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.hilbert_conductor_inverse"><code class="docutils literal notranslate"><span class="pre">hilbert_conductor_inverse()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.hilbert_symbol"><code class="docutils literal notranslate"><span class="pre">hilbert_symbol()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.integer_ceil"><code class="docutils literal notranslate"><span class="pre">integer_ceil()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.integer_floor"><code class="docutils literal notranslate"><span class="pre">integer_floor()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.integer_trunc"><code class="docutils literal notranslate"><span class="pre">integer_trunc()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.inverse_mod"><code class="docutils literal notranslate"><span class="pre">inverse_mod()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.is_power_of_two"><code class="docutils literal notranslate"><span class="pre">is_power_of_two()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.is_prime"><code class="docutils literal notranslate"><span class="pre">is_prime()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.is_prime_power"><code class="docutils literal notranslate"><span class="pre">is_prime_power()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.is_pseudoprime"><code class="docutils literal notranslate"><span class="pre">is_pseudoprime()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.is_pseudoprime_power"><code class="docutils literal notranslate"><span class="pre">is_pseudoprime_power()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.is_square"><code class="docutils literal notranslate"><span class="pre">is_square()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.is_squarefree"><code class="docutils literal notranslate"><span class="pre">is_squarefree()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.jacobi_symbol"><code class="docutils literal notranslate"><span class="pre">jacobi_symbol()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.kronecker"><code class="docutils literal notranslate"><span class="pre">kronecker()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.kronecker_symbol"><code class="docutils literal notranslate"><span class="pre">kronecker_symbol()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.legendre_symbol"><code class="docutils literal notranslate"><span class="pre">legendre_symbol()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.mqrr_rational_reconstruction"><code class="docutils literal notranslate"><span class="pre">mqrr_rational_reconstruction()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.multinomial"><code class="docutils literal notranslate"><span class="pre">multinomial()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.multinomial_coefficients"><code class="docutils literal notranslate"><span class="pre">multinomial_coefficients()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.next_prime"><code class="docutils literal notranslate"><span class="pre">next_prime()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.next_prime_power"><code class="docutils literal notranslate"><span class="pre">next_prime_power()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.next_probable_prime"><code class="docutils literal notranslate"><span class="pre">next_probable_prime()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.nth_prime"><code class="docutils literal notranslate"><span class="pre">nth_prime()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.number_of_divisors"><code class="docutils literal notranslate"><span class="pre">number_of_divisors()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.odd_part"><code class="docutils literal notranslate"><span class="pre">odd_part()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.power_mod"><code class="docutils literal notranslate"><span class="pre">power_mod()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.previous_prime"><code class="docutils literal notranslate"><span class="pre">previous_prime()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.previous_prime_power"><code class="docutils literal notranslate"><span class="pre">previous_prime_power()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.prime_divisors"><code class="docutils literal notranslate"><span class="pre">prime_divisors()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.prime_factors"><code class="docutils literal notranslate"><span class="pre">prime_factors()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.prime_powers"><code class="docutils literal notranslate"><span class="pre">prime_powers()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.prime_to_m_part"><code class="docutils literal notranslate"><span class="pre">prime_to_m_part()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.primes"><code class="docutils literal notranslate"><span class="pre">primes()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.primes_first_n"><code class="docutils literal notranslate"><span class="pre">primes_first_n()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.primitive_root"><code class="docutils literal notranslate"><span class="pre">primitive_root()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.quadratic_residues"><code class="docutils literal notranslate"><span class="pre">quadratic_residues()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.radical"><code class="docutils literal notranslate"><span class="pre">radical()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.random_prime"><code class="docutils literal notranslate"><span class="pre">random_prime()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.rational_reconstruction"><code class="docutils literal notranslate"><span class="pre">rational_reconstruction()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.rising_factorial"><code class="docutils literal notranslate"><span class="pre">rising_factorial()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.sort_complex_numbers_for_display"><code class="docutils literal notranslate"><span class="pre">sort_complex_numbers_for_display()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.squarefree_divisors"><code class="docutils literal notranslate"><span class="pre">squarefree_divisors()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.subfactorial"><code class="docutils literal notranslate"><span class="pre">subfactorial()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.sum_of_k_squares"><code class="docutils literal notranslate"><span class="pre">sum_of_k_squares()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.three_squares"><code class="docutils literal notranslate"><span class="pre">three_squares()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.trial_division"><code class="docutils literal notranslate"><span class="pre">trial_division()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.two_squares"><code class="docutils literal notranslate"><span class="pre">two_squares()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.valuation"><code class="docutils literal notranslate"><span class="pre">valuation()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.xgcd"><code class="docutils literal notranslate"><span class="pre">xgcd()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.xkcd"><code class="docutils literal notranslate"><span class="pre">xkcd()</span></code></a></li>
<li><a class="reference internal" href="#sage.arith.misc.xlcm"><code class="docutils literal notranslate"><span class="pre">xlcm()</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/scripts/furo.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="../../../_static/mathjax/tex-chtml.js"></script>
    </body>
</html>