<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="Elements of Quaternion Algebras" href="quaternion_algebra_element.html" /><link rel="prev" title="Quaternion Algebras" href="../../../index.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>Quaternion Algebras - Quaternion Algebras</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-furo.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Quaternion Algebras</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 10.0 Reference Manual</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../../index.html">Home - Quaternion Algebras</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Quaternion Algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="quaternion_algebra_element.html">Elements of Quaternion Algebras</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="quaternion-algebras">
<span id="sage-algebras-quatalg-quaternion-algebra"></span><h1>Quaternion Algebras<a class="headerlink" href="#quaternion-algebras" title="Permalink to this heading">#</a></h1>
<span class="target" id="module-sage.algebras.quatalg.quaternion_algebra"></span><p>AUTHORS:</p>
<ul class="simple">
<li><p>Jon Bobber (2009): rewrite</p></li>
<li><p>William Stein (2009): rewrite</p></li>
<li><p>Julian Rueth (2014-03-02): use UniqueFactory for caching</p></li>
<li><p>Peter Bruin (2021): do not require the base ring to be a field</p></li>
</ul>
<p>This code is partly based on Sage code by David Kohel from 2005.</p>
<dl class="py class">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebraFactory">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.algebras.quatalg.quaternion_algebra.</span></span><span class="sig-name descname"><span class="pre">QuaternionAlgebraFactory</span></span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebraFactory" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/factory.html#sage.structure.factory.UniqueFactory" title="(in Parents and Elements v10.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniqueFactory</span></code></a></p>
<p>Construct a quaternion algebra.</p>
<p>INPUT:</p>
<p>There are three input formats:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">QuaternionAlgebra(a,</span> <span class="pre">b)</span></code>, where <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> can be coerced to
units in a common field <span class="math notranslate nohighlight">\(K\)</span> of characteristic different from 2.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">QuaternionAlgebra(K,</span> <span class="pre">a,</span> <span class="pre">b)</span></code>, where <span class="math notranslate nohighlight">\(K\)</span> is a ring in which 2
is a unit and <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are units of <span class="math notranslate nohighlight">\(K\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">QuaternionAlgebra(D)</span></code>, where <span class="math notranslate nohighlight">\(D \ge 1\)</span> is a squarefree
integer.  This constructs a quaternion algebra of discriminant
<span class="math notranslate nohighlight">\(D\)</span> over <span class="math notranslate nohighlight">\(K = \QQ\)</span>.  Suitable nonzero rational numbers <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>
as above are deduced from <span class="math notranslate nohighlight">\(D\)</span>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>The quaternion algebra <span class="math notranslate nohighlight">\((a, b)_K\)</span> over <span class="math notranslate nohighlight">\(K\)</span> generated by <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(j\)</span>
subject to <span class="math notranslate nohighlight">\(i^2 = a\)</span>, <span class="math notranslate nohighlight">\(j^2 = b\)</span>, and <span class="math notranslate nohighlight">\(ji = -ij\)</span>.</p>
<p>EXAMPLES:</p>
<p><code class="docutils literal notranslate"><span class="pre">QuaternionAlgebra(a,</span> <span class="pre">b)</span></code> – return the quaternion algebra
<span class="math notranslate nohighlight">\((a, b)_K\)</span>, where the base ring <span class="math notranslate nohighlight">\(K\)</span> is a suitably chosen field
containing <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Quaternion Algebra (-2, -3) with base ring Rational Field</span>
<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">2</span><span class="p">),</span> <span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">Quaternion Algebra (2, 3) with base ring Finite Field of size 5</span>
<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">Quaternion Algebra (2, 3) with base ring Finite Field of size 5</span>
<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)](</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Quaternion Algebra (-1, -5) with base ring Number Field in sqrt2 with defining polynomial x^2 - 2 with sqrt2 = 1.414213562373095?</span>
<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">))</span>
<span class="go">Quaternion Algebra (I, sqrt(-3)) with base ring Symbolic Ring</span>
<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">1</span><span class="n">r</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Quaternion Algebra (1, 1) with base ring Rational Field</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="go">Quaternion Algebra (-1, t) with base ring Fraction Field of Univariate Polynomial Ring in t over Integer Ring</span>
</pre></div>
</div>
<p>Python ints and floats may be passed to the
<code class="docutils literal notranslate"><span class="pre">QuaternionAlgebra(a,</span> <span class="pre">b)</span></code> constructor, as may all pairs of
nonzero elements of a domain not of characteristic 2.</p>
<p>The following tests address the issues raised in <a class="reference external" href="https://github.com/sagemath/sage/issues/10601">github issue #10601</a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">1</span><span class="n">r</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Quaternion Algebra (1, 1) with base ring Rational Field</span>
<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">1.0</span><span class="n">r</span><span class="p">)</span>
<span class="go">Quaternion Algebra (1.00000000000000, 1.00000000000000) with base ring Real Field with 53 bits of precision</span>
<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: defining elements of quaternion algebra (0, 0) are not invertible in Rational Field</span>
<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">)(</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: 2 is not invertible in Finite Field of size 2</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">PermutationGroupElement</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: a and b must be elements of a ring with characteristic not 2</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">QuaternionAlgebra(K,</span> <span class="pre">a,</span> <span class="pre">b)</span></code> – return the quaternion algebra
defined by <span class="math notranslate nohighlight">\((a, b)\)</span> over the ring <span class="math notranslate nohighlight">\(K\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">21</span><span class="p">)</span>
<span class="go">Quaternion Algebra (-7, -21) with base ring Rational Field</span>
<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)],</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Quaternion Algebra (-2, -3) with base ring Number Field in sqrt2 with defining polynomial x^2 - 2 with sqrt2 = 1.414213562373095?</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">QuaternionAlgebra(D)</span></code> – <span class="math notranslate nohighlight">\(D\)</span> is a squarefree integer; return a
rational quaternion algebra of discriminant <span class="math notranslate nohighlight">\(D\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Quaternion Algebra (-1, 1) with base ring Rational Field</span>
<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Quaternion Algebra (-1, -1) with base ring Rational Field</span>
<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">Quaternion Algebra (-1, -7) with base ring Rational Field</span>
<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="mi">7</span><span class="p">)</span>
<span class="go">Quaternion Algebra (-22, 210) with base ring Rational Field</span>
</pre></div>
</div>
<p>If the coefficients <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> in the definition of the quaternion
algebra are not integral, then a slower generic type is used for
arithmetic:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="mf">.0</span><span class="p">)</span>
<span class="go">&lt;... &#39;sage.algebras.quatalg.quaternion_algebra_element.QuaternionAlgebraElement_rational_field&#39;&gt;</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="mf">.0</span><span class="p">)</span>
<span class="go">&lt;... &#39;sage.algebras.quatalg.quaternion_algebra_element.QuaternionAlgebraElement_generic&#39;&gt;</span>
</pre></div>
</div>
<p>Make sure caching is sane:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> <span class="n">A</span>
<span class="go">Quaternion Algebra (2, 3) with base ring Rational Field</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">2</span><span class="p">),</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">3</span><span class="p">));</span> <span class="n">B</span>
<span class="go">Quaternion Algebra (2, 3) with base ring Finite Field of size 5</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="ow">is</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="ow">is</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">2</span><span class="p">),</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">Q</span>
<span class="go">Quaternion Algebra (-1, -1) with base ring Rational Field</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="ow">is</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="ow">is</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.&lt;</span><span class="n">ii</span><span class="p">,</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">15</span><span class="p">);</span> <span class="n">Q</span><span class="o">.</span><span class="n">variable_names</span><span class="p">()</span>
<span class="go">(&#39;ii&#39;, &#39;jj&#39;, &#39;kk&#39;)</span>
<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">variable_names</span><span class="p">()</span>
<span class="go">(&#39;i&#39;, &#39;j&#39;, &#39;k&#39;)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebraFactory.create_key">
<span class="sig-name descname"><span class="pre">create_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arg1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arg2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'i,j,k'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebraFactory.create_key" title="Permalink to this definition">#</a></dt>
<dd><p>Create a key that uniquely determines a quaternion algebra.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebraFactory.create_object">
<span class="sig-name descname"><span class="pre">create_object</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">version</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">extra_args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebraFactory.create_object" title="Permalink to this definition">#</a></dt>
<dd><p>Create the object from the key (extra arguments are ignored). This is
only called if the object was not found in the cache.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.algebras.quatalg.quaternion_algebra.</span></span><span class="sig-name descname"><span class="pre">QuaternionAlgebra_ab</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_ring</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'i,j,k'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract" title="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuaternionAlgebra_abstract</span></code></a></p>
<p>A quaternion algebra of the form <span class="math notranslate nohighlight">\((a, b)_K\)</span>.</p>
<p>See <code class="docutils literal notranslate"><span class="pre">QuaternionAlgebra</span></code> for many more examples.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">base_ring</span></code> – a commutative ring <span class="math notranslate nohighlight">\(K\)</span> in which 2 is invertible</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a,</span> <span class="pre">b</span></code> – units of <span class="math notranslate nohighlight">\(K\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">names</span></code> – string (optional, default ‘i,j,k’) names of the generators</p></li>
</ul>
<p>OUTPUT:</p>
<p>The quaternion algebra <span class="math notranslate nohighlight">\((a, b)\)</span> over <span class="math notranslate nohighlight">\(K\)</span> generated by <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span>
subject to <span class="math notranslate nohighlight">\(i^2 = a\)</span>, <span class="math notranslate nohighlight">\(j^2 = b\)</span>, and <span class="math notranslate nohighlight">\(ji = -ij\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">21</span><span class="p">)</span>  <span class="c1"># indirect doctest</span>
<span class="go">Quaternion Algebra (-7, -21) with base ring Rational Field</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.discriminant">
<span class="sig-name descname"><span class="pre">discriminant</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.discriminant" title="Permalink to this definition">#</a></dt>
<dd><p>Given a quaternion algebra <span class="math notranslate nohighlight">\(A\)</span> defined over a number field,
return the discriminant of <span class="math notranslate nohighlight">\(A\)</span>, i.e. the
product of the ramified primes of <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">210</span><span class="p">,</span><span class="o">-</span><span class="mi">22</span><span class="p">)</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">210</span>
<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">19</span>

<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="n">F</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">Fractional ideal (2)</span>

<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)],</span><span class="mi">3</span><span class="p">,</span><span class="mi">19</span><span class="p">)</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">Fractional ideal (1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.gen">
<span class="sig-name descname"><span class="pre">gen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.gen" title="Permalink to this definition">#</a></dt>
<dd><p>Return the <span class="math notranslate nohighlight">\(i^{th}\)</span> generator of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">i</span></code> - integer (optional, default 0)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">.&lt;</span><span class="n">ii</span><span class="p">,</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span> <span class="n">Q</span>
<span class="go">Quaternion Algebra (-1, -2) with base ring Rational Field</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">ii</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">jj</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">kk</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[ii, jj, kk]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.ideal">
<span class="sig-name descname"><span class="pre">ideal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.ideal" title="Permalink to this definition">#</a></dt>
<dd><p>Return the quaternion ideal with given gens over <span class="math notranslate nohighlight">\(\ZZ\)</span>.</p>
<p>Neither a left or right order structure need be specified.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gens</span></code> – a list of elements of this quaternion order</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> – bool (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">left_order</span></code> – a quaternion order or <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">right_order</span></code> – a quaternion order or <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">R</span><span class="o">.</span><span class="n">basis</span><span class="p">()])</span>
<span class="go">Fractional ideal (2, 2*i, 2*j, 2*k)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.inner_product_matrix">
<span class="sig-name descname"><span class="pre">inner_product_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.inner_product_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Return the inner product matrix associated to <code class="docutils literal notranslate"><span class="pre">self</span></code>, i.e. the
Gram matrix of the reduced norm as a quadratic form on <code class="docutils literal notranslate"><span class="pre">self</span></code>.
The standard basis <span class="math notranslate nohighlight">\(1\)</span>, <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(j\)</span>, <span class="math notranslate nohighlight">\(k\)</span> is orthogonal, so this matrix
is just the diagonal matrix with diagonal entries <span class="math notranslate nohighlight">\(1\)</span>, <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, <span class="math notranslate nohighlight">\(ab\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">19</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">inner_product_matrix</span><span class="p">()</span>
<span class="go">[  2   0   0   0]</span>
<span class="go">[  0  10   0   0]</span>
<span class="go">[  0   0  38   0]</span>
<span class="go">[  0   0   0 190]</span>

<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[];</span> <span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Frac</span><span class="p">(</span><span class="n">R</span><span class="p">),</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">inner_product_matrix</span><span class="p">()</span>
<span class="go">[    2     0     0     0]</span>
<span class="go">[    0  -2*a     0     0]</span>
<span class="go">[    0     0  -2*b     0]</span>
<span class="go">[    0     0     0 2*a*b]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.invariants">
<span class="sig-name descname"><span class="pre">invariants</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.invariants" title="Permalink to this definition">#</a></dt>
<dd><p>Return the structural invariants <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span> of this quaternion
algebra: <code class="docutils literal notranslate"><span class="pre">self</span></code> is generated by <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(j\)</span> subject to
<span class="math notranslate nohighlight">\(i^2 = a\)</span>, <span class="math notranslate nohighlight">\(j^2 = b\)</span> and <span class="math notranslate nohighlight">\(ji = -ij\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">invariants</span><span class="p">()</span>
<span class="go">(-3, 5)</span>
<span class="gp">sage: </span><span class="n">i</span><span class="o">^</span><span class="mi">2</span>
<span class="go">-3</span>
<span class="gp">sage: </span><span class="n">j</span><span class="o">^</span><span class="mi">2</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.maximal_order">
<span class="sig-name descname"><span class="pre">maximal_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">take_shortcuts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.maximal_order" title="Permalink to this definition">#</a></dt>
<dd><p>Return a maximal order in this quaternion algebra.</p>
<p>The algorithm used is from <a class="reference internal" href="../../../../references/index.html#voi2012" id="id1"><span>[Voi2012]</span></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">take_shortcuts</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) if the discriminant is
prime and the invariants of the algebra are of a nice form, use
Proposition 5.2 of <a class="reference internal" href="../../../../references/index.html#piz1980" id="id2"><span>[Piz1980]</span></a>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A maximal order in this quaternion algebra.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="go">Order of Quaternion Algebra (-1, -7) with base ring Rational Field with basis (1/2 + 1/2*j, 1/2*i + 1/2*k, j, k)</span>

<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*i + 1/2*j + 1/2*k, i, j, k)</span>

<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*j, 1/2*i + 1/2*k, j, k)</span>

<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*j, 1/2*i + 1/2*k, j, k)</span>

<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*i, 1/2*j - 1/2*k, i, -k)</span>

<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*j + 1/2*k, 1/4*i + 1/2*j + 1/4*k, j, k)</span>

<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*i - 1/2*k, 1/2*i + 1/4*j - 1/4*k, i, -k)</span>

<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">17</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*j, 1/2*i + 1/2*k, -1/3*j - 1/3*k, k)</span>

<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*i, 1/2*j - 1/2*k, -1/3*i + 1/3*k, -k)</span>

<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">17</span><span class="o">*</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1, 1/3*i, 1/6*i + 1/2*j, 1/2 + 1/3*j + 1/18*k)</span>

<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">389</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*j + 1/2*k, 1/4*i + 1/2*j + 1/4*k, j, k)</span>
</pre></div>
</div>
<p>If you want bases containing 1, switch off <code class="docutils literal notranslate"><span class="pre">take_shortcuts</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">89</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">(</span><span class="n">take_shortcuts</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">Order of Quaternion Algebra (-3, -89) with base ring Rational Field with basis (1, 1/2 + 1/2*i, j, 1/2 + 1/6*i + 1/2*j + 1/6*k)</span>

<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">(</span><span class="n">take_shortcuts</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>    <span class="c1"># Matrix ring</span>
<span class="go">Order of Quaternion Algebra (1, 1) with base ring Rational Field with basis (1, 1/2 + 1/2*i, j, 1/2*j + 1/2*k)</span>

<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">22</span><span class="p">,</span><span class="mi">210</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">(</span><span class="n">take_shortcuts</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">Order of Quaternion Algebra (-22, 210) with base ring Rational Field with basis (1, i, 1/2*i + 1/2*j, 1/2 + 17/22*i + 1/44*k)</span>

<span class="gp">sage: </span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">(</span> <span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_squarefree</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="p">):</span>        <span class="c1"># long time (3s)</span>
<span class="gp">....: </span>    <span class="n">A</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="n">R</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">(</span><span class="n">take_shortcuts</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="k">assert</span> <span class="n">A</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span> <span class="o">==</span> <span class="n">R</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
</pre></div>
</div>
<p>We do not support number fields other than the rationals yet:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError: maximal order only implemented for rational quaternion algebras</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.modp_splitting_data">
<span class="sig-name descname"><span class="pre">modp_splitting_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.modp_splitting_data" title="Permalink to this definition">#</a></dt>
<dd><p>Return mod <span class="math notranslate nohighlight">\(p\)</span> splitting data for this quaternion algebra at
the unramified prime <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>This is <span class="math notranslate nohighlight">\(2\times 2\)</span>
matrices <span class="math notranslate nohighlight">\(I\)</span>, <span class="math notranslate nohighlight">\(J\)</span>, <span class="math notranslate nohighlight">\(K\)</span> over the finite field <span class="math notranslate nohighlight">\(\GF{p}\)</span> such that if
the quaternion algebra has generators <span class="math notranslate nohighlight">\(i, j, k\)</span>, then <span class="math notranslate nohighlight">\(I^2 =
i^2\)</span>, <span class="math notranslate nohighlight">\(J^2 = j^2\)</span>, <span class="math notranslate nohighlight">\(IJ=K\)</span> and <span class="math notranslate nohighlight">\(IJ=-JI\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently only implemented when <span class="math notranslate nohighlight">\(p\)</span> is odd and the base
ring is <span class="math notranslate nohighlight">\(\QQ\)</span>.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p\)</span> – unramified odd prime</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>2-tuple of matrices over finite field</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="o">-</span><span class="mi">19</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">modp_splitting_data</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">[0 6]  [6 1]  [6 6]</span>
<span class="go">[1 0], [1 1], [6 1]</span>
<span class="go">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">modp_splitting_data</span><span class="p">(</span><span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">5</span><span class="p">))</span>
<span class="go">(</span>
<span class="go">[    0 99988]  [97311     4]  [99999 59623]</span>
<span class="go">[    1     0], [13334  2692], [97311     4]</span>
<span class="go">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">K</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">modp_splitting_data</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span>
<span class="go">[0 8]</span>
<span class="go">[1 0]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">^</span><span class="mi">2</span>
<span class="go">[8 0]</span>
<span class="go">[0 8]</span>
<span class="gp">sage: </span><span class="n">J</span>
<span class="go">[19  2]</span>
<span class="go">[17  4]</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">^</span><span class="mi">2</span>
<span class="go">[4 0]</span>
<span class="go">[0 4]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">*</span><span class="n">J</span> <span class="o">==</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">I</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">*</span><span class="n">J</span> <span class="o">==</span> <span class="n">K</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The following is a good test because of the asserts in the code:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">modp_splitting_data</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">primes</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">1000</span><span class="p">)]</span>
</pre></div>
</div>
<p>Proper error handling:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">modp_splitting_data</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError: algorithm for computing local splittings not implemented in general (currently require the first invariant to be coprime to p)</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">modp_splitting_data</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError: p must be odd</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.modp_splitting_map">
<span class="sig-name descname"><span class="pre">modp_splitting_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.modp_splitting_map" title="Permalink to this definition">#</a></dt>
<dd><p>Return Python map from the (<span class="math notranslate nohighlight">\(p\)</span>-integral) quaternion algebra to
the set of <span class="math notranslate nohighlight">\(2\times 2\)</span> matrices over <span class="math notranslate nohighlight">\(\GF{p}\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p\)</span> – prime number</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">modp_splitting_map</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="n">j</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">k</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">7</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">j</span><span class="o">+</span><span class="n">k</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span>
<span class="go">[12  3]</span>
<span class="go">[10  5]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">[12  3]</span>
<span class="go">[10  5]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.quaternion_order">
<span class="sig-name descname"><span class="pre">quaternion_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">basis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.quaternion_order" title="Permalink to this definition">#</a></dt>
<dd><p>Return the order of this quaternion order with given basis.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">basis</span></code> - list of 4 elements of <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> - bool (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">quaternion_order</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">])</span>
<span class="go">Order of Quaternion Algebra (-11, -1) with base ring Rational Field with basis (1, i, j, k)</span>
</pre></div>
</div>
<p>We test out <code class="docutils literal notranslate"><span class="pre">check=False</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">quaternion_order</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">],</span> <span class="n">check</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">Order of Quaternion Algebra (-11, -1) with base ring Rational Field with basis (1, i, j, k)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">quaternion_order</span><span class="p">([</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">],</span> <span class="n">check</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">Order of Quaternion Algebra (-11, -1) with base ring Rational Field with basis (i, j, k)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.ramified_primes">
<span class="sig-name descname"><span class="pre">ramified_primes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.ramified_primes" title="Permalink to this definition">#</a></dt>
<dd><p>Return the primes that ramify in this quaternion algebra.</p>
<p>Currently only implemented over the rational numbers.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ramified_primes</span><span class="p">()</span>
<span class="go">[2]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.algebras.quatalg.quaternion_algebra.</span></span><span class="sig-name descname"><span class="pre">QuaternionAlgebra_abstract</span></span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../rings/sage/rings/ring.html#sage.rings.ring.Algebra" title="(in General Rings, Ideals, and Morphisms v10.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Algebra</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.basis">
<span class="sig-name descname"><span class="pre">basis</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.basis" title="Permalink to this definition">#</a></dt>
<dd><p>Return the fixed basis of <code class="docutils literal notranslate"><span class="pre">self</span></code>, which is <span class="math notranslate nohighlight">\(1\)</span>, <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(j\)</span>, <span class="math notranslate nohighlight">\(k\)</span>, where
<span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(j\)</span>, <span class="math notranslate nohighlight">\(k\)</span> are the generators of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1, i, j, k)</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.&lt;</span><span class="n">xyz</span><span class="p">,</span><span class="n">abc</span><span class="p">,</span><span class="n">theta</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">),</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1, xyz, abc, theta)</span>
</pre></div>
</div>
<p>The basis is cached:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span> <span class="ow">is</span> <span class="n">Q</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.free_module">
<span class="sig-name descname"><span class="pre">free_module</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.free_module" title="Permalink to this definition">#</a></dt>
<dd><p>Return the free module associated to <code class="docutils literal notranslate"><span class="pre">self</span></code> with inner
product given by the reduced norm.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">LaurentPolynomialRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="go">Ambient free quadratic module of rank 4 over the principal ideal domain Univariate Laurent Polynomial Ring in t over Finite Field of size 3</span>
<span class="go">Inner product matrix:</span>
<span class="go">[2 0 0 0]</span>
<span class="go">[0 2 0 0]</span>
<span class="go">[0 0 t 0]</span>
<span class="go">[0 0 0 t]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.inner_product_matrix">
<span class="sig-name descname"><span class="pre">inner_product_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.inner_product_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Return the inner product matrix associated to <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>This is the
Gram matrix of the reduced norm as a quadratic form on <code class="docutils literal notranslate"><span class="pre">self</span></code>.
The standard basis <span class="math notranslate nohighlight">\(1\)</span>, <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(j\)</span>, <span class="math notranslate nohighlight">\(k\)</span> is orthogonal, so this matrix
is just the diagonal matrix with diagonal entries <span class="math notranslate nohighlight">\(2\)</span>, <span class="math notranslate nohighlight">\(2a\)</span>, <span class="math notranslate nohighlight">\(2b\)</span>,
<span class="math notranslate nohighlight">\(2ab\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">19</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">inner_product_matrix</span><span class="p">()</span>
<span class="go">[  2   0   0   0]</span>
<span class="go">[  0  10   0   0]</span>
<span class="go">[  0   0  38   0]</span>
<span class="go">[  0   0   0 190]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_commutative">
<span class="sig-name descname"><span class="pre">is_commutative</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_commutative" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">False</span></code> always, since all quaternion algebras are
noncommutative.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_commutative</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_division_algebra">
<span class="sig-name descname"><span class="pre">is_division_algebra</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_division_algebra" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if the quaternion algebra is a division algebra (i.e.
every nonzero element in <code class="docutils literal notranslate"><span class="pre">self</span></code> is invertible), and <code class="docutils literal notranslate"><span class="pre">False</span></code> if the
quaternion algebra is isomorphic to the 2x2 matrix algebra.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_division_algebra</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_division_algebra</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">is_division_algebra</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="mf">2.</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_division_algebra</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError: base field must be rational numbers</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_exact">
<span class="sig-name descname"><span class="pre">is_exact</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_exact" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if elements of this quaternion algebra are represented
exactly, i.e. there is no precision loss when doing arithmetic. A
quaternion algebra is exact if and only if its base field is
exact.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_exact</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">Qp</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_exact</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_field">
<span class="sig-name descname"><span class="pre">is_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_field" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">False</span></code> always, since all quaternion algebras are
noncommutative and all fields are commutative.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_field</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_finite">
<span class="sig-name descname"><span class="pre">is_finite</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_finite" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if the quaternion algebra is finite as a set.</p>
<p>Algorithm: A quaternion algebra is finite if and only if the
base field is finite.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_finite</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_finite</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_integral_domain">
<span class="sig-name descname"><span class="pre">is_integral_domain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_integral_domain" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">False</span></code> always, since all quaternion algebras are
noncommutative and integral domains are commutative (in Sage).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_integral_domain</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_matrix_ring">
<span class="sig-name descname"><span class="pre">is_matrix_ring</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_matrix_ring" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if the quaternion algebra is isomorphic to the 2x2
matrix ring, and <code class="docutils literal notranslate"><span class="pre">False</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is a division algebra (i.e.
every nonzero element in <code class="docutils literal notranslate"><span class="pre">self</span></code> is invertible).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_matrix_ring</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_matrix_ring</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">is_matrix_ring</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="mf">2.</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_matrix_ring</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError: base field must be rational numbers</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_noetherian">
<span class="sig-name descname"><span class="pre">is_noetherian</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_noetherian" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> always, since any quaternion algebra is a noetherian
ring (because it is a finitely generated module over a field).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_noetherian</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.ngens">
<span class="sig-name descname"><span class="pre">ngens</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.ngens" title="Permalink to this definition">#</a></dt>
<dd><p>Return the number of generators of the quaternion algebra as a K-vector
space, not including 1.</p>
<p>This value is always 3: the algebra is spanned
by the standard basis <span class="math notranslate nohighlight">\(1\)</span>, <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(j\)</span>, <span class="math notranslate nohighlight">\(k\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">ngens</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[i, j, k]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.order">
<span class="sig-name descname"><span class="pre">order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.order" title="Permalink to this definition">#</a></dt>
<dd><p>Return the number of elements of the quaternion algebra, or
<code class="docutils literal notranslate"><span class="pre">+Infinity</span></code> if the algebra is not finite.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">625</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.random_element">
<span class="sig-name descname"><span class="pre">random_element</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.random_element" title="Permalink to this definition">#</a></dt>
<dd><p>Return a random element of this quaternion algebra.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">args</span></code> and <code class="docutils literal notranslate"><span class="pre">kwds</span></code> are passed to the <code class="docutils literal notranslate"><span class="pre">random_element</span></code> method
of the base ring.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)],</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)],</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">17</span><span class="p">)(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">17</span><span class="p">)(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Specify the numerator and denominator bounds:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">19</span><span class="p">)</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="o">^</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">g</span><span class="p">:</span>
<span class="gp">....: </span>    <span class="k">assert</span> <span class="n">h</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="o">^</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="k">assert</span> <span class="n">h</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">19</span><span class="p">)</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">g</span><span class="p">:</span>
<span class="gp">....: </span>    <span class="k">assert</span> <span class="n">h</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="k">assert</span> <span class="n">h</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.vector_space">
<span class="sig-name descname"><span class="pre">vector_space</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.vector_space" title="Permalink to this definition">#</a></dt>
<dd><p>Alias for <a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.free_module" title="sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.free_module"><code class="xref py py-meth docutils literal notranslate"><span class="pre">free_module()</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">19</span><span class="p">)</span><span class="o">.</span><span class="n">vector_space</span><span class="p">()</span>
<span class="go">Ambient quadratic space of dimension 4 over Rational Field</span>
<span class="go">Inner product matrix:</span>
<span class="go">[   2    0    0    0]</span>
<span class="go">[   0    6    0    0]</span>
<span class="go">[   0    0  -38    0]</span>
<span class="go">[   0    0    0 -114]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.algebras.quatalg.quaternion_algebra.</span></span><span class="sig-name descname"><span class="pre">QuaternionFractionalIdeal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ring</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coerce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../rings/sage/rings/ideal.html#sage.rings.ideal.Ideal_fractional" title="(in General Rings, Ideals, and Morphisms v10.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Ideal_fractional</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.algebras.quatalg.quaternion_algebra.</span></span><span class="sig-name descname"><span class="pre">QuaternionFractionalIdeal_rational</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal" title="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuaternionFractionalIdeal</span></code></a></p>
<p>A fractional ideal in a rational quaternion algebra.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">left_order</span></code> – a quaternion order or <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">right_order</span></code> – a quaternion order or <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">basis</span></code> – tuple of length 4 of elements in of ambient
quaternion algebra whose <span class="math notranslate nohighlight">\(\ZZ\)</span>-span is an ideal</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> – bool (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); if <code class="docutils literal notranslate"><span class="pre">False</span></code>, do no type
checking.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.basis">
<span class="sig-name descname"><span class="pre">basis</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.basis" title="Permalink to this definition">#</a></dt>
<dd><p>Return a basis for this fractional ideal.</p>
<p>OUTPUT: tuple</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">unit_ideal</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*i, 1/2*j - 1/2*k, i, -k)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.basis_matrix">
<span class="sig-name descname"><span class="pre">basis_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.basis_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Return basis matrix <span class="math notranslate nohighlight">\(M\)</span> in Hermite normal form for self as a
matrix with rational entries.</p>
<p>If <span class="math notranslate nohighlight">\(Q\)</span> is the ambient quaternion algebra, then the <span class="math notranslate nohighlight">\(\ZZ\)</span>-span of
the rows of <span class="math notranslate nohighlight">\(M\)</span> viewed as linear combinations of Q.basis() =
<span class="math notranslate nohighlight">\([1,i,j,k]\)</span> is the fractional ideal self.  Also,
<code class="docutils literal notranslate"><span class="pre">M</span> <span class="pre">*</span> <span class="pre">M.denominator()</span></code> is an integer matrix in Hermite normal form.</p>
<p>OUTPUT: matrix over <span class="math notranslate nohighlight">\(\QQ\)</span></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">unit_ideal</span><span class="p">()</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">()</span>
<span class="go">[1/2 1/2   0   0]</span>
<span class="go">[  0   1   0   0]</span>
<span class="go">[  0   0 1/2 1/2]</span>
<span class="go">[  0   0   0   1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.conjugate">
<span class="sig-name descname"><span class="pre">conjugate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.conjugate" title="Permalink to this definition">#</a></dt>
<dd><p>Return the ideal with generators the conjugates of the generators for self.</p>
<p>OUTPUT: a quaternionic fractional ideal</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="mi">1</span><span class="p">];</span> <span class="n">I</span>
<span class="go">Fractional ideal (2 + 6*j + 4*k, 2*i + 4*j + 34*k, 8*j + 32*k, 40*k)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span>
<span class="go">Fractional ideal (2 + 2*j + 28*k, 2*i + 4*j + 34*k, 8*j + 32*k, 40*k)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.cyclic_right_subideals">
<span class="sig-name descname"><span class="pre">cyclic_right_subideals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.cyclic_right_subideals" title="Permalink to this definition">#</a></dt>
<dd><p>Let <span class="math notranslate nohighlight">\(I\)</span> = <code class="docutils literal notranslate"><span class="pre">self</span></code>. This function returns the right subideals
<span class="math notranslate nohighlight">\(J\)</span> of <span class="math notranslate nohighlight">\(I\)</span> such that <span class="math notranslate nohighlight">\(I/J\)</span> is an <span class="math notranslate nohighlight">\(\GF{p}\)</span>-vector space of
dimension 2.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – prime number (see below)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">alpha</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) element of quaternion algebra,
which can be used to parameterize the order of the
ideals <span class="math notranslate nohighlight">\(J\)</span>.  More precisely the <span class="math notranslate nohighlight">\(J\)</span>’s are the right annihilators
of <span class="math notranslate nohighlight">\((1,0) \alpha^i\)</span> for <span class="math notranslate nohighlight">\(i=0,1,2,...,p\)</span></p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>list of right ideals</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently, <span class="math notranslate nohighlight">\(p\)</span> must satisfy a bunch of conditions, or a
<code class="docutils literal notranslate"><span class="pre">NotImplementedError</span></code> is raised.  In particular, <span class="math notranslate nohighlight">\(p\)</span> must be
odd and unramified in the quaternion algebra, must be
coprime to the index of the right order in the maximal
order, and also coprime to the normal of self.  (The Brandt
modules code has a more general algorithm in some cases.)</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">37</span><span class="p">);</span> <span class="n">I</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">cyclic_right_subideals</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[Fractional ideal (2 + 2*i + 10*j + 90*k, 4*i + 4*j + 152*k, 12*j + 132*k, 444*k), Fractional ideal (2 + 2*i + 2*j + 150*k, 4*i + 8*j + 196*k, 12*j + 132*k, 444*k), Fractional ideal (2 + 2*i + 6*j + 194*k, 4*i + 8*j + 344*k, 12*j + 132*k, 444*k), Fractional ideal (2 + 2*i + 6*j + 46*k, 4*i + 4*j + 4*k, 12*j + 132*k, 444*k)]</span>

<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">389</span><span class="p">);</span> <span class="n">I</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">cyclic_right_subideals</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">C</span>
<span class="go">[Fractional ideal (2 + 10*j + 546*k, i + 6*j + 133*k, 12*j + 3456*k, 4668*k), Fractional ideal (2 + 2*j + 2910*k, i + 6*j + 3245*k, 12*j + 3456*k, 4668*k), Fractional ideal (2 + i + 2295*k, 3*i + 2*j + 3571*k, 4*j + 2708*k, 4668*k), Fractional ideal (2 + 2*i + 2*j + 4388*k, 3*i + 2*j + 2015*k, 4*j + 4264*k, 4668*k)]</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">I</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span><span class="o">/</span><span class="n">J</span><span class="o">.</span><span class="n">free_module</span><span class="p">())</span><span class="o">.</span><span class="n">invariants</span><span class="p">()</span> <span class="k">for</span> <span class="n">J</span> <span class="ow">in</span> <span class="n">C</span><span class="p">]</span>
<span class="go">[(3, 3), (3, 3), (3, 3), (3, 3)]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">cyclic_right_subideals</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[Fractional ideal (6 + 30*j + 1638*k, 3*i + 18*j + 399*k, 36*j + 10368*k, 14004*k), Fractional ideal (6 + 6*j + 8730*k, 3*i + 18*j + 9735*k, 36*j + 10368*k, 14004*k), Fractional ideal (6 + 3*i + 6885*k, 9*i + 6*j + 10713*k, 12*j + 8124*k, 14004*k), Fractional ideal (6 + 6*i + 6*j + 13164*k, 9*i + 6*j + 6045*k, 12*j + 12792*k, 14004*k)]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">cyclic_right_subideals</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">C</span>
<span class="go">[Fractional ideal (2/9 + 10/9*j + 182/3*k, 1/9*i + 2/3*j + 133/9*k, 4/3*j + 384*k, 1556/3*k), Fractional ideal (2/9 + 2/9*j + 970/3*k, 1/9*i + 2/3*j + 3245/9*k, 4/3*j + 384*k, 1556/3*k), Fractional ideal (2/9 + 1/9*i + 255*k, 1/3*i + 2/9*j + 3571/9*k, 4/9*j + 2708/9*k, 1556/3*k), Fractional ideal (2/9 + 2/9*i + 2/9*j + 4388/9*k, 1/3*i + 2/9*j + 2015/9*k, 4/9*j + 4264/9*k, 1556/3*k)]</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">I</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span><span class="o">/</span><span class="n">J</span><span class="o">.</span><span class="n">free_module</span><span class="p">())</span><span class="o">.</span><span class="n">invariants</span><span class="p">()</span> <span class="k">for</span> <span class="n">J</span> <span class="ow">in</span> <span class="n">C</span><span class="p">]</span>
<span class="go">[(3, 3), (3, 3), (3, 3), (3, 3)]</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">Q</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">cyclic_right_subideals</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[Fractional ideal (1 + 2*j, i + k, 3*j, 3*k), Fractional ideal (1 + j, i + 2*k, 3*j, 3*k), Fractional ideal (1 + 2*i, 3*i, j + 2*k, 3*k), Fractional ideal (1 + i, 3*i, j + k, 3*k)]</span>
</pre></div>
</div>
<p>The general algorithm is not yet implemented here:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">cyclic_right_subideals</span><span class="p">(</span><span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cyclic_right_subideals</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError: general algorithm not implemented (The given basis vectors must be linearly independent.)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.free_module">
<span class="sig-name descname"><span class="pre">free_module</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.free_module" title="Permalink to this definition">#</a></dt>
<dd><p>Return the underlying free <span class="math notranslate nohighlight">\(\ZZ\)</span>-module corresponding to this ideal.</p>
<p>OUTPUT:</p>
<p>Free <span class="math notranslate nohighlight">\(\ZZ\)</span>-module of rank 4 embedded in an ambient <span class="math notranslate nohighlight">\(\QQ^4\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Fractional ideal (2 + 2*j + 8*k, 2*i + 18*k, 4*j + 16*k, 20*k)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="go">Free module of degree 4 and rank 4 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[ 2  0  2  8]</span>
<span class="go">[ 0  2  0 18]</span>
<span class="go">[ 0  0  4 16]</span>
<span class="go">[ 0  0  0 20]</span>
<span class="gp">sage: </span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="go">Free module of degree 4 and rank 4 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[ 2/7    0  2/7  8/7]</span>
<span class="go">[   0  2/7    0 18/7]</span>
<span class="go">[   0    0  4/7 16/7]</span>
<span class="go">[   0    0    0 20/7]</span>

<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">unit_ideal</span><span class="p">()</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">()</span>
<span class="go">[1/2 1/2   0   0]</span>
<span class="go">[  0   1   0   0]</span>
<span class="go">[  0   0 1/2 1/2]</span>
<span class="go">[  0   0   0   1]</span>
</pre></div>
</div>
<p>The free module method is also useful since it allows for checking if
one ideal is contained in another, computing quotients <span class="math notranslate nohighlight">\(I/J\)</span>, etc.:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span> <span class="n">I</span>
<span class="go">Fractional ideal (2 + 2*j + 164*k, 2*i + 4*j + 46*k, 16*j + 224*k, 272*k)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span><span class="o">.</span><span class="n">is_submodule</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">free_module</span><span class="p">())</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span><span class="o">.</span><span class="n">is_submodule</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">free_module</span><span class="p">())</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span> <span class="o">/</span> <span class="n">I</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="go">Finitely generated module V/W over Integer Ring with invariants (4, 4)</span>
</pre></div>
</div>
<p>This shows that the issue at <a class="reference external" href="https://github.com/sagemath/sage/issues/6760">github issue #6760</a> is fixed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">13</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">]);</span> <span class="n">I</span>
<span class="go">Fractional ideal (2 + i, 3*i, j + k, 5*k)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="go">Free module of degree 4 and rank 4 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[2 1 0 0]</span>
<span class="go">[0 3 0 0]</span>
<span class="go">[0 0 1 1]</span>
<span class="go">[0 0 0 5]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.gram_matrix">
<span class="sig-name descname"><span class="pre">gram_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.gram_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Gram matrix of this fractional ideal.</p>
<p>OUTPUT: <span class="math notranslate nohighlight">\(4 \times 4\)</span> matrix over <span class="math notranslate nohighlight">\(\QQ\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="mi">1</span><span class="p">];</span> <span class="n">I</span>
<span class="go">Fractional ideal (2 + 6*j + 4*k, 2*i + 4*j + 34*k, 8*j + 32*k, 40*k)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">gram_matrix</span><span class="p">()</span>
<span class="go">[  640  1920  2112  1920]</span>
<span class="go">[ 1920 14080 13440 16320]</span>
<span class="go">[ 2112 13440 13056 15360]</span>
<span class="go">[ 1920 16320 15360 19200]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.intersection">
<span class="sig-name descname"><span class="pre">intersection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">J</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.intersection" title="Permalink to this definition">#</a></dt>
<dd><p>Return the intersection of the ideals self and <span class="math notranslate nohighlight">\(J\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span> <span class="n">I</span>
<span class="go">Fractional ideal (2 + 6*j + 4*k, 2*i + 4*j + 34*k, 8*j + 32*k, 40*k)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.is_equivalent">
<span class="sig-name descname"><span class="pre">is_equivalent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">J</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.is_equivalent" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">J</span></code> are equivalent as right ideals.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">J</span></code> – a fractional quaternion ideal with same order as <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">B</span></code> – a bound to compute and compare theta series before
doing the full equivalence test</p></li>
</ul>
<p>OUTPUT: bool</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">();</span> <span class="nb">len</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_equivalent</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_equivalent</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">OO</span> <span class="o">=</span> <span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">left_order</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">OO</span><span class="o">.</span><span class="n">right_ideal</span><span class="p">([</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">basis</span><span class="p">()])</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_equivalent</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.left_order">
<span class="sig-name descname"><span class="pre">left_order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.left_order" title="Permalink to this definition">#</a></dt>
<dd><p>Return the left order associated to this fractional ideal.</p>
<p>OUTPUT: an order in a quaternion algebra</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">unit_ideal</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">left_order</span><span class="p">()</span>
<span class="go">Order of Quaternion Algebra (-1, -11) with base ring Rational Field with basis (1/2 + 1/2*j, 1/2*i + 1/2*k, j, k)</span>
</pre></div>
</div>
<p>We do a consistency check:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">19</span><span class="p">);</span> <span class="n">R</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">left_order</span><span class="p">()</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">R</span><span class="p">]</span>
<span class="go">[209, 209, 209, 209, 209, 209, 209, 209, 209, 209, 209, 209, 209, 209, 209, 209, 209, 209]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.multiply_by_conjugate">
<span class="sig-name descname"><span class="pre">multiply_by_conjugate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">J</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.multiply_by_conjugate" title="Permalink to this definition">#</a></dt>
<dd><p>Return product of self and the conjugate Jbar of <span class="math notranslate nohighlight">\(J\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">J</span></code> – a quaternion ideal.</p></li>
</ul>
<p>OUTPUT: a quaternionic fractional ideal.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">multiply_by_conjugate</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">Fractional ideal (8 + 8*j + 112*k, 8*i + 16*j + 136*k, 32*j + 128*k, 160*k)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">R</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span>
<span class="go">Fractional ideal (8 + 8*j + 112*k, 8*i + 16*j + 136*k, 32*j + 128*k, 160*k)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.norm">
<span class="sig-name descname"><span class="pre">norm</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.norm" title="Permalink to this definition">#</a></dt>
<dd><p>Return the reduced norm of this fractional ideal.</p>
<p>OUTPUT: rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">I</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">C</span><span class="p">]</span>
<span class="go">[16, 32, 32]</span>

<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="p">()</span><span class="o">.</span><span class="n">invariants</span><span class="p">()</span>                                       <span class="c1"># optional - magma</span>
<span class="gp">sage: </span><span class="n">magma</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;A&lt;i,j,k&gt; := QuaternionAlgebra&lt;Rationals() | </span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>         <span class="c1"># optional - magma</span>
<span class="go">&#39;&#39;</span>
<span class="gp">sage: </span><span class="n">magma</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;O := QuaternionOrder(</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">right_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">())))</span>    <span class="c1"># optional - magma</span>
<span class="go">&#39;&#39;</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="n">magma</span><span class="p">(</span><span class="s1">&#39;rideal&lt;O | </span><span class="si">%s</span><span class="s1">&gt;&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">basis</span><span class="p">())))</span><span class="o">.</span><span class="n">Norm</span><span class="p">()</span> <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">C</span><span class="p">]</span>               <span class="c1"># optional - magma</span>
<span class="go">[16, 32, 32]</span>

<span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">])</span>      <span class="c1"># this is actually an order, so has reduced norm 1</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="n">J</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="k">for</span> <span class="n">J</span> <span class="ow">in</span> <span class="n">R</span><span class="o">.</span><span class="n">cyclic_right_subideals</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">]</span>     <span class="c1"># enumerate maximal right R-ideals of reduced norm 3, verify their norms</span>
<span class="go">[3, 3, 3, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.quadratic_form">
<span class="sig-name descname"><span class="pre">quadratic_form</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.quadratic_form" title="Permalink to this definition">#</a></dt>
<dd><p>Return the normalized quadratic form associated to this quaternion ideal.</p>
<p>OUTPUT: quadratic form</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">quadratic_form</span><span class="p">();</span> <span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Rational Field with coefficients:</span>
<span class="go">[ 18 22 33 22 ]</span>
<span class="go">[ * 7 22 11 ]</span>
<span class="go">[ * * 22 0 ]</span>
<span class="go">[ * * * 22 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">1 + 12*q^2 + 12*q^3 + 12*q^4 + 12*q^5 + 24*q^6 + 24*q^7 + 36*q^8 + 36*q^9 + O(q^10)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">1 + 12*q^2 + 12*q^3 + 12*q^4 + 12*q^5 + 24*q^6 + 24*q^7 + 36*q^8 + 36*q^9 + O(q^10)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.quaternion_algebra">
<span class="sig-name descname"><span class="pre">quaternion_algebra</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.quaternion_algebra" title="Permalink to this definition">#</a></dt>
<dd><p>Return the ambient quaternion algebra that contains this fractional ideal.</p>
<p>OUTPUT: a quaternion algebra</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="mi">1</span><span class="p">];</span> <span class="n">I</span>
<span class="go">Fractional ideal (2 + 6*j + 4*k, 2*i + 4*j + 34*k, 8*j + 32*k, 40*k)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="p">()</span>
<span class="go">Quaternion Algebra (-1, -3) with base ring Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.quaternion_order">
<span class="sig-name descname"><span class="pre">quaternion_order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.quaternion_order" title="Permalink to this definition">#</a></dt>
<dd><p>Return the order for which this ideal is a left or right
fractional ideal.</p>
<p>If this ideal has both a left and right
ideal structure, then the left order is returned.  If it has
neither structure, then an error is raised.</p>
<p>OUTPUT: QuaternionOrder</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">unit_ideal</span><span class="p">()</span><span class="o">.</span><span class="n">quaternion_order</span><span class="p">()</span> <span class="ow">is</span> <span class="n">R</span>
<span class="go">doctest:...:  DeprecationWarning: quaternion_order() is deprecated, please use left_order() or right_order()</span>
<span class="go">See https://github.com/sagemath/sage/issues/31583 for details.</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.right_order">
<span class="sig-name descname"><span class="pre">right_order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.right_order" title="Permalink to this definition">#</a></dt>
<dd><p>Return the right order associated to this fractional ideal.</p>
<p>OUTPUT: an order in a quaternion algebra</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="mi">1</span><span class="p">];</span> <span class="n">I</span>
<span class="go">Fractional ideal (2 + 6*j + 2*k, i + 2*j + k, 8*j, 8*k)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">right_order</span><span class="p">()</span>
<span class="go">Order of Quaternion Algebra (-2, -389) with base ring Rational Field with basis (1/2 + 1/2*j + 1/2*k, 1/4*i + 1/2*j + 1/4*k, j, k)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">left_order</span><span class="p">()</span>
<span class="go">Order of Quaternion Algebra (-2, -389) with base ring Rational Field with basis (1/2 + 1/2*j + 3/2*k, 1/8*i + 1/4*j + 9/8*k, j + k, 2*k)</span>
</pre></div>
</div>
<p>The following is a big consistency check.  We take reps for
all the right ideal classes of a certain order, take the
corresponding left orders, then take ideals in the left orders
and from those compute the right order again:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">19</span><span class="p">);</span> <span class="n">R</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">O</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">left_order</span><span class="p">()</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">R</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="p">[</span><span class="n">O</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">left_ideal</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">basis</span><span class="p">())</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">R</span><span class="p">))]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">J</span><span class="p">))</span>
<span class="go">18</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">I</span><span class="o">.</span><span class="n">right_order</span><span class="p">()</span> <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">J</span><span class="p">]))</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">right_order</span><span class="p">()</span> <span class="o">==</span> <span class="n">B</span><span class="o">.</span><span class="n">order_of_level_N</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.ring">
<span class="sig-name descname"><span class="pre">ring</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.ring" title="Permalink to this definition">#</a></dt>
<dd><p>Return ring that this is a fractional ideal for.</p>
<p>The <a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.ring" title="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.ring"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ring()</span></code></a> method will be removed from this class in the
future.  Calling <a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.ring" title="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.ring"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ring()</span></code></a> will then return the ambient
quaternion algebra.  This is consistent with the behaviour for
number fields.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">unit_ideal</span><span class="p">()</span><span class="o">.</span><span class="n">ring</span><span class="p">()</span> <span class="ow">is</span> <span class="n">R</span>
<span class="go">doctest:...:  DeprecationWarning: ring() will return the quaternion algebra in the future, please use left_order() or right_order()</span>
<span class="go">See https://github.com/sagemath/sage/issues/31583 for details.</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.scale">
<span class="sig-name descname"><span class="pre">scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.scale" title="Permalink to this definition">#</a></dt>
<dd><p>Scale the fractional ideal <code class="docutils literal notranslate"><span class="pre">self</span></code> by multiplying the basis
by <code class="docutils literal notranslate"><span class="pre">alpha</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\alpha\)</span> – element of quaternion algebra</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">left</span></code> – bool (default: False); if true multiply
<span class="math notranslate nohighlight">\(\alpha\)</span> on the left, otherwise multiply <span class="math notranslate nohighlight">\(\alpha\)</span> on the right</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a new fractional ideal</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">37</span><span class="p">);</span> <span class="n">I</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="mi">0</span><span class="p">];</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">();</span> <span class="n">I</span>
<span class="go">Fractional ideal (2 + 2*j + 106*k, i + 2*j + 105*k, 4*j + 64*k, 148*k)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="go">Fractional ideal (2*i + 212*j - 2*k, -2 + 210*j - 2*k, 128*j - 4*k, 296*j)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Fractional ideal (2*i - 212*j + 2*k, -2 - 210*j + 2*k, -128*j + 4*k, -296*j)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">Fractional ideal (2*i + 212*j - 2*k, -2 + 210*j - 2*k, 128*j - 4*k, 296*j)</span>
<span class="gp">sage: </span><span class="n">i</span> <span class="o">*</span> <span class="n">I</span><span class="o">.</span><span class="n">gens</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">2*i - 212*j + 2*k</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">gens</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">i</span>
<span class="go">2*i + 212*j - 2*k</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.theta_series">
<span class="sig-name descname"><span class="pre">theta_series</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'q'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.theta_series" title="Permalink to this definition">#</a></dt>
<dd><p>Return normalized theta series of <code class="docutils literal notranslate"><span class="pre">self</span></code>, as a power series over
<span class="math notranslate nohighlight">\(\ZZ\)</span> in the variable <code class="docutils literal notranslate"><span class="pre">var</span></code>, which is ‘q’ by default.</p>
<p>The normalized theta series is by definition</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\theta_I(q) = \sum_{x \in I} q^{\frac{N(x)}{N(I)}}.\]</div>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">B</span></code> – positive integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">var</span></code> – string (default: ‘q’)</p></li>
</ul>
<p>OUTPUT: power series</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="mi">1</span><span class="p">];</span> <span class="n">I</span>
<span class="go">Fractional ideal (2 + 6*j + 4*k, 2*i + 4*j + 2*k, 8*j, 8*k)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">32</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">1 + 12*q^2 + 12*q^3 + 12*q^4 + O(q^5)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>
<span class="go">1 + 12*T^2 + 12*T^3 + 12*T^4 + O(T^5)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1 + 12*q^2 + O(q^3)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.theta_series_vector">
<span class="sig-name descname"><span class="pre">theta_series_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.theta_series_vector" title="Permalink to this definition">#</a></dt>
<dd><p>Return theta series coefficients of <code class="docutils literal notranslate"><span class="pre">self</span></code>, as a vector
of <code class="docutils literal notranslate"><span class="pre">B</span></code> integers.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">B</span></code> – positive integer</p></li>
</ul>
<p>OUTPUT:</p>
<p>Vector over <span class="math notranslate nohighlight">\(\ZZ\)</span> with <code class="docutils literal notranslate"><span class="pre">B</span></code> entries.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span><span class="o">.</span><span class="n">right_ideals</span><span class="p">()[</span><span class="mi">1</span><span class="p">];</span> <span class="n">I</span>
<span class="go">Fractional ideal (2 + 6*j + 2*k, i + 2*j + k, 8*j, 8*k)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">theta_series_vector</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">(1, 0, 2, 2, 6)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">theta_series_vector</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">(1, 0, 2, 2, 6, 4, 8, 6, 10, 10)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">theta_series_vector</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">(1, 0, 2, 2, 6)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.algebras.quatalg.quaternion_algebra.</span></span><span class="sig-name descname"><span class="pre">QuaternionOrder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/parent.html#sage.structure.parent.Parent" title="(in Parents and Elements v10.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parent</span></code></a></p>
<p>An order in a quaternion algebra.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="go">Order of Quaternion Algebra (-1, -7) with base ring Rational Field with basis (1/2 + 1/2*j, 1/2*i + 1/2*k, j, k)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">())</span>
<span class="go">&lt;class &#39;sage.algebras.quatalg.quaternion_algebra.QuaternionOrder_with_category&#39;&gt;</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.basis">
<span class="sig-name descname"><span class="pre">basis</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.basis" title="Permalink to this definition">#</a></dt>
<dd><p>Return fix choice of basis for this quaternion order.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*i, 1/2*j - 1/2*k, i, -k)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.discriminant">
<span class="sig-name descname"><span class="pre">discriminant</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.discriminant" title="Permalink to this definition">#</a></dt>
<dd><p>Return the discriminant of this order.</p>
<p>This is defined as
<span class="math notranslate nohighlight">\(\sqrt{ det ( Tr(e_i \bar{e}_j ) ) }\)</span>, where <span class="math notranslate nohighlight">\(\{e_i\}\)</span> is the
basis of the order.</p>
<p>OUTPUT: rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">11</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">order_of_level_N</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">55</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">discriminant</span><span class="p">())</span>
<span class="go">&lt;... &#39;sage.rings.rational.Rational&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.free_module">
<span class="sig-name descname"><span class="pre">free_module</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.free_module" title="Permalink to this definition">#</a></dt>
<dd><p>Return the free <span class="math notranslate nohighlight">\(\ZZ\)</span>-module that corresponds to this order
inside the vector space corresponding to the ambient
quaternion algebra.</p>
<p>OUTPUT:</p>
<p>A free <span class="math notranslate nohighlight">\(\ZZ\)</span>-module of rank 4.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*i, 1/2*j - 1/2*k, i, -k)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="go">Free module of degree 4 and rank 4 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[1/2 1/2   0   0]</span>
<span class="go">[  0   1   0   0]</span>
<span class="go">[  0   0 1/2 1/2]</span>
<span class="go">[  0   0   0   1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.gen">
<span class="sig-name descname"><span class="pre">gen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.gen" title="Permalink to this definition">#</a></dt>
<dd><p>Return the n-th generator.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> - an integer between 0 and 3, inclusive.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">();</span> <span class="n">R</span>
<span class="go">Order of Quaternion Algebra (-11, -1) with base ring Rational Field with basis (1/2 + 1/2*i, 1/2*j - 1/2*k, i, -k)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">1/2 + 1/2*i</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1/2*j - 1/2*k</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">i</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">-k</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.gens">
<span class="sig-name descname"><span class="pre">gens</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.gens" title="Permalink to this definition">#</a></dt>
<dd><p>Return generators for self.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(1/2 + 1/2*j, 1/2*i + 1/2*k, j, k)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.intersection">
<span class="sig-name descname"><span class="pre">intersection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.intersection" title="Permalink to this definition">#</a></dt>
<dd><p>Return the intersection of this order with other.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> - a quaternion order in the same ambient quaternion algebra</p></li>
</ul>
<p>OUTPUT: a quaternion order</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="go">Order of Quaternion Algebra (-11, -1) with base ring Rational Field with basis (1/2 + 1/2*i, i, 1/2*j + 1/2*k, k)</span>
</pre></div>
</div>
<p>We intersect various orders in the quaternion algebra ramified at 11:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">();</span> <span class="n">S</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">order_of_level_N</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="go">Order of Quaternion Algebra (-1, -11) with base ring Rational Field with basis (1/2 + 1/2*j, 1/2*i + 5/2*k, j, 3*k)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">S</span><span class="p">)</span> <span class="o">==</span> <span class="n">S</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">order_of_level_N</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="go">Order of Quaternion Algebra (-1, -11) with base ring Rational Field with basis (1/2 + 1/2*j, 1/2*i + 23/2*k, j, 15*k)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.left_ideal">
<span class="sig-name descname"><span class="pre">left_ideal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.left_ideal" title="Permalink to this definition">#</a></dt>
<dd><p>Return the ideal with given gens over <span class="math notranslate nohighlight">\(\ZZ\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gens</span></code> – a list of elements of this quaternion order</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> – bool (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">left_ideal</span><span class="p">([</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">R</span><span class="o">.</span><span class="n">basis</span><span class="p">()])</span>
<span class="go">Fractional ideal (1 + i, 2*i, j + k, 2*k)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.ngens">
<span class="sig-name descname"><span class="pre">ngens</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.ngens" title="Permalink to this definition">#</a></dt>
<dd><p>Return the number of generators (which is 4).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">ngens</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.one">
<span class="sig-name descname"><span class="pre">one</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.one" title="Permalink to this definition">#</a></dt>
<dd><p>Return the multiplicative unit of this quaternion order.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.quadratic_form">
<span class="sig-name descname"><span class="pre">quadratic_form</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.quadratic_form" title="Permalink to this definition">#</a></dt>
<dd><p>Return the normalized quadratic form associated to this quaternion order.</p>
<p>OUTPUT: quadratic form</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span><span class="o">.</span><span class="n">order_of_level_N</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">quadratic_form</span><span class="p">();</span> <span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Rational Field with coefficients:</span>
<span class="go">[ 14 253 55 286 ]</span>
<span class="go">[ * 1455 506 3289 ]</span>
<span class="go">[ * * 55 572 ]</span>
<span class="go">[ * * * 1859 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">1 + 2*q + 2*q^4 + 4*q^6 + 4*q^8 + 2*q^9 + O(q^10)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.quaternion_algebra">
<span class="sig-name descname"><span class="pre">quaternion_algebra</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.quaternion_algebra" title="Permalink to this definition">#</a></dt>
<dd><p>Return ambient quaternion algebra that contains this quaternion order.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="p">()</span>
<span class="go">Quaternion Algebra (-11, -1) with base ring Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.random_element">
<span class="sig-name descname"><span class="pre">random_element</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.random_element" title="Permalink to this definition">#</a></dt>
<dd><p>Return a random element of this order.</p>
<p>The args and kwds are passed to the random_element method of
the integer ring, and we return an element of the form</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[ae_1 + be_2 + ce_3 + de_4\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(e_1\)</span>, …, <span class="math notranslate nohighlight">\(e_4\)</span> are the basis of this order and <span class="math notranslate nohighlight">\(a\)</span>,
<span class="math notranslate nohighlight">\(b\)</span>, <span class="math notranslate nohighlight">\(c\)</span>, <span class="math notranslate nohighlight">\(d\)</span> are random integers.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>  <span class="c1"># random</span>
<span class="go">-4 - 4*i + j - k</span>
<span class="gp">sage: </span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># random</span>
<span class="go">-9/2 - 7/2*i - 7/2*j - 3/2*k</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.right_ideal">
<span class="sig-name descname"><span class="pre">right_ideal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.right_ideal" title="Permalink to this definition">#</a></dt>
<dd><p>Return the ideal with given gens over <span class="math notranslate nohighlight">\(\ZZ\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gens</span></code> – a list of elements of this quaternion order</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> – bool (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">right_ideal</span><span class="p">([</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">R</span><span class="o">.</span><span class="n">basis</span><span class="p">()])</span>
<span class="go">Fractional ideal (1 + i, 2*i, j + k, 2*k)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.ternary_quadratic_form">
<span class="sig-name descname"><span class="pre">ternary_quadratic_form</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.ternary_quadratic_form" title="Permalink to this definition">#</a></dt>
<dd><p>Return the ternary quadratic form associated to this order.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">include_basis</span></code> – bool (default: False), if True also
return a basis for the dimension 3 subspace <span class="math notranslate nohighlight">\(G\)</span></p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>QuadraticForm</p></li>
<li><p>optional basis for dimension 3 subspace</p></li>
</ul>
<p>This function computes the positive definition quadratic form
obtained by letting G be the trace zero subspace of <span class="math notranslate nohighlight">\(\ZZ\)</span> +
2* <code class="docutils literal notranslate"><span class="pre">self</span></code>, which has rank 3, and restricting the pairing
<a class="reference internal" href="quaternion_algebra_element.html#sage.algebras.quatalg.quaternion_algebra_element.QuaternionAlgebraElement_abstract.pair" title="sage.algebras.quatalg.quaternion_algebra_element.QuaternionAlgebraElement_abstract.pair"><code class="xref py py-meth docutils literal notranslate"><span class="pre">QuaternionAlgebraElement_abstract.pair()</span></code></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">(x,y) = (x.conjugate()*y).reduced_trace()</span>
</pre></div>
</div>
<p>to <span class="math notranslate nohighlight">\(G\)</span>.</p>
<p>APPLICATIONS: Ternary quadratic forms associated to an order
in a rational quaternion algebra are useful in computing with
Gross points, in decided whether quaternion orders have
embeddings from orders in quadratic imaginary fields, and in
computing elements of the Kohnen plus subspace of modular
forms of weight 3/2.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">BrandtModule</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span><span class="o">.</span><span class="n">order_of_level_N</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ternary_quadratic_form</span><span class="p">();</span> <span class="n">Q</span>
<span class="go">Quadratic form in 3 variables over Rational Field with coefficients:</span>
<span class="go">[ 5820 1012 13156 ]</span>
<span class="go">[ * 55 1144 ]</span>
<span class="go">[ * * 7436 ]</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">disc</span><span class="p">())</span>
<span class="go">2^4 * 11^2 * 13^2</span>
</pre></div>
</div>
<p>The following theta series is a modular form of weight 3/2 and level 4*11*13:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">1 + 2*q^23 + 2*q^55 + 2*q^56 + 2*q^75 + 4*q^92 + O(q^100)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.unit_ideal">
<span class="sig-name descname"><span class="pre">unit_ideal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.unit_ideal" title="Permalink to this definition">#</a></dt>
<dd><p>Return the unit ideal in this quaternion order.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">unit_ideal</span><span class="p">();</span> <span class="n">I</span>
<span class="go">Fractional ideal (1/2 + 1/2*i, 1/2*j - 1/2*k, i, -k)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.basis_for_quaternion_lattice">
<span class="sig-prename descclassname"><span class="pre">sage.algebras.quatalg.quaternion_algebra.</span></span><span class="sig-name descname"><span class="pre">basis_for_quaternion_lattice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.basis_for_quaternion_lattice" title="Permalink to this definition">#</a></dt>
<dd><p>Return a basis for the <span class="math notranslate nohighlight">\(\ZZ\)</span>-lattice in a quaternion algebra
spanned by the given gens.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gens</span></code> – list of elements of a single quaternion algebra</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reverse</span></code> – when computing the HNF do it on the basis
<span class="math notranslate nohighlight">\((k,j,i,1)\)</span> instead of <span class="math notranslate nohighlight">\((1,i,j,k)\)</span>; this ensures
that if <code class="docutils literal notranslate"><span class="pre">gens</span></code> are the generators for an order,
the first returned basis vector is 1</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.algebras.quatalg.quaternion_algebra</span> <span class="kn">import</span> <span class="n">basis_for_quaternion_lattice</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">basis_for_quaternion_lattice</span><span class="p">([</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">-</span><span class="n">j</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)])</span>
<span class="go">[1/3, i + j, 2*j, 2*k]</span>

<span class="gp">sage: </span><span class="n">basis_for_quaternion_lattice</span><span class="p">([</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">])</span>
<span class="go">[1, i, j, k]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.intersection_of_row_modules_over_ZZ">
<span class="sig-prename descclassname"><span class="pre">sage.algebras.quatalg.quaternion_algebra.</span></span><span class="sig-name descname"><span class="pre">intersection_of_row_modules_over_ZZ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.intersection_of_row_modules_over_ZZ" title="Permalink to this definition">#</a></dt>
<dd><p>Intersect the <span class="math notranslate nohighlight">\(\ZZ\)</span>-modules with basis matrices the full rank <span class="math notranslate nohighlight">\(4 \times 4\)</span>
<span class="math notranslate nohighlight">\(\QQ\)</span>-matrices in the list v.</p>
<p>The returned intersection is
represented by a <span class="math notranslate nohighlight">\(4 \times 4\)</span> matrix over <span class="math notranslate nohighlight">\(\QQ\)</span>.  This can also be done
using modules and intersection, but that would take over twice as long
because of overhead, hence this function.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">4</span><span class="p">,[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">4</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">4</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">]</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.algebras.quatalg.quaternion_algebra</span> <span class="kn">import</span> <span class="n">intersection_of_row_modules_over_ZZ</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">intersection_of_row_modules_over_ZZ</span><span class="p">(</span><span class="n">v</span><span class="p">);</span> <span class="n">M</span>
<span class="go">[   2    0   -1   -1]</span>
<span class="go">[  -4    1    1   -3]</span>
<span class="go">[  -3 19/2   -1   -4]</span>
<span class="go">[   2   -3   -8    4]</span>
<span class="gp">sage: </span><span class="n">M2</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">row_module</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">row_module</span><span class="p">(</span><span class="n">ZZ</span><span class="p">))</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">row_module</span><span class="p">(</span><span class="n">ZZ</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">row_module</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span> <span class="o">==</span> <span class="n">M2</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.is_QuaternionAlgebra">
<span class="sig-prename descclassname"><span class="pre">sage.algebras.quatalg.quaternion_algebra.</span></span><span class="sig-name descname"><span class="pre">is_QuaternionAlgebra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.is_QuaternionAlgebra" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">A</span></code> is of the QuaternionAlgebra data type.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">algebras</span><span class="o">.</span><span class="n">quatalg</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="o">.</span><span class="n">is_QuaternionAlgebra</span><span class="p">(</span><span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">algebras</span><span class="o">.</span><span class="n">quatalg</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="o">.</span><span class="n">is_QuaternionAlgebra</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.maxord_solve_aux_eq">
<span class="sig-prename descclassname"><span class="pre">sage.algebras.quatalg.quaternion_algebra.</span></span><span class="sig-name descname"><span class="pre">maxord_solve_aux_eq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.maxord_solve_aux_eq" title="Permalink to this definition">#</a></dt>
<dd><p>Given <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> and an even prime ideal <code class="docutils literal notranslate"><span class="pre">p</span></code> find
(y,z,w) with y a unit mod <span class="math notranslate nohighlight">\(p^{2e}\)</span> such that</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[1 - ay^2 - bz^2 + abw^2 \equiv 0 mod p^{2e},\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(e\)</span> is the ramification index of <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>Currently only <span class="math notranslate nohighlight">\(p=2\)</span> is implemented by hardcoding solutions.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code> – integer with <span class="math notranslate nohighlight">\(v_p(a) = 0\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code> – integer with <span class="math notranslate nohighlight">\(v_p(b) \in \{0,1\}\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – even prime ideal (actually only <code class="docutils literal notranslate"><span class="pre">p=ZZ(2)</span></code> is implemented)</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>A tuple <span class="math notranslate nohighlight">\((y, z, w)\)</span></p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.algebras.quatalg.quaternion_algebra</span> <span class="kn">import</span> <span class="n">maxord_solve_aux_eq</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]:</span>
<span class="gp">....: </span>    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]:</span>
<span class="gp">....: </span>        <span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="p">)</span> <span class="o">=</span> <span class="n">maxord_solve_aux_eq</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">....: </span>        <span class="k">assert</span> <span class="n">mod</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">mod</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">....: </span>        <span class="k">assert</span> <span class="n">mod</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">a</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">b</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">w</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.normalize_basis_at_p">
<span class="sig-prename descclassname"><span class="pre">sage.algebras.quatalg.quaternion_algebra.</span></span><span class="sig-name descname"><span class="pre">normalize_basis_at_p</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B=&lt;method</span> <span class="pre">'pair'</span> <span class="pre">of</span> <span class="pre">'sage.algebras.quatalg.quaternion_algebra_element.QuaternionAlgebraElement_abstract'</span> <span class="pre">objects&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.normalize_basis_at_p" title="Permalink to this definition">#</a></dt>
<dd><p>Compute a (at <code class="docutils literal notranslate"><span class="pre">p</span></code>) normalized basis from the given basis <code class="docutils literal notranslate"><span class="pre">e</span></code>
of a <span class="math notranslate nohighlight">\(\ZZ\)</span>-module.</p>
<p>The returned basis is (at <code class="docutils literal notranslate"><span class="pre">p</span></code>) a <span class="math notranslate nohighlight">\(\ZZ_p\)</span> basis for the same
module, and has the property that with respect to it the quadratic
form induced by the bilinear form B is represented as a orthogonal
sum of atomic forms multiplied by p-powers.</p>
<p>If <span class="math notranslate nohighlight">\(p \neq 2\)</span> this means that the form is diagonal with respect to
this basis.</p>
<p>If <span class="math notranslate nohighlight">\(p = 2\)</span> there may be additional 2-dimensional subspaces on which
the form is represented as <span class="math notranslate nohighlight">\(2^e (ax^2 + bxy + cx^2)\)</span> with
<span class="math notranslate nohighlight">\(0 = v_2(b) = v_2(a) \leq v_2(c)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">e</span></code> – list; basis of a <span class="math notranslate nohighlight">\(\ZZ\)</span> module.
WARNING: will be modified!</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – prime for at which the basis should be normalized</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">B</span></code> –
(default: <a class="reference internal" href="quaternion_algebra_element.html#sage.algebras.quatalg.quaternion_algebra_element.QuaternionAlgebraElement_abstract.pair" title="sage.algebras.quatalg.quaternion_algebra_element.QuaternionAlgebraElement_abstract.pair"><code class="xref py py-meth docutils literal notranslate"><span class="pre">QuaternionAlgebraElement_abstract.pair()</span></code></a>)
a bilinear form with respect to which to normalize</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>A list containing two-element tuples: The first element of
each tuple is a basis element, the second the valuation of
the orthogonal summand to which it belongs. The list is sorted
by ascending valuation.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.algebras.quatalg.quaternion_algebra</span> <span class="kn">import</span> <span class="n">normalize_basis_at_p</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="p">[</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">normalize_basis_at_p</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">[(1, 0), (i, 0), (j, 0), (k, 0)]</span>

<span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">210</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="p">[</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">normalize_basis_at_p</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">[(1, 0), (i, 1), (j, 1), (k, 2)]</span>

<span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="mi">286</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="p">[</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">normalize_basis_at_p</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">[(1, 0), (1/2*j + 1/2*k, 0), (-5/6*j + 1/6*k, 1), (1/2*i, 1)]</span>

<span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="p">[</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">normalize_basis_at_p</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">[(1, 0), (1/2 + 1/2*i + 1/2*j + 1/2*k, 0), (-34/105*i - 463/735*j + 71/105*k, 1), (-34/105*i - 463/735*j + 71/105*k, 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.algebras.quatalg.quaternion_algebra.unpickle_QuaternionAlgebra_v0">
<span class="sig-prename descclassname"><span class="pre">sage.algebras.quatalg.quaternion_algebra.</span></span><span class="sig-name descname"><span class="pre">unpickle_QuaternionAlgebra_v0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.algebras.quatalg.quaternion_algebra.unpickle_QuaternionAlgebra_v0" title="Permalink to this definition">#</a></dt>
<dd><p>The 0th version of pickling for quaternion algebras.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">19</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">19</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">algebras</span><span class="o">.</span><span class="n">quatalg</span><span class="o">.</span><span class="n">quaternion_algebra</span><span class="o">.</span><span class="n">unpickle_QuaternionAlgebra_v0</span><span class="p">(</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="go">Quaternion Algebra (-5, -19) with base ring Rational Field</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">Q</span><span class="p">))</span> <span class="o">==</span> <span class="n">Q</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">Q</span><span class="p">))</span> <span class="ow">is</span> <span class="n">Q</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="quaternion_algebra_element.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Elements of Quaternion Algebras</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../../../index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Home</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2023, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Quaternion Algebras</a><ul>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebraFactory"><code class="docutils literal notranslate"><span class="pre">QuaternionAlgebraFactory</span></code></a><ul>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebraFactory.create_key"><code class="docutils literal notranslate"><span class="pre">create_key()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebraFactory.create_object"><code class="docutils literal notranslate"><span class="pre">create_object()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab"><code class="docutils literal notranslate"><span class="pre">QuaternionAlgebra_ab</span></code></a><ul>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.discriminant"><code class="docutils literal notranslate"><span class="pre">discriminant()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.gen"><code class="docutils literal notranslate"><span class="pre">gen()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.ideal"><code class="docutils literal notranslate"><span class="pre">ideal()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.inner_product_matrix"><code class="docutils literal notranslate"><span class="pre">inner_product_matrix()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.invariants"><code class="docutils literal notranslate"><span class="pre">invariants()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.maximal_order"><code class="docutils literal notranslate"><span class="pre">maximal_order()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.modp_splitting_data"><code class="docutils literal notranslate"><span class="pre">modp_splitting_data()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.modp_splitting_map"><code class="docutils literal notranslate"><span class="pre">modp_splitting_map()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.quaternion_order"><code class="docutils literal notranslate"><span class="pre">quaternion_order()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_ab.ramified_primes"><code class="docutils literal notranslate"><span class="pre">ramified_primes()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract"><code class="docutils literal notranslate"><span class="pre">QuaternionAlgebra_abstract</span></code></a><ul>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.basis"><code class="docutils literal notranslate"><span class="pre">basis()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.free_module"><code class="docutils literal notranslate"><span class="pre">free_module()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.inner_product_matrix"><code class="docutils literal notranslate"><span class="pre">inner_product_matrix()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_commutative"><code class="docutils literal notranslate"><span class="pre">is_commutative()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_division_algebra"><code class="docutils literal notranslate"><span class="pre">is_division_algebra()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_exact"><code class="docutils literal notranslate"><span class="pre">is_exact()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_field"><code class="docutils literal notranslate"><span class="pre">is_field()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_finite"><code class="docutils literal notranslate"><span class="pre">is_finite()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_integral_domain"><code class="docutils literal notranslate"><span class="pre">is_integral_domain()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_matrix_ring"><code class="docutils literal notranslate"><span class="pre">is_matrix_ring()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.is_noetherian"><code class="docutils literal notranslate"><span class="pre">is_noetherian()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.ngens"><code class="docutils literal notranslate"><span class="pre">ngens()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.order"><code class="docutils literal notranslate"><span class="pre">order()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.random_element"><code class="docutils literal notranslate"><span class="pre">random_element()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionAlgebra_abstract.vector_space"><code class="docutils literal notranslate"><span class="pre">vector_space()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal"><code class="docutils literal notranslate"><span class="pre">QuaternionFractionalIdeal</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational"><code class="docutils literal notranslate"><span class="pre">QuaternionFractionalIdeal_rational</span></code></a><ul>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.basis"><code class="docutils literal notranslate"><span class="pre">basis()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.basis_matrix"><code class="docutils literal notranslate"><span class="pre">basis_matrix()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.conjugate"><code class="docutils literal notranslate"><span class="pre">conjugate()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.cyclic_right_subideals"><code class="docutils literal notranslate"><span class="pre">cyclic_right_subideals()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.free_module"><code class="docutils literal notranslate"><span class="pre">free_module()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.gram_matrix"><code class="docutils literal notranslate"><span class="pre">gram_matrix()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.intersection"><code class="docutils literal notranslate"><span class="pre">intersection()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.is_equivalent"><code class="docutils literal notranslate"><span class="pre">is_equivalent()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.left_order"><code class="docutils literal notranslate"><span class="pre">left_order()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.multiply_by_conjugate"><code class="docutils literal notranslate"><span class="pre">multiply_by_conjugate()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.norm"><code class="docutils literal notranslate"><span class="pre">norm()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.quadratic_form"><code class="docutils literal notranslate"><span class="pre">quadratic_form()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.quaternion_algebra"><code class="docutils literal notranslate"><span class="pre">quaternion_algebra()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.quaternion_order"><code class="docutils literal notranslate"><span class="pre">quaternion_order()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.right_order"><code class="docutils literal notranslate"><span class="pre">right_order()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.ring"><code class="docutils literal notranslate"><span class="pre">ring()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.scale"><code class="docutils literal notranslate"><span class="pre">scale()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.theta_series"><code class="docutils literal notranslate"><span class="pre">theta_series()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionFractionalIdeal_rational.theta_series_vector"><code class="docutils literal notranslate"><span class="pre">theta_series_vector()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder"><code class="docutils literal notranslate"><span class="pre">QuaternionOrder</span></code></a><ul>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.basis"><code class="docutils literal notranslate"><span class="pre">basis()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.discriminant"><code class="docutils literal notranslate"><span class="pre">discriminant()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.free_module"><code class="docutils literal notranslate"><span class="pre">free_module()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.gen"><code class="docutils literal notranslate"><span class="pre">gen()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.gens"><code class="docutils literal notranslate"><span class="pre">gens()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.intersection"><code class="docutils literal notranslate"><span class="pre">intersection()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.left_ideal"><code class="docutils literal notranslate"><span class="pre">left_ideal()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.ngens"><code class="docutils literal notranslate"><span class="pre">ngens()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.one"><code class="docutils literal notranslate"><span class="pre">one()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.quadratic_form"><code class="docutils literal notranslate"><span class="pre">quadratic_form()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.quaternion_algebra"><code class="docutils literal notranslate"><span class="pre">quaternion_algebra()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.random_element"><code class="docutils literal notranslate"><span class="pre">random_element()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.right_ideal"><code class="docutils literal notranslate"><span class="pre">right_ideal()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.ternary_quadratic_form"><code class="docutils literal notranslate"><span class="pre">ternary_quadratic_form()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.QuaternionOrder.unit_ideal"><code class="docutils literal notranslate"><span class="pre">unit_ideal()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.basis_for_quaternion_lattice"><code class="docutils literal notranslate"><span class="pre">basis_for_quaternion_lattice()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.intersection_of_row_modules_over_ZZ"><code class="docutils literal notranslate"><span class="pre">intersection_of_row_modules_over_ZZ()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.is_QuaternionAlgebra"><code class="docutils literal notranslate"><span class="pre">is_QuaternionAlgebra()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.maxord_solve_aux_eq"><code class="docutils literal notranslate"><span class="pre">maxord_solve_aux_eq()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.normalize_basis_at_p"><code class="docutils literal notranslate"><span class="pre">normalize_basis_at_p()</span></code></a></li>
<li><a class="reference internal" href="#sage.algebras.quatalg.quaternion_algebra.unpickle_QuaternionAlgebra_v0"><code class="docutils literal notranslate"><span class="pre">unpickle_QuaternionAlgebra_v0()</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/scripts/furo.js"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script src="../../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="../../../../_static/mathjax/tex-chtml.js"></script>
    </body>
</html>