<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="Quotients of modules with basis" href="subquotient.html" /><link rel="prev" title="Invariant modules" href="invariant.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>Morphisms of modules with a basis - Modules</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=a078f75a" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/jupyter-sphinx.css?v=572af1d6" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-furo.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-codemirror-monokai.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Modules</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 10.3 Reference Manual</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../../index.html">Home - Modules</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial_free_modules.html">Tutorial: Using free modules and vector spaces</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../module.html">Abstract base class for modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../free_module.html">Free modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../free_module_element.html">Elements of free modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../submodule.html">Submodules and subquotients of free modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quotient_module.html">Quotients of free modules</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="all.html">Concrete classes related to modules with a distinguished basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="cell_module.html">Cell modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="indexed_element.html">An element in an indexed free module</a></li>
<li class="toctree-l1"><a class="reference internal" href="invariant.html">Invariant modules</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Morphisms of modules with a basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="subquotient.html">Quotients of modules with basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="representation.html">Representations of a semigroup</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../fg_pid/fgp_module.html">Finitely generated modules over a PID</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fg_pid/fgp_element.html">Elements of finitely generated modules over a PID</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fg_pid/fgp_morphism.html">Morphisms between finitely generated modules over a PID</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../fp_graded/free_module.html">Finitely generated free graded left modules over connected graded algebras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fp_graded/free_element.html">Elements of finitely generated free graded left modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fp_graded/free_morphism.html">Homomorphisms of finitely generated free graded left modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fp_graded/free_homspace.html">Homsets of finitely generated free graded left modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fp_graded/module.html">Finitely presented graded modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fp_graded/element.html">Elements of finitely presented graded modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fp_graded/morphism.html">Homomorphisms of finitely presented graded modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fp_graded/homspace.html">Homsets of finitely presented graded modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fp_graded/steenrod/module.html">Finitely presented graded modules over the Steenrod algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fp_graded/steenrod/morphism.html">Homomorphisms of finitely presented modules over the Steenrod algebra</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../free_module_integer.html">Discrete subgroups of <span class="math notranslate nohighlight">\(\ZZ^n\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../free_quadratic_module.html">Free quadratic modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../free_quadratic_module_integer_symmetric.html">Integral lattices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../torsion_quadratic_module.html">Finite <span class="math notranslate nohighlight">\(\ZZ\)</span>-modules with bilinear and quadratic forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../filtered_vector_space.html"><span class="math notranslate nohighlight">\(\ZZ\)</span>-filtered vector spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../multi_filtered_vector_space.html">Multiple <span class="math notranslate nohighlight">\(\ZZ\)</span>-graded filtrations of a single vector space</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../vector_space_homspace.html">Space of morphisms of vector spaces (linear transformations)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vector_space_morphism.html">Morphisms of vector spaces (linear transformations)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../free_module_homspace.html">Homspaces between free modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../free_module_morphism.html">Morphisms of free modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../matrix_morphism.html">Morphisms defined by a matrix</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../vector_integer_dense.html">Vectors with integer entries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vector_integer_sparse.html">File: sage/modules/vector_integer_sparse.pyx (starting at line 1)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vector_mod2_dense.html">Vectors with elements in <span class="math notranslate nohighlight">\(\GF{2}\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../vector_modn_dense.html">Vectors with integer mod <span class="math notranslate nohighlight">\(n\)</span> entries, with small <span class="math notranslate nohighlight">\(n\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../vector_modn_sparse.html">File: sage/modules/vector_modn_sparse.pyx (starting at line 1)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vector_rational_dense.html">Vectors with rational entries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vector_rational_sparse.html">File: sage/modules/vector_rational_sparse.pyx (starting at line 1)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vector_symbolic_dense.html">Dense vectors over the symbolic ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vector_symbolic_sparse.html">Sparse vectors over the symbolic ring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vector_callable_symbolic_dense.html">Vectors over callable symbolic rings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vector_double_dense.html">Dense vectors using a NumPy backend</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vector_real_double_dense.html">Dense real double vectors using a NumPy backend</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vector_numpy_dense.html">Dense vectors using a NumPy backend.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vector_numpy_integer_dense.html">Dense integer vectors using a NumPy backend.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vector_complex_double_dense.html">Dense complex double vectors using a NumPy backend</a></li>
<li class="toctree-l1"><a class="reference internal" href="../complex_double_vector.html">Pickling for the old CDF vector class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../real_double_vector.html">Pickling for the old RDF vector class</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../diamond_cutting.html">Diamond cutting implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tensor_operations.html">Helper classes to implement tensor operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../finite_submodule_iter.html">Iterators over finite submodules of a <span class="math notranslate nohighlight">\(\ZZ\)</span>-module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc.html">Miscellaneous module-related functions</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="morphisms-of-modules-with-a-basis">
<span id="sage-modules-with-basis-morphism"></span><h1>Morphisms of modules with a basis<a class="headerlink" href="#morphisms-of-modules-with-a-basis" title="Link to this heading">#</a></h1>
<p id="module-sage.modules.with_basis.morphism">This module contains a hierarchy of classes for morphisms of modules
with a basis (category <code class="xref py py-class docutils literal notranslate"><span class="pre">Modules.WithBasis</span></code>):</p>
<ul class="simple">
<li><p><a class="reference internal" href="#sage.modules.with_basis.morphism.ModuleMorphism" title="sage.modules.with_basis.morphism.ModuleMorphism"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleMorphism</span></code></a></p></li>
<li><p><a class="reference internal" href="#sage.modules.with_basis.morphism.ModuleMorphismByLinearity" title="sage.modules.with_basis.morphism.ModuleMorphismByLinearity"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleMorphismByLinearity</span></code></a></p></li>
<li><p><a class="reference internal" href="#sage.modules.with_basis.morphism.ModuleMorphismFromMatrix" title="sage.modules.with_basis.morphism.ModuleMorphismFromMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleMorphismFromMatrix</span></code></a></p></li>
<li><p><a class="reference internal" href="#sage.modules.with_basis.morphism.ModuleMorphismFromFunction" title="sage.modules.with_basis.morphism.ModuleMorphismFromFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleMorphismFromFunction</span></code></a></p></li>
<li><p><a class="reference internal" href="#sage.modules.with_basis.morphism.TriangularModuleMorphism" title="sage.modules.with_basis.morphism.TriangularModuleMorphism"><code class="xref py py-class docutils literal notranslate"><span class="pre">TriangularModuleMorphism</span></code></a></p></li>
<li><p><a class="reference internal" href="#sage.modules.with_basis.morphism.TriangularModuleMorphismByLinearity" title="sage.modules.with_basis.morphism.TriangularModuleMorphismByLinearity"><code class="xref py py-class docutils literal notranslate"><span class="pre">TriangularModuleMorphismByLinearity</span></code></a></p></li>
<li><p><a class="reference internal" href="#sage.modules.with_basis.morphism.TriangularModuleMorphismFromFunction" title="sage.modules.with_basis.morphism.TriangularModuleMorphismFromFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">TriangularModuleMorphismFromFunction</span></code></a></p></li>
</ul>
<p>These are internal classes; it is recommended <em>not</em> to use them
directly, and instead to construct morphisms through the
<a class="reference external" href="../../../../categories/sage/categories/modules_with_basis.html#sage.categories.modules_with_basis.ModulesWithBasis.ParentMethods.module_morphism" title="(in Category Framework v10.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ModulesWithBasis.ParentMethods.module_morphism()</span></code></a> method of the
domain, or through the homset. See the former for an overview
of the possible arguments.</p>
<p>EXAMPLES:</p>
<p>We construct a morphism through the method
<a class="reference external" href="../../../../categories/sage/categories/modules_with_basis.html#sage.categories.modules_with_basis.ModulesWithBasis.ParentMethods.module_morphism" title="(in Category Framework v10.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ModulesWithBasis.ParentMethods.module_morphism()</span></code></a>, by specifying
the image of each element of the distinguished basis:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span>   <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]);</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">on_basis</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">Y</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">Y</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">phi1</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">module_morphism</span><span class="p">(</span><span class="n">on_basis</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">Y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi1</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">B[1] + 2*B[2]</span>

<span class="gp">sage: </span><span class="n">phi1</span>
<span class="go">Generic morphism:</span>
<span class="go">  From: Free module generated by {1, 2, 3} over Rational Field</span>
<span class="go">  To:   Free module generated by {1, 2, 3, 4} over Rational Field</span>
<span class="gp">sage: </span><span class="n">phi1</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Set of Morphisms from Free module generated by {1, 2, 3} over Rational Field to Free module generated by {1, 2, 3, 4} over Rational Field in Category of finite dimensional vector spaces with basis over Rational Field</span>
<span class="gp">sage: </span><span class="n">phi1</span><span class="o">.</span><span class="vm">__class__</span>
<span class="go">&lt;class &#39;sage.modules.with_basis.morphism.ModuleMorphismByLinearity_with_category&#39;&gt;</span>
</pre></div>
</div>
<p>Constructing the same morphism from the homset:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">Hom</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi2</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="n">on_basis</span><span class="o">=</span><span class="n">on_basis</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi1</span> <span class="o">==</span> <span class="n">phi2</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Constructing the same morphism directly using the class; no backward
compatibility is guaranteed in this case:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modules.with_basis.morphism</span> <span class="kn">import</span> <span class="n">ModuleMorphismByLinearity</span>
<span class="gp">sage: </span><span class="n">phi3</span> <span class="o">=</span> <span class="n">ModuleMorphismByLinearity</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">on_basis</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">Y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi3</span> <span class="o">==</span> <span class="n">phi1</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The hierarchy of classes implemented in this module is one of the
first non-trivial hierarchies of classes for morphisms. It is
hitting a couple scaling issues:</p>
<ul>
<li><p>There are many independent properties from which module
morphisms can get code (being defined by linearity, from a
matrix, or a function; being triangular, being diagonal,
…). How to mitigate the class hierarchy growth?</p>
<p>This will become even more stringent as more properties are
added (e.g. being defined from generators for an algebra
morphism, …)</p>
<p>Categories, whose primary purpose is to provide infrastructure
for handling such large hierarchy of classes, can’t help at this
point: there is no category whose morphisms are triangular
morphisms, and it’s not clear such a category would be sensible.</p>
</li>
<li><p>How to properly handle <code class="docutils literal notranslate"><span class="pre">__init__</span></code> method calls and
multiple inheritance?</p></li>
<li><p>Who should be in charge of setting the default category: the
classes themselves, or
<a class="reference external" href="../../../../categories/sage/categories/modules_with_basis.html#sage.categories.modules_with_basis.ModulesWithBasis.ParentMethods.module_morphism" title="(in Category Framework v10.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ModulesWithBasis.ParentMethods.module_morphism()</span></code></a>?</p></li>
</ul>
<p>Because of this, the hierarchy of classes, and the specific APIs,
is likely to be refactored as better infrastructure and best
practices emerge.</p>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Nicolas M. Thiery (2008-2015)</p></li>
<li><p>Jason Bandlow and Florent Hivert (2010): Triangular Morphisms</p></li>
<li><p>Christian Stump (2010): <a class="reference external" href="https://github.com/sagemath/sage/issues/9648">github issue #9648</a> module_morphism’s to a wider class
of codomains</p></li>
</ul>
<p>Before <a class="reference external" href="https://github.com/sagemath/sage/issues/8678">github issue #8678</a>, this hierarchy of classes used to be in
sage.categories.modules_with_basis; see <a class="reference external" href="https://github.com/sagemath/sage/issues/8678">github issue #8678</a> for the complete log.</p>
<dl class="py class">
<dt class="sig sig-object py" id="sage.modules.with_basis.morphism.DiagonalModuleMorphism">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.modules.with_basis.morphism.</span></span><span class="sig-name descname"><span class="pre">DiagonalModuleMorphism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagonal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">codomain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">category</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modules.with_basis.morphism.DiagonalModuleMorphism" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.modules.with_basis.morphism.ModuleMorphismByLinearity" title="sage.modules.with_basis.morphism.ModuleMorphismByLinearity"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleMorphismByLinearity</span></code></a></p>
<p>A class for diagonal module morphisms.</p>
<p>See <a class="reference external" href="../../../../categories/sage/categories/modules_with_basis.html#sage.categories.modules_with_basis.ModulesWithBasis.ParentMethods.module_morphism" title="(in Category Framework v10.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ModulesWithBasis.ParentMethods.module_morphism()</span></code></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">domain</span></code>, <code class="docutils literal notranslate"><span class="pre">codomain</span></code> – two modules with basis <span class="math notranslate nohighlight">\(F\)</span> and <span class="math notranslate nohighlight">\(G\)</span>,
respectively</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">diagonal</span></code> – a function <span class="math notranslate nohighlight">\(d\)</span></p></li>
</ul>
<p>Assumptions:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">domain</span></code> and <code class="docutils literal notranslate"><span class="pre">codomain</span></code> have the same base ring <span class="math notranslate nohighlight">\(R\)</span>,</p></li>
<li><p>their respective bases <span class="math notranslate nohighlight">\(F\)</span> and <span class="math notranslate nohighlight">\(G\)</span> have the same index set <span class="math notranslate nohighlight">\(I\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(d\)</span> is a function <span class="math notranslate nohighlight">\(I \to R\)</span>.</p></li>
</ul>
<p>Return the diagonal module morphism from <code class="docutils literal notranslate"><span class="pre">domain</span></code> to <code class="docutils literal notranslate"><span class="pre">codomain</span></code>
sending <span class="math notranslate nohighlight">\(F(i) \mapsto d(i) G(i)\)</span> for all <span class="math notranslate nohighlight">\(i \in I\)</span>.</p>
<p>By default, <code class="docutils literal notranslate"><span class="pre">codomain</span></code> is currently assumed to be <code class="docutils literal notranslate"><span class="pre">domain</span></code>.
(Todo: make a consistent choice with <code class="docutils literal notranslate"><span class="pre">*ModuleMorphism</span></code>.)</p>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Implement an optimized <code class="docutils literal notranslate"><span class="pre">_call_()</span></code> function.</p></li>
<li><p>Generalize to a mapcoeffs.</p></li>
<li><p>Generalize to a mapterms.</p></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]);</span> <span class="n">X</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">module_morphism</span><span class="p">(</span><span class="n">diagonal</span><span class="o">=</span><span class="n">factorial</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">phi</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">phi</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="go">(B[1], 2*B[2], 6*B[3])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.modules.with_basis.morphism.ModuleMorphism">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.modules.with_basis.morphism.</span></span><span class="sig-name descname"><span class="pre">ModuleMorphism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">codomain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">category</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">affine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modules.with_basis.morphism.ModuleMorphism" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../categories/sage/categories/morphism.html#sage.categories.morphism.Morphism" title="(in Category Framework v10.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Morphism</span></code></a></p>
<p>The top abstract base class for module with basis morphisms.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">domain</span></code> – a parent in <code class="docutils literal notranslate"><span class="pre">ModulesWithBasis(...)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">codomain</span></code> – a parent in <code class="docutils literal notranslate"><span class="pre">Modules(...)</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">category</span></code> – a category or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default: <span class="math notranslate nohighlight">\(None`\)</span>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">affine</span></code> – whether we define an affine module morphism
(default: False).</p></li>
</ul>
<p>Construct a module morphism from <code class="docutils literal notranslate"><span class="pre">domain</span></code> to <code class="docutils literal notranslate"><span class="pre">codomain</span></code> in the
category <code class="docutils literal notranslate"><span class="pre">category</span></code>. By default, the category is the first of
<code class="docutils literal notranslate"><span class="pre">Modules(R).WithBasis().FiniteDimensional()</span></code>,
<code class="docutils literal notranslate"><span class="pre">Modules(R).WithBasis()</span></code>, <code class="docutils literal notranslate"><span class="pre">Modules(R)</span></code>,
<code class="docutils literal notranslate"><span class="pre">CommutativeAdditiveMonoids()</span></code> that contains both the domain and
the codomain. If initializing an affine morphism, then <span class="math notranslate nohighlight">\(Sets()\)</span> is
used instead.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="../../../../categories/sage/categories/modules_with_basis.html#sage.categories.modules_with_basis.ModulesWithBasis.ParentMethods.module_morphism" title="(in Category Framework v10.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ModulesWithBasis.ParentMethods.module_morphism()</span></code></a> for
usage information and examples;</p></li>
<li><p><a class="reference internal" href="#module-sage.modules.with_basis.morphism" title="sage.modules.with_basis.morphism"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.modules.with_basis.morphism</span></code></a> for a technical
overview of the classes for module morphisms;</p></li>
<li><p><a class="reference internal" href="#sage.modules.with_basis.morphism.ModuleMorphismFromFunction" title="sage.modules.with_basis.morphism.ModuleMorphismFromFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleMorphismFromFunction</span></code></a> and
<a class="reference internal" href="#sage.modules.with_basis.morphism.TriangularModuleMorphism" title="sage.modules.with_basis.morphism.TriangularModuleMorphism"><code class="xref py py-class docutils literal notranslate"><span class="pre">TriangularModuleMorphism</span></code></a>.</p></li>
</ul>
</div>
<p>The role of this class is minimal: it provides an <code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code>
method which:</p>
<ul class="simple">
<li><p>handles the choice of the default category</p></li>
<li><p>handles the proper inheritance from categories by updating the
class of <code class="docutils literal notranslate"><span class="pre">self</span></code> upon construction.</p></li>
</ul>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.modules.with_basis.morphism.ModuleMorphismByLinearity">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.modules.with_basis.morphism.</span></span><span class="sig-name descname"><span class="pre">ModuleMorphismByLinearity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">codomain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">category</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modules.with_basis.morphism.ModuleMorphismByLinearity" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.modules.with_basis.morphism.ModuleMorphism" title="sage.modules.with_basis.morphism.ModuleMorphism"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleMorphism</span></code></a></p>
<p>A class for module morphisms obtained by extending a function by linearity.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">domain</span></code>, <code class="docutils literal notranslate"><span class="pre">codomain</span></code>, <code class="docutils literal notranslate"><span class="pre">category</span></code> – as for <a class="reference internal" href="#sage.modules.with_basis.morphism.ModuleMorphism" title="sage.modules.with_basis.morphism.ModuleMorphism"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleMorphism</span></code></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">on_basis</span></code> – a function which accepts indices of the basis of
<code class="docutils literal notranslate"><span class="pre">domain</span></code> as <code class="docutils literal notranslate"><span class="pre">position</span></code>-th argument</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">codomain</span></code> – a parent in <code class="docutils literal notranslate"><span class="pre">Modules(...)</span></code></dt><dd><p>(default: <code class="docutils literal notranslate"><span class="pre">on_basis.codomain()</span></code>)</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">position</span></code> – a non-negative integer (default: 0)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">zero</span></code> – the zero of the codomain (defaults: <code class="docutils literal notranslate"><span class="pre">codomain.zero()</span></code>)</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="../../../../categories/sage/categories/modules_with_basis.html#sage.categories.modules_with_basis.ModulesWithBasis.ParentMethods.module_morphism" title="(in Category Framework v10.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ModulesWithBasis.ParentMethods.module_morphism()</span></code></a> for
usage information and examples;</p></li>
<li><p><a class="reference internal" href="#module-sage.modules.with_basis.morphism" title="sage.modules.with_basis.morphism"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.modules.with_basis.morphism</span></code></a> for a technical
overview of the classes for module morphisms;</p></li>
<li><p><a class="reference internal" href="#sage.modules.with_basis.morphism.ModuleMorphismFromFunction" title="sage.modules.with_basis.morphism.ModuleMorphismFromFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleMorphismFromFunction</span></code></a> and
<a class="reference internal" href="#sage.modules.with_basis.morphism.TriangularModuleMorphism" title="sage.modules.with_basis.morphism.TriangularModuleMorphism"><code class="xref py py-class docutils literal notranslate"><span class="pre">TriangularModuleMorphism</span></code></a>.</p></li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">on_basis</span></code> may alternatively be provided in derived classes
by passing <code class="docutils literal notranslate"><span class="pre">None</span></code> as argument, and implementing or setting
the attribute <code class="docutils literal notranslate"><span class="pre">_on_basis</span></code></p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.modules.with_basis.morphism.ModuleMorphismByLinearity.on_basis">
<span class="sig-name descname"><span class="pre">on_basis</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modules.with_basis.morphism.ModuleMorphismByLinearity.on_basis" title="Link to this definition">#</a></dt>
<dd><p>Return the action of this morphism on basis elements, as per
<code class="xref py py-meth docutils literal notranslate"><span class="pre">ModulesWithBasis.Homsets.ElementMethods.on_basis()</span></code>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a function from the indices of the basis of the domain to the
codomain</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi_on_basis</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">monomial</span> <span class="o">*</span> <span class="nb">abs</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">with_basis</span><span class="o">.</span><span class="n">morphism</span><span class="o">.</span><span class="n">ModuleMorphismByLinearity</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">on_basis</span> <span class="o">=</span> <span class="n">phi_on_basis</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">Y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">on_basis</span><span class="p">()(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">B[2]</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">on_basis</span><span class="p">()</span> <span class="o">==</span> <span class="n">phi_on_basis</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.modules.with_basis.morphism.ModuleMorphismFromFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.modules.with_basis.morphism.</span></span><span class="sig-name descname"><span class="pre">ModuleMorphismFromFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">codomain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">category</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modules.with_basis.morphism.ModuleMorphismFromFunction" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.modules.with_basis.morphism.ModuleMorphism" title="sage.modules.with_basis.morphism.ModuleMorphism"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleMorphism</span></code></a>, <a class="reference external" href="../../../../categories/sage/categories/morphism.html#sage.categories.morphism.SetMorphism" title="(in Category Framework v10.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SetMorphism</span></code></a></p>
<p>A class for module morphisms implemented by a plain function.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">domain</span></code>, <code class="docutils literal notranslate"><span class="pre">codomain</span></code>, <code class="docutils literal notranslate"><span class="pre">category</span></code> – as for <a class="reference internal" href="#sage.modules.with_basis.morphism.ModuleMorphism" title="sage.modules.with_basis.morphism.ModuleMorphism"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleMorphism</span></code></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">function</span></code> – any function or callable from domain to codomain</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="../../../../categories/sage/categories/modules_with_basis.html#sage.categories.modules_with_basis.ModulesWithBasis.ParentMethods.module_morphism" title="(in Category Framework v10.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ModulesWithBasis.ParentMethods.module_morphism()</span></code></a> for
usage information and examples;</p></li>
<li><p><a class="reference internal" href="#module-sage.modules.with_basis.morphism" title="sage.modules.with_basis.morphism"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.modules.with_basis.morphism</span></code></a> for a technical
overview of the classes for module morphisms;</p></li>
<li><p><a class="reference internal" href="#sage.modules.with_basis.morphism.ModuleMorphismFromFunction" title="sage.modules.with_basis.morphism.ModuleMorphismFromFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleMorphismFromFunction</span></code></a> and
<a class="reference internal" href="#sage.modules.with_basis.morphism.TriangularModuleMorphism" title="sage.modules.with_basis.morphism.TriangularModuleMorphism"><code class="xref py py-class docutils literal notranslate"><span class="pre">TriangularModuleMorphism</span></code></a>.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.modules.with_basis.morphism.ModuleMorphismFromMatrix">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.modules.with_basis.morphism.</span></span><span class="sig-name descname"><span class="pre">ModuleMorphismFromMatrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">codomain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">category</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">side</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'left'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modules.with_basis.morphism.ModuleMorphismFromMatrix" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.modules.with_basis.morphism.ModuleMorphismByLinearity" title="sage.modules.with_basis.morphism.ModuleMorphismByLinearity"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleMorphismByLinearity</span></code></a></p>
<p>A class for module morphisms built from a matrix in the
distinguished bases of the domain and codomain.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="../../../../categories/sage/categories/modules_with_basis.html#sage.categories.modules_with_basis.ModulesWithBasis.ParentMethods.module_morphism" title="(in Category Framework v10.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ModulesWithBasis.ParentMethods.module_morphism()</span></code></a></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">ModulesWithBasis.FiniteDimensional.MorphismMethods.matrix()</span></code></p></li>
</ul>
</div>
<p>INPUT:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">domain</span></code>, <code class="docutils literal notranslate"><span class="pre">codomain</span></code> – two finite dimensional modules over
the same base ring <span class="math notranslate nohighlight">\(R\)</span> with basis <span class="math notranslate nohighlight">\(F\)</span> and <span class="math notranslate nohighlight">\(G\)</span>, respectively</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">matrix</span></code> – a matrix with base ring <span class="math notranslate nohighlight">\(R\)</span> and dimensions
matching that of <span class="math notranslate nohighlight">\(F\)</span> and <span class="math notranslate nohighlight">\(G\)</span>, respectively</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">side</span></code> – “left” or “right” (default: “left”)</p>
<blockquote>
<div><p>If <code class="docutils literal notranslate"><span class="pre">side</span></code> is “left”, this morphism is considered as
acting on the left; i.e. each column of the matrix
represents the image of an element of the basis of the
domain.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">category</span></code> – a category or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]);</span> <span class="n">X</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">);</span> <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]);</span> <span class="n">Y</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;Y&quot;</span><span class="p">);</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">module_morphism</span><span class="p">(</span><span class="n">matrix</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">Y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Set of Morphisms from X to Y in Category of finite dimensional modules with basis over Integer Ring</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="vm">__class__</span>
<span class="go">&lt;class &#39;sage.modules.with_basis.morphism.ModuleMorphismFromMatrix_with_category&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">B[3] + 3*B[4]</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">2*B[3] + 5*B[4]</span>

<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">module_morphism</span><span class="p">(</span><span class="n">matrix</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span>
<span class="gp">....: </span>                        <span class="n">category</span><span class="o">=</span><span class="n">Modules</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span><span class="o">.</span><span class="n">WithBasis</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Set of Morphisms from X to Y</span>
<span class="go">in Category of modules with basis over Integer Ring</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">B[3] + 2*B[4]</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">3*B[3] + 5*B[4]</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p>Possibly implement rank, addition, multiplication, matrix,
etc, from the stored matrix.</p>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.modules.with_basis.morphism.PointwiseInverseFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.modules.with_basis.morphism.</span></span><span class="sig-name descname"><span class="pre">PointwiseInverseFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modules.with_basis.morphism.PointwiseInverseFunction" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Parents and Elements v10.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SageObject</span></code></a></p>
<p>A class for pointwise inverse functions.</p>
<p>The pointwise inverse function of a function <span class="math notranslate nohighlight">\(f\)</span> is the function
sending every <span class="math notranslate nohighlight">\(x\)</span> to <span class="math notranslate nohighlight">\(1 / f(x)\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modules.with_basis.morphism</span> <span class="kn">import</span> <span class="n">PointwiseInverseFunction</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">PointwiseInverseFunction</span><span class="p">(</span><span class="n">factorial</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">f</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(1, 1, 1/2, 1/6)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.modules.with_basis.morphism.PointwiseInverseFunction.pointwise_inverse">
<span class="sig-name descname"><span class="pre">pointwise_inverse</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modules.with_basis.morphism.PointwiseInverseFunction.pointwise_inverse" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.modules.with_basis.morphism.TriangularModuleMorphism">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.modules.with_basis.morphism.</span></span><span class="sig-name descname"><span class="pre">TriangularModuleMorphism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">triangular='upper'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unitriangular=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inverse=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inverse_on_support=&lt;built-in</span> <span class="pre">function</span> <span class="pre">identity&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invertible=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modules.with_basis.morphism.TriangularModuleMorphism" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.modules.with_basis.morphism.ModuleMorphism" title="sage.modules.with_basis.morphism.ModuleMorphism"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleMorphism</span></code></a></p>
<p>An abstract class for triangular module morphisms</p>
<p>Let <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> be modules over the same base ring, with
distinguished bases <span class="math notranslate nohighlight">\(F\)</span> indexed by <span class="math notranslate nohighlight">\(I\)</span> and <span class="math notranslate nohighlight">\(G\)</span> indexed by <span class="math notranslate nohighlight">\(J\)</span>,
respectively.</p>
<p>A module morphism <span class="math notranslate nohighlight">\(\phi\)</span> from <span class="math notranslate nohighlight">\(X\)</span> to <span class="math notranslate nohighlight">\(Y\)</span> is <em>triangular</em> if its
representing matrix in the distinguished bases of <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> is
upper triangular (echelon form).</p>
<p>More precisely, <span class="math notranslate nohighlight">\(\phi\)</span> is <em>upper triangular</em> w.r.t. a total order
<span class="math notranslate nohighlight">\(&lt;\)</span> on <span class="math notranslate nohighlight">\(J\)</span> if, for any <span class="math notranslate nohighlight">\(j\in J\)</span>, there exists at most one index
<span class="math notranslate nohighlight">\(i\in I\)</span> such that the leading support of <span class="math notranslate nohighlight">\(\phi(F_i)\)</span> is <span class="math notranslate nohighlight">\(j\)</span> (see
<code class="xref py py-meth docutils literal notranslate"><span class="pre">leading_support()</span></code>). We denote by <span class="math notranslate nohighlight">\(r(j)\)</span> this index,
setting <span class="math notranslate nohighlight">\(r(j)\)</span> to <code class="docutils literal notranslate"><span class="pre">None</span></code> if it does not exist.</p>
<p><em>Lower triangular</em> morphisms are defined similarly, taking the
trailing support instead (see <code class="xref py py-meth docutils literal notranslate"><span class="pre">trailing_support()</span></code>).</p>
<p>A triangular morphism is <em>unitriangular</em> if all its pivots
(i.e. coefficient of <span class="math notranslate nohighlight">\(j\)</span> in each <span class="math notranslate nohighlight">\(\phi(F[r(j)])\)</span>) are <span class="math notranslate nohighlight">\(1\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">domain</span></code> – a module with basis <span class="math notranslate nohighlight">\(X\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">codomain</span></code> – a module with basis <span class="math notranslate nohighlight">\(Y\)</span> (default: <span class="math notranslate nohighlight">\(X\)</span>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">category</span></code> – a category, as for <a class="reference internal" href="#sage.modules.with_basis.morphism.ModuleMorphism" title="sage.modules.with_basis.morphism.ModuleMorphism"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleMorphism</span></code></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">triangular</span></code> – <code class="docutils literal notranslate"><span class="pre">&quot;upper&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;lower&quot;</span></code> (default: <code class="docutils literal notranslate"><span class="pre">&quot;upper&quot;</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">unitriangular</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)
As a shorthand, one may use <code class="docutils literal notranslate"><span class="pre">unitriangular=&quot;lower&quot;</span></code>
for <code class="docutils literal notranslate"><span class="pre">triangular=&quot;lower&quot;,</span> <span class="pre">unitriangular=True</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key</span></code> – a comparison key on <span class="math notranslate nohighlight">\(J\)</span>
(default: the usual comparison of elements of <span class="math notranslate nohighlight">\(J\)</span>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inverse_on_support</span></code> – a function <span class="math notranslate nohighlight">\(J \to I\cup \{None\}\)</span>
implementing <span class="math notranslate nohighlight">\(r\)</span> (default: the identity function).
If set to “compute”, the values of <span class="math notranslate nohighlight">\(r(j)\)</span> are precomputed by
running through the index set <span class="math notranslate nohighlight">\(I\)</span> of the basis of the
domain. This of course requires the domain to be finite
dimensional.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">invertible</span></code> – a boolean or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); can
be set to specify that <span class="math notranslate nohighlight">\(\phi\)</span> is known to be (or not to be)
invertible. If the domain and codomain share the same indexing
set, this is by default automatically set to <code class="docutils literal notranslate"><span class="pre">True</span></code> if
<code class="docutils literal notranslate"><span class="pre">inverse_on_support</span></code> is the identity, or in the finite
dimensional case.</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="../../../../categories/sage/categories/modules_with_basis.html#sage.categories.modules_with_basis.ModulesWithBasis.ParentMethods.module_morphism" title="(in Category Framework v10.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ModulesWithBasis.ParentMethods.module_morphism()</span></code></a> for
usage information and examples;</p></li>
<li><p><a class="reference internal" href="#module-sage.modules.with_basis.morphism" title="sage.modules.with_basis.morphism"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.modules.with_basis.morphism</span></code></a> for a technical
overview of the classes for module morphisms;</p></li>
<li><p><a class="reference internal" href="#sage.modules.with_basis.morphism.ModuleMorphismFromFunction" title="sage.modules.with_basis.morphism.ModuleMorphismFromFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleMorphismFromFunction</span></code></a> and
<a class="reference internal" href="#sage.modules.with_basis.morphism.TriangularModuleMorphism" title="sage.modules.with_basis.morphism.TriangularModuleMorphism"><code class="xref py py-class docutils literal notranslate"><span class="pre">TriangularModuleMorphism</span></code></a>.</p></li>
</ul>
</div>
<p>OUTPUT:</p>
<p>A morphism from <span class="math notranslate nohighlight">\(X\)</span> to <span class="math notranslate nohighlight">\(Y\)</span>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This class is meant to be used as a complement for a concrete
morphism class.  In particular, the <code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code> method
focuses on setting up the data structure describing the
triangularity of the morphism. It purposely does <em>not</em> call
<code class="xref py py-meth docutils literal notranslate"><span class="pre">ModuleMorphism.__init__()</span></code> which should be called
(directly or indirectly) beforehand.</p>
</div>
<p>EXAMPLES:</p>
<p>We construct and invert an upper unitriangular module morphism between
two free <span class="math notranslate nohighlight">\(\QQ\)</span>-modules:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="n">I</span><span class="p">);</span> <span class="n">X</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">);</span> <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="n">I</span><span class="p">);</span> <span class="n">Y</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;Y&quot;</span><span class="p">);</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">ut</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">sum_of_monomials</span> <span class="o">*</span> <span class="n">divisors</span>   <span class="c1"># This * is map composition.</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">module_morphism</span><span class="p">(</span><span class="n">ut</span><span class="p">,</span> <span class="n">unitriangular</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">Y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">B[1] + B[2]</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
<span class="go">B[1] + B[2] + B[3] + B[6]</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">30</span><span class="p">])</span>
<span class="go">B[1] + B[2] + B[3] + B[5] + B[6] + B[10] + B[15] + B[30]</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">preimage</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">-B[1] + B[2]</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">preimage</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
<span class="go">B[1] - B[2] - B[3] + B[6]</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">preimage</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">30</span><span class="p">])</span>
<span class="go">-B[1] + B[2] + B[3] + B[5] - B[6] - B[10] - B[15] + B[30]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">phi</span><span class="o">^-</span><span class="mi">1</span><span class="p">)(</span><span class="n">y</span><span class="p">[</span><span class="mi">30</span><span class="p">])</span>
<span class="go">-B[1] + B[2] + B[3] + B[5] - B[6] - B[10] - B[15] + B[30]</span>
</pre></div>
</div>
<p>A lower triangular (but not unitriangular) morphism:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]);</span> <span class="n">X</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">);</span> <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">def</span> <span class="nf">lt</span><span class="p">(</span><span class="n">i</span><span class="p">):</span> <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">j</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">module_morphism</span><span class="p">(</span><span class="n">lt</span><span class="p">,</span> <span class="n">triangular</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">2*B[2] + 3*B[3]</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">preimage</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">1/2*B[2] - 1/2*B[3]</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">phi</span><span class="o">.</span><span class="n">preimage</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
<span class="go">B[2]</span>
</pre></div>
</div>
<p>Using the <code class="docutils literal notranslate"><span class="pre">key</span></code> keyword, we can use triangularity even if
the map becomes triangular only after a permutation of the basis:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]);</span> <span class="n">X</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">);</span> <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">def</span> <span class="nf">ut</span><span class="p">(</span><span class="n">i</span><span class="p">):</span> <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">3</span> <span class="k">else</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">perm</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">module_morphism</span><span class="p">(</span><span class="n">ut</span><span class="p">,</span> <span class="n">triangular</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
<span class="gp">....: </span>                        <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">perm</span><span class="p">[</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">phi</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)]</span>
<span class="go">[B[1] + B[2], B[2], B[2] + B[3]]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">phi</span><span class="o">.</span><span class="n">preimage</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)]</span>
<span class="go">[B[1] - B[2], B[2], -B[2] + B[3]]</span>
</pre></div>
</div>
<p>The same works in the lower-triangular case:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">def</span> <span class="nf">lt</span><span class="p">(</span><span class="n">i</span><span class="p">):</span> <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">module_morphism</span><span class="p">(</span><span class="n">lt</span><span class="p">,</span> <span class="n">triangular</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
<span class="gp">....: </span>                        <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">perm</span><span class="p">[</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">phi</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)]</span>
<span class="go">[B[1], B[1] + B[2] + B[3], B[3]]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">phi</span><span class="o">.</span><span class="n">preimage</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)]</span>
<span class="go">[B[1], -B[1] + B[2] - B[3], B[3]]</span>
</pre></div>
</div>
<p>An injective but not surjective morphism cannot be inverted,
but the <code class="docutils literal notranslate"><span class="pre">inverse_on_support</span></code> keyword allows Sage to find a
partial inverse:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span> <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]);</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">ult</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span>  <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>  <span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">module_morphism</span><span class="p">(</span><span class="n">ult</span><span class="p">,</span> <span class="n">unitriangular</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span>
<span class="gp">....: </span>       <span class="n">inverse_on_support</span><span class="o">=</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">B[3] + B[4] + B[5]</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">preimage</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="go">B[2] - B[3]</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">inverse_on_support</span></code> keyword can also be used if the
bases of the domain and the codomain are identical but one of
them has to be permuted in order to render the morphism
triangular. For example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]);</span> <span class="n">X</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">);</span> <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">def</span> <span class="nf">ut</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">2</span>
<span class="gp">....: </span>            <span class="k">else</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="k">def</span> <span class="nf">perm</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="k">return</span> <span class="p">(</span><span class="mi">2</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">3</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">module_morphism</span><span class="p">(</span><span class="n">ut</span><span class="p">,</span> <span class="n">triangular</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
<span class="gp">....: </span>                        <span class="n">inverse_on_support</span><span class="o">=</span><span class="n">perm</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">phi</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)]</span>
<span class="go">[B[3], B[1], B[1] + B[2]]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">phi</span><span class="o">.</span><span class="n">preimage</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)]</span>
<span class="go">[B[2], -B[2] + B[3], B[1]]</span>
</pre></div>
</div>
<p>The same works if the permutation induces lower triangularity:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]);</span> <span class="n">X</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">);</span> <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">def</span> <span class="nf">lt</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">2</span>
<span class="gp">....: </span>            <span class="k">else</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="k">def</span> <span class="nf">perm</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="k">return</span> <span class="mi">4</span> <span class="o">-</span> <span class="n">i</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">module_morphism</span><span class="p">(</span><span class="n">lt</span><span class="p">,</span> <span class="n">triangular</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
<span class="gp">....: </span>                        <span class="n">inverse_on_support</span><span class="o">=</span><span class="n">perm</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">phi</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)]</span>
<span class="go">[B[3], B[2], B[1] + B[2]]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">phi</span><span class="o">.</span><span class="n">preimage</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)]</span>
<span class="go">[-B[2] + B[3], B[2], B[1]]</span>
</pre></div>
</div>
<p>In the finite dimensional case, one can ask Sage to recover
<code class="docutils literal notranslate"><span class="pre">inverse_on_support</span></code> by a precomputation:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]);</span> <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]);</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">ut</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span>  <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">module_morphism</span><span class="p">(</span><span class="n">ut</span><span class="p">,</span> <span class="n">triangular</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span>
<span class="gp">....: </span>                        <span class="n">inverse_on_support</span><span class="o">=</span><span class="s2">&quot;compute&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">tx</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">Y</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<span class="gp">....: </span>    <span class="n">i</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">_inverse_on_support</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="nb">print</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">phi</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">))</span>
<span class="go">1 None None</span>
<span class="go">2 1 B[1] + B[2]</span>
<span class="go">3 2 B[1] + B[2] + B[3]</span>
<span class="go">4 3 B[1] + B[2] + B[3] + B[4]</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">inverse_on_basis</span></code> and <code class="docutils literal notranslate"><span class="pre">key</span></code> keywords can be combined:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]);</span> <span class="n">X</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">def</span> <span class="nf">ut</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="k">return</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">....: </span>            <span class="k">else</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">2</span>
<span class="gp">....: </span>            <span class="k">else</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="k">def</span> <span class="nf">perm</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="k">return</span> <span class="p">(</span><span class="mi">2</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">3</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">perverse_key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">module_morphism</span><span class="p">(</span><span class="n">ut</span><span class="p">,</span> <span class="n">triangular</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
<span class="gp">....: </span>                        <span class="n">inverse_on_support</span><span class="o">=</span><span class="n">perm</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">perverse_key</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">phi</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)]</span>
<span class="go">[2*B[2] + 3*B[3], B[1] + B[2] + B[3], 4*B[2]]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">phi</span><span class="o">.</span><span class="n">preimage</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)]</span>
<span class="go">[-1/3*B[1] + B[2] - 1/12*B[3], 1/4*B[3], 1/3*B[1] - 1/6*B[3]]</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.modules.with_basis.morphism.TriangularModuleMorphism.cokernel_basis_indices">
<span class="sig-name descname"><span class="pre">cokernel_basis_indices</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modules.with_basis.morphism.TriangularModuleMorphism.cokernel_basis_indices" title="Link to this definition">#</a></dt>
<dd><p>Return the indices of the natural monomial basis of the cokernel of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – a triangular morphism over a field or a
unitriangular morphism over a ring, with a finite
dimensional codomain.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A list <span class="math notranslate nohighlight">\(E\)</span> of indices of the basis <span class="math notranslate nohighlight">\((B_e)_e\)</span> of the codomain
of <code class="docutils literal notranslate"><span class="pre">self</span></code> so that <span class="math notranslate nohighlight">\((B_e)_{e\in E}\)</span> forms a basis of a
supplementary of the image set of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>Thinking of this triangular morphism as a row echelon matrix,
this returns the complementary of the characteristic
columns. Namely <span class="math notranslate nohighlight">\(E\)</span> is the set of indices which do not appear
as leading support of some element of the image set of
<code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span> <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]);</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">uut</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span>  <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>  <span class="p">)</span> <span class="c1"># uni-upper</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">module_morphism</span><span class="p">(</span><span class="n">uut</span><span class="p">,</span> <span class="n">unitriangular</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span>
<span class="gp">....: </span>      <span class="n">inverse_on_support</span><span class="o">=</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">cokernel_basis_indices</span><span class="p">()</span>
<span class="go">[1, 5]</span>

<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">module_morphism</span><span class="p">(</span><span class="n">uut</span><span class="p">,</span> <span class="n">triangular</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span>
<span class="gp">....: </span>      <span class="n">inverse_on_support</span><span class="o">=</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">cokernel_basis_indices</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError: cokernel_basis_indices for a triangular but not unitriangular morphism over a ring</span>

<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">NN</span><span class="p">);</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">module_morphism</span><span class="p">(</span><span class="n">uut</span><span class="p">,</span> <span class="n">unitriangular</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span>
<span class="gp">....: </span>      <span class="n">inverse_on_support</span><span class="o">=</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">cokernel_basis_indices</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError: cokernel_basis_indices implemented only for morphisms with a finite dimensional codomain</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modules.with_basis.morphism.TriangularModuleMorphism.cokernel_projection">
<span class="sig-name descname"><span class="pre">cokernel_projection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">category</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modules.with_basis.morphism.TriangularModuleMorphism.cokernel_projection" title="Link to this definition">#</a></dt>
<dd><p>Return a projection on the co-kernel of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">category</span></code> – the category of the result</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span> <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]);</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">lt</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span>  <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>  <span class="p">)</span> <span class="c1"># lower</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">module_morphism</span><span class="p">(</span><span class="n">lt</span><span class="p">,</span> <span class="n">triangular</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span>
<span class="gp">....: </span>     <span class="n">inverse_on_support</span><span class="o">=</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phipro</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">cokernel_projection</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phipro</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">B[1]</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">phipro</span><span class="p">(</span><span class="n">phi</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">basis</span><span class="p">())</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phipro</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">B[1]</span>
<span class="gp">sage: </span><span class="n">phipro</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<span class="go">-B[5]</span>
<span class="gp">sage: </span><span class="n">phipro</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
<span class="go">B[5]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modules.with_basis.morphism.TriangularModuleMorphism.coreduced">
<span class="sig-name descname"><span class="pre">coreduced</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modules.with_basis.morphism.TriangularModuleMorphism.coreduced" title="Link to this definition">#</a></dt>
<dd><p>Return <span class="math notranslate nohighlight">\(y\)</span> reduced w.r.t. the image of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – a triangular morphism over a field, or a
unitriangular morphism over a ring</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code> – an element of the codomain of <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
</ul>
<p>Suppose that <code class="docutils literal notranslate"><span class="pre">self</span></code> is a morphism from <span class="math notranslate nohighlight">\(X\)</span> to <span class="math notranslate nohighlight">\(Y\)</span>. Then, for
any <span class="math notranslate nohighlight">\(y \in Y\)</span>, the call <code class="docutils literal notranslate"><span class="pre">self.coreduced(y)</span></code> returns a
normal form for <span class="math notranslate nohighlight">\(y\)</span> in the quotient <span class="math notranslate nohighlight">\(Y / I\)</span> where <span class="math notranslate nohighlight">\(I\)</span> is the
image of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span> <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]);</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">ult</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span>  <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>  <span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">module_morphism</span><span class="p">(</span><span class="n">ult</span><span class="p">,</span> <span class="n">unitriangular</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span>
<span class="gp">....: </span>       <span class="n">inverse_on_support</span><span class="o">=</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">phi</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">basis</span><span class="p">()]</span>
<span class="go">[B[2] + B[3] + B[4] + B[5],</span>
<span class="go">        B[3] + B[4] + B[5],</span>
<span class="go">               B[4] + B[5]]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">phi</span><span class="o">.</span><span class="n">coreduced</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">4</span><span class="p">])]</span>
<span class="go">[B[1] + 2*B[5]]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">phi</span><span class="o">.</span><span class="n">coreduced</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">y</span><span class="p">]</span>
<span class="go">[B[1], 0, 0, -B[5], B[5]]</span>
</pre></div>
</div>
<p>Now with a non unitriangular morphism:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">lt</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span> <span class="n">j</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>  <span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">module_morphism</span><span class="p">(</span><span class="n">lt</span><span class="p">,</span> <span class="n">triangular</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span>
<span class="gp">....: </span>      <span class="n">inverse_on_support</span><span class="o">=</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">phi</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">basis</span><span class="p">()]</span>
<span class="go">[2*B[2] + 3*B[3] + 4*B[4] + 5*B[5],</span>
<span class="go">          3*B[3] + 4*B[4] + 5*B[5],</span>
<span class="go">                   4*B[4] + 5*B[5]]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">phi</span><span class="o">.</span><span class="n">coreduced</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">4</span><span class="p">])]</span>
<span class="go">[B[1] + 5/2*B[5]]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">phi</span><span class="o">.</span><span class="n">coreduced</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">y</span><span class="p">]</span>
<span class="go">[B[1], 0, 0, -5/4*B[5], B[5]]</span>
</pre></div>
</div>
<p>For general rings, this method is only implemented for
unitriangular morphisms:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span> <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]);</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">module_morphism</span><span class="p">(</span><span class="n">ult</span><span class="p">,</span> <span class="n">unitriangular</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span>
<span class="gp">....: </span>      <span class="n">inverse_on_support</span><span class="o">=</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">phi</span><span class="o">.</span><span class="n">coreduced</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">4</span><span class="p">])]</span>
<span class="go">[B[1] + 2*B[5]]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">phi</span><span class="o">.</span><span class="n">coreduced</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">y</span><span class="p">]</span>
<span class="go">[B[1], 0, 0, -B[5], B[5]]</span>

<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">module_morphism</span><span class="p">(</span><span class="n">lt</span><span class="p">,</span> <span class="n">triangular</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span>
<span class="gp">....: </span>      <span class="n">inverse_on_support</span><span class="o">=</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">phi</span><span class="o">.</span><span class="n">coreduced</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">y</span><span class="p">]</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError: coreduce for a triangular but not unitriangular morphism over a ring</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Before <a class="reference external" href="https://github.com/sagemath/sage/issues/8678">github issue #8678</a> this method used to be called co_reduced.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modules.with_basis.morphism.TriangularModuleMorphism.preimage">
<span class="sig-name descname"><span class="pre">preimage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modules.with_basis.morphism.TriangularModuleMorphism.preimage" title="Link to this definition">#</a></dt>
<dd><p>Return the preimage of <span class="math notranslate nohighlight">\(f\)</span> under <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]);</span> <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]);</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">ult</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span>  <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>  <span class="p">)</span> <span class="c1"># uni-lower</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">module_morphism</span><span class="p">(</span><span class="n">ult</span><span class="p">,</span> <span class="n">triangular</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">Y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">preimage</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">B[1] - B[3]</span>
</pre></div>
</div>
<p>The morphism need not be surjective. In the following example,
the codomain is of larger dimension than the domain:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]);</span> <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]);</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">lt</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span>  <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>  <span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">module_morphism</span><span class="p">(</span><span class="n">lt</span><span class="p">,</span> <span class="n">triangular</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">Y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">preimage</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">B[1] - B[3]</span>
</pre></div>
</div>
<p>Here are examples using <code class="docutils literal notranslate"><span class="pre">inverse_on_support</span></code> to handle a
morphism that shifts the leading indices by <span class="math notranslate nohighlight">\(1\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]);</span> <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]);</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">lt</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span>  <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>  <span class="p">)</span> <span class="c1"># lower</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">module_morphism</span><span class="p">(</span><span class="n">lt</span><span class="p">,</span> <span class="n">triangular</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span>
<span class="gp">....: </span>        <span class="n">inverse_on_support</span><span class="o">=</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">B[2] + B[3] + B[4] + B[5]</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="go">B[4] + B[5]</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">preimage</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="go">B[1] - B[3]</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">phi</span><span class="o">.</span><span class="n">preimage</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span> <span class="o">==</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">el</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">preimage</span><span class="p">(</span><span class="n">phi</span><span class="p">(</span><span class="n">el</span><span class="p">))</span> <span class="o">==</span> <span class="n">el</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">preimage</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: B[1] is not in the image</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">preimage</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: B[4] is not in the image</span>
</pre></div>
</div>
<p>Over a base ring like <span class="math notranslate nohighlight">\(\ZZ\)</span>, the morphism need not be
surjective even when the dimensions match:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]);</span> <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]);</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">lt</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span> <span class="mi">2</span><span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>  <span class="p">)</span> <span class="c1"># lower</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">module_morphism</span><span class="p">(</span><span class="n">lt</span><span class="p">,</span> <span class="n">triangular</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">Y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">preimage</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">B[1] - B[3]</span>
</pre></div>
</div>
<p>The error message in case of failure could be more specific though:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">preimage</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">  ...</span>
<span class="go">TypeError: no conversion of this rational to integer</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modules.with_basis.morphism.TriangularModuleMorphism.section">
<span class="sig-name descname"><span class="pre">section</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modules.with_basis.morphism.TriangularModuleMorphism.section" title="Link to this definition">#</a></dt>
<dd><p>Return the section (partial inverse) of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>This returns a partial triangular morphism which is a section of
<code class="docutils literal notranslate"><span class="pre">self</span></code>. The section morphism raises a <a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ValueError</span></code></a> if
asked to apply on an element which is not in the image of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span> <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">CombinatorialFreeModule</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]);</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">ult</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span>  <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>  <span class="p">)</span> <span class="c1"># uni-lower</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">module_morphism</span><span class="p">(</span><span class="n">ult</span><span class="p">,</span> <span class="n">triangular</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span>
<span class="gp">....: </span>     <span class="n">inverse_on_support</span><span class="o">=</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
<span class="gp">sage: </span><span class="o">~</span><span class="n">phi</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Morphism not known to be invertible;</span>
<span class="go">see the invertible option of module_morphism</span>
<span class="gp">sage: </span><span class="n">phiinv</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">section</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">phiinv</span><span class="o">*</span><span class="n">phi</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span><span class="o">.</span><span class="n">list</span><span class="p">()))</span> <span class="o">==</span> <span class="n">X</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phiinv</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">basis</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: B[1] is not in the image</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.modules.with_basis.morphism.TriangularModuleMorphismByLinearity">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.modules.with_basis.morphism.</span></span><span class="sig-name descname"><span class="pre">TriangularModuleMorphismByLinearity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_basis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">codomain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">category</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">keywords</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modules.with_basis.morphism.TriangularModuleMorphismByLinearity" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.modules.with_basis.morphism.ModuleMorphismByLinearity" title="sage.modules.with_basis.morphism.ModuleMorphismByLinearity"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleMorphismByLinearity</span></code></a>, <a class="reference internal" href="#sage.modules.with_basis.morphism.TriangularModuleMorphism" title="sage.modules.with_basis.morphism.TriangularModuleMorphism"><code class="xref py py-class docutils literal notranslate"><span class="pre">TriangularModuleMorphism</span></code></a></p>
<p>A concrete class for triangular module morphisms obtained by extending a function by linearity.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="../../../../categories/sage/categories/modules_with_basis.html#sage.categories.modules_with_basis.ModulesWithBasis.ParentMethods.module_morphism" title="(in Category Framework v10.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ModulesWithBasis.ParentMethods.module_morphism()</span></code></a> for
usage information and examples;</p></li>
<li><p><a class="reference internal" href="#module-sage.modules.with_basis.morphism" title="sage.modules.with_basis.morphism"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.modules.with_basis.morphism</span></code></a> for a technical
overview of the classes for module morphisms;</p></li>
<li><p><a class="reference internal" href="#sage.modules.with_basis.morphism.ModuleMorphismByLinearity" title="sage.modules.with_basis.morphism.ModuleMorphismByLinearity"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleMorphismByLinearity</span></code></a> and
<a class="reference internal" href="#sage.modules.with_basis.morphism.TriangularModuleMorphism" title="sage.modules.with_basis.morphism.TriangularModuleMorphism"><code class="xref py py-class docutils literal notranslate"><span class="pre">TriangularModuleMorphism</span></code></a>.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.modules.with_basis.morphism.TriangularModuleMorphismFromFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.modules.with_basis.morphism.</span></span><span class="sig-name descname"><span class="pre">TriangularModuleMorphismFromFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">codomain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">category</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">keywords</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modules.with_basis.morphism.TriangularModuleMorphismFromFunction" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.modules.with_basis.morphism.ModuleMorphismFromFunction" title="sage.modules.with_basis.morphism.ModuleMorphismFromFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleMorphismFromFunction</span></code></a>, <a class="reference internal" href="#sage.modules.with_basis.morphism.TriangularModuleMorphism" title="sage.modules.with_basis.morphism.TriangularModuleMorphism"><code class="xref py py-class docutils literal notranslate"><span class="pre">TriangularModuleMorphism</span></code></a></p>
<p>A concrete class for triangular module morphisms implemented by a function.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="../../../../categories/sage/categories/modules_with_basis.html#sage.categories.modules_with_basis.ModulesWithBasis.ParentMethods.module_morphism" title="(in Category Framework v10.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ModulesWithBasis.ParentMethods.module_morphism()</span></code></a> for
usage information and examples;</p></li>
<li><p><a class="reference internal" href="#module-sage.modules.with_basis.morphism" title="sage.modules.with_basis.morphism"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.modules.with_basis.morphism</span></code></a> for a technical
overview of the classes for module morphisms;</p></li>
<li><p><a class="reference internal" href="#sage.modules.with_basis.morphism.ModuleMorphismFromFunction" title="sage.modules.with_basis.morphism.ModuleMorphismFromFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleMorphismFromFunction</span></code></a> and
<a class="reference internal" href="#sage.modules.with_basis.morphism.TriangularModuleMorphism" title="sage.modules.with_basis.morphism.TriangularModuleMorphism"><code class="xref py py-class docutils literal notranslate"><span class="pre">TriangularModuleMorphism</span></code></a>.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.modules.with_basis.morphism.pointwise_inverse_function">
<span class="sig-prename descclassname"><span class="pre">sage.modules.with_basis.morphism.</span></span><span class="sig-name descname"><span class="pre">pointwise_inverse_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modules.with_basis.morphism.pointwise_inverse_function" title="Link to this definition">#</a></dt>
<dd><p>Return the function <span class="math notranslate nohighlight">\(x \mapsto 1 / f(x)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> – a function</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modules.with_basis.morphism</span> <span class="kn">import</span> <span class="n">pointwise_inverse_function</span>
<span class="gp">sage: </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">pointwise_inverse_function</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">g</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">g</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(1, 1/2, 1/3)</span>
</pre></div>
</div>
<p><a class="reference internal" href="#sage.modules.with_basis.morphism.pointwise_inverse_function" title="sage.modules.with_basis.morphism.pointwise_inverse_function"><code class="xref py py-func docutils literal notranslate"><span class="pre">pointwise_inverse_function()</span></code></a> is an involution:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="ow">is</span> <span class="n">pointwise_inverse_function</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="id3">
<p class="admonition-title">Todo</p>
<p>This has nothing to do here!!! Should there be a library for
pointwise operations on functions somewhere in Sage?</p>
</div>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="subquotient.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Quotients of modules with basis</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="invariant.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Invariant modules</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2024, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Morphisms of modules with a basis</a><ul>
<li><a class="reference internal" href="#sage.modules.with_basis.morphism.DiagonalModuleMorphism"><code class="docutils literal notranslate"><span class="pre">DiagonalModuleMorphism</span></code></a></li>
<li><a class="reference internal" href="#sage.modules.with_basis.morphism.ModuleMorphism"><code class="docutils literal notranslate"><span class="pre">ModuleMorphism</span></code></a></li>
<li><a class="reference internal" href="#sage.modules.with_basis.morphism.ModuleMorphismByLinearity"><code class="docutils literal notranslate"><span class="pre">ModuleMorphismByLinearity</span></code></a><ul>
<li><a class="reference internal" href="#sage.modules.with_basis.morphism.ModuleMorphismByLinearity.on_basis"><code class="docutils literal notranslate"><span class="pre">on_basis()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.modules.with_basis.morphism.ModuleMorphismFromFunction"><code class="docutils literal notranslate"><span class="pre">ModuleMorphismFromFunction</span></code></a></li>
<li><a class="reference internal" href="#sage.modules.with_basis.morphism.ModuleMorphismFromMatrix"><code class="docutils literal notranslate"><span class="pre">ModuleMorphismFromMatrix</span></code></a></li>
<li><a class="reference internal" href="#sage.modules.with_basis.morphism.PointwiseInverseFunction"><code class="docutils literal notranslate"><span class="pre">PointwiseInverseFunction</span></code></a><ul>
<li><a class="reference internal" href="#sage.modules.with_basis.morphism.PointwiseInverseFunction.pointwise_inverse"><code class="docutils literal notranslate"><span class="pre">pointwise_inverse()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.modules.with_basis.morphism.TriangularModuleMorphism"><code class="docutils literal notranslate"><span class="pre">TriangularModuleMorphism</span></code></a><ul>
<li><a class="reference internal" href="#sage.modules.with_basis.morphism.TriangularModuleMorphism.cokernel_basis_indices"><code class="docutils literal notranslate"><span class="pre">cokernel_basis_indices()</span></code></a></li>
<li><a class="reference internal" href="#sage.modules.with_basis.morphism.TriangularModuleMorphism.cokernel_projection"><code class="docutils literal notranslate"><span class="pre">cokernel_projection()</span></code></a></li>
<li><a class="reference internal" href="#sage.modules.with_basis.morphism.TriangularModuleMorphism.coreduced"><code class="docutils literal notranslate"><span class="pre">coreduced()</span></code></a></li>
<li><a class="reference internal" href="#sage.modules.with_basis.morphism.TriangularModuleMorphism.preimage"><code class="docutils literal notranslate"><span class="pre">preimage()</span></code></a></li>
<li><a class="reference internal" href="#sage.modules.with_basis.morphism.TriangularModuleMorphism.section"><code class="docutils literal notranslate"><span class="pre">section()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.modules.with_basis.morphism.TriangularModuleMorphismByLinearity"><code class="docutils literal notranslate"><span class="pre">TriangularModuleMorphismByLinearity</span></code></a></li>
<li><a class="reference internal" href="#sage.modules.with_basis.morphism.TriangularModuleMorphismFromFunction"><code class="docutils literal notranslate"><span class="pre">TriangularModuleMorphismFromFunction</span></code></a></li>
<li><a class="reference internal" href="#sage.modules.with_basis.morphism.pointwise_inverse_function"><code class="docutils literal notranslate"><span class="pre">pointwise_inverse_function()</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/scripts/furo.js"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script src="../../../../_static/tabs.js"></script>
    <script src="../../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "lcm": "\\mathop{\\operatorname{lcm}}", "dist": "\\mathrm{dist}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <script src="../../../../_static/jupyter-sphinx-furo.js"></script>
    </body>
</html>