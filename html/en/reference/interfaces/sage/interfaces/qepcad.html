<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Interface to QEPCAD &mdash; Sage Reference Manual v6.8: Interpreter Interfaces</title>
    
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '6.8',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="top" title="Sage Reference Manual v6.8: Interpreter Interfaces" href="../../index.html" />
    <link rel="next" title="Interface to Bill Hart’s Quadratic Sieve" href="qsieve.html" />
    <link rel="prev" title="Parallel Interface to the Sage interpreter" href="psage.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="qsieve.html" title="Interface to Bill Hart’s Quadratic Sieve"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="psage.html" title="Parallel Interface to the Sage interpreter"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../index.html">Interpreter Interfaces</a> &raquo;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="interface-to-qepcad">
<span id="sage-interfaces-qepcad"></span><h1>Interface to QEPCAD<a class="headerlink" href="#interface-to-qepcad" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.interfaces.qepcad"></span><hr class="docutils" />
<p>The basic function of QEPCAD is to construct cylindrical algebraic
decompositions (CADs) of <span class="math">\(\RR^k\)</span>, given a list of polynomials.  Using
this CAD, it is possible to perform quantifier elimination and formula
simplification.</p>
<p>A CAD for a set <span class="math">\(A\)</span> of <span class="math">\(k\)</span>-variate polynomials decomposes <span class="math">\(\RR^j\)</span> into
disjoint cells, for each <span class="math">\(j\)</span> in <span class="math">\(0 \leq j \leq k\)</span>.  The sign of each
polynomial in <span class="math">\(A\)</span> is constant in each cell of <span class="math">\(\RR^k\)</span>, and for each
cell in <span class="math">\(\RR^j\)</span> (<span class="math">\(j &gt; 1\)</span>), the projection of that cell into
<span class="math">\(\RR^{j-1}\)</span> is a cell of <span class="math">\(\RR^{j-1}\)</span>.  (This property makes the
decomposition &#8216;cylindrical&#8217;.)</p>
<p>Given a formula <span class="math">\(\exists x. P(a,b,x) = 0\)</span> (for a polynomial <span class="math">\(P\)</span>), and
a cylindrical algebraic decomposition for <span class="math">\(P\)</span>, we can eliminate the
quantifier (find an equivalent formula in the two variables <span class="math">\(a\)</span>, <span class="math">\(b\)</span>
without the quantifier <span class="math">\(\exists\)</span>) as follows.  For each cell <span class="math">\(C\)</span> in
<span class="math">\(\RR^2\)</span>, find the cells of <span class="math">\(\RR^3\)</span> which project to <span class="math">\(C\)</span>.  (This
collection is called the <tt class="docutils literal"><span class="pre">stack</span></tt> over <span class="math">\(C\)</span>.)  Mark <span class="math">\(C\)</span> as true if
some member of the stack has sign <span class="math">\(= 0\)</span>; otherwise, mark <span class="math">\(C\)</span> as false.
Then, construct a polynomial formula in <span class="math">\(a\)</span>, <span class="math">\(b\)</span> which specifies
exactly the true cells (this is always possible).  The same technique
works if the body of the quantifier is any boolean combination of
polynomial equalities and inequalities.</p>
<p>Formula simplification is a similar technique.  Given a formula which
describes a simple set of <span class="math">\(\RR^k\)</span> in a complicated way as a boolean
combination of polynomial equalities and inequalities, QEPCAD can
construct a CAD for the polynomials and recover a simple equivalent
formula.</p>
<p>Note that while the following documentation is tutorial in nature, and
is written for people who may not be familiar with QEPCAD, it is
documentation for the sage interface rather than for QEPCAD.  As
such, it does not cover several issues that are very important to use
QEPCAD efficiently, such as variable ordering, the efficient use of
the alternate quantifiers and <tt class="docutils literal"><span class="pre">_root_</span></tt> expressions, the
<tt class="docutils literal"><span class="pre">measure-zero-error</span></tt> command, etc.  For more information on
QEPCAD, see the online documentation at
url{<a class="reference external" href="http://www.cs.usna.edu/~qepcad/B/QEPCAD.html">http://www.cs.usna.edu/~qepcad/B/QEPCAD.html</a>} and Chris Brown&#8217;s
tutorial handout and slides from
url{<a class="reference external" href="http://www.cs.usna.edu/~wcbrown/research/ISSAC04/Tutorial.html">http://www.cs.usna.edu/~wcbrown/research/ISSAC04/Tutorial.html</a>}.
(Several of the examples in this documentation came from these
sources.)</p>
<p>The examples below require that the optional qepcad package is installed.</p>
<p>QEPCAD can be run in a fully automatic fashion, or interactively.
We first demonstrate the automatic use of QEPCAD.</p>
<p>Since sage has no built-in support for quantifiers, this interface
provides <tt class="docutils literal"><span class="pre">qepcad_formula</span></tt> which helps construct quantified
formulas in the syntax QEPCAD requires.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a,b,c,d,x,y,z&#39;</span><span class="p">)</span>
<span class="go">(a, b, c, d, x, y, z)</span>
<span class="gp">sage: </span><span class="n">qf</span> <span class="o">=</span> <span class="n">qepcad_formula</span>
</pre></div>
</div>
<p>We start with a simple example.  Consider an arbitrarily-selected
ellipse:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">ellipse</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">7</span>
</pre></div>
</div>
<p>What is the projection onto the <span class="math">\(x\)</span> axis of this ellipse?  First we
construct a formula asking this question.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">qf</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">ellipse</span> <span class="o">==</span> <span class="mi">0</span><span class="p">);</span> <span class="n">F</span>
<span class="go">(E y)[3 x^2 + 2 x y + y^2 - x + y - 7 = 0]</span>
</pre></div>
</div>
<p>Then we run qepcad to get the answer:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qepcad</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>                            <span class="c"># optional - qepcad</span>
<span class="go">8 x^2 - 8 x - 29 &lt;= 0</span>
</pre></div>
</div>
<p>How about the projection onto the <span class="math">\(y\)</span> axis?</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qepcad</span><span class="p">(</span><span class="n">qf</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ellipse</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span>   <span class="c"># optional - qepcad</span>
<span class="go">8 y^2 + 16 y - 85 &lt;= 0</span>
</pre></div>
</div>
<p>QEPCAD deals with more quantifiers than just &#8216;exists&#8217;, of course.
Besides the standard &#8216;forall&#8217;, there are also &#8216;for infinitely
many&#8217;, &#8216;for all but finitely many&#8217;, &#8216;for a connected subset&#8217;, and
&#8216;for exactly k&#8217;.  The <a class="reference internal" href="#sage.interfaces.qepcad.qepcad" title="sage.interfaces.qepcad.qepcad"><tt class="xref py py-func docutils literal"><span class="pre">qepcad()</span></tt></a> documentation has examples
of all of these; here we will just give one example.</p>
<p>First we construct a circle:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">circle</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span>
</pre></div>
</div>
<p>For what values <span class="math">\(k\)</span> does a vertical line <span class="math">\(x=k\)</span> intersect the combined
figure of the circle and ellipse exactly three times?</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">qf</span><span class="o">.</span><span class="n">exactly_k</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">circle</span> <span class="o">*</span> <span class="n">ellipse</span> <span class="o">==</span> <span class="mi">0</span><span class="p">);</span> <span class="n">F</span>  <span class="c"># optional - qepcad</span>
<span class="go">(X3 y)[(x^2 + y^2 - 3) (3 x^2 + 2 x y + y^2 - x + y - 7) = 0]</span>
<span class="gp">sage: </span><span class="n">qepcad</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>                                         <span class="c"># optional - qepcad</span>
<span class="go">8 x^2 - 8 x - 29 &lt;= 0 /\ x^2 - 3 &lt;= 0 /\ 8 x^4 - 26 x^2 - 4 x + 13 &gt;= 0 /\ [ 8 x^4 - 26 x^2 - 4 x + 13 = 0 \/ x^2 - 3 = 0 \/ 8 x^2 - 8 x - 29 = 0 ]</span>
</pre></div>
</div>
<p>Here we see that the solutions are among the eight (<span class="math">\(4 + 2 + 2\)</span>) roots
of the three polynomials inside the brackets, but not all of these
roots are solutions; the polynomial inequalities outside the brackets
are needed to select those roots that are solutions.</p>
<p>QEPCAD also supports an extended formula language, where
<tt class="docutils literal"><span class="pre">_root_k</span></tt> <span class="math">\(P(\bar x, y)\)</span> refers to a particular zero of
<span class="math">\(P(\bar x, y)\)</span> (viewed as a polynomial in <span class="math">\(y\)</span>).  If there are <span class="math">\(n\)</span> roots,
then <tt class="docutils literal"><span class="pre">_root_1</span></tt> refers to the least root and <tt class="docutils literal"><span class="pre">_root_n</span></tt> refers to
the greatest. Also, <tt class="docutils literal"><span class="pre">_root_-n</span></tt> refers to the least root and
<tt class="docutils literal"><span class="pre">_root_-1</span></tt> refers to the greatest.</p>
<p>This extended language is available both on input and output; see the
QEPCAD documentation for more information on how to use this syntax on
input.  We can request output that is intended to be easy to interpret
geometrically; then QEPCAD will use the extended language to produce
a solution formula without the selection polynomials.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qepcad</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="s">&#39;geometric&#39;</span><span class="p">)</span>                 <span class="c"># optional - qepcad</span>
<span class="go">x = _root_1 8 x^2 - 8 x - 29</span>
<span class="go">\/</span>
<span class="go">8 x^4 - 26 x^2 - 4 x + 13 = 0</span>
<span class="go">\/</span>
<span class="go">x = _root_-1 x^2 - 3</span>
</pre></div>
</div>
<p>We then see that the 6 solutions correspond to the vertical tangent on
the left side of the ellipse, the four intersections between the
ellipse and the circle, and the vertical tangent on the right side of
the circle.</p>
<p>Let us do some basic formula simplification and visualization.
We will look at the region which is inside both the ellipse and the circle:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">qf</span><span class="o">.</span><span class="n">and_</span><span class="p">(</span><span class="n">ellipse</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">circle</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">);</span> <span class="n">F</span>         <span class="c"># optional - qepcad</span>
<span class="go">[3 x^2 + 2 x y + y^2 - x + y - 7 &lt; 0 /\ x^2 + y^2 - 3 &lt; 0]</span>
<span class="gp">sage: </span><span class="n">qepcad</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>                                       <span class="c"># optional - qepcad</span>
<span class="go">y^2 + 2 x y + y + 3 x^2 - x - 7 &lt; 0 /\ y^2 + x^2 - 3 &lt; 0</span>
</pre></div>
</div>
<p>We get back the same formula we put in.  This is not surprising (we
started with a pretty simple formula, after all), but it is not very
enlightening either.  Again, if we ask for a &#8216;geometric&#8217; output, then we see
an output that lets us understand something about the shape of the solution
set.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qepcad</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="s">&#39;geometric&#39;</span><span class="p">)</span>                 <span class="c"># optional - qepcad</span>
<span class="go">[</span>
<span class="go">  [</span>
<span class="go">    x = _root_-2 8 x^4 - 26 x^2 - 4 x + 13</span>
<span class="go">    \/</span>
<span class="go">    x = _root_2 8 x^4 - 26 x^2 - 4 x + 13</span>
<span class="go">    \/</span>
<span class="go">    8 x^4 - 26 x^2 - 4 x + 13 &lt; 0</span>
<span class="go">  ]</span>
<span class="go">  /\</span>
<span class="go">  y^2 + 2 x y + y + 3 x^2 - x - 7 &lt; 0</span>
<span class="go">  /\</span>
<span class="go">  y^2 + x^2 - 3 &lt; 0</span>
<span class="go">]</span>
<span class="go">\/</span>
<span class="go">[</span>
<span class="go">  x &gt; _root_2 8 x^4 - 26 x^2 - 4 x + 13</span>
<span class="go">  /\</span>
<span class="go">  x &lt; _root_-2 8 x^4 - 26 x^2 - 4 x + 13</span>
<span class="go">  /\</span>
<span class="go">  y^2 + x^2 - 3 &lt; 0</span>
<span class="go">]</span>
</pre></div>
</div>
<p>There is another reason to prefer output using _root_ expressions; not
only does it sometimes give added insight into the geometric
structure, it also can be more efficient to construct.  Consider this
formula for the projection of a particular semicircle onto the <span class="math">\(x\)</span>
axis:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">qf</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">qf</span><span class="o">.</span><span class="n">and_</span><span class="p">(</span><span class="n">circle</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">));</span> <span class="n">F</span>   <span class="c"># optional - qepcad</span>
<span class="go">(E y)[x^2 + y^2 - 3 = 0 /\ x + y &gt; 0]</span>
<span class="gp">sage: </span><span class="n">qepcad</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>                                  <span class="c"># optional - qepcad</span>
<span class="go">x^2 - 3 &lt;= 0 /\ [ x &gt; 0 \/ 2 x^2 - 3 &lt; 0 ]</span>
</pre></div>
</div>
<p>Here, the formula <span class="math">\(x &gt; 0\)</span> had to be introduced in order to get a
solution formula; the original CAD of F did not include the
polynomial <span class="math">\(x\)</span>.  To avoid having QEPCAD do the extra work to come up
with a solution formula, we can tell it to use the extended language;
it is always possible to construct a solution formula in the extended
language without introducing new polynomials.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qepcad</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="s">&#39;extended&#39;</span><span class="p">)</span>                 <span class="c"># optional - qepcad</span>
<span class="go">x^2 - 3 &lt;= 0 /\ x &gt; _root_1 2 x^2 - 3</span>
</pre></div>
</div>
<p>Up to this point, all the output we have seen has basically been in the
form of strings; there is no support (yet) for parsing these outputs
back into sage polynomials (partly because sage does not yet have
support for symbolic conjunctions and disjunctions).  The function
<a class="reference internal" href="#sage.interfaces.qepcad.qepcad" title="sage.interfaces.qepcad.qepcad"><tt class="xref py py-func docutils literal"><span class="pre">qepcad()</span></tt></a> supports three more output types that give numbers which
can be manipulated in sage: any-point, all-points, and cell-points.</p>
<p>These output types give dictionaries mapping variable names to values.
With any-point, <a class="reference internal" href="#sage.interfaces.qepcad.qepcad" title="sage.interfaces.qepcad.qepcad"><tt class="xref py py-func docutils literal"><span class="pre">qepcad()</span></tt></a> either produces a single dictionary
specifying a point where the formula is true, or raises an exception
if the formula is false everywhere.  With all-points,
<a class="reference internal" href="#sage.interfaces.qepcad.qepcad" title="sage.interfaces.qepcad.qepcad"><tt class="xref py py-func docutils literal"><span class="pre">qepcad()</span></tt></a> either produces a list of dictionaries for all
points where the formula is true, or raises an exception if the
formula is true on infinitely many points.  With cell-points,
<a class="reference internal" href="#sage.interfaces.qepcad.qepcad" title="sage.interfaces.qepcad.qepcad"><tt class="xref py py-func docutils literal"><span class="pre">qepcad()</span></tt></a> produces a list of dictionaries with one point for
each cell where the formula is true.  (This means you will have at least
one point in each connected component of the solution, although you will
often have many more points than that.)</p>
<p>Let us revisit some of the above examples and get some points to play
with.  We will start by finding a point on our ellipse.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">qepcad</span><span class="p">(</span><span class="n">ellipse</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="s">&#39;any-point&#39;</span><span class="p">);</span> <span class="n">p</span>  <span class="c"># optional - qepcad</span>
<span class="go">{&#39;y&#39;: 0.9685019685029527?, &#39;x&#39;: -1.468501968502953?}</span>
</pre></div>
</div>
<p>(Note that despite the decimal printing and the question marks, these
are really exact numbers.)</p>
<p>We can verify that this point is a solution.  To do so, we create
a copy of ellipse as a polynomial over <span class="math">\(\QQ\)</span> (instead of a symbolic
expression).</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">pellipse</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s">&#39;x,y&#39;</span><span class="p">](</span><span class="n">ellipse</span><span class="p">)</span>                <span class="c"># optional - qepcad</span>
<span class="gp">sage: </span><span class="n">pellipse</span><span class="p">(</span><span class="o">**</span><span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>                           <span class="c"># optional - qepcad</span>
<span class="go">True</span>
</pre></div>
</div>
<p>For cell-points, let us look at points <em>not</em> on the ellipse.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">pts</span> <span class="o">=</span> <span class="n">qepcad</span><span class="p">(</span><span class="n">ellipse</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="s">&#39;cell-points&#39;</span><span class="p">);</span> <span class="n">pts</span>   <span class="c"># optional - qepcad</span>
<span class="go">[{&#39;y&#39;: 0, &#39;x&#39;: 4}, {&#39;y&#39;: 1, &#39;x&#39;: 2.468501968502953?}, {&#39;y&#39;: -9, &#39;x&#39;: 2.468501968502953?}, {&#39;y&#39;: 9, &#39;x&#39;: 1/2}, {&#39;y&#39;: -1, &#39;x&#39;: 1/2}, {&#39;y&#39;: -5, &#39;x&#39;: 1/2}, {&#39;y&#39;: 3, &#39;x&#39;: -1.468501968502953?}, {&#39;y&#39;: -1, &#39;x&#39;: -1.468501968502953?}, {&#39;y&#39;: 0, &#39;x&#39;: -3}]</span>
</pre></div>
</div>
<p>For the points here which are in full-dimensional cells, QEPCAD has the
freedom to choose rational sample points, and it does so.</p>
<p>And, of course, all these points really are not on the ellipse.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="p">[</span><span class="n">pellipse</span><span class="p">(</span><span class="o">**</span><span class="n">p</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pts</span><span class="p">]</span>               <span class="c"># optional - qepcad</span>
<span class="go">[True, True, True, True, True, True, True, True, True]</span>
</pre></div>
</div>
<p>Finally, for all-points, let us look again at finding vertical lines that
intersect the union of the circle and the ellipse exactly three times.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">qf</span><span class="o">.</span><span class="n">exactly_k</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">circle</span> <span class="o">*</span> <span class="n">ellipse</span> <span class="o">==</span> <span class="mi">0</span><span class="p">);</span> <span class="n">F</span>   <span class="c"># optional - qepcad</span>
<span class="go">(X3 y)[(x^2 + y^2 - 3) (3 x^2 + 2 x y + y^2 - x + y - 7) = 0]</span>
<span class="gp">sage: </span><span class="n">pts</span> <span class="o">=</span> <span class="n">qepcad</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">solution</span><span class="o">=</span><span class="s">&#39;all-points&#39;</span><span class="p">);</span> <span class="n">pts</span>       <span class="c"># optional - qepcad</span>
<span class="go">[{&#39;x&#39;: 1.732050807568878?}, {&#39;x&#39;: 1.731054913462534?}, {&#39;x&#39;: 0.678911384208004?}, {&#39;x&#39;: -0.9417727377417167?}, {&#39;x&#39;: -1.468193559928821?}, {&#39;x&#39;: -1.468501968502953?}]</span>
</pre></div>
</div>
<p>Since <span class="math">\(y\)</span> is bound by the quantifier, the solutions only refer to <span class="math">\(x\)</span>.</p>
<p>We can substitute one of these solutions into the original equation:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">pt</span> <span class="o">=</span> <span class="n">pts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>                             <span class="c"># optional - qepcad</span>
<span class="gp">sage: </span><span class="n">pcombo</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s">&#39;x,y&#39;</span><span class="p">](</span><span class="n">circle</span> <span class="o">*</span> <span class="n">ellipse</span><span class="p">)</span>     <span class="c"># optional - qepcad</span>
<span class="gp">sage: </span><span class="n">intersections</span> <span class="o">=</span> <span class="n">pcombo</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">polygen</span><span class="p">(</span><span class="n">AA</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">),</span> <span class="o">**</span><span class="n">pt</span><span class="p">);</span> <span class="n">intersections</span>       <span class="c"># optional - qepcad</span>
<span class="go">y^4 + 4.464101615137755?*y^3 + 0.2679491924311227?*y^2</span>
</pre></div>
</div>
<p>and verify that it does have three roots:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">intersections</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>                                                 <span class="c"># optional - qepcad</span>
<span class="go">[(-4.403249005600958?, 1), (-0.06085260953679653?, 1), (0, 2)]</span>
</pre></div>
</div>
<p>Let us check all six solutions.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">pcombo</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">polygen</span><span class="p">(</span><span class="n">AA</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">),</span> <span class="o">**</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">roots</span><span class="p">())</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pts</span><span class="p">]</span>    <span class="c"># optional - qepcad</span>
<span class="go">[3, 3, 3, 3, 3, 3]</span>
</pre></div>
</div>
<p>We said earlier that we can run QEPCAD either automatically or
interactively.  Now that we have discussed the automatic modes, let us turn
to interactive uses.</p>
<p>If the <a class="reference internal" href="#sage.interfaces.qepcad.qepcad" title="sage.interfaces.qepcad.qepcad"><tt class="xref py py-func docutils literal"><span class="pre">qepcad()</span></tt></a> function is passed <tt class="docutils literal"><span class="pre">interact=True</span></tt>, then
instead of returning a result, it returns an object of class
<a class="reference internal" href="#sage.interfaces.qepcad.Qepcad" title="sage.interfaces.qepcad.Qepcad"><tt class="xref py py-class docutils literal"><span class="pre">Qepcad</span></tt></a> representing a running instance of QEPCAD that you can
interact with.  For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qe</span> <span class="o">=</span> <span class="n">qepcad</span><span class="p">(</span><span class="n">qf</span><span class="o">.</span><span class="n">forall</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">),</span> <span class="n">interact</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">qe</span>     <span class="c"># optional - qepcad</span>
<span class="go">QEPCAD object in phase &#39;Before Normalization&#39;</span>
</pre></div>
</div>
<p>This object is a fairly thin wrapper over QEPCAD; most QEPCAD commands
are available as methods on the <a class="reference internal" href="#sage.interfaces.qepcad.Qepcad" title="sage.interfaces.qepcad.Qepcad"><tt class="xref py py-class docutils literal"><span class="pre">Qepcad</span></tt></a> object.  Given a
<a class="reference internal" href="#sage.interfaces.qepcad.Qepcad" title="sage.interfaces.qepcad.Qepcad"><tt class="xref py py-class docutils literal"><span class="pre">Qepcad</span></tt></a> object <tt class="docutils literal"><span class="pre">qe</span></tt>, you can type <tt class="docutils literal"><span class="pre">qe.[tab]</span></tt> to see
the available QEPCAD commands; to see the documentation for an
individual QEPCAD command, for example <tt class="docutils literal"><span class="pre">d_setting</span></tt>, you can type
<tt class="docutils literal"><span class="pre">qe.d_setting?</span></tt>.  (In QEPCAD, this command is called
<tt class="docutils literal"><span class="pre">d-setting</span></tt>. We systematically replace hyphens with underscores
for this interface.)</p>
<p>The execution of QEPCAD is divided into four phases. Most commands are
not available during all phases.  We saw above that QEPCAD starts out
in phase <tt class="docutils literal"><span class="pre">'Before</span> <span class="pre">Normalization'</span></tt>. We see that the <tt class="docutils literal"><span class="pre">d_cell</span></tt> command
is not available in this phase:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">d_cell</span><span class="p">()</span>                                <span class="c"># optional - qepcad</span>
<span class="go">Error GETCID: This command is not active here.</span>
</pre></div>
</div>
<p>We will focus here on the fourth (and last) phase, <tt class="docutils literal"><span class="pre">'Before</span> <span class="pre">Solution'</span></tt>,
because this interface has special support for some operations in this
phase.  Consult the QEPCAD documentation for information on the other
phases.</p>
<p>We can tell QEPCAD to finish off the current phase and move to the
next with its <tt class="docutils literal"><span class="pre">go</span></tt> command.  (There is also the <tt class="docutils literal"><span class="pre">step</span></tt>
command, which partially completes a phase for phases that have
multiple steps, and the <tt class="docutils literal"><span class="pre">finish</span></tt> command, which runs QEPCAD to
completion.)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">()</span>                                        <span class="c"># optional - qepcad</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Projection (x)&#39;</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">()</span>                                        <span class="c"># optional - qepcad</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Choice&#39;</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">()</span>                                        <span class="c"># optional - qepcad</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Solution&#39;</span>
</pre></div>
</div>
<p>Note that the <a class="reference internal" href="#sage.interfaces.qepcad.Qepcad" title="sage.interfaces.qepcad.Qepcad"><tt class="xref py py-class docutils literal"><span class="pre">Qepcad</span></tt></a> object returns the new phase whenever the
phase changes, as a convenience for interactive use; except that when
the new phase is <tt class="docutils literal"><span class="pre">'EXITED'</span></tt>, the solution formula printed by QEPCAD is
returned instead.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">()</span>                                        <span class="c"># optional - qepcad</span>
<span class="go">4 c - b^2 &gt; 0</span>
<span class="gp">sage: </span><span class="n">qe</span>                                             <span class="c"># optional - qepcad</span>
<span class="go">QEPCAD object in phase &#39;EXITED&#39;</span>
</pre></div>
</div>
<p>Let us pick a nice, simple example, return to phase 4, and explore the
resulting <tt class="docutils literal"><span class="pre">qe</span></tt> object.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qe</span> <span class="o">=</span> <span class="n">qepcad</span><span class="p">(</span><span class="n">circle</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">interact</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">qe</span>       <span class="c"># optional - qepcad</span>
<span class="go">QEPCAD object in phase &#39;Before Normalization&#39;</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">();</span> <span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">();</span> <span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">()</span>                         <span class="c"># optional - qepcad</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Projection (y)&#39;</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Choice&#39;</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Solution&#39;</span>
</pre></div>
</div>
<p>We said before that QEPCAD creates &#8216;cylindrical algebraic
decompositions&#8217;; since we have a bivariate polynomial, we get
decompositions of <span class="math">\(\RR^0\)</span>, <span class="math">\(\RR^1\)</span>, and <span class="math">\(\RR^2\)</span>.  In this case, where
our example is a circle of radius <span class="math">\(\sqrt{3}\)</span> centered on the origin,
these decompositions are as follows:</p>
<p>The decomposition of <span class="math">\(\RR^0\)</span> is trivial (of course).  The
decomposition of <span class="math">\(\RR^1\)</span> has five cells: <span class="math">\(x &lt; -\sqrt{3}\)</span>, <span class="math">\(x =
-\sqrt{3}\)</span>, <span class="math">\(-\sqrt{3} &lt; x &lt; \sqrt{3}\)</span>, <span class="math">\(x = \sqrt{3}\)</span>, and <span class="math">\(x &gt;
\sqrt{3}\)</span>.  These five cells comprise the <tt class="docutils literal"><span class="pre">stack</span></tt> over the single
cell in the trivial decomposition of <span class="math">\(\RR^0\)</span>.</p>
<p>These five cells give rise to five stacks in <span class="math">\(\RR^2\)</span>.  The first and
fifth stack have just one cell apiece.  The second and fourth stacks
have three cells: <span class="math">\(y &lt; 0\)</span>, <span class="math">\(y = 0\)</span>, and <span class="math">\(y &gt; 0\)</span>.  The third stack has
five cells: below the circle, the lower semicircle, the interior of
the circle, the upper semicircle, and above the circle.</p>
<p>QEPCAD (and this QEPCAD interface) number the cells in a stack
starting with 1.  Each cell has an <tt class="docutils literal"><span class="pre">index</span></tt>, which is a tuple of
integers describing the path to the cell in the tree of all cells.
For example, the cell &#8216;below the circle&#8217; has index (3,1) (the first
cell in the stack over the third cell of <span class="math">\(\RR^1\)</span>) and the interior of
the circle has index (3,3).</p>
<p>We can view these cells with the QEPCAD command <tt class="docutils literal"><span class="pre">d_cell</span></tt>.  For
instance, let us look at the cell for the upper semicircle:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">d_cell</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>                              <span class="c"># optional - qepcad</span>
<span class="go">---------- Information about the cell (3,4) ----------</span>
<span class="go">Level                       : 2</span>
<span class="go">Dimension                   : 1</span>
<span class="go">Number of children          : 0</span>
<span class="go">Truth value                 : T    by trial evaluation.</span>
<span class="go">Degrees after substitution  : Not known yet or No polynomial.</span>
<span class="go">Multiplicities              : ((1,1))</span>
<span class="go">Signs of Projection Factors</span>
<span class="go">Level 1  : (-)</span>
<span class="go">Level 2  : (0)</span>
<span class="go">----------   Sample point  ----------</span>
<span class="go">The sample point is in a PRIMITIVE representation.</span>

<span class="go">alpha = the unique root of x^2 - 3 between 0 and 4</span>
<span class="go">      = 1.7320508076-</span>

<span class="go">Coordinate 1 = 0</span>
<span class="go">             = 0.0000000000</span>
<span class="go">Coordinate 2 = alpha</span>
<span class="go">             = 1.7320508076-</span>
<span class="go">----------------------------------------------------</span>
</pre></div>
</div>
<p>We see that, the level of this cell is 2, meaning that it is part of
the decomposition of <span class="math">\(\RR^2\)</span>.  The dimension is 1, meaning that the
cell is homeomorphic to a line (rather than a plane or a point).  The
sample point gives the coordinates of one point in the cell, both
symbolically and numerically.</p>
<p>For programmatic access to cells, we have defined a sage wrapper class
<a class="reference internal" href="#sage.interfaces.qepcad.QepcadCell" title="sage.interfaces.qepcad.QepcadCell"><tt class="xref py py-class docutils literal"><span class="pre">QepcadCell</span></tt></a>.  These cells can be created with the
<tt class="xref py py-meth docutils literal"><span class="pre">cell()</span></tt> method; for example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">qe</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span> <span class="n">c</span>                       <span class="c"># optional - qepcad</span>
<span class="go">QEPCAD cell (3, 4)</span>
</pre></div>
</div>
<p>A <a class="reference internal" href="#sage.interfaces.qepcad.QepcadCell" title="sage.interfaces.qepcad.QepcadCell"><tt class="xref py py-class docutils literal"><span class="pre">QepcadCell</span></tt></a> has accessor methods for the important state held
within a cell.  For instance:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">level</span><span class="p">()</span>                                  <span class="c"># optional - qepcad</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>                                  <span class="c"># optional - qepcad</span>
<span class="go">(3, 4)</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">number_of_children</span><span class="p">()</span>            <span class="c"># optional - qepcad</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">qe</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>                            <span class="c"># optional - qepcad</span>
<span class="go">5</span>
</pre></div>
</div>
<p>One particularly useful thing we can get from a cell is its sample point,
as sage algebraic real numbers.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">sample_point</span><span class="p">()</span>                           <span class="c"># optional - qepcad</span>
<span class="go">(0, 1.732050807568878?)</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">sample_point_dict</span><span class="p">()</span>                      <span class="c"># optional - qepcad</span>
<span class="go">{&#39;y&#39;: 1.732050807568878?, &#39;x&#39;: 0}</span>
</pre></div>
</div>
<p>We have seen that we can get cells using the <tt class="xref py py-meth docutils literal"><span class="pre">cell()</span></tt> method.
There are several QEPCAD commands that print lists of cells; we can
also get cells using the <tt class="xref py py-meth docutils literal"><span class="pre">make_cells()</span></tt> method, passing it the
output of one of these commands.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">make_cells</span><span class="p">(</span><span class="n">qe</span><span class="o">.</span><span class="n">d_true_cells</span><span class="p">())</span>           <span class="c"># optional - qepcad</span>
<span class="go">[QEPCAD cell (4, 2), QEPCAD cell (3, 4), QEPCAD cell (3, 2),</span>
<span class="go">QEPCAD cell (2, 2)]</span>
</pre></div>
</div>
<p>Also, the cells in the stack over a given cell can be accessed using
array subscripting or iteration.  (Remember that cells in a stack are
numbered starting with one; we preserve this convention in the
array-subscripting syntax.)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">qe</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                             <span class="c"># optional - qepcad</span>
<span class="gp">sage: </span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>                                       <span class="c"># optional - qepcad</span>
<span class="go">QEPCAD cell (3, 1)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">c2</span> <span class="k">for</span> <span class="n">c2</span> <span class="ow">in</span> <span class="n">c</span><span class="p">]</span>                           <span class="c"># optional - qepcad</span>
<span class="go">[QEPCAD cell (3, 1), QEPCAD cell (3, 2), QEPCAD cell (3, 3),</span>
<span class="go">QEPCAD cell (3, 4), QEPCAD cell (3, 5)]</span>
</pre></div>
</div>
<p>We can do one more thing with a cell: we can set its truth value.
Once the truth values of the cells have been set, we can get QEPCAD to
produce a formula which is true in exactly the cells we have selected.
This is useful if QEPCAD&#8217;s quantifier language is insufficient to
express your problem.</p>
<p>For example, consider again our combined figure of the circle and the
ellipse.  Suppose you want to find all vertical lines that intersect
the circle twice, and also intersect the ellipse twice.  The vertical
lines that intersect the circle twice can be found by simplifying:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">qf</span><span class="o">.</span><span class="n">exactly_k</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">circle</span> <span class="o">==</span> <span class="mi">0</span><span class="p">);</span> <span class="n">F</span>         <span class="c"># optional - qepcad</span>
<span class="go">(X2 y)[x^2 + y^2 - 3 = 0]</span>
</pre></div>
</div>
<p>and the vertical lines that intersect the ellipse twice are expressed by:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">qf</span><span class="o">.</span><span class="n">exactly_k</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ellipse</span> <span class="o">==</span> <span class="mi">0</span><span class="p">);</span> <span class="n">G</span>        <span class="c"># optional - qepcad</span>
<span class="go">(X2 y)[3 x^2 + 2 x y + y^2 - x + y - 7 = 0]</span>
</pre></div>
</div>
<p>and the lines that intersect both figures would be:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">and_</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">G</span><span class="p">)</span>                                  <span class="c"># optional - qepcad</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">QEPCAD formulas must be in prenex (quantifiers outermost) form</span>
</pre></div>
</div>
<p>...except that QEPCAD does not support formulas like this; in QEPCAD
input, all logical connectives must be inside all quantifiers.</p>
<p>Instead, we can get QEPCAD to construct a CAD for our combined figure
and set the truth values ourselves.  (The exact formula we use doesn&#8217;t
matter, since we&#8217;re going to replace the truth values in the cells; we
just need to use a formula that uses both polynomials.)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qe</span> <span class="o">=</span> <span class="n">qepcad</span><span class="p">(</span><span class="n">qf</span><span class="o">.</span><span class="n">and_</span><span class="p">(</span><span class="n">ellipse</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">circle</span> <span class="o">==</span> <span class="mi">0</span><span class="p">),</span> <span class="n">interact</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>       <span class="c"># optional - qepcad</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">();</span> <span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">();</span> <span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">()</span>                      <span class="c"># optional - qepcad</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Projection (y)&#39;</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Choice&#39;</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Solution&#39;</span>
</pre></div>
</div>
<p>Now we want to find all cells <span class="math">\(c\)</span> in the decomposition of <span class="math">\(\RR^1\)</span> such
that the stack over <span class="math">\(c\)</span> contains exactly two cells on the ellipse, and
also contains exactly two cells on the circle.</p>
<p>Our input polynomials are &#8216;level-2 projection factors&#8217;, we see:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">d_proj_factors</span><span class="p">()</span>                           <span class="c"># optional - qepcad</span>
<span class="go">P_1,1  = fac(J_1,1) = fac(dis(A_2,1))</span>
<span class="go">       = 8 x^2 - 8 x - 29</span>
<span class="go">P_1,2  = fac(J_1,2) = fac(dis(A_2,2))</span>
<span class="go">       = x^2 - 3</span>
<span class="go">P_1,3  = fac(J_1,3) = fac(res(A_2,1|A_2,2))</span>
<span class="go">       = 8 x^4 - 26 x^2 - 4 x + 13</span>
<span class="go">A_2,1  = input</span>
<span class="go">       = y^2 + 2 x y + y + 3 x^2 - x - 7</span>
<span class="go">A_2,2  = input</span>
<span class="go">       = y^2 + x^2 - 3</span>
</pre></div>
</div>
<p>so we can test whether a cell is on the ellipse by checking that the
sign of the corresponding projection factor is 0 in our cell.
For instance, the cell (12,2) is on the ellipse:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">signs</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>                  <span class="c"># optional - qepcad</span>
<span class="go">0</span>
</pre></div>
</div>
<p>So we can update the truth values as desired like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">qe</span><span class="o">.</span><span class="n">cell</span><span class="p">():</span>                                        <span class="c"># optional - qepcad</span>
<span class="go">....:     count_ellipse = 0</span>
<span class="go">....:     count_circle = 0</span>
<span class="go">....:     for c2 in c:</span>
<span class="go">....:         count_ellipse += (c2.signs()[1][0] == 0)</span>
<span class="go">....:         count_circle += (c2.signs()[1][1] == 0)</span>
<span class="go">....:     c.set_truth(count_ellipse == 2 and count_circle == 2)</span>
</pre></div>
</div>
<p>and then we can get our desired solution formula.  (The <tt class="docutils literal"><span class="pre">'G'</span></tt> stands for
<tt class="docutils literal"><span class="pre">'geometric'</span></tt>, and gives solutions using the same rules as
<tt class="docutils literal"><span class="pre">solution='geometric'</span></tt> described above.)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">solution_extension</span><span class="p">(</span><span class="s">&#39;G&#39;</span><span class="p">)</span>     <span class="c"># optional - qepcad</span>
<span class="go">8 x^2 - 8 x - 29 &lt; 0</span>
<span class="go">/\</span>
<span class="go">x^2 - 3 &lt; 0</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>Check the qepcad configuration file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="nb">open</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">/default.qepcadrc&#39;</span><span class="o">%</span><span class="n">SAGE_LOCAL</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">&#39;SINGULAR .../local/bin\n&#39;</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Carl Witty (2008-03): initial version</li>
</ul>
<dl class="class">
<dt id="sage.interfaces.qepcad.Qepcad">
<em class="property">class </em><tt class="descclassname">sage.interfaces.qepcad.</tt><tt class="descname">Qepcad</tt><big>(</big><em>formula</em>, <em>vars=None</em>, <em>logfile=None</em>, <em>verbose=False</em>, <em>memcells=None</em>, <em>server=None</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.Qepcad" title="Permalink to this definition">¶</a></dt>
<dd><p>The wrapper for QEPCAD.</p>
<dl class="method">
<dt id="sage.interfaces.qepcad.Qepcad.answer">
<tt class="descname">answer</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.Qepcad.answer" title="Permalink to this definition">¶</a></dt>
<dd><p>For a QEPCAD instance which is finished, return the
simplified quantifier-free formula that it printed just before
exiting.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qe</span> <span class="o">=</span> <span class="n">qepcad</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">interact</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c"># optional - qepcad</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">finish</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">x - 1 &lt;= 0 /\ x + 1 &gt;= 0 /\ [ x = 0 \/ x - 1 = 0 \/ x + 1 = 0 ]</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">answer</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">x - 1 &lt;= 0 /\ x + 1 &gt;= 0 /\ [ x = 0 \/ x - 1 = 0 \/ x + 1 = 0 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.Qepcad.assume">
<tt class="descname">assume</tt><big>(</big><em>assume</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.Qepcad.assume" title="Permalink to this definition">¶</a></dt>
<dd><p>The following documentation is from <tt class="docutils literal"><span class="pre">qepcad.help</span></tt>.</p>
<p>Add an assumption to the problem.  These will not be
included in the solution formula.</p>
<p>For example, with input  (E x)[ a x^2 + b x + c = 0],
if we issue the command</p>
<blockquote>
<div>assume [ a /= 0 ]</div></blockquote>
<p>we will get the solution formula b^2 - 4 a c &gt;= 0.  Without
the assumption we&#8217;d get something like [a = 0 /b /= 0] /
[a /= 0 /4 a c - b^2 &lt;= 0] / [a = 0 /b = 0 /c = 0].</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a,b,c,x&#39;</span><span class="p">)</span>
<span class="go">(a, b, c, x)</span>
<span class="gp">sage: </span><span class="n">qf</span> <span class="o">=</span> <span class="n">qepcad_formula</span>
<span class="gp">sage: </span><span class="n">qe</span> <span class="o">=</span> <span class="n">qepcad</span><span class="p">(</span><span class="n">qf</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">),</span> <span class="n">interact</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c"># optional - qepcad</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">assume</span><span class="p">(</span><span class="n">a</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="c"># optional - qepcad</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">finish</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">4 a c - b^2 &lt;= 0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.Qepcad.cell">
<tt class="descname">cell</tt><big>(</big><em>*index</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.Qepcad.cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a cell index, returns a <a class="reference internal" href="#sage.interfaces.qepcad.QepcadCell" title="sage.interfaces.qepcad.QepcadCell"><tt class="xref py py-class docutils literal"><span class="pre">QepcadCell</span></tt></a> wrapper for that
cell.  Uses a cache for efficiency.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qe</span> <span class="o">=</span> <span class="n">qepcad</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">42</span><span class="p">,</span> <span class="n">interact</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c"># optional - qepcad</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">();</span> <span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">();</span> <span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">QEPCAD object has moved to phase &#39;At the end of projection phase&#39;</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Choice&#39;</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Solution&#39;</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c"># optional - qepcad</span>
<span class="go">QEPCAD cell (2)</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="ow">is</span> <span class="n">qe</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c"># optional - qepcad</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.Qepcad.final_stats">
<tt class="descname">final_stats</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.Qepcad.final_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>For a QEPCAD instance which is finished, return the
statistics that it printed just before exiting.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qe</span> <span class="o">=</span> <span class="n">qepcad</span><span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">interact</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  <span class="c"># optional - qepcad</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">finish</span><span class="p">()</span>  <span class="c"># optional - qepcad</span>
<span class="go">x = 0</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">final_stats</span><span class="p">()</span>  <span class="c"># random, optional - qepcad</span>
<span class="go">-----------------------------------------------------------------------------</span>
<span class="go">0 Garbage collections, 0 Cells and 0 Arrays reclaimed, in 0 milliseconds.</span>
<span class="go">492840 Cells in AVAIL, 500000 Cells in SPACE.</span>
<span class="go">System time: 8 milliseconds.</span>
<span class="go">System time after the initialization: 4 milliseconds.</span>
<span class="go">-----------------------------------------------------------------------------</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.Qepcad.make_cells">
<tt class="descname">make_cells</tt><big>(</big><em>text</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.Qepcad.make_cells" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the result of some QEPCAD command that returns cells
(such as <tt class="xref py py-meth docutils literal"><span class="pre">d_cell()</span></tt>, <tt class="xref py py-meth docutils literal"><span class="pre">d_witness_list()</span></tt>, etc.),
return a list of cell objects.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;x,y&#39;</span><span class="p">)</span>
<span class="go">(x, y)</span>
<span class="gp">sage: </span><span class="n">qe</span> <span class="o">=</span> <span class="n">qepcad</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interact</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c"># optional - qepcad</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">();</span> <span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">();</span> <span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Projection (y)&#39;</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Choice&#39;</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Solution&#39;</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">make_cells</span><span class="p">(</span><span class="n">qe</span><span class="o">.</span><span class="n">d_false_cells</span><span class="p">())</span> <span class="c"># optional - qepcad</span>
<span class="go">[QEPCAD cell (5, 1), QEPCAD cell (4, 3), QEPCAD cell (4, 1), QEPCAD cell (3, 5), QEPCAD cell (3, 3), QEPCAD cell (3, 1), QEPCAD cell (2, 3), QEPCAD cell (2, 1), QEPCAD cell (1, 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.Qepcad.phase">
<tt class="descname">phase</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.Qepcad.phase" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the current phase of the QEPCAD program.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qe</span> <span class="o">=</span> <span class="n">qepcad</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">interact</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c"># optional - qepcad</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">phase</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">&#39;Before Normalization&#39;</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">QEPCAD object has moved to phase &#39;At the end of projection phase&#39;</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">phase</span><span class="p">()</span> <span class="c"># optional  - qepcad</span>
<span class="go">&#39;At the end of projection phase&#39;</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Choice&#39;</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">phase</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">&#39;Before Choice&#39;</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Solution&#39;</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">phase</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">&#39;Before Solution&#39;</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">3 x - 2 &gt; 0</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">phase</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">&#39;EXITED&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.Qepcad.set_truth_value">
<tt class="descname">set_truth_value</tt><big>(</big><em>index</em>, <em>nv</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.Qepcad.set_truth_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a cell index (or a cell) and an integer, set the truth value
of the cell to that integer.</p>
<p>Valid integers are 0 (false), 1 (true), and 2 (undetermined).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qe</span> <span class="o">=</span> <span class="n">qepcad</span><span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interact</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c"># optional - qepcad</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">();</span> <span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">();</span> <span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">QEPCAD object has moved to phase &#39;At the end of projection phase&#39;</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Choice&#39;</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Solution&#39;</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">set_truth_value</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c"># optional - qepcad</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.Qepcad.solution_extension">
<tt class="descname">solution_extension</tt><big>(</big><em>kind</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.Qepcad.solution_extension" title="Permalink to this definition">¶</a></dt>
<dd><p>The following documentation is modified from <tt class="docutils literal"><span class="pre">qepcad.help</span></tt>:</p>
<p>solution-extension x</p>
<p>Use an alternative solution formula construction method.  The
parameter x is allowed to be T,E, or G.  If x is T, then a
formula in the usual language of Tarski formulas is produced.
If x is E, a formula in the language of Extended Tarski formulas
is produced.  If x is G, then a geometry-based formula is
produced.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;x,y&#39;</span><span class="p">)</span>
<span class="go">(x, y)</span>
<span class="gp">sage: </span><span class="n">qf</span> <span class="o">=</span> <span class="n">qepcad_formula</span>
<span class="gp">sage: </span><span class="n">qe</span> <span class="o">=</span> <span class="n">qepcad</span><span class="p">(</span><span class="n">qf</span><span class="o">.</span><span class="n">and_</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">),</span> <span class="n">interact</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c"># optional - qepcad</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">();</span> <span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">();</span> <span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Projection (y)&#39;</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Choice&#39;</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Solution&#39;</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">solution_extension</span><span class="p">(</span><span class="s">&#39;E&#39;</span><span class="p">)</span> <span class="c"># optional - qepcad</span>
<span class="go">x &gt; _root_1 2 x^2 - 3 /\ y^2 + x^2 - 3 = 0 /\ [ 2 x^2 - 3 &gt; 0 \/ y = _root_-1 y^2 + x^2 - 3 ]</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">solution_extension</span><span class="p">(</span><span class="s">&#39;G&#39;</span><span class="p">)</span> <span class="c"># optional - qepcad</span>
<span class="go">[</span>
<span class="go">  [</span>
<span class="go">    2 x^2 - 3 &lt; 0</span>
<span class="go">    \/</span>
<span class="go">    x = _root_-1 2 x^2 - 3</span>
<span class="go">  ]</span>
<span class="go">  /\</span>
<span class="go">  y = _root_-1 y^2 + x^2 - 3</span>
<span class="go">]</span>
<span class="go">\/</span>
<span class="go">[</span>
<span class="go">  x^2 - 3 &lt;= 0</span>
<span class="go">  /\</span>
<span class="go">  x &gt; _root_-1 2 x^2 - 3</span>
<span class="go">  /\</span>
<span class="go">  y^2 + x^2 - 3 = 0</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">solution_extension</span><span class="p">(</span><span class="s">&#39;T&#39;</span><span class="p">)</span> <span class="c"># optional - qepcad</span>
<span class="go">y + x &gt; 0 /\ y^2 + x^2 - 3 = 0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.Qepcad.trait_names">
<tt class="descname">trait_names</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.Qepcad.trait_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of the QEPCAD commands which are available as
extra methods on a <a class="reference internal" href="#sage.interfaces.qepcad.Qepcad" title="sage.interfaces.qepcad.Qepcad"><tt class="xref py py-class docutils literal"><span class="pre">Qepcad</span></tt></a> object.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qe</span> <span class="o">=</span> <span class="n">qepcad</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">interact</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c"># optional - qepcad</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">qe</span><span class="o">.</span><span class="n">trait_names</span><span class="p">())</span> <span class="c"># random, optional - qepcad</span>
<span class="go">97</span>
<span class="gp">sage: </span><span class="s">&#39;d_cell&#39;</span> <span class="ow">in</span> <span class="n">qe</span><span class="o">.</span><span class="n">trait_names</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.interfaces.qepcad.QepcadCell">
<em class="property">class </em><tt class="descclassname">sage.interfaces.qepcad.</tt><tt class="descname">QepcadCell</tt><big>(</big><em>parent</em>, <em>lines</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.QepcadCell" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper for a QEPCAD cell.</p>
<dl class="method">
<dt id="sage.interfaces.qepcad.QepcadCell.index">
<tt class="descname">index</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.QepcadCell.index" title="Permalink to this definition">¶</a></dt>
<dd><p>Give the index of a QEPCAD cell.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;x,y&#39;</span><span class="p">)</span>
<span class="go">(x, y)</span>
<span class="gp">sage: </span><span class="n">qe</span> <span class="o">=</span> <span class="n">qepcad</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interact</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c"># optional - qepcad</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">();</span> <span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">();</span> <span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Projection (y)&#39;</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Choice&#39;</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Solution&#39;</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">cell</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">()</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">(1,)</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">(2, 2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.QepcadCell.level">
<tt class="descname">level</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.QepcadCell.level" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the level of a QEPCAD cell.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;x,y&#39;</span><span class="p">)</span>
<span class="go">(x, y)</span>
<span class="gp">sage: </span><span class="n">qe</span> <span class="o">=</span> <span class="n">qepcad</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interact</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c"># optional - qepcad</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">();</span> <span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">();</span> <span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Projection (y)&#39;</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Choice&#39;</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Solution&#39;</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">cell</span><span class="p">()</span><span class="o">.</span><span class="n">level</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">level</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">level</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.QepcadCell.number_of_children">
<tt class="descname">number_of_children</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.QepcadCell.number_of_children" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of elements in the stack over a QEPCAD cell.
(This is always an odd number, if the stack has been constructed.)</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;x,y&#39;</span><span class="p">)</span>
<span class="go">(x, y)</span>
<span class="gp">sage: </span><span class="n">qe</span> <span class="o">=</span> <span class="n">qepcad</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interact</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c"># optional - qepcad</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">();</span> <span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">();</span> <span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Projection (y)&#39;</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Choice&#39;</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Solution&#39;</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">cell</span><span class="p">()</span><span class="o">.</span><span class="n">number_of_children</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">number_of_children</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">qe</span><span class="o">.</span><span class="n">cell</span><span class="p">()]</span> <span class="c"># optional - qepcad</span>
<span class="go">[1, 3, 5, 3, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.QepcadCell.sample_point">
<tt class="descname">sample_point</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.QepcadCell.sample_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the coordinates of a point in the cell, as a tuple of
sage algebraic reals.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qe</span> <span class="o">=</span> <span class="n">qepcad</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">interact</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c"># optional - qepcad</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">();</span> <span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">();</span> <span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">QEPCAD object has moved to phase &#39;At the end of projection phase&#39;</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Choice&#39;</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Solution&#39;</span>
<span class="gp">sage: </span><span class="n">v1</span> <span class="o">=</span> <span class="n">qe</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sample_point</span><span class="p">()[</span><span class="mi">0</span><span class="p">];</span> <span class="n">v1</span> <span class="c"># optional - qepcad</span>
<span class="go">-0.618033988749895?</span>
<span class="gp">sage: </span><span class="n">v2</span> <span class="o">=</span> <span class="n">qe</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">sample_point</span><span class="p">()[</span><span class="mi">0</span><span class="p">];</span> <span class="n">v2</span> <span class="c"># optional - qepcad</span>
<span class="go">1.618033988749895?</span>
<span class="gp">sage: </span><span class="n">v1</span> <span class="o">+</span> <span class="n">v2</span> <span class="o">==</span> <span class="mi">1</span> <span class="c"># optional - qepcad</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.QepcadCell.sample_point_dict">
<tt class="descname">sample_point_dict</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.QepcadCell.sample_point_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the coordinates of a point in the cell, as a dictionary
mapping variable names (as strings) to sage algebraic reals.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qe</span> <span class="o">=</span> <span class="n">qepcad</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">interact</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c"># optional - qepcad</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">();</span> <span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">();</span> <span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">QEPCAD object has moved to phase &#39;At the end of projection phase&#39;</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Choice&#39;</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Solution&#39;</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">sample_point_dict</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">{&#39;x&#39;: 1.618033988749895?}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.QepcadCell.set_truth">
<tt class="descname">set_truth</tt><big>(</big><em>v</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.QepcadCell.set_truth" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the truth value of this cell, as used by QEPCAD for solution
formula construction.</p>
<p>The argument <tt class="docutils literal"><span class="pre">v</span></tt> should be either a boolean or <tt class="docutils literal"><span class="pre">None</span></tt>
(which will set the truth value to <tt class="docutils literal"><span class="pre">'undetermined'</span></tt>).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;x,y&#39;</span><span class="p">)</span>
<span class="go">(x, y)</span>
<span class="gp">sage: </span><span class="n">qe</span> <span class="o">=</span> <span class="n">qepcad</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interact</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c"># optional - qepcad</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">();</span> <span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">();</span> <span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Projection (y)&#39;</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Choice&#39;</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Solution&#39;</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">solution_extension</span><span class="p">(</span><span class="s">&#39;T&#39;</span><span class="p">)</span> <span class="c"># optional - qepcad</span>
<span class="go">y^2 + x^2 - 1 = 0</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">set_truth</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span> <span class="c"># optional - qepcad</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">solution_extension</span><span class="p">(</span><span class="s">&#39;T&#39;</span><span class="p">)</span> <span class="c"># optional - qepcad</span>
<span class="go">y^2 + x^2 - 1 &lt;= 0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.QepcadCell.signs">
<tt class="descname">signs</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.QepcadCell.signs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the sign vector of a QEPCAD cell.</p>
<p>This is a list of lists.
The outer list contains one element for each level of the cell;
the inner list contains one element for each projection factor at
that level.  These elements are either -1, 0, or 1.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;x,y&#39;</span><span class="p">)</span>
<span class="go">(x, y)</span>
<span class="gp">sage: </span><span class="n">qe</span> <span class="o">=</span> <span class="n">qepcad</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interact</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c"># optional - qepcad</span>
<span class="gp">sage: </span><span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">();</span> <span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">();</span> <span class="n">qe</span><span class="o">.</span><span class="n">go</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Projection (y)&#39;</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Choice&#39;</span>
<span class="go">QEPCAD object has moved to phase &#39;Before Solution&#39;</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.interfaces.qepcad</span> <span class="kn">import</span> <span class="n">QepcadCell</span>
<span class="gp">sage: </span><span class="n">all_cells</span> <span class="o">=</span> <span class="n">flatten</span><span class="p">(</span><span class="n">qe</span><span class="o">.</span><span class="n">cell</span><span class="p">(),</span> <span class="n">ltypes</span><span class="o">=</span><span class="n">QepcadCell</span><span class="p">,</span> <span class="n">max_level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c"># optional - qepcad</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">c</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">signs</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">all_cells</span><span class="p">]</span> <span class="c"># optional - qepcad</span>
<span class="go">[(QEPCAD cell (1, 1), 1), (QEPCAD cell (2, 1), 1), (QEPCAD cell (2, 2), 0), (QEPCAD cell (2, 3), 1), (QEPCAD cell (3, 1), 1), (QEPCAD cell (3, 2), 0), (QEPCAD cell (3, 3), -1), (QEPCAD cell (3, 4), 0), (QEPCAD cell (3, 5), 1), (QEPCAD cell (4, 1), 1), (QEPCAD cell (4, 2), 0), (QEPCAD cell (4, 3), 1), (QEPCAD cell (5, 1), 1)]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.interfaces.qepcad.QepcadFunction">
<em class="property">class </em><tt class="descclassname">sage.interfaces.qepcad.</tt><tt class="descname">QepcadFunction</tt><big>(</big><em>parent</em>, <em>name</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.QepcadFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="expect.html#sage.interfaces.expect.ExpectFunction" title="sage.interfaces.expect.ExpectFunction"><tt class="xref py py-class docutils literal"><span class="pre">sage.interfaces.expect.ExpectFunction</span></tt></a></p>
<p>A wrapper for a QEPCAD command.</p>
</dd></dl>

<dl class="class">
<dt id="sage.interfaces.qepcad.Qepcad_expect">
<em class="property">class </em><tt class="descclassname">sage.interfaces.qepcad.</tt><tt class="descname">Qepcad_expect</tt><big>(</big><em>memcells=None</em>, <em>maxread=100000</em>, <em>logfile=None</em>, <em>server=None</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.Qepcad_expect" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="expect.html#sage.interfaces.expect.Expect" title="sage.interfaces.expect.Expect"><tt class="xref py py-class docutils literal"><span class="pre">sage.interfaces.expect.Expect</span></tt></a></p>
<p>The low-level wrapper for QEPCAD.</p>
</dd></dl>

<dl class="function">
<dt id="sage.interfaces.qepcad.qepcad">
<tt class="descclassname">sage.interfaces.qepcad.</tt><tt class="descname">qepcad</tt><big>(</big><em>formula</em>, <em>assume=None</em>, <em>interact=False</em>, <em>solution=None</em>, <em>vars=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.qepcad" title="Permalink to this definition">¶</a></dt>
<dd><p>Quantifier elimination and formula simplification using QEPCAD B.</p>
<p>If <tt class="docutils literal"><span class="pre">assume</span></tt> is specified, then the given formula is <tt class="docutils literal"><span class="pre">'assumed'</span></tt>,
which is taken into account during final solution formula construction.</p>
<p>If <tt class="docutils literal"><span class="pre">interact=True</span></tt> is given, then a <a class="reference internal" href="#sage.interfaces.qepcad.Qepcad" title="sage.interfaces.qepcad.Qepcad"><tt class="xref py py-class docutils literal"><span class="pre">Qepcad</span></tt></a> object is
returned which can be interacted with either at the command line
or programmatically.</p>
<p>The type of solution returned can be adjusted with <tt class="docutils literal"><span class="pre">solution</span></tt>.
The options are <tt class="docutils literal"><span class="pre">'geometric'</span></tt>, which tries to construct a
solution formula with geometric meaning; <tt class="docutils literal"><span class="pre">'extended'</span></tt>, which
gives a solution formula in an extended language that may be more
efficient to construct; <tt class="docutils literal"><span class="pre">'any-point'</span></tt>, which returns any
point where the formula is true; <tt class="docutils literal"><span class="pre">'all-points'</span></tt>, which
returns a list of all points where the formula is true (or raises
an exception if there are infinitely many); and <tt class="docutils literal"><span class="pre">'cell-points'</span></tt>,
which returns one point in each cell where the formula is true.</p>
<p>All other keyword arguments are passed through to the <a class="reference internal" href="#sage.interfaces.qepcad.Qepcad" title="sage.interfaces.qepcad.Qepcad"><tt class="xref py py-class docutils literal"><span class="pre">Qepcad</span></tt></a>
constructor.</p>
<p>For much more documentation and many more examples, see the module
docstring for this module (type <tt class="docutils literal"><span class="pre">sage.interfaces.qepcad?</span></tt> to
read this docstring from the sage command line).</p>
<p>The examples below require that the optional qepcad package is installed.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qf</span> <span class="o">=</span> <span class="n">qepcad_formula</span>

<span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a,b,c,d,x,y,z,long_with_underscore_314159&#39;</span><span class="p">)</span>
<span class="go">(a, b, c, d, x, y, z, long_with_underscore_314159)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>

<span class="gp">sage: </span><span class="n">qepcad</span><span class="p">(</span><span class="s">&#39;(E x)[a x + b &gt; 0]&#39;</span><span class="p">,</span> <span class="nb">vars</span><span class="o">=</span><span class="s">&#39;(a,b,x)&#39;</span><span class="p">)</span>      <span class="c"># optional - qepcad</span>
<span class="go">a /= 0 \/ b &gt; 0</span>

<span class="gp">sage: </span><span class="n">qepcad</span><span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="n">b</span><span class="p">)</span>                            <span class="c"># optional - qepcad</span>
<span class="go">b - a &lt; 0</span>

<span class="gp">sage: </span><span class="n">qepcad</span><span class="p">(</span><span class="n">qf</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span>        <span class="c"># optional - qepcad</span>
<span class="go">4 a c - b^2 &lt;= 0 /\ [ c = 0 \/ a /= 0 \/ 4 a c - b^2 &lt; 0 ]</span>

<span class="gp">sage: </span><span class="n">qepcad</span><span class="p">(</span><span class="n">qf</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">),</span> <span class="n">assume</span><span class="o">=</span><span class="p">(</span><span class="n">a</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">))</span>    <span class="c"># optional - qepcad</span>
<span class="go">4 a c - b^2 &lt;= 0</span>
</pre></div>
</div>
<p>For which values of <span class="math">\(a\)</span>, <span class="math">\(b\)</span>, <span class="math">\(c\)</span> does <span class="math">\(a x^2 + b x + c\)</span> have
2 real zeroes?</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">exact2</span> <span class="o">=</span> <span class="n">qepcad</span><span class="p">(</span><span class="n">qf</span><span class="o">.</span><span class="n">exactly_k</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">));</span> <span class="n">exact2</span>   <span class="c"># optional - qepcad</span>
<span class="go">a /= 0 /\ 4 a c - b^2 &lt; 0</span>
</pre></div>
</div>
<p>one real zero?</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">exact1</span> <span class="o">=</span> <span class="n">qepcad</span><span class="p">(</span><span class="n">qf</span><span class="o">.</span><span class="n">exactly_k</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">));</span> <span class="n">exact1</span>   <span class="c"># optional - qepcad</span>
<span class="go">[ a &gt; 0 /\ 4 a c - b^2 = 0 ] \/ [ a &lt; 0 /\ 4 a c - b^2 = 0 ] \/ [ a = 0 /\ 4 a c - b^2 &lt; 0 ]</span>
</pre></div>
</div>
<p>No real zeroes?</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">exact0</span> <span class="o">=</span> <span class="n">qepcad</span><span class="p">(</span><span class="n">qf</span><span class="o">.</span><span class="n">forall</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">));</span> <span class="n">exact0</span>     <span class="c"># optional - qepcad</span>
<span class="go">4 a c - b^2 &gt;= 0 /\ c /= 0 /\ [ b = 0 \/ 4 a c - b^2 &gt; 0 ]</span>
</pre></div>
</div>
<p><span class="math">\(3^{75}\)</span> real zeroes?</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qepcad</span><span class="p">(</span><span class="n">qf</span><span class="o">.</span><span class="n">exactly_k</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">75</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span>    <span class="c"># optional - qepcad</span>
<span class="go">FALSE</span>
</pre></div>
</div>
<p>We can check that the results don&#8217;t overlap:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qepcad</span><span class="p">(</span><span class="s">r&#39;[[</span><span class="si">%s</span><span class="s">] /\ [</span><span class="si">%s</span><span class="s">]]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">exact0</span><span class="p">,</span> <span class="n">exact1</span><span class="p">),</span> <span class="nb">vars</span><span class="o">=</span><span class="s">&#39;a,b,c&#39;</span><span class="p">)</span>      <span class="c"># optional - qepcad</span>
<span class="go">FALSE</span>
<span class="gp">sage: </span><span class="n">qepcad</span><span class="p">(</span><span class="s">r&#39;[[</span><span class="si">%s</span><span class="s">] /\ [</span><span class="si">%s</span><span class="s">]]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">exact0</span><span class="p">,</span> <span class="n">exact2</span><span class="p">),</span> <span class="nb">vars</span><span class="o">=</span><span class="s">&#39;a,b,c&#39;</span><span class="p">)</span>      <span class="c"># optional - qepcad</span>
<span class="go">FALSE</span>
<span class="gp">sage: </span><span class="n">qepcad</span><span class="p">(</span><span class="s">r&#39;[[</span><span class="si">%s</span><span class="s">] /\ [</span><span class="si">%s</span><span class="s">]]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">exact1</span><span class="p">,</span> <span class="n">exact2</span><span class="p">),</span> <span class="nb">vars</span><span class="o">=</span><span class="s">&#39;a,b,c&#39;</span><span class="p">)</span>      <span class="c"># optional - qepcad</span>
<span class="go">FALSE</span>
</pre></div>
</div>
<p>and that the union of the results is as expected:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qepcad</span><span class="p">(</span><span class="s">r&#39;[[</span><span class="si">%s</span><span class="s">] \/ [</span><span class="si">%s</span><span class="s">] \/ [</span><span class="si">%s</span><span class="s">]]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">exact0</span><span class="p">,</span> <span class="n">exact1</span><span class="p">,</span> <span class="n">exact2</span><span class="p">),</span> <span class="nb">vars</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">))</span>  <span class="c"># optional - qepcad</span>
<span class="go">b /= 0 \/ a /= 0 \/ c /= 0</span>
</pre></div>
</div>
<p>So we have finitely many zeroes if <span class="math">\(a\)</span>, <span class="math">\(b\)</span>, or <span class="math">\(c\)</span> is nonzero;
which means we should have infinitely many zeroes if they are all
zero.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qepcad</span><span class="p">(</span><span class="n">qf</span><span class="o">.</span><span class="n">infinitely_many</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span>          <span class="c"># optional - qepcad</span>
<span class="go">a = 0 /\ b = 0 /\ c = 0</span>
</pre></div>
</div>
<p>The polynomial is nonzero almost everywhere iff it is not
identically zero.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qepcad</span><span class="p">(</span><span class="n">qf</span><span class="o">.</span><span class="n">all_but_finitely_many</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">))</span>    <span class="c"># optional - qepcad</span>
<span class="go">b /= 0 \/ a /= 0 \/ c /= 0</span>
</pre></div>
</div>
<p>The non-zeroes are continuous iff there are no zeroes or if
the polynomial is zero.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qepcad</span><span class="p">(</span><span class="n">qf</span><span class="o">.</span><span class="n">connected_subset</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">))</span>         <span class="c"># optional - qepcad</span>
<span class="go">4 a c - b^2 &gt;= 0 /\ [ a = 0 \/ 4 a c - b^2 &gt; 0 ]</span>
</pre></div>
</div>
<p>The zeroes are continuous iff there are no or one zeroes, or if the
polynomial is zero:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qepcad</span><span class="p">(</span><span class="n">qf</span><span class="o">.</span><span class="n">connected_subset</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span>         <span class="c"># optional - qepcad</span>
<span class="go">a = 0 \/ 4 a c - b^2 &gt;= 0</span>
<span class="gp">sage: </span><span class="n">qepcad</span><span class="p">(</span><span class="s">r&#39;[[</span><span class="si">%s</span><span class="s">] \/ [</span><span class="si">%s</span><span class="s">] \/ [a = 0 /\ b = 0 /\ c = 0]]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">exact0</span><span class="p">,</span> <span class="n">exact1</span><span class="p">),</span> <span class="nb">vars</span><span class="o">=</span><span class="s">&#39;a,b,c&#39;</span><span class="p">)</span>   <span class="c"># optional - qepcad</span>
<span class="go">a = 0 \/ 4 a c - b^2 &gt;= 0</span>
</pre></div>
</div>
<p>Since polynomials are continuous and <span class="math">\(y &gt; 0\)</span> is an open set,
they are positive infinitely often iff they are positive at
least once.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qepcad</span><span class="p">(</span><span class="n">qf</span><span class="o">.</span><span class="n">infinitely_many</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span>        <span class="c"># optional - qepcad</span>
<span class="go">c &gt; 0 \/ a &gt; 0 \/ 4 a c - b^2 &lt; 0</span>
<span class="gp">sage: </span><span class="n">qepcad</span><span class="p">(</span><span class="n">qf</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span>        <span class="c"># optional - qepcad</span>
<span class="go">c &gt; 0 \/ a &gt; 0 \/ 4 a c - b^2 &lt; 0</span>
</pre></div>
</div>
<p>However, since <span class="math">\(y &gt;= 0\)</span> is not open, the equivalence does not
hold if you replace &#8216;positive&#8217; with &#8216;nonnegative&#8217;.
(We assume <span class="math">\(a \neq 0\)</span> to get simpler formulas.)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qepcad</span><span class="p">(</span><span class="n">qf</span><span class="o">.</span><span class="n">infinitely_many</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">),</span> <span class="n">assume</span><span class="o">=</span><span class="p">(</span><span class="n">a</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">))</span>    <span class="c"># optional - qepcad</span>
<span class="go">a &gt; 0 \/ 4 a c - b^2 &lt; 0</span>
<span class="gp">sage: </span><span class="n">qepcad</span><span class="p">(</span><span class="n">qf</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">),</span> <span class="n">assume</span><span class="o">=</span><span class="p">(</span><span class="n">a</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">))</span>             <span class="c"># optional - qepcad</span>
<span class="go">a &gt; 0 \/ 4 a c - b^2 &lt;= 0</span>
</pre></div>
</div>
<p>TESTS:</p>
<p>We verify that long variable names work.  (Note that QEPCAD
does not support underscores, so they are stripped from the formula.)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qepcad</span><span class="p">(</span><span class="n">qf</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">long_with_underscore_314159</span> <span class="o">==</span> <span class="mi">1</span><span class="p">))</span>                <span class="c"># optional - qepcad</span>
<span class="go">longwithunderscore314159 /= 0</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.interfaces.qepcad.qepcad_banner">
<tt class="descclassname">sage.interfaces.qepcad.</tt><tt class="descname">qepcad_banner</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.qepcad_banner" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the QEPCAD startup banner.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.interfaces.qepcad</span> <span class="kn">import</span> <span class="n">qepcad_banner</span>
<span class="gp">sage: </span><span class="n">qepcad_banner</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">=======================================================</span>
<span class="go">                Quantifier Elimination</span>
<span class="go">                          in</span>
<span class="go">            Elementary Algebra and Geometry</span>
<span class="go">                          by</span>
<span class="go">      Partial Cylindrical Algebraic Decomposition</span>
<span class="gp">...</span>
<span class="go">                          by</span>
<span class="go">                       Hoon Hong</span>
<span class="go">                 (hhong@math.ncsu.edu)</span>
<span class="go">With contributions by: Christopher W. Brown, George E.</span>
<span class="go">Collins, Mark J. Encarnacion, Jeremy R. Johnson</span>
<span class="go">Werner Krandick, Richard Liska, Scott McCallum,</span>
<span class="go">Nicolas Robidoux, and Stanly Steinberg</span>
<span class="go">=======================================================</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.interfaces.qepcad.qepcad_console">
<tt class="descclassname">sage.interfaces.qepcad.</tt><tt class="descname">qepcad_console</tt><big>(</big><em>memcells=None</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.qepcad_console" title="Permalink to this definition">¶</a></dt>
<dd><p>Run QEPCAD directly.  To exit early, press Control-C.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qepcad_console</span><span class="p">()</span> <span class="c"># not tested</span>
<span class="gp">...</span>
<span class="go">Enter an informal description  between &#39;[&#39; and &#39;]&#39;:</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.interfaces.qepcad.qepcad_formula_factory">
<em class="property">class </em><tt class="descclassname">sage.interfaces.qepcad.</tt><tt class="descname">qepcad_formula_factory</tt><a class="headerlink" href="#sage.interfaces.qepcad.qepcad_formula_factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains routines to help construct formulas in QEPCAD syntax.</p>
<dl class="method">
<dt id="sage.interfaces.qepcad.qepcad_formula_factory.A">
<tt class="descname">A</tt><big>(</big><em>v</em>, <em>formula</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.qepcad_formula_factory.A" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a variable (or list of variables) and a formula, returns
the universal quantification of the formula over the variables.</p>
<p>This method is available both as <a class="reference internal" href="#sage.interfaces.qepcad.qepcad_formula_factory.forall" title="sage.interfaces.qepcad.qepcad_formula_factory.forall"><tt class="xref py py-meth docutils literal"><span class="pre">forall()</span></tt></a> and <a class="reference internal" href="#sage.interfaces.qepcad.qepcad_formula_factory.A" title="sage.interfaces.qepcad.qepcad_formula_factory.A"><tt class="xref py py-meth docutils literal"><span class="pre">A()</span></tt></a>
(the QEPCAD name for this quantifier).</p>
<p>The input formula may be a <a class="reference internal" href="#sage.interfaces.qepcad.qformula" title="sage.interfaces.qepcad.qformula"><tt class="xref py py-class docutils literal"><span class="pre">qformula</span></tt></a> as returned by the
methods of <tt class="docutils literal"><span class="pre">qepcad_formula</span></tt>, a symbolic equality or
inequality, or a polynomial <span class="math">\(p\)</span> (meaning <span class="math">\(p = 0\)</span>).</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a,b&#39;</span><span class="p">)</span>
<span class="go">(a, b)</span>
<span class="gp">sage: </span><span class="n">qf</span> <span class="o">=</span> <span class="n">qepcad_formula</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">forall</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span>
<span class="go">(A a)[a^2 + b &gt; b^2 + a]</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">forall</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">(A a)(A b)[a^2 + b^2 &gt; 0]</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">A</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">!=</span> <span class="n">a</span><span class="p">)</span>
<span class="go">(A b)[b^2 /= a]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.qepcad_formula_factory.C">
<tt class="descname">C</tt><big>(</big><em>v</em>, <em>formula</em>, <em>allow_multi=False</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.qepcad_formula_factory.C" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a variable and a formula, returns a new formula which is
true iff the set of values for the variable at which the
original formula was true is connected (including cases where
this set is empty or is a single point).</p>
<p>This method is available both as <a class="reference internal" href="#sage.interfaces.qepcad.qepcad_formula_factory.connected_subset" title="sage.interfaces.qepcad.qepcad_formula_factory.connected_subset"><tt class="xref py py-meth docutils literal"><span class="pre">connected_subset()</span></tt></a>
and <a class="reference internal" href="#sage.interfaces.qepcad.qepcad_formula_factory.C" title="sage.interfaces.qepcad.qepcad_formula_factory.C"><tt class="xref py py-meth docutils literal"><span class="pre">C()</span></tt></a> (the QEPCAD name for this quantifier).</p>
<p>The input formula may be a <a class="reference internal" href="#sage.interfaces.qepcad.qformula" title="sage.interfaces.qepcad.qformula"><tt class="xref py py-class docutils literal"><span class="pre">qformula</span></tt></a> as returned by the
methods of <tt class="docutils literal"><span class="pre">qepcad_formula</span></tt>, a symbolic equality or
inequality, or a polynomial <span class="math">\(p\)</span> (meaning <span class="math">\(p = 0\)</span>).</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a,b&#39;</span><span class="p">)</span>
<span class="go">(a, b)</span>
<span class="gp">sage: </span><span class="n">qf</span> <span class="o">=</span> <span class="n">qepcad_formula</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">connected_subset</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span>
<span class="go">(C a)[a^2 + b &gt; b^2 + a]</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">C</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">!=</span> <span class="n">a</span><span class="p">)</span>
<span class="go">(C b)[b^2 /= a]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.qepcad_formula_factory.E">
<tt class="descname">E</tt><big>(</big><em>v</em>, <em>formula</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.qepcad_formula_factory.E" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a variable (or list of variables) and a formula, returns
the existential quantification of the formula over the variables.</p>
<p>This method is available both as <a class="reference internal" href="#sage.interfaces.qepcad.qepcad_formula_factory.exists" title="sage.interfaces.qepcad.qepcad_formula_factory.exists"><tt class="xref py py-meth docutils literal"><span class="pre">exists()</span></tt></a> and <a class="reference internal" href="#sage.interfaces.qepcad.qepcad_formula_factory.E" title="sage.interfaces.qepcad.qepcad_formula_factory.E"><tt class="xref py py-meth docutils literal"><span class="pre">E()</span></tt></a>
(the QEPCAD name for this quantifier).</p>
<p>The input formula may be a <a class="reference internal" href="#sage.interfaces.qepcad.qformula" title="sage.interfaces.qepcad.qformula"><tt class="xref py py-class docutils literal"><span class="pre">qformula</span></tt></a> as returned by the
methods of <tt class="docutils literal"><span class="pre">qepcad_formula</span></tt>, a symbolic equality or
inequality, or a polynomial <span class="math">\(p\)</span> (meaning <span class="math">\(p = 0\)</span>).</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a,b&#39;</span><span class="p">)</span>
<span class="go">(a, b)</span>
<span class="gp">sage: </span><span class="n">qf</span> <span class="o">=</span> <span class="n">qepcad_formula</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span>
<span class="go">(E a)[a^2 + b &gt; b^2 + a]</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">exists</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">(E a)(E b)[a^2 + b^2 &lt; 0]</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">E</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">==</span> <span class="n">a</span><span class="p">)</span>
<span class="go">(E b)[b^2 = a]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.qepcad_formula_factory.F">
<tt class="descname">F</tt><big>(</big><em>v</em>, <em>formula</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.qepcad_formula_factory.F" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a variable and a formula, returns a new formula which is
true iff the original formula was true for infinitely many
values of the variable.</p>
<p>This method is available both as <a class="reference internal" href="#sage.interfaces.qepcad.qepcad_formula_factory.infinitely_many" title="sage.interfaces.qepcad.qepcad_formula_factory.infinitely_many"><tt class="xref py py-meth docutils literal"><span class="pre">infinitely_many()</span></tt></a>
and <a class="reference internal" href="#sage.interfaces.qepcad.qepcad_formula_factory.F" title="sage.interfaces.qepcad.qepcad_formula_factory.F"><tt class="xref py py-meth docutils literal"><span class="pre">F()</span></tt></a> (the QEPCAD name for this quantifier).</p>
<p>The input formula may be a <a class="reference internal" href="#sage.interfaces.qepcad.qformula" title="sage.interfaces.qepcad.qformula"><tt class="xref py py-class docutils literal"><span class="pre">qformula</span></tt></a> as returned by the
methods of <tt class="docutils literal"><span class="pre">qepcad_formula</span></tt>, a symbolic equality or
inequality, or a polynomial <span class="math">\(p\)</span> (meaning <span class="math">\(p = 0\)</span>).</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a,b&#39;</span><span class="p">)</span>
<span class="go">(a, b)</span>
<span class="gp">sage: </span><span class="n">qf</span> <span class="o">=</span> <span class="n">qepcad_formula</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">infinitely_many</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span>
<span class="go">(F a)[a^2 + b &gt; b^2 + a]</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">F</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">!=</span> <span class="n">a</span><span class="p">)</span>
<span class="go">(F b)[b^2 /= a]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.qepcad_formula_factory.G">
<tt class="descname">G</tt><big>(</big><em>v</em>, <em>formula</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.qepcad_formula_factory.G" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a variable and a formula, returns a new formula which is
true iff the original formula was true for all but finitely many
values of the variable.</p>
<p>This method is available both as <a class="reference internal" href="#sage.interfaces.qepcad.qepcad_formula_factory.all_but_finitely_many" title="sage.interfaces.qepcad.qepcad_formula_factory.all_but_finitely_many"><tt class="xref py py-meth docutils literal"><span class="pre">all_but_finitely_many()</span></tt></a>
and <a class="reference internal" href="#sage.interfaces.qepcad.qepcad_formula_factory.G" title="sage.interfaces.qepcad.qepcad_formula_factory.G"><tt class="xref py py-meth docutils literal"><span class="pre">G()</span></tt></a> (the QEPCAD name for this quantifier).</p>
<p>The input formula may be a <a class="reference internal" href="#sage.interfaces.qepcad.qformula" title="sage.interfaces.qepcad.qformula"><tt class="xref py py-class docutils literal"><span class="pre">qformula</span></tt></a> as returned by the
methods of <tt class="docutils literal"><span class="pre">qepcad_formula</span></tt>, a symbolic equality or
inequality, or a polynomial <span class="math">\(p\)</span> (meaning <span class="math">\(p = 0\)</span>).</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a,b&#39;</span><span class="p">)</span>
<span class="go">(a, b)</span>
<span class="gp">sage: </span><span class="n">qf</span> <span class="o">=</span> <span class="n">qepcad_formula</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">all_but_finitely_many</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span>
<span class="go">(G a)[a^2 + b &gt; b^2 + a]</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">G</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">!=</span> <span class="n">a</span><span class="p">)</span>
<span class="go">(G b)[b^2 /= a]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.qepcad_formula_factory.X">
<tt class="descname">X</tt><big>(</big><em>k</em>, <em>v</em>, <em>formula</em>, <em>allow_multi=False</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.qepcad_formula_factory.X" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a nonnegative integer <span class="math">\(k\)</span>, a variable, and a formula,
returns a new formula which is true iff the original formula
is true for exactly <span class="math">\(k\)</span> values of the variable.</p>
<p>This method is available both as <a class="reference internal" href="#sage.interfaces.qepcad.qepcad_formula_factory.exactly_k" title="sage.interfaces.qepcad.qepcad_formula_factory.exactly_k"><tt class="xref py py-meth docutils literal"><span class="pre">exactly_k()</span></tt></a>
and <a class="reference internal" href="#sage.interfaces.qepcad.qepcad_formula_factory.X" title="sage.interfaces.qepcad.qepcad_formula_factory.X"><tt class="xref py py-meth docutils literal"><span class="pre">X()</span></tt></a> (the QEPCAD name for this quantifier).</p>
<p>(Note that QEPCAD does not support <span class="math">\(k=0\)</span> with this syntax, so if
<span class="math">\(k=0\)</span> is requested we implement it with <a class="reference internal" href="#sage.interfaces.qepcad.qepcad_formula_factory.forall" title="sage.interfaces.qepcad.qepcad_formula_factory.forall"><tt class="xref py py-meth docutils literal"><span class="pre">forall()</span></tt></a> and
<a class="reference internal" href="#sage.interfaces.qepcad.qepcad_formula_factory.not_" title="sage.interfaces.qepcad.qepcad_formula_factory.not_"><tt class="xref py py-meth docutils literal"><span class="pre">not_()</span></tt></a>.)</p>
<p>The input formula may be a <a class="reference internal" href="#sage.interfaces.qepcad.qformula" title="sage.interfaces.qepcad.qformula"><tt class="xref py py-class docutils literal"><span class="pre">qformula</span></tt></a> as returned by the
methods of <tt class="docutils literal"><span class="pre">qepcad_formula</span></tt>, a symbolic equality or
inequality, or a polynomial <span class="math">\(p\)</span> (meaning <span class="math">\(p = 0\)</span>).</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a,b&#39;</span><span class="p">)</span>
<span class="go">(a, b)</span>
<span class="gp">sage: </span><span class="n">qf</span> <span class="o">=</span> <span class="n">qepcad_formula</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">exactly_k</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">(X1 x)[a x + x^2 + b = 0]</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">exactly_k</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">(A b)[~a b = 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.qepcad_formula_factory.all_but_finitely_many">
<tt class="descname">all_but_finitely_many</tt><big>(</big><em>v</em>, <em>formula</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.qepcad_formula_factory.all_but_finitely_many" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a variable and a formula, returns a new formula which is
true iff the original formula was true for all but finitely many
values of the variable.</p>
<p>This method is available both as <a class="reference internal" href="#sage.interfaces.qepcad.qepcad_formula_factory.all_but_finitely_many" title="sage.interfaces.qepcad.qepcad_formula_factory.all_but_finitely_many"><tt class="xref py py-meth docutils literal"><span class="pre">all_but_finitely_many()</span></tt></a>
and <a class="reference internal" href="#sage.interfaces.qepcad.qepcad_formula_factory.G" title="sage.interfaces.qepcad.qepcad_formula_factory.G"><tt class="xref py py-meth docutils literal"><span class="pre">G()</span></tt></a> (the QEPCAD name for this quantifier).</p>
<p>The input formula may be a <a class="reference internal" href="#sage.interfaces.qepcad.qformula" title="sage.interfaces.qepcad.qformula"><tt class="xref py py-class docutils literal"><span class="pre">qformula</span></tt></a> as returned by the
methods of <tt class="docutils literal"><span class="pre">qepcad_formula</span></tt>, a symbolic equality or
inequality, or a polynomial <span class="math">\(p\)</span> (meaning <span class="math">\(p = 0\)</span>).</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a,b&#39;</span><span class="p">)</span>
<span class="go">(a, b)</span>
<span class="gp">sage: </span><span class="n">qf</span> <span class="o">=</span> <span class="n">qepcad_formula</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">all_but_finitely_many</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span>
<span class="go">(G a)[a^2 + b &gt; b^2 + a]</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">G</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">!=</span> <span class="n">a</span><span class="p">)</span>
<span class="go">(G b)[b^2 /= a]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.qepcad_formula_factory.and_">
<tt class="descname">and_</tt><big>(</big><em>*formulas</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.qepcad_formula_factory.and_" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the conjunction of its input formulas.</p>
<p>(This method would be named &#8216;and&#8217; if that were not a Python
keyword.)</p>
<p>Each input formula may be a <a class="reference internal" href="#sage.interfaces.qepcad.qformula" title="sage.interfaces.qepcad.qformula"><tt class="xref py py-class docutils literal"><span class="pre">qformula</span></tt></a> as returned by the
methods of <tt class="docutils literal"><span class="pre">qepcad_formula</span></tt>, a symbolic equality or
inequality, or a polynomial <span class="math">\(p\)</span> (meaning <span class="math">\(p = 0\)</span>).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a,b,c,x&#39;</span><span class="p">)</span>
<span class="go">(a, b, c, x)</span>
<span class="gp">sage: </span><span class="n">qf</span> <span class="o">=</span> <span class="n">qepcad_formula</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">and_</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">c</span><span class="p">,</span> <span class="n">b</span><span class="o">*</span><span class="n">c</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">[a b = 0 /\ a c = 0 /\ b c /= 0]</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">and_</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> <span class="n">qf</span><span class="o">.</span><span class="n">or_</span><span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="n">b</span><span class="p">,</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="n">c</span><span class="p">))</span>
<span class="go">[a x^2 = 3 /\ [a &gt; b \/ b &gt; c]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.qepcad_formula_factory.atomic">
<tt class="descname">atomic</tt><big>(</big><em>lhs</em>, <em>op='='</em>, <em>rhs=0</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.qepcad_formula_factory.atomic" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a QEPCAD formula from the given inputs.</p>
<p>INPUT:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">lhs</span></tt> &#8211; a polynomial, or a symbolic equality or inequality</li>
<li><tt class="docutils literal"><span class="pre">op</span></tt> &#8211; a relational operator, default &#8216;=&#8217;</li>
<li><tt class="docutils literal"><span class="pre">rhs</span></tt> &#8211; a polynomial, default 0</li>
</ul>
<p>If <tt class="docutils literal"><span class="pre">lhs</span></tt> is a symbolic equality or inequality, then <tt class="docutils literal"><span class="pre">op</span></tt>
and <tt class="docutils literal"><span class="pre">rhs</span></tt> are ignored.</p>
<p>This method works by printing the given polynomials, so we do not
care what ring they are in (as long as they print with integral
or rational coefficients).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qf</span> <span class="o">=</span> <span class="n">qepcad_formula</span>
<span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a,b,c&#39;</span><span class="p">)</span>
<span class="go">(a, b, c)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="k">def</span> <span class="nf">test_qf</span><span class="p">(</span><span class="n">qf</span><span class="p">):</span>
<span class="go">....:     return qf, qf.vars</span>
<span class="gp">sage: </span><span class="n">test_qf</span><span class="p">(</span><span class="n">qf</span><span class="o">.</span><span class="n">atomic</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">17</span><span class="p">))</span>
<span class="go">(a^2 + 17 = 0, frozenset({&#39;a&#39;}))</span>
<span class="gp">sage: </span><span class="n">test_qf</span><span class="p">(</span><span class="n">qf</span><span class="o">.</span><span class="n">atomic</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">c</span> <span class="o">&lt;=</span> <span class="n">c</span><span class="o">^</span><span class="mi">3</span><span class="p">))</span>
<span class="go">(a b c &lt;= c^3, frozenset({&#39;a&#39;, &#39;b&#39;, &#39;c&#39;}))</span>
<span class="gp">sage: </span><span class="n">test_qf</span><span class="p">(</span><span class="n">qf</span><span class="o">.</span><span class="n">atomic</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="s">&#39;!=&#39;</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">))</span>
<span class="go">(y^2 + x /= a + b, frozenset({&#39;a&#39;, &#39;b&#39;, &#39;x&#39;, &#39;y&#39;}))</span>
<span class="gp">sage: </span><span class="n">test_qf</span><span class="p">(</span><span class="n">qf</span><span class="o">.</span><span class="n">atomic</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">lt</span><span class="p">))</span>
<span class="go">(x &lt; 0, frozenset({&#39;x&#39;}))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.qepcad_formula_factory.connected_subset">
<tt class="descname">connected_subset</tt><big>(</big><em>v</em>, <em>formula</em>, <em>allow_multi=False</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.qepcad_formula_factory.connected_subset" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a variable and a formula, returns a new formula which is
true iff the set of values for the variable at which the
original formula was true is connected (including cases where
this set is empty or is a single point).</p>
<p>This method is available both as <a class="reference internal" href="#sage.interfaces.qepcad.qepcad_formula_factory.connected_subset" title="sage.interfaces.qepcad.qepcad_formula_factory.connected_subset"><tt class="xref py py-meth docutils literal"><span class="pre">connected_subset()</span></tt></a>
and <a class="reference internal" href="#sage.interfaces.qepcad.qepcad_formula_factory.C" title="sage.interfaces.qepcad.qepcad_formula_factory.C"><tt class="xref py py-meth docutils literal"><span class="pre">C()</span></tt></a> (the QEPCAD name for this quantifier).</p>
<p>The input formula may be a <a class="reference internal" href="#sage.interfaces.qepcad.qformula" title="sage.interfaces.qepcad.qformula"><tt class="xref py py-class docutils literal"><span class="pre">qformula</span></tt></a> as returned by the
methods of <tt class="docutils literal"><span class="pre">qepcad_formula</span></tt>, a symbolic equality or
inequality, or a polynomial <span class="math">\(p\)</span> (meaning <span class="math">\(p = 0\)</span>).</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a,b&#39;</span><span class="p">)</span>
<span class="go">(a, b)</span>
<span class="gp">sage: </span><span class="n">qf</span> <span class="o">=</span> <span class="n">qepcad_formula</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">connected_subset</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span>
<span class="go">(C a)[a^2 + b &gt; b^2 + a]</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">C</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">!=</span> <span class="n">a</span><span class="p">)</span>
<span class="go">(C b)[b^2 /= a]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.qepcad_formula_factory.exactly_k">
<tt class="descname">exactly_k</tt><big>(</big><em>k</em>, <em>v</em>, <em>formula</em>, <em>allow_multi=False</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.qepcad_formula_factory.exactly_k" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a nonnegative integer <span class="math">\(k\)</span>, a variable, and a formula,
returns a new formula which is true iff the original formula
is true for exactly <span class="math">\(k\)</span> values of the variable.</p>
<p>This method is available both as <a class="reference internal" href="#sage.interfaces.qepcad.qepcad_formula_factory.exactly_k" title="sage.interfaces.qepcad.qepcad_formula_factory.exactly_k"><tt class="xref py py-meth docutils literal"><span class="pre">exactly_k()</span></tt></a>
and <a class="reference internal" href="#sage.interfaces.qepcad.qepcad_formula_factory.X" title="sage.interfaces.qepcad.qepcad_formula_factory.X"><tt class="xref py py-meth docutils literal"><span class="pre">X()</span></tt></a> (the QEPCAD name for this quantifier).</p>
<p>(Note that QEPCAD does not support <span class="math">\(k=0\)</span> with this syntax, so if
<span class="math">\(k=0\)</span> is requested we implement it with <a class="reference internal" href="#sage.interfaces.qepcad.qepcad_formula_factory.forall" title="sage.interfaces.qepcad.qepcad_formula_factory.forall"><tt class="xref py py-meth docutils literal"><span class="pre">forall()</span></tt></a> and
<a class="reference internal" href="#sage.interfaces.qepcad.qepcad_formula_factory.not_" title="sage.interfaces.qepcad.qepcad_formula_factory.not_"><tt class="xref py py-meth docutils literal"><span class="pre">not_()</span></tt></a>.)</p>
<p>The input formula may be a <a class="reference internal" href="#sage.interfaces.qepcad.qformula" title="sage.interfaces.qepcad.qformula"><tt class="xref py py-class docutils literal"><span class="pre">qformula</span></tt></a> as returned by the
methods of <tt class="docutils literal"><span class="pre">qepcad_formula</span></tt>, a symbolic equality or
inequality, or a polynomial <span class="math">\(p\)</span> (meaning <span class="math">\(p = 0\)</span>).</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a,b&#39;</span><span class="p">)</span>
<span class="go">(a, b)</span>
<span class="gp">sage: </span><span class="n">qf</span> <span class="o">=</span> <span class="n">qepcad_formula</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">exactly_k</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">(X1 x)[a x + x^2 + b = 0]</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">exactly_k</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">(A b)[~a b = 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.qepcad_formula_factory.exists">
<tt class="descname">exists</tt><big>(</big><em>v</em>, <em>formula</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.qepcad_formula_factory.exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a variable (or list of variables) and a formula, returns
the existential quantification of the formula over the variables.</p>
<p>This method is available both as <a class="reference internal" href="#sage.interfaces.qepcad.qepcad_formula_factory.exists" title="sage.interfaces.qepcad.qepcad_formula_factory.exists"><tt class="xref py py-meth docutils literal"><span class="pre">exists()</span></tt></a> and <a class="reference internal" href="#sage.interfaces.qepcad.qepcad_formula_factory.E" title="sage.interfaces.qepcad.qepcad_formula_factory.E"><tt class="xref py py-meth docutils literal"><span class="pre">E()</span></tt></a>
(the QEPCAD name for this quantifier).</p>
<p>The input formula may be a <a class="reference internal" href="#sage.interfaces.qepcad.qformula" title="sage.interfaces.qepcad.qformula"><tt class="xref py py-class docutils literal"><span class="pre">qformula</span></tt></a> as returned by the
methods of <tt class="docutils literal"><span class="pre">qepcad_formula</span></tt>, a symbolic equality or
inequality, or a polynomial <span class="math">\(p\)</span> (meaning <span class="math">\(p = 0\)</span>).</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a,b&#39;</span><span class="p">)</span>
<span class="go">(a, b)</span>
<span class="gp">sage: </span><span class="n">qf</span> <span class="o">=</span> <span class="n">qepcad_formula</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span>
<span class="go">(E a)[a^2 + b &gt; b^2 + a]</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">exists</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">(E a)(E b)[a^2 + b^2 &lt; 0]</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">E</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">==</span> <span class="n">a</span><span class="p">)</span>
<span class="go">(E b)[b^2 = a]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.qepcad_formula_factory.forall">
<tt class="descname">forall</tt><big>(</big><em>v</em>, <em>formula</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.qepcad_formula_factory.forall" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a variable (or list of variables) and a formula, returns
the universal quantification of the formula over the variables.</p>
<p>This method is available both as <a class="reference internal" href="#sage.interfaces.qepcad.qepcad_formula_factory.forall" title="sage.interfaces.qepcad.qepcad_formula_factory.forall"><tt class="xref py py-meth docutils literal"><span class="pre">forall()</span></tt></a> and <a class="reference internal" href="#sage.interfaces.qepcad.qepcad_formula_factory.A" title="sage.interfaces.qepcad.qepcad_formula_factory.A"><tt class="xref py py-meth docutils literal"><span class="pre">A()</span></tt></a>
(the QEPCAD name for this quantifier).</p>
<p>The input formula may be a <a class="reference internal" href="#sage.interfaces.qepcad.qformula" title="sage.interfaces.qepcad.qformula"><tt class="xref py py-class docutils literal"><span class="pre">qformula</span></tt></a> as returned by the
methods of <tt class="docutils literal"><span class="pre">qepcad_formula</span></tt>, a symbolic equality or
inequality, or a polynomial <span class="math">\(p\)</span> (meaning <span class="math">\(p = 0\)</span>).</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a,b&#39;</span><span class="p">)</span>
<span class="go">(a, b)</span>
<span class="gp">sage: </span><span class="n">qf</span> <span class="o">=</span> <span class="n">qepcad_formula</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">forall</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span>
<span class="go">(A a)[a^2 + b &gt; b^2 + a]</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">forall</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">(A a)(A b)[a^2 + b^2 &gt; 0]</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">A</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">!=</span> <span class="n">a</span><span class="p">)</span>
<span class="go">(A b)[b^2 /= a]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.qepcad_formula_factory.formula">
<tt class="descname">formula</tt><big>(</big><em>formula</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.qepcad_formula_factory.formula" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs a QEPCAD formula from the given input.</p>
<p>INPUTS:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">formula</span></tt> &#8211; a polynomial, a symbolic equality or inequality,
or a list of polynomials, equalities, or inequalities</li>
</ul>
<p>A polynomial <span class="math">\(p\)</span> is interpreted as the equation <span class="math">\(p = 0\)</span>.
A list is interpreted as the conjunction (&#8216;and&#8217;) of the elements.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a,b,c,x&#39;</span><span class="p">)</span>
<span class="go">(a, b, c, x)</span>
<span class="gp">sage: </span><span class="n">qf</span> <span class="o">=</span> <span class="n">qepcad_formula</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">formula</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>
<span class="go">a x + b = 0</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">formula</span><span class="p">((</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span><span class="p">,</span> <span class="n">a</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">))</span>
<span class="go">[a x^2 + b x + c = 0 /\ a /= 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.qepcad_formula_factory.iff">
<tt class="descname">iff</tt><big>(</big><em>f1</em>, <em>f2</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.qepcad_formula_factory.iff" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the equivalence of its input formulas (that is, given
formulas <span class="math">\(P\)</span> and <span class="math">\(Q\)</span>, returns &#8216;<span class="math">\(P\)</span> iff <span class="math">\(Q\)</span>&#8216;).</p>
<p>The input formulas may be a <a class="reference internal" href="#sage.interfaces.qepcad.qformula" title="sage.interfaces.qepcad.qformula"><tt class="xref py py-class docutils literal"><span class="pre">qformula</span></tt></a> as returned by the
methods of <tt class="docutils literal"><span class="pre">qepcad_formula</span></tt>, a symbolic equality or
inequality, or a polynomial <span class="math">\(p\)</span> (meaning <span class="math">\(p = 0\)</span>).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a,b&#39;</span><span class="p">)</span>
<span class="go">(a, b)</span>
<span class="gp">sage: </span><span class="n">qf</span> <span class="o">=</span> <span class="n">qepcad_formula</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">iff</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="go">[a = 0 &lt;==&gt; b = 0]</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">iff</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">a</span><span class="p">)</span>
<span class="go">[a^2 &lt; b &lt;==&gt; b^2 &lt; a]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.qepcad_formula_factory.implies">
<tt class="descname">implies</tt><big>(</big><em>f1</em>, <em>f2</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.qepcad_formula_factory.implies" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the implication of its input formulas (that is, given
formulas <span class="math">\(P\)</span> and <span class="math">\(Q\)</span>, returns &#8216;<span class="math">\(P\)</span> implies <span class="math">\(Q\)</span>&#8216;).</p>
<p>The input formulas may be a <a class="reference internal" href="#sage.interfaces.qepcad.qformula" title="sage.interfaces.qepcad.qformula"><tt class="xref py py-class docutils literal"><span class="pre">qformula</span></tt></a> as returned by the
methods of <tt class="docutils literal"><span class="pre">qepcad_formula</span></tt>, a symbolic equality or
inequality, or a polynomial <span class="math">\(p\)</span> (meaning <span class="math">\(p = 0\)</span>).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a,b&#39;</span><span class="p">)</span>
<span class="go">(a, b)</span>
<span class="gp">sage: </span><span class="n">qf</span> <span class="o">=</span> <span class="n">qepcad_formula</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">implies</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="go">[a = 0 ==&gt; b = 0]</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">implies</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">a</span><span class="p">)</span>
<span class="go">[a^2 &lt; b ==&gt; b^2 &lt; a]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.qepcad_formula_factory.infinitely_many">
<tt class="descname">infinitely_many</tt><big>(</big><em>v</em>, <em>formula</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.qepcad_formula_factory.infinitely_many" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a variable and a formula, returns a new formula which is
true iff the original formula was true for infinitely many
values of the variable.</p>
<p>This method is available both as <a class="reference internal" href="#sage.interfaces.qepcad.qepcad_formula_factory.infinitely_many" title="sage.interfaces.qepcad.qepcad_formula_factory.infinitely_many"><tt class="xref py py-meth docutils literal"><span class="pre">infinitely_many()</span></tt></a>
and <a class="reference internal" href="#sage.interfaces.qepcad.qepcad_formula_factory.F" title="sage.interfaces.qepcad.qepcad_formula_factory.F"><tt class="xref py py-meth docutils literal"><span class="pre">F()</span></tt></a> (the QEPCAD name for this quantifier).</p>
<p>The input formula may be a <a class="reference internal" href="#sage.interfaces.qepcad.qformula" title="sage.interfaces.qepcad.qformula"><tt class="xref py py-class docutils literal"><span class="pre">qformula</span></tt></a> as returned by the
methods of <tt class="docutils literal"><span class="pre">qepcad_formula</span></tt>, a symbolic equality or
inequality, or a polynomial <span class="math">\(p\)</span> (meaning <span class="math">\(p = 0\)</span>).</p>
<p>EXAMPLE:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a,b&#39;</span><span class="p">)</span>
<span class="go">(a, b)</span>
<span class="gp">sage: </span><span class="n">qf</span> <span class="o">=</span> <span class="n">qepcad_formula</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">infinitely_many</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span>
<span class="go">(F a)[a^2 + b &gt; b^2 + a]</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">F</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">!=</span> <span class="n">a</span><span class="p">)</span>
<span class="go">(F b)[b^2 /= a]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.qepcad_formula_factory.not_">
<tt class="descname">not_</tt><big>(</big><em>formula</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.qepcad_formula_factory.not_" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the negation of its input formula.</p>
<p>(This method would be named &#8216;not&#8217; if that were not a Python
keyword.)</p>
<p>The input formula may be a <a class="reference internal" href="#sage.interfaces.qepcad.qformula" title="sage.interfaces.qepcad.qformula"><tt class="xref py py-class docutils literal"><span class="pre">qformula</span></tt></a> as returned by the
methods of <tt class="docutils literal"><span class="pre">qepcad_formula</span></tt>, a symbolic equality or
inequality, or a polynomial <span class="math">\(p\)</span> (meaning <span class="math">\(p = 0\)</span>).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a,b&#39;</span><span class="p">)</span>
<span class="go">(a, b)</span>
<span class="gp">sage: </span><span class="n">qf</span> <span class="o">=</span> <span class="n">qepcad_formula</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">not_</span><span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="n">b</span><span class="p">)</span>
<span class="go">[~a &gt; b]</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">not_</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[~a^2 + b^2 = 0]</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">not_</span><span class="p">(</span><span class="n">qf</span><span class="o">.</span><span class="n">and_</span><span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">))</span>
<span class="go">[~[a &gt; 0 /\ b &lt; 0]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.qepcad_formula_factory.or_">
<tt class="descname">or_</tt><big>(</big><em>*formulas</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.qepcad_formula_factory.or_" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the disjunction of its input formulas.</p>
<p>(This method would be named &#8216;or&#8217; if that were not a Python
keyword.)</p>
<p>Each input formula may be a <a class="reference internal" href="#sage.interfaces.qepcad.qformula" title="sage.interfaces.qepcad.qformula"><tt class="xref py py-class docutils literal"><span class="pre">qformula</span></tt></a> as returned by the
methods of <tt class="docutils literal"><span class="pre">qepcad_formula</span></tt>, a symbolic equality or
inequality, or a polynomial <span class="math">\(p\)</span> (meaning <span class="math">\(p = 0\)</span>).</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a,b,c,x&#39;</span><span class="p">)</span>
<span class="go">(a, b, c, x)</span>
<span class="gp">sage: </span><span class="n">qf</span> <span class="o">=</span> <span class="n">qepcad_formula</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">or_</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">c</span><span class="p">,</span> <span class="n">b</span><span class="o">*</span><span class="n">c</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">[a b = 0 \/ a c = 0 \/ b c /= 0]</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">or_</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> <span class="n">qf</span><span class="o">.</span><span class="n">and_</span><span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="n">b</span><span class="p">,</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="n">c</span><span class="p">))</span>
<span class="go">[a x^2 = 3 \/ [a &gt; b /\ b &gt; c]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.interfaces.qepcad.qepcad_formula_factory.quantifier">
<tt class="descname">quantifier</tt><big>(</big><em>kind</em>, <em>v</em>, <em>formula</em>, <em>allow_multi=True</em><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.qepcad_formula_factory.quantifier" title="Permalink to this definition">¶</a></dt>
<dd><p>A helper method for building quantified QEPCAD formulas; not
expected to be called directly.</p>
<p>Takes the quantifier kind (the string label of this quantifier),
a variable or list of variables, and a formula, and returns
the quantified formula.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;a,b&#39;</span><span class="p">)</span>
<span class="go">(a, b)</span>
<span class="gp">sage: </span><span class="n">qf</span> <span class="o">=</span> <span class="n">qepcad_formula</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">quantifier</span><span class="p">(</span><span class="s">&#39;NOT_A_REAL_QEPCAD_QUANTIFIER&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(NOT_A_REAL_QEPCAD_QUANTIFIER a)[a b = 0]</span>
<span class="gp">sage: </span><span class="n">qf</span><span class="o">.</span><span class="n">quantifier</span><span class="p">(</span><span class="s">&#39;FOO&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span>
<span class="go">(FOO a)(FOO b)[a b = 0]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sage.interfaces.qepcad.qepcad_version">
<tt class="descclassname">sage.interfaces.qepcad.</tt><tt class="descname">qepcad_version</tt><big>(</big><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.qepcad_version" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a string containing the current QEPCAD version number.</p>
<p>EXAMPLES:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qepcad_version</span><span class="p">()</span> <span class="c"># random, optional - qepcad</span>
<span class="go">&#39;Version B 1.48, 25 Oct 2007&#39;</span>
</pre></div>
</div>
<p>TESTS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">sage: </span><span class="n">qepcad_version</span><span class="p">()</span> <span class="c"># optional - qepcad</span>
<span class="go">&#39;Version B ..., ...&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.interfaces.qepcad.qformula">
<em class="property">class </em><tt class="descclassname">sage.interfaces.qepcad.</tt><tt class="descname">qformula</tt><big>(</big><em>formula</em>, <em>vars</em>, <em>qvars=</em><span class="optional">[</span><span class="optional">]</span><big>)</big><a class="headerlink" href="#sage.interfaces.qepcad.qformula" title="Permalink to this definition">¶</a></dt>
<dd><p>A qformula holds a string describing a formula in QEPCAD&#8217;s syntax,
and a set of variables used.</p>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="psage.html"
                                  title="previous chapter">Parallel Interface to the Sage interpreter</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="qsieve.html"
                                  title="next chapter">Interface to Bill Hart&#8217;s Quadratic Sieve</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../_sources/sage/interfaces/qepcad.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="qsieve.html" title="Interface to Bill Hart’s Quadratic Sieve"
             >next</a> |</li>
        <li class="right" >
          <a href="psage.html" title="Parallel Interface to the Sage interpreter"
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li><a href="../../index.html">Interpreter Interfaces</a> &raquo;</li>
 
      </ul>
    </div>
    
    <div class="footer">
        &copy; Copyright 2005--2015, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>