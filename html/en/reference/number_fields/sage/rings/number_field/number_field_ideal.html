<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="Relative Number Field Ideals" href="number_field_ideal_rel.html" /><link rel="prev" title="Orders in Number Fields" href="order.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2022.09.29"/>
        <title>Number Field Ideals - Algebraic Numbers and Number Fields</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom-furo.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #0f0fff;
  --color-brand-content: #0f0fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZGD13B5572"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-ZGD13B5572');
</script></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Algebraic Numbers and Number Fields</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../../_static/logo_sagemath_black.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../../_static/logo_sagemath_white.svg" alt="Dark Logo"/>
  </div>
  
      <span class="sidebar-brand-text">Sage 9.8 Reference Manual</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-home">
  <div class="sidebar-tree">
    <ul><li class="toctree-l1">
      <a class="reference internal" href="../../../index.html">Home - Algebraic Numbers and Number Fields</a>
    </li></ul>
  </div>
</div><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="number_field.html">Number Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="number_field_base.html">Base class for all number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="number_field_rel.html">Relative Number Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="number_field_element.html">Number Field Elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="number_field_element_quadratic.html">Optimized Quadratic Number Field Elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="splitting_field.html">Splitting fields of polynomials over number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="galois_group.html">Galois Groups of Number Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="bdd_height.html">Elements of bounded height in number fields</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="morphism.html">Morphisms between number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="homset.html">Sets of homomorphisms between number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="number_field_morphisms.html">Embeddings into ambient fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="maps.html">Structure maps for number fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="structure.html">Helper classes for structural embeddings and isomorphisms of number fields</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="order.html">Orders in Number Fields</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Number Field Ideals</a></li>
<li class="toctree-l1"><a class="reference internal" href="number_field_ideal_rel.html">Relative Number Field Ideals</a></li>
<li class="toctree-l1"><a class="reference internal" href="class_group.html">Class Groups of Number Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="unit_group.html">Unit and S-unit groups of Number Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="S_unit_solver.html">Solve S-unit equation x + y = 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="small_primes_of_degree_one.html">Small primes of degree one</a></li>
<li class="toctree-l1"><a class="reference internal" href="selmer_group.html"><span class="math notranslate nohighlight">\(p\)</span>-Selmer groups of number fields</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="totallyreal.html">Enumeration of Primitive Totally Real Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="totallyreal_rel.html">Enumeration of Totally Real Fields: Relative Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="totallyreal_data.html">Enumeration of Totally Real Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="totallyreal_phc.html">Enumeration of Totally Real Fields: PHC interface</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../qqbar.html">Field of Algebraic Numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../universal_cyclotomic_field.html">Universal cyclotomic field</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="number-field-ideals">
<span id="sage-rings-number-field-number-field-ideal"></span><h1>Number Field Ideals<a class="headerlink" href="#number-field-ideals" title="Permalink to this heading">#</a></h1>
<span class="target" id="module-sage.rings.number_field.number_field_ideal"></span><p>AUTHORS:</p>
<ul class="simple">
<li><p>Steven Sivek (2005-05-16)</p></li>
<li><p>William Stein (2007-09-06): vastly improved the doctesting</p></li>
<li><p>William Stein and John Cremona (2007-01-28): new class
NumberFieldFractionalIdeal now used for all except the 0 ideal</p></li>
<li><dl class="simple">
<dt>Radoslav Kirov and Alyson Deines (2010-06-22):</dt><dd><p>prime_to_S_part, is_S_unit, is_S_integral</p>
</dd>
</dl>
</li>
</ul>
<p>We test that pickling works:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">5</span><span class="o">+</span><span class="n">a</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">==</span> <span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">I</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.LiftMap">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.rings.number_field.number_field_ideal.</span></span><span class="sig-name descname"><span class="pre">LiftMap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">OK</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M_OK_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">I</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.LiftMap" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to hold data needed by lifting maps from residue fields to
number field orders.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.rings.number_field.number_field_ideal.</span></span><span class="sig-name descname"><span class="pre">NumberFieldFractionalIdeal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coerce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/element.html#sage.structure.element.MultiplicativeGroupElement" title="(in Parents and Elements v9.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiplicativeGroupElement</span></code></a>, <a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal" title="sage.rings.number_field.number_field_ideal.NumberFieldIdeal"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumberFieldIdeal</span></code></a>, <a class="reference external" href="../../../../rings/sage/rings/ideal.html#sage.rings.ideal.Ideal_fractional" title="(in General Rings, Ideals, and Morphisms v9.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Ideal_fractional</span></code></a></p>
<p>A fractional ideal in a number field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">5</span><span class="o">+</span><span class="n">a</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">I</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">Jinv</span> <span class="o">=</span> <span class="n">I</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">*</span><span class="n">Jinv</span>
<span class="go">Fractional ideal (1)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.denominator">
<span class="sig-name descname"><span class="pre">denominator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.denominator" title="Permalink to this definition">#</a></dt>
<dd><p>Return the denominator ideal of this fractional ideal. Each
fractional ideal has a unique expression as <span class="math notranslate nohighlight">\(N/D\)</span> where <span class="math notranslate nohighlight">\(N\)</span>,
<span class="math notranslate nohighlight">\(D\)</span> are coprime integral ideals; the denominator is <span class="math notranslate nohighlight">\(D\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">((</span><span class="mi">3</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">);</span> <span class="n">I</span>
<span class="go">Fractional ideal (4/5*i + 3/5)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span>
<span class="go">Fractional ideal (2*i + 1)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span>
<span class="go">Fractional ideal (-i - 2)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span> <span class="ow">and</span> <span class="n">I</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span> <span class="o">+</span> <span class="n">I</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">==</span> <span class="n">K</span><span class="o">.</span><span class="n">unit_ideal</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span><span class="o">/</span><span class="n">I</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">==</span> <span class="n">I</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.divides">
<span class="sig-name descname"><span class="pre">divides</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.divides" title="Permalink to this definition">#</a></dt>
<dd><p>Returns True if this ideal divides other and False otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">11</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Cyclotomic Field of order 11 and degree 10</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">31</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span> <span class="n">I</span>
<span class="go">Fractional ideal (31, a^5 + 10*a^4 - a^3 + a^2 + 9*a - 1)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">divides</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">divides</span><span class="p">(</span><span class="mi">31</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">divides</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.element_1_mod">
<span class="sig-name descname"><span class="pre">element_1_mod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.element_1_mod" title="Permalink to this definition">#</a></dt>
<dd><p>Returns an element <span class="math notranslate nohighlight">\(r\)</span> in this ideal such that <span class="math notranslate nohighlight">\(1-r\)</span> is in other</p>
<p>An error is raised if either ideal is not integral of if they
are not coprime.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> – another ideal of the same field, or generators
of an ideal.</p></li>
</ul>
<p>OUTPUT:</p>
<p>An element <span class="math notranslate nohighlight">\(r\)</span> of the ideal self such that <span class="math notranslate nohighlight">\(1-r\)</span> is in the ideal other</p>
<p>AUTHOR: Maite Aranes (modified to use PARI’s <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/idealaddtoone">pari:idealaddtoone</a> by Francis Clarke)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span> <span class="n">A</span><span class="p">;</span> <span class="n">A</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">Fractional ideal (a + 1)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">2</span><span class="p">);</span> <span class="n">B</span><span class="p">;</span> <span class="n">B</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">Fractional ideal (a^2 - 4*a + 2)</span>
<span class="go">68</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">element_1_mod</span><span class="p">(</span><span class="n">B</span><span class="p">);</span> <span class="n">r</span>
<span class="go">-33</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="ow">in</span> <span class="n">A</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="mi">1</span><span class="o">-</span><span class="n">r</span> <span class="ow">in</span> <span class="n">B</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.euler_phi">
<span class="sig-name descname"><span class="pre">euler_phi</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.euler_phi" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the Euler <span class="math notranslate nohighlight">\(\varphi\)</span>-function of this integral ideal.</p>
<p>This is the order of the multiplicative group of the quotient
modulo the ideal.</p>
<p>An error is raised if the ideal is not integral.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">I</span><span class="o">.</span><span class="n">residues</span><span class="p">()</span> <span class="k">if</span> <span class="n">I</span><span class="o">.</span><span class="n">is_coprime</span><span class="p">(</span><span class="n">r</span><span class="p">)]</span>
<span class="go">[-2*i, -i, i, 2*i]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">euler_phi</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">I</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">euler_phi</span><span class="p">()</span>
<span class="go">100</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">([</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">J</span><span class="o">.</span><span class="n">residues</span><span class="p">()</span> <span class="k">if</span> <span class="n">J</span><span class="o">.</span><span class="n">is_coprime</span><span class="p">(</span><span class="n">r</span><span class="p">)])</span>
<span class="go">100</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">is_coprime</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">euler_phi</span><span class="p">()</span><span class="o">*</span><span class="n">J</span><span class="o">.</span><span class="n">euler_phi</span><span class="p">()</span> <span class="o">==</span> <span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">J</span><span class="p">)</span><span class="o">.</span><span class="n">euler_phi</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">euler_phi</span><span class="p">()</span>
<span class="go">64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.factor">
<span class="sig-name descname"><span class="pre">factor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.factor" title="Permalink to this definition">#</a></dt>
<dd><p>Factorization of this ideal in terms of prime ideals.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">23</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in a with defining polynomial x^4 + 23</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">19</span><span class="p">);</span> <span class="n">I</span>
<span class="go">Fractional ideal (19)</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">factor</span><span class="p">();</span> <span class="n">F</span>
<span class="go">(Fractional ideal (19, 1/2*a^2 + a - 17/2)) * (Fractional ideal (19, 1/2*a^2 - a - 17/2))</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.structure.factorization.Factorization&#39;&gt;</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="go">[(Fractional ideal (19, 1/2*a^2 + a - 17/2), 1), (Fractional ideal (19, 1/2*a^2 - a - 17/2), 1)]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">prod</span><span class="p">()</span>
<span class="go">Fractional ideal (19)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.idealcoprime">
<span class="sig-name descname"><span class="pre">idealcoprime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">J</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.idealcoprime" title="Permalink to this definition">#</a></dt>
<dd><p>Returns l such that l*self is coprime to J.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">J</span></code> - another integral ideal of the same field as self, which must also be integral.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">l</span></code> - an element such that l*self is coprime to the ideal J</p></li>
</ul>
<p>TODO: Extend the implementation to non-integral ideals.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_coprime</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">lam</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">idealcoprime</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">lam</span>  <span class="c1"># representation depends, not tested</span>
<span class="go">-1/6*a + 1/6</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">lam</span><span class="o">*</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">is_coprime</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>ALGORITHM: Uses Pari function <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/idealcoprime">pari:idealcoprime</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.ideallog">
<span class="sig-name descname"><span class="pre">ideallog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.ideallog" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the discrete logarithm of x with respect to the generators
given in the <code class="docutils literal notranslate"><span class="pre">bid</span></code> structure of the ideal self, or with respect to
the generators <code class="docutils literal notranslate"><span class="pre">gens</span></code> if these are given.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> - a non-zero element of the number field of self,
which must have valuation equal to 0 at all prime ideals in
the support of the ideal self.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gens</span></code> - a list of elements of the number field which generate <span class="math notranslate nohighlight">\((R
/ I)^*\)</span>, where <span class="math notranslate nohighlight">\(R\)</span> is the ring of integers of the field and <span class="math notranslate nohighlight">\(I\)</span> is
this ideal, or <code class="docutils literal notranslate"><span class="pre">None</span></code>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, use the generators calculated
by <a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.idealstar" title="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.idealstar"><code class="xref py py-meth docutils literal notranslate"><span class="pre">idealstar()</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> - if True, do a consistency check on the results. Ignored
if <code class="docutils literal notranslate"><span class="pre">gens</span></code> is None.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">l</span></code> - a list of non-negative integers <span class="math notranslate nohighlight">\((x_i)\)</span> such that <span class="math notranslate nohighlight">\(x =
\prod_i g_i^{x_i}\)</span> in <span class="math notranslate nohighlight">\((R/I)^*\)</span>, where <span class="math notranslate nohighlight">\(x_i\)</span> are the generators, and
the list <span class="math notranslate nohighlight">\((x_i)\)</span> is lexicographically minimal with respect to this
requirement. If the <span class="math notranslate nohighlight">\(x_i\)</span> generate independent cyclic factors of
order <span class="math notranslate nohighlight">\(d_i\)</span>, as is the case for the default generators calculated by
<a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.idealstar" title="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.idealstar"><code class="xref py py-meth docutils literal notranslate"><span class="pre">idealstar()</span></code></a>, this just means that <span class="math notranslate nohighlight">\(0 \le x_i &lt; d_i\)</span>.</p></li>
</ul>
<p>A <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> will be raised if the elements specified in <code class="docutils literal notranslate"><span class="pre">gens</span></code>
do not in fact generate the unit group (even if the element <span class="math notranslate nohighlight">\(x\)</span> is in
the subgroup they generate).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">idealstar</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">l</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">ideallog</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">G</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">A</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">small_residue</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="c1"># random</span>
<span class="go">a^2 - 2</span>
</pre></div>
</div>
<p>Examples with custom generators:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">ideallog</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mi">7</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="go">[10, 3]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">ideallog</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mi">7</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="p">])</span>
<span class="go">[0, 118]</span>

<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="o">-</span><span class="n">b</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="o">-</span><span class="mi">14</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">21</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">b</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">ideallog</span><span class="p">(</span><span class="mi">5</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="p">,</span> <span class="p">[</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">],</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[4, 13]</span>
</pre></div>
</div>
<p>A non-example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">ideallog</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mi">7</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Given elements do not generate unit group -- they generate a subgroup of index 36</span>
</pre></div>
</div>
<p>ALGORITHM: Uses Pari function <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/ideallog">pari:ideallog</a>, and (if <code class="docutils literal notranslate"><span class="pre">gens</span></code> is not
None) a Hermite normal form calculation to express the result in terms
of the generators <code class="docutils literal notranslate"><span class="pre">gens</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.idealstar">
<span class="sig-name descname"><span class="pre">idealstar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.idealstar" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the finite abelian group <span class="math notranslate nohighlight">\((O_K/I)^*\)</span>, where I is the ideal self
of the number field K, and <span class="math notranslate nohighlight">\(O_K\)</span> is the ring of integers of K.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">flag</span></code> (int default 1) – when <code class="docutils literal notranslate"><span class="pre">flag</span></code> =2, it also
computes the generators of the group <span class="math notranslate nohighlight">\((O_K/I)^*\)</span>, which
takes more time. By default <code class="docutils literal notranslate"><span class="pre">flag</span></code> =1 (no generators are
computed). In both cases the special pari structure <code class="docutils literal notranslate"><span class="pre">bid</span></code>
is computed as well.  If <code class="docutils literal notranslate"><span class="pre">flag</span></code> =0 (deprecated) it computes
only the group structure of <span class="math notranslate nohighlight">\((O_K/I)^*\)</span> (with generators)
and not the special <code class="docutils literal notranslate"><span class="pre">bid</span></code> structure.</p></li>
</ul>
<p>OUTPUT:</p>
<p>The finite abelian group <span class="math notranslate nohighlight">\((O_K/I)^*\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Uses the pari function <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/idealstar">pari:idealstar</a>. The pari function outputs
a special <code class="docutils literal notranslate"><span class="pre">bid</span></code> structure which is stored in the internal
field <code class="docutils literal notranslate"><span class="pre">_bid</span></code> of the ideal (when flag=1,2). The special structure
<code class="docutils literal notranslate"><span class="pre">bid</span></code> is used in the pari function <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/ideallog">pari:ideallog</a>
to compute discrete logarithms.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">idealstar</span><span class="p">();</span> <span class="n">G</span>
<span class="go">Multiplicative Abelian group isomorphic to C24 x C4</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(f0, f1)</span>

<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">idealstar</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(f0, f1)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">gens_values</span><span class="p">()</span>   <span class="c1"># random output</span>
<span class="go">(2*a^2 - 1, 2*a^2 + 2*a - 2)</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">()</span> <span class="ow">in</span> <span class="n">k</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">ngens</span><span class="p">()))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>ALGORITHM: Uses Pari function <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/idealstar">pari:idealstar</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.invertible_residues">
<span class="sig-name descname"><span class="pre">invertible_residues</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reduce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.invertible_residues" title="Permalink to this definition">#</a></dt>
<dd><p>Returns a iterator through a list of invertible residues
modulo this integral ideal.</p>
<p>An error is raised if this fractional ideal is not integral.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">reduce</span></code> - bool. If True (default), use <code class="docutils literal notranslate"><span class="pre">small_residue</span></code> to get
small representatives of the residues.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>An iterator through a list of invertible residues modulo this ideal
<span class="math notranslate nohighlight">\(I\)</span>, i.e. a list of elements in the ring of integers <span class="math notranslate nohighlight">\(R\)</span> representing
the elements of <span class="math notranslate nohighlight">\((R/I)^*\)</span>.</p></li>
</ul>
<p>ALGORITHM: Use <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/idealstar">pari:idealstar</a> to find the group structure and
generators of the multiplicative group modulo the ideal.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ires</span> <span class="o">=</span>  <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">invertible_residues</span><span class="p">();</span> <span class="n">ires</span>
<span class="go">xmrange_iter([[0, 1]], &lt;function ...&lt;lambda&gt; at 0x...&gt;)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">ires</span><span class="p">)</span>
<span class="go">[1, -i]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">invertible_residues</span><span class="p">())</span>
<span class="go">[1, 2, 4, 3]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">residues</span><span class="p">())</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">invertible_residues</span><span class="p">())</span>
<span class="go">[1]</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="o">+</span><span class="mi">6</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">units</span><span class="o">=</span><span class="n">I</span><span class="o">.</span><span class="n">invertible_residues</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">units</span><span class="p">))</span><span class="o">==</span><span class="n">I</span><span class="o">.</span><span class="n">euler_phi</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">invertible_residues</span><span class="p">()))</span> <span class="o">==</span> <span class="n">I</span><span class="o">.</span><span class="n">euler_phi</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">invertible_residues</span><span class="p">()))</span>
<span class="go">80</span>
</pre></div>
</div>
<p>AUTHOR: John Cremona</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.invertible_residues_mod">
<span class="sig-name descname"><span class="pre">invertible_residues_mod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subgp_gens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.invertible_residues_mod" title="Permalink to this definition">#</a></dt>
<dd><p>Returns a iterator through a list of representatives for the invertible
residues modulo this integral ideal, modulo the subgroup generated by
the elements in the list <code class="docutils literal notranslate"><span class="pre">subgp_gens</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">subgp_gens</span></code> - either None or a list of elements of the number
field of self. These need not be integral, but should be coprime to
the ideal self. If the list is empty or None, the function returns
an iterator through a list of representatives for the invertible
residues modulo the integral ideal self.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reduce</span></code> - bool. If True (default), use <code class="docutils literal notranslate"><span class="pre">small_residues</span></code> to
get small representatives of the residues.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See also invertible_residues() for a simpler version without the subgroup.</p>
</div>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>An iterator through a list of representatives for the invertible
residues modulo self and modulo the group generated by
<code class="docutils literal notranslate"><span class="pre">subgp_gens</span></code>, i.e. a list of elements in the ring of integers <span class="math notranslate nohighlight">\(R\)</span>
representing the elements of <span class="math notranslate nohighlight">\((R/I)^*/U\)</span>, where <span class="math notranslate nohighlight">\(I\)</span> is this ideal and
<span class="math notranslate nohighlight">\(U\)</span> is the subgroup of <span class="math notranslate nohighlight">\((R/I)^*\)</span> generated by <code class="docutils literal notranslate"><span class="pre">subgp_gens</span></code>.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">invertible_residues_mod</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">[1, 5, 2, 10, 4, 20, 8, 17, 16, 11, 9]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">invertible_residues_mod</span><span class="p">([</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">]))</span>
<span class="go">[1, 5]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">invertible_residues_mod</span><span class="p">([</span><span class="mi">23</span><span class="p">]))</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: the element must be invertible mod the ideal</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">invertible_residues_mod</span><span class="p">([])))</span> <span class="o">==</span> <span class="n">I</span><span class="o">.</span><span class="n">euler_phi</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">invertible_residues_mod</span><span class="p">([]))</span>
<span class="go">[1]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">invertible_residues_mod</span><span class="p">([])))</span>
<span class="go">80</span>
</pre></div>
</div>
<p>AUTHOR: Maite Aranes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.is_S_integral">
<span class="sig-name descname"><span class="pre">is_S_integral</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.is_S_integral" title="Permalink to this definition">#</a></dt>
<dd><p>Return True if this fractional ideal is integral with respect to the list of primes <code class="docutils literal notranslate"><span class="pre">S</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(S\)</span> - a list of prime ideals (not checked if they are indeed
prime).</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function assumes that <span class="math notranslate nohighlight">\(S\)</span> is a list of prime ideals,
but does not check this.  This function will fail if <span class="math notranslate nohighlight">\(S\)</span> is
not a list of prime ideals.</p>
</div>
<p>OUTPUT:</p>
<p>True, if the ideal is <span class="math notranslate nohighlight">\(S\)</span>-integral: that is, if the valuations
of the ideal at all primes not in <span class="math notranslate nohighlight">\(S\)</span> are non-negative. False,
otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">is_S_integral</span><span class="p">([</span><span class="n">P</span><span class="p">])</span>
<span class="go">False</span>

<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">is_S_integral</span><span class="p">([</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">5</span><span class="p">)])</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.is_S_unit">
<span class="sig-name descname"><span class="pre">is_S_unit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.is_S_unit" title="Permalink to this definition">#</a></dt>
<dd><p>Return True if this fractional ideal is a unit with respect to the list of primes <code class="docutils literal notranslate"><span class="pre">S</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(S\)</span> - a list of prime ideals (not checked if they are
indeed prime).</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function assumes that <span class="math notranslate nohighlight">\(S\)</span> is a list of prime ideals,
but does not check this.  This function will fail if <span class="math notranslate nohighlight">\(S\)</span> is
not a list of prime ideals.</p>
</div>
<p>OUTPUT:</p>
<p>True, if the ideal is an <span class="math notranslate nohighlight">\(S\)</span>-unit: that is, if the valuations of
the ideal at all primes not in <span class="math notranslate nohighlight">\(S\)</span> are zero. False, otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">factor</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">is_S_unit</span><span class="p">([</span><span class="n">P</span><span class="p">])</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.is_coprime">
<span class="sig-name descname"><span class="pre">is_coprime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.is_coprime" title="Permalink to this definition">#</a></dt>
<dd><p>Returns True if this ideal is coprime to the other, else False.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> – another ideal of the same field, or generators
of an ideal.</p></li>
</ul>
<p>OUTPUT:</p>
<p>True if self and other are coprime, else False.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function works for fractional ideals as well as
integral ideals.</p>
</div>
<p>AUTHOR: John Cremona</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">is_coprime</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">I</span><span class="o">^-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_coprime</span><span class="p">(</span><span class="n">J</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">is_coprime</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">is_coprime</span><span class="p">(</span><span class="mi">6</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>See <a class="reference external" href="https://trac.sagemath.org/4536">trac ticket #4536</a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">18</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">OE</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">ring_of_integers</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="o">=</span> <span class="p">[</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">factor</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">OE</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="n">j</span><span class="p">)</span><span class="o">.</span><span class="n">is_coprime</span><span class="p">(</span><span class="n">j</span><span class="o">/</span><span class="n">k</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">j</span><span class="o">/</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">is_coprime</span><span class="p">(</span><span class="n">j</span><span class="o">/</span><span class="n">k</span><span class="p">)</span>
<span class="go">False</span>

<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">is_coprime</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.is_maximal">
<span class="sig-name descname"><span class="pre">is_maximal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.is_maximal" title="Permalink to this definition">#</a></dt>
<dd><p>Return True if this ideal is maximal.  This is equivalent to
self being prime, since it is nonzero.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in a with defining polynomial x^3 + 3</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">is_maximal</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">is_maximal</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.is_trivial">
<span class="sig-name descname"><span class="pre">is_trivial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.is_trivial" title="Permalink to this definition">#</a></dt>
<dd><p>Returns True if this is a trivial ideal.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">is_trivial</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">is_trivial</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="n">J</span><span class="p">)</span><span class="o">.</span><span class="n">is_trivial</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.numerator">
<span class="sig-name descname"><span class="pre">numerator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.numerator" title="Permalink to this definition">#</a></dt>
<dd><p>Return the numerator ideal of this fractional ideal.</p>
<p>Each fractional ideal has a unique expression as <span class="math notranslate nohighlight">\(N/D\)</span> where <span class="math notranslate nohighlight">\(N\)</span>,
<span class="math notranslate nohighlight">\(D\)</span> are coprime integral ideals.  The numerator is <span class="math notranslate nohighlight">\(N\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">((</span><span class="mi">3</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">);</span> <span class="n">I</span>
<span class="go">Fractional ideal (4/5*i + 3/5)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span>
<span class="go">Fractional ideal (2*i + 1)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span>
<span class="go">Fractional ideal (-i - 2)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span> <span class="ow">and</span> <span class="n">I</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span> <span class="o">+</span> <span class="n">I</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">==</span> <span class="n">K</span><span class="o">.</span><span class="n">unit_ideal</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span><span class="o">/</span><span class="n">I</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span> <span class="o">==</span> <span class="n">I</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.prime_factors">
<span class="sig-name descname"><span class="pre">prime_factors</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.prime_factors" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list of the prime ideal factors of self</p>
<dl class="simple">
<dt>OUTPUT:</dt><dd><p>list – list of prime ideals (a new list is returned
each time this function is called)</p>
</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">ideal</span><span class="p">(</span><span class="n">w</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">prime_factors</span><span class="p">()</span>
<span class="go">[Fractional ideal (2, 1/2*w - 1/2), Fractional ideal (2, 1/2*w + 1/2), Fractional ideal (3, 1/2*w + 1/2)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.prime_to_S_part">
<span class="sig-name descname"><span class="pre">prime_to_S_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.prime_to_S_part" title="Permalink to this definition">#</a></dt>
<dd><p>Return the part of this fractional ideal which is coprime to
the prime ideals in the list <code class="docutils literal notranslate"><span class="pre">S</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function assumes that <span class="math notranslate nohighlight">\(S\)</span> is a list of prime ideals,
but does not check this.  This function will fail if <span class="math notranslate nohighlight">\(S\)</span> is
not a list of prime ideals.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(S\)</span> – a list of prime ideals</p></li>
</ul>
<p>OUTPUT:</p>
<p>A fractional ideal coprime to the primes in <span class="math notranslate nohighlight">\(S\)</span>, whose prime
factorization is that of <code class="docutils literal notranslate"><span class="pre">self</span></code> with the primes in <span class="math notranslate nohighlight">\(S\)</span>
removed.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="p">[</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="o">+</span><span class="mi">5</span><span class="p">),</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">prime_to_S_part</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="go">Fractional ideal (3)</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">prime_to_S_part</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="go">Fractional ideal (3)</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="p">[</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">15161</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">28383</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">53135</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">99478</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">186250</span><span class="p">),</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">15</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">11</span><span class="p">),</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">101</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">prime_to_S_part</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="go">Fractional ideal (24)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.prime_to_idealM_part">
<span class="sig-name descname"><span class="pre">prime_to_idealM_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.prime_to_idealM_part" title="Permalink to this definition">#</a></dt>
<dd><p>Version for integral ideals of the <code class="docutils literal notranslate"><span class="pre">prime_to_m_part</span></code> function over <span class="math notranslate nohighlight">\(\ZZ\)</span>.
Returns the largest divisor of self that is coprime to the ideal <code class="docutils literal notranslate"><span class="pre">M</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">M</span></code> – an integral ideal of the same field, or generators of an ideal</p></li>
</ul>
<p>OUTPUT:</p>
<p>An ideal which is the largest divisor of self that is coprime to <span class="math notranslate nohighlight">\(M\)</span>.</p>
<p>AUTHOR: Maite Aranes</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">prime_to_idealM_part</span><span class="p">(</span><span class="n">M</span><span class="p">);</span> <span class="n">J</span>
<span class="go">Fractional ideal (12, 1/2*a + 13/2)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">is_coprime</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">prime_to_idealM_part</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">J</span>
<span class="go">Fractional ideal (3, 1/2*a + 1/2)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">is_coprime</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.ramification_index">
<span class="sig-name descname"><span class="pre">ramification_index</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.ramification_index" title="Permalink to this definition">#</a></dt>
<dd><p>Return the ramification index of this fractional ideal,
assuming it is prime.  Otherwise, raise a ValueError.</p>
<p>The ramification index is the power of this prime appearing in
the factorization of the prime in <span class="math notranslate nohighlight">\(\ZZ\)</span> that this prime lies
over.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in a with defining polynomial x^2 + 2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">f</span>
<span class="go">(Fractional ideal (a))^2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ramification_index</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span><span class="o">.</span><span class="n">ramification_index</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">ramification_index</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Fractional ideal (17) is not a prime ideal</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.ray_class_number">
<span class="sig-name descname"><span class="pre">ray_class_number</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.ray_class_number" title="Permalink to this definition">#</a></dt>
<dd><p>Return the order of the ray class group modulo this ideal. This is a
wrapper around Pari’s <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/bnrclassno">pari:bnrclassno</a> function.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">ray_class_number</span><span class="p">()</span>
<span class="go">3</span>

<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">ray_class_number</span><span class="p">()</span>
<span class="go">5184</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.reduce">
<span class="sig-name descname"><span class="pre">reduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.reduce" title="Permalink to this definition">#</a></dt>
<dd><p>Return the canonical reduction of the element of <span class="math notranslate nohighlight">\(f\)</span> modulo the ideal
<span class="math notranslate nohighlight">\(I\)</span> (=self). This is an element of <span class="math notranslate nohighlight">\(R\)</span> (the ring of integers of the
number field) that is equivalent modulo <span class="math notranslate nohighlight">\(I\)</span> to <span class="math notranslate nohighlight">\(f\)</span>.</p>
<p>An error is raised if this fractional ideal is not integral or
the element <span class="math notranslate nohighlight">\(f\)</span> is not integral.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> - an integral element of the number field</p></li>
</ul>
<p>OUTPUT:</p>
<p>An integral element <span class="math notranslate nohighlight">\(g\)</span>, such that <span class="math notranslate nohighlight">\(f - g\)</span> belongs to the ideal self
and such that <span class="math notranslate nohighlight">\(g\)</span> is a canonical reduced representative of the coset
<span class="math notranslate nohighlight">\(f + I\)</span> (<span class="math notranslate nohighlight">\(I\)</span> =self) as described in the <code class="docutils literal notranslate"><span class="pre">residues</span></code> function, namely an integral element with coordinates <span class="math notranslate nohighlight">\((r_0, \dots,r_{n-1})\)</span>, where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(r_i\)</span> is reduced modulo <span class="math notranslate nohighlight">\(d_i\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(d_i = b_i[i]\)</span>, with <span class="math notranslate nohighlight">\({b_0, b_1, \dots, b_n}\)</span> HNF basis
of the ideal self.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The reduced element <span class="math notranslate nohighlight">\(g\)</span> is not necessarily small. To get a
small <span class="math notranslate nohighlight">\(g\)</span> use the method <code class="docutils literal notranslate"><span class="pre">small_residue</span></code>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">9</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">a^2 - 2*a</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">-</span> <span class="n">I</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="ow">in</span> <span class="n">I</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The reduced element is in the list of canonical representatives
returned by the <code class="docutils literal notranslate"><span class="pre">residues</span></code> method:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">residues</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The reduced element does not necessarily have smaller norm (use
<code class="docutils literal notranslate"><span class="pre">small_residue</span></code> for that)</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">25</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">c</span><span class="p">))</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">209</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">small_residue</span><span class="p">(</span><span class="n">c</span><span class="p">))</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">10</span>
</pre></div>
</div>
<p>Sometimes the canonical reduced representative of <span class="math notranslate nohighlight">\(1\)</span> won’t be <span class="math notranslate nohighlight">\(1\)</span>
(it depends on the choice of basis for the ring of integers):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">-3/2*a - 1/2</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">ring_of_integers</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">[1/2*a + 1/2, a]</span>
</pre></div>
</div>
<p>AUTHOR: Maite Aranes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.residue_class_degree">
<span class="sig-name descname"><span class="pre">residue_class_degree</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.residue_class_degree" title="Permalink to this definition">#</a></dt>
<dd><p>Return the residue class degree of this fractional ideal,
assuming it is prime.  Otherwise, raise a ValueError.</p>
<p>The residue class degree of a prime ideal <span class="math notranslate nohighlight">\(I\)</span> is the degree of
the extension <span class="math notranslate nohighlight">\(O_K/I\)</span> of its prime subfield.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in a with defining polynomial x^5 + 2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">19</span><span class="p">);</span> <span class="n">f</span>
<span class="go">(Fractional ideal (a^2 + a - 3)) * (Fractional ideal (2*a^4 + a^2 - 2*a + 1)) * (Fractional ideal (a^2 + a - 1))</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">residue_class_degree</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">f</span><span class="p">]</span>
<span class="go">[2, 2, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.residue_field">
<span class="sig-name descname"><span class="pre">residue_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.residue_field" title="Permalink to this definition">#</a></dt>
<dd><p>Return the residue class field of this fractional ideal, which
must be prime.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">residue_field</span><span class="p">()</span>
<span class="go">Residue field in abar of Fractional ideal (2*a^2 + 3*a - 10)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">residue_field</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="go">Residue field in z of Fractional ideal (2*a^2 + 3*a - 10)</span>
</pre></div>
</div>
<p>Another example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span> <span class="n">P</span>
<span class="go">Fractional ideal (389, a^2 - 44*a - 9)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">residue_class_degree</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">residue_field</span><span class="p">()</span>
<span class="go">Residue field in abar of Fractional ideal (389, a^2 - 44*a - 9)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">residue_field</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="go">Residue field in z of Fractional ideal (389, a^2 - 44*a - 9)</span>
<span class="gp">sage: </span><span class="n">FF</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">residue_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">FF</span>
<span class="go">Residue field in w of Fractional ideal (389, a^2 - 44*a - 9)</span>
<span class="gp">sage: </span><span class="n">FF</span><span class="p">((</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">390</span><span class="p">)</span>
<span class="go">36</span>
<span class="gp">sage: </span><span class="n">FF</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">w</span>
</pre></div>
</div>
<p>An example of reduction maps to the residue field: these are
defined on the whole valuation ring, i.e. the subring of the
number field consisting of elements with non-negative
valuation.  This shows that the issue raised in <a class="reference external" href="https://trac.sagemath.org/1951">trac ticket #1951</a>
has been fixed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P1</span><span class="p">,</span> <span class="n">P2</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">5</span><span class="p">)];</span> <span class="p">(</span><span class="n">P1</span><span class="p">,</span><span class="n">P2</span><span class="p">)</span>
<span class="go">(Fractional ideal (-i - 2), Fractional ideal (2*i + 1))</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F1</span><span class="p">,</span> <span class="n">F2</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">residue_field</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="p">[</span><span class="n">P1</span><span class="p">,</span><span class="n">P2</span><span class="p">]];</span> <span class="p">(</span><span class="n">F1</span><span class="p">,</span><span class="n">F2</span><span class="p">)</span>
<span class="go">(Residue field of Fractional ideal (-i - 2), Residue field of Fractional ideal (2*i + 1))</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="n">P1</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">F1</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">F1</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="n">P2</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">F2</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ZeroDivisionError: Cannot reduce field element -2/5*i + 1/5 modulo Fractional ideal (2*i + 1): it has negative valuation</span>
</pre></div>
</div>
<p>An example with a relative number field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">ideal</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">residue_field</span><span class="p">();</span> <span class="n">R</span>
<span class="go">Residue field in abar of Fractional ideal ((-1/2*b - 1/2)*a + 1/2*b - 1/2)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">9</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">((</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="mi">17</span><span class="p">)</span>
<span class="go">abar</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">b</span><span class="p">)</span>
<span class="go">2*abar</span>
</pre></div>
</div>
<p>We verify that <a class="reference external" href="https://trac.sagemath.org/8721">trac ticket #8721</a> is fixed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">residue_field</span><span class="p">()</span>
<span class="go">Residue field in abar of Fractional ideal (a)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.residues">
<span class="sig-name descname"><span class="pre">residues</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.residues" title="Permalink to this definition">#</a></dt>
<dd><p>Return a iterator through a complete list of residues modulo this integral ideal.</p>
<p>An error is raised if this fractional ideal is not integral.</p>
<p>OUTPUT:</p>
<p>An iterator through a complete list of residues modulo the integral
ideal self. This list is the set of canonical reduced representatives
given by all integral elements with coordinates <span class="math notranslate nohighlight">\((r_0, \dots,r_{n-1})\)</span>,
where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(r_i\)</span> is reduced modulo <span class="math notranslate nohighlight">\(d_i\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(d_i = b_i[i]\)</span>, with <span class="math notranslate nohighlight">\({b_0, b_1, \dots, b_n}\)</span> HNF basis
of the ideal.</p></li>
</ul>
<p>AUTHOR: John Cremona (modified by Maite Aranes)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">res</span> <span class="o">=</span>  <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">residues</span><span class="p">();</span> <span class="n">res</span>
<span class="go">xmrange_iter([[0, 1], [0, 1]], &lt;function ...&lt;lambda&gt; at 0x...&gt;)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="go">[0, i, 1, i + 1]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">residues</span><span class="p">())</span>
<span class="go">[-2*i, -i, 0, i, 2*i]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">residues</span><span class="p">())</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="o">+</span><span class="mi">6</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">reps</span><span class="o">=</span><span class="n">I</span><span class="o">.</span><span class="n">residues</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">reps</span><span class="p">))</span> <span class="o">==</span> <span class="n">I</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">r</span> <span class="o">==</span> <span class="n">s</span> <span class="ow">or</span> <span class="ow">not</span> <span class="p">(</span><span class="n">r</span><span class="o">-</span><span class="n">s</span><span class="p">)</span> <span class="ow">in</span> <span class="n">I</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">reps</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">reps</span><span class="p">)</span>  <span class="c1"># long time (6s on sage.math, 2011)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">residues</span><span class="p">()))</span> <span class="o">==</span> <span class="n">I</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">residues</span><span class="p">()))</span> <span class="o">==</span> <span class="mi">3</span><span class="o">**</span><span class="mi">5</span>  <span class="c1"># long time (5s on sage.math, 2011)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.small_residue">
<span class="sig-name descname"><span class="pre">small_residue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.small_residue" title="Permalink to this definition">#</a></dt>
<dd><p>Given an element <span class="math notranslate nohighlight">\(f\)</span> of the ambient number field, returns an
element <span class="math notranslate nohighlight">\(g\)</span> such that <span class="math notranslate nohighlight">\(f - g\)</span> belongs to the ideal self (which
must be integral), and <span class="math notranslate nohighlight">\(g\)</span> is small.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The reduced representative returned is not uniquely determined.</p>
</div>
<p>ALGORITHM: Uses Pari function <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/nfeltreduce">pari:nfeltreduce</a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">small_residue</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">18</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">small_residue</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span><span class="mi">13</span><span class="p">)</span>
<span class="go">a^2 + 5*a - 3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.support">
<span class="sig-name descname"><span class="pre">support</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.support" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list of the prime ideal factors of self</p>
<dl class="simple">
<dt>OUTPUT:</dt><dd><p>list – list of prime ideals (a new list is returned
each time this function is called)</p>
</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">ideal</span><span class="p">(</span><span class="n">w</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">prime_factors</span><span class="p">()</span>
<span class="go">[Fractional ideal (2, 1/2*w - 1/2), Fractional ideal (2, 1/2*w + 1/2), Fractional ideal (3, 1/2*w + 1/2)]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.rings.number_field.number_field_ideal.</span></span><span class="sig-name descname"><span class="pre">NumberFieldIdeal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coerce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../rings/sage/rings/ideal.html#sage.rings.ideal.Ideal_generic" title="(in General Rings, Ideals, and Morphisms v9.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Ideal_generic</span></code></a></p>
<p>An ideal of a number field.</p>
<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.S_ideal_class_log">
<span class="sig-name descname"><span class="pre">S_ideal_class_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.S_ideal_class_log" title="Permalink to this definition">#</a></dt>
<dd><p>S-class group version of <a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.ideal_class_log" title="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.ideal_class_log"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ideal_class_log()</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">14</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">S_ideal_class_log</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="go">[1]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">S_ideal_class_log</span><span class="p">([])</span>
<span class="go">[3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.absolute_norm">
<span class="sig-name descname"><span class="pre">absolute_norm</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.absolute_norm" title="Permalink to this definition">#</a></dt>
<dd><p>A synonym for norm.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">absolute_norm</span><span class="p">()</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.absolute_ramification_index">
<span class="sig-name descname"><span class="pre">absolute_ramification_index</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.absolute_ramification_index" title="Permalink to this definition">#</a></dt>
<dd><p>A synonym for ramification_index.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">absolute_ramification_index</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.artin_symbol">
<span class="sig-name descname"><span class="pre">artin_symbol</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.artin_symbol" title="Permalink to this definition">#</a></dt>
<dd><p>Return the Artin symbol <span class="math notranslate nohighlight">\(( K / \QQ, P)\)</span>, where <span class="math notranslate nohighlight">\(K\)</span> is the
number field of <span class="math notranslate nohighlight">\(P\)</span> =self.  This is the unique element <span class="math notranslate nohighlight">\(s\)</span> of
the decomposition group of <span class="math notranslate nohighlight">\(P\)</span> such that <span class="math notranslate nohighlight">\(s(x) = x^p \pmod{P}\)</span>
where <span class="math notranslate nohighlight">\(p\)</span> is the residue characteristic of <span class="math notranslate nohighlight">\(P\)</span>.  (Here <span class="math notranslate nohighlight">\(P\)</span>
(self) should be prime and unramified.)</p>
<p>See the <code class="docutils literal notranslate"><span class="pre">artin_symbol</span></code> method of the <code class="docutils literal notranslate"><span class="pre">GaloisGroup_v2</span></code>
class for further documentation and examples.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">7</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">artin_symbol</span><span class="p">()</span>
<span class="go">(1,2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.basis">
<span class="sig-name descname"><span class="pre">basis</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.basis" title="Permalink to this definition">#</a></dt>
<dd><p>Return a basis for this ideal viewed as a <span class="math notranslate nohighlight">\(\ZZ\)</span> -module.</p>
<p>OUTPUT:</p>
<p>An immutable sequence of elements of this ideal (note: their
parent is the number field) forming a basis for this ideal.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">11</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>           <span class="c1"># warning -- choice of basis can be somewhat random</span>
<span class="go">[11, 11*z, 11*z^2, z^3 + 5*z^2 + 4*z + 10, z^4 + z^2 + z + 5, z^5 + z^4 + z^3 + 2*z^2 + 6*z + 5]</span>
</pre></div>
</div>
<p>An example of a non-integral ideal.:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">I</span>
<span class="gp">sage: </span><span class="n">J</span>          <span class="c1"># warning -- choice of generators can be somewhat random</span>
<span class="go">Fractional ideal (2/11*z^5 + 2/11*z^4 + 3/11*z^3 + 2/11)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>           <span class="c1"># warning -- choice of basis can be somewhat random</span>
<span class="go">[1, z, z^2, 1/11*z^3 + 7/11*z^2 + 6/11*z + 10/11, 1/11*z^4 + 1/11*z^2 + 1/11*z + 7/11, 1/11*z^5 + 1/11*z^4 + 1/11*z^3 + 2/11*z^2 + 8/11*z + 7/11]</span>
</pre></div>
</div>
<p>Number fields defined by non-monic and non-integral
polynomials are supported (<a class="reference external" href="https://trac.sagemath.org/252">trac ticket #252</a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">[1, a]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.coordinates">
<span class="sig-name descname"><span class="pre">coordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.coordinates" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the coordinate vector of <span class="math notranslate nohighlight">\(x\)</span> with respect to this ideal.</p>
<dl class="simple">
<dt>INPUT:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">x</span></code> – an element of the number field (or ring of integers) of this ideal.</p>
</dd>
<dt>OUTPUT:</dt><dd><p>List giving the coordinates of <span class="math notranslate nohighlight">\(x\)</span> with respect to the integral basis
of the ideal.  In general this will be a vector of
rationals; it will consist of integers if and only if <span class="math notranslate nohighlight">\(x\)</span>
is in the ideal.</p>
</dd>
</dl>
<p>AUTHOR: John Cremona  2008-10-31</p>
<p>ALGORITHM:</p>
<p>Uses linear algebra.
Provides simpler implementations for <code class="docutils literal notranslate"><span class="pre">_contains_()</span></code>,
<code class="docutils literal notranslate"><span class="pre">is_integral()</span></code> and <code class="docutils literal notranslate"><span class="pre">smallest_integer()</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">7</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Ibasis</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">integral_basis</span><span class="p">();</span> <span class="n">Ibasis</span>
<span class="go">[58, i + 41]</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="mi">23</span><span class="o">-</span><span class="mi">14</span><span class="o">*</span><span class="n">i</span>
<span class="gp">sage: </span><span class="n">acoords</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="n">a</span><span class="p">);</span> <span class="n">acoords</span>
<span class="go">(597/58, -14)</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">([</span><span class="n">Ibasis</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">acoords</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)])</span> <span class="o">==</span> <span class="n">a</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="mi">123</span><span class="o">+</span><span class="mi">456</span><span class="o">*</span><span class="n">i</span>
<span class="gp">sage: </span><span class="n">bcoords</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="n">b</span><span class="p">);</span> <span class="n">bcoords</span>
<span class="go">(-18573/58, 456)</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">([</span><span class="n">Ibasis</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">bcoords</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)])</span> <span class="o">==</span> <span class="n">b</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">()</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">coordinates</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: vector is not in free module</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.decomposition_group">
<span class="sig-name descname"><span class="pre">decomposition_group</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.decomposition_group" title="Permalink to this definition">#</a></dt>
<dd><p>Return the decomposition group of self, as a subset of the
automorphism group of the number field of self. Raises an
error if the field isn’t Galois. See the decomposition_group
method of the <code class="docutils literal notranslate"><span class="pre">GaloisGroup_v2</span></code> class for further examples
and doctests.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">7</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">decomposition_group</span><span class="p">()</span>
<span class="go">Subgroup generated by [(1,2)] of (Galois group 2T1 (S2) with order 2 of x^2 + 23)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.free_module">
<span class="sig-name descname"><span class="pre">free_module</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.free_module" title="Permalink to this definition">#</a></dt>
<dd><p>Return the free <span class="math notranslate nohighlight">\(\ZZ\)</span>-module contained in the vector space
associated to the ambient number field, that corresponds
to this ideal.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">11</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span> <span class="n">I</span>
<span class="go">Fractional ideal (-3*z^4 - 2*z^3 - 2*z^2 - 2)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span>              <span class="c1"># warning -- choice of basis can be somewhat random</span>
<span class="go">Free module of degree 6 and rank 6 over Integer Ring</span>
<span class="go">User basis matrix:</span>
<span class="go">[11  0  0  0  0  0]</span>
<span class="go">[ 0 11  0  0  0  0]</span>
<span class="go">[ 0  0 11  0  0  0]</span>
<span class="go">[10  4  5  1  0  0]</span>
<span class="go">[ 5  1  1  0  1  0]</span>
<span class="go">[ 5  6  2  1  1  1]</span>
</pre></div>
</div>
<p>However, the actual <span class="math notranslate nohighlight">\(\ZZ\)</span>-module is not at all random:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[ 1  0  0  5  1  1]</span>
<span class="go">[ 0  1  0  1  1  7]</span>
<span class="go">[ 0  0  1  7  6 10]</span>
<span class="go">[ 0  0  0 11  0  0]</span>
<span class="go">[ 0  0  0  0 11  0]</span>
<span class="go">[ 0  0  0  0  0 11]</span>
</pre></div>
</div>
<p>The ideal doesn’t have to be integral:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">I</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">J</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">echelonized_basis_matrix</span><span class="p">()</span>
<span class="go">[ 1/11     0     0  7/11  1/11  1/11]</span>
<span class="go">[    0  1/11     0  1/11  1/11  5/11]</span>
<span class="go">[    0     0  1/11  5/11  4/11 10/11]</span>
<span class="go">[    0     0     0     1     0     0]</span>
<span class="go">[    0     0     0     0     1     0]</span>
<span class="go">[    0     0     0     0     0     1]</span>
</pre></div>
</div>
<p>This also works for relative extensions:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">fractional_ideal</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="go">Free module of degree 4 and rank 4 over Integer Ring</span>
<span class="go">User basis matrix:</span>
<span class="go">[  4   0   0   0]</span>
<span class="go">[ -3   7  -1   1]</span>
<span class="go">[  3   7   1   1]</span>
<span class="go">[  0 -10   0  -2]</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">I</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span> <span class="n">J</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="go">Free module of degree 4 and rank 4 over Integer Ring</span>
<span class="go">User basis matrix:</span>
<span class="go">[  1/4     0     0     0]</span>
<span class="go">[-3/16  7/16 -1/16  1/16]</span>
<span class="go">[ 3/16  7/16  1/16  1/16]</span>
<span class="go">[    0  -5/8     0  -1/8]</span>
</pre></div>
</div>
<p>An example of intersecting ideals by intersecting free modules.:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p1</span> <span class="o">=</span> <span class="n">I</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">I</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">p1</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">p2</span><span class="o">.</span><span class="n">free_module</span><span class="p">());</span> <span class="n">N</span>
<span class="go">Free module of degree 3 and rank 3 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[  1 1/2 1/2]</span>
<span class="go">[  0   1   1]</span>
<span class="go">[  0   0   2]</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">index_in</span><span class="p">(</span><span class="n">p1</span><span class="o">.</span><span class="n">free_module</span><span class="p">())</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.gens_reduced">
<span class="sig-name descname"><span class="pre">gens_reduced</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.gens_reduced" title="Permalink to this definition">#</a></dt>
<dd><p>Express this ideal in terms of at most two generators, and one
if possible.</p>
<p>This function indirectly uses <code class="docutils literal notranslate"><span class="pre">bnfisprincipal</span></code>, so set
<code class="docutils literal notranslate"><span class="pre">proof=True</span></code> if you want to prove correctness (which <em>is</em> the
default).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">gens_reduced</span><span class="p">()</span>
<span class="go">(0,)</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">a</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(a + 2, 9)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">gens_reduced</span><span class="p">()</span>  <span class="c1"># random sign</span>
<span class="go">(a + 2,)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">a</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">gens_reduced</span><span class="p">()</span>
<span class="go">(3, a + 2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.gens_two">
<span class="sig-name descname"><span class="pre">gens_two</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.gens_two" title="Permalink to this definition">#</a></dt>
<dd><p>Express this ideal using exactly two generators, the first of
which is a generator for the intersection of the ideal with <span class="math notranslate nohighlight">\(Q\)</span>.</p>
<p>ALGORITHM: uses PARI’s <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/idealtwoelt">pari:idealtwoelt</a> function, which runs in
randomized polynomial time and is very fast in practice.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">a</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(a + 2, 9)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">gens_two</span><span class="p">()</span>
<span class="go">(9, a + 2)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">a</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="mi">8</span><span class="p">])</span><span class="o">.</span><span class="n">gens_two</span><span class="p">()</span>
<span class="go">(3, a + 2)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">gens_two</span><span class="p">()</span>
<span class="go">(0, 0)</span>
</pre></div>
</div>
<p>The second generator is zero if and only if the ideal is
generated by a rational, in contrast to the PARI function
<a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/idealtwoelt">pari:idealtwoelt</a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pari</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">idealtwoelt</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>  <span class="c1"># Note that second element is not zero</span>
<span class="go">[12, [0, 12]~]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">gens_two</span><span class="p">()</span>
<span class="go">(12, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.ideal_class_log">
<span class="sig-name descname"><span class="pre">ideal_class_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.ideal_class_log" title="Permalink to this definition">#</a></dt>
<dd><p>Return the output of PARI’s <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/bnfisprincipal">pari:bnfisprincipal</a> for this ideal,
i.e. a vector expressing the class of this ideal in terms of a
set of generators for the class group.</p>
<p>Since it uses the PARI method <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/bnfisprincipal">pari:bnfisprincipal</a>, specify
<code class="docutils literal notranslate"><span class="pre">proof=True</span></code> (this is the default setting) to prove the correctness
of the output.</p>
<p>EXAMPLES:</p>
<p>When the class number is 1, the result is always the empty list:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">163</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="n">random_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">6</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">ideal_class_log</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>An example with class group of order 2.  The first ideal is
not principal, the second one is:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">ideal_class_log</span><span class="p">()</span>
<span class="go">[1]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">J</span><span class="o">^</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">ideal_class_log</span><span class="p">()</span>
<span class="go">[0]</span>
</pre></div>
</div>
<p>An example with a more complicated class group:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">26</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">class_group</span><span class="p">()</span>
<span class="go">Class group of order 18 with structure C6 x C3 of Number Field in a with defining polynomial x^3 - x + 1 over its base field</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">7</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ideal_class_log</span><span class="p">()</span> <span class="c1"># random</span>
<span class="go">[1, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.inertia_group">
<span class="sig-name descname"><span class="pre">inertia_group</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.inertia_group" title="Permalink to this definition">#</a></dt>
<dd><p>Return the inertia group of self, i.e. the set of elements s of the
Galois group of the number field of self (which we assume is Galois)
such that s acts trivially modulo self. This is the same as the 0th
ramification group of self. See the inertia_group method of the
<code class="docutils literal notranslate"><span class="pre">GaloisGroup_v2</span></code> class for further examples and doctests.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">23</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">inertia_group</span><span class="p">()</span>
<span class="go">Subgroup generated by [(1,2)] of (Galois group 2T1 (S2) with order 2 of x^2 + 23)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.integral_basis">
<span class="sig-name descname"><span class="pre">integral_basis</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.integral_basis" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list of generators for this ideal as a <span class="math notranslate nohighlight">\(\ZZ\)</span>-module.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">integral_basis</span><span class="p">()</span>
<span class="go">[2, i + 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.integral_split">
<span class="sig-name descname"><span class="pre">integral_split</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.integral_split" title="Permalink to this definition">#</a></dt>
<dd><p>Return a tuple <span class="math notranslate nohighlight">\((I, d)\)</span>, where <span class="math notranslate nohighlight">\(I\)</span> is an integral ideal, and <span class="math notranslate nohighlight">\(d\)</span> is the
smallest positive integer such that this ideal is equal to <span class="math notranslate nohighlight">\(I/d\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">5</span><span class="o">+</span><span class="n">a</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">J</span><span class="p">,</span><span class="n">d</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">integral_split</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">J</span>
<span class="go">Fractional ideal (-1/2*a + 5/2)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">d</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">==</span> <span class="n">J</span><span class="o">/</span><span class="n">d</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.intersection">
<span class="sig-name descname"><span class="pre">intersection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.intersection" title="Permalink to this definition">#</a></dt>
<dd><p>Return the intersection of self and other.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">((</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span> <span class="n">q</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">((</span><span class="n">a</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">==</span> <span class="n">q</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>An example with non-principal ideals:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">==</span> <span class="n">L</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A relative example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">11</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="mi">15</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="mi">7</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">8</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span> <span class="o">-</span> <span class="mi">5</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="o">==</span> <span class="n">L</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.is_integral">
<span class="sig-name descname"><span class="pre">is_integral</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.is_integral" title="Permalink to this definition">#</a></dt>
<dd><p>Return True if this ideal is integral.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.is_maximal">
<span class="sig-name descname"><span class="pre">is_maximal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.is_maximal" title="Permalink to this definition">#</a></dt>
<dd><p>Return True if this ideal is maximal.  This is equivalent to
self being prime and nonzero.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in a with defining polynomial x^3 + 3</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">is_maximal</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">is_maximal</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.is_prime">
<span class="sig-name descname"><span class="pre">is_prime</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.is_prime" title="Permalink to this definition">#</a></dt>
<dd><p>Return True if this ideal is prime.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">17</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in a with defining polynomial x^2 - 17</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>   <span class="c1"># inert prime</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>  <span class="c1"># split</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>  <span class="c1"># ramified</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.is_principal">
<span class="sig-name descname"><span class="pre">is_principal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.is_principal" title="Permalink to this definition">#</a></dt>
<dd><p>Return True if this ideal is principal.</p>
<p>Since it uses the PARI method <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/bnfisprincipal">pari:bnfisprincipal</a>, specify
<code class="docutils literal notranslate"><span class="pre">proof=True</span></code> (this is the default setting) to prove the correctness
of the output.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">119</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">2</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">is_principal</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">P</span><span class="o">^</span><span class="mi">5</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">is_principal</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="c1"># random</span>
<span class="go">Fractional ideal (-1/2*a + 3/2)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">factor</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">P</span><span class="o">^</span><span class="mi">5</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">is_principal</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.is_zero">
<span class="sig-name descname"><span class="pre">is_zero</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.is_zero" title="Permalink to this definition">#</a></dt>
<dd><p>Return True iff self is the zero ideal</p>
<p>Note that <span class="math notranslate nohighlight">\((0)\)</span> is a <code class="docutils literal notranslate"><span class="pre">NumberFieldIdeal</span></code>, not a
<code class="docutils literal notranslate"><span class="pre">NumberFieldFractionalIdeal</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in a with defining polynomial x^2 + 2</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">=</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">I</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">I</span>
<span class="go">Ideal (0) of Number Field in a with defining polynomial x^2 + 2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.norm">
<span class="sig-name descname"><span class="pre">norm</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.norm" title="Permalink to this definition">#</a></dt>
<dd><p>Return the norm of this fractional ideal as a rational number.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">23</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in a with defining polynomial x^4 + 23</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">19</span><span class="p">);</span> <span class="n">I</span>
<span class="go">Fractional ideal (19)</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">norm</span><span class="p">())</span>
<span class="go">19^4</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">F</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">19^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.number_field">
<span class="sig-name descname"><span class="pre">number_field</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.number_field" title="Permalink to this definition">#</a></dt>
<dd><p>Return the number field that this is a fractional ideal in.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in a with defining polynomial x^2 + 2</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">number_field</span><span class="p">()</span>
<span class="go">Number Field in a with defining polynomial x^2 + 2</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">number_field</span><span class="p">()</span> <span class="c1"># not tested (not implemented)</span>
<span class="go">Number Field in a with defining polynomial x^2 + 2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.pari_hnf">
<span class="sig-name descname"><span class="pre">pari_hnf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.pari_hnf" title="Permalink to this definition">#</a></dt>
<dd><p>Return PARI’s representation of this ideal in Hermite normal form.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">5</span><span class="o">+</span><span class="n">a</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">pari_hnf</span><span class="p">()</span>
<span class="go">[2, 0, 50/127; 0, 2, 244/127; 0, 0, 2/127]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.pari_prime">
<span class="sig-name descname"><span class="pre">pari_prime</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.pari_prime" title="Permalink to this definition">#</a></dt>
<dd><p>Returns a PARI prime ideal corresponding to the ideal <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> - a prime ideal.</p></li>
</ul>
</div></blockquote>
<p>OUTPUT: a PARI “prime ideal”, i.e. a five-component vector <span class="math notranslate nohighlight">\([p,a,e,f,b]\)</span>
representing the prime ideal <span class="math notranslate nohighlight">\(p O_K + a O_K\)</span>, <span class="math notranslate nohighlight">\(e\)</span>, <span class="math notranslate nohighlight">\(f\)</span> as usual, <span class="math notranslate nohighlight">\(a\)</span> as
vector of components on the integral basis, <span class="math notranslate nohighlight">\(b\)</span> Lenstra’s constant.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">pari_prime</span><span class="p">()</span>
<span class="go">[3, [3, 0]~, 1, 2, 1]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">pari_prime</span><span class="p">()</span>
<span class="go">[5, [2, 1]~, 1, 1, [-2, -1; 1, -2]]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">pari_prime</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Fractional ideal (2) is not a prime ideal</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.ramification_group">
<span class="sig-name descname"><span class="pre">ramification_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.ramification_group" title="Permalink to this definition">#</a></dt>
<dd><p>Return the <span class="math notranslate nohighlight">\(v\)</span>’th ramification group of self, i.e. the set of
elements <span class="math notranslate nohighlight">\(s\)</span> of the Galois group of the number field of self
(which we assume is Galois) such that <span class="math notranslate nohighlight">\(s\)</span> acts trivially
modulo the <span class="math notranslate nohighlight">\((v+1)\)</span>’st power of self. See the
ramification_group method of the <code class="docutils literal notranslate"><span class="pre">GaloisGroup</span></code> class for
further examples and doctests.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">23</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ramification_group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Subgroup generated by [(1,2)] of (Galois group 2T1 (S2) with order 2 of x^2 + 23)</span>
<span class="gp">sage: </span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">23</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ramification_group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Subgroup generated by [()] of (Galois group 2T1 (S2) with order 2 of x^2 + 23)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.random_element">
<span class="sig-name descname"><span class="pre">random_element</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.random_element" title="Permalink to this definition">#</a></dt>
<dd><p>Return a random element of this order.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">*args</span></code>, <code class="docutils literal notranslate"><span class="pre">*kwds</span></code> - Parameters passed to the random integer
function.  See the documentation of <code class="docutils literal notranslate"><span class="pre">ZZ.random_element()</span></code> for
details.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A random element of this fractional ideal, computed as a random
<span class="math notranslate nohighlight">\(\ZZ\)</span>-linear combination of the basis.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span> <span class="c1"># random output</span>
<span class="go">-a^2 - a - 19</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="s2">&quot;uniform&quot;</span><span class="p">)</span> <span class="c1"># random output</span>
<span class="go">a^2 - 2*a - 8</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span> <span class="c1"># random output</span>
<span class="go">-7*a^2 - 17*a - 75</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">K</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A relative example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1000</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span> <span class="c1"># random output</span>
<span class="go">17/500002*a^3 + 737253/250001*a^2 - 1494505893/500002*a + 752473260/250001</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">K</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.reduce_equiv">
<span class="sig-name descname"><span class="pre">reduce_equiv</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.reduce_equiv" title="Permalink to this definition">#</a></dt>
<dd><p>Return a small ideal that is equivalent to self in the group
of fractional ideals modulo principal ideals.  Very often (but
not always) if self is principal then this function returns
the unit ideal.</p>
<p>ALGORITHM: Calls <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/idealred">pari:idealred</a> function.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">ideal</span><span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="mi">23</span><span class="o">^</span><span class="mi">5</span><span class="p">);</span> <span class="n">I</span>
<span class="go">Fractional ideal (6436343*w)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">reduce_equiv</span><span class="p">()</span>
<span class="go">Fractional ideal (1)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">class_group</span><span class="p">()</span><span class="mf">.0</span><span class="o">.</span><span class="n">ideal</span><span class="p">()</span><span class="o">^</span><span class="mi">10</span><span class="p">;</span> <span class="n">I</span>
<span class="go">Fractional ideal (1024, 1/2*w + 979/2)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">reduce_equiv</span><span class="p">()</span>
<span class="go">Fractional ideal (2, 1/2*w - 1/2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.relative_norm">
<span class="sig-name descname"><span class="pre">relative_norm</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.relative_norm" title="Permalink to this definition">#</a></dt>
<dd><p>A synonym for norm.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">relative_norm</span><span class="p">()</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.relative_ramification_index">
<span class="sig-name descname"><span class="pre">relative_ramification_index</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.relative_ramification_index" title="Permalink to this definition">#</a></dt>
<dd><p>A synonym for ramification_index.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">relative_ramification_index</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.residue_symbol">
<span class="sig-name descname"><span class="pre">residue_symbol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.residue_symbol" title="Permalink to this definition">#</a></dt>
<dd><p>The m-th power residue symbol for an element e and the proper ideal.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\left(\frac{\alpha}{\mathbf{P}}\right) \equiv \alpha^{\frac{N(\mathbf{P})-1}{m}} \operatorname{mod} \mathbf{P}\]</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>accepts m=1, in which case returns 1</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>can also be called for an element from sage.rings.number_field_element.residue_symbol</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>e is coerced into the number field of self</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>if m=2, e is an integer, and self.number_field() has absolute degree 1 (i.e. it is a copy of the rationals), then this calls kronecker_symbol, which is implemented using GMP.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">e</span></code> - element of the number field</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> - positive integer</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>an m-th root of unity in the number field</p></li>
</ul>
<p>EXAMPLES:</p>
<p>Quadratic Residue (7 is not a square modulo 11):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">residue_symbol</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-1</span>
</pre></div>
</div>
<p>Cubic Residue:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">residue_symbol</span><span class="p">(</span><span class="n">w</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">-w</span>
</pre></div>
</div>
<p>The field must contain the m-th roots of unity:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">residue_symbol</span><span class="p">(</span><span class="n">w</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: The residue symbol to that power is not defined for the number field</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.smallest_integer">
<span class="sig-name descname"><span class="pre">smallest_integer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.smallest_integer" title="Permalink to this definition">#</a></dt>
<dd><p>Return the smallest non-negative integer in <span class="math notranslate nohighlight">\(I \cap \ZZ\)</span>,
where <span class="math notranslate nohighlight">\(I\)</span> is this ideal.  If <span class="math notranslate nohighlight">\(I = 0\)</span>, returns 0.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="n">a</span><span class="p">])</span><span class="o">/</span><span class="mi">7</span><span class="p">;</span> <span class="n">I</span>
<span class="go">Fractional ideal (2/7, 1/7*a)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">smallest_integer</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.NumberFieldIdeal.valuation">
<span class="sig-name descname"><span class="pre">valuation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.valuation" title="Permalink to this definition">#</a></dt>
<dd><p>Return the valuation of self at <code class="docutils literal notranslate"><span class="pre">p</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime ideal <span class="math notranslate nohighlight">\(\mathfrak{p}\)</span> of this number field.</p></li>
</ul>
<p>OUTPUT:</p>
<p>(integer) The valuation of this fractional ideal at the prime
<span class="math notranslate nohighlight">\(\mathfrak{p}\)</span>.  If <span class="math notranslate nohighlight">\(\mathfrak{p}\)</span> is not prime, raise a
ValueError.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in a with defining polynomial x^5 + 2</span>
<span class="gp">sage: </span><span class="n">i</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">38</span><span class="p">);</span> <span class="n">i</span>
<span class="go">Fractional ideal (38)</span>
<span class="gp">sage: </span><span class="n">i</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">19</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">i</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">i</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">i</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: p (= Ideal (0) of Number Field in a with defining polynomial x^5 + 2) must be nonzero</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.QuotientMap">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.rings.number_field.number_field_ideal.</span></span><span class="sig-name descname"><span class="pre">QuotientMap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M_OK_change</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">I</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.QuotientMap" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to hold data needed by quotient maps from number field
orders to residue fields.  These are only partial maps: the exact
domain is the appropriate valuation ring.  For examples, see
<a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.residue_field" title="sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.residue_field"><code class="xref py py-meth docutils literal notranslate"><span class="pre">residue_field()</span></code></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.basis_to_module">
<span class="sig-prename descclassname"><span class="pre">sage.rings.number_field.number_field_ideal.</span></span><span class="sig-name descname"><span class="pre">basis_to_module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.basis_to_module" title="Permalink to this definition">#</a></dt>
<dd><p>Given a basis <span class="math notranslate nohighlight">\(B\)</span> of elements for a <span class="math notranslate nohighlight">\(\ZZ\)</span>-submodule of a number
field <span class="math notranslate nohighlight">\(K\)</span>, return the corresponding <span class="math notranslate nohighlight">\(\ZZ\)</span>-submodule.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.number_field.number_field_ideal</span> <span class="kn">import</span> <span class="n">basis_to_module</span>
<span class="gp">sage: </span><span class="n">basis_to_module</span><span class="p">([</span><span class="n">K</span><span class="mf">.0</span><span class="p">,</span> <span class="n">K</span><span class="mf">.0</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">],</span> <span class="n">K</span><span class="p">)</span>
<span class="go">Free module of degree 4 and rank 2 over Integer Ring</span>
<span class="go">User basis matrix:</span>
<span class="go">[0 1 0 0]</span>
<span class="go">[3 0 1 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.is_NumberFieldFractionalIdeal">
<span class="sig-prename descclassname"><span class="pre">sage.rings.number_field.number_field_ideal.</span></span><span class="sig-name descname"><span class="pre">is_NumberFieldFractionalIdeal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.is_NumberFieldFractionalIdeal" title="Permalink to this definition">#</a></dt>
<dd><p>Return True if x is a fractional ideal of a number field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.number_field.number_field_ideal</span> <span class="kn">import</span> <span class="n">is_NumberFieldFractionalIdeal</span>
<span class="gp">sage: </span><span class="n">is_NumberFieldFractionalIdeal</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_NumberFieldFractionalIdeal</span><span class="p">(</span><span class="n">ideal</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]);</span> <span class="n">I</span>
<span class="go">Fractional ideal (a + 1)</span>
<span class="gp">sage: </span><span class="n">is_NumberFieldFractionalIdeal</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Z</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">Z</span>
<span class="go">Ideal (0) of Number Field in a with defining polynomial x^2 + 2</span>
<span class="gp">sage: </span><span class="n">is_NumberFieldFractionalIdeal</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.is_NumberFieldIdeal">
<span class="sig-prename descclassname"><span class="pre">sage.rings.number_field.number_field_ideal.</span></span><span class="sig-name descname"><span class="pre">is_NumberFieldIdeal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.is_NumberFieldIdeal" title="Permalink to this definition">#</a></dt>
<dd><p>Return True if x is an ideal of a number field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.number_field.number_field_ideal</span> <span class="kn">import</span> <span class="n">is_NumberFieldIdeal</span>
<span class="gp">sage: </span><span class="n">is_NumberFieldIdeal</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_NumberFieldIdeal</span><span class="p">(</span><span class="n">ideal</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]);</span> <span class="n">I</span>
<span class="go">Fractional ideal (a + 1)</span>
<span class="gp">sage: </span><span class="n">is_NumberFieldIdeal</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Z</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">Z</span>
<span class="go">Ideal (0) of Number Field in a with defining polynomial x^2 + 2</span>
<span class="gp">sage: </span><span class="n">is_NumberFieldIdeal</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field_ideal.quotient_char_p">
<span class="sig-prename descclassname"><span class="pre">sage.rings.number_field.number_field_ideal.</span></span><span class="sig-name descname"><span class="pre">quotient_char_p</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">I</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field_ideal.quotient_char_p" title="Permalink to this definition">#</a></dt>
<dd><p>Given an integral ideal <span class="math notranslate nohighlight">\(I\)</span> that contains a prime number <span class="math notranslate nohighlight">\(p\)</span>, compute
a vector space <span class="math notranslate nohighlight">\(V = (O_K \mod p) / (I \mod p)\)</span>, along with a
homomorphism <span class="math notranslate nohighlight">\(O_K \to V\)</span> and a section <span class="math notranslate nohighlight">\(V \to O_K\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.number_field.number_field_ideal</span> <span class="kn">import</span> <span class="n">quotient_char_p</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span> <span class="n">O</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">();</span> <span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">fractional_ideal</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">quotient_char_p</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="mi">5</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Vector space quotient V/W of dimension 2 over Finite Field of size 5 where</span>
<span class="go">V: Vector space of dimension 2 over Finite Field of size 5</span>
<span class="go">W: Vector space of degree 2 and dimension 0 over Finite Field of size 5</span>
<span class="go">Basis matrix:</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">quotient_char_p</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Vector space quotient V/W of dimension 2 over Finite Field of size 3 where</span>
<span class="go">V: Vector space of dimension 2 over Finite Field of size 3</span>
<span class="go">W: Vector space of degree 2 and dimension 0 over Finite Field of size 3</span>
<span class="go">Basis matrix:</span>
<span class="go">[]</span>

<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">13</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span> <span class="n">I</span>
<span class="go">Fractional ideal (-2*i + 3)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">residue_class_degree</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">quotient_char_p</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="mi">13</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Vector space quotient V/W of dimension 1 over Finite Field of size 13 where</span>
<span class="go">V: Vector space of dimension 2 over Finite Field of size 13</span>
<span class="go">W: Vector space of degree 2 and dimension 1 over Finite Field of size 13</span>
<span class="go">Basis matrix:</span>
<span class="go">[1 8]</span>
</pre></div>
</div>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="number_field_ideal_rel.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Relative Number Field Ideals</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="order.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Orders in Number Fields</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2005--2023, The Sage Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Number Field Ideals</a><ul>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.LiftMap"><code class="docutils literal notranslate"><span class="pre">LiftMap</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal"><code class="docutils literal notranslate"><span class="pre">NumberFieldFractionalIdeal</span></code></a><ul>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.denominator"><code class="docutils literal notranslate"><span class="pre">denominator()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.divides"><code class="docutils literal notranslate"><span class="pre">divides()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.element_1_mod"><code class="docutils literal notranslate"><span class="pre">element_1_mod()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.euler_phi"><code class="docutils literal notranslate"><span class="pre">euler_phi()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.factor"><code class="docutils literal notranslate"><span class="pre">factor()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.idealcoprime"><code class="docutils literal notranslate"><span class="pre">idealcoprime()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.ideallog"><code class="docutils literal notranslate"><span class="pre">ideallog()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.idealstar"><code class="docutils literal notranslate"><span class="pre">idealstar()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.invertible_residues"><code class="docutils literal notranslate"><span class="pre">invertible_residues()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.invertible_residues_mod"><code class="docutils literal notranslate"><span class="pre">invertible_residues_mod()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.is_S_integral"><code class="docutils literal notranslate"><span class="pre">is_S_integral()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.is_S_unit"><code class="docutils literal notranslate"><span class="pre">is_S_unit()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.is_coprime"><code class="docutils literal notranslate"><span class="pre">is_coprime()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.is_maximal"><code class="docutils literal notranslate"><span class="pre">is_maximal()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.is_trivial"><code class="docutils literal notranslate"><span class="pre">is_trivial()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.numerator"><code class="docutils literal notranslate"><span class="pre">numerator()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.prime_factors"><code class="docutils literal notranslate"><span class="pre">prime_factors()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.prime_to_S_part"><code class="docutils literal notranslate"><span class="pre">prime_to_S_part()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.prime_to_idealM_part"><code class="docutils literal notranslate"><span class="pre">prime_to_idealM_part()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.ramification_index"><code class="docutils literal notranslate"><span class="pre">ramification_index()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.ray_class_number"><code class="docutils literal notranslate"><span class="pre">ray_class_number()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.reduce"><code class="docutils literal notranslate"><span class="pre">reduce()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.residue_class_degree"><code class="docutils literal notranslate"><span class="pre">residue_class_degree()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.residue_field"><code class="docutils literal notranslate"><span class="pre">residue_field()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.residues"><code class="docutils literal notranslate"><span class="pre">residues()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.small_residue"><code class="docutils literal notranslate"><span class="pre">small_residue()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.support"><code class="docutils literal notranslate"><span class="pre">support()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal"><code class="docutils literal notranslate"><span class="pre">NumberFieldIdeal</span></code></a><ul>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.S_ideal_class_log"><code class="docutils literal notranslate"><span class="pre">S_ideal_class_log()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.absolute_norm"><code class="docutils literal notranslate"><span class="pre">absolute_norm()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.absolute_ramification_index"><code class="docutils literal notranslate"><span class="pre">absolute_ramification_index()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.artin_symbol"><code class="docutils literal notranslate"><span class="pre">artin_symbol()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.basis"><code class="docutils literal notranslate"><span class="pre">basis()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.coordinates"><code class="docutils literal notranslate"><span class="pre">coordinates()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.decomposition_group"><code class="docutils literal notranslate"><span class="pre">decomposition_group()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.free_module"><code class="docutils literal notranslate"><span class="pre">free_module()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.gens_reduced"><code class="docutils literal notranslate"><span class="pre">gens_reduced()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.gens_two"><code class="docutils literal notranslate"><span class="pre">gens_two()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.ideal_class_log"><code class="docutils literal notranslate"><span class="pre">ideal_class_log()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.inertia_group"><code class="docutils literal notranslate"><span class="pre">inertia_group()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.integral_basis"><code class="docutils literal notranslate"><span class="pre">integral_basis()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.integral_split"><code class="docutils literal notranslate"><span class="pre">integral_split()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.intersection"><code class="docutils literal notranslate"><span class="pre">intersection()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.is_integral"><code class="docutils literal notranslate"><span class="pre">is_integral()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.is_maximal"><code class="docutils literal notranslate"><span class="pre">is_maximal()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.is_prime"><code class="docutils literal notranslate"><span class="pre">is_prime()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.is_principal"><code class="docutils literal notranslate"><span class="pre">is_principal()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.is_zero"><code class="docutils literal notranslate"><span class="pre">is_zero()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.norm"><code class="docutils literal notranslate"><span class="pre">norm()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.number_field"><code class="docutils literal notranslate"><span class="pre">number_field()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.pari_hnf"><code class="docutils literal notranslate"><span class="pre">pari_hnf()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.pari_prime"><code class="docutils literal notranslate"><span class="pre">pari_prime()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.ramification_group"><code class="docutils literal notranslate"><span class="pre">ramification_group()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.random_element"><code class="docutils literal notranslate"><span class="pre">random_element()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.reduce_equiv"><code class="docutils literal notranslate"><span class="pre">reduce_equiv()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.relative_norm"><code class="docutils literal notranslate"><span class="pre">relative_norm()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.relative_ramification_index"><code class="docutils literal notranslate"><span class="pre">relative_ramification_index()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.residue_symbol"><code class="docutils literal notranslate"><span class="pre">residue_symbol()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.smallest_integer"><code class="docutils literal notranslate"><span class="pre">smallest_integer()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.NumberFieldIdeal.valuation"><code class="docutils literal notranslate"><span class="pre">valuation()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.QuotientMap"><code class="docutils literal notranslate"><span class="pre">QuotientMap</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.basis_to_module"><code class="docutils literal notranslate"><span class="pre">basis_to_module()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.is_NumberFieldFractionalIdeal"><code class="docutils literal notranslate"><span class="pre">is_NumberFieldFractionalIdeal()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.is_NumberFieldIdeal"><code class="docutils literal notranslate"><span class="pre">is_NumberFieldIdeal()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.number_field.number_field_ideal.quotient_char_p"><code class="docutils literal notranslate"><span class="pre">quotient_char_p()</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/scripts/furo.js"></script>
    <script src="../../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"ZZ": "\\Bold{Z}", "NN": "\\Bold{N}", "RR": "\\Bold{R}", "CC": "\\Bold{C}", "QQ": "\\Bold{Q}", "QQbar": "\\overline{\\QQ}", "GF": ["\\Bold{F}_{#1}", 1], "Zp": ["\\Bold{Z}_{#1}", 1], "Qp": ["\\Bold{Q}_{#1}", 1], "Zmod": ["\\ZZ/#1\\ZZ", 1], "CDF": "\\Bold{C}", "CIF": "\\Bold{C}", "CLF": "\\Bold{C}", "RDF": "\\Bold{R}", "RIF": "\\Bold{I} \\Bold{R}", "RLF": "\\Bold{R}", "SL": "\\mathrm{SL}", "PSL": "\\mathrm{PSL}", "Bold": ["\\mathbf{#1}", 1]}, "inlineMath": [["$", "$"], ["\\(", "\\)"]], "maxBuffer": 51200, "autoload": {"color": [], "colorv2": ["color"]}}}</script>
    <script defer="defer" src="../../../../_static/mathjax/tex-chtml.js"></script>
    </body>
</html>