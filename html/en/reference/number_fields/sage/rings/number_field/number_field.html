
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Number Fields &#8212; Sage 9.4 Reference Manual: Algebraic Numbers and Number Fields</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sage.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script async="async" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Base class for all number fields" href="number_field_base.html" />
    <link rel="prev" title="Algebraic Numbers and Number Fields" href="../../../index.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="number_field_base.html" title="Base class for all number fields"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../../../index.html" title="Algebraic Numbers and Number Fields"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Sage 9.4 Reference Manual: Algebraic Numbers and Number Fields</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">Number Fields</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="number-fields">
<span id="sage-rings-number-field-number-field"></span><h1>Number Fields<a class="headerlink" href="#number-fields" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.rings.number_field.number_field"></span><p>AUTHORS:</p>
<ul class="simple">
<li><p>William Stein (2004, 2005): initial version</p></li>
<li><p>Steven Sivek (2006-05-12): added support for relative extensions</p></li>
<li><p>William Stein (2007-09-04): major rewrite and documentation</p></li>
<li><p>Robert Bradshaw (2008-10): specified embeddings into ambient fields</p></li>
<li><p>Simon King (2010-05): Improve coercion from GAP</p></li>
<li><p>Jeroen Demeyer (2010-07, 2011-04): Upgrade PARI (<a class="reference external" href="https://trac.sagemath.org/9343">trac ticket #9343</a>, <a class="reference external" href="https://trac.sagemath.org/10430">trac ticket #10430</a>, <a class="reference external" href="https://trac.sagemath.org/11130">trac ticket #11130</a>)</p></li>
<li><p>Robert Harron (2012-08): added is_CM(), complex_conjugation(), and
maximal_totally_real_subfield()</p></li>
<li><p>Christian Stump (2012-11): added conversion to universal cyclotomic field</p></li>
<li><p>Julian Rueth (2014-04-03): absolute number fields are unique parents</p></li>
<li><p>Vincent Delecroix (2015-02): comparisons/floor/ceil using embeddings</p></li>
<li><p>Kiran Kedlaya (2016-05): relative number fields hash based on relative polynomials</p></li>
<li><p>Peter Bruin (2016-06): make number fields fully satisfy unique representation</p></li>
<li><p>John Jones (2017-07): improve check for is_galois(), add is_abelian(), building on work in patch by Chris Wuthrich</p></li>
<li><p>Anna Haensch (2018-03): added <code class="xref py py-meth docutils literal notranslate"><span class="pre">quadratic_defect()</span></code></p></li>
<li><p>Michael Daub, Chris Wuthrich (2020-09-01): adding Dirichlet characters for abelian fields</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Unlike in PARI/GP, class group computations <em>in Sage</em> do <em>not</em> by default
assume the Generalized Riemann Hypothesis. To do class groups computations
not provably correctly you must often pass the flag <code class="docutils literal notranslate"><span class="pre">proof=False</span></code> to
functions or call the function <code class="docutils literal notranslate"><span class="pre">proof.number_field(False)</span></code>. It can easily
take 1000’s of times longer to do computations with <code class="docutils literal notranslate"><span class="pre">proof=True</span></code> (the
default).</p>
</div>
<p>This example follows one in the Magma reference manual:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">420</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">40000</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">5</span><span class="o">/</span><span class="mi">11</span><span class="p">;</span> <span class="n">z</span>
<span class="go">420/11*y^3 - 40000/11*y</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">f</span><span class="p">);</span> <span class="n">L</span>
<span class="go">Number Field in a with defining polynomial y^2 + y + 1 over its base field</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">420</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">40000</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]);</span> <span class="n">KL</span>
<span class="go">Number Field in b0 with defining polynomial x^4 - 420*x^2 + 40000 over its base field</span>
</pre></div>
</div>
<p>We do some arithmetic in a tower of relative number fields:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">cuberoot2</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">cuberoot3</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">sqrt2</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span>
<span class="go">Number Field in sqrt2 with defining polynomial x^2 - 2 over its base field</span>
<span class="gp">sage: </span><span class="n">sqrt2</span> <span class="o">*</span> <span class="n">cuberoot3</span>
<span class="go">cuberoot3*sqrt2</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">sqrt2</span> <span class="o">+</span> <span class="n">cuberoot3</span><span class="p">)</span><span class="o">^</span><span class="mi">5</span>
<span class="go">(20*cuberoot3^2 + 15*cuberoot3 + 4)*sqrt2 + 3*cuberoot3^2 + 20*cuberoot3 + 60</span>
<span class="gp">sage: </span><span class="n">cuberoot2</span> <span class="o">+</span> <span class="n">cuberoot3</span>
<span class="go">cuberoot3 + cuberoot2</span>
<span class="gp">sage: </span><span class="n">cuberoot2</span> <span class="o">+</span> <span class="n">cuberoot3</span> <span class="o">+</span> <span class="n">sqrt2</span>
<span class="go">sqrt2 + cuberoot3 + cuberoot2</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">cuberoot2</span> <span class="o">+</span> <span class="n">cuberoot3</span> <span class="o">+</span> <span class="n">sqrt2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="go">(2*cuberoot3 + 2*cuberoot2)*sqrt2 + cuberoot3^2 + 2*cuberoot2*cuberoot3 + cuberoot2^2 + 2</span>
<span class="gp">sage: </span><span class="n">cuberoot2</span> <span class="o">+</span> <span class="n">sqrt2</span>
<span class="go">sqrt2 + cuberoot2</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="n">cuberoot2</span><span class="p">);</span> <span class="n">a</span>
<span class="go">cuberoot2</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Number Field in sqrt2 with defining polynomial x^2 - 2 over its base field</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Doing arithmetic in towers of relative fields that depends on
canonical coercions is currently VERY SLOW. It is much better to
explicitly coerce all elements into a common field, then do
arithmetic with them there (which is quite fast).</p>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.CyclotomicFieldFactory">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sage.rings.number_field.number_field.</span></span><span class="sig-name descname"><span class="pre">CyclotomicFieldFactory</span></span><a class="headerlink" href="#sage.rings.number_field.number_field.CyclotomicFieldFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/factory.html#sage.structure.factory.UniqueFactory" title="(in Sage 9.4 Reference Manual: Parents and Elements v9.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.structure.factory.UniqueFactory</span></code></a></p>
<p>Return the <span class="math notranslate nohighlight">\(n\)</span>-th cyclotomic field, where n is a positive integer,
or the universal cyclotomic field if <code class="docutils literal notranslate"><span class="pre">n==0</span></code>.</p>
<p>For the documentation of the universal cyclotomic field, see
<a class="reference internal" href="../universal_cyclotomic_field.html#sage.rings.universal_cyclotomic_field.UniversalCyclotomicField" title="sage.rings.universal_cyclotomic_field.UniversalCyclotomicField"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniversalCyclotomicField</span></code></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> - a nonnegative integer, default:<code class="docutils literal notranslate"><span class="pre">0</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">names</span></code> - name of generator (optional - defaults to zetan)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bracket</span></code> - Defines the brackets in the case of <code class="docutils literal notranslate"><span class="pre">n==0</span></code>, and
is ignored otherwise. Can be any even length string, with <code class="docutils literal notranslate"><span class="pre">&quot;()&quot;</span></code> being the default.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">embedding</span></code> - bool or n-th root of unity in an
ambient field (default True)</p></li>
</ul>
<p>EXAMPLES:</p>
<p>If called without a parameter, we get the <a class="reference internal" href="../universal_cyclotomic_field.html#sage.rings.universal_cyclotomic_field.UniversalCyclotomicField" title="sage.rings.universal_cyclotomic_field.UniversalCyclotomicField"><code class="xref py py-class docutils literal notranslate"><span class="pre">universal</span> <span class="pre">cyclotomic</span>
<span class="pre">field</span></code></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">()</span>
<span class="go">Universal Cyclotomic Field</span>
</pre></div>
</div>
<p>We create the <span class="math notranslate nohighlight">\(7\)</span>th cyclotomic field
<span class="math notranslate nohighlight">\(\QQ(\zeta_7)\)</span> with the default generator name.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">7</span><span class="p">);</span> <span class="n">k</span>
<span class="go">Cyclotomic Field of order 7 and degree 6</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="go">zeta7</span>
</pre></div>
</div>
<p>The default embedding sends the generator to the complex primitive
<span class="math notranslate nohighlight">\(n^{th}\)</span> root of unity of least argument.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CC</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">gen</span><span class="p">())</span>
<span class="go">0.623489801858734 + 0.781831482468030*I</span>
</pre></div>
</div>
<p>Cyclotomic fields are of a special type.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.rings.number_field.number_field.NumberField_cyclotomic_with_category&#39;&gt;</span>
</pre></div>
</div>
<p>We can specify a different generator name as follows.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">z7</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">7</span><span class="p">);</span> <span class="n">k</span>
<span class="go">Cyclotomic Field of order 7 and degree 6</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="go">z7</span>
</pre></div>
</div>
<p>The <span class="math notranslate nohighlight">\(n\)</span> must be an integer.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: no conversion of this rational to integer</span>
</pre></div>
</div>
<p>The degree must be nonnegative.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: n (=-1) must be a positive integer</span>
</pre></div>
</div>
<p>The special case <span class="math notranslate nohighlight">\(n=1\)</span> does <em>not</em> return the rational
numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Cyclotomic Field of order 1 and degree 1</span>
</pre></div>
</div>
<p>Due to their default embedding into <span class="math notranslate nohighlight">\(\CC\)</span>,
cyclotomic number fields are all compatible.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cf30</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cf5</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cf3</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cf30</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span> <span class="o">+</span> <span class="n">cf5</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span> <span class="o">+</span> <span class="n">cf3</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="go">zeta30^6 + zeta30^5 + zeta30 - 1</span>
<span class="gp">sage: </span><span class="n">cf6</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">;</span> <span class="n">z6</span> <span class="o">=</span> <span class="n">cf6</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">cf3</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">;</span> <span class="n">z3</span> <span class="o">=</span> <span class="n">cf3</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">cf3</span><span class="p">(</span><span class="n">z6</span><span class="p">)</span>
<span class="go">zeta3 + 1</span>
<span class="gp">sage: </span><span class="n">cf6</span><span class="p">(</span><span class="n">z3</span><span class="p">)</span>
<span class="go">zeta6 - 1</span>
<span class="gp">sage: </span><span class="n">cf9</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="p">;</span> <span class="n">z9</span> <span class="o">=</span> <span class="n">cf9</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">cf18</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span> <span class="p">;</span> <span class="n">z18</span> <span class="o">=</span> <span class="n">cf18</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">cf18</span><span class="p">(</span><span class="n">z9</span><span class="p">)</span>
<span class="go">zeta18^2</span>
<span class="gp">sage: </span><span class="n">cf9</span><span class="p">(</span><span class="n">z18</span><span class="p">)</span>
<span class="go">-zeta9^5</span>
<span class="gp">sage: </span><span class="n">cf18</span><span class="p">(</span><span class="n">z3</span><span class="p">)</span>
<span class="go">zeta18^3 - 1</span>
<span class="gp">sage: </span><span class="n">cf18</span><span class="p">(</span><span class="n">z6</span><span class="p">)</span>
<span class="go">zeta18^3</span>
<span class="gp">sage: </span><span class="n">cf18</span><span class="p">(</span><span class="n">z6</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="go">zeta18^3 - 1</span>
<span class="gp">sage: </span><span class="n">cf9</span><span class="p">(</span><span class="n">z3</span><span class="p">)</span>
<span class="go">zeta9^3</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.CyclotomicFieldFactory.create_key">
<span class="sig-name descname"><span class="pre">create_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.CyclotomicFieldFactory.create_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the unique key for the cyclotomic field specified by the
parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.CyclotomicFieldFactory.create_object">
<span class="sig-name descname"><span class="pre">create_object</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">version</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">extra_args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.CyclotomicFieldFactory.create_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the unique cyclotomic field defined by <code class="docutils literal notranslate"><span class="pre">key</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.GaussianField">
<span class="sig-prename descclassname"><span class="pre">sage.rings.number_field.number_field.</span></span><span class="sig-name descname"><span class="pre">GaussianField</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.GaussianField" title="Permalink to this definition">¶</a></dt>
<dd><p>The field QQ[i].</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField">
<span class="sig-prename descclassname"><span class="pre">sage.rings.number_field.number_field.</span></span><span class="sig-name descname"><span class="pre">NumberField</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">polynomial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latex_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assume_disc_small</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maximize_at_primes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latex_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <em>the</em> number field (or tower of number fields) defined by the
irreducible <code class="docutils literal notranslate"><span class="pre">polynomial</span></code>.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">polynomial</span></code> - a polynomial over <span class="math notranslate nohighlight">\(\QQ\)</span> or a number field, or a list
of such polynomials.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">names</span></code> (or <code class="docutils literal notranslate"><span class="pre">name</span></code>) - a string or a list of strings, the names of
the generators</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> - a boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); do type checking and
irreducibility checking.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">embedding</span></code> - <code class="docutils literal notranslate"><span class="pre">None</span></code>, an element, or a list of elements, the
images of the generators in an ambient field (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">latex_names</span></code> (or <code class="docutils literal notranslate"><span class="pre">latex_name</span></code>) - <code class="docutils literal notranslate"><span class="pre">None</span></code>, a string, or a
list of strings (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>), how the generators are printed
for latex output</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">assume_disc_small</span></code> – a boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); if <code class="docutils literal notranslate"><span class="pre">True</span></code>,
assume that no square of a prime greater than PARI’s primelimit
(which should be 500000); only applies for absolute fields at
present.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">maximize_at_primes</span></code> – <code class="docutils literal notranslate"><span class="pre">None</span></code> or a list of primes (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>); if not <code class="docutils literal notranslate"><span class="pre">None</span></code>, then the maximal order is computed by
maximizing only at the primes in this list, which completely avoids
having to factor the discriminant, but of course can lead to wrong
results; only applies for absolute fields at present.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">structure</span></code> – <code class="docutils literal notranslate"><span class="pre">None</span></code>, a list or an instance of
<code class="xref py py-class docutils literal notranslate"><span class="pre">structure.NumberFieldStructure</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>),
internally used to pass in additional structural information, e.g.,
about the field from which this field is created as a subfield.</p></li>
</ul>
</div></blockquote>
<p>We accept <code class="docutils literal notranslate"><span class="pre">implementation</span></code> and <code class="docutils literal notranslate"><span class="pre">prec</span></code> attributes for compatibility
with <a class="reference external" href="../../../../categories/sage/categories/pushout.html#sage.categories.pushout.AlgebraicExtensionFunctor" title="(in Sage 9.4 Reference Manual: Category Framework v9.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">AlgebraicExtensionFunctor</span></code></a>
but we ignore them as they are not used.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in s with defining polynomial z^2 - 2</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="mi">0</span><span class="p">;</span> <span class="n">s</span>
<span class="go">s</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">*</span><span class="n">s</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">^</span><span class="mi">2</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Constructing a relative number field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">t</span><span class="o">+</span><span class="n">a</span><span class="p">);</span> <span class="n">L</span>
<span class="go">Number Field in b with defining polynomial t^3 + t + a over its base field</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">absolute_field</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="go">Number Field in c with defining polynomial x^6 + 2*x^4 + x^2 - 2</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">*</span><span class="n">b</span>
<span class="go">a*b</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">a</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">lift_to_base</span><span class="p">(</span><span class="n">b</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>
<span class="go">-a</span>
</pre></div>
</div>
<p>Constructing another number field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">k</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.&lt;</span><span class="n">j</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">i</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span>
<span class="go">Number Field in j with defining polynomial z^3 + i*z + 3 over its base field</span>
</pre></div>
</div>
<p>Number fields are globally unique:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">^</span><span class="mi">3</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="ow">is</span> <span class="n">L</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Equality of number fields depends on the variable name of the
defining polynomial:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">);</span> <span class="n">y</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span>
<span class="go">Number Field in a with defining polynomial x^2 + 3</span>
<span class="gp">sage: </span><span class="n">m</span>
<span class="go">Number Field in a with defining polynomial y^2 + 3</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">==</span> <span class="n">m</span>
<span class="go">False</span>
</pre></div>
</div>
<p>In case of conflict of the generator name with the name given by the preparser, the name given by the preparser takes precedence:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in b with defining polynomial x^2 + 5</span>
</pre></div>
</div>
<p>One can also define number fields with specified embeddings, may be used
for arithmetic and deduce relations with other number fields which would
not be valid for an abstract number field.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">embedding</span><span class="o">=</span><span class="mf">1.2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">RR</span><span class="o">.</span><span class="n">coerce_map_from</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="go">Composite map:</span>
<span class="go">  From: Number Field in a with defining polynomial x^3 - 2 with a = 1.259921049894873?</span>
<span class="go">  To:   Real Field with 53 bits of precision</span>
<span class="go">  Defn:   Generic morphism:</span>
<span class="go">          From: Number Field in a with defining polynomial x^3 - 2 with a = 1.259921049894873?</span>
<span class="go">          To:   Real Lazy Field</span>
<span class="go">          Defn: a -&gt; 1.259921049894873?</span>
<span class="go">        then</span>
<span class="go">          Conversion via _mpfr_ method map:</span>
<span class="go">          From: Real Lazy Field</span>
<span class="go">          To:   Real Field with 53 bits of precision</span>
<span class="gp">sage: </span><span class="n">RR</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">1.25992104989487</span>
<span class="gp">sage: </span><span class="mf">1.1</span> <span class="o">+</span> <span class="n">a</span>
<span class="go">2.35992104989487</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span> <span class="n">b</span>
<span class="go">1/3*a^2 - 1/3*a + 1/3</span>
<span class="gp">sage: </span><span class="n">RR</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">0.442493334024442</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">embedding</span><span class="o">=</span><span class="mf">1.1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">b^2</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
<span class="go">b^2 + b</span>
</pre></div>
</div>
<p>Note that the image only needs to be specified to enough precision
to distinguish roots, and is exactly computed to any needed
precision:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">RealField</span><span class="p">(</span><span class="mi">200</span><span class="p">)(</span><span class="n">a</span><span class="p">)</span>
<span class="go">1.2599210498948731647672106072782283505702514647015079800820</span>
</pre></div>
</div>
<p>One can embed into any other field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">embedding</span><span class="o">=</span><span class="n">CC</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span><span class="o">-</span><span class="mf">0.6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">CC</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">-0.629960524947436 + 1.09112363597172*I</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">L</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">embedding</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">+</span> <span class="n">L</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">4 + 2*5^2 + 2*5^3 + 3*5^4 + 5^5 + 4*5^6 + 2*5^8 + 3*5^9 + 4*5^12 + 4*5^14 + 4*5^15 + 3*5^16 + 5^17 + 5^18 + 2*5^19 + O(5^20)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="n">embedding</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="n">embedding</span><span class="o">=</span><span class="n">b</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">+</span><span class="n">b</span>
<span class="go">b^2 + b</span>
<span class="gp">sage: </span><span class="n">CC</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="n">CC</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">coerce_embedding</span><span class="p">()</span>
<span class="go">Generic morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial x^3 - x + 1/10 with a = b^2</span>
<span class="go">  To:   Number Field in b with defining polynomial x^6 - x^2 + 1/10 with b = 0.9724449978911874?</span>
<span class="go">  Defn: a -&gt; b^2</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">QuadraticField</span></code> and <code class="docutils literal notranslate"><span class="pre">CyclotomicField</span></code> constructors
create an embedding by default unless otherwise specified:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">zeta</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">CC</span><span class="p">(</span><span class="n">zeta</span><span class="p">)</span>
<span class="go">0.913545457642601 + 0.406736643075800*I</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">sqrtn3</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="n">sqrtn3</span><span class="p">)</span>
<span class="go">2*zeta^5 + 1</span>
<span class="gp">sage: </span><span class="n">sqrtn3</span> <span class="o">+</span> <span class="n">zeta</span>
<span class="go">2*zeta^5 + zeta + 1</span>
</pre></div>
</div>
<p>Comparison depends on the (real) embedding specified (or the one selected by default).
Note that the codomain of the embedding must be <code class="docutils literal notranslate"><span class="pre">QQbar</span></code> or <code class="docutils literal notranslate"><span class="pre">AA</span></code> for this to work
(see <a class="reference external" href="https://trac.sagemath.org/20184">trac ticket #20184</a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span><span class="o">.&lt;</span><span class="n">g</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">embedding</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="mi">1</span> <span class="o">&lt;</span> <span class="n">g</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">&gt;</span> <span class="mi">1</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">RR</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">-1.25992104989487</span>
</pre></div>
</div>
<p>If no embedding is specified or is complex, the comparison is not returning something
meaningful.:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span><span class="o">.&lt;</span><span class="n">g</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="mi">1</span> <span class="o">&lt;</span> <span class="n">g</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">&gt;</span> <span class="mi">1</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Since SageMath 6.9, number fields may be defined by polynomials
that are not necessarily integral or monic.  The only notable
practical point is that in the PARI interface, a monic integral
polynomial defining the same number field is computed and used:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">pari_polynomial</span><span class="p">()</span>
<span class="go">x^3 - x^2 - 2</span>
</pre></div>
</div>
<p>Elements and ideals may be converted to and from PARI as follows:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">pari</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">Mod(-1/2*y^2 + 1/2*y, y^3 - y^2 - 2)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="n">pari</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="go">a</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="p">);</span> <span class="n">I</span>
<span class="go">Fractional ideal (a)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">pari_hnf</span><span class="p">()</span>
<span class="go">[1, 0, 0; 0, 1, 0; 0, 0, 1/2]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">pari_hnf</span><span class="p">())</span>
<span class="go">Fractional ideal (a)</span>
</pre></div>
</div>
<p>Here is an example where the field has non-trivial class group:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">pari_polynomial</span><span class="p">()</span>
<span class="go">x^2 - 15</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span> <span class="n">J</span>
<span class="go">Fractional ideal (2, 15*b + 1)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">pari_hnf</span><span class="p">()</span>
<span class="go">[2, 1; 0, 1]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">J</span><span class="o">.</span><span class="n">pari_hnf</span><span class="p">())</span>
<span class="go">Fractional ideal (2, 15*b + 1)</span>
</pre></div>
</div>
<p>An example involving a variable name that defines a function in
PARI:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">theta</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="s1">&#39;theta&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">theta</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="n">theta</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]);</span> <span class="n">M</span>
<span class="go">Number Field in z0 with defining polynomial theta^3 + 4 over its base field</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberFieldFactory">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sage.rings.number_field.number_field.</span></span><span class="sig-name descname"><span class="pre">NumberFieldFactory</span></span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberFieldFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/factory.html#sage.structure.factory.UniqueFactory" title="(in Sage 9.4 Reference Manual: Parents and Elements v9.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.structure.factory.UniqueFactory</span></code></a></p>
<p>Factory for number fields.</p>
<p>This should usually not be called directly, use <a class="reference internal" href="#sage.rings.number_field.number_field.NumberField" title="sage.rings.number_field.number_field.NumberField"><code class="xref py py-meth docutils literal notranslate"><span class="pre">NumberField()</span></code></a>
instead.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">polynomial</span></code> - a polynomial over <span class="math notranslate nohighlight">\(\QQ\)</span> or a number field.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> - a string (default: <code class="docutils literal notranslate"><span class="pre">'a'</span></code>), the name of the generator</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> - a boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); do type checking and
irreducibility checking.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">embedding</span></code> - <code class="docutils literal notranslate"><span class="pre">None</span></code> or an element, the images of the generator
in an ambient field (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">latex_name</span></code> - <code class="docutils literal notranslate"><span class="pre">None</span></code> or a string (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>), how the
generator is printed for latex output</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">assume_disc_small</span></code> – a boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); if <code class="docutils literal notranslate"><span class="pre">True</span></code>,
assume that no square of a prime greater than PARI’s primelimit
(which should be 500000); only applies for absolute fields at
present.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">maximize_at_primes</span></code> – <code class="docutils literal notranslate"><span class="pre">None</span></code> or a list of primes (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>); if not <code class="docutils literal notranslate"><span class="pre">None</span></code>, then the maximal order is computed by
maximizing only at the primes in this list, which completely avoids
having to factor the discriminant, but of course can lead to wrong
results; only applies for absolute fields at present.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">structure</span></code> – <code class="docutils literal notranslate"><span class="pre">None</span></code> or an instance of
<code class="xref py py-class docutils literal notranslate"><span class="pre">structure.NumberFieldStructure</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>),
internally used to pass in additional structural information, e.g.,
about the field from which this field is created as a subfield.</p></li>
</ul>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberFieldFactory.create_key_and_extra_args">
<span class="sig-name descname"><span class="pre">create_key_and_extra_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">polynomial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latex_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assume_disc_small</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maximize_at_primes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberFieldFactory.create_key_and_extra_args" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a unique key for the number field specified by the parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberFieldFactory.create_object">
<span class="sig-name descname"><span class="pre">create_object</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">version</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberFieldFactory.create_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the unique number field defined by <code class="docutils literal notranslate"><span class="pre">key</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberFieldTower">
<span class="sig-prename descclassname"><span class="pre">sage.rings.number_field.number_field.</span></span><span class="sig-name descname"><span class="pre">NumberFieldTower</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">polynomials</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embeddings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latex_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assume_disc_small</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maximize_at_primes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structures</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberFieldTower" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the tower of number fields defined by the polynomials in the list
<code class="docutils literal notranslate"><span class="pre">polynomials</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">polynomials</span></code> - a list of polynomials. Each entry must be polynomial
which is irreducible over the number field generated by the roots of the
following entries.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">names</span></code> - a list of strings or a string, the names of the generators of
the relative number fields. If a single string, then names are generated
from that string.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> - a boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>), whether to check that the
polynomials are irreducible</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">embeddings</span></code> - a list of elements or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>),
embeddings of the relative number fields in an ambient field.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">latex_names</span></code> - a list of strings or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>), names
used to print the generators for latex output.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">assume_disc_small</span></code> – a boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); if <code class="docutils literal notranslate"><span class="pre">True</span></code>,
assume that no square of a prime greater than PARI’s primelimit
(which should be 500000); only applies for absolute fields at
present.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">maximize_at_primes</span></code> – <code class="docutils literal notranslate"><span class="pre">None</span></code> or a list of primes (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>); if not <code class="docutils literal notranslate"><span class="pre">None</span></code>, then the maximal order is computed by
maximizing only at the primes in this list, which completely avoids
having to factor the discriminant, but of course can lead to wrong
results; only applies for absolute fields at present.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">structures</span></code> – <code class="docutils literal notranslate"><span class="pre">None</span></code> or a list (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>), internally used
to provide additional information about the number field such as the
field from which it was created.</p></li>
</ul>
<p>OUTPUT:</p>
<p>The relative number field generated by a root of the first entry of
<code class="docutils literal notranslate"><span class="pre">polynomials</span></code> over the relative number field generated by root of the
second entry of <code class="docutils literal notranslate"><span class="pre">polynomials</span></code> … over the number field over which the
last entry of <code class="docutils literal notranslate"><span class="pre">polynomials</span></code> is defined.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]);</span> <span class="n">k</span> <span class="c1"># indirect doctest</span>
<span class="go">Number Field in a with defining polynomial x^2 + 1 over its base field</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">^</span><span class="mi">2</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">^</span><span class="mi">2</span>
<span class="go">-3</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">^</span><span class="mi">2</span>
<span class="go">-5</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="go">(2*b + 2*c)*a + 2*c*b - 9</span>
</pre></div>
</div>
<p>The Galois group is a product of 3 groups of order 2:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">absolute_field</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">galois_group</span><span class="p">()</span>
<span class="go">Galois group 8T3 (2[x]2[x]2) with order 8 of x^8 + 36*x^6 + 302*x^4 + 564*x^2 + 121</span>
</pre></div>
</div>
<p>Repeatedly calling base_field allows us to descend the internally
constructed tower of fields:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">base_field</span><span class="p">()</span>
<span class="go">Number Field in b with defining polynomial x^2 + 3 over its base field</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">base_field</span><span class="p">()</span><span class="o">.</span><span class="n">base_field</span><span class="p">()</span>
<span class="go">Number Field in c with defining polynomial x^2 + 5</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">base_field</span><span class="p">()</span><span class="o">.</span><span class="n">base_field</span><span class="p">()</span><span class="o">.</span><span class="n">base_field</span><span class="p">()</span>
<span class="go">Rational Field</span>
</pre></div>
</div>
<p>In the following example the second polynomial is reducible over
the first, so we get an error:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: defining polynomial (x^3 - 2) must be irreducible</span>
</pre></div>
</div>
<p>We mix polynomial parent rings:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;beta&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span>
<span class="go">Number Field in beta0 with defining polynomial y^3 - 3 over its base field</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">base_field</span> <span class="p">()</span>
<span class="go">Number Field in beta1 with defining polynomial x^2 + x + 1 over its base field</span>
</pre></div>
</div>
<p>A tower of quadratic fields:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">K</span>
<span class="go">Number Field in a0 with defining polynomial x^2 + 3 over its base field</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">base_field</span><span class="p">()</span>
<span class="go">Number Field in a1 with defining polynomial x^2 + 2 over its base field</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">base_field</span><span class="p">()</span><span class="o">.</span><span class="n">base_field</span><span class="p">()</span>
<span class="go">Number Field in a2 with defining polynomial x^2 + 1</span>
</pre></div>
</div>
<p>LaTeX versions of generator names can be specified either as:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">5</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="n">latex_names</span><span class="o">=</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;\alpha&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\beta&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\gamma&#39;</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">inject_variables</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">latex</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span>
<span class="go">\alpha + \beta + \gamma</span>
</pre></div>
</div>
<p>or as:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">5</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">latex_names</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\alpha&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">inject_variables</span><span class="p">()</span>
<span class="go">Defining a0, a1, a2</span>
<span class="gp">sage: </span><span class="n">latex</span><span class="p">(</span><span class="n">a0</span> <span class="o">+</span> <span class="n">a1</span> <span class="o">+</span> <span class="n">a2</span><span class="p">)</span>
<span class="go">\alpha_{0} + \alpha_{1} + \alpha_{2}</span>
</pre></div>
</div>
<p>A bigger tower of quadratic fields:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a2</span><span class="p">,</span><span class="n">a3</span><span class="p">,</span><span class="n">a5</span><span class="p">,</span><span class="n">a7</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]]);</span> <span class="n">K</span>
<span class="go">Number Field in a2 with defining polynomial x^2 + 2 over its base field</span>
<span class="gp">sage: </span><span class="n">a2</span><span class="o">^</span><span class="mi">2</span>
<span class="go">-2</span>
<span class="gp">sage: </span><span class="n">a3</span><span class="o">^</span><span class="mi">2</span>
<span class="go">-3</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a2</span><span class="o">+</span><span class="n">a3</span><span class="o">+</span><span class="n">a5</span><span class="o">+</span><span class="n">a7</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span>
<span class="go">((6*a5 + 6*a7)*a3 + 6*a7*a5 - 47)*a2 + (6*a7*a5 - 45)*a3 - 41*a5 - 37*a7</span>
</pre></div>
</div>
<p>The function can also be called by name:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NumberFieldTower</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="go">Number Field in a with defining polynomial x^2 + 1 over its base field</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sage.rings.number_field.number_field.</span></span><span class="sig-name descname"><span class="pre">NumberField_absolute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">polynomial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latex_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assume_disc_small</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maximize_at_primes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.rings.number_field.number_field.NumberField_generic" title="sage.rings.number_field.number_field.NumberField_generic"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.rings.number_field.number_field.NumberField_generic</span></code></a></p>
<p>Function to initialize an absolute number field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">17</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in a with defining polynomial x^17 + 3</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.rings.number_field.number_field.NumberField_absolute_with_category&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">TestSuite</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.abs_val">
<span class="sig-name descname"><span class="pre">abs_val</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iota</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.abs_val" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value <span class="math notranslate nohighlight">\(|\iota|_{v}\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code> – a place of <code class="docutils literal notranslate"><span class="pre">K</span></code>, finite (a fractional ideal) or infinite (element of <code class="docutils literal notranslate"><span class="pre">K.places(prec)</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">iota</span></code> – an element of <code class="docutils literal notranslate"><span class="pre">K</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) the precision of the real field</p></li>
</ul>
<p>OUTPUT:</p>
<p>The absolute value as a real number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">xi</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi_real</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">places</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">phi_complex</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">places</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">v_fin</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">3</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">abs_val</span><span class="p">(</span><span class="n">phi_real</span><span class="p">,</span><span class="n">xi</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">2.08008382305190</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">abs_val</span><span class="p">(</span><span class="n">phi_complex</span><span class="p">,</span><span class="n">xi</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">4.32674871092223</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">abs_val</span><span class="p">(</span><span class="n">v_fin</span><span class="p">,</span><span class="n">xi</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">0.111111111111111</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.absolute_degree">
<span class="sig-name descname"><span class="pre">absolute_degree</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.absolute_degree" title="Permalink to this definition">¶</a></dt>
<dd><p>A synonym for degree.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">absolute_degree</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.absolute_different">
<span class="sig-name descname"><span class="pre">absolute_different</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.absolute_different" title="Permalink to this definition">¶</a></dt>
<dd><p>A synonym for different.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">absolute_different</span><span class="p">()</span>
<span class="go">Fractional ideal (2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.absolute_discriminant">
<span class="sig-name descname"><span class="pre">absolute_discriminant</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.absolute_discriminant" title="Permalink to this definition">¶</a></dt>
<dd><p>A synonym for discriminant.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">absolute_discriminant</span><span class="p">()</span>
<span class="go">-4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.absolute_generator">
<span class="sig-name descname"><span class="pre">absolute_generator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.absolute_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>An alias for
<a class="reference internal" href="#sage.rings.number_field.number_field.NumberField_generic.gen" title="sage.rings.number_field.number_field.NumberField_generic.gen"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.rings.number_field.number_field.NumberField_generic.gen()</span></code></a>.
This is provided for consistency with relative fields, where the
element returned by
<a class="reference internal" href="number_field_rel.html#sage.rings.number_field.number_field_rel.NumberField_relative.gen" title="sage.rings.number_field.number_field_rel.NumberField_relative.gen"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.rings.number_field.number_field_rel.NumberField_relative.gen()</span></code></a>
only generates the field over its base field (not necessarily over
<span class="math notranslate nohighlight">\(\QQ\)</span>).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">17</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">absolute_generator</span><span class="p">()</span>
<span class="go">a</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.absolute_polynomial">
<span class="sig-name descname"><span class="pre">absolute_polynomial</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.absolute_polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Return absolute polynomial that defines this absolute field. This
is the same as <code class="docutils literal notranslate"><span class="pre">self.polynomial()</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">absolute_polynomial</span> <span class="p">()</span>
<span class="go">x^2 + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.absolute_vector_space">
<span class="sig-name descname"><span class="pre">absolute_vector_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.absolute_vector_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Return vector space over <span class="math notranslate nohighlight">\(\QQ\)</span> corresponding to this
number field, along with maps from that space to this number field
and in the other direction.</p>
<p>For an absolute extension this is identical to
<code class="docutils literal notranslate"><span class="pre">self.vector_space()</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">absolute_vector_space</span><span class="p">()</span>
<span class="go">(Vector space of dimension 3 over Rational Field,</span>
<span class="go"> Isomorphism map:</span>
<span class="go">  From: Vector space of dimension 3 over Rational Field</span>
<span class="go">  To:   Number Field in a with defining polynomial x^3 - 5,</span>
<span class="go"> Isomorphism map:</span>
<span class="go">  From: Number Field in a with defining polynomial x^3 - 5</span>
<span class="go">  To:   Vector space of dimension 3 over Rational Field)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.automorphisms">
<span class="sig-name descname"><span class="pre">automorphisms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.automorphisms" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute all Galois automorphisms of self.</p>
<p>This uses PARI’s <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/nfgaloisconj">pari:nfgaloisconj</a> and is much faster than root finding
for many fields.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">10000</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">automorphisms</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">Ring endomorphism of Number Field in a with defining polynomial x^2 + 10000</span>
<span class="go">  Defn: a |--&gt; a,</span>
<span class="go">Ring endomorphism of Number Field in a with defining polynomial x^2 + 10000</span>
<span class="go">  Defn: a |--&gt; -a</span>
<span class="go">]</span>
</pre></div>
</div>
<p>Here’s a larger example, that would take some time if we found
roots instead of using PARI’s specialized machinery:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">automorphisms</span><span class="p">())</span>
<span class="go">2</span>
</pre></div>
</div>
<p><span class="math notranslate nohighlight">\(L\)</span> is the Galois closure of <span class="math notranslate nohighlight">\(K\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">24</span> <span class="o">-</span> <span class="mi">84</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">22</span> <span class="o">+</span> <span class="mi">2814</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">20</span> <span class="o">-</span> <span class="mi">15880</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">18</span> <span class="o">-</span> <span class="mi">409563</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">16</span> <span class="o">-</span> <span class="mi">8543892</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">14</span> <span class="o">+</span> <span class="mi">25518202</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">12</span> <span class="o">+</span> <span class="mi">32831026956</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">10</span> <span class="o">-</span> <span class="mi">672691027218</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">8</span> <span class="o">-</span> <span class="mi">4985379093428</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">320854419319140</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">817662865724712</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">513191437605441</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">automorphisms</span><span class="p">())</span>
<span class="go">24</span>
</pre></div>
</div>
<p>Number fields defined by non-monic and non-integral
polynomials are supported (<a class="reference external" href="https://trac.sagemath.org/252">trac ticket #252</a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">7</span><span class="o">/</span><span class="mi">9</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">7</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">56</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">123</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">automorphisms</span><span class="p">();</span> <span class="n">A</span>
<span class="go">[</span>
<span class="go">Ring endomorphism of Number Field in a with defining polynomial 7/9*x^3 + 7/3*x^2 - 56*x + 123</span>
<span class="go">  Defn: a |--&gt; a,</span>
<span class="go">Ring endomorphism of Number Field in a with defining polynomial 7/9*x^3 + 7/3*x^2 - 56*x + 123</span>
<span class="go">  Defn: a |--&gt; -7/15*a^2 - 18/5*a + 96/5,</span>
<span class="go">Ring endomorphism of Number Field in a with defining polynomial 7/9*x^3 + 7/3*x^2 - 56*x + 123</span>
<span class="go">  Defn: a |--&gt; 7/15*a^2 + 13/5*a - 111/5</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">prod</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">sigma</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">sigma</span> <span class="ow">in</span> <span class="n">A</span><span class="p">)</span> <span class="o">==</span> <span class="n">f</span><span class="o">.</span><span class="n">monic</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.base_field">
<span class="sig-name descname"><span class="pre">base_field</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.base_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the base field of self, which is always <code class="docutils literal notranslate"><span class="pre">QQ</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">base_field</span><span class="p">()</span>
<span class="go">Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.change_names">
<span class="sig-name descname"><span class="pre">change_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.change_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Return number field isomorphic to self but with the given generator
name.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">names</span></code> - should be exactly one variable name.</p></li>
</ul>
<p>Also, <code class="docutils literal notranslate"><span class="pre">K.structure()</span></code> returns from_K and to_K,
where from_K is an isomorphism from K to self and to_K is an
isomorphism from self to K.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in z with defining polynomial x^2 + 3</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">ww</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">change_names</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">Number Field in ww with defining polynomial x^2 + 3</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">structure</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Isomorphism given by variable name change map:</span>
<span class="go">  From: Number Field in ww with defining polynomial x^2 + 3</span>
<span class="go">  To:   Number Field in z with defining polynomial x^2 + 3</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">structure</span><span class="p">()[</span><span class="mi">0</span><span class="p">](</span><span class="n">ww</span> <span class="o">+</span> <span class="mi">5</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="go">z + 5/3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.elements_of_bounded_height">
<span class="sig-name descname"><span class="pre">elements_of_bounded_height</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.elements_of_bounded_height" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an iterator over the elements of <code class="docutils literal notranslate"><span class="pre">self</span></code> with relative
multiplicative height at most <code class="docutils literal notranslate"><span class="pre">bound</span></code>.</p>
<p>This algorithm computes 2 lists: L containing elements x in <span class="math notranslate nohighlight">\(K\)</span> such that
H_k(x) &lt;= B, and a list L’ containing elements x in <span class="math notranslate nohighlight">\(K\)</span> that, due to
floating point issues,
may be slightly larger then the bound. This can be controlled
by lowering the tolerance.</p>
<p>In current implementation both lists (L,L’) are merged and returned in
form of iterator.</p>
<p>ALGORITHM:</p>
<p>This is an implementation of the revised algorithm (Algorithm 4) in
<a class="reference internal" href="../../../../references/index.html#dk2013" id="id1"><span>[DK2013]</span></a>. Algorithm 5 is used for imaginary quadratic fields.</p>
<p>INPUT:</p>
<p>kwds:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bound</span></code> - a real number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tolerance</span></code> - (default: 0.01) a rational number in (0,1]</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">precision</span></code> - (default: 53) a positive integer</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>an iterator of number field elements</p></li>
</ul>
<p>EXAMPLES:</p>
<p>There are no elements in a number field with multiplicative height less
than 1:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">g</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">19</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">elements_of_bounded_height</span><span class="p">(</span><span class="n">bound</span><span class="o">=</span><span class="mf">0.9</span><span class="p">))</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>The only elements in a number field of height 1 are 0 and the roots of
unity:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">elements_of_bounded_height</span><span class="p">(</span><span class="n">bound</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="go">[0, a + 1, a, -1, -a - 1, -a, 1]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">elements_of_bounded_height</span><span class="p">(</span><span class="n">bound</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span>
<span class="go">21</span>
</pre></div>
</div>
<p>The elements in the output iterator all have relative multiplicative
height at most the input bound:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">elements_of_bounded_height</span><span class="p">(</span><span class="n">bound</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">L</span><span class="p">:</span>
<span class="gp">....: </span>    <span class="n">exp</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">t</span><span class="o">.</span><span class="n">global_height</span><span class="p">())</span>
<span class="gp">....:</span>
<span class="go">1.00000000000000</span>
<span class="go">1.00000000000000</span>
<span class="go">1.00000000000000</span>
<span class="go">2.00000000000000</span>
<span class="go">2.00000000000000</span>
<span class="go">2.00000000000000</span>
<span class="go">2.00000000000000</span>
<span class="go">4.00000000000000</span>
<span class="go">4.00000000000000</span>
<span class="go">4.00000000000000</span>
<span class="go">4.00000000000000</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">71</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">elements_of_bounded_height</span><span class="p">(</span><span class="n">bound</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">.</span><span class="n">global_height</span><span class="p">())</span> <span class="o">&lt;=</span> <span class="mi">20</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">L</span><span class="p">)</span> <span class="c1"># long time (5 s)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">17</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">elements_of_bounded_height</span><span class="p">(</span><span class="n">bound</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">L</span><span class="p">))</span>
<span class="go">9047</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">elements_of_bounded_height</span><span class="p">(</span><span class="n">bound</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">L</span><span class="p">))</span> <span class="c1"># long time (2 s)</span>
<span class="go">2163</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">elements_of_bounded_height</span><span class="p">(</span><span class="n">bound</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">L</span><span class="p">))</span> <span class="c1"># long time (3 s)</span>
<span class="go">27</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">elements_of_bounded_height</span><span class="p">(</span><span class="n">bound</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">L</span><span class="p">))</span> <span class="c1"># long time (5 s)</span>
<span class="go">1899</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">elements_of_bounded_height</span><span class="p">(</span><span class="n">bound</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">L</span><span class="p">))</span>
<span class="go">99</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>John Doyle (2013)</p></li>
<li><p>David Krumm (2013)</p></li>
<li><p>Raman Raghukul (2018)</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.embeddings">
<span class="sig-name descname"><span class="pre">embeddings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">K</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.embeddings" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute all field embeddings of this field into the field K (which need
not even be a number field, e.g., it could be the complex numbers).
This will return an identical result when given K as input again.</p>
<p>If possible, the most natural embedding of this field into K is put first
in the list.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">K</span></code> - a field</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a1</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">galois_closure</span><span class="p">();</span> <span class="n">L</span>
<span class="go">Number Field in a1 with defining polynomial x^6 + 108</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">L</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial x^3 - 2</span>
<span class="go">  To:   Number Field in a1 with defining polynomial x^6 + 108</span>
<span class="go">  Defn: a |--&gt; 1/18*a1^4</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="ow">is</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We embed a quadratic field into a cyclotomic field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial x^2 + 7 with a = 2.645751311064591?*I</span>
<span class="go">  To:   Cyclotomic Field of order 7 and degree 6</span>
<span class="go">  Defn: a |--&gt; 2*zeta7^4 + 2*zeta7^2 + 2*zeta7 + 1,</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial x^2 + 7 with a = 2.645751311064591?*I</span>
<span class="go">  To:   Cyclotomic Field of order 7 and degree 6</span>
<span class="go">  Defn: a |--&gt; -2*zeta7^4 - 2*zeta7^2 - 2*zeta7 - 1</span>
<span class="go">]</span>
</pre></div>
</div>
<p>We embed a cubic field in the complex numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">CC</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial x^3 - 2</span>
<span class="go">  To:   Complex Field with 53 bits of precision</span>
<span class="go">  Defn: a |--&gt; -0.62996052494743... - 1.09112363597172*I,</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial x^3 - 2</span>
<span class="go">  To:   Complex Field with 53 bits of precision</span>
<span class="go">  Defn: a |--&gt; -0.62996052494743... + 1.09112363597172*I,</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial x^3 - 2</span>
<span class="go">  To:   Complex Field with 53 bits of precision</span>
<span class="go">  Defn: a |--&gt; 1.25992104989487</span>
<span class="go">]</span>
</pre></div>
</div>
<p>Test that <a class="reference external" href="https://trac.sagemath.org/15053">trac ticket #15053</a> is fixed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.free_module">
<span class="sig-name descname"><span class="pre">free_module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.free_module" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a vector space V and isomorphisms self –&gt; V and V –&gt; self.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">base</span></code> – a subfield (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); the returned vector
space is over this subfield <span class="math notranslate nohighlight">\(R\)</span>, which defaults to the base field of this
function field</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">basis</span></code> – a basis for this field over the base</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">maps</span></code> – boolean (default <code class="docutils literal notranslate"><span class="pre">True</span></code>), whether to return
<span class="math notranslate nohighlight">\(R\)</span>-linear maps to and from <span class="math notranslate nohighlight">\(V\)</span></p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">V</span></code> - a vector space over the rational numbers</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">from_V</span></code> - an isomorphism from V to self (if requested)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">to_V</span></code> - an isomorphism from self to V (if requested)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span><span class="p">,</span> <span class="n">from_V</span><span class="p">,</span> <span class="n">to_V</span>  <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">from_V</span><span class="p">(</span><span class="n">V</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span>
<span class="go">3*a^2 + 2*a + 1</span>
<span class="gp">sage: </span><span class="n">to_V</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(1, 2, 3)</span>
<span class="gp">sage: </span><span class="n">V</span>
<span class="go">Vector space of dimension 3 over Rational Field</span>
<span class="gp">sage: </span><span class="n">to_V</span>
<span class="go">Isomorphism map:</span>
<span class="go">  From: Number Field in a with defining polynomial x^3 + 2</span>
<span class="go">  To:   Vector space of dimension 3 over Rational Field</span>
<span class="gp">sage: </span><span class="n">from_V</span><span class="p">(</span><span class="n">to_V</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">5</span><span class="o">/</span><span class="mi">8</span><span class="p">))</span>
<span class="go">2/3*a - 5/8</span>
<span class="gp">sage: </span><span class="n">to_V</span><span class="p">(</span><span class="n">from_V</span><span class="p">(</span><span class="n">V</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">7</span><span class="p">,</span><span class="mi">0</span><span class="p">])))</span>
<span class="go">(0, -1/7, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.galois_closure">
<span class="sig-name descname"><span class="pre">galois_closure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.galois_closure" title="Permalink to this definition">¶</a></dt>
<dd><p>Return number field <span class="math notranslate nohighlight">\(K\)</span> that is the Galois closure of self,
i.e., is generated by all roots of the defining polynomial of
self, and possibly an embedding of self into <span class="math notranslate nohighlight">\(K\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">names</span></code> - variable name for Galois closure</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">map</span></code> - (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) also return an embedding of self into <span class="math notranslate nohighlight">\(K\)</span></p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">galois_closure</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">);</span> <span class="n">M</span>
<span class="go">Number Field in b with defining polynomial x^8 + 28*x^4 + 2500</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a2</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">galois_closure</span><span class="p">();</span> <span class="n">L</span>
<span class="go">Number Field in a2 with defining polynomial x^8 + 28*x^4 + 2500</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;a3&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">8</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">L</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>
<span class="go">1/120*a2^5 + 19/60*a2</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>
<span class="go">x^4 - 2</span>

<span class="gp">sage: </span><span class="n">L</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">galois_closure</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="nb">map</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">Number Field in b with defining polynomial x^8 + 28*x^4 + 2500</span>
<span class="gp">sage: </span><span class="n">phi</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial x^4 - 2</span>
<span class="go">  To:   Number Field in b with defining polynomial x^8 + 28*x^4 + 2500</span>
<span class="go">  Defn: a |--&gt; 1/240*b^5 - 41/120*b</span>
</pre></div>
</div>
<p>A cyclotomic field is already Galois:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">cyclotomic_polynomial</span><span class="p">(</span><span class="mi">23</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">galois_closure</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">Number Field in z with defining polynomial x^22 + x^21 + x^20 + x^19 + x^18 + x^17 + x^16 + x^15 + x^14 + x^13 + x^12 + x^11 + x^10 + x^9 + x^8 + x^7 + x^6 + x^5 + x^4 + x^3 + x^2 + x + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.hilbert_conductor">
<span class="sig-name descname"><span class="pre">hilbert_conductor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.hilbert_conductor" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the product of all (finite) primes where the Hilbert symbol is -1.
What is the same, this is the (reduced) discriminant of the quaternion
algebra <span class="math notranslate nohighlight">\((a,b)\)</span> over a number field.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code> – elements of the number field <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>squarefree ideal of the ring of integers of <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">hilbert_conductor</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="n">F</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="go">Fractional ideal (2)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_conductor</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">K</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
<span class="go">Fractional ideal (1)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_conductor</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="p">),</span><span class="n">K</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
<span class="go">Fractional ideal (b^2 + b - 2)</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li><p>Aly Deines</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.hilbert_symbol">
<span class="sig-name descname"><span class="pre">hilbert_symbol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.hilbert_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Hilbert symbol <span class="math notranslate nohighlight">\((a,b)_P\)</span> for a prime P of self
and non-zero elements a and b of self.</p>
<p>If P is omitted, return the global Hilbert symbol <span class="math notranslate nohighlight">\((a,b)\)</span> instead.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code> – elements of self</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">P</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) If <span class="math notranslate nohighlight">\(P\)</span> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, compute the global
symbol.  Otherwise, <span class="math notranslate nohighlight">\(P\)</span> should be either a prime ideal of self
(which may also be given as a generator or set of generators)
or a real or complex embedding.</p></li>
</ul>
<p>OUTPUT:</p>
<p>If a or b is zero, returns 0.</p>
<p>If a and b are non-zero and P is specified, returns
the Hilbert symbol <span class="math notranslate nohighlight">\((a,b)_P\)</span>, which is 1 if the equation
<span class="math notranslate nohighlight">\(a x^2 + b y^2 = 1\)</span> has a solution in the completion of
self at P, and is -1 otherwise.</p>
<p>If a and b are non-zero and P is unspecified, returns 1
if the equation has a solution in self and -1 otherwise.</p>
<p>EXAMPLES:</p>
<p>Some global examples:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>
<span class="go">-1</span>
</pre></div>
</div>
<p>That the latter two are unsolvable should be visible in local
obstructions.  For the first, this is a prime ideal above 19.
For the second, the ramified prime above 23:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="go">-1</span>
</pre></div>
</div>
<p>More local examples:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">K</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">())</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">emb1</span><span class="p">,</span> <span class="n">emb2</span><span class="p">]</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">AA</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">emb1</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">emb2</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Ideals P can be given by generators:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pi</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">15</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">11</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span> <span class="n">pi</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">15</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">11</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span> <span class="n">rho</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>This also works for non-principal ideals:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">gens_reduced</span><span class="p">()</span>  <span class="c1"># random, could be the other factor</span>
<span class="go">(3, a + 1)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Primes above 2:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">O</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">O</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span> <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">==</span> <span class="mi">16</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="go">-1</span>
</pre></div>
</div>
<p>Various real fields are allowed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">a</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">RDF</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">a</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">RR</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">AA</span><span class="p">)]</span>
<span class="go">[-1]</span>
</pre></div>
</div>
<p>Real embeddings are not allowed to be disguised as complex embeddings:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">CC</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Possibly real place (=Ring morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial x^2 - 5 with a = 2.236067977499790?</span>
<span class="go">  To:   Complex Field with 53 bits of precision</span>
<span class="go">  Defn: a |--&gt; -2.23606797749979) given as complex embedding in hilbert_symbol. Is it real or complex?</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">QQbar</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Possibly real place (=Ring morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial x^2 - 5 with a = 2.236067977499790?</span>
<span class="go">  To:   Algebraic Field</span>
<span class="go">  Defn: a |--&gt; -2.236067977499790?) given as complex embedding in hilbert_symbol. Is it real or complex?</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">CDF</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">QQbar</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">1</span>
</pre></div>
</div>
<p>a and b do not have to be integral or coprime:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">O</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">O</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">1</span><span class="o">+</span><span class="n">i</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">p</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Various other examples:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="o">-</span><span class="mi">6912</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="o">-</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">a</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="o">-</span><span class="mi">1105</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">1541</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">795</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2993</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">11853</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">13</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">13</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">50</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="o">-</span><span class="n">a</span><span class="o">+</span><span class="mi">5</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">Q</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="o">-</span><span class="mi">1105</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">1541</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">795</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2993</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">11853</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Check that the bug reported at <a class="reference external" href="https://trac.sagemath.org/16043">trac ticket #16043</a> has been fixed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span> <span class="n">p</span>
<span class="go">Fractional ideal (2, a + 1)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="go">-1</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li><p>Aly Deines (2010-08-19): part of the doctests</p></li>
<li><p>Marco Streng (2010-12-06)</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.hilbert_symbol_negative_at_S">
<span class="sig-name descname"><span class="pre">hilbert_symbol_negative_at_S</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.hilbert_symbol_negative_at_S" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <span class="math notranslate nohighlight">\(a\)</span> such that the hilbert conductor of <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> is <span class="math notranslate nohighlight">\(S\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">S</span></code> – a list of places (or prime ideals) of even cardinality</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code> – a non-zero rational number which is a non-square locally
at every place in S.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> – bool (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) perform additional checks on
the input and confirm the output</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>an element <span class="math notranslate nohighlight">\(a\)</span> that has negative Hilbert symbol <span class="math notranslate nohighlight">\((a,b)_p\)</span> for
every (finite and infinite) place <span class="math notranslate nohighlight">\(p\)</span> in <span class="math notranslate nohighlight">\(S\)</span>.</p></li>
</ul>
<p>ALGORITHM:</p>
<p>The implementation is following algorithm 3.4.1 in <a class="reference internal" href="../../../../references/index.html#kir2016" id="id2"><span>[Kir2016]</span></a>.
We note that class and unit groups are computed using the generalized
Riemann hypothesis. If it is false, this may result in an infinite loop.
Nevertheless, if the algorithm terminates the output is correct.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">20072</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="p">[</span><span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">23</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol_negative_at_S</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">S</span><span class="p">]</span>
<span class="go">[-1, -1]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">d</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="p">[</span><span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">11</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol_negative_at_S</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">S</span><span class="p">]</span>
<span class="go">[-1, -1]</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">c</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">maximal_totally_real_subfield</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">k</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">5</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">+=</span> <span class="n">k</span><span class="o">.</span><span class="n">real_places</span><span class="p">()[:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">+</span> <span class="n">c</span> <span class="o">+</span> <span class="n">c</span><span class="o">^</span><span class="mi">9</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">hilbert_symbol_negative_at_S</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">hilbert_symbol</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">S</span><span class="p">]</span>
<span class="go">[-1, -1, -1, -1]</span>
</pre></div>
</div>
<p>Note that the closely related hilbert conductor
takes only the finite places into account:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">hilbert_conductor</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="go">Fractional ideal (15)</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Simon Brandhorst, Anna Haensch (01-05-2018)</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.is_absolute">
<span class="sig-name descname"><span class="pre">is_absolute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.is_absolute" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> since self is an absolute field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">is_absolute</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.maximal_order">
<span class="sig-name descname"><span class="pre">maximal_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.maximal_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the maximal order, i.e., the ring of integers, associated to
this number field.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code> - (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) <code class="docutils literal notranslate"><span class="pre">None</span></code>, a prime, or a list of primes.</p>
<ul>
<li><p>if <code class="docutils literal notranslate"><span class="pre">v</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, return the maximal order.</p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">v</span></code> is a prime, return an order that is <span class="math notranslate nohighlight">\(p\)</span>-maximal.</p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">v</span></code> is a list, return an order that is maximal at each prime
in the list <code class="docutils literal notranslate"><span class="pre">v</span></code>.</p></li>
</ul>
</li>
</ul>
<p>EXAMPLES:</p>
<p>In this example, the maximal order cannot be generated by a single
element:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">o</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">o</span>
<span class="go">Maximal Order in Number Field in a with defining polynomial x^3 + x^2 - 2*x + 8</span>
</pre></div>
</div>
<p>We compute <span class="math notranslate nohighlight">\(p\)</span>-maximal orders for several <span class="math notranslate nohighlight">\(p\)</span>. Note
that computing a <span class="math notranslate nohighlight">\(p\)</span>-maximal order is much faster in
general than computing the maximal order:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">22</span><span class="p">);</span> <span class="n">q</span> <span class="o">=</span> <span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">([</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">[1/3*a^2 + 1/3*a + 1/3, a, a^2]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">([</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">[1/3*a^2 + 1/3*a + 1/3, a, a^2]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">([</span><span class="n">p</span><span class="p">])</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">[1/3*a^2 + 1/3*a + 1/3, a, a^2]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">([</span><span class="n">q</span><span class="p">])</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">[1/3*a^2 + 1/3*a + 1/3, a, a^2]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">([</span><span class="n">p</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">[1/3*a^2 + 1/3*a + 1/3, a, a^2]</span>
</pre></div>
</div>
<p>An example with bigger discriminant:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">97</span><span class="p">);</span> <span class="n">q</span> <span class="o">=</span> <span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">99</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">(</span><span class="n">prime_range</span><span class="p">(</span><span class="mi">10000</span><span class="p">))</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">[1, a, a^2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.minkowski_embedding">
<span class="sig-name descname"><span class="pre">minkowski_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.minkowski_embedding" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an nxn matrix over RDF whose columns are the images of the
basis <span class="math notranslate nohighlight">\(\{1, \alpha, \dots, \alpha^{n-1}\}\)</span> of self over
<span class="math notranslate nohighlight">\(\QQ\)</span> (as vector spaces), where here
<span class="math notranslate nohighlight">\(\alpha\)</span> is the generator of self over
<span class="math notranslate nohighlight">\(\QQ\)</span>, i.e. self.gen(0). If B is not None, return
the images of the vectors in B as the columns instead. If prec is
not None, use RealField(prec) instead of RDF.</p>
<p>This embedding is the so-called “Minkowski embedding” of a number
field in <span class="math notranslate nohighlight">\(\RR^n\)</span>: given the <span class="math notranslate nohighlight">\(n\)</span> embeddings
<span class="math notranslate nohighlight">\(\sigma_1, \dots, \sigma_n\)</span> of self in
<span class="math notranslate nohighlight">\(\CC\)</span>, write <span class="math notranslate nohighlight">\(\sigma_1, \dots, \sigma_r\)</span>
for the real embeddings, and
<span class="math notranslate nohighlight">\(\sigma_{r+1}, \dots, \sigma_{r+s}\)</span> for choices of one of
each pair of complex conjugate embeddings (in our case, we simply
choose the one where the image of <span class="math notranslate nohighlight">\(\alpha\)</span> has positive
real part). Here <span class="math notranslate nohighlight">\((r,s)\)</span> is the signature of self. Then the
Minkowski embedding is given by</p>
<div class="math notranslate nohighlight">
\[x \mapsto ( \sigma_1(x), \dots,
         \sigma_r(x), \sqrt{2}\Re(\sigma_{r+1}(x)),
         \sqrt{2}\Im(\sigma_{r+1}(x)), \dots,
         \sqrt{2}\Re(\sigma_{r+s}(x)),
         \sqrt{2}\Im(\sigma_{r+s}(x)))\]</div>
<p>Equivalently, this is an embedding of self in <span class="math notranslate nohighlight">\(\RR^n\)</span> so
that the usual norm on <span class="math notranslate nohighlight">\(\RR^n\)</span> coincides with
<span class="math notranslate nohighlight">\(|x| = \sum_i |\sigma_i(x)|^2\)</span> on self.</p>
<div class="admonition-todo admonition" id="id3">
<p class="admonition-title">Todo</p>
<p>This could be much improved by implementing homomorphisms
over VectorSpaces.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">alpha</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">minkowski_embedding</span><span class="p">()</span>
<span class="go">[ 1.00000000000000 -1.25992104989487  1.58740105196820]</span>
<span class="go">[ 1.41421356237... 0.8908987181... -1.12246204830...]</span>
<span class="go">[0.000000000000000  1.54308184421...  1.94416129723...]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">minkowski_embedding</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">alpha</span><span class="p">])</span>
<span class="go">[ 1.00000000000000 0.740078950105127  2.84732210186307]</span>
<span class="go">[ 1.41421356237...  3.7193258428... -2.01336076644...]</span>
<span class="go">[0.000000000000000  1.54308184421... 0.40107945302...]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">minkowski_embedding</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">vector</span><span class="p">()</span><span class="o">.</span><span class="n">column</span><span class="p">()</span>
<span class="go">[0.740078950105127]</span>
<span class="go">[ 3.7193258428...]</span>
<span class="go">[ 1.54308184421...]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.optimized_representation">
<span class="sig-name descname"><span class="pre">optimized_representation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">both_maps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.optimized_representation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a field isomorphic to self with a better defining polynomial
if possible, along with field isomorphisms from the new field to
self and from self to the new field.</p>
<p>EXAMPLES: We construct a compositum of 3 quadratic fields, then
find an optimized representation and transform elements back and
forth.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">absolute_field</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in b with defining polynomial x^8 + 40*x^6 + 352*x^4 + 960*x^2 + 576</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">,</span> <span class="n">from_L</span><span class="p">,</span> <span class="n">to_L</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">optimized_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span>    <span class="c1"># your answer may different, since algorithm is random</span>
<span class="go">Number Field in b1 with defining polynomial x^8 + 4*x^6 + 7*x^4 +</span>
<span class="go">36*x^2 + 81</span>
<span class="gp">sage: </span><span class="n">to_L</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>   <span class="c1"># random</span>
<span class="go">4/189*b1^7 + 1/63*b1^6 + 1/27*b1^5 - 2/9*b1^4 - 5/27*b1^3 - 8/9*b1^2 + 3/7*b1 - 3/7</span>
<span class="gp">sage: </span><span class="n">from_L</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>   <span class="c1"># random</span>
<span class="go">1/1152*b^7 - 1/192*b^6 + 23/576*b^5 - 17/96*b^4 + 37/72*b^3 - 5/6*b^2 + 55/24*b - 3/4</span>
</pre></div>
</div>
<p>The transformation maps are mutually inverse isomorphisms.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">from_L</span><span class="p">(</span><span class="n">to_L</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="mi">0</span><span class="p">))</span> <span class="o">==</span> <span class="n">K</span><span class="o">.</span><span class="mi">0</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">to_L</span><span class="p">(</span><span class="n">from_L</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="mi">0</span><span class="p">))</span> <span class="o">==</span> <span class="n">L</span><span class="o">.</span><span class="mi">0</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Number fields defined by non-monic and non-integral
polynomials are supported (<a class="reference external" href="https://trac.sagemath.org/252">trac ticket #252</a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">9</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">7</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">56</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">123</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">optimized_representation</span><span class="p">()</span>  <span class="c1"># representation varies, not tested</span>
<span class="go">(Number Field in a1 with defining polynomial x^3 - 7*x - 7,</span>
<span class="go"> Ring morphism:</span>
<span class="go">   From: Number Field in a1 with defining polynomial x^3 - 7*x - 7</span>
<span class="go">   To:   Number Field in a with defining polynomial 7/9*x^3 + 7/3*x^2 - 56*x + 123</span>
<span class="go">   Defn: a1 |--&gt; 7/225*a^2 - 7/75*a - 42/25,</span>
<span class="go"> Ring morphism:</span>
<span class="go">   From: Number Field in a with defining polynomial 7/9*x^3 + 7/3*x^2 - 56*x + 123</span>
<span class="go">   To:   Number Field in a1 with defining polynomial x^3 - 7*x - 7</span>
<span class="go">   Defn: a |--&gt; -15/7*a1^2 + 9)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.optimized_subfields">
<span class="sig-name descname"><span class="pre">optimized_subfields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">both_maps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.optimized_subfields" title="Permalink to this definition">¶</a></dt>
<dd><p>Return optimized representations of many (but <em>not</em> necessarily
all!) subfields of self of the given degree, or of all possible degrees if
degree is 0.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">absolute_field</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in b with defining polynomial x^8 + 40*x^6 + 352*x^4 + 960*x^2 + 576</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">optimized_subfields</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Number Field in b0 with defining polynomial x</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Number Field in b1 with defining polynomial x^2 - 3*x + 3</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">L</span><span class="p">]</span>          <span class="c1"># random -- since algorithm is random</span>
<span class="go">[Number Field in b0 with defining polynomial x - 1,</span>
<span class="go"> Number Field in b1 with defining polynomial x^2 - x + 1,</span>
<span class="go"> Number Field in b2 with defining polynomial x^4 - 5*x^2 + 25,</span>
<span class="go"> Number Field in b3 with defining polynomial x^4 - 2*x^2 + 4,</span>
<span class="go"> Number Field in b4 with defining polynomial x^8 + 4*x^6 + 7*x^4 + 36*x^2 + 81]</span>
</pre></div>
</div>
<p>We examine one of the optimized subfields in more detail:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="p">,</span> <span class="n">from_M</span><span class="p">,</span> <span class="n">to_M</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">M</span>                             <span class="c1"># random</span>
<span class="go">Number Field in b2 with defining polynomial x^4 - 5*x^2 + 25</span>
<span class="gp">sage: </span><span class="n">from_M</span>     <span class="c1"># may be slightly random</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Number Field in b2 with defining polynomial x^4 - 5*x^2 + 25</span>
<span class="go">  To:   Number Field in a1 with defining polynomial x^8 + 40*x^6 + 352*x^4 + 960*x^2 + 576</span>
<span class="go">  Defn: b2 |--&gt; -5/1152*a1^7 + 1/96*a1^6 - 97/576*a1^5 + 17/48*a1^4 - 95/72*a1^3 + 17/12*a1^2 - 53/24*a1 - 1</span>
</pre></div>
</div>
<p>The to_M map is None, since there is no map from K to M:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">to_M</span>
</pre></div>
</div>
<p>We apply the from_M map to the generator of M, which gives a
rather large element of <span class="math notranslate nohighlight">\(K\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">from_M</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>          <span class="c1"># random</span>
<span class="go">-5/1152*a1^7 + 1/96*a1^6 - 97/576*a1^5 + 17/48*a1^4 - 95/72*a1^3 + 17/12*a1^2 - 53/24*a1 - 1</span>
</pre></div>
</div>
<p>Nevertheless, that large-ish element lies in a degree 4 subfield:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">from_M</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>   <span class="c1"># random</span>
<span class="go">x^4 - 5*x^2 + 25</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.order">
<span class="sig-name descname"><span class="pre">order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the order with given ring generators in the maximal order of
this number field.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gens</span></code> - list of elements in this number field; if no generators
are given, just returns the cardinality of this number field
(<span class="math notranslate nohighlight">\(\infty\)</span>) for consistency.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check_is_integral</span></code> - bool (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>), whether to check
that each generator is integral.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check_rank</span></code> - bool (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>), whether to check that the
ring generated by <code class="docutils literal notranslate"><span class="pre">gens</span></code> is of full rank.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">allow_subfield</span></code> - bool (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>), if <code class="docutils literal notranslate"><span class="pre">True</span></code> and the
generators do not generate an order, i.e., they generate a subring
of smaller rank, instead of raising an error, return an order in a
smaller number field.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">order</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<span class="go">Order in Number Field in i with defining polynomial x^2 + 1</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">order</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
<span class="go">Order in Number Field in i with defining polynomial x^2 + 1</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">order</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: the rank of the span of gens is wrong</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">order</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: each generator must be integral</span>
</pre></div>
</div>
<p>Alternatively, an order can be constructed by adjoining elements to
<span class="math notranslate nohighlight">\(\ZZ\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ZZ</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
<span class="go">Order in Number Field in a0 with defining polynomial x^3 - 2 with a0 = a</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.places">
<span class="sig-name descname"><span class="pre">places</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_complex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.places" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the collection of all infinite places of self.</p>
<p>By default, this returns the set of real places as
homomorphisms into RIF first, followed by a choice of one of
each pair of complex conjugate homomorphisms into CIF.</p>
<p>On the other hand, if prec is not None, we simply return places
into RealField(prec) and ComplexField(prec) (or RDF, CDF if
prec=53). One can also use <code class="docutils literal notranslate"><span class="pre">prec=infinity</span></code>, which returns embeddings
into the field <span class="math notranslate nohighlight">\(\overline{\QQ}\)</span> of algebraic numbers (or its subfield
<span class="math notranslate nohighlight">\(\mathbb{A}\)</span> of algebraic reals); this permits exact computation, but
can be extremely slow.</p>
<p>There is an optional flag all_complex, which defaults to False. If
all_complex is True, then the real embeddings are returned as
embeddings into CIF instead of RIF.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">alpha</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">100</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">;</span> <span class="n">F</span><span class="o">.</span><span class="n">places</span><span class="p">()</span>
<span class="go">[Ring morphism:</span>
<span class="go">From: Number Field in alpha with defining polynomial x^3 - 100*x + 1</span>
<span class="go">To:   Real Field with 106 bits of precision</span>
<span class="go">Defn: alpha |--&gt; -10.00499625499181184573367219280,</span>
<span class="go">Ring morphism:</span>
<span class="go">From: Number Field in alpha with defining polynomial x^3 - 100*x + 1</span>
<span class="go">To:   Real Field with 106 bits of precision</span>
<span class="go">Defn: alpha |--&gt; 0.01000001000003000012000055000273,</span>
<span class="go">Ring morphism:</span>
<span class="go">From: Number Field in alpha with defining polynomial x^3 - 100*x + 1</span>
<span class="go">To:   Real Field with 106 bits of precision</span>
<span class="go">Defn: alpha |--&gt; 9.994996244991781845613530439509]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">alpha</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">7</span><span class="p">)</span> <span class="p">;</span> <span class="n">F</span><span class="o">.</span><span class="n">places</span><span class="p">()</span>
<span class="go">[Ring morphism:</span>
<span class="go">From: Number Field in alpha with defining polynomial x^3 + 7</span>
<span class="go">To:   Real Field with 106 bits of precision</span>
<span class="go">Defn: alpha |--&gt; -1.912931182772389101199116839549,</span>
<span class="go">Ring morphism:</span>
<span class="go">From: Number Field in alpha with defining polynomial x^3 + 7</span>
<span class="go">To:   Complex Field with 53 bits of precision</span>
<span class="go">Defn: alpha |--&gt; 0.956465591386195 + 1.65664699997230*I]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">alpha</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">7</span><span class="p">)</span> <span class="p">;</span> <span class="n">F</span><span class="o">.</span><span class="n">places</span><span class="p">(</span><span class="n">all_complex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[Ring morphism:</span>
<span class="go">From: Number Field in alpha with defining polynomial x^3 + 7</span>
<span class="go">To:   Complex Field with 53 bits of precision</span>
<span class="go">Defn: alpha |--&gt; -1.91293118277239,</span>
<span class="go">Ring morphism:</span>
<span class="go">From: Number Field in alpha with defining polynomial x^3 + 7</span>
<span class="go">To:   Complex Field with 53 bits of precision</span>
<span class="go">Defn: alpha |--&gt; 0.956465591386195 + 1.65664699997230*I]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">places</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[Ring morphism:</span>
<span class="go">From: Number Field in alpha with defining polynomial x^3 + 7</span>
<span class="go">To:   Real Field with 10 bits of precision</span>
<span class="go">Defn: alpha |--&gt; -1.9,</span>
<span class="go">Ring morphism:</span>
<span class="go">From: Number Field in alpha with defining polynomial x^3 + 7</span>
<span class="go">To:   Complex Field with 10 bits of precision</span>
<span class="go">Defn: alpha |--&gt; 0.96 + 1.7*I]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.real_places">
<span class="sig-name descname"><span class="pre">real_places</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.real_places" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all real places of self as homomorphisms into RIF.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">alpha</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span> <span class="p">;</span> <span class="n">F</span><span class="o">.</span><span class="n">real_places</span><span class="p">()</span>
<span class="go">[Ring morphism:</span>
<span class="go">From: Number Field in alpha with defining polynomial x^4 - 7</span>
<span class="go">To:   Real Field with 106 bits of precision</span>
<span class="go">Defn: alpha |--&gt; -1.626576561697785743211232345494,</span>
<span class="go">Ring morphism:</span>
<span class="go">From: Number Field in alpha with defining polynomial x^4 - 7</span>
<span class="go">To:   Real Field with 106 bits of precision</span>
<span class="go">Defn: alpha |--&gt; 1.626576561697785743211232345494]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.relative_degree">
<span class="sig-name descname"><span class="pre">relative_degree</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.relative_degree" title="Permalink to this definition">¶</a></dt>
<dd><p>A synonym for degree.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">relative_degree</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.relative_different">
<span class="sig-name descname"><span class="pre">relative_different</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.relative_different" title="Permalink to this definition">¶</a></dt>
<dd><p>A synonym for different.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">relative_different</span><span class="p">()</span>
<span class="go">Fractional ideal (2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.relative_discriminant">
<span class="sig-name descname"><span class="pre">relative_discriminant</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.relative_discriminant" title="Permalink to this definition">¶</a></dt>
<dd><p>A synonym for discriminant.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">relative_discriminant</span><span class="p">()</span>
<span class="go">-4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.relative_polynomial">
<span class="sig-name descname"><span class="pre">relative_polynomial</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.relative_polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>A synonym for polynomial.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">relative_polynomial</span><span class="p">()</span>
<span class="go">x^2 + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.relative_vector_space">
<span class="sig-name descname"><span class="pre">relative_vector_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.relative_vector_space" title="Permalink to this definition">¶</a></dt>
<dd><p>A synonym for vector_space.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">relative_vector_space</span><span class="p">()</span>
<span class="go">(Vector space of dimension 2 over Rational Field,</span>
<span class="go"> Isomorphism map:</span>
<span class="go">  From: Vector space of dimension 2 over Rational Field</span>
<span class="go">  To:   Number Field in i with defining polynomial x^2 + 1,</span>
<span class="go"> Isomorphism map:</span>
<span class="go">  From: Number Field in i with defining polynomial x^2 + 1</span>
<span class="go">  To:   Vector space of dimension 2 over Rational Field)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.relativize">
<span class="sig-name descname"><span class="pre">relativize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.relativize" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an element in self or an embedding of a subfield into self,
return a relative number field <span class="math notranslate nohighlight">\(K\)</span> isomorphic to self that is relative
over the absolute field <span class="math notranslate nohighlight">\(\QQ(\alpha)\)</span> or the domain of <span class="math notranslate nohighlight">\(alpha\)</span>, along
with isomorphisms from <span class="math notranslate nohighlight">\(K\)</span> to self and from self to <span class="math notranslate nohighlight">\(K\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alpha</span></code> - an element of self  or an embedding of a subfield into
self</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">names</span></code> - 2-tuple of names of generator for output field K and the
subfield QQ(alpha) names[0] generators K and names[1] QQ(alpha).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">structure</span></code> – an instance of
<code class="xref py py-class docutils literal notranslate"><span class="pre">structure.NumberFieldStructure</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default:
<code class="docutils literal notranslate"><span class="pre">None</span></code>), if <code class="docutils literal notranslate"><span class="pre">None</span></code>, then the resulting field’s <code class="xref py py-meth docutils literal notranslate"><span class="pre">structure()</span></code>
will return isomorphisms from and to this field. Otherwise, the field
will be equipped with <code class="docutils literal notranslate"><span class="pre">structure</span></code>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>K – relative number field</p>
<p>Also, <code class="docutils literal notranslate"><span class="pre">K.structure()</span></code> returns from_K and to_K, where
from_K is an isomorphism from K to self and to_K is an isomorphism
from self to K.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">10</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">relativize</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span> <span class="n">L</span>
<span class="go">Number Field in c with defining polynomial x^2 - 1/5*d^4 + 8/5*d^3 - 23/5*d^2 + 7*d - 18/5 over its base field</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">absolute_minpoly</span><span class="p">()</span>
<span class="go">x^10 - 2</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">absolute_minpoly</span><span class="p">()</span>
<span class="go">x^5 - 10*x^4 + 40*x^3 - 90*x^2 + 110*x - 58</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>
<span class="go">x^5 - 10*x^4 + 40*x^3 - 90*x^2 + 110*x - 58</span>
<span class="gp">sage: </span><span class="n">from_L</span><span class="p">,</span> <span class="n">to_L</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">structure</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">to_L</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">c</span>
<span class="gp">sage: </span><span class="n">to_L</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">d</span>
<span class="gp">sage: </span><span class="n">from_L</span><span class="p">(</span><span class="n">to_L</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">a^4 + a^2 + 2</span>
</pre></div>
</div>
<p>The following demonstrates distinct embeddings of a subfield into a
larger field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K0</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">subfields</span><span class="p">(</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span> <span class="n">K0</span>
<span class="go">Number Field in a0 with defining polynomial x^2 - 2*x + 2</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="p">,</span> <span class="n">tau</span> <span class="o">=</span> <span class="n">K0</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L0</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">relativize</span><span class="p">(</span><span class="n">rho</span><span class="p">(</span><span class="n">K0</span><span class="o">.</span><span class="n">gen</span><span class="p">()),</span> <span class="s1">&#39;b&#39;</span><span class="p">);</span> <span class="n">L0</span>
<span class="go">Number Field in b0 with defining polynomial x^2 - b1 + 2 over its base field</span>
<span class="gp">sage: </span><span class="n">L1</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">relativize</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">);</span> <span class="n">L1</span>
<span class="go">Number Field in b with defining polynomial x^2 - a0 + 2 over its base field</span>
<span class="gp">sage: </span><span class="n">L2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">relativize</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">);</span> <span class="n">L2</span>
<span class="go">Number Field in b with defining polynomial x^2 + a0 over its base field</span>
<span class="gp">sage: </span><span class="n">L0</span><span class="o">.</span><span class="n">base_field</span><span class="p">()</span> <span class="ow">is</span> <span class="n">K0</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">L1</span><span class="o">.</span><span class="n">base_field</span><span class="p">()</span> <span class="ow">is</span> <span class="n">K0</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">L2</span><span class="o">.</span><span class="n">base_field</span><span class="p">()</span> <span class="ow">is</span> <span class="n">K0</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Here we see that with the different embeddings, the relative norms are
different:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a0</span> <span class="o">=</span> <span class="n">K0</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L1_into_K</span><span class="p">,</span> <span class="n">K_into_L1</span> <span class="o">=</span> <span class="n">L1</span><span class="o">.</span><span class="n">structure</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L2_into_K</span><span class="p">,</span> <span class="n">K_into_L2</span> <span class="o">=</span> <span class="n">L2</span><span class="o">.</span><span class="n">structure</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">41</span><span class="p">))</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">w1</span> <span class="o">=</span> <span class="o">-</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="n">P</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">w1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Pp</span> <span class="o">=</span> <span class="n">L1</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">K_into_L1</span><span class="p">(</span><span class="n">w1</span><span class="p">))</span><span class="o">.</span><span class="n">ideal_below</span><span class="p">();</span> <span class="n">Pp</span> <span class="o">==</span> <span class="n">K0</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="mi">4</span><span class="o">*</span><span class="n">a0</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Pp</span> <span class="o">==</span> <span class="n">w1</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">w2</span> <span class="o">=</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="n">w2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Qq</span> <span class="o">=</span> <span class="n">L2</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">K_into_L2</span><span class="p">(</span><span class="n">w2</span><span class="p">))</span><span class="o">.</span><span class="n">ideal_below</span><span class="p">();</span> <span class="n">Qq</span> <span class="o">==</span> <span class="n">K0</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">a0</span> <span class="o">+</span> <span class="mi">9</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Qq</span> <span class="o">==</span> <span class="n">w2</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">Pp</span> <span class="o">==</span> <span class="n">Qq</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute.subfields">
<span class="sig-name descname"><span class="pre">subfields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute.subfields" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all subfields of self of the given degree,
or of all possible degrees if degree is 0.  The subfields are returned as
absolute fields together with an embedding into self.  For the case of the
field itself, the reverse isomorphism is also provided.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span> <span class="p">[</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">absolute_field</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">subfields</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">polynomial</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">S</span><span class="p">]</span>
<span class="go">[x - 3,</span>
<span class="go"> x^2 - 3*x + 9,</span>
<span class="go"> x^3 - 3*x^2 + 3*x + 1,</span>
<span class="go"> x^3 - 3*x^2 + 3*x + 1,</span>
<span class="go"> x^3 - 3*x^2 + 3*x - 17,</span>
<span class="go"> x^6 - 3*x^5 + 6*x^4 - 11*x^3 + 12*x^2 + 3*x + 1]</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">L</span><span class="o">.</span><span class="n">subfields</span><span class="p">()]</span>
<span class="go">[Ring morphism:</span>
<span class="go">  From: Number Field in c0 with defining polynomial t</span>
<span class="go">  To:   Number Field in c with defining polynomial t^3 - 3*t + 1</span>
<span class="go">  Defn: 0 |--&gt; 0,</span>
<span class="go"> Ring morphism:</span>
<span class="go">  From: Number Field in c1 with defining polynomial t^3 - 3*t + 1</span>
<span class="go">  To:   Number Field in c with defining polynomial t^3 - 3*t + 1</span>
<span class="go">  Defn: c1 |--&gt; c]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">subfields</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">subfields</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_absolute_v1">
<span class="sig-prename descclassname"><span class="pre">sage.rings.number_field.number_field.</span></span><span class="sig-name descname"><span class="pre">NumberField_absolute_v1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">poly</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latex_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">canonical_embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_absolute_v1" title="Permalink to this definition">¶</a></dt>
<dd><p>Used for unpickling old pickles.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.number_field.number_field</span> <span class="kn">import</span> <span class="n">NumberField_absolute_v1</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">NumberField_absolute_v1</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">)</span>
<span class="go">Number Field in i with defining polynomial x^2 + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_cyclotomic">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sage.rings.number_field.number_field.</span></span><span class="sig-name descname"><span class="pre">NumberField_cyclotomic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assume_disc_small</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maximize_at_primes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_cyclotomic" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.rings.number_field.number_field.NumberField_absolute" title="sage.rings.number_field.number_field.NumberField_absolute"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.rings.number_field.number_field.NumberField_absolute</span></code></a></p>
<p>Create a cyclotomic extension of the rational field.</p>
<p>The command CyclotomicField(n) creates the n-th cyclotomic field,
obtained by adjoining an n-th root of unity to the rational field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Cyclotomic Field of order 3 and degree 2</span>
<span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<span class="go">Cyclotomic Field of order 18 and degree 6</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">gen</span><span class="p">();</span> <span class="n">z</span>
<span class="go">zeta6</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">^</span><span class="mi">3</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">z</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span>
<span class="go">6*zeta6 - 3</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">197</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">dumps</span><span class="p">())</span> <span class="o">==</span> <span class="n">K</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">((</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">dumps</span><span class="p">())</span> <span class="o">==</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cf12</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span> <span class="mi">12</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">z12</span> <span class="o">=</span> <span class="n">cf12</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">cf6</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span> <span class="mi">6</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">z6</span> <span class="o">=</span> <span class="n">cf6</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">FF</span> <span class="o">=</span> <span class="n">Frac</span><span class="p">(</span> <span class="n">cf12</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">FF</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">z6</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">/</span><span class="p">(</span><span class="n">z6</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span>
<span class="go">zeta12^2*x^3/(x + zeta12^2)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cf6</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">;</span> <span class="n">z6</span> <span class="o">=</span> <span class="n">cf6</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cf3</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">;</span> <span class="n">z3</span> <span class="o">=</span> <span class="n">cf3</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cf3</span><span class="p">(</span><span class="n">z6</span><span class="p">)</span>
<span class="go">zeta3 + 1</span>
<span class="gp">sage: </span><span class="n">cf6</span><span class="p">(</span><span class="n">z3</span><span class="p">)</span>
<span class="go">zeta6 - 1</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">cf6</span><span class="p">(</span><span class="n">z3</span><span class="p">))</span>
<span class="go">&lt;type &#39;sage.rings.number_field.number_field_element_quadratic.NumberFieldElement_quadratic&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">cf1</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">;</span> <span class="n">z1</span> <span class="o">=</span> <span class="n">cf1</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">cf3</span><span class="p">(</span><span class="n">z1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">cf3</span><span class="p">(</span><span class="n">z1</span><span class="p">))</span>
<span class="go">&lt;type &#39;sage.rings.number_field.number_field_element_quadratic.NumberFieldElement_quadratic&#39;&gt;</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_cyclotomic.complex_embedding">
<span class="sig-name descname"><span class="pre">complex_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">53</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_cyclotomic.complex_embedding" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the embedding of this cyclotomic field into the approximate
complex field with precision prec obtained by sending the generator
<span class="math notranslate nohighlight">\(\zeta\)</span> of self to exp(2*pi*i/n), where <span class="math notranslate nohighlight">\(n\)</span> is
the multiplicative order of <span class="math notranslate nohighlight">\(\zeta\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">complex_embedding</span><span class="p">()</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Cyclotomic Field of order 4 and degree 2</span>
<span class="go">  To:   Complex Field with 53 bits of precision</span>
<span class="go">  Defn: zeta4 |--&gt; 6.12323399573677e-17 + 1.00000000000000*I</span>
</pre></div>
</div>
<p>Note in the example above that the way zeta is computed (using sin
and cosine in MPFR) means that only the prec bits of the number
after the decimal point are valid.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">complex_embedding</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>
<span class="go">-0.50 + 0.87*I</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="mi">0</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1.0</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="mi">0</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">0.00</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="mi">0</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">7</span><span class="p">)</span>
<span class="go">8.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_cyclotomic.complex_embeddings">
<span class="sig-name descname"><span class="pre">complex_embeddings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">53</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_cyclotomic.complex_embeddings" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all embeddings of this cyclotomic field into the approximate
complex field with precision prec.</p>
<p>If you want 53-bit double precision, which is faster but less
reliable, then do <code class="docutils literal notranslate"><span class="pre">self.embeddings(CDF)</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">complex_embeddings</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Cyclotomic Field of order 5 and degree 4</span>
<span class="go">  To:   Complex Field with 53 bits of precision</span>
<span class="go">  Defn: zeta5 |--&gt; 0.309016994374947 + 0.951056516295154*I,</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Cyclotomic Field of order 5 and degree 4</span>
<span class="go">  To:   Complex Field with 53 bits of precision</span>
<span class="go">  Defn: zeta5 |--&gt; -0.809016994374947 + 0.587785252292473*I,</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Cyclotomic Field of order 5 and degree 4</span>
<span class="go">  To:   Complex Field with 53 bits of precision</span>
<span class="go">  Defn: zeta5 |--&gt; -0.809016994374947 - 0.587785252292473*I,</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Cyclotomic Field of order 5 and degree 4</span>
<span class="go">  To:   Complex Field with 53 bits of precision</span>
<span class="go">  Defn: zeta5 |--&gt; 0.309016994374947 - 0.951056516295154*I</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_cyclotomic.construction">
<span class="sig-name descname"><span class="pre">construction</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_cyclotomic.construction" title="Permalink to this definition">¶</a></dt>
<dd><p>Return data defining a functorial construction of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">construction</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">R</span>
<span class="go">Rational Field</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">polys</span>
<span class="go">[x^4 + x^3 + x^2 + x + 1]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">names</span>
<span class="go">[&#39;zeta5&#39;]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">embeddings</span>
<span class="go">[0.309016994374948? + 0.951056516295154?*I]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">structures</span>
<span class="go">[None]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_cyclotomic.different">
<span class="sig-name descname"><span class="pre">different</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_cyclotomic.different" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the different ideal of the cyclotomic field self.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C20</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C20</span><span class="o">.</span><span class="n">different</span><span class="p">()</span>
<span class="go">Fractional ideal (10, 2*zeta20^6 - 4*zeta20^4 - 4*zeta20^2 + 2)</span>
<span class="gp">sage: </span><span class="n">C18</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">C18</span><span class="o">.</span><span class="n">different</span><span class="p">()</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">==</span> <span class="n">C18</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_cyclotomic.discriminant">
<span class="sig-name descname"><span class="pre">discriminant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_cyclotomic.discriminant" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the discriminant of the ring of integers of the cyclotomic
field self, or if v is specified, the determinant of the trace
pairing on the elements of the list v.</p>
<p>Uses the formula for the discriminant of a prime power cyclotomic
field and Hilbert Theorem 88 on the discriminant of composita.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">v</span> <span class="pre">(optional)</span></code> - list of element of this number
field</p></li>
</ul>
<p>OUTPUT: Integer if v is omitted, and Rational otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">4000000</span>
<span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">-19683</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_cyclotomic.embeddings">
<span class="sig-name descname"><span class="pre">embeddings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">K</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_cyclotomic.embeddings" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute all field embeddings of this field into the field <code class="docutils literal notranslate"><span class="pre">K</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">K</span></code> – a field</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">ComplexField</span><span class="p">(</span><span class="mi">53</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Cyclotomic Field of order 5 and degree 4</span>
<span class="go">  To:   Complex Field with 53 bits of precision</span>
<span class="go">  Defn: zeta5 |--&gt; -0.809016994374947 + 0.587785252292473*I</span>
<span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">Qp</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">print_mode</span><span class="o">=</span><span class="s1">&#39;digits&#39;</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Cyclotomic Field of order 5 and degree 4</span>
<span class="go">  To:   11-adic Field with capped relative precision 4</span>
<span class="go">  Defn: zeta5 |--&gt; ...1525</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_cyclotomic.is_abelian">
<span class="sig-name descname"><span class="pre">is_abelian</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_cyclotomic.is_abelian" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True since all cyclotomic fields are automatically abelian.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span><span class="o">.</span><span class="n">is_abelian</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_cyclotomic.is_galois">
<span class="sig-name descname"><span class="pre">is_galois</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_cyclotomic.is_galois" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True since all cyclotomic fields are automatically Galois.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span><span class="o">.</span><span class="n">is_galois</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_cyclotomic.is_isomorphic">
<span class="sig-name descname"><span class="pre">is_isomorphic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_cyclotomic.is_isomorphic" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if the cyclotomic field self is isomorphic as a number
field to other.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">22</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">23</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Check <a class="reference external" href="https://trac.sagemath.org/14300">trac ticket #14300</a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_cyclotomic.next_split_prime">
<span class="sig-name descname"><span class="pre">next_split_prime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_cyclotomic.next_split_prime" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the next prime integer <span class="math notranslate nohighlight">\(p\)</span> that splits completely in
this cyclotomic field (and does not ramify).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">next_split_prime</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">13</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_cyclotomic.number_of_roots_of_unity">
<span class="sig-name descname"><span class="pre">number_of_roots_of_unity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_cyclotomic.number_of_roots_of_unity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return number of roots of unity in this cyclotomic field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">number_of_roots_of_unity</span><span class="p">()</span>
<span class="go">42</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_cyclotomic.real_embeddings">
<span class="sig-name descname"><span class="pre">real_embeddings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">53</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_cyclotomic.real_embeddings" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all embeddings of this cyclotomic field into the approximate
real field with precision prec.</p>
<p>Mostly, of course, there are no such embeddings.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">real_embeddings</span><span class="p">())</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">real_embeddings</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Cyclotomic Field of order 2 and degree 1</span>
<span class="go">  To:   Real Field with 53 bits of precision</span>
<span class="go">  Defn: -1 |--&gt; -1.00000000000000</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_cyclotomic.roots_of_unity">
<span class="sig-name descname"><span class="pre">roots_of_unity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_cyclotomic.roots_of_unity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all the roots of unity in this cyclotomic field, primitive
or not.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">zs</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">roots_of_unity</span><span class="p">();</span> <span class="n">zs</span>
<span class="go">[1, a, -a - 1, -1, -a, a + 1]</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="n">z</span><span class="o">**</span><span class="n">K</span><span class="o">.</span><span class="n">number_of_roots_of_unity</span><span class="p">()</span> <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">zs</span> <span class="p">]</span>
<span class="go">[1, 1, 1, 1, 1, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_cyclotomic.signature">
<span class="sig-name descname"><span class="pre">signature</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_cyclotomic.signature" title="Permalink to this definition">¶</a></dt>
<dd><p>Return (r1, r2), where r1 and r2 are the number of real embeddings
and pairs of complex embeddings of this cyclotomic field,
respectively.</p>
<p>Trivial since, apart from QQ, cyclotomic fields are totally
complex.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">signature</span><span class="p">()</span>
<span class="go">(0, 2)</span>
<span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">signature</span><span class="p">()</span>
<span class="go">(1, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_cyclotomic.zeta">
<span class="sig-name descname"><span class="pre">zeta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_cyclotomic.zeta" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an element of multiplicative order <span class="math notranslate nohighlight">\(n\)</span> in this
cyclotomic field.</p>
<p>If there is no such element, raise a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – integer (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>, returns element of
maximal order)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">all</span></code> – bool (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) - whether to return
a list of all primitive <span class="math notranslate nohighlight">\(n\)</span>-th roots of unity.</p></li>
</ul>
<p>OUTPUT: root of unity or list</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">zeta</span><span class="p">()</span>
<span class="go">zeta4</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">zeta</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">zeta</span><span class="p">()</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">zeta</span><span class="p">()</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">()</span>
<span class="go">42</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">zeta</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">()</span>
<span class="go">21</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">zeta</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">()</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">zeta</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">zeta</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: 84 does not divide order of generator (42)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zeta</span><span class="p">(</span><span class="nb">all</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[-a^4, -a^5, a^5 + a^4 + a^3 + a^2 + a + 1, -a, -a^2, -a^3]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zeta</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="nb">all</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[-a^4, -a^5, a^5 + a^4 + a^3 + a^2 + a + 1, -a, -a^2, -a^3]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zeta</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">all</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[-1]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zeta</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="nb">all</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: 20 does not divide order of generator (10)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zeta</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: 4 does not divide order of generator (10)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">zeta</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="nb">all</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">v</span>
<span class="go">[a, a^2, a^3, -a^3 - a^2 - a - 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">b</span><span class="o">^</span><span class="mi">5</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">v</span><span class="p">]</span>
<span class="go">[1, 1, 1, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_cyclotomic.zeta_order">
<span class="sig-name descname"><span class="pre">zeta_order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_cyclotomic.zeta_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the order of the maximal root of unity contained in this
cyclotomic field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">zeta_order</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">zeta_order</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">zeta_order</span><span class="p">()</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">_n</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">389</span><span class="p">)</span><span class="o">.</span><span class="n">zeta_order</span><span class="p">()</span>
<span class="go">778</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_cyclotomic_v1">
<span class="sig-prename descclassname"><span class="pre">sage.rings.number_field.number_field.</span></span><span class="sig-name descname"><span class="pre">NumberField_cyclotomic_v1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zeta_order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">canonical_embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_cyclotomic_v1" title="Permalink to this definition">¶</a></dt>
<dd><p>Used for unpickling old pickles.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.number_field.number_field</span> <span class="kn">import</span> <span class="n">NumberField_cyclotomic_v1</span>
<span class="gp">sage: </span><span class="n">NumberField_cyclotomic_v1</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">Cyclotomic Field of order 5 and degree 4</span>
<span class="gp">sage: </span><span class="n">NumberField_cyclotomic_v1</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">variable_name</span><span class="p">()</span>
<span class="go">&#39;a&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sage.rings.number_field.number_field.</span></span><span class="sig-name descname"><span class="pre">NumberField_generic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">polynomial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latex_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">category</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assume_disc_small</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maximize_at_primes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../misc/sage/misc/fast_methods.html#sage.misc.fast_methods.WithEqualityById" title="(in Sage 9.4 Reference Manual: Utilities v9.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.misc.fast_methods.WithEqualityById</span></code></a>, <a class="reference internal" href="number_field_base.html#sage.rings.number_field.number_field_base.NumberField" title="sage.rings.number_field.number_field_base.NumberField"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.rings.number_field.number_field_base.NumberField</span></code></a></p>
<p>Generic class for number fields defined by an irreducible
polynomial over <span class="math notranslate nohighlight">\(\QQ\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in a with defining polynomial x^3 - 2</span>
<span class="gp">sage: </span><span class="n">TestSuite</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.S_class_group">
<span class="sig-name descname"><span class="pre">S_class_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'c'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.S_class_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the S-class group of this number field over its base field.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">S</span></code> - a set of primes of the base field</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> - if False, assume the GRH in computing the class group.
Default is True. Call <code class="docutils literal notranslate"><span class="pre">number_field_proof</span></code> to change this
default globally.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">names</span></code> - names of the generators of this class group.</p></li>
</ul>
<p>OUTPUT:</p>
<p>The S-class group of this number field.</p>
<p>EXAMPLES:</p>
<p>A well known example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">S_class_group</span><span class="p">([])</span>
<span class="go">S-class group of order 2 with structure C2 of Number Field in a with defining polynomial x^2 + 5 with a = 2.236067977499790?*I</span>
</pre></div>
</div>
<p>When we include the prime <span class="math notranslate nohighlight">\((2, a+1)\)</span>, the S-class group becomes
trivial:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">S_class_group</span><span class="p">([</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>
<span class="go">S-class group of order 1 of Number Field in a with defining polynomial x^2 + 5 with a = 2.236067977499790?*I</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.S_unit_group">
<span class="sig-name descname"><span class="pre">S_unit_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.S_unit_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the S-unit group (including torsion) of this number field.</p>
<p>ALGORITHM: Uses PARI’s <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/bnfsunit">pari:bnfsunit</a> command.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> (bool, default True) flag passed to <code class="docutils literal notranslate"><span class="pre">pari</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">S</span></code> - list or tuple of prime ideals, or an ideal, or a single
ideal or element from which an ideal can be constructed, in
which case the support is used.  If None, the global unit
group is constructed; otherwise, the S-unit group is
constructed.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The group is cached.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">20</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">15</span><span class="o">*</span><span class="mi">5</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">11</span><span class="o">*</span><span class="mi">5</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">U</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">S_unit_group</span><span class="p">(</span><span class="n">S</span><span class="o">=</span><span class="n">a</span><span class="p">);</span> <span class="n">U</span>
<span class="go">S-unit group with structure C10 x Z x Z x Z of Number Field in a with defining polynomial x^4 - 10*x^3 + 100*x^2 - 375*x + 1375 with S = (Fractional ideal (5, 1/275*a^3 + 4/55*a^2 - 5/11*a + 5), Fractional ideal (11, 1/275*a^3 + 4/55*a^2 - 5/11*a + 9))</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(u0, u1, u2, u3)</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">.</span><span class="n">gens_values</span><span class="p">()</span>  <span class="c1"># random</span>
<span class="go">[-1/275*a^3 + 7/55*a^2 - 6/11*a + 4, 1/275*a^3 + 4/55*a^2 - 5/11*a + 3, 1/275*a^3 + 4/55*a^2 - 5/11*a + 5, -14/275*a^3 + 21/55*a^2 - 29/11*a + 6]</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">.</span><span class="n">invariants</span><span class="p">()</span>
<span class="go">(10, 0, 0, 0)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">u</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">()</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">U</span><span class="o">.</span><span class="n">gens</span><span class="p">()]</span>
<span class="go">[10, +Infinity, +Infinity, +Infinity]</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">.</span><span class="n">primes</span><span class="p">()</span>
<span class="go">(Fractional ideal (5, 1/275*a^3 + 4/55*a^2 - 5/11*a + 5), Fractional ideal (11, 1/275*a^3 + 4/55*a^2 - 5/11*a + 9))</span>
</pre></div>
</div>
<p>With the default value of <span class="math notranslate nohighlight">\(S\)</span>, the S-unit group is the same as
the global unit group:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">U</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">unit_group</span><span class="p">(</span><span class="n">proof</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">S_unit_group</span><span class="p">(</span><span class="n">proof</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The value of <span class="math notranslate nohighlight">\(S\)</span> may be specified as a list of prime ideals,
or an ideal, or an element of the field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">U</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">S_unit_group</span><span class="p">(</span><span class="n">proof</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">S</span><span class="o">=</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">prime_factors</span><span class="p">());</span> <span class="n">U</span>
<span class="go">S-unit group with structure C2 x Z x Z x Z x Z of Number Field in a with defining polynomial x^3 + 3 with S = (Fractional ideal (-a^2 + a - 1), Fractional ideal (a + 1), Fractional ideal (a))</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">U</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">S_unit_group</span><span class="p">(</span><span class="n">proof</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">S</span><span class="o">=</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">6</span><span class="p">));</span> <span class="n">U</span>
<span class="go">S-unit group with structure C2 x Z x Z x Z x Z of Number Field in a with defining polynomial x^3 + 3 with S = (Fractional ideal (-a^2 + a - 1), Fractional ideal (a + 1), Fractional ideal (a))</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">U</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">S_unit_group</span><span class="p">(</span><span class="n">proof</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">S</span><span class="o">=</span><span class="mi">6</span><span class="p">);</span> <span class="n">U</span>
<span class="go">S-unit group with structure C2 x Z x Z x Z x Z of Number Field in a with defining polynomial x^3 + 3 with S = (Fractional ideal (-a^2 + a - 1), Fractional ideal (a + 1), Fractional ideal (a))</span>

<span class="gp">sage: </span><span class="n">U</span>
<span class="go">S-unit group with structure C2 x Z x Z x Z x Z of Number Field in a with defining polynomial x^3 + 3 with S = (Fractional ideal (-a^2 + a - 1), Fractional ideal (a + 1), Fractional ideal (a))</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">.</span><span class="n">primes</span><span class="p">()</span>
<span class="go">(Fractional ideal (-a^2 + a - 1),</span>
<span class="go">Fractional ideal (a + 1),</span>
<span class="go">Fractional ideal (a))</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(u0, u1, u2, u3, u4)</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">.</span><span class="n">gens_values</span><span class="p">()</span>
<span class="go">[-1, a^2 - 2, -a^2 + a - 1, a + 1, a]</span>
</pre></div>
</div>
<p>The exp and log methods can be used to create <span class="math notranslate nohighlight">\(S\)</span>-units from
sequences of exponents, and recover the exponents:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">U</span><span class="o">.</span><span class="n">gens_orders</span><span class="p">()</span>
<span class="go">(2, 0, 0, 0, 0)</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">));</span> <span class="n">u</span>
<span class="go">-6*a^2 + 18*a - 54</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">-1 * 2^9 * 3^5</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">(1, 1, 4, 1, 5)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.S_unit_solutions">
<span class="sig-name descname"><span class="pre">S_unit_solutions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">106</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_exponents</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.S_unit_solutions" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all solutions to the S-unit equation <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">+</span> <span class="pre">y</span> <span class="pre">=</span> <span class="pre">1</span></code> over K.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">S</span></code> – a list of finite primes in this number field</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> – precision used for computations in real, complex, and p-adic fields (default: 106)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">include_exponents</span></code> – whether to include the exponent vectors in the returned value (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">include_bound</span></code> – whether to return the final computed bound (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> – if <code class="docutils literal notranslate"><span class="pre">False</span></code>, assume the GRH in computing the class group. Default is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A list of tuples <code class="docutils literal notranslate"><span class="pre">[(</span> <span class="pre">A_1,</span> <span class="pre">B_1,</span> <span class="pre">x_1,</span> <span class="pre">y_1),</span> <span class="pre">(A_2,</span> <span class="pre">B_2,</span> <span class="pre">x_2,</span> <span class="pre">y_2),</span> <span class="pre">...</span> <span class="pre">(</span> <span class="pre">A_n,</span> <span class="pre">B_n,</span> <span class="pre">x_n,</span> <span class="pre">y_n)]</span></code> such that:</p>
<ol class="arabic simple">
<li><p>The first two entries are tuples <code class="docutils literal notranslate"><span class="pre">A_i</span> <span class="pre">=</span> <span class="pre">(a_0,</span> <span class="pre">a_1,</span> <span class="pre">...</span> <span class="pre">,</span> <span class="pre">a_t)</span></code> and <code class="docutils literal notranslate"><span class="pre">B_i</span> <span class="pre">=</span> <span class="pre">(b_0,</span> <span class="pre">b_1,</span> <span class="pre">...</span> <span class="pre">,</span> <span class="pre">b_t)</span></code> of exponents.  These will be omitted if <code class="docutils literal notranslate"><span class="pre">include_exponents</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p>The last two entries are <code class="docutils literal notranslate"><span class="pre">S</span></code>-units <code class="docutils literal notranslate"><span class="pre">x_i</span></code> and <code class="docutils literal notranslate"><span class="pre">y_i</span></code> in <code class="docutils literal notranslate"><span class="pre">K</span></code> with <code class="docutils literal notranslate"><span class="pre">x_i</span> <span class="pre">+</span> <span class="pre">y_i</span> <span class="pre">=</span> <span class="pre">1</span></code>.</p></li>
<li><p>If the default generators for the <code class="docutils literal notranslate"><span class="pre">S</span></code>-units of <code class="docutils literal notranslate"><span class="pre">K</span></code> are <code class="docutils literal notranslate"><span class="pre">(rho_0,</span> <span class="pre">rho_1,</span> <span class="pre">...</span> <span class="pre">,</span> <span class="pre">rho_t)</span></code>, then these satisfy <code class="docutils literal notranslate"><span class="pre">x_i</span> <span class="pre">=</span> <span class="pre">\prod(rho_i)^(a_i)</span></code> and <code class="docutils literal notranslate"><span class="pre">y_i</span> <span class="pre">=</span> <span class="pre">\prod(rho_i)^(b_i)</span></code>.</p></li>
</ol>
<p>If <code class="docutils literal notranslate"><span class="pre">include_bound</span></code>, will return a pair <code class="docutils literal notranslate"><span class="pre">(sols,</span> <span class="pre">bound)</span></code> where <code class="docutils literal notranslate"><span class="pre">sols</span></code> is as above and <code class="docutils literal notranslate"><span class="pre">bound</span></code> is the bound used for the entries in the exponent vectors.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">xi</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">S_unit_solutions</span><span class="p">(</span><span class="n">S</span><span class="p">)</span> <span class="c1"># random, due to ordering</span>
<span class="go">[(xi + 2, -xi - 1), (1/3*xi + 2/3, -1/3*xi + 1/3), (-xi, xi + 1), (-xi + 1, xi)]</span>
</pre></div>
</div>
<p>You can get the exponent vectors:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">S_unit_solutions</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">include_exponents</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c1"># random, due to ordering</span>
<span class="go">[((2, 1), (4, 0), xi + 2, -xi - 1),</span>
<span class="go"> ((5, -1), (4, -1), 1/3*xi + 2/3, -1/3*xi + 1/3),</span>
<span class="go"> ((5, 0), (1, 0), -xi, xi + 1),</span>
<span class="go"> ((1, 1), (2, 0), -xi + 1, xi)]</span>
</pre></div>
</div>
<p>And the computed bound:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">solutions</span><span class="p">,</span> <span class="n">bound</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">S_unit_solutions</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">include_bound</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">bound</span>
<span class="go">7</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.S_units">
<span class="sig-name descname"><span class="pre">S_units</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.S_units" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Return a list of generators of the S-units.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">S</span></code> – a set of primes of the base field</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> – if <code class="docutils literal notranslate"><span class="pre">False</span></code>, assume the GRH in computing the class group</p></li>
</ul>
<p>OUTPUT:</p>
<p>A list of generators of the unit group.</p>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<blockquote>
<div><p>For more functionality see the S_unit_group() function.</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">unit_group</span><span class="p">()</span>
<span class="go">Unit group with structure C6 of Number Field in a with defining polynomial x^2 + 3 with a = 1.732050807568878?*I</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">S_units</span><span class="p">([])</span>  <span class="c1"># random</span>
<span class="go">[1/2*a + 1/2]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">S_units</span><span class="p">([])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">()</span>
<span class="go">6</span>
</pre></div>
</div>
<p>An example in a relative extension (see <a class="reference external" href="https://trac.sagemath.org/8722">trac ticket #8722</a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">ideal</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">S_units</span><span class="p">([</span><span class="n">p</span><span class="p">]);</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">W</span><span class="p">]</span>
<span class="go">[9, 1, 1]</span>
</pre></div>
</div>
<p>Our generators should have the correct parent (<a class="reference external" href="https://trac.sagemath.org/9367">trac ticket #9367</a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">_</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">alpha</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">S_units</span><span class="p">([</span> <span class="n">L</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="p">])</span>
<span class="gp">sage: </span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Number Field in alpha with defining polynomial x^3 + x + 1</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.absolute_degree">
<span class="sig-name descname"><span class="pre">absolute_degree</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.absolute_degree" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the degree of self over <span class="math notranslate nohighlight">\(\QQ\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">997</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">absolute_degree</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">absolute_degree</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">997</span> <span class="o">+</span> <span class="mi">17</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">absolute_degree</span><span class="p">()</span>
<span class="go">997</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.absolute_field">
<span class="sig-name descname"><span class="pre">absolute_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.absolute_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">self</span></code> as an absolute number field.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">names</span></code> – string; name of generator of the absolute field</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">K</span></code> – this number field (since it is already absolute)</p></li>
</ul>
<p>Also, <code class="docutils literal notranslate"><span class="pre">K.structure()</span></code> returns <code class="docutils literal notranslate"><span class="pre">from_K</span></code> and <code class="docutils literal notranslate"><span class="pre">to_K</span></code>, where
<code class="docutils literal notranslate"><span class="pre">from_K</span></code> is an isomorphism from <span class="math notranslate nohighlight">\(K\)</span> to <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">to_K</span></code>
is an isomorphism from <code class="docutils literal notranslate"><span class="pre">self</span></code> to <span class="math notranslate nohighlight">\(K\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">absolute_field</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">Number Field in a with defining polynomial x^4 + x^3 + x^2 + x + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.absolute_polynomial_ntl">
<span class="sig-name descname"><span class="pre">absolute_polynomial_ntl</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.absolute_polynomial_ntl" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference internal" href="#sage.rings.number_field.number_field.NumberField_generic.polynomial_ntl" title="sage.rings.number_field.number_field.NumberField_generic.polynomial_ntl"><code class="xref py py-meth docutils literal notranslate"><span class="pre">polynomial_ntl()</span></code></a>. Mostly for internal use.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">9</span><span class="o">/</span><span class="mi">17</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">absolute_polynomial_ntl</span><span class="p">()</span>
<span class="go">([-27 34 51], 51)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.algebraic_closure">
<span class="sig-name descname"><span class="pre">algebraic_closure</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.algebraic_closure" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the algebraic closure of self (which is QQbar).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">algebraic_closure</span><span class="p">()</span>
<span class="go">Algebraic Field</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">algebraic_closure</span><span class="p">()</span>
<span class="go">Algebraic Field</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">algebraic_closure</span><span class="p">()</span>
<span class="go">Algebraic Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.change_generator">
<span class="sig-name descname"><span class="pre">change_generator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.change_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the number field self, construct another isomorphic number
field <span class="math notranslate nohighlight">\(K\)</span> generated by the element alpha of self, along
with isomorphisms from <span class="math notranslate nohighlight">\(K\)</span> to self and from self to
<span class="math notranslate nohighlight">\(K\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span> <span class="n">L</span>
<span class="go">Number Field in i with defining polynomial x^2 + 1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">,</span> <span class="n">from_K</span><span class="p">,</span> <span class="n">to_K</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">change_generator</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span>
<span class="go">Number Field in i0 with defining polynomial x^2 - 6*x + 37/4 with i0 = 1/2*i + 3</span>
<span class="gp">sage: </span><span class="n">from_K</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Number Field in i0 with defining polynomial x^2 - 6*x + 37/4 with i0 = 1/2*i + 3</span>
<span class="go">  To:   Number Field in i with defining polynomial x^2 + 1</span>
<span class="go">  Defn: i0 |--&gt; 1/2*i + 3</span>
<span class="gp">sage: </span><span class="n">to_K</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Number Field in i with defining polynomial x^2 + 1</span>
<span class="go">  To:   Number Field in i0 with defining polynomial x^2 - 6*x + 37/4 with i0 = 1/2*i + 3</span>
<span class="go">  Defn: i |--&gt; 2*i0 - 6</span>
</pre></div>
</div>
<p>We can also do</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">c</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">from_K</span><span class="p">,</span> <span class="n">to_K</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">change_generator</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in c with defining polynomial x^2 - 6*x + 37/4 with c = 1/2*i + 3</span>
</pre></div>
</div>
<p>We compute the image of the generator <span class="math notranslate nohighlight">\(\sqrt{-1}\)</span> of <span class="math notranslate nohighlight">\(L\)</span>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">to_K</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="go">2*c - 6</span>
</pre></div>
</div>
<p>Note that the image is indeed a square root of -1.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">to_K</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">from_K</span><span class="p">(</span><span class="n">to_K</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="go">i</span>
<span class="gp">sage: </span><span class="n">to_K</span><span class="p">(</span><span class="n">from_K</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
<span class="go">c</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.characteristic">
<span class="sig-name descname"><span class="pre">characteristic</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.characteristic" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the characteristic of this number field, which is of course
0.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">99</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span> <span class="n">k</span>
<span class="go">Number Field in a with defining polynomial x^99 + 2</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">characteristic</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.class_group">
<span class="sig-name descname"><span class="pre">class_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'c'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.class_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the class group of the ring of integers of this number
field.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> - if True then compute the class group
provably correctly. Default is True. Call number_field_proof to
change this default globally.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">names</span></code> - names of the generators of this class
group.</p></li>
</ul>
<p>OUTPUT: The class group of this number field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">class_group</span><span class="p">();</span> <span class="n">G</span>
<span class="go">Class group of order 3 with structure C3 of Number Field in a with defining polynomial x^2 + 23</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="mi">0</span>
<span class="go">Fractional ideal class (2, 1/2*a - 1/2)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(Fractional ideal class (2, 1/2*a - 1/2),)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">number_field</span><span class="p">()</span>
<span class="go">Number Field in a with defining polynomial x^2 + 23</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="ow">is</span> <span class="n">K</span><span class="o">.</span><span class="n">class_group</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="ow">is</span> <span class="n">K</span><span class="o">.</span><span class="n">class_group</span><span class="p">(</span><span class="n">proof</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(Fractional ideal class (2, 1/2*a - 1/2),)</span>
</pre></div>
</div>
<p>There can be multiple generators:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">20072</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">class_group</span><span class="p">();</span> <span class="n">G</span>
<span class="go">Class group of order 76 with structure C38 x C2 of Number Field in a with defining polynomial x^2 + 20072</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="mi">0</span> <span class="c1"># random</span>
<span class="go">Fractional ideal class (41, a + 10)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="mi">0</span><span class="o">^</span><span class="mi">38</span>
<span class="go">Trivial principal fractional ideal class</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="mi">1</span> <span class="c1"># random</span>
<span class="go">Fractional ideal class (2, -1/2*a)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="mi">1</span><span class="o">^</span><span class="mi">2</span>
<span class="go">Trivial principal fractional ideal class</span>
</pre></div>
</div>
<p>Class groups of Hecke polynomials tend to be very small:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">ModularForms</span><span class="p">(</span><span class="mi">97</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(x - 3) * (x^3 + 4*x^2 + 3*x - 1) * (x^4 - 3*x^3 - x^2 + 6*x - 1)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">NumberField</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">class_group</span><span class="p">()</span><span class="o">.</span><span class="n">order</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">factor</span><span class="p">()]</span>
<span class="go">[1, 1, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.class_number">
<span class="sig-name descname"><span class="pre">class_number</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.class_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the class number of this number field, as an integer.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> - bool (default: <code class="docutils literal notranslate"><span class="pre">True</span></code> unless you called
number_field_proof)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">23</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">class_number</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">163</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">class_number</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">997</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">class_number</span><span class="p">(</span><span class="n">proof</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">1539</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.completely_split_primes">
<span class="sig-name descname"><span class="pre">completely_split_primes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.completely_split_primes" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Return a list of rational primes which split completely in the number field <span class="math notranslate nohighlight">\(K\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">B</span></code> – a positive integer bound (default: 200)</p></li>
</ul>
<p>OUTPUT:</p>
<p>A list of all primes <code class="docutils literal notranslate"><span class="pre">p</span> <span class="pre">&lt;</span> <span class="pre">B</span></code> which split completely in <code class="docutils literal notranslate"><span class="pre">K</span></code>.</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">xi</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">completely_split_primes</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">[17, 19, 37, 53, 71, 73, 89]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.completion">
<span class="sig-name descname"><span class="pre">completion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extras</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.completion" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the completion of self at <span class="math notranslate nohighlight">\(p\)</span> to the specified precision.</p>
<p>Only implemented at archimedean places, and then only if
an embedding has been fixed.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">completion</span><span class="p">(</span><span class="n">infinity</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="go">Real Field with 100 bits of precision</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">zeta</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">completion</span><span class="p">(</span><span class="n">infinity</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="n">extras</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;RDF&#39;</span><span class="p">})</span>
<span class="go">Complex Double Field</span>
<span class="gp">sage: </span><span class="n">zeta</span> <span class="o">+</span> <span class="mf">1.5</span>                            <span class="c1"># implicit test</span>
<span class="go">2.36602540378444 + 0.500000000000000*I</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.complex_conjugation">
<span class="sig-name descname"><span class="pre">complex_conjugation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.complex_conjugation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the complex conjugation of self.</p>
<p>This is only well-defined for fields contained in CM fields
(i.e. for totally real fields and CM fields). Recall that a CM
field is a totally imaginary quadratic extension of a totally
real field. For other fields, a ValueError is raised.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">complex_conjugation</span><span class="p">()</span>
<span class="go">Ring endomorphism of Number Field in I with defining polynomial x^2 + 1 with I = 1*I</span>
<span class="go">  Defn: I |--&gt; -I</span>
<span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">complex_conjugation</span><span class="p">()</span>
<span class="go">Ring endomorphism of Cyclotomic Field of order 8 and degree 4</span>
<span class="go">  Defn: zeta8 |--&gt; -zeta8^3</span>
<span class="gp">sage: </span><span class="n">QuadraticField</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">complex_conjugation</span><span class="p">()</span>
<span class="go">Identity endomorphism of Number Field in a with defining polynomial x^2 - 5 with a = 2.236067977499790?</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">is_totally_real</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">complex_conjugation</span><span class="p">()</span>
<span class="go">Identity endomorphism of Number Field in a with defining polynomial x^4 + x^3 - 3*x^2 - x + 1</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">complex_conjugation</span><span class="p">()</span>
<span class="go">Relative number field endomorphism of Number Field in a with defining polynomial x^2 + 1 over its base field</span>
<span class="go">  Defn: a |--&gt; -a</span>
<span class="go">        b |--&gt; b</span>
<span class="gp">sage: </span><span class="n">F2</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K2</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">F2</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cc</span> <span class="o">=</span> <span class="n">K2</span><span class="o">.</span><span class="n">complex_conjugation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">cc</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">-a</span>
<span class="gp">sage: </span><span class="n">cc</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">-b</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.complex_embeddings">
<span class="sig-name descname"><span class="pre">complex_embeddings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">53</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.complex_embeddings" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all homomorphisms of this number field into the approximate
complex field with precision prec.</p>
<p>This always embeds into an MPFR based complex field.  If you
want embeddings into the 53-bit double precision, which is
faster, use <code class="docutils literal notranslate"><span class="pre">self.embeddings(CDF)</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">17</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">complex_embeddings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">ls</span> <span class="o">=</span> <span class="p">[</span><span class="n">phi</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="mi">0</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">phi</span> <span class="ow">in</span> <span class="n">v</span><span class="p">]</span> <span class="p">;</span> <span class="n">ls</span> <span class="c1"># random order</span>
<span class="go">[2.97572074038...,</span>
<span class="go"> -2.40889943716 + 1.90254105304*I,</span>
<span class="go"> -2.40889943716 - 1.90254105304*I,</span>
<span class="go"> 0.921039066973 + 3.07553311885*I,</span>
<span class="go"> 0.921039066973 - 3.07553311885*I]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ls</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">complex_embeddings</span><span class="p">()</span> <span class="p">;</span> <span class="n">ls</span> <span class="c1"># random order</span>
<span class="go">[</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial x^3 + 2</span>
<span class="go">  To:   Complex Double Field</span>
<span class="go">  Defn: a |--&gt; -1.25992104989...,</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial x^3 + 2</span>
<span class="go">  To:   Complex Double Field</span>
<span class="go">  Defn: a |--&gt; 0.629960524947 - 1.09112363597*I,</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial x^3 + 2</span>
<span class="go">  To:   Complex Double Field</span>
<span class="go">  Defn: a |--&gt; 0.629960524947 + 1.09112363597*I</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.composite_fields">
<span class="sig-name descname"><span class="pre">composite_fields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">both_maps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preserve_embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.composite_fields" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the possible composite number fields formed from
<code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">other</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> – number field</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">names</span></code> – generator name for composite fields</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">both_maps</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">preserve_embedding</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>)</p></li>
</ul>
<p>OUTPUT:</p>
<p>A list of the composite fields, possibly with maps.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">both_maps</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, the list consists of quadruples
<code class="docutils literal notranslate"><span class="pre">(F,</span> <span class="pre">self_into_F,</span> <span class="pre">other_into_F,</span> <span class="pre">k)</span></code> such that
<code class="docutils literal notranslate"><span class="pre">self_into_F</span></code> is an embedding of <code class="docutils literal notranslate"><span class="pre">self</span></code> in <code class="docutils literal notranslate"><span class="pre">F</span></code>,
<code class="docutils literal notranslate"><span class="pre">other_into_F</span></code> is an embedding of in <code class="docutils literal notranslate"><span class="pre">F</span></code>, and <code class="docutils literal notranslate"><span class="pre">k</span></code> is one
of the following:</p>
<ul class="simple">
<li><p>an integer such that <code class="docutils literal notranslate"><span class="pre">F.gen()</span></code> equals
<code class="docutils literal notranslate"><span class="pre">other_into_F(other.gen())</span> <span class="pre">+</span> <span class="pre">k*self_into_F(self.gen())</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Infinity</span></code>, in which case <code class="docutils literal notranslate"><span class="pre">F.gen()</span></code> equals
<code class="docutils literal notranslate"><span class="pre">self_into_F(self.gen())</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code> (when <code class="docutils literal notranslate"><span class="pre">other</span></code> is a relative number field).</p></li>
</ul>
<p>If both <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">other</span></code> have embeddings into an ambient
field, then each <code class="docutils literal notranslate"><span class="pre">F</span></code> will have an embedding with respect to
which both <code class="docutils literal notranslate"><span class="pre">self_into_F</span></code> and <code class="docutils literal notranslate"><span class="pre">other_into_F</span></code> will be
compatible with the ambient embeddings.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">preserve_embedding</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code> and if <code class="docutils literal notranslate"><span class="pre">self</span></code> and
<code class="docutils literal notranslate"><span class="pre">other</span></code> both have embeddings into the same ambient field, or
into fields which are contained in a common field, only the
compositum respecting both embeddings is returned.  In all
other cases, all possible composite number fields are
returned.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">composite_fields</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="go">[Number Field in a with defining polynomial x^4 - 2,</span>
<span class="go"> Number Field in a0 with defining polynomial x^8 + 28*x^4 + 2500]</span>
</pre></div>
</div>
<p>A particular compositum is selected, together with compatible maps
into the compositum, if the fields are endowed with a real or
complex embedding:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K1</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">embedding</span><span class="o">=</span><span class="n">RR</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="n">K2</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">embedding</span><span class="o">=</span><span class="n">RR</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="n">K1</span><span class="o">.</span><span class="n">composite_fields</span><span class="p">(</span><span class="n">K2</span><span class="p">)</span>
<span class="go">[Number Field in a with defining polynomial x^4 - 2 with a = 1.189207115002722?]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">F</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">k</span><span class="p">],</span> <span class="o">=</span> <span class="n">K1</span><span class="o">.</span><span class="n">composite_fields</span><span class="p">(</span><span class="n">K2</span><span class="p">,</span> <span class="n">both_maps</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">F</span>
<span class="go">Number Field in a with defining polynomial x^4 - 2 with a = 1.189207115002722?</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">K1</span><span class="o">.</span><span class="mi">0</span><span class="p">),</span> <span class="n">g</span><span class="p">(</span><span class="n">K2</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(a, -a)</span>
</pre></div>
</div>
<p>With <code class="docutils literal notranslate"><span class="pre">preserve_embedding</span></code> set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, the embeddings
are ignored:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K1</span><span class="o">.</span><span class="n">composite_fields</span><span class="p">(</span><span class="n">K2</span><span class="p">,</span> <span class="n">preserve_embedding</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[Number Field in a with defining polynomial x^4 - 2 with a = 1.189207115002722?,</span>
<span class="go"> Number Field in a0 with defining polynomial x^8 + 28*x^4 + 2500]</span>
</pre></div>
</div>
<p>Changing the embedding selects a different compositum:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K3</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">embedding</span><span class="o">=</span><span class="n">CC</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">I</span><span class="p">))</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">F</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">k</span><span class="p">],</span> <span class="o">=</span> <span class="n">K1</span><span class="o">.</span><span class="n">composite_fields</span><span class="p">(</span><span class="n">K3</span><span class="p">,</span> <span class="n">both_maps</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">F</span>
<span class="go">Number Field in a0 with defining polynomial x^8 + 28*x^4 + 2500 with a0 = -2.378414230005443? + 1.189207115002722?*I</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">K1</span><span class="o">.</span><span class="mi">0</span><span class="p">),</span> <span class="n">g</span><span class="p">(</span><span class="n">K3</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(1/240*a0^5 - 41/120*a0, 1/120*a0^5 + 19/60*a0)</span>
</pre></div>
</div>
<p>If no embeddings are specified, the maps into the compositum
are chosen arbitrarily:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q1</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q2</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">16</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">composite_fields</span><span class="p">(</span><span class="n">Q2</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="go">[Number Field in c with defining polynomial x^8 + 64*x^6 + 904*x^4 + 3840*x^2 + 3600]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="p">,</span> <span class="n">Q1_into_F</span><span class="p">,</span> <span class="n">Q2_into_F</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">Q1</span><span class="o">.</span><span class="n">composite_fields</span><span class="p">(</span><span class="n">Q2</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">both_maps</span><span class="o">=</span><span class="bp">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">Q1_into_F</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial x^4 + 10*x^2 + 1</span>
<span class="go">  To:   Number Field in c with defining polynomial x^8 + 64*x^6 + 904*x^4 + 3840*x^2 + 3600</span>
<span class="go">  Defn: a |--&gt; 19/14400*c^7 + 137/1800*c^5 + 2599/3600*c^3 + 8/15*c</span>
</pre></div>
</div>
<p>This is just one of four embeddings of <code class="docutils literal notranslate"><span class="pre">Q1</span></code> into <code class="docutils literal notranslate"><span class="pre">F</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Hom</span><span class="p">(</span><span class="n">Q1</span><span class="p">,</span> <span class="n">F</span><span class="p">)</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
<p>Note that even with <code class="docutils literal notranslate"><span class="pre">preserve_embedding=True</span></code>, this method may fail
to recognize that the two number fields have compatible embeddings, and
hence return several composite number fields:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">7</span><span class="p">,</span> <span class="n">embedding</span><span class="o">=</span><span class="n">CC</span><span class="p">(</span><span class="o">-</span><span class="mf">0.95</span><span class="o">+</span><span class="mf">1.65</span><span class="o">*</span><span class="n">I</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">9</span> <span class="o">-</span> <span class="mi">7</span><span class="p">,</span> <span class="n">embedding</span><span class="o">=</span><span class="n">QQbar</span><span class="o">.</span><span class="n">polynomial_root</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">9</span> <span class="o">-</span> <span class="mi">7</span><span class="p">,</span> <span class="n">RIF</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">composite_fields</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">preserve_embedding</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.conductor">
<span class="sig-name descname"><span class="pre">conductor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">check_abelian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.conductor" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the conductor of the abelian field <span class="math notranslate nohighlight">\(K\)</span>.
If check_abelian is set to false and the field is not an
abelian extension of <span class="math notranslate nohighlight">\(\QQ\)</span>, the output is not meaningful.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">check_abelian</span></code> - a boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); check to see that this is an abelian extension of <span class="math notranslate nohighlight">\(\QQ\)</span></p></li>
</ul>
<p>OUTPUT:</p>
<p>Integer which is the conductor of the field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">subfields</span><span class="p">(</span><span class="mi">9</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">27</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">36</span><span class="o">*</span><span class="n">x</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">109</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">48</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">subfields</span><span class="p">(</span><span class="mi">16</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">48</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">8</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">19</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">12</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">40</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">8</span> <span class="o">+</span> <span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">40</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">8</span> <span class="o">-</span> <span class="mi">40</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">500</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2000</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">50</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">160</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<blockquote>
<div><p>For odd primes, it is easy to compute from the ramification
index because the p-Sylow subgroup is cyclic.  For p=2, there
are two choices for a given ramification index.  They can be
distinguished by the parity of the exponent in the discriminant
of a 2-adic completion.</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.construction">
<span class="sig-name descname"><span class="pre">construction</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.construction" title="Permalink to this definition">¶</a></dt>
<dd><p>Construction of self</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">embedding</span><span class="o">=</span><span class="n">CC</span><span class="o">.</span><span class="n">gen</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">F</span><span class="p">,</span><span class="n">R</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">construction</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">F</span>
<span class="go">AlgebraicExtensionFunctor</span>
<span class="gp">sage: </span><span class="n">R</span>
<span class="go">Rational Field</span>
</pre></div>
</div>
<p>The construction functor respects distinguished embeddings:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="p">(</span><span class="n">R</span><span class="p">)</span> <span class="ow">is</span> <span class="n">K</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">embeddings</span>
<span class="go">[0.2327856159383841? + 0.7925519925154479?*I]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.decomposition_type">
<span class="sig-name descname"><span class="pre">decomposition_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.decomposition_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Return how the given prime of the base field splits in this number field.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime element or ideal of the base field.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A list of triples <span class="math notranslate nohighlight">\((e, f, g)\)</span> where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(e\)</span> is the ramification index,</p></li>
<li><p><span class="math notranslate nohighlight">\(f\)</span> is the residue class degree,</p></li>
<li><p><span class="math notranslate nohighlight">\(g\)</span> is the number of primes above <span class="math notranslate nohighlight">\(p\)</span> with given <span class="math notranslate nohighlight">\(e\)</span> and <span class="math notranslate nohighlight">\(f\)</span></p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">20</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">18</span> <span class="o">+</span> <span class="mi">15</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">16</span> <span class="o">+</span> <span class="mi">28</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">14</span> <span class="o">+</span> <span class="mi">237</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">12</span> <span class="o">+</span> <span class="mi">579</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">10</span> <span class="o">+</span> <span class="mi">1114</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">8</span> <span class="o">+</span> <span class="mi">1470</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">2304</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">1296</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">729</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">is_galois</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">2^20 * 3^10 * 53^10</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">decomposition_type</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[(2, 5, 2)]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">decomposition_type</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[(2, 1, 10)]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">decomposition_type</span><span class="p">(</span><span class="mi">53</span><span class="p">)</span>
<span class="go">[(2, 2, 5)]</span>
</pre></div>
</div>
<p>This example is only ramified at 11:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">24</span> <span class="o">+</span> <span class="mi">11</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">90</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">12</span> <span class="o">-</span> <span class="mi">640</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">8</span> <span class="o">+</span> <span class="mi">2280</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">512</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span><span class="mi">2432</span><span class="o">/</span><span class="mi">11</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">11</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">-1 * 11^43</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">decomposition_type</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">[(1, 1, 2), (22, 1, 1)]</span>
</pre></div>
</div>
<p>Computing the decomposition type is feasible even in large degree:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">144</span> <span class="o">+</span> <span class="mi">123</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">72</span> <span class="o">+</span> <span class="mi">321</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">36</span> <span class="o">+</span> <span class="mi">13</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">18</span> <span class="o">+</span> <span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>
<span class="go">2^144 * 3^288 * 7^18 * 11^17 * 31^18 * 157^18 * 2153^18 * 13907^18 * ...</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">decomposition_type</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[(2, 4, 3), (2, 12, 2), (2, 36, 1)]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">decomposition_type</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[(9, 3, 2), (9, 10, 1)]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">decomposition_type</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">[(1, 18, 1), (1, 90, 1), (2, 1, 6), (2, 3, 4)]</span>
</pre></div>
</div>
<p>It also works for relative extensions:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">143</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">c</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">10</span> <span class="o">-</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">8</span> <span class="o">+</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mi">12</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">89</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="p">(</span><span class="mi">13</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">77</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">25</span><span class="p">)</span>
</pre></div>
</div>
<p>There is a unique prime above <span class="math notranslate nohighlight">\(11\)</span> and above <span class="math notranslate nohighlight">\(13\)</span> in <span class="math notranslate nohighlight">\(K\)</span>, each of which is unramified in <span class="math notranslate nohighlight">\(M\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">decomposition_type</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">[(1, 2, 5)]</span>
<span class="gp">sage: </span><span class="n">P11</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">11</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="n">P11</span><span class="p">))</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">decomposition_type</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="go">[(1, 1, 10)]</span>
<span class="gp">sage: </span><span class="n">P13</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">13</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="n">P13</span><span class="p">))</span>
<span class="go">10</span>
</pre></div>
</div>
<p>There are two primes above <span class="math notranslate nohighlight">\(2\)</span>, each of which ramifies in <span class="math notranslate nohighlight">\(M\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q0</span><span class="p">,</span> <span class="n">Q1</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">decomposition_type</span><span class="p">(</span><span class="n">Q0</span><span class="p">)</span>
<span class="go">[(2, 5, 1)]</span>
<span class="gp">sage: </span><span class="n">q0</span><span class="p">,</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="n">Q0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">q0</span><span class="o">.</span><span class="n">residue_class_degree</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">q0</span><span class="o">.</span><span class="n">relative_ramification_index</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">decomposition_type</span><span class="p">(</span><span class="n">Q1</span><span class="p">)</span>
<span class="go">[(2, 5, 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.defining_polynomial">
<span class="sig-name descname"><span class="pre">defining_polynomial</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.defining_polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the defining polynomial of this number field.</p>
<p>This is exactly the same as <code class="docutils literal notranslate"><span class="pre">self.polynomial()</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k5</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k5</span><span class="o">.</span><span class="n">defining_polynomial</span><span class="p">()</span>
<span class="go">x^4 + x^3 + x^2 + x + 1</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">9</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">5</span><span class="p">);</span> <span class="n">k</span>
<span class="go">Number Field in a with defining polynomial y^9 - 3*y + 5</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">defining_polynomial</span><span class="p">()</span>
<span class="go">y^9 - 3*y + 5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.degree">
<span class="sig-name descname"><span class="pre">degree</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.degree" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the degree of this number field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">997</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">997</span> <span class="o">+</span> <span class="mi">17</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">997</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.different">
<span class="sig-name descname"><span class="pre">different</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.different" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the different fractional ideal of this number field.</p>
<p>The codifferent is the fractional ideal of all <span class="math notranslate nohighlight">\(x\)</span> in <span class="math notranslate nohighlight">\(K\)</span>
such that the trace of <span class="math notranslate nohighlight">\(xy\)</span> is an integer for
all <span class="math notranslate nohighlight">\(y \in O_K\)</span>.</p>
<p>The different is the integral ideal which is the inverse of
the codifferent.</p>
<p>See <a class="reference external" href="https://en.wikipedia.org/wiki/Different_ideal">Wikipedia article Different_ideal</a></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">different</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">d</span>
<span class="go">Fractional ideal (-a)</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">23</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">disc</span><span class="p">()</span>
<span class="go">-23</span>
</pre></div>
</div>
<p>The different is cached:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">d</span> <span class="ow">is</span> <span class="n">k</span><span class="o">.</span><span class="n">different</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Another example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">123</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">different</span><span class="p">();</span> <span class="n">d</span>
<span class="go">Fractional ideal (2*b)</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">492</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">disc</span><span class="p">()</span>
<span class="go">492</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.dirichlet_group">
<span class="sig-name descname"><span class="pre">dirichlet_group</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.dirichlet_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a abelian field <span class="math notranslate nohighlight">\(K\)</span>, this computes and returns the
set of all Dirichlet characters corresponding to the
characters of the Galois group of <span class="math notranslate nohighlight">\(K/\mathbb{Q}\)</span>.</p>
<p>The output is random if the field is not abelian</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a list of Dirichlet characters</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">36</span><span class="o">*</span><span class="n">x</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">109</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">dirichlet_group</span><span class="p">()</span>
<span class="go">[Dirichlet character modulo 109 of conductor 1 mapping 6 |--&gt; 1,</span>
<span class="go">Dirichlet character modulo 109 of conductor 109 mapping 6 |--&gt; zeta3,</span>
<span class="go">Dirichlet character modulo 109 of conductor 109 mapping 6 |--&gt; -zeta3 - 1]</span>

<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">44</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">subfields</span><span class="p">(</span><span class="mi">5</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">dirichlet_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">X</span>
<span class="go">[Dirichlet character modulo 11 of conductor 1 mapping 2 |--&gt; 1,</span>
<span class="go">Dirichlet character modulo 11 of conductor 11 mapping 2 |--&gt; zeta5,</span>
<span class="go">Dirichlet character modulo 11 of conductor 11 mapping 2 |--&gt; zeta5^2,</span>
<span class="go">Dirichlet character modulo 11 of conductor 11 mapping 2 |--&gt; zeta5^3,</span>
<span class="go">Dirichlet character modulo 11 of conductor 11 mapping 2 |--&gt; -zeta5^3 - zeta5^2 - zeta5 - 1]</span>
<span class="gp">sage: </span><span class="n">X</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span>
<span class="go">Dirichlet character modulo 11 of conductor 11 mapping 2 |--&gt; zeta5^3</span>
<span class="gp">sage: </span><span class="n">X</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span> <span class="ow">in</span> <span class="n">X</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.disc">
<span class="sig-name descname"><span class="pre">disc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.disc" title="Permalink to this definition">¶</a></dt>
<dd><p>Shortcut for self.discriminant.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">123</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">disc</span><span class="p">()</span>
<span class="go">492</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.discriminant">
<span class="sig-name descname"><span class="pre">discriminant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.discriminant" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the discriminant of the ring of integers of the number
field, or if v is specified, the determinant of the trace pairing
on the elements of the list v.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code> – (optional) list of elements of this number field</p></li>
</ul>
<p>OUTPUT:</p>
<p>Integer if <span class="math notranslate nohighlight">\(v\)</span> is omitted, and Rational otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">disc</span><span class="p">()</span>
<span class="go">-503</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">disc</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="go">-2012</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">disc</span><span class="p">([</span><span class="mi">1</span><span class="o">/</span><span class="mi">7</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="go">-2012/11025</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="mi">7</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="go">11025</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">8</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.elements_of_norm">
<span class="sig-name descname"><span class="pre">elements_of_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.elements_of_norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of elements of norm <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – integer in this number field</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>, unless you called
<code class="xref py py-meth docutils literal notranslate"><span class="pre">proof.number_field()</span></code> and set it otherwise)</p></li>
</ul>
<p>OUTPUT:</p>
<p>A complete system of integral elements of norm <span class="math notranslate nohighlight">\(n\)</span>, modulo
units of positive norm.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">elements_of_norm</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">elements_of_norm</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="go">[-7*a + 1, 5*a - 5, 7*a + 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.extension">
<span class="sig-name descname"><span class="pre">extension</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">poly</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latex_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latex_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.extension" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the relative extension of this field by a given polynomial.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="p">);</span> <span class="n">L</span>
<span class="go">Number Field in b with defining polynomial t^2 + a over its base field</span>
</pre></div>
</div>
<p>We create another extension:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span> <span class="n">k</span>
<span class="go">Number Field in a with defining polynomial x^2 + 1</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span> <span class="n">m</span>
<span class="go">Number Field in b with defining polynomial y^2 + 2 over its base field</span>
</pre></div>
</div>
<p>Note that b is a root of <span class="math notranslate nohighlight">\(y^2 + 2\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>
<span class="go">x^2 + 2</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">minpoly</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="go">z^2 + 2</span>
</pre></div>
</div>
<p>A relative extension of a relative extension:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">k</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">a</span><span class="p">);</span> <span class="n">L</span>
<span class="go">Number Field in b with defining polynomial z^3 + a0 + 3 over its base field</span>
</pre></div>
</div>
<p>Extension fields with given defining data are unique
(<a class="reference external" href="https://trac.sagemath.org/20791">trac ticket #20791</a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.factor">
<span class="sig-name descname"><span class="pre">factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Ideal factorization of the principal ideal generated by <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>EXAMPLES:</p>
<p>Here we show how to factor Gaussian integers (up to units).
First we form a number field defined by <span class="math notranslate nohighlight">\(x^2 + 1\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">I</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in I with defining polynomial x^2 + 1</span>
</pre></div>
</div>
<p>Here are the factors:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fi</span><span class="p">,</span> <span class="n">fj</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">17</span><span class="p">);</span> <span class="n">fi</span><span class="p">,</span><span class="n">fj</span>
<span class="go">((Fractional ideal (I + 4), 1), (Fractional ideal (I - 4), 1))</span>
</pre></div>
</div>
<p>Now we extract the reduced form of the generators:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">zi</span> <span class="o">=</span> <span class="n">fi</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">gens_reduced</span><span class="p">()[</span><span class="mi">0</span><span class="p">];</span> <span class="n">zi</span>
<span class="go">I + 4</span>
<span class="gp">sage: </span><span class="n">zj</span> <span class="o">=</span> <span class="n">fj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">gens_reduced</span><span class="p">()[</span><span class="mi">0</span><span class="p">];</span> <span class="n">zj</span>
<span class="go">I - 4</span>
</pre></div>
</div>
<p>We recover the integer that was factored in <span class="math notranslate nohighlight">\(\ZZ[i]\)</span> (up to a unit):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">zi</span><span class="o">*</span><span class="n">zj</span>
<span class="go">-17</span>
</pre></div>
</div>
<p>One can also factor elements or ideals of the number field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(Fractional ideal (3))^-1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="p">)</span>
<span class="go">Fractional ideal (a + 1)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
<span class="go">(Fractional ideal (a + 1)) * (Fractional ideal (-a - 2))^-1 * (Fractional ideal (2*a + 1))^-1 * (Fractional ideal (-3*a - 2))</span>
</pre></div>
</div>
<p>An example over a relative number field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">pari</span><span class="p">(</span><span class="s1">&#39;setrand(2)&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span>                               <span class="c1"># representation varies, not tested</span>
<span class="go">(Fractional ideal (1/2*a*b - a + 1/2)) * (Fractional ideal (-1/2*a*b - a + 1/2))</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">value</span><span class="p">()</span> <span class="o">==</span> <span class="n">a</span><span class="o">+</span><span class="mi">1</span>
<span class="go">True</span>
</pre></div>
</div>
<p>It doesn’t make sense to factor the ideal (0), so this raises an error:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">AttributeError: &#39;NumberFieldIdeal&#39; object has no attribute &#39;factor&#39;</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Alex Clemesha (2006-05-20), Francis Clarke (2009-04-21): examples</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.fractional_ideal">
<span class="sig-name descname"><span class="pre">fractional_ideal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">gens</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.fractional_ideal" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the ideal in <span class="math notranslate nohighlight">\(\mathcal{O}_K\)</span> generated by gens.
This overrides the <code class="docutils literal notranslate"><span class="pre">sage.rings.ring.Field</span></code> method to
use the <code class="docutils literal notranslate"><span class="pre">sage.rings.ring.Ring</span></code> one instead, since
we’re not really concerned with ideals in a field but in its ring
of integers.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gens</span></code> - a list of generators, or a number field
ideal.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">fractional_ideal</span><span class="p">([</span><span class="mi">1</span><span class="o">/</span><span class="n">a</span><span class="p">])</span>
<span class="go">Fractional ideal (1/2*a^2)</span>
</pre></div>
</div>
<p>One can also input a number field ideal itself,
or, more usefully, for a tower of number fields an ideal
in one of the fields lower down the tower.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">fractional_ideal</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="go">Fractional ideal (a)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">c</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>
<span class="go">Fractional ideal (-a)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span> <span class="o">==</span> <span class="n">M</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The zero ideal is not a fractional ideal!</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">fractional_ideal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: gens must have a nonzero element (zero ideal is not a fractional ideal)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.galois_group">
<span class="sig-name descname"><span class="pre">galois_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pari'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gc_numbering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.galois_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Galois group of the Galois closure of this number field.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">type</span></code> - Deprecated; the different versions of Galois groups have been
merged in <a class="reference external" href="https://trac.sagemath.org/28782">trac ticket #28782</a>.</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> - ‘pari’, ‘gap’, ‘kash’, ‘magma’. (default: ‘pari’;</dt><dd><p>for degrees between 12 and 15 default is ‘gap’, and
when the degree is &gt;= 16 it is ‘kash’.)</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">names</span></code> - a string giving a name for the generator of the Galois
closure of self, when this field is not Galois.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gc_numbering</span></code> – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, permutations will be written
in terms of the action on the roots of a defining polynomial
for the Galois closure, rather than the defining polynomial for
the original number field.  This is significantly faster;
but not the standard way of presenting Galois groups.
The default currently depends on the algorithm (<code class="docutils literal notranslate"><span class="pre">True</span></code> for <code class="docutils literal notranslate"><span class="pre">'pari'</span></code>,
<code class="docutils literal notranslate"><span class="pre">False</span></code> for <code class="docutils literal notranslate"><span class="pre">'magma'</span></code>) and may change in the future.</p></li>
</ul>
<p>The resulting group will only compute with automorphisms when necessary,
so certain functions (such as <a class="reference internal" href="galois_group.html#sage.rings.number_field.galois_group.GaloisGroup_v2.order" title="sage.rings.number_field.galois_group.GaloisGroup_v2.order"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.rings.number_field.galois_group.GaloisGroup_v2.order()</span></code></a>)
will still be fast.  For more (important!)
documentation, see the documentation for Galois groups of polynomials
over <span class="math notranslate nohighlight">\(\QQ\)</span>, e.g., by typing <code class="docutils literal notranslate"><span class="pre">K.polynomial().galois_group?</span></code>,
where <span class="math notranslate nohighlight">\(K\)</span> is a number field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">14</span><span class="p">)</span> <span class="c1"># a Galois extension</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">galois_group</span><span class="p">();</span> <span class="n">G</span>
<span class="go">Galois group 2T1 (S2) with order 2 of x^2 - 14</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(1,2)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">0</span><span class="p">)(</span><span class="n">b</span><span class="p">)</span>
<span class="go">-b</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">artin_symbol</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">(1,2)</span>

<span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># not Galois</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Galois group 3T2 (S3) with order 6 of x^3 - x + 1</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(1,2,3)(4,5,6)</span>

<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">)</span>   <span class="c1"># optional - magma</span>
<span class="go">Galois group Transitive group number 2 of degree 3 of the Number Field in a with defining polynomial x^3 + 2*x + 1</span>
</pre></div>
</div>
<p>EXPLICIT GALOIS GROUP: We compute the Galois group as an explicit
group of automorphisms of the Galois closure of a field.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">b1</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">galois_closure</span><span class="p">();</span> <span class="n">L</span>
<span class="go">Number Field in b1 with defining polynomial x^6 + 108</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">End</span><span class="p">(</span><span class="n">L</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Automorphism group of Number Field in b1 with defining polynomial x^6 + 108</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">Ring endomorphism of Number Field in b1 with defining polynomial x^6 + 108</span>
<span class="go">  Defn: b1 |--&gt; b1,</span>
<span class="go">...</span>
<span class="go">Ring endomorphism of Number Field in b1 with defining polynomial x^6 + 108</span>
<span class="go">  Defn: b1 |--&gt; -1/12*b1^4 - 1/2*b1</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="p">[</span><span class="mi">2</span><span class="p">](</span><span class="n">b1</span><span class="p">)</span>
<span class="go">1/12*b1^4 + 1/2*b1</span>
</pre></div>
</div>
<p>many examples for higher degrees may be found in the online databases
<a class="reference external" href="http://galoisdb.math.upb.de/">http://galoisdb.math.upb.de/</a> by Jürgen Klüners and Gunter Malle and
<a class="reference external" href="https://www.lmfdb.org/NumberField/">https://www.lmfdb.org/NumberField/</a> by the LMFDB collaboration,
although these might need a lot of computing time.</p>
<p>If <span class="math notranslate nohighlight">\(L/K\)</span> is a relative number field, this method will currently return <span class="math notranslate nohighlight">\(Gal(L/\QQ)\)</span>.  This behavior will
change in the future, so it’s better to explicitly call <a class="reference internal" href="#sage.rings.number_field.number_field.NumberField_generic.absolute_field" title="sage.rings.number_field.number_field.NumberField_generic.absolute_field"><code class="xref py py-meth docutils literal notranslate"><span class="pre">absolute_field()</span></code></a> if that is
the desired behavior:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="n">t</span><span class="o">+</span><span class="n">a</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">galois_group</span><span class="p">()</span>
<span class="go">...DeprecationWarning: Use .absolute_field().galois_group() if you want the Galois group of the absolute field</span>
<span class="go">See https://trac.sagemath.org/28782 for details.</span>
<span class="go">Galois group 10T22 (S(5)[x]2) with order 240 of t^5 - t + a</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.gen">
<span class="sig-name descname"><span class="pre">gen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.gen" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the generator for this number field.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> - must be 0 (the default), or an exception is
raised.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">theta</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">14</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span> <span class="n">k</span>
<span class="go">Number Field in theta with defining polynomial x^14 + 2</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="go">theta</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">IndexError: Only one generator.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.gen_embedding">
<span class="sig-name descname"><span class="pre">gen_embedding</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.gen_embedding" title="Permalink to this definition">¶</a></dt>
<dd><p>If an embedding has been specified, return the image of the
generator under that embedding. Otherwise return None.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">gen_embedding</span><span class="p">()</span>
<span class="go">2.645751311064591?*I</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">gen_embedding</span><span class="p">()</span> <span class="c1"># None</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.ideal">
<span class="sig-name descname"><span class="pre">ideal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">gens</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.ideal" title="Permalink to this definition">¶</a></dt>
<dd><p>K.ideal() returns a fractional ideal of the field, except for the
zero ideal which is not a fractional ideal.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Fractional ideal (2)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>
<span class="go">Fractional ideal (i + 2)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Ideal (0) of Number Field in i with defining polynomial x^2 + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.idealchinese">
<span class="sig-name descname"><span class="pre">idealchinese</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ideals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residues</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.idealchinese" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a solution of the Chinese Remainder Theorem problem
for ideals in a number field.</p>
<p>This is a wrapper around the pari function <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/idealchinese">pari:idealchinese</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ideals</span></code> - a list of ideals of the number field.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">residues</span></code> - a list of elements of the number field.</p></li>
</ul>
<p>OUTPUT:</p>
<p>Return an element <span class="math notranslate nohighlight">\(b\)</span> of the number field such that
<span class="math notranslate nohighlight">\(b \equiv x_i \bmod I_i\)</span> for all residues <span class="math notranslate nohighlight">\(x_i\)</span> and
respective ideals <span class="math notranslate nohighlight">\(I_i\)</span>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="../../../../rings_standard/sage/arith/misc.html#sage.arith.misc.crt" title="(in Sage 9.4 Reference Manual: Standard Commutative Rings v9.4)"><code class="xref py py-func docutils literal notranslate"><span class="pre">crt()</span></code></a></p></li>
</ul>
</div>
<p>EXAMPLES:</p>
<p>This is the example from the pari page on <code class="docutils literal notranslate"><span class="pre">idealchinese</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">sqrt2</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">minpoly</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">ideals</span> <span class="o">=</span> <span class="p">[</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">residues</span> <span class="o">=</span> <span class="p">[</span><span class="n">sqrt2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">idealchinese</span><span class="p">(</span><span class="n">ideals</span><span class="p">,</span><span class="n">residues</span><span class="p">);</span> <span class="n">r</span>
<span class="go">-3*sqrt2 + 4</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">((</span><span class="n">r</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="ow">in</span> <span class="n">I</span> <span class="k">for</span> <span class="n">I</span><span class="p">,</span><span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ideals</span><span class="p">,</span><span class="n">residues</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The result may be non-integral if the results are non-integral:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">sqrt2</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">minpoly</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">ideals</span> <span class="o">=</span> <span class="p">[</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">21</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">residues</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">idealchinese</span><span class="p">(</span><span class="n">ideals</span><span class="p">,</span><span class="n">residues</span><span class="p">);</span> <span class="n">r</span>
<span class="go">-63/2*sqrt2 - 20</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span>
<span class="gp">....: </span>    <span class="p">(</span><span class="n">r</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">k</span>
<span class="gp">....: </span>    <span class="k">for</span> <span class="n">I</span><span class="p">,</span><span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ideals</span><span class="p">,</span><span class="n">residues</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="k">for</span> <span class="n">P</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="n">I</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="gp">....: </span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.ideals_of_bdd_norm">
<span class="sig-name descname"><span class="pre">ideals_of_bdd_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bound</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.ideals_of_bdd_norm" title="Permalink to this definition">¶</a></dt>
<dd><p>All integral ideals of bounded norm.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bound</span></code> - a positive integer</p></li>
</ul>
<p>OUTPUT: A dict of all integral ideals I such that Norm(I) &lt;= bound,
keyed by norm.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideals_of_bdd_norm</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
<span class="gp">....: </span>    <span class="k">print</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">n</span><span class="p">]):</span>
<span class="gp">....: </span>        <span class="k">print</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="go">1</span>
<span class="go">Fractional ideal (1)</span>
<span class="go">2</span>
<span class="go">Fractional ideal (2, 1/2*a - 1/2)</span>
<span class="go">Fractional ideal (2, 1/2*a + 1/2)</span>
<span class="go">3</span>
<span class="go">Fractional ideal (3, 1/2*a - 1/2)</span>
<span class="go">Fractional ideal (3, 1/2*a + 1/2)</span>
<span class="go">4</span>
<span class="go">Fractional ideal (2)</span>
<span class="go">Fractional ideal (4, 1/2*a + 3/2)</span>
<span class="go">Fractional ideal (4, 1/2*a + 5/2)</span>
<span class="go">5</span>
<span class="go">6</span>
<span class="go">Fractional ideal (1/2*a - 1/2)</span>
<span class="go">Fractional ideal (1/2*a + 1/2)</span>
<span class="go">Fractional ideal (6, 1/2*a + 5/2)</span>
<span class="go">Fractional ideal (6, 1/2*a + 7/2)</span>
<span class="go">7</span>
<span class="go">8</span>
<span class="go">Fractional ideal (4, a - 1)</span>
<span class="go">Fractional ideal (4, a + 1)</span>
<span class="go">Fractional ideal (1/2*a + 3/2)</span>
<span class="go">Fractional ideal (1/2*a - 3/2)</span>
<span class="go">9</span>
<span class="go">Fractional ideal (3)</span>
<span class="go">Fractional ideal (9, 1/2*a + 7/2)</span>
<span class="go">Fractional ideal (9, 1/2*a + 11/2)</span>
<span class="go">10</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.integral_basis">
<span class="sig-name descname"><span class="pre">integral_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.integral_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list containing a ZZ-basis for the full ring of integers
of this number field.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code> - None, a prime, or a list of primes. See the
documentation for self.maximal_order.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">integral_basis</span><span class="p">()</span>
<span class="go">[1, a, a^2, a^3, a^4]</span>
</pre></div>
</div>
<p>Next we compute the ring of integers of a cubic field in which 2 is
an “essential discriminant divisor”, so the ring of integers is not
generated by a single element.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">integral_basis</span><span class="p">()</span>
<span class="go">[1, 1/2*a^2 + 1/2*a, a^2]</span>
</pre></div>
</div>
<p>ALGORITHM: Uses the pari library (via _pari_integral_basis).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.is_CM">
<span class="sig-name descname"><span class="pre">is_CM</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.is_CM" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if self is a CM field (i.e. a totally imaginary
quadratic extension of a totally real field).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_CM</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">is_CM</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">zeta20</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">is_CM</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">omega</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">is_CM</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">sqrt5</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">is_CM</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">is_CM</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">is_CM</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>The following are non-CM totally imaginary fields.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">is_totally_imaginary</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">is_CM</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">F2</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">12</span> <span class="o">-</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">11</span> <span class="o">+</span> <span class="mi">8</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">10</span> <span class="o">-</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">9</span> <span class="o">-</span> \
<span class="go">                           x^8 + 9*x^7 + 7*x^6 - 3*x^5 + 5*x^4 + \</span>
<span class="go">                           7*x^3 - 4*x^2 - 7*x + 7)</span>
<span class="gp">sage: </span><span class="n">F2</span><span class="o">.</span><span class="n">is_totally_imaginary</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">F2</span><span class="o">.</span><span class="n">is_CM</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>The following is a non-cyclotomic CM field.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">is_CM</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Now, we construct a totally imaginary quadratic extension of a
totally real field (which is not cyclotomic).</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E_0</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">7</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> \
<span class="go">                            6*x^2 - x + 1)</span>
<span class="gp">sage: </span><span class="n">E_0</span><span class="o">.</span><span class="n">is_totally_real</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">E_0</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">is_CM</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Finally, a CM field that is given as an extension that is not CM.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E_0</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">16</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">E_0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">E_0</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">E_0</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">is_CM</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">is_CM_extension</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.is_abelian">
<span class="sig-name descname"><span class="pre">is_abelian</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.is_abelian" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this number field is an abelian Galois extension of
<span class="math notranslate nohighlight">\(\QQ\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_abelian</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_abelian</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_abelian</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">40</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1372</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_abelian</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_abelian</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.is_absolute">
<span class="sig-name descname"><span class="pre">is_absolute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.is_absolute" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if self is an absolute field.</p>
<p>This function will be implemented in the derived classes.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">is_absolute</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.is_field">
<span class="sig-name descname"><span class="pre">is_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.is_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True since a number field is a field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_field</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.is_galois">
<span class="sig-name descname"><span class="pre">is_galois</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.is_galois" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this number field is a Galois extension of
<span class="math notranslate nohighlight">\(\QQ\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_galois</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_galois</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">15</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">14</span> <span class="o">-</span> <span class="mi">14</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">13</span> <span class="o">-</span> <span class="mi">13</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">12</span> <span class="o">+</span> <span class="mi">78</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">11</span> <span class="o">+</span> <span class="mi">66</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">10</span> <span class="o">-</span> <span class="mi">220</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">9</span> <span class="o">-</span> <span class="mi">165</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">8</span> <span class="o">+</span> <span class="mi">330</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">7</span> <span class="o">+</span> <span class="mi">210</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">252</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">126</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">84</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">28</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_galois</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">15</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">14</span> <span class="o">-</span> <span class="mi">14</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">13</span> <span class="o">-</span> <span class="mi">13</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">12</span> <span class="o">+</span> <span class="mi">78</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">11</span> <span class="o">+</span> <span class="mi">66</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">10</span> <span class="o">-</span> <span class="mi">220</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">9</span> <span class="o">-</span> <span class="mi">165</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">8</span> <span class="o">+</span> <span class="mi">330</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">7</span> <span class="o">+</span> <span class="mi">210</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">252</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">126</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">84</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">28</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_galois</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.is_isomorphic">
<span class="sig-name descname"><span class="pre">is_isomorphic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isomorphism_maps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.is_isomorphic" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if self is isomorphic as a number field to other.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">is_isomorphic</span> <span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">NumberField</span><span class="p">((</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">))</span>
<span class="go">False</span>

<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">l</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">(False, [])</span>

<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ky</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">k</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">l</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">(True, [-x, x + 1])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.is_relative">
<span class="sig-name descname"><span class="pre">is_relative</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.is_relative" title="Permalink to this definition">¶</a></dt>
<dd><p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">10</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">is_absolute</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">is_relative</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.is_totally_imaginary">
<span class="sig-name descname"><span class="pre">is_totally_imaginary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.is_totally_imaginary" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if self is totally imaginary, and False otherwise.</p>
<p>Totally imaginary means that no isomorphic embedding of self into
the complex numbers has image contained in the real numbers.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_totally_imaginary</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_totally_imaginary</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_totally_imaginary</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.is_totally_real">
<span class="sig-name descname"><span class="pre">is_totally_real</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.is_totally_real" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if self is totally real, and False otherwise.</p>
<p>Totally real means that every isomorphic embedding of self into the
complex numbers has image contained in the real numbers.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_totally_real</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_totally_real</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_totally_real</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.latex_variable_name">
<span class="sig-name descname"><span class="pre">latex_variable_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.latex_variable_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the latex representation of the variable name for this
number field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">latex_variable_name</span><span class="p">()</span>
<span class="go">doctest:...: DeprecationWarning: This method is replaced by ...</span>
<span class="go">See https://trac.sagemath.org/30372 for details.</span>
<span class="go">&#39;a&#39;</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;theta3&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">latex_variable_name</span><span class="p">()</span>
<span class="go">&#39;\theta_{3}&#39;</span>
<span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">latex_variable_name</span><span class="p">()</span>
<span class="go">&#39;\zeta_{5}&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.lmfdb_page">
<span class="sig-name descname"><span class="pre">lmfdb_page</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.lmfdb_page" title="Permalink to this definition">¶</a></dt>
<dd><p>Open the LMFDB web page of the number field in a browser.</p>
<p>See <a class="reference external" href="https://www.lmfdb.org">https://www.lmfdb.org</a></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">lmfdb_page</span><span class="p">()</span>  <span class="c1"># optional -- webbrowser</span>
</pre></div>
</div>
<p>Even if the variable name is different it works:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">,</span> <span class="s2">&quot;i&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">lmfdb_page</span><span class="p">()</span>  <span class="c1"># optional -- webbrowser</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.maximal_totally_real_subfield">
<span class="sig-name descname"><span class="pre">maximal_totally_real_subfield</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.maximal_totally_real_subfield" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the maximal totally real subfield of self together with an embedding of it into self.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">maximal_totally_real_subfield</span><span class="p">()</span>
<span class="go">[Number Field in a with defining polynomial x^2 - 11 with a = 3.316624790355400?,</span>
<span class="go"> Identity endomorphism of Number Field in a with defining polynomial x^2 - 11 with a = 3.316624790355400?]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">maximal_totally_real_subfield</span><span class="p">()</span>
<span class="go">[Rational Field, Natural morphism:</span>
<span class="go">   From: Rational Field</span>
<span class="go">   To:   Number Field in a with defining polynomial x^2 + 15 with a = 3.872983346207417?*I]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">maximal_totally_real_subfield</span><span class="p">()</span>
<span class="go">(Number Field in a0 with defining polynomial x^14 + x^13 - 13*x^12 - 12*x^11 + 66*x^10 + 55*x^9 - 165*x^8 - 120*x^7 + 210*x^6 + 126*x^5 - 126*x^4 - 56*x^3 + 28*x^2 + 7*x - 1 with a0 = 1.953241111420174?,</span>
<span class="go"> Ring morphism:</span>
<span class="go">   From: Number Field in a0 with defining polynomial x^14 + x^13 - 13*x^12 - 12*x^11 + 66*x^10 + 55*x^9 - 165*x^8 - 120*x^7 + 210*x^6 + 126*x^5 - 126*x^4 - 56*x^3 + 28*x^2 + 7*x - 1 with a0 = 1.953241111420174?</span>
<span class="go">   To:   Cyclotomic Field of order 29 and degree 28</span>
<span class="go">   Defn: a0 |--&gt; -a^27 - a^26 - a^25 - a^24 - a^23 - a^22 - a^21 - a^20 - a^19 - a^18 - a^17 - a^16 - a^15 - a^14 - a^13 - a^12 - a^11 - a^10 - a^9 - a^8 - a^7 - a^6 - a^5 - a^4 - a^3 - a^2 - 1)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">maximal_totally_real_subfield</span><span class="p">()</span>
<span class="go">[Rational Field, Coercion map:</span>
<span class="go">   From: Rational Field</span>
<span class="go">   To:   Number Field in a with defining polynomial x^3 - 2]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">maximal_totally_real_subfield</span><span class="p">()</span>
<span class="go">[Rational Field, Coercion map:</span>
<span class="go">   From: Rational Field</span>
<span class="go">   To:   Number Field in a with defining polynomial x^4 - x^3 - x^2 + x + 1]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">maximal_totally_real_subfield</span><span class="p">()</span>
<span class="go">[Number Field in a1 with defining polynomial x^2 - x - 1, Ring morphism:</span>
<span class="go">  From: Number Field in a1 with defining polynomial x^2 - x - 1</span>
<span class="go">  To:   Number Field in a with defining polynomial x^4 - x^3 + 2*x^2 + x + 1</span>
<span class="go">  Defn: a1 |--&gt; -1/2*a^3 - 1/2]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">maximal_totally_real_subfield</span><span class="p">()</span>
<span class="go">[Number Field in a with defining polynomial x^4 - 4*x^2 - x + 1, Identity endomorphism of Number Field in a with defining polynomial x^4 - 4*x^2 - x + 1]</span>
</pre></div>
</div>
<p>An example of a relative extension where the base field is not the maximal totally real subfield.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E_0</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">16</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">E_0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">E_0</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">E_0</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">maximal_totally_real_subfield</span><span class="p">()</span>
<span class="go">[Number Field in z1 with defining polynomial x^2 - 2*x - 5, Composite map:</span>
<span class="go">   From: Number Field in z1 with defining polynomial x^2 - 2*x - 5</span>
<span class="go">   To:   Number Field in z with defining polynomial x^2 - 1/2*a over its base field</span>
<span class="go">   Defn:   Ring morphism:</span>
<span class="go">           From: Number Field in z1 with defining polynomial x^2 - 2*x - 5</span>
<span class="go">           To:   Number Field in z with defining polynomial x^4 - 2*x^3 + x^2 + 6*x + 3</span>
<span class="go">           Defn: z1 |--&gt; -1/3*z^3 + 1/3*z^2 + z - 1</span>
<span class="go">         then</span>
<span class="go">           Isomorphism map:</span>
<span class="go">           From: Number Field in z with defining polynomial x^4 - 2*x^3 + x^2 + 6*x + 3</span>
<span class="go">           To:   Number Field in z with defining polynomial x^2 - 1/2*a over its base field]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.narrow_class_group">
<span class="sig-name descname"><span class="pre">narrow_class_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.narrow_class_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the narrow class group of this field.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> - default: <code class="docutils literal notranslate"><span class="pre">None</span></code> (use the global proof
setting, which defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">narrow_class_group</span><span class="p">()</span>
<span class="go">Multiplicative Abelian group isomorphic to C2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.ngens">
<span class="sig-name descname"><span class="pre">ngens</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.ngens" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of generators of this number field (always 1).</p>
<p>OUTPUT: the python integer 1.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">17</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ngens</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ngens</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">ngens</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="mi">0</span>
<span class="go">-3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.number_of_roots_of_unity">
<span class="sig-name descname"><span class="pre">number_of_roots_of_unity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.number_of_roots_of_unity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of roots of unity in this field.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We do not create the full unit group since that can be
expensive, but we do use it if it is already known.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">alpha</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">22</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">zeta_order</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">alpha</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">zeta_order</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.order">
<span class="sig-name descname"><span class="pre">order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the order of this number field (always +infinity).</p>
<p>OUTPUT: always positive infinity</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">19</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.pari_bnf">
<span class="sig-name descname"><span class="pre">pari_bnf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.pari_bnf" title="Permalink to this definition">¶</a></dt>
<dd><p>PARI big number field corresponding to this field.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> – If <code class="docutils literal notranslate"><span class="pre">False</span></code>, assume GRH.  If <code class="docutils literal notranslate"><span class="pre">True</span></code>, run PARI’s
<a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/bnfcertify">pari:bnfcertify</a> to make sure that the results are correct.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">units</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True)</span> <span class="pre">If</span> <span class="pre">``True</span></code>, insist on having
fundamental units.  If <code class="docutils literal notranslate"><span class="pre">False</span></code>, the units may or may not be
computed.</p></li>
</ul>
<p>OUTPUT:</p>
<p>The PARI <code class="docutils literal notranslate"><span class="pre">bnf</span></code> structure of this number field.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Even with <code class="docutils literal notranslate"><span class="pre">proof=True</span></code>, I wouldn’t trust this to mean
that everything computed involving this number field is
actually correct.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span> <span class="n">k</span>
<span class="go">Number Field in a with defining polynomial x^2 + 1</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">pari_bnf</span><span class="p">())</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">pari_bnf</span><span class="p">()[:</span><span class="mi">4</span><span class="p">]</span>
<span class="go">[[;], matrix(0,3), [;], ...]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">pari_nf</span><span class="p">())</span>
<span class="go">9</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">7</span> <span class="o">+</span> <span class="mi">7</span><span class="p">);</span> <span class="n">k</span>
<span class="go">Number Field in a with defining polynomial x^7 + 7</span>
<span class="gp">sage: </span><span class="n">dummy</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">pari_bnf</span><span class="p">(</span><span class="n">proof</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.pari_nf">
<span class="sig-name descname"><span class="pre">pari_nf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">important</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.pari_nf" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the PARI number field corresponding to this field.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">important</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>).  If <code class="docutils literal notranslate"><span class="pre">False</span></code>,
raise a <code class="docutils literal notranslate"><span class="pre">RuntimeError</span></code> if we need to do a difficult
discriminant factorization.  This is useful when an integral
basis is not strictly required, such as for factoring
polynomials over this number field.</p></li>
</ul>
<p>OUTPUT:</p>
<p>The PARI number field obtained by calling the PARI function
<a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/nfinit">pari:nfinit</a> with <code class="docutils literal notranslate"><span class="pre">self.pari_polynomial('y')</span></code> as argument.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method has the same effect as <code class="docutils literal notranslate"><span class="pre">pari(self)</span></code>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">7</span><span class="p">);</span> <span class="n">k</span>
<span class="go">Number Field in a with defining polynomial x^4 - 3*x + 7</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">pari_nf</span><span class="p">()[:</span><span class="mi">4</span><span class="p">]</span>
<span class="go">[y^4 - 3*y + 7, [0, 2], 85621, 1]</span>
<span class="gp">sage: </span><span class="n">pari</span><span class="p">(</span><span class="n">k</span><span class="p">)[:</span><span class="mi">4</span><span class="p">]</span>
<span class="go">[y^4 - 3*y + 7, [0, 2], 85621, 1]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5</span><span class="o">/</span><span class="mi">3</span><span class="p">);</span> <span class="n">k</span>
<span class="go">Number Field in a with defining polynomial x^4 - 3/2*x + 5/3</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">pari_nf</span><span class="p">()</span>
<span class="go">[y^4 - 324*y + 2160, [0, 2], 48918708, 216, ..., [36, 36*y, y^3 + 6*y^2 - 252, 6*y^2], [1, 0, 0, 252; 0, 1, 0, 0; 0, 0, 0, 36; 0, 0, 6, -36], [1, 0, 0, 0, 0, 0, -18, 42, 0, -18, -46, -60, 0, 42, -60, -60; 0, 1, 0, 0, 1, 0, 2, 0, 0, 2, -11, -1, 0, 0, -1, 9; 0, 0, 1, 0, 0, 0, 6, 6, 1, 6, -5, 0, 0, 6, 0, 0; 0, 0, 0, 1, 0, 6, -6, -6, 0, -6, -1, 2, 1, -6, 2, 0]]</span>
<span class="gp">sage: </span><span class="n">pari</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="go">[y^4 - 324*y + 2160, [0, 2], 48918708, 216, ...]</span>
<span class="gp">sage: </span><span class="n">gp</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="go">[y^4 - 324*y + 2160, [0, 2], 48918708, 216, ...]</span>
</pre></div>
</div>
<p>With <code class="docutils literal notranslate"><span class="pre">important=False</span></code>, we simply bail out if we cannot
easily factor the discriminant:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">40</span><span class="p">);</span> <span class="n">q</span> <span class="o">=</span> <span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">41</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">pari_nf</span><span class="p">(</span><span class="n">important</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">RuntimeError: Unable to factor discriminant with trial division</span>
</pre></div>
</div>
<p>Next, we illustrate the <code class="docutils literal notranslate"><span class="pre">maximize_at_primes</span></code> and <code class="docutils literal notranslate"><span class="pre">assume_disc_small</span></code>
parameters of the <code class="docutils literal notranslate"><span class="pre">NumberField</span></code> constructor. The following would take
a very long time without the <code class="docutils literal notranslate"><span class="pre">maximize_at_primes</span></code> option:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="p">,</span> <span class="n">maximize_at_primes</span><span class="o">=</span><span class="p">[</span><span class="n">p</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">pari_nf</span><span class="p">()</span>
<span class="go">[y^2 - 100000000000000000000...]</span>
</pre></div>
</div>
<p>Since the discriminant is square-free, this also works:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="p">,</span> <span class="n">assume_disc_small</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">pari_nf</span><span class="p">()</span>
<span class="go">[y^2 - 100000000000000000000...]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.pari_polynomial">
<span class="sig-name descname"><span class="pre">pari_polynomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.pari_polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the PARI polynomial corresponding to this number field.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> – variable name (default: <code class="docutils literal notranslate"><span class="pre">'x'</span></code>)</p></li>
</ul>
<p>OUTPUT:</p>
<p>A monic polynomial with integral coefficients (PARI <code class="docutils literal notranslate"><span class="pre">t_POL</span></code>)
defining the PARI number field corresponding to <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is <em>not</em> the same as simply converting the defining
polynomial to PARI.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">5</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">pari_polynomial</span><span class="p">()</span>
<span class="go">x^2 - x + 40</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">polynomial</span><span class="p">()</span><span class="o">.</span><span class="n">__pari__</span><span class="p">()</span>
<span class="go">x^2 - 3/2*x + 5/3</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">pari_polynomial</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">a^2 - a + 40</span>
</pre></div>
</div>
<p>Some examples with relative number fields:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">pari_polynomial</span><span class="p">()</span>
<span class="go">x^4 + 8*x^2 + 4</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">pari_polynomial</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">a^4 + 8*a^2 + 4</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">absolute_polynomial</span><span class="p">()</span>
<span class="go">x^4 + 8*x^2 + 4</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">relative_polynomial</span><span class="p">()</span>
<span class="go">x^2 + 3</span>

<span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">pari_polynomial</span><span class="p">()</span>
<span class="go">x^4 - x^2 + 1</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">absolute_polynomial</span><span class="p">()</span>
<span class="go">x^4 - x^2 + 1</span>
</pre></div>
</div>
<p>This fails with arguments which are not a valid PARI variable name:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">pari_polynomial</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">PariError: I already exists with incompatible valence</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">pari_polynomial</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">)</span>
<span class="go">i^2 + 1</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">pari_polynomial</span><span class="p">(</span><span class="s1">&#39;theta&#39;</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">PariError: theta already exists with incompatible valence</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.pari_rnfnorm_data">
<span class="sig-name descname"><span class="pre">pari_rnfnorm_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.pari_rnfnorm_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the PARI <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/rnfisnorminit">pari:rnfisnorminit</a> data corresponding to the
extension L/self.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;gamma&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ls</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">pari_rnfnorm_data</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="p">;</span> <span class="nb">len</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
<span class="go">8</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">X</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">X</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ls</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">pari_rnfnorm_data</span><span class="p">(</span><span class="n">L</span><span class="p">);</span> <span class="nb">len</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
<span class="go">8</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.pari_zk">
<span class="sig-name descname"><span class="pre">pari_zk</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.pari_zk" title="Permalink to this definition">¶</a></dt>
<dd><p>Integral basis of the PARI number field corresponding to this field.</p>
<p>This is the same as pari_nf().getattr(‘zk’), but much faster.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">17</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">pari_zk</span><span class="p">()</span>
<span class="go">[1, 1/3*y^2 - 1/3*y + 1/3, y]</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">pari_nf</span><span class="p">()</span><span class="o">.</span><span class="n">getattr</span><span class="p">(</span><span class="s1">&#39;zk&#39;</span><span class="p">)</span>
<span class="go">[1, 1/3*y^2 - 1/3*y + 1/3, y]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.polynomial">
<span class="sig-name descname"><span class="pre">polynomial</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the defining polynomial of this number field.</p>
<p>This is exactly the same as
<code class="docutils literal notranslate"><span class="pre">self.defining_polynomial()</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">9</span><span class="o">/</span><span class="mi">17</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">polynomial</span><span class="p">()</span>
<span class="go">x^2 + 2/3*x - 9/17</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.polynomial_ntl">
<span class="sig-name descname"><span class="pre">polynomial_ntl</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.polynomial_ntl" title="Permalink to this definition">¶</a></dt>
<dd><p>Return defining polynomial of this number field as a pair, an ntl
polynomial and a denominator.</p>
<p>This is used mainly to implement some internal arithmetic.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">9</span><span class="o">/</span><span class="mi">17</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">polynomial_ntl</span><span class="p">()</span>
<span class="go">([-27 34 51], 51)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.polynomial_quotient_ring">
<span class="sig-name descname"><span class="pre">polynomial_quotient_ring</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.polynomial_quotient_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the polynomial quotient ring isomorphic to this number
field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">polynomial_quotient_ring</span><span class="p">()</span>
<span class="go">Univariate Quotient Polynomial Ring in alpha over Rational Field with modulus x^3 + 2*x - 5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.polynomial_ring">
<span class="sig-name descname"><span class="pre">polynomial_ring</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.polynomial_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the polynomial ring that we view this number field as being
a quotient of (by a principal ideal).</p>
<p>EXAMPLES: An example with an absolute field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">polynomial_ring</span><span class="p">()</span>
<span class="go">Univariate Polynomial Ring in y over Rational Field</span>
</pre></div>
</div>
<p>An example with a relative field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">97</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]);</span> <span class="n">M</span>
<span class="go">Number Field in a0 with defining polynomial y^3 + 97 over its base field</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">polynomial_ring</span><span class="p">()</span>
<span class="go">Univariate Polynomial Ring in y over Number Field in a1 with defining polynomial y^2 + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.power_basis">
<span class="sig-name descname"><span class="pre">power_basis</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.power_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a power basis for this number field over its base field.</p>
<p>If this number field is represented as <span class="math notranslate nohighlight">\(k[t]/f(t)\)</span>, then
the basis returned is <span class="math notranslate nohighlight">\(1, t, t^2, \ldots, t^{d-1}\)</span> where
<span class="math notranslate nohighlight">\(d\)</span> is the degree of this number field over its base
field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">power_basis</span><span class="p">()</span>
<span class="go">[1, a, a^2, a^3, a^4]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">power_basis</span><span class="p">()</span>
<span class="go">[1, b]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">absolute_field</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">power_basis</span><span class="p">()</span>
<span class="go">[1, c, c^2, c^3, c^4, c^5, c^6, c^7, c^8, c^9]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">power_basis</span><span class="p">()</span>
<span class="go">[1, zeta15, zeta15^2, zeta15^3, zeta15^4, zeta15^5, zeta15^6, zeta15^7]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.prime_above">
<span class="sig-name descname"><span class="pre">prime_above</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.prime_above" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a prime ideal of self lying over x.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code>: usually an element or ideal of self. It
should be such that self.ideal(x) is sensible. This excludes x=0.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">degree</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>): <code class="docutils literal notranslate"><span class="pre">None</span></code> or an integer.
If one, find a prime above x of any degree. If an integer, find a
prime above x such that the resulting residue field has exactly
this degree.</p></li>
</ul>
<p>OUTPUT: A prime ideal of self lying over x. If degree is specified
and no such ideal exists, raises a ValueError.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">prime_above</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P2</span> <span class="c1"># random</span>
<span class="go">Fractional ideal (-t)</span>
<span class="gp">sage: </span><span class="mi">2</span> <span class="ow">in</span> <span class="n">P2</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P3</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">prime_above</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P3</span> <span class="c1"># random</span>
<span class="go">Fractional ideal (t + 1)</span>
<span class="gp">sage: </span><span class="mi">3</span> <span class="ow">in</span> <span class="n">P3</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P3</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P3</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
<p>The ideal (3) is totally ramified in F, so there is no degree 2
prime above 3:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">prime_above</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: No prime of degree 2 above Fractional ideal (3)</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="nb">id</span><span class="o">.</span><span class="n">residue_class_degree</span><span class="p">()</span> <span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">F</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span> <span class="p">]</span>
<span class="go">[1]</span>
</pre></div>
</div>
<p>Asking for a specific degree works:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P5_1</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">prime_above</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P5_1</span> <span class="c1"># random</span>
<span class="go">Fractional ideal (-t^2 - 1)</span>
<span class="gp">sage: </span><span class="n">P5_1</span><span class="o">.</span><span class="n">residue_class_degree</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P5_2</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">prime_above</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P5_2</span> <span class="c1"># random</span>
<span class="go">Fractional ideal (t^2 - 2*t - 1)</span>
<span class="gp">sage: </span><span class="n">P5_2</span><span class="o">.</span><span class="n">residue_class_degree</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Relative number fields are ok:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">prime_above</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">Fractional ideal (b + 2)</span>
</pre></div>
</div>
<p>It doesn’t make sense to factor the ideal (0):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">prime_above</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">AttributeError: &#39;NumberFieldIdeal&#39; object has no attribute &#39;prime_factors&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.prime_factors">
<span class="sig-name descname"><span class="pre">prime_factors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.prime_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of the prime ideals of self which divide
the ideal generated by <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>OUTPUT: list of prime ideals (a new list is returned each time this
function is called)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">prime_factors</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">[Fractional ideal (2, 1/2*w - 1/2), Fractional ideal (2, 1/2*w + 1/2), Fractional ideal (3, 1/2*w + 1/2)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.primes_above">
<span class="sig-name descname"><span class="pre">primes_above</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.primes_above" title="Permalink to this definition">¶</a></dt>
<dd><p>Return prime ideals of self lying over x.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code>: usually an element or ideal of self. It
should be such that self.ideal(x) is sensible. This excludes x=0.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">degree</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>): <code class="docutils literal notranslate"><span class="pre">None</span></code> or an integer.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, find all primes above x of any degree. If an
integer, find all primes above x such that the resulting
residue field has exactly this degree.</p></li>
</ul>
<p>OUTPUT: A list of prime ideals of self lying over x. If degree
is specified and no such ideal exists, returns the empty list.
The output is sorted by residue degree first, then by
underlying prime (or equivalently, by norm).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2s</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P2s</span> <span class="c1"># random</span>
<span class="go">[Fractional ideal (-t)]</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="mi">2</span> <span class="ow">in</span> <span class="n">P2</span> <span class="k">for</span> <span class="n">P2</span> <span class="ow">in</span> <span class="n">P2s</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">P2</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span> <span class="k">for</span> <span class="n">P2</span> <span class="ow">in</span> <span class="n">P2s</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="n">P2</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="k">for</span> <span class="n">P2</span> <span class="ow">in</span> <span class="n">P2s</span> <span class="p">]</span>
<span class="go">[2]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P3s</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P3s</span> <span class="c1"># random</span>
<span class="go">[Fractional ideal (t + 1)]</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="mi">3</span> <span class="ow">in</span> <span class="n">P3</span> <span class="k">for</span> <span class="n">P3</span> <span class="ow">in</span> <span class="n">P3s</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">P3</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span> <span class="k">for</span> <span class="n">P3</span> <span class="ow">in</span> <span class="n">P3s</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="n">P3</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="k">for</span> <span class="n">P3</span> <span class="ow">in</span> <span class="n">P3s</span> <span class="p">]</span>
<span class="go">[3]</span>
</pre></div>
</div>
<p>The ideal (3) is totally ramified in F, so there is no degree 2
prime above 3:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="nb">id</span><span class="o">.</span><span class="n">residue_class_degree</span><span class="p">()</span> <span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">F</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span> <span class="p">]</span>
<span class="go">[1]</span>
</pre></div>
</div>
<p>Asking for a specific degree works:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P5_1s</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P5_1s</span> <span class="c1"># random</span>
<span class="go">[Fractional ideal (-t^2 - 1)]</span>
<span class="gp">sage: </span><span class="n">P5_1</span> <span class="o">=</span> <span class="n">P5_1s</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">P5_1</span><span class="o">.</span><span class="n">residue_class_degree</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P5_2s</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P5_2s</span> <span class="c1"># random</span>
<span class="go">[Fractional ideal (t^2 - 2*t - 1)]</span>
<span class="gp">sage: </span><span class="n">P5_2</span> <span class="o">=</span> <span class="n">P5_2s</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">P5_2</span><span class="o">.</span><span class="n">residue_class_degree</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Works in relative extensions too:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">PQ</span><span class="o">.&lt;</span><span class="n">X</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">X</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">X</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">PF</span><span class="o">.&lt;</span><span class="n">Y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">F</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">c</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">Y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">,</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">Q</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">P</span><span class="p">]</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="n">Q</span><span class="p">]</span>
<span class="go">True</span>
</pre></div>
</div>
<p>It doesn’t make sense to factor the ideal (0), so this raises an error:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">prime_above</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">AttributeError: &#39;NumberFieldIdeal&#39; object has no attribute &#39;prime_factors&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.primes_of_bounded_norm">
<span class="sig-name descname"><span class="pre">primes_of_bounded_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.primes_of_bounded_norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a sorted list of all prime ideals with norm at most <span class="math notranslate nohighlight">\(B\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">B</span></code> – a positive integer or real; upper bound on the norms of the
primes generated.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A list of all prime ideals of this number field of norm at
most <span class="math notranslate nohighlight">\(B\)</span>, sorted by norm.  Primes of the same norm are sorted
using the comparison function for ideals, which is based on
the Hermite Normal Form.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See also <a class="reference internal" href="#sage.rings.number_field.number_field.NumberField_generic.primes_of_bounded_norm_iter" title="sage.rings.number_field.number_field.NumberField_generic.primes_of_bounded_norm_iter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">primes_of_bounded_norm_iter()</span></code></a> for an
iterator version of this, but note that the iterator sorts
the primes in order of underlying rational prime, not by
norm.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">primes_of_bounded_norm</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[Fractional ideal (i + 1), Fractional ideal (-i - 2), Fractional ideal (2*i + 1), Fractional ideal (3)]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">primes_of_bounded_norm</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_of_bounded_norm</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span>
<span class="go">[Fractional ideal (a),</span>
<span class="go"> Fractional ideal (a + 1),</span>
<span class="go"> Fractional ideal (-a^2 - 1),</span>
<span class="go"> Fractional ideal (a^2 + a - 1),</span>
<span class="go"> Fractional ideal (2*a + 1),</span>
<span class="go"> Fractional ideal (-2*a^2 - a - 1),</span>
<span class="go"> Fractional ideal (a^2 - 2*a - 1),</span>
<span class="go"> Fractional ideal (a + 3)]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">P</span><span class="p">]</span>
<span class="go">[2, 3, 5, 11, 17, 23, 25, 29]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.primes_of_bounded_norm_iter">
<span class="sig-name descname"><span class="pre">primes_of_bounded_norm_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.primes_of_bounded_norm_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterator yielding all prime ideals with norm at most <span class="math notranslate nohighlight">\(B\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">B</span></code> – a positive integer or real; upper bound on the norms of the
primes generated.</p></li>
</ul>
<p>OUTPUT:</p>
<p>An iterator over all prime ideals of this number field of norm
at most <span class="math notranslate nohighlight">\(B\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The output is not sorted by norm, but by size of the
underlying rational prime.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">it</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_of_bounded_norm_iter</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<span class="go">[Fractional ideal (i + 1),</span>
<span class="go"> Fractional ideal (3),</span>
<span class="go"> Fractional ideal (-i - 2),</span>
<span class="go"> Fractional ideal (2*i + 1)]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">primes_of_bounded_norm_iter</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.primes_of_degree_one_iter">
<span class="sig-name descname"><span class="pre">primes_of_degree_one_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_integer_primes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.primes_of_degree_one_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an iterator yielding prime ideals of absolute degree one and
small norm.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is possible that there are no primes of <span class="math notranslate nohighlight">\(K\)</span> of
absolute degree one of small prime norm, and it possible
that this algorithm will not find any primes of small norm.</p>
<p>See module <a class="reference internal" href="small_primes_of_degree_one.html#module-sage.rings.number_field.small_primes_of_degree_one" title="sage.rings.number_field.small_primes_of_degree_one"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.rings.number_field.small_primes_of_degree_one</span></code></a>
for details.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">num_integer_primes</span> <span class="pre">(default:</span> <span class="pre">10000)</span></code> - an
integer. We try to find primes of absolute norm no greater than the
num_integer_primes-th prime number. For example, if
num_integer_primes is 2, the largest norm found will be 3, since
the second prime is 3.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_iterations</span> <span class="pre">(default:</span> <span class="pre">100)</span></code> - an integer. We
test max_iterations integers to find small primes before raising
StopIteration.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">it</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_of_degree_one_iter</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Ps</span> <span class="o">=</span> <span class="p">[</span> <span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">]</span>
<span class="gp">sage: </span><span class="n">Ps</span> <span class="c1"># random</span>
<span class="go">[Fractional ideal (z^3 + z + 1), Fractional ideal (3*z^3 - z^2 + z - 1), Fractional ideal (2*z^3 - 3*z^2 + z - 2)]</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="n">P</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="k">for</span> <span class="n">P</span> <span class="ow">in</span> <span class="n">Ps</span> <span class="p">]</span> <span class="c1"># random</span>
<span class="go">[11, 31, 41]</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="n">P</span><span class="o">.</span><span class="n">residue_class_degree</span><span class="p">()</span> <span class="k">for</span> <span class="n">P</span> <span class="ow">in</span> <span class="n">Ps</span> <span class="p">]</span>
<span class="go">[1, 1, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.primes_of_degree_one_list">
<span class="sig-name descname"><span class="pre">primes_of_degree_one_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_integer_primes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.primes_of_degree_one_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of n prime ideals of absolute degree one and small
norm.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is possible that there are no primes of <span class="math notranslate nohighlight">\(K\)</span> of
absolute degree one of small prime norm, and it possible
that this algorithm will not find any primes of small norm.</p>
<p>See module <a class="reference internal" href="small_primes_of_degree_one.html#module-sage.rings.number_field.small_primes_of_degree_one" title="sage.rings.number_field.small_primes_of_degree_one"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.rings.number_field.small_primes_of_degree_one</span></code></a>
for details.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">num_integer_primes</span> <span class="pre">(default:</span> <span class="pre">10000)</span></code> - an
integer. We try to find primes of absolute norm no greater than the
num_integer_primes-th prime number. For example, if
num_integer_primes is 2, the largest norm found will be 3, since
the second prime is 3.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_iterations</span> <span class="pre">(default:</span> <span class="pre">100)</span></code> - an integer. We
test max_iterations integers to find small primes before raising
StopIteration.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Ps</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_of_degree_one_list</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Ps</span>  <span class="c1"># random output</span>
<span class="go">[Fractional ideal (-z^3 - z^2 + 1), Fractional ideal (2*z^3 - 2*z^2 + 2*z - 3), Fractional ideal (2*z^3 - 3*z^2 + z - 2)]</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="n">P</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="k">for</span> <span class="n">P</span> <span class="ow">in</span> <span class="n">Ps</span> <span class="p">]</span>
<span class="go">[11, 31, 41]</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="n">P</span><span class="o">.</span><span class="n">residue_class_degree</span><span class="p">()</span> <span class="k">for</span> <span class="n">P</span> <span class="ow">in</span> <span class="n">Ps</span> <span class="p">]</span>
<span class="go">[1, 1, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.primitive_element">
<span class="sig-name descname"><span class="pre">primitive_element</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.primitive_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a primitive element for this field, i.e., an element that
generates it over <span class="math notranslate nohighlight">\(\QQ\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">primitive_element</span><span class="p">()</span>
<span class="go">a</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">primitive_element</span><span class="p">()</span>
<span class="go">a - b + c</span>
<span class="gp">sage: </span><span class="n">alpha</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primitive_element</span><span class="p">();</span> <span class="n">alpha</span>
<span class="go">a - b + c</span>
<span class="gp">sage: </span><span class="n">alpha</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>
<span class="go">x^2 + (2*b - 2*c)*x - 2*c*b + 6</span>
<span class="gp">sage: </span><span class="n">alpha</span><span class="o">.</span><span class="n">absolute_minpoly</span><span class="p">()</span>
<span class="go">x^8 - 40*x^6 + 352*x^4 - 960*x^2 + 576</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.primitive_root_of_unity">
<span class="sig-name descname"><span class="pre">primitive_root_of_unity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.primitive_root_of_unity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a generator of the roots of unity in this field.</p>
<p>OUTPUT: a primitive root of unity. No guarantee is made about
which primitive root of unity this returns, not even for
cyclotomic fields. Repeated calls of this function may return
a different value.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We do not create the full unit group since that can be
expensive, but we do use it if it is already known.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primitive_root_of_unity</span><span class="p">();</span> <span class="n">z</span>
<span class="go">i</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">()</span>
<span class="go">4</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primitive_root_of_unity</span><span class="p">();</span> <span class="n">z</span>
<span class="go">a + 1</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">()</span>
<span class="go">6</span>

<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">c</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">primitive_root_of_unity</span><span class="p">()</span>
<span class="go">-1</span>
</pre></div>
</div>
<p>We do not special-case cyclotomic fields, so we do not always
get the most obvious primitive root of unity:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primitive_root_of_unity</span><span class="p">();</span> <span class="n">z</span>
<span class="go">a + 1</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">()</span>
<span class="go">6</span>

<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primitive_root_of_unity</span><span class="p">();</span> <span class="n">z</span>
<span class="go">zeta3 + 1</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">()</span>
<span class="go">6</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.quadratic_defect">
<span class="sig-name descname"><span class="pre">quadratic_defect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.quadratic_defect" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the valuation of the quadratic defect of <span class="math notranslate nohighlight">\(a\)</span> at <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code> – an element of <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime ideal</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); check if <span class="math notranslate nohighlight">\(p\)</span> is prime</p></li>
</ul>
<p>ALGORITHM:</p>
<p>This is an implementation of Algorithm 3.1.3 from <a class="reference internal" href="../../../../references/index.html#kir2016" id="id4"><span>[Kir2016]</span></a></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">quadratic_defect</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">quadratic_defect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">quadratic_defect</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">quadratic_defect</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.random_element">
<span class="sig-name descname"><span class="pre">random_element</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">den_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integral_coefficients</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.random_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a random element of this number field.</p>
<p>INPUT:</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">num_bound</span></code> - Bound on numerator of the coefficients of</dt><dd><p>the resulting element</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">den_bound</span></code> - Bound on denominators of the coefficients</dt><dd><p>of the resulting element</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">integral_coefficients</span></code> (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) - If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then</dt><dd><p>the resulting element will have integral
coefficients. This option overrides any
value of <span class="math notranslate nohighlight">\(den_bound\)</span>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">distribution</span></code> - Distribution to use for the coefficients</dt><dd><p>of the resulting element</p>
</dd>
</dl>
</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>Element of this number field</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">j</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">8</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="go">1/2*j^7 - j^6 - 12*j^5 + 1/2*j^4 - 1/95*j^3 - 1/2*j^2 - 4</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="go">((6136*c - 7489/3)*b + 5825/3*c - 71422/3)*a + (-4849/3*c + 58918/3)*b - 45718/3*c + 75409/12</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">integral_coefficients</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">a^3 + a^2 - 3*a - 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.real_embeddings">
<span class="sig-name descname"><span class="pre">real_embeddings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">53</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.real_embeddings" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all homomorphisms of this number field into the approximate
real field with precision prec.</p>
<p>If prec is 53 (the default), then the real double field is
used; otherwise the arbitrary precision (but slow) real field
is used.  If you want embeddings into the 53-bit double
precision, which is faster, use <code class="docutils literal notranslate"><span class="pre">self.embeddings(RDF)</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function uses finite precision real numbers.
In functions that should output proven results, one
could use <code class="docutils literal notranslate"><span class="pre">self.embeddings(AA)</span></code> instead.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">real_embeddings</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial x^3 + 2</span>
<span class="go">  To:   Real Field with 53 bits of precision</span>
<span class="go">  Defn: a |--&gt; -1.25992104989487</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">real_embeddings</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial x^3 + 2</span>
<span class="go">  To:   Real Field with 16 bits of precision</span>
<span class="go">  Defn: a |--&gt; -1.260</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">real_embeddings</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial x^3 + 2</span>
<span class="go">  To:   Real Field with 100 bits of precision</span>
<span class="go">  Defn: a |--&gt; -1.2599210498948731647672106073</span>
<span class="go">]</span>
</pre></div>
</div>
<p>As this is a numerical function, the number of embeddings
may be incorrect if the precision is too low:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="mi">10</span><span class="o">^</span><span class="mi">1000</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">10</span><span class="o">^</span><span class="mi">2000</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">real_embeddings</span><span class="p">())</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">real_embeddings</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">real_embeddings</span><span class="p">(</span><span class="mi">10000</span><span class="p">))</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">AA</span><span class="p">))</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.reduced_basis">
<span class="sig-name descname"><span class="pre">reduced_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.reduced_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an LLL-reduced basis for the Minkowski-embedding
of the maximal order of a number field.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) - the precision with which to
compute the Minkowski embedding.</p></li>
</ul>
<p>OUTPUT:</p>
<p>An LLL-reduced basis for the Minkowski-embedding of the
maximal order of a number field, given by a sequence of (integral)
elements from the field.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the non-totally-real case, the LLL routine we call is
currently PARI’s <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/qflll">pari:qflll</a>, which works with floating point
approximations, and so the result is only as good as the
precision promised by PARI. The matrix returned will always
be integral; however, it may only be only “almost” LLL-reduced
when the precision is not sufficiently high.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">11</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">[1/2*t^5 + 1/2*t^4 + 1/2*t^2 + 1/2, t, t^2, t^3, t^4, t^5]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">reduced_basis</span><span class="p">()</span>
<span class="go">[-1, -1/2*t^5 + 1/2*t^4 + 3*t^3 - 3/2*t^2 - 4*t - 1/2, t, 1/2*t^5 + 1/2*t^4 - 4*t^3 - 5/2*t^2 + 7*t + 1/2, 1/2*t^5 - 1/2*t^4 - 2*t^3 + 3/2*t^2 - 1/2, 1/2*t^5 - 1/2*t^4 - 3*t^3 + 5/2*t^2 + 4*t - 5/2]</span>
<span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">reduced_basis</span><span class="p">()</span>
<span class="go">[1, zeta12^2, zeta12, zeta12^3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.reduced_gram_matrix">
<span class="sig-name descname"><span class="pre">reduced_gram_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.reduced_gram_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Gram matrix of an LLL-reduced basis for
the Minkowski embedding of the maximal order of a number field.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) - the precision with which
to calculate the Minkowski embedding. (See NOTE below.)</p></li>
</ul>
<p>OUTPUT: The Gram matrix <span class="math notranslate nohighlight">\([\langle x_i,x_j \rangle]\)</span> of an LLL reduced
basis for the maximal order of self, where the integral basis for
self is given by <span class="math notranslate nohighlight">\(\{x_0, \dots, x_{n-1}\}\)</span>. Here <span class="math notranslate nohighlight">\(\langle , \rangle\)</span> is
the usual inner product on <span class="math notranslate nohighlight">\(\RR^n\)</span>, and self is embedded in <span class="math notranslate nohighlight">\(\RR^n\)</span> by
the Minkowski embedding. See the docstring for
<a class="reference internal" href="#sage.rings.number_field.number_field.NumberField_absolute.minkowski_embedding" title="sage.rings.number_field.number_field.NumberField_absolute.minkowski_embedding"><code class="xref py py-meth docutils literal notranslate"><span class="pre">NumberField_absolute.minkowski_embedding()</span></code></a> for more information.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the non-totally-real case, the LLL routine we call is
currently PARI’s <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/qflll">pari:qflll</a>, which works with floating point
approximations, and so the result is only as good as the
precision promised by PARI. In particular, in this case,
the returned matrix will <em>not</em> be integral, and may not
have enough precision to recover the correct gram matrix
(which is known to be integral for theoretical
reasons). Thus the need for the prec flag above.</p>
</div>
<p>If the following run-time error occurs: “PariError: not a definite
matrix in lllgram (42)” try increasing the prec parameter,</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">11</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">reduced_gram_matrix</span><span class="p">()</span>
<span class="go">[ 6  3  0  2  0  1]</span>
<span class="go">[ 3  9  0  1  0 -2]</span>
<span class="go">[ 0  0 14  6 -2  3]</span>
<span class="go">[ 2  1  6 16 -3  3]</span>
<span class="go">[ 0  0 -2 -3 16  6]</span>
<span class="go">[ 1 -2  3  3  6 19]</span>
<span class="gp">sage: </span><span class="n">Matrix</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="p">[(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">F</span><span class="o">.</span><span class="n">integral_basis</span><span class="p">()</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">F</span><span class="o">.</span><span class="n">integral_basis</span><span class="p">()])</span>
<span class="go">[2550  133  259  664 1368 3421]</span>
<span class="go">[ 133   14    3   54   30  233]</span>
<span class="go">[ 259    3   54   30  233  217]</span>
<span class="go">[ 664   54   30  233  217 1078]</span>
<span class="go">[1368   30  233  217 1078 1371]</span>
<span class="go">[3421  233  217 1078 1371 5224]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">alpha</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">712312</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">131001238</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">reduced_gram_matrix</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
<span class="go">[   4.0000000000000000000000000000000000000   0.00000000000000000000000000000000000000   -1.9999999999999999999999999999999999037  -0.99999999999999999999999999999999383702]</span>
<span class="go">[  0.00000000000000000000000000000000000000    46721.539331563218381658483353092335550   -11488.910026551724275122749703614966768   -418.12718083977141198754424579680468382]</span>
<span class="go">[  -1.9999999999999999999999999999999999037   -11488.910026551724275122749703614966768  5.5658915310500611768713076521847709187e8  1.4179092271494070050433368847682152174e8]</span>
<span class="go">[ -0.99999999999999999999999999999999383702   -418.12718083977141198754424579680468382  1.4179092271494070050433368847682152174e8 1.3665897267919181137884111201405279175e12]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.regulator">
<span class="sig-name descname"><span class="pre">regulator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.regulator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the regulator of this number field.</p>
<p>Note that PARI computes the regulator to higher precision than the
Sage default.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> - default: <code class="docutils literal notranslate"><span class="pre">True</span></code>, unless you set it otherwise.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">regulator</span><span class="p">()</span>
<span class="go">0.881373587019543</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">regulator</span><span class="p">()</span>
<span class="go">0.962423650119207</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.residue_field">
<span class="sig-name descname"><span class="pre">residue_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.residue_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the residue field of this number field at a given prime, ie
<span class="math notranslate nohighlight">\(O_K / p O_K\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">prime</span></code> - a prime ideal of the maximal order in
this number field, or an element of the field which generates a
principal prime ideal.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">names</span></code> - the name of the variable in the residue
field</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> - whether or not to check the primality of
prime.</p></li>
</ul>
<p>OUTPUT: The residue field at this prime.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">17</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">61</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">residue_field</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">Residue field in abar of Fractional ideal (61, a^2 + 30)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">residue_field</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>
<span class="go">Residue field of Fractional ideal (i + 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.roots_of_unity">
<span class="sig-name descname"><span class="pre">roots_of_unity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.roots_of_unity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all the roots of unity in this field, primitive or not.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">zs</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">roots_of_unity</span><span class="p">();</span> <span class="n">zs</span>
<span class="go">[b, -1, -b, 1]</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="n">z</span><span class="o">**</span><span class="n">K</span><span class="o">.</span><span class="n">number_of_roots_of_unity</span><span class="p">()</span> <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">zs</span> <span class="p">]</span>
<span class="go">[1, 1, 1, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.selmer_generators">
<span class="sig-name descname"><span class="pre">selmer_generators</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orders</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.selmer_generators" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute generators of the group <span class="math notranslate nohighlight">\(K(S,m)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">S</span></code> – a set of primes of <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> – a positive integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> – if False, assume the GRH in computing the class group</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">orders</span></code> (default False) – if True, output two lists, the
generators and their orders</p></li>
</ul>
<p>OUTPUT:</p>
<p>A list of generators of <span class="math notranslate nohighlight">\(K(S,m)\)</span>, and (optionally) their
orders as elements of <span class="math notranslate nohighlight">\(K^\times/(K^\times)^m\)</span>.  This is the
subgroup of <span class="math notranslate nohighlight">\(K^\times/(K^\times)^m\)</span> consisting of elements <span class="math notranslate nohighlight">\(a\)</span>
such that the valuation of <span class="math notranslate nohighlight">\(a\)</span> is divisible by <span class="math notranslate nohighlight">\(m\)</span> at all
primes not in <span class="math notranslate nohighlight">\(S\)</span>.  It fits in an exact sequence between the
units modulo <span class="math notranslate nohighlight">\(m\)</span>-th powers and the <span class="math notranslate nohighlight">\(m\)</span>-torsion in the
<span class="math notranslate nohighlight">\(S\)</span>-class group:</p>
<div class="math notranslate nohighlight">
\[1                                    \longrightarrow
O_{K,S}^\times / (O_{K,S}^\times)^m  \longrightarrow
K(S,m)                               \longrightarrow
\operatorname{Cl}_{K,S}[m]           \longrightarrow
0.\]</div>
<p>The group <span class="math notranslate nohighlight">\(K(S,m)\)</span> contains the subgroup of those <span class="math notranslate nohighlight">\(a\)</span> such
that <span class="math notranslate nohighlight">\(K(\sqrt[m]{a})/K\)</span> is unramified at all primes of <span class="math notranslate nohighlight">\(K\)</span>
outside of <span class="math notranslate nohighlight">\(S\)</span>, but may contain it properly when not all
primes dividing <span class="math notranslate nohighlight">\(m\)</span> are in <span class="math notranslate nohighlight">\(S\)</span>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.rings.number_field.number_field.NumberField_generic.selmer_space" title="sage.rings.number_field.number_field.NumberField_generic.selmer_space"><code class="xref py py-meth docutils literal notranslate"><span class="pre">NumberField_generic.selmer_space()</span></code></a>, which gives
additional output when <span class="math notranslate nohighlight">\(m=p\)</span> is prime: as well as generators,
it gives an abstract vector space over <span class="math notranslate nohighlight">\(GF(p)\)</span> isomorphic to
<span class="math notranslate nohighlight">\(K(S,p)\)</span> and maps implementing the isomorphism between this
space and <span class="math notranslate nohighlight">\(K(S,p)\)</span> as a subgroup of <span class="math notranslate nohighlight">\(K^*/(K^*)^p\)</span>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">selmer_generators</span><span class="p">((),</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">[-1, 2]</span>
</pre></div>
</div>
<p>The previous example shows that the group generated by the
output may be strictly larger than the group of
elements giving extensions unramified outside <span class="math notranslate nohighlight">\(S\)</span>, since that
has order just 2, generated by <span class="math notranslate nohighlight">\(-1\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">class_number</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_class_field</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="go">Number Field in b with defining polynomial x^2 + 1 over its base field</span>
</pre></div>
</div>
<p>When <span class="math notranslate nohighlight">\(m\)</span> is prime all the orders are equal to <span class="math notranslate nohighlight">\(m\)</span>, but in general they are only divisors of <span class="math notranslate nohighlight">\(m\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P3</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">selmer_generators</span><span class="p">((),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">orders</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">([-1, 2], [2, 2])</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">selmer_generators</span><span class="p">((),</span> <span class="mi">4</span><span class="p">,</span> <span class="n">orders</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">([-1, 4], [2, 2])</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">selmer_generators</span><span class="p">([</span><span class="n">P2</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">[2, -1]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">selmer_generators</span><span class="p">((</span><span class="n">P2</span><span class="p">,</span><span class="n">P3</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">[2, -a - 1, -1]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">selmer_generators</span><span class="p">((</span><span class="n">P2</span><span class="p">,</span><span class="n">P3</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="n">orders</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">([2, -a - 1, -1], [4, 4, 2])</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">selmer_generators</span><span class="p">([</span><span class="n">P2</span><span class="p">],</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">[2]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">selmer_generators</span><span class="p">([</span><span class="n">P2</span><span class="p">,</span> <span class="n">P3</span><span class="p">],</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">[2, -a - 1]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">selmer_generators</span><span class="p">([</span><span class="n">P2</span><span class="p">,</span> <span class="n">P3</span><span class="p">,</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="p">)],</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># random signs</span>
<span class="go">[2, a + 1, a]</span>
</pre></div>
</div>
<p>Example over <span class="math notranslate nohighlight">\(\QQ\)</span> (as a number field):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">selmer_generators</span><span class="p">([],</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">selmer_generators</span><span class="p">([</span><span class="n">K</span><span class="o">.</span><span class="n">prime_above</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]],</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[2, 3, 5, -1]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">selmer_generators</span><span class="p">([</span><span class="n">K</span><span class="o">.</span><span class="n">prime_above</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]],</span><span class="mi">6</span><span class="p">,</span> <span class="n">orders</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">([2, 3, 5, -1], [6, 6, 6, 2])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.selmer_group">
<span class="sig-name descname"><span class="pre">selmer_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.selmer_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Deprecated: Use <a class="reference internal" href="#sage.rings.number_field.number_field.NumberField_generic.selmer_generators" title="sage.rings.number_field.number_field.NumberField_generic.selmer_generators"><code class="xref py py-func docutils literal notranslate"><span class="pre">selmer_generators()</span></code></a> instead.
See <a class="reference external" href="https://trac.sagemath.org/31345">trac ticket #31345</a> for details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.selmer_group_iterator">
<span class="sig-name descname"><span class="pre">selmer_group_iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.selmer_group_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an iterator through elements of the finite group <span class="math notranslate nohighlight">\(K(S,m)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">S</span></code> – a set of primes of <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code> – a positive integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> – if False, assume the GRH in computing the class group</p></li>
</ul>
<p>OUTPUT:</p>
<p>An iterator yielding the distinct elements of <span class="math notranslate nohighlight">\(K(S,m)\)</span>.  See
the docstring for <a class="reference internal" href="#sage.rings.number_field.number_field.NumberField_generic.selmer_generators" title="sage.rings.number_field.number_field.NumberField_generic.selmer_generators"><code class="xref py py-meth docutils literal notranslate"><span class="pre">NumberField_generic.selmer_generators()</span></code></a> for
more information.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">selmer_group_iterator</span><span class="p">((),</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">[1, 2, -1, -2]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">selmer_group_iterator</span><span class="p">((),</span> <span class="mi">4</span><span class="p">))</span>
<span class="go">[1, 4, -1, -4]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">selmer_group_iterator</span><span class="p">([</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">)],</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">[1, -1, 2, -2]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">selmer_group_iterator</span><span class="p">([</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">)],</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">[1, -1, -a - 1, a + 1, 2, -2, -2*a - 2, 2*a + 2]</span>
</pre></div>
</div>
<p>Examples over <span class="math notranslate nohighlight">\(\QQ\)</span> (as a number field):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">))</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">selmer_group_iterator</span><span class="p">([],</span> <span class="mi">5</span><span class="p">))</span>
<span class="go">[1]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">selmer_group_iterator</span><span class="p">([],</span> <span class="mi">4</span><span class="p">))</span>
<span class="go">[1, -1]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">selmer_group_iterator</span><span class="p">([</span><span class="n">K</span><span class="o">.</span><span class="n">prime_above</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span><span class="mi">13</span><span class="p">]],</span><span class="mi">2</span><span class="p">))</span>
<span class="go">[1, -1, 13, -13, 11, -11, 143, -143]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.selmer_space">
<span class="sig-name descname"><span class="pre">selmer_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.selmer_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the group <span class="math notranslate nohighlight">\(K(S,p)\)</span> as a vector space with maps to and from <span class="math notranslate nohighlight">\(K^*\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">S</span></code> – a set of primes ideals of <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> – if False, assume the GRH in computing the class group</p></li>
</ul>
<p>OUTPUT:</p>
<p>(tuple) <code class="docutils literal notranslate"><span class="pre">KSp</span></code>, <code class="docutils literal notranslate"><span class="pre">KSp_gens</span></code>, <code class="docutils literal notranslate"><span class="pre">from_KSp</span></code>, <code class="docutils literal notranslate"><span class="pre">to_KSp</span></code> where</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">KSp</span></code> is an abstract vector space over <span class="math notranslate nohighlight">\(GF(p)\)</span> isomorphic to <span class="math notranslate nohighlight">\(K(S,p)\)</span>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">KSp_gens</span></code> is a list of elements of <span class="math notranslate nohighlight">\(K^*\)</span> generating <span class="math notranslate nohighlight">\(K(S,p)\)</span>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">from_KSp</span></code> is a function from <code class="docutils literal notranslate"><span class="pre">KSp</span></code> to <span class="math notranslate nohighlight">\(K^*\)</span>
implementing the isomorphism from the abstract <span class="math notranslate nohighlight">\(K(S,p)\)</span> to
<span class="math notranslate nohighlight">\(K(S,p)\)</span> as a subgroup of <span class="math notranslate nohighlight">\(K^*/(K^*)^p\)</span>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">to_KSP</span></code> is a partial function from <span class="math notranslate nohighlight">\(K^*\)</span> to <code class="docutils literal notranslate"><span class="pre">KSp</span></code>,
defined on elements <span class="math notranslate nohighlight">\(a\)</span> whose image in <span class="math notranslate nohighlight">\(K^*/(K^*)^p\)</span> lies in
<span class="math notranslate nohighlight">\(K(S,p)\)</span>, mapping them via the inverse isomorphism to the
abstract vector space <code class="docutils literal notranslate"><span class="pre">KSp</span></code>.</p></li>
</ul>
<p>The group <span class="math notranslate nohighlight">\(K(S,p)\)</span> is the finite subgroup of <span class="math notranslate nohighlight">\(K^*/(K^*)^p\)</span>
consisting of elements whose valuation at all primes not in
<span class="math notranslate nohighlight">\(S\)</span> is a multiple of <span class="math notranslate nohighlight">\(p\)</span>.  It contains the subgroup of those
<span class="math notranslate nohighlight">\(a\in K^*\)</span> such that <span class="math notranslate nohighlight">\(K(\sqrt[p]{a})/K\)</span> is unramified at all
primes of <span class="math notranslate nohighlight">\(K\)</span> outside of <span class="math notranslate nohighlight">\(S\)</span>, but may contain it properly when
not all primes dividing <span class="math notranslate nohighlight">\(p\)</span> are in <span class="math notranslate nohighlight">\(S\)</span>.</p>
<p>EXAMPLES:</p>
<p>A real quadratic field with class number 2, where the fundamental
unit is a generator, and the class group provides another
generator when <span class="math notranslate nohighlight">\(p=2\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">class_number</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P3</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P5</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">KS2</span><span class="p">,</span> <span class="n">gens</span><span class="p">,</span> <span class="n">fromKS2</span><span class="p">,</span> <span class="n">toKS2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">selmer_space</span><span class="p">([</span><span class="n">P2</span><span class="p">,</span> <span class="n">P3</span><span class="p">,</span> <span class="n">P5</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">KS2</span>
<span class="go">Vector space of dimension 4 over Finite Field of size 2</span>
<span class="gp">sage: </span><span class="n">gens</span>
<span class="go">[a + 1, a, 2, -1]</span>
</pre></div>
</div>
<p>Each generator must have even valuation at primes not in <span class="math notranslate nohighlight">\(S\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">gens</span><span class="p">]</span>
<span class="go">[(Fractional ideal (2, a + 1)) * (Fractional ideal (3, a + 1)),</span>
<span class="go">Fractional ideal (-a),</span>
<span class="go">(Fractional ideal (2, a + 1))^2,</span>
<span class="go">1]</span>

<span class="gp">sage: </span><span class="n">toKS2</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">(0, 0, 1, 1)</span>
<span class="gp">sage: </span><span class="n">fromKS2</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">-2</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">10</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">KS3</span><span class="p">,</span> <span class="n">gens</span><span class="p">,</span> <span class="n">fromKS3</span><span class="p">,</span> <span class="n">toKS3</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">selmer_space</span><span class="p">([</span><span class="n">P2</span><span class="p">,</span> <span class="n">P3</span><span class="p">,</span> <span class="n">P5</span><span class="p">],</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">KS3</span>
<span class="go">Vector space of dimension 3 over Finite Field of size 3</span>
<span class="gp">sage: </span><span class="n">gens</span>
<span class="go">[1/2, 1/4*a + 1/4, a]</span>
</pre></div>
</div>
<p>An example to show that the group <span class="math notranslate nohighlight">\(K(S,2)\)</span> may be strictly
larger than the group of elements giving extensions unramified
outside <span class="math notranslate nohighlight">\(S\)</span>.  In this case, with <span class="math notranslate nohighlight">\(K\)</span> of class number <span class="math notranslate nohighlight">\(2\)</span> and
<span class="math notranslate nohighlight">\(S\)</span> empty, there is only one quadratic extension of <span class="math notranslate nohighlight">\(K\)</span>
unramified outside <span class="math notranslate nohighlight">\(S\)</span>, the Hilbert Class Field
<span class="math notranslate nohighlight">\(K(\sqrt{-1})\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">KS2</span><span class="p">,</span> <span class="n">gens</span><span class="p">,</span> <span class="n">fromKS2</span><span class="p">,</span> <span class="n">toKS2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">selmer_space</span><span class="p">([],</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">KS2</span>
<span class="go">Vector space of dimension 2 over Finite Field of size 2</span>
<span class="gp">sage: </span><span class="n">gens</span>
<span class="go">[2, -1]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">KS2</span><span class="p">:</span>
<span class="gp">....: </span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span><span class="p">:</span>
<span class="gp">....: </span>        <span class="k">continue</span>
<span class="gp">....: </span>    <span class="n">a</span> <span class="o">=</span> <span class="n">fromKS2</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="k">print</span><span class="p">((</span><span class="n">a</span><span class="p">,</span><span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">a</span><span class="p">,</span> <span class="s1">&#39;roota&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">relative_discriminant</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()))</span>
<span class="gp">....:</span>
<span class="go">(2, (Fractional ideal (2, a + 1))^4)</span>
<span class="go">(-1, 1)</span>
<span class="go">(-2, (Fractional ideal (2, a + 1))^4)</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_class_field</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="go">Number Field in b with defining polynomial x^2 + 1 over its base field</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.signature">
<span class="sig-name descname"><span class="pre">signature</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.signature" title="Permalink to this definition">¶</a></dt>
<dd><p>Return (r1, r2), where r1 and r2 are the number of real embeddings
and pairs of complex embeddings of this field, respectively.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">signature</span><span class="p">()</span>
<span class="go">(0, 1)</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">signature</span><span class="p">()</span>
<span class="go">(1, 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.solve_CRT">
<span class="sig-name descname"><span class="pre">solve_CRT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reslist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ilist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.solve_CRT" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve a Chinese remainder problem over this number field.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">reslist</span></code> – a list of residues, i.e. integral number field elements</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Ilist</span></code> – a list of integral ideals, assumed pairwise coprime</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> (boolean, default True) – if True, result is checked</p></li>
</ul>
<p>OUTPUT:</p>
<p>An integral element x such that x-reslist[i] is in Ilist[i] for all i.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The current implementation requires the ideals to be pairwise
coprime.  A more general version would be possible.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Ilist</span> <span class="o">=</span> <span class="p">[</span><span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="n">p</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">solve_CRT</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span><span class="n">Ilist</span><span class="p">,</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span> <span class="ow">in</span> <span class="n">Ilist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Ilist</span> <span class="o">=</span> <span class="p">[</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">solve_CRT</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">Ilist</span><span class="p">,</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ArithmeticError: ideals in solve_CRT() must be pairwise coprime</span>
<span class="gp">sage: </span><span class="n">Ilist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">Ilist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">Fractional ideal (2, a)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.some_elements">
<span class="sig-name descname"><span class="pre">some_elements</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.some_elements" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of elements in the given number field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span>  <span class="n">QQ</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in a with defining polynomial t^2 - 2</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">some_elements</span><span class="p">()</span>
<span class="go">[1, a, 2*a, 3*a - 4, 1/2, 1/3*a, 1/6*a, 0, 1/2*a, 2, ..., 12, -12*a + 18]</span>

<span class="gp">sage: </span><span class="n">T</span><span class="o">.&lt;</span><span class="n">u</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">5</span><span class="p">);</span> <span class="n">M</span>
<span class="go">Number Field in b with defining polynomial t^3 - 5 over its base field</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">some_elements</span><span class="p">()</span>
<span class="go">[1, b, 1/2*a*b, ..., 2/5*b^2 + 2/5, 1/6*b^2 + 5/6*b + 13/6, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.specified_complex_embedding">
<span class="sig-name descname"><span class="pre">specified_complex_embedding</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.specified_complex_embedding" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the embedding of this field into the complex numbers which has
been specified.</p>
<p>Fields created with the <code class="docutils literal notranslate"><span class="pre">QuadraticField</span></code> or
<code class="docutils literal notranslate"><span class="pre">CyclotomicField</span></code> constructors come with an implicit
embedding. To get one of these fields without the embedding, use
the generic <code class="docutils literal notranslate"><span class="pre">NumberField</span></code> constructor.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">specified_complex_embedding</span><span class="p">()</span>
<span class="go">Generic morphism:</span>
<span class="go">  From: Number Field in I with defining polynomial x^2 + 1 with I = 1*I</span>
<span class="go">  To:   Complex Lazy Field</span>
<span class="go">  Defn: I -&gt; 1*I</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuadraticField</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">specified_complex_embedding</span><span class="p">()</span>
<span class="go">Generic morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial x^2 - 3 with a = 1.732050807568878?</span>
<span class="go">  To:   Real Lazy Field</span>
<span class="go">  Defn: a -&gt; 1.732050807568878?</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span><span class="o">.</span><span class="n">specified_complex_embedding</span><span class="p">()</span>
<span class="go">Generic morphism:</span>
<span class="go">  From: Cyclotomic Field of order 13 and degree 12</span>
<span class="go">  To:   Complex Lazy Field</span>
<span class="go">  Defn: zeta13 -&gt; 0.885456025653210? + 0.464723172043769?*I</span>
</pre></div>
</div>
<p>Most fields don’t implicitly have embeddings unless explicitly
specified:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">specified_complex_embedding</span><span class="p">()</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">specified_complex_embedding</span><span class="p">()</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">embedding</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">specified_complex_embedding</span><span class="p">()</span>
<span class="go">Generic morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial x^3 - x + 5 with a = -1.904160859134921?</span>
<span class="go">  To:   Real Lazy Field</span>
<span class="go">  Defn: a -&gt; -1.904160859134921?</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">embedding</span><span class="o">=</span><span class="n">CDF</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">specified_complex_embedding</span><span class="p">()</span>
<span class="go">Generic morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial x^3 - x + 5 with a = 0.952080429567461? + 1.311248044077123?*I</span>
<span class="go">  To:   Complex Lazy Field</span>
<span class="go">  Defn: a -&gt; 0.952080429567461? + 1.311248044077123?*I</span>
</pre></div>
</div>
<p>This function only returns complex embeddings:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">embedding</span><span class="o">=</span><span class="n">Qp</span><span class="p">(</span><span class="mi">7</span><span class="p">)(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sqrt</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">specified_complex_embedding</span><span class="p">()</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">gen_embedding</span><span class="p">()</span>
<span class="go">3 + 7 + 2*7^2 + 6*7^3 + 7^4 + 2*7^5 + 7^6 + 2*7^7 + 4*7^8 + 6*7^9 + 6*7^10 + 2*7^11 + 7^12 + 7^13 + 2*7^15 + 7^16 + 7^17 + 4*7^18 + 6*7^19 + O(7^20)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">coerce_embedding</span><span class="p">()</span>
<span class="go">Generic morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial x^2 - 2 with a = 3 + 7 + 2*7^2 + 6*7^3 + 7^4 + 2*7^5 + 7^6 + 2*7^7 + 4*7^8 + 6*7^9 + 6*7^10 + 2*7^11 + 7^12 + 7^13 + 2*7^15 + 7^16 + 7^17 + 4*7^18 + 6*7^19 + O(7^20)</span>
<span class="go">  To:   7-adic Field with capped relative precision 20</span>
<span class="go">  Defn: a -&gt; 3 + 7 + 2*7^2 + 6*7^3 + 7^4 + 2*7^5 + 7^6 + 2*7^7 + 4*7^8 + 6*7^9 + 6*7^10 + 2*7^11 + 7^12 + 7^13 + 2*7^15 + 7^16 + 7^17 + 4*7^18 + 6*7^19 + O(7^20)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.structure">
<span class="sig-name descname"><span class="pre">structure</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Return fixed isomorphism or embedding structure on self.</p>
<p>This is used to record various isomorphisms or embeddings that
arise naturally in other constructions.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">absolute_field</span><span class="p">();</span> <span class="n">L</span>
<span class="go">Number Field in a with defining polynomial x^2 + 3</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">structure</span><span class="p">()</span>
<span class="go">(Isomorphism given by variable name change map:</span>
<span class="go">  From: Number Field in a with defining polynomial x^2 + 3</span>
<span class="go">  To:   Number Field in z with defining polynomial x^2 + 3,</span>
<span class="go"> Isomorphism given by variable name change map:</span>
<span class="go">  From: Number Field in z with defining polynomial x^2 + 3</span>
<span class="go">  To:   Number Field in a with defining polynomial x^2 + 3)</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.&lt;</span><span class="n">x0</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D_abs</span><span class="o">.&lt;</span><span class="n">y0</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">absolute_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D_abs</span><span class="o">.</span><span class="n">structure</span><span class="p">()[</span><span class="mi">0</span><span class="p">](</span><span class="n">y0</span><span class="p">)</span>
<span class="go">-a</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.subfield">
<span class="sig-name descname"><span class="pre">subfield</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.subfield" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a number field <span class="math notranslate nohighlight">\(K\)</span> isomorphic to <span class="math notranslate nohighlight">\(\QQ(\alpha)\)</span>
(if this is an absolute number field) or <span class="math notranslate nohighlight">\(L(\alpha)\)</span> (if this
is a relative extension <span class="math notranslate nohighlight">\(M/L\)</span>) and a map from K to self that
sends the generator of K to alpha.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alpha</span></code> - an element of self, or something that
coerces to an element of self.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">K</span></code> - a number field</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">from_K</span></code> - a homomorphism from K to self that
sends the generator of K to alpha.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">3</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in a with defining polynomial x^4 - 3</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">from_H</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">subfield</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span>
<span class="go">Number Field in b with defining polynomial x^2 - 3 with b = a^2</span>
<span class="gp">sage: </span><span class="n">from_H</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">a^2</span>
<span class="gp">sage: </span><span class="n">from_H</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Number Field in b with defining polynomial x^2 - 3 with b = a^2</span>
<span class="go">  To:   Number Field in a with defining polynomial x^4 - 3</span>
<span class="go">  Defn: b |--&gt; a^2</span>
</pre></div>
</div>
<p>A relative example. Note that the result returned is the subfield generated
by <span class="math notranslate nohighlight">\(\alpha\)</span> over <code class="docutils literal notranslate"><span class="pre">self.base_field()</span></code>, not over <span class="math notranslate nohighlight">\(\QQ\)</span> (see <a class="reference external" href="https://trac.sagemath.org/5392">trac ticket #5392</a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">subfield</span><span class="p">(</span><span class="n">b</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">base_field</span><span class="p">()</span> <span class="ow">is</span> <span class="n">L</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Subfields inherit embeddings:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">,</span> <span class="n">K_from_L</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">subfield</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">z</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">Number Field in z0 with defining polynomial x^2 - 5 with z0 = 2.236067977499790?</span>
<span class="gp">sage: </span><span class="n">CLF_from_K</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">coerce_embedding</span><span class="p">();</span> <span class="n">CLF_from_K</span>
<span class="go">Generic morphism:</span>
<span class="go">  From: Cyclotomic Field of order 5 and degree 4</span>
<span class="go">  To:   Complex Lazy Field</span>
<span class="go">  Defn: z -&gt; 0.309016994374948? + 0.951056516295154?*I</span>
<span class="gp">sage: </span><span class="n">CLF_from_L</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">coerce_embedding</span><span class="p">();</span> <span class="n">CLF_from_L</span>
<span class="go">Generic morphism:</span>
<span class="go">  From: Number Field in z0 with defining polynomial x^2 - 5 with z0 = 2.236067977499790?</span>
<span class="go">  To:   Complex Lazy Field</span>
<span class="go">  Defn: z0 -&gt; 2.236067977499790?</span>
</pre></div>
</div>
<p>Check transitivity:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CLF_from_L</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">gen</span><span class="p">())</span>
<span class="go">2.236067977499790?</span>
<span class="gp">sage: </span><span class="n">CLF_from_K</span><span class="p">(</span><span class="n">K_from_L</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">gen</span><span class="p">()))</span>
<span class="go">2.23606797749979? + 0.?e-14*I</span>
</pre></div>
</div>
<p>If <span class="math notranslate nohighlight">\(self\)</span> has no specified embedding, then <span class="math notranslate nohighlight">\(K\)</span> comes with an
embedding in <span class="math notranslate nohighlight">\(self\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">8</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">from_L</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">subfield</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">Number Field in b with defining polynomial x^3 - 6*x^2 + 8*x - 1 with b = a^2</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">gen_embedding</span><span class="p">()</span>
<span class="go">a^2</span>
</pre></div>
</div>
<p>You can also view a number field as having a different generator by
just choosing the input to generate the whole field; for that it is
better to use <code class="docutils literal notranslate"><span class="pre">self.change_generator</span></code>, which gives
isomorphisms in both directions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.subfield_from_elements">
<span class="sig-name descname"><span class="pre">subfield_from_elements</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.subfield_from_elements" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the subfield generated by the elements <code class="docutils literal notranslate"><span class="pre">alpha</span></code>.</p>
<p>If the generated subfield by the elements <code class="docutils literal notranslate"><span class="pre">alpha</span></code> is either the
rational field or the complete number field, the field returned is
respectively <code class="docutils literal notranslate"><span class="pre">QQ</span></code> or <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alpha</span></code> - list of elements in this number field</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> - a name for the generator of the new number field</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">polred</span></code> (boolean, default <code class="docutils literal notranslate"><span class="pre">True</span></code>) - whether to optimize the generator of
the newly created field</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">threshold</span></code> (positive number, default <code class="docutils literal notranslate"><span class="pre">None</span></code>) - threshold to be passed to
the <code class="docutils literal notranslate"><span class="pre">do_polred</span></code> function</p></li>
</ul>
<p>OUTPUT: a triple <code class="docutils literal notranslate"><span class="pre">(field,</span> <span class="pre">beta,</span> <span class="pre">hom)</span></code> where</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">field</span></code> - a subfield of this number field</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">beta</span></code> - a list of elements of <code class="docutils literal notranslate"><span class="pre">field</span></code> corresponding to <code class="docutils literal notranslate"><span class="pre">alpha</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hom</span></code> - inclusion homomorphism from <code class="docutils literal notranslate"><span class="pre">field</span></code> to <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">poly</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">emb</span> <span class="o">=</span> <span class="n">AA</span><span class="o">.</span><span class="n">polynomial_root</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">RIF</span><span class="p">(</span><span class="mf">0.51</span><span class="p">,</span> <span class="mf">0.52</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">embedding</span><span class="o">=</span><span class="n">emb</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sqrt2</span> <span class="o">=</span> <span class="o">-</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">a</span>
<span class="gp">sage: </span><span class="n">sqrt3</span> <span class="o">=</span> <span class="o">-</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="k">assert</span> <span class="n">sqrt2</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">sqrt3</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">,</span> <span class="n">elts</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">subfield_from_elements</span><span class="p">([</span><span class="n">sqrt2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">sqrt2</span><span class="o">/</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">Number Field in a0 with defining polynomial x^2 - 2 with a0 = 1.414213562373095?</span>
<span class="gp">sage: </span><span class="n">elts</span>
<span class="go">[a0, -1/3*a0 + 1]</span>
<span class="gp">sage: </span><span class="n">phi</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Number Field in a0 with defining polynomial x^2 - 2 with a0 = 1.414213562373095?</span>
<span class="go">  To:   Number Field in a with defining polynomial x^4 - 4*x^2 + 1 with a = 0.5176380902050415?</span>
<span class="go">  Defn: a0 |--&gt; -a^3 + 3*a</span>
<span class="gp">sage: </span><span class="k">assert</span> <span class="n">phi</span><span class="p">(</span><span class="n">elts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">sqrt2</span>
<span class="gp">sage: </span><span class="k">assert</span> <span class="n">phi</span><span class="p">(</span><span class="n">elts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">sqrt2</span><span class="o">/</span><span class="mi">3</span>


<span class="gp">sage: </span><span class="n">L</span><span class="p">,</span> <span class="n">elts</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">subfield_from_elements</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">sqrt3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="k">assert</span> <span class="n">phi</span><span class="p">(</span><span class="n">elts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="k">assert</span> <span class="n">phi</span><span class="p">(</span><span class="n">elts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="n">sqrt3</span>

<span class="gp">sage: </span><span class="n">L</span><span class="p">,</span> <span class="n">elts</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">subfield_from_elements</span><span class="p">([</span><span class="n">sqrt2</span><span class="p">,</span> <span class="n">sqrt3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span>
<span class="go">Identity endomorphism of Number Field in a with defining polynomial x^4 - 4*x^2 + 1 with a = 0.5176380902050415?</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.trace_dual_basis">
<span class="sig-name descname"><span class="pre">trace_dual_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.trace_dual_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the dual basis of a basis of <code class="docutils literal notranslate"><span class="pre">self</span></code> with respect to the trace pairing.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">trace_dual_basis</span><span class="p">(</span><span class="n">b</span><span class="p">);</span> <span class="n">T</span>
<span class="go">[4/31*a^2 - 6/31*a + 13/31, -9/62*a^2 - 1/31*a - 3/31, 2/31*a^2 - 3/31*a + 4/93]</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="go">[1, 0, 0, 0, 1, 0, 0, 0, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.trace_pairing">
<span class="sig-name descname"><span class="pre">trace_pairing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.trace_pairing" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the matrix of the trace pairing on the elements of the list
<span class="math notranslate nohighlight">\(v\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">zeta3</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">trace_pairing</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="n">zeta3</span><span class="p">])</span>
<span class="go">[ 2  0]</span>
<span class="go">[ 0 -6]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.uniformizer">
<span class="sig-name descname"><span class="pre">uniformizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">others</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'positive'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.uniformizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an element of self with valuation 1 at the prime ideal P.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> - a number field</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">P</span></code> - a prime ideal of self</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">others</span></code> - either “positive” (default), in which
case the element will have non-negative valuation at all other
primes of self, or “negative”, in which case the element will have
non-positive valuation at all other primes of self.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When P is principal (e.g. always when self has class number
one) the result may or may not be a generator of P!</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in a with defining polynomial x^2 + 5</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">,</span><span class="n">Q</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">prime_factors</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span>
<span class="go">Fractional ideal (3, a + 1)</span>
<span class="gp">sage: </span><span class="n">pi</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">uniformizer</span><span class="p">(</span><span class="n">P</span><span class="p">);</span> <span class="n">pi</span>
<span class="go">a + 1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(Fractional ideal (2, a + 1)) * (Fractional ideal (3, a + 1))</span>
<span class="gp">sage: </span><span class="n">pi</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">uniformizer</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="s1">&#39;negative&#39;</span><span class="p">);</span> <span class="n">pi</span>
<span class="go">1/2*a + 1/2</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(Fractional ideal (2, a + 1))^-1 * (Fractional ideal (3, a + 1))</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Plist</span><span class="o">=</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">prime_factors</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">pilist</span> <span class="o">=</span> <span class="p">[</span><span class="n">K</span><span class="o">.</span><span class="n">uniformizer</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="k">for</span> <span class="n">P</span> <span class="ow">in</span> <span class="n">Plist</span><span class="p">]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">pi</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span> <span class="k">for</span> <span class="n">pi</span> <span class="ow">in</span> <span class="n">pilist</span><span class="p">]</span>
<span class="go">[True, True, True]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">pi</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="k">for</span> <span class="n">pi</span><span class="p">,</span><span class="n">P</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">pilist</span><span class="p">,</span><span class="n">Plist</span><span class="p">)]</span>
<span class="go">[1, 1, 1]</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="n">pilist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="n">Plist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Plist</span><span class="p">))</span> <span class="p">]</span>
<span class="go">[True, True, True]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">K</span><span class="o">.</span><span class="n">uniformizer</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="k">for</span> <span class="n">P</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="n">factor</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">2</span><span class="p">))]</span>
<span class="go">[2]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">K</span><span class="o">.</span><span class="n">uniformizer</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="k">for</span> <span class="n">P</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="n">factor</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">))]</span>
<span class="go">[t - 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">K</span><span class="o">.</span><span class="n">uniformizer</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="k">for</span> <span class="n">P</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="n">factor</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">5</span><span class="p">))]</span>
<span class="go">[t^2 - t + 1, t + 2, t - 2]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">K</span><span class="o">.</span><span class="n">uniformizer</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="k">for</span> <span class="n">P</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="n">factor</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">7</span><span class="p">))]</span>  <span class="c1"># representation varies, not tested</span>
<span class="go">[t^2 + 3*t + 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">K</span><span class="o">.</span><span class="n">uniformizer</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="k">for</span> <span class="n">P</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="n">factor</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">67</span><span class="p">))]</span>
<span class="go">[t + 23, t + 26, t - 32, t - 18]</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<blockquote>
<div><p>Use PARI. More precisely, use the second component of
<a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/idealprimedec">pari:idealprimedec</a> in the “positive” case. Use <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/idealappr">pari:idealappr</a>
with exponent of -1 and invert the result in the “negative”
case.</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.unit_group">
<span class="sig-name descname"><span class="pre">unit_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.unit_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the unit group (including torsion) of this number field.</p>
<p>ALGORITHM: Uses PARI’s <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/bnfinit">pari:bnfinit</a> command.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> (bool, default True) flag passed to <code class="docutils literal notranslate"><span class="pre">pari</span></code>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The group is cached.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.rings.number_field.number_field.NumberField_generic.units" title="sage.rings.number_field.number_field.NumberField_generic.units"><code class="xref py py-meth docutils literal notranslate"><span class="pre">units()</span></code></a>
<a class="reference internal" href="#sage.rings.number_field.number_field.NumberField_generic.S_unit_group" title="sage.rings.number_field.number_field.NumberField_generic.S_unit_group"><code class="xref py py-meth docutils literal notranslate"><span class="pre">S_unit_group()</span></code></a>
<a class="reference internal" href="#sage.rings.number_field.number_field.NumberField_generic.S_units" title="sage.rings.number_field.number_field.NumberField_generic.S_units"><code class="xref py py-meth docutils literal notranslate"><span class="pre">S_units()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">20</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">15</span><span class="o">*</span><span class="mi">5</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">11</span><span class="o">*</span><span class="mi">5</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">U</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">unit_group</span><span class="p">();</span> <span class="n">U</span>
<span class="go">Unit group with structure C10 x Z of Number Field in a with defining polynomial x^4 - 10*x^3 + 100*x^2 - 375*x + 1375</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(u0, u1)</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">.</span><span class="n">gens_values</span><span class="p">()</span>  <span class="c1"># random</span>
<span class="go">[-1/275*a^3 + 7/55*a^2 - 6/11*a + 4, 1/275*a^3 + 4/55*a^2 - 5/11*a + 3]</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">.</span><span class="n">invariants</span><span class="p">()</span>
<span class="go">(10, 0)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">u</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">()</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">U</span><span class="o">.</span><span class="n">gens</span><span class="p">()]</span>
<span class="go">[10, +Infinity]</span>
</pre></div>
</div>
<p>For big number fields, provably computing the unit group can
take a very long time.  In this case, one can ask for the
conjectural unit group (correct if the Generalized Riemann
Hypothesis is true):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">17</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">unit_group</span><span class="p">(</span><span class="n">proof</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  <span class="c1"># takes forever, not tested</span>
<span class="go">...</span>
<span class="gp">sage: </span><span class="n">U</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">unit_group</span><span class="p">(</span><span class="n">proof</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">U</span>
<span class="go">Unit group with structure C2 x Z x Z x Z x Z x Z x Z x Z x Z of Number Field in a with defining polynomial x^17 + 3</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(u0, u1, u2, u3, u4, u5, u6, u7, u8)</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">.</span><span class="n">gens_values</span><span class="p">()</span>  <span class="c1"># result not independently verified</span>
<span class="go">[-1, -a^9 - a + 1, -a^16 + a^15 - a^14 + a^12 - a^11 + a^10 + a^8 - a^7 + 2*a^6 - a^4 + 3*a^3 - 2*a^2 + 2*a - 1, 2*a^16 - a^14 - a^13 + 3*a^12 - 2*a^10 + a^9 + 3*a^8 - 3*a^6 + 3*a^5 + 3*a^4 - 2*a^3 - 2*a^2 + 3*a + 4, a^15 + a^14 + 2*a^11 + a^10 - a^9 + a^8 + 2*a^7 - a^5 + 2*a^3 - a^2 - 3*a + 1, -a^16 - a^15 - a^14 - a^13 - a^12 - a^11 - a^10 - a^9 - a^8 - a^7 - a^6 - a^5 - a^4 - a^3 - a^2 + 2, -2*a^16 + 3*a^15 - 3*a^14 + 3*a^13 - 3*a^12 + a^11 - a^9 + 3*a^8 - 4*a^7 + 5*a^6 - 6*a^5 + 4*a^4 - 3*a^3 + 2*a^2 + 2*a - 4, a^15 - a^12 + a^10 - a^9 - 2*a^8 + 3*a^7 + a^6 - 3*a^5 + a^4 + 4*a^3 - 3*a^2 - 2*a + 2, -a^14 - a^13 + a^12 + 2*a^10 + a^8 - 2*a^7 - 2*a^6 + 2*a^3 - a^2 + 2*a - 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.units">
<span class="sig-name descname"><span class="pre">units</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.units" title="Permalink to this definition">¶</a></dt>
<dd><p>Return generators for the unit group modulo torsion.</p>
<p>ALGORITHM: Uses PARI’s <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/bnfinit">pari:bnfinit</a> command.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> (bool, default True) flag passed to <code class="docutils literal notranslate"><span class="pre">pari</span></code>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For more functionality see the unit_group() function.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.rings.number_field.number_field.NumberField_generic.unit_group" title="sage.rings.number_field.number_field.NumberField_generic.unit_group"><code class="xref py py-meth docutils literal notranslate"><span class="pre">unit_group()</span></code></a>
<a class="reference internal" href="#sage.rings.number_field.number_field.NumberField_generic.S_unit_group" title="sage.rings.number_field.number_field.NumberField_generic.S_unit_group"><code class="xref py py-meth docutils literal notranslate"><span class="pre">S_unit_group()</span></code></a>
<a class="reference internal" href="#sage.rings.number_field.number_field.NumberField_generic.S_units" title="sage.rings.number_field.number_field.NumberField_generic.S_units"><code class="xref py py-meth docutils literal notranslate"><span class="pre">S_units()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">20</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">15</span><span class="o">*</span><span class="mi">5</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">11</span><span class="o">*</span><span class="mi">5</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">units</span><span class="p">()</span>
<span class="go">(-1/275*a^3 - 4/55*a^2 + 5/11*a - 3,)</span>
</pre></div>
</div>
<p>For big number fields, provably computing the unit group can
take a very long time.  In this case, one can ask for the
conjectural unit group (correct if the Generalized Riemann
Hypothesis is true):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">17</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">units</span><span class="p">(</span><span class="n">proof</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  <span class="c1"># takes forever, not tested</span>
<span class="go">...</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">units</span><span class="p">(</span><span class="n">proof</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>  <span class="c1"># result not independently verified</span>
<span class="go">(-a^9 - a + 1,</span>
<span class="go"> -a^16 + a^15 - a^14 + a^12 - a^11 + a^10 + a^8 - a^7 + 2*a^6 - a^4 + 3*a^3 - 2*a^2 + 2*a - 1,</span>
<span class="go"> 2*a^16 - a^14 - a^13 + 3*a^12 - 2*a^10 + a^9 + 3*a^8 - 3*a^6 + 3*a^5 + 3*a^4 - 2*a^3 - 2*a^2 + 3*a + 4,</span>
<span class="go"> a^15 + a^14 + 2*a^11 + a^10 - a^9 + a^8 + 2*a^7 - a^5 + 2*a^3 - a^2 - 3*a + 1,</span>
<span class="go"> -a^16 - a^15 - a^14 - a^13 - a^12 - a^11 - a^10 - a^9 - a^8 - a^7 - a^6 - a^5 - a^4 - a^3 - a^2 + 2,</span>
<span class="go"> -2*a^16 + 3*a^15 - 3*a^14 + 3*a^13 - 3*a^12 + a^11 - a^9 + 3*a^8 - 4*a^7 + 5*a^6 - 6*a^5 + 4*a^4 - 3*a^3 + 2*a^2 + 2*a - 4,</span>
<span class="go"> a^15 - a^12 + a^10 - a^9 - 2*a^8 + 3*a^7 + a^6 - 3*a^5 + a^4 + 4*a^3 - 3*a^2 - 2*a + 2,</span>
<span class="go"> -a^14 - a^13 + a^12 + 2*a^10 + a^8 - 2*a^7 - 2*a^6 + 2*a^3 - a^2 + 2*a - 2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.valuation">
<span class="sig-name descname"><span class="pre">valuation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prime</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.valuation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the valuation on this field defined by <code class="docutils literal notranslate"><span class="pre">prime</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">prime</span></code> – a prime that does not split, a discrete
(pseudo-)valuation or a fractional ideal</p></li>
</ul>
<p>EXAMPLES:</p>
<p>The valuation can be specified with an integer <code class="docutils literal notranslate"><span class="pre">prime</span></code> that is
completely ramified in <code class="docutils literal notranslate"><span class="pre">R</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">2-adic valuation</span>
</pre></div>
</div>
<p>It can also be unramified in <code class="docutils literal notranslate"><span class="pre">R</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">3-adic valuation</span>
</pre></div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">prime</span></code> that factors into pairwise distinct factors, results in an error:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: The valuation Gauss valuation induced by 5-adic valuation does not approximate a unique extension of 5-adic valuation with respect to x^2 + 1</span>
</pre></div>
</div>
<p>The valuation can also be selected by giving a valuation on the base
ring that extends uniquely:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="n">ZZ</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">5-adic valuation</span>
</pre></div>
</div>
<p>When the extension is not unique, this does not work:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="n">ZZ</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: The valuation Gauss valuation induced by 5-adic valuation does not approximate a unique extension of 5-adic valuation with respect to x^2 + 1</span>
</pre></div>
</div>
<p>For a number field which is of the form <span class="math notranslate nohighlight">\(K[x]/(G)\)</span>, you can specify a
valuation by providing a discrete pseudo-valuation on <span class="math notranslate nohighlight">\(K[x]\)</span> which sends
<span class="math notranslate nohighlight">\(G\)</span> to infinity. This lets us specify which extension of the 5-adic
valuation we care about in the above example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="n">GaussValuation</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">QQ</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">augmentation</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">infinity</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="n">GaussValuation</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">QQ</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">augmentation</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">infinity</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">==</span> <span class="n">w</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Note that you get the same valuation, even if you write down the
pseudo-valuation differently:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ww</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="n">GaussValuation</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">QQ</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">augmentation</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="n">infinity</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="ow">is</span> <span class="n">ww</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The valuation <code class="docutils literal notranslate"><span class="pre">prime</span></code> does not need to send the defining polynomial <span class="math notranslate nohighlight">\(G\)</span>
to infinity. It is sufficient if it singles out one of the valuations on
the number field.  This is important if the prime only factors over the
completion, i.e., if it is not possible to write down one of the factors
within the number field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">GaussValuation</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">QQ</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">augmentation</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">[ 5-adic valuation, v(x + 3) = 1 ]-adic valuation</span>
</pre></div>
</div>
<p>Finally, <code class="docutils literal notranslate"><span class="pre">prime</span></code> can also be a fractional ideal of a number field if it
singles out an extension of a <span class="math notranslate nohighlight">\(p\)</span>-adic valuation of the base field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">fractional_ideal</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">2-adic valuation</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="order.html#sage.rings.number_field.order.Order.valuation" title="sage.rings.number_field.order.Order.valuation"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Order.valuation()</span></code></a>,
<a class="reference external" href="../../../../padics/sage/rings/padics/padic_generic.html#sage.rings.padics.padic_generic.pAdicGeneric.valuation" title="(in Sage 9.4 Reference Manual: p-Adics v9.4)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pAdicGeneric.valuation()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.zeta">
<span class="sig-name descname"><span class="pre">zeta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.zeta" title="Permalink to this definition">¶</a></dt>
<dd><p>Return one, or a list of all, primitive n-th root of unity in this field.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> - positive integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">all</span></code> - bool.  If False (default), return a primitive
<span class="math notranslate nohighlight">\(n\)</span>-th root of unity in this field, or raise a ValueError
exception if there are none.  If True, return a list of
all primitive <span class="math notranslate nohighlight">\(n\)</span>-th roots of unity in this field
(possibly empty).</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To obtain the maximal order of a root of unity in this field,
use self.number_of_roots_of_unity().</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We do not create the full unit group since that can be
expensive, but we do use it if it is already known.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zeta</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zeta</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zeta</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">all</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[-1]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zeta</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1/2*z - 1/2</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zeta</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="nb">all</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[1/2*z - 1/2, -1/2*z - 1/2]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zeta</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: There are no 4th roots of unity in self.</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">r</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zeta</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">b</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zeta</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="nb">all</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[b, -b]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zeta</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: There are no 3rd roots of unity in self.</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zeta</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="nb">all</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>Number fields defined by non-monic and non-integral
polynomials are supported (<a class="reference external" href="https://trac.sagemath.org/252">trac ticket #252</a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zeta</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">-3/2*a - 1/2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.zeta_coefficients">
<span class="sig-name descname"><span class="pre">zeta_coefficients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.zeta_coefficients" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the first n coefficients of the Dedekind zeta function of
this field as a Dirichlet series.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">zeta_coefficients</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[1, 1, 0, 1, 2, 0, 0, 1, 1, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic.zeta_order">
<span class="sig-name descname"><span class="pre">zeta_order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic.zeta_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of roots of unity in this field.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We do not create the full unit group since that can be
expensive, but we do use it if it is already known.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">alpha</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">22</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">zeta_order</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">alpha</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">zeta_order</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_generic_v1">
<span class="sig-prename descclassname"><span class="pre">sage.rings.number_field.number_field.</span></span><span class="sig-name descname"><span class="pre">NumberField_generic_v1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">poly</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latex_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">canonical_embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_generic_v1" title="Permalink to this definition">¶</a></dt>
<dd><p>Used for unpickling old pickles.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.number_field.number_field</span> <span class="kn">import</span> <span class="n">NumberField_absolute_v1</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">NumberField_absolute_v1</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">)</span>
<span class="go">Number Field in i with defining polynomial x^2 + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_quadratic">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sage.rings.number_field.number_field.</span></span><span class="sig-name descname"><span class="pre">NumberField_quadratic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">polynomial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latex_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assume_disc_small</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maximize_at_primes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_quadratic" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.rings.number_field.number_field.NumberField_absolute" title="sage.rings.number_field.number_field.NumberField_absolute"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.rings.number_field.number_field.NumberField_absolute</span></code></a></p>
<p>Create a quadratic extension of the rational field.</p>
<p>The command <code class="docutils literal notranslate"><span class="pre">QuadraticField(a)</span></code> creates the field <span class="math notranslate nohighlight">\(\QQ(\sqrt{a})\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuadraticField</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">Number Field in a with defining polynomial x^2 - 3 with a = 1.732050807568878?</span>
<span class="gp">sage: </span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="go">Number Field in b with defining polynomial x^2 + 4 with b = 2*I</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_quadratic.class_number">
<span class="sig-name descname"><span class="pre">class_number</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_quadratic.class_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the size of the class group of self.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>, unless you called
<code class="xref py py-meth docutils literal notranslate"><span class="pre">proof.number_field()</span></code> and set it otherwise).  If
<code class="docutils literal notranslate"><span class="pre">proof</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code> (<em>not</em> the default!), and the
discriminant of the field is negative, then the following
warning from the PARI manual applies:</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For <span class="math notranslate nohighlight">\(D&lt;0\)</span>, this function may give incorrect results when
the class group has a low exponent (has many cyclic
factors), because implementing Shank’s method in full
generality slows it down immensely.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">class_number</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
<p>These are all the primes so that the class number of
<span class="math notranslate nohighlight">\(\QQ(\sqrt{-p})\)</span> is <span class="math notranslate nohighlight">\(1\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">300</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_square</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="ow">and</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="n">d</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">class_number</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
<span class="go">[2, 3, 7, 11, 19, 43, 67, 163]</span>
</pre></div>
</div>
<p>It is an open problem to <em>prove</em> that there are infinity many
positive square-free <span class="math notranslate nohighlight">\(d\)</span> such that
<span class="math notranslate nohighlight">\(\QQ(\sqrt{d})\)</span> has class number <span class="math notranslate nohighlight">\(1\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">len</span><span class="p">([</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_square</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="ow">and</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">class_number</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span>
<span class="go">121</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_quadratic.discriminant">
<span class="sig-name descname"><span class="pre">discriminant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_quadratic.discriminant" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the discriminant of the ring of integers of the number
field, or if v is specified, the determinant of the trace pairing
on the elements of the list v.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">v</span> <span class="pre">(optional)</span></code> - list of element of this number
field</p></li>
</ul>
<p>OUTPUT: Integer if v is omitted, and Rational otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">-4</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">-20</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_quadratic.hilbert_class_field">
<span class="sig-name descname"><span class="pre">hilbert_class_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_quadratic.hilbert_class_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Hilbert class field of this quadratic field as a
relative extension of this field.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the polynomial that defines this field as a relative
extension, see the <code class="docutils literal notranslate"><span class="pre">hilbert_class_field_defining_polynomial</span></code>
command, which is vastly faster than this command, since it doesn’t
construct a relative extension.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">hilbert_class_field</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">);</span> <span class="n">L</span>
<span class="go">Number Field in b with defining polynomial x^3 - x^2 + 1 over its base field</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">absolute_field</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="go">Number Field in c with defining polynomial x^6 - 2*x^5 + 70*x^4 - 90*x^3 + 1631*x^2 - 1196*x + 12743</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_class_field_defining_polynomial</span><span class="p">()</span>
<span class="go">x^3 - x^2 + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_quadratic.hilbert_class_field_defining_polynomial">
<span class="sig-name descname"><span class="pre">hilbert_class_field_defining_polynomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_quadratic.hilbert_class_field_defining_polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a polynomial over <span class="math notranslate nohighlight">\(\QQ\)</span> whose roots generate the
Hilbert class field of this quadratic field as an extension of
this quadratic field.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Computed using PARI via Schertz’s method. This
implementation is quite fast.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_class_field_defining_polynomial</span><span class="p">()</span>
<span class="go">x^3 - x^2 + 1</span>
</pre></div>
</div>
<p>Note that this polynomial is not the actual Hilbert class
polynomial: see <code class="docutils literal notranslate"><span class="pre">hilbert_class_polynomial</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_class_polynomial</span><span class="p">()</span>
<span class="go">x^3 + 3491750*x^2 - 5151296875*x + 12771880859375</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">431</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">class_number</span><span class="p">()</span>
<span class="go">21</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_class_field_defining_polynomial</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="go">z^21 + 6*z^20 + 9*z^19 - 4*z^18 + 33*z^17 + 140*z^16 + 220*z^15 + 243*z^14 + 297*z^13 + 461*z^12 + 658*z^11 + 743*z^10 + 722*z^9 + 681*z^8 + 619*z^7 + 522*z^6 + 405*z^5 + 261*z^4 + 119*z^3 + 35*z^2 + 7*z + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_quadratic.hilbert_class_polynomial">
<span class="sig-name descname"><span class="pre">hilbert_class_polynomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_quadratic.hilbert_class_polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Hilbert class polynomial of this quadratic field.</p>
<p>Right now, this is only implemented for imaginary quadratic
fields.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_class_polynomial</span><span class="p">()</span>
<span class="go">x</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">31</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">hilbert_class_polynomial</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="go">z^3 + 39491307*z^2 - 58682638134*z + 1566028350940383</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_quadratic.is_galois">
<span class="sig-name descname"><span class="pre">is_galois</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_quadratic.is_galois" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True since all quadratic fields are automatically Galois.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuadraticField</span><span class="p">(</span><span class="mi">1234</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_galois</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_quadratic.number_of_roots_of_unity">
<span class="sig-name descname"><span class="pre">number_of_roots_of_unity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_quadratic.number_of_roots_of_unity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of roots of unity in this quadratic field.</p>
<p>This is always 2 except when d is -3 or -4.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QF</span> <span class="o">=</span> <span class="n">QuadraticField</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">QF</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">number_of_roots_of_unity</span><span class="p">()</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)]</span>
<span class="go">[2, 2, 2, 4, 6]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.NumberField_quadratic_v1">
<span class="sig-prename descclassname"><span class="pre">sage.rings.number_field.number_field.</span></span><span class="sig-name descname"><span class="pre">NumberField_quadratic_v1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">poly</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">canonical_embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.NumberField_quadratic_v1" title="Permalink to this definition">¶</a></dt>
<dd><p>Used for unpickling old pickles.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.number_field.number_field</span> <span class="kn">import</span> <span class="n">NumberField_quadratic_v1</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">NumberField_quadratic_v1</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">)</span>
<span class="go">Number Field in d with defining polynomial x^2 - 2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.QuadraticField">
<span class="sig-prename descclassname"><span class="pre">sage.rings.number_field.number_field.</span></span><span class="sig-name descname"><span class="pre">QuadraticField</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'a'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latex_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sqrt'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.QuadraticField" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a quadratic field obtained by adjoining a square root of
<span class="math notranslate nohighlight">\(D\)</span> to the rational numbers, where <span class="math notranslate nohighlight">\(D\)</span> is not a
perfect square.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">D</span></code> - a rational number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> - variable name (default: ‘a’)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> - bool (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">embedding</span></code> - bool or square root of D in an
ambient field (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">latex_name</span></code> - latex variable name (default: sqrt{D})</p></li>
</ul>
<p>OUTPUT: A number field defined by a quadratic polynomial. Unless
otherwise specified, it has an embedding into <span class="math notranslate nohighlight">\(\RR\)</span> or
<span class="math notranslate nohighlight">\(\CC\)</span> by sending the generator to the positive
or upper-half-plane root.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuadraticField</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">Number Field in a with defining polynomial x^2 - 3 with a = 1.732050807568878?</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">theta</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Number Field in theta with defining polynomial x^2 - 3 with theta = 1.732050807568878?</span>
<span class="gp">sage: </span><span class="n">RR</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="go">1.73205080756888</span>
<span class="gp">sage: </span><span class="n">QuadraticField</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: D must not be a perfect square.</span>
<span class="gp">sage: </span><span class="n">QuadraticField</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">Number Field in a with defining polynomial x^2 - 9 with a = 3</span>
</pre></div>
</div>
<p>Quadratic number fields derive from general number fields.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.number_field.number_field</span> <span class="kn">import</span> <span class="n">is_NumberField</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.rings.number_field.number_field.NumberField_quadratic_with_category&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">is_NumberField</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Quadratic number fields are cached:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>By default, quadratic fields come with a nice latex representation:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">latex</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="go">\Bold{Q}(\sqrt{-7})</span>
<span class="gp">sage: </span><span class="n">latex</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">\sqrt{-7}</span>
<span class="gp">sage: </span><span class="n">latex</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="p">))</span>
<span class="go">-\frac{1}{8} \sqrt{-7} + \frac{1}{8}</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">latex_variable_names</span><span class="p">())</span>
<span class="go">[&#39;\\sqrt{-7}&#39;]</span>
</pre></div>
</div>
<p>We can provide our own name as well:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">10</span><span class="p">),</span> <span class="n">latex_name</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\sqrt{D}&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="mi">1</span><span class="o">+</span><span class="n">a</span>
<span class="go">a + 1</span>
<span class="gp">sage: </span><span class="n">latex</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="p">)</span>
<span class="go">\sqrt{D} + 1</span>
<span class="gp">sage: </span><span class="n">latex</span><span class="p">(</span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">latex_name</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span><span class="o">.</span><span class="n">gen</span><span class="p">())</span>
<span class="go">a</span>
</pre></div>
</div>
<p>The name of the generator does not interfere with Sage preparser, see <a class="reference external" href="https://trac.sagemath.org/1135">trac ticket #1135</a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K1</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K2</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K3</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K1</span> <span class="ow">is</span> <span class="n">K2</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K1</span> <span class="ow">is</span> <span class="n">K3</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K1</span>
<span class="go">Number Field in x with defining polynomial x^2 - 5 with x = 2.236067977499790?</span>
</pre></div>
</div>
<p>Note that, in presence of two different names for the generator,
the name given by the preparser takes precedence:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K4</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">);</span> <span class="n">K4</span>
<span class="go">Number Field in y with defining polynomial x^2 - 5 with y = 2.236067977499790?</span>
<span class="gp">sage: </span><span class="n">K1</span> <span class="o">==</span> <span class="n">K4</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.is_AbsoluteNumberField">
<span class="sig-prename descclassname"><span class="pre">sage.rings.number_field.number_field.</span></span><span class="sig-name descname"><span class="pre">is_AbsoluteNumberField</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.is_AbsoluteNumberField" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if x is an absolute number field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.number_field.number_field</span> <span class="kn">import</span> <span class="n">is_AbsoluteNumberField</span>
<span class="gp">sage: </span><span class="n">is_AbsoluteNumberField</span><span class="p">(</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_AbsoluteNumberField</span><span class="p">(</span><span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">17</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;a&#39;</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
<p>The rationals are a number field, but they’re not of the absolute
number field class.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">is_AbsoluteNumberField</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.is_CyclotomicField">
<span class="sig-prename descclassname"><span class="pre">sage.rings.number_field.number_field.</span></span><span class="sig-name descname"><span class="pre">is_CyclotomicField</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.is_CyclotomicField" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if x is a cyclotomic field, i.e., of the special
cyclotomic field class. This function does not return True for a
number field that just happens to be isomorphic to a cyclotomic
field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.number_field.number_field</span> <span class="kn">import</span> <span class="n">is_CyclotomicField</span>
<span class="gp">sage: </span><span class="n">is_CyclotomicField</span><span class="p">(</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span><span class="s1">&#39;zeta4&#39;</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_CyclotomicField</span><span class="p">(</span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_CyclotomicField</span><span class="p">(</span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_CyclotomicField</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_CyclotomicField</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.is_NumberFieldHomsetCodomain">
<span class="sig-prename descclassname"><span class="pre">sage.rings.number_field.number_field.</span></span><span class="sig-name descname"><span class="pre">is_NumberFieldHomsetCodomain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">codomain</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.is_NumberFieldHomsetCodomain" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether <code class="docutils literal notranslate"><span class="pre">codomain</span></code> is a valid codomain for a number
field homset. This is used by NumberField._Hom_ to determine
whether the created homsets should be a
<a class="reference internal" href="homset.html#sage.rings.number_field.homset.NumberFieldHomset" title="sage.rings.number_field.homset.NumberFieldHomset"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.rings.number_field.homset.NumberFieldHomset</span></code></a>.</p>
<p>EXAMPLES:</p>
<p>This currently accepts any parent (CC, RR, …) in <a class="reference external" href="../../../../categories/sage/categories/fields.html#sage.categories.fields.Fields" title="(in Sage 9.4 Reference Manual: Category Framework v9.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Fields</span></code></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.number_field.number_field</span> <span class="kn">import</span> <span class="n">is_NumberFieldHomsetCodomain</span>
<span class="gp">sage: </span><span class="n">is_NumberFieldHomsetCodomain</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_NumberFieldHomsetCodomain</span><span class="p">(</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_NumberFieldHomsetCodomain</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_NumberFieldHomsetCodomain</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_NumberFieldHomsetCodomain</span><span class="p">(</span><span class="n">MatrixSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_NumberFieldHomsetCodomain</span><span class="p">(</span><span class="n">InfinityRing</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Question: should, for example, QQ-algebras be accepted as well?</p>
<p>Caveat: Gap objects are not (yet) in <a class="reference external" href="../../../../categories/sage/categories/fields.html#sage.categories.fields.Fields" title="(in Sage 9.4 Reference Manual: Category Framework v9.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Fields</span></code></a>, and therefore
not accepted as number field homset codomains:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">is_NumberFieldHomsetCodomain</span><span class="p">(</span><span class="n">gap</span><span class="o">.</span><span class="n">Rationals</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.is_QuadraticField">
<span class="sig-prename descclassname"><span class="pre">sage.rings.number_field.number_field.</span></span><span class="sig-name descname"><span class="pre">is_QuadraticField</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.is_QuadraticField" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if x is of the quadratic <em>number</em> field type.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.number_field.number_field</span> <span class="kn">import</span> <span class="n">is_QuadraticField</span>
<span class="gp">sage: </span><span class="n">is_QuadraticField</span><span class="p">(</span><span class="n">QuadraticField</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_QuadraticField</span><span class="p">(</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_QuadraticField</span><span class="p">(</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
<p>A quadratic field specially refers to a number field, not a finite
field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">is_QuadraticField</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.is_fundamental_discriminant">
<span class="sig-prename descclassname"><span class="pre">sage.rings.number_field.number_field.</span></span><span class="sig-name descname"><span class="pre">is_fundamental_discriminant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.is_fundamental_discriminant" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if the integer <span class="math notranslate nohighlight">\(D\)</span> is a fundamental
discriminant, i.e., if <span class="math notranslate nohighlight">\(D \cong 0,1\pmod{4}\)</span>, and
<span class="math notranslate nohighlight">\(D\neq 0, 1\)</span> and either (1) <span class="math notranslate nohighlight">\(D\)</span> is square free or
(2) we have <span class="math notranslate nohighlight">\(D\cong 0\pmod{4}\)</span> with
<span class="math notranslate nohighlight">\(D/4 \cong 2,3\pmod{4}\)</span> and <span class="math notranslate nohighlight">\(D/4\)</span> square free. These
are exactly the discriminants of quadratic fields.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">D</span> <span class="k">for</span> <span class="n">D</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_fundamental_discriminant</span><span class="p">(</span><span class="n">D</span><span class="p">)]</span>
<span class="go">[-15, -11, -8, -7, -4, -3, 5, 8, 12, 13]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">D</span> <span class="k">for</span> <span class="n">D</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_square</span><span class="p">(</span><span class="n">D</span><span class="p">)</span> <span class="ow">and</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="n">D</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">disc</span><span class="p">()</span> <span class="o">==</span> <span class="n">D</span><span class="p">]</span>
<span class="go">[-15, -11, -8, -7, -4, -3, 5, 8, 12, 13]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.is_real_place">
<span class="sig-prename descclassname"><span class="pre">sage.rings.number_field.number_field.</span></span><span class="sig-name descname"><span class="pre">is_real_place</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.is_real_place" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">v</span></code> is real, <code class="docutils literal notranslate"><span class="pre">False</span></code> if <code class="docutils literal notranslate"><span class="pre">v</span></code> is complex</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code> – an infinite place of <code class="docutils literal notranslate"><span class="pre">K</span></code></p></li>
</ul>
<p>OUTPUT:</p>
<p>A boolean indicating whether a place is real (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or complex (<code class="docutils literal notranslate"><span class="pre">False</span></code>).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">xi</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi_real</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">places</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">phi_complex</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">places</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">v_fin</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">3</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

<span class="gp">sage: </span><span class="n">is_real_place</span><span class="p">(</span><span class="n">phi_real</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">is_real_place</span><span class="p">(</span><span class="n">phi_complex</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>It is an error to put in a finite place</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">is_real_place</span><span class="p">(</span><span class="n">v_fin</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">AttributeError: &#39;NumberFieldFractionalIdeal&#39; object has no attribute &#39;im_gens&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.proof_flag">
<span class="sig-prename descclassname"><span class="pre">sage.rings.number_field.number_field.</span></span><span class="sig-name descname"><span class="pre">proof_flag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.proof_flag" title="Permalink to this definition">¶</a></dt>
<dd><p>Used for easily determining the correct proof flag to use.</p>
<p>Return t if t is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, otherwise return the system-wide
proof-flag for number fields (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.number_field.number_field</span> <span class="kn">import</span> <span class="n">proof_flag</span>
<span class="gp">sage: </span><span class="n">proof_flag</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">proof_flag</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">proof_flag</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">proof_flag</span><span class="p">(</span><span class="s2">&quot;banana&quot;</span><span class="p">)</span>
<span class="go">&#39;banana&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.put_natural_embedding_first">
<span class="sig-prename descclassname"><span class="pre">sage.rings.number_field.number_field.</span></span><span class="sig-name descname"><span class="pre">put_natural_embedding_first</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.put_natural_embedding_first" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function for embeddings() functions for number fields.</p>
<p>INPUT: a list of embeddings of a number field</p>
<p>OUTPUT: <code class="docutils literal notranslate"><span class="pre">None</span></code>. The
list is altered in-place, so that, if possible, the first embedding
has been switched with one of the others, so that if there is an
embedding which preserves the generator names then it appears
first.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">embs</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">e</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">embs</span><span class="p">]</span> <span class="c1"># random - there is no natural sort order</span>
<span class="go">[a, a^2, a^3, a^4, a^5, -a^5 - a^4 - a^3 - a^2 - a - 1]</span>
<span class="gp">sage: </span><span class="nb">id</span> <span class="o">=</span> <span class="p">[</span> <span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">embs</span> <span class="k">if</span> <span class="n">e</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="n">a</span> <span class="p">][</span><span class="mi">0</span><span class="p">];</span> <span class="nb">id</span>
<span class="go">Ring endomorphism of Cyclotomic Field of order 7 and degree 6</span>
<span class="go">  Defn: a |--&gt; a</span>
<span class="gp">sage: </span><span class="n">permuted_embs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">embs</span><span class="p">);</span> <span class="n">permuted_embs</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="nb">id</span><span class="p">);</span> <span class="n">permuted_embs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">e</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">permuted_embs</span><span class="p">]</span> <span class="c1"># random - but natural map is not first</span>
<span class="go">[a^2, a^3, a^4, a^5, -a^5 - a^4 - a^3 - a^2 - a - 1, a]</span>
<span class="gp">sage: </span><span class="n">permuted_embs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">a</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.number_field.number_field</span> <span class="kn">import</span> <span class="n">put_natural_embedding_first</span>
<span class="gp">sage: </span><span class="n">put_natural_embedding_first</span><span class="p">(</span><span class="n">permuted_embs</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">e</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">permuted_embs</span><span class="p">]</span> <span class="c1"># random - but natural map is first</span>
<span class="go">[a, a^3, a^4, a^5, -a^5 - a^4 - a^3 - a^2 - a - 1, a^2]</span>
<span class="gp">sage: </span><span class="n">permuted_embs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="nb">id</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.rings.number_field.number_field.refine_embedding">
<span class="sig-prename descclassname"><span class="pre">sage.rings.number_field.number_field.</span></span><span class="sig-name descname"><span class="pre">refine_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.number_field.number_field.refine_embedding" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an embedding from a number field to either <span class="math notranslate nohighlight">\(\RR\)</span> or
<span class="math notranslate nohighlight">\(\CC\)</span>, returns an equivalent embedding with higher precision.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">e</span></code> - an embedding of a number field into either
RR or CC (with some precision)</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">prec</span></code> - (default None) the desired precision; if None,</dt><dd><p>current precision is doubled; if Infinity, the equivalent
embedding into either <code class="docutils literal notranslate"><span class="pre">QQbar</span></code> or <code class="docutils literal notranslate"><span class="pre">AA</span></code> is returned.</p>
</dd>
</dl>
</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.number_field.number_field</span> <span class="kn">import</span> <span class="n">refine_embedding</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e10</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">complex_embedding</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e10</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span><span class="o">.</span><span class="n">precision</span><span class="p">()</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">e25</span> <span class="o">=</span> <span class="n">refine_embedding</span><span class="p">(</span><span class="n">e10</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e25</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span><span class="o">.</span><span class="n">precision</span><span class="p">()</span>
<span class="go">25</span>
</pre></div>
</div>
<p>An example where we extend a real embedding into <code class="docutils literal notranslate"><span class="pre">AA</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">signature</span><span class="p">()</span>
<span class="go">(1, 1)</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">RR</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span> <span class="n">e</span>
<span class="go">Ring morphism:</span>
<span class="go">From: Number Field in a with defining polynomial x^3 - 2</span>
<span class="go">To:   Real Field with 53 bits of precision</span>
<span class="go">Defn: a |--&gt; 1.25992104989487</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">refine_embedding</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">Infinity</span><span class="p">);</span> <span class="n">e</span>
<span class="go">Ring morphism:</span>
<span class="go">From: Number Field in a with defining polynomial x^3 - 2</span>
<span class="go">To:   Algebraic Real Field</span>
<span class="go">Defn: a |--&gt; 1.259921049894873?</span>
</pre></div>
</div>
<p>Now we can obtain arbitrary precision values with no trouble:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">RealField</span><span class="p">(</span><span class="mi">150</span><span class="p">)(</span><span class="n">e</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="go">1.2599210498948731647672106072782283505702515</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">^</span><span class="mi">3</span>
<span class="go">2.0000000000000000000000000000000000000000000</span>
<span class="gp">sage: </span><span class="n">RealField</span><span class="p">(</span><span class="mi">200</span><span class="p">)(</span><span class="n">e</span><span class="p">(</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">7</span><span class="p">))</span>
<span class="go">4.8076379022835799804500738174376232086807389337953290695624</span>
</pre></div>
</div>
<p>Complex embeddings can be extended into <code class="docutils literal notranslate"><span class="pre">QQbar</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">CC</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span> <span class="n">e</span>
<span class="go">Ring morphism:</span>
<span class="go">From: Number Field in a with defining polynomial x^3 - 2</span>
<span class="go">To:   Complex Field with 53 bits of precision</span>
<span class="go">Defn: a |--&gt; -0.62996052494743... - 1.09112363597172*I</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">refine_embedding</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">Infinity</span><span class="p">);</span> <span class="n">e</span>
<span class="go">Ring morphism:</span>
<span class="go">From: Number Field in a with defining polynomial x^3 - 2</span>
<span class="go">To:   Algebraic Field</span>
<span class="go">Defn: a |--&gt; -0.6299605249474365? - 1.091123635971722?*I</span>
<span class="gp">sage: </span><span class="n">ComplexField</span><span class="p">(</span><span class="mi">200</span><span class="p">)(</span><span class="n">e</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="go">-0.62996052494743658238360530363911417528512573235075399004099 - 1.0911236359717214035600726141898088813258733387403009407036*I</span>
<span class="gp">sage: </span><span class="n">e</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Embeddings into lazy fields work:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">specified_complex_embedding</span><span class="p">();</span> <span class="n">x</span>
<span class="go">Generic morphism:</span>
<span class="go">  From: Cyclotomic Field of order 7 and degree 6</span>
<span class="go">  To:   Complex Lazy Field</span>
<span class="go">  Defn: zeta7 -&gt; 0.623489801858734? + 0.781831482468030?*I</span>
<span class="gp">sage: </span><span class="n">refine_embedding</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Cyclotomic Field of order 7 and degree 6</span>
<span class="go">  To:   Complex Field with 300 bits of precision</span>
<span class="go">  Defn: zeta7 |--&gt; 0.623489801858733530525004884004239810632274730896402105365549439096853652456487284575942507 + 0.781831482468029808708444526674057750232334518708687528980634958045091731633936441700868007*I</span>
<span class="gp">sage: </span><span class="n">refine_embedding</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">infinity</span><span class="p">)</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Cyclotomic Field of order 7 and degree 6</span>
<span class="go">  To:   Algebraic Field</span>
<span class="go">  Defn: zeta7 |--&gt; 0.6234898018587335? + 0.7818314824680299?*I</span>
</pre></div>
</div>
<p>When the old embedding is into the real lazy field,
then only real embeddings should be considered.
See <a class="reference external" href="https://trac.sagemath.org/17495">trac ticket #17495</a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">embedding</span><span class="o">=</span><span class="mf">0.68</span><span class="p">)</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.number_field.number_field</span> <span class="kn">import</span> <span class="n">refine_embedding</span>
<span class="gp">sage: </span><span class="n">refine_embedding</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">specified_complex_embedding</span><span class="p">(),</span> <span class="mi">100</span><span class="p">)</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial x^3 + x - 1 with a = 0.6823278038280193?</span>
<span class="go">  To:   Real Field with 100 bits of precision</span>
<span class="go">  Defn: a |--&gt; 0.68232780382801932736948373971</span>
<span class="gp">sage: </span><span class="n">refine_embedding</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">specified_complex_embedding</span><span class="p">(),</span> <span class="n">Infinity</span><span class="p">)</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial x^3 + x - 1 with a = 0.6823278038280193?</span>
<span class="go">  To:   Algebraic Real Field</span>
<span class="go">  Defn: a |--&gt; 0.6823278038280193?</span>
</pre></div>
</div>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="../../../index.html"
                        title="previous chapter">Algebraic Numbers and Number Fields</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="number_field_base.html"
                        title="next chapter">Base class for all number fields</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/sage/rings/number_field/number_field.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="number_field_base.html" title="Base class for all number fields"
             >next</a> |</li>
        <li class="right" >
          <a href="../../../index.html" title="Algebraic Numbers and Number Fields"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Sage 9.4 Reference Manual: Algebraic Numbers and Number Fields</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">Number Fields</a></li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2021, The Sage Development Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.0.1.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* The sidebar toggle adapts its height to the bodywrapper height. */
    const resizeObserver = new ResizeObserver(entries => {
        tog.height(bod.height());
    });
    resizeObserver.observe(bod[0]);

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>